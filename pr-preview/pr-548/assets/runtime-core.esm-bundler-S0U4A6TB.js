const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./pinia-DFMOV6lD-BZLsqLPB.js","./vue.runtime.esm-bundler-CYHrvVzW-BTeeWO83.js","./indicateLoading-C_uppgjV-DVX-YvQI.js","./index-ZIR1Iiy--ZKTDyIVI.js"])))=>i.map(i=>d[i]);
import{computed as Ct,toRaw as to,ref as me,watch as Zr,defineCustomElement as tO,nextTick as ju,defineComponent as je,shallowRef as eO,inject as MM,useCssVars as rO,useTemplateRef as _u,createElementBlock as Gt,onMounted as zc,useHost as iO,useShadowRoot as nO,onBeforeUnmount as t1,openBlock as ht,createVNode as po,createBlock as Ee,createCommentVNode as xr,unref as nt,createElementVNode as Yt,Fragment as ri,resolveDynamicComponent as yn,normalizeClass as mr,toDisplayString as nr,withModifiers as Ys,onUnmounted as sO,markRaw as ac,withCtx as Ps,Transition as oO,renderList as tn,renderSlot as gw,useId as aO,withDirectives as RM,withKeys as za,isRef as qv,vModelText as lO,normalizeStyle as ll,provide as cO,mergeModels as hO,useModel as uO,vModelDynamic as dO,onScopeDispose as IM}from"./vue.runtime.esm-bundler-CYHrvVzW-BTeeWO83.js";import{p as ar,C as Lr,L as ws,o as zu,u as PM,d as Ci,l as wf,c as fw}from"./index-ZIR1Iiy--ZKTDyIVI.js";import{defineStore as Sl,createPinia as gO,storeToRefs as yr}from"./pinia-DFMOV6lD-BZLsqLPB.js";import{A as AM,X as xS,d as fO}from"./reverseGeocode-CR3Bbmu1-Cvr90uaQ.js";import{a as pO}from"./indicateLoading-C_uppgjV-DVX-YvQI.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}})();const gr=(r,t)=>{const e=r.__vccOpts||r;for(const[i,n]of t)e[i]=n;return e},ea={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":.3048006096012192},vu={PROPERTYCHANGE:"propertychange"},Vt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};let bf=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function mO(r,t,e){let i,n;e=e||oo;let s=0,o=r.length,a=!1;for(;s<o;)i=s+(o-s>>1),n=+e(r[i],t),n<0?s=i+1:(o=i,a=!n);return a?s:~s}function oo(r,t){return r>t?1:r<t?-1:0}function yO(r,t){return r<t?1:r>t?-1:0}function e1(r,t,e){if(r[0]<=t)return 0;const i=r.length;if(t<=r[i-1])return i-1;if(typeof e=="function"){for(let n=1;n<i;++n){const s=r[n];if(s===t)return n;if(s<t)return e(t,r[n-1],s)>0?n-1:n}return i-1}if(e>0){for(let n=1;n<i;++n)if(r[n]<t)return n-1;return i-1}if(e<0){for(let n=1;n<i;++n)if(r[n]<=t)return n;return i-1}for(let n=1;n<i;++n){if(r[n]==t)return n;if(r[n]<t)return r[n-1]-t<t-r[n]?n-1:n}return i-1}function _O(r,t,e){for(;t<e;){const i=r[t];r[t]=r[e],r[e]=i,++t,--e}}function wi(r,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let n=0;n<i;n++)r[r.length]=e[n]}function ua(r,t){const e=r.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(r[i]!==t[i])return!1;return!0}function vO(r,t,e){const i=t||oo;return r.every(function(n,s){if(s===0)return!0;const o=i(r[s-1],n);return!(o>0||o===0)})}function mo(){return!0}function qu(){return!1}function bg(){}function LM(r){let t,e,i;return function(){const n=Array.prototype.slice.call(arguments);return(!e||this!==i||!ua(n,e))&&(i=this,e=n,t=r.apply(this,arguments)),t}}function xu(r){function t(){let e;try{e=r()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function Bu(r){for(const t in r)delete r[t]}function yl(r){let t;for(t in r)return!1;return!t}let on=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},kf=class extends bf{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const s=e?new on(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let c=0,h=n.length;c<h;++c)if("handleEvent"in n[c]?l=n[c].handleEvent(s):l=n[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let c=a[i];for(delete a[i];c--;)this.removeEventListener(i,bg);delete o[i]}return l}disposeInternal(){this.listeners_&&Bu(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const n=i.indexOf(e);n!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=bg,++this.pendingRemovals_[t]):(i.splice(n,1),i.length===0&&delete this.listeners_[t]))}};function Oe(r,t,e,i,n){if(n){const o=e;e=function(a){return r.removeEventListener(t,e),o.call(i??this,a)}}else i&&i!==r&&(e=e.bind(i));const s={target:r,type:t,listener:e};return r.addEventListener(t,e),s}function A0(r,t,e,i){return Oe(r,t,e,i,!0)}function sr(r){r&&r.target&&(r.target.removeEventListener(r.type,r.listener),Bu(r))}let Ef=class extends kf{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Vt.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Oe(this,t[s],e);return n}return Oe(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let s=0;s<n;++s)i[s]=A0(this,t[s],e)}else i=A0(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)ks(i);else if(Array.isArray(t))for(let n=0,s=t.length;n<s;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}};Ef.prototype.on;Ef.prototype.once;Ef.prototype.un;function ks(r){if(Array.isArray(r))for(let t=0,e=r.length;t<e;++t)sr(r[t]);else sr(r)}function te(){throw new Error("Unimplemented abstract method.")}let xO=0;function $t(r){return r.ol_uid||(r.ol_uid=String(++xO))}class wS extends on{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}let zs=class extends Ef{constructor(t){super(),this.on,this.once,this.un,$t(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new wS(i,t,e)),i=vu.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new wS(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const s=n[t];n[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],yl(this.values_)&&(this.values_=null),e||this.notify(t,i)}}};const pi={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Ei(r){const t=nn();for(let e=0,i=r.length;e<i;++e)Yd(t,r[e]);return t}function wO(r,t,e){const i=Math.min.apply(null,r),n=Math.min.apply(null,t),s=Math.max.apply(null,r),o=Math.max.apply(null,t);return hs(i,n,s,o,e)}function rs(r,t,e){return e?(e[0]=r[0]-t,e[1]=r[1]-t,e[2]=r[2]+t,e[3]=r[3]+t,e):[r[0]-t,r[1]-t,r[2]+t,r[3]+t]}function OM(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r.slice()}function qc(r,t,e){let i,n;return t<r[0]?i=r[0]-t:r[2]<t?i=t-r[2]:i=0,e<r[1]?n=r[1]-e:r[3]<e?n=e-r[3]:n=0,i*i+n*n}function Sc(r,t){return pw(r,t[0],t[1])}function eo(r,t){return r[0]<=t[0]&&t[2]<=r[2]&&r[1]<=t[1]&&t[3]<=r[3]}function pw(r,t,e){return r[0]<=t&&t<=r[2]&&r[1]<=e&&e<=r[3]}function Bv(r,t){const e=r[0],i=r[1],n=r[2],s=r[3],o=t[0],a=t[1];let l=pi.UNKNOWN;return o<e?l=l|pi.LEFT:o>n&&(l=l|pi.RIGHT),a<i?l=l|pi.BELOW:a>s&&(l=l|pi.ABOVE),l===pi.UNKNOWN&&(l=pi.INTERSECTING),l}function nn(){return[1/0,1/0,-1/0,-1/0]}function hs(r,t,e,i,n){return n?(n[0]=r,n[1]=t,n[2]=e,n[3]=i,n):[r,t,e,i]}function Uu(r){return hs(1/0,1/0,-1/0,-1/0,r)}function tu(r,t){const e=r[0],i=r[1];return hs(e,i,e,i,t)}function mw(r,t,e,i,n){const s=Uu(n);return FM(s,r,t,e,i)}function ra(r,t){return r[0]==t[0]&&r[2]==t[2]&&r[1]==t[1]&&r[3]==t[3]}function yw(r,t){return t[0]<r[0]&&(r[0]=t[0]),t[2]>r[2]&&(r[2]=t[2]),t[1]<r[1]&&(r[1]=t[1]),t[3]>r[3]&&(r[3]=t[3]),r}function Yd(r,t){t[0]<r[0]&&(r[0]=t[0]),t[0]>r[2]&&(r[2]=t[0]),t[1]<r[1]&&(r[1]=t[1]),t[1]>r[3]&&(r[3]=t[1])}function FM(r,t,e,i,n){for(;e<i;e+=n)bO(r,t[e],t[e+1]);return r}function bO(r,t,e){r[0]=Math.min(r[0],t),r[1]=Math.min(r[1],e),r[2]=Math.max(r[2],t),r[3]=Math.max(r[3],e)}function _w(r,t){let e;return e=t(r1(r)),e||(e=t(i1(r)),e)||(e=t(n1(r)),e)||(e=t(da(r)),e)?e:!1}function Uv(r){let t=0;return Bc(r)||(t=Me(r)*Ar(r)),t}function r1(r){return[r[0],r[1]]}function i1(r){return[r[2],r[1]]}function Wi(r){return[(r[0]+r[2])/2,(r[1]+r[3])/2]}function kO(r,t){let e;if(t==="bottom-left")e=r1(r);else if(t==="bottom-right")e=i1(r);else if(t==="top-left")e=da(r);else if(t==="top-right")e=n1(r);else throw new Error("Invalid corner");return e}function kg(r,t,e,i,n){const[s,o,a,l,c,h,u,d]=NM(r,t,e,i);return hs(Math.min(s,a,c,u),Math.min(o,l,h,d),Math.max(s,a,c,u),Math.max(o,l,h,d),n)}function NM(r,t,e,i){const n=t*i[0]/2,s=t*i[1]/2,o=Math.cos(e),a=Math.sin(e),l=n*o,c=n*a,h=s*o,u=s*a,d=r[0],g=r[1];return[d-l+u,g-c-h,d-l-u,g-c+h,d+l-u,g+c+h,d+l+u,g+c-h,d-l+u,g-c-h]}function Ar(r){return r[3]-r[1]}function As(r,t,e){const i=e||nn();return wr(r,t)?(r[0]>t[0]?i[0]=r[0]:i[0]=t[0],r[1]>t[1]?i[1]=r[1]:i[1]=t[1],r[2]<t[2]?i[2]=r[2]:i[2]=t[2],r[3]<t[3]?i[3]=r[3]:i[3]=t[3]):Uu(i),i}function da(r){return[r[0],r[3]]}function n1(r){return[r[2],r[3]]}function Me(r){return r[2]-r[0]}function wr(r,t){return r[0]<=t[2]&&r[2]>=t[0]&&r[1]<=t[3]&&r[3]>=t[1]}function Bc(r){return r[2]<r[0]||r[3]<r[1]}function EO(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r}function SO(r,t,e){let i=!1;const n=Bv(r,t),s=Bv(r,e);if(n===pi.INTERSECTING||s===pi.INTERSECTING)i=!0;else{const o=r[0],a=r[1],l=r[2],c=r[3],h=t[0],u=t[1],d=e[0],g=e[1],f=(g-u)/(d-h);let p,m;s&pi.ABOVE&&!(n&pi.ABOVE)&&(p=d-(g-c)/f,i=p>=o&&p<=l),!i&&s&pi.RIGHT&&!(n&pi.RIGHT)&&(m=g-(d-l)*f,i=m>=a&&m<=c),!i&&s&pi.BELOW&&!(n&pi.BELOW)&&(p=d-(g-a)/f,i=p>=o&&p<=l),!i&&s&pi.LEFT&&!(n&pi.LEFT)&&(m=g-(d-o)*f,i=m>=a&&m<=c)}return i}function DM(r,t,e,i){if(Bc(r))return Uu(e);let n=[];if(i>1){const a=r[2]-r[0],l=r[3]-r[1];for(let c=0;c<i;++c)n.push(r[0]+a*c/i,r[1],r[2],r[1]+l*c/i,r[2]-a*c/i,r[3],r[0],r[3]-l*c/i)}else n=[r[0],r[1],r[2],r[1],r[2],r[3],r[0],r[3]];t(n,n,2);const s=[],o=[];for(let a=0,l=n.length;a<l;a+=2)s.push(n[a]),o.push(n[a+1]);return wO(s,o,e)}function $M(r,t){const e=t.getExtent(),i=Wi(r);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){const n=Me(e),s=Math.floor((i[0]-e[0])/n)*n;r[0]-=s,r[2]-=s}return r}function GM(r,t,e){if(t.canWrapX()){const i=t.getExtent();if(!isFinite(r[0])||!isFinite(r[2]))return[[i[0],r[1],i[2],r[3]]];$M(r,t);const n=Me(i);if(Me(r)>n&&!e)return[[i[0],r[1],i[2],r[3]]];if(r[0]<i[0])return[[r[0]+n,r[1],i[2],r[3]],[i[0],r[1],r[2],r[3]]];if(r[2]>i[2])return[[r[0],r[1],i[2],r[3]],[i[0],r[1],r[2]-n,r[3]]]}return[r]}function kr(r,t,e){return Math.min(Math.max(r,t),e)}function TO(r,t,e,i,n,s){const o=n-e,a=s-i;if(o!==0||a!==0){const l=((r-e)*o+(t-i)*a)/(o*o+a*a);l>1?(e=n,i=s):l>0&&(e+=o*l,i+=a*l)}return Zo(r,t,e,i)}function Zo(r,t,e,i){const n=e-r,s=i-t;return n*n+s*s}function CO(r){const t=r.length;for(let i=0;i<t;i++){let n=i,s=Math.abs(r[i][i]);for(let a=i+1;a<t;a++){const l=Math.abs(r[a][i]);l>s&&(s=l,n=a)}if(s===0)return null;const o=r[n];r[n]=r[i],r[i]=o;for(let a=i+1;a<t;a++){const l=-r[a][i]/r[i][i];for(let c=i;c<t+1;c++)i==c?r[a][c]=0:r[a][c]+=l*r[i][c]}}const e=new Array(t);for(let i=t-1;i>=0;i--){e[i]=r[i][t]/r[i][i];for(let n=i-1;n>=0;n--)r[n][t]-=r[n][i]*e[i]}return e}function L0(r){return r*180/Math.PI}function ao(r){return r*Math.PI/180}function cl(r,t){const e=r%t;return e*t<0?e+t:e}function Rn(r,t,e){return r+e*(t-r)}function Wu(r,t){const e=Math.pow(10,t);return Math.round(r*e)/e}function bS(r,t){return Math.round(Wu(r,t))}function Gh(r,t){return Math.floor(Wu(r,t))}function Za(r,t){return Math.ceil(Wu(r,t))}function Wv(r,t,e){if(r>=t&&r<e)return r;const i=e-t;return((r-t)%i+i)%i+t}const jM=63710088e-1;function kS(r,t,e){e=e||jM;const i=ao(r[1]),n=ao(t[1]),s=(n-i)/2,o=ao(t[0]-r[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(n);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function MO(r,t,e,i){i=i||jM;const n=ao(r[1]),s=ao(r[0]),o=t/i,a=Math.asin(Math.sin(n)*Math.cos(o)+Math.cos(n)*Math.sin(o)*Math.cos(e)),l=s+Math.atan2(Math.sin(e)*Math.sin(o)*Math.cos(n),Math.cos(o)-Math.sin(n)*Math.sin(a));return[L0(l),L0(a)]}function zM(...r){console.warn(...r)}function qM(r,t){return r[0]+=+t[0],r[1]+=+t[1],r}function vw(r,t){const e=r[0],i=r[1],n=t[0],s=t[1],o=n[0],a=n[1],l=s[0],c=s[1],h=l-o,u=c-a,d=h===0&&u===0?0:(h*(e-o)+u*(i-a))/(h*h+u*u||0);let g,f;return d<=0?(g=o,f=a):d>=1?(g=l,f=c):(g=o+d*h,f=a+d*u),[g,f]}function Xi(r,t){let e=!0;for(let i=r.length-1;i>=0;--i)if(r[i]!=t[i]){e=!1;break}return e}function xw(r,t){const e=Math.cos(t),i=Math.sin(t),n=r[0]*e-r[1]*i,s=r[1]*e+r[0]*i;return r[0]=n,r[1]=s,r}function BM(r,t){return r[0]*=t,r[1]*=t,r}function wu(r,t){const e=r[0]-t[0],i=r[1]-t[1];return e*e+i*i}function jh(r,t){return Math.sqrt(wu(r,t))}function RO(r,t){return wu(r,vw(r,t))}function ww(r,t){if(t.canWrapX()){const e=Me(t.getExtent()),i=IO(r,t,e);i&&(r[0]-=i*e)}return r}function IO(r,t,e){const i=t.getExtent();let n=0;return t.canWrapX()&&(r[0]<i[0]||r[0]>i[2])&&(e=e||Me(i),n=Math.floor((r[0]-i[0])/e)),n}let s1=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||ea[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const Sf=6378137,zh=Math.PI*Sf,PO=[-zh,-zh,zh,zh],AO=[-180,-85,180,85],gp=Sf*Math.log(Math.tan(Math.PI/2));let nh=class extends s1{constructor(t){super({code:t,units:"m",extent:PO,global:!0,worldExtent:AO,getPointResolution:function(e,i){return e/Math.cosh(i[1]/Sf)}})}};const ES=[new nh("EPSG:3857"),new nh("EPSG:102100"),new nh("EPSG:102113"),new nh("EPSG:900913"),new nh("http://www.opengis.net/def/crs/EPSG/0/3857"),new nh("http://www.opengis.net/gml/srs/epsg.xml#3857")];function LO(r,t,e,i){const n=r.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=r.slice():t=new Array(n));for(let s=0;s<n;s+=i){t[s]=zh*r[s]/180;let o=Sf*Math.log(Math.tan(Math.PI*(+r[s+1]+90)/360));o>gp?o=gp:o<-gp&&(o=-gp),t[s+1]=o}return t}function OO(r,t,e,i){const n=r.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=r.slice():t=new Array(n));for(let s=0;s<n;s+=i)t[s]=180*r[s]/zh,t[s+1]=360*Math.atan(Math.exp(r[s+1]/Sf))/Math.PI-90;return t}const FO=6378137,SS=[-180,-90,180,90],NO=Math.PI*FO/180;let Al=class extends s1{constructor(t,e){super({code:t,units:"degrees",extent:SS,axisOrientation:e,global:!0,metersPerUnit:NO,worldExtent:SS})}};const TS=[new Al("CRS:84"),new Al("EPSG:4326","neu"),new Al("urn:ogc:def:crs:OGC:1.3:CRS84"),new Al("urn:ogc:def:crs:OGC:2:84"),new Al("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Al("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Al("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Vv={};function DO(r){return Vv[r]||Vv[r.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function $O(r,t){Vv[r]=t}let eu={};function Eg(r,t,e){const i=r.getCode(),n=t.getCode();i in eu||(eu[i]={}),eu[i][n]=e}function Wy(r,t){return r in eu&&t in eu[r]?eu[r][t]:null}const O0=.9996,is=.00669438,o1=is*is,a1=o1*is,Zl=is/(1-is),CS=Math.sqrt(1-is),bu=(1-CS)/(1+CS),UM=bu*bu,bw=UM*bu,kw=bw*bu,WM=kw*bu,VM=1-is/4-3*o1/64-5*a1/256,GO=3*is/8+3*o1/32+45*a1/1024,jO=15*o1/256+45*a1/1024,zO=35*a1/3072,qO=3/2*bu-27/32*bw+269/512*WM,BO=21/16*UM-55/32*kw,UO=151/96*bw-417/128*WM,WO=1097/512*kw,F0=6378137;function VO(r,t,e){const i=r-5e5,n=(e.north?t:t-1e7)/O0/(F0*VM),s=n+qO*Math.sin(2*n)+BO*Math.sin(4*n)+UO*Math.sin(6*n)+WO*Math.sin(8*n),o=Math.sin(s),a=o*o,l=Math.cos(s),c=o/l,h=c*c,u=h*h,d=1-is*a,g=Math.sqrt(1-is*a),f=F0/g,p=(1-is)/d,m=Zl*l**2,y=m*m,_=i/(f*O0),x=_*_,v=x*_,w=v*_,b=w*_,E=b*_,C=s-c/p*(x/2-w/24*(5+3*h+10*m-4*y-9*Zl))+E/720*(61+90*h+298*m+45*u-252*Zl-3*y);let S=(_-v/6*(1+2*h+m)+b/120*(5-2*m+28*h-3*y+8*Zl+24*u))/l;return S=Wv(S+ao(ZM(e.number)),-Math.PI,Math.PI),[L0(S),L0(C)]}const MS=-80,RS=84,ZO=-180,HO=180;function YO(r,t,e){r=Wv(r,ZO,HO),t<MS?t=MS:t>RS&&(t=RS);const i=ao(t),n=Math.sin(i),s=Math.cos(i),o=n/s,a=o*o,l=a*a,c=ao(r),h=ZM(e.number),u=ao(h),d=F0/Math.sqrt(1-is*n**2),g=Zl*s**2,f=s*Wv(c-u,-Math.PI,Math.PI),p=f*f,m=p*f,y=m*f,_=y*f,x=_*f,v=F0*(VM*i-GO*Math.sin(2*i)+jO*Math.sin(4*i)-zO*Math.sin(6*i)),w=O0*d*(f+m/6*(1-a+g)+_/120*(5-18*a+l+72*g-58*Zl))+5e5;let b=O0*(v+d*o*(p/2+y/24*(5-a+9*g+4*g**2)+x/720*(61-58*a+l+600*g-330*Zl)));return e.north||(b+=1e7),[w,b]}function ZM(r){return(r-1)*6-180+3}const XO=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function HM(r){let t=0;for(const n of XO){const s=r.match(n);if(s){t=parseInt(s[1]);break}}if(!t)return null;let e=0,i=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(i=!0,e=t-32600),e?{number:e,north:i}:null}function IS(r,t){return function(e,i,n,s){const o=e.length;n=n>1?n:2,s=s??n,i||(n>2?i=e.slice():i=new Array(o));for(let a=0;a<o;a+=s){const l=e[a],c=e[a+1],h=r(l,c,t);i[a]=h[0],i[a+1]=h[1]}return i}}function KO(r){return HM(r)?new s1({code:r,units:"m"}):null}function QO(r){const t=HM(r.getCode());return t?{forward:IS(YO,t),inverse:IS(VO,t)}:null}const JO=[QO],tF=[KO];let Zv=!0;function YM(r){Zv=!1}function Ew(r,t){if(t!==void 0){for(let e=0,i=r.length;e<i;++e)t[e]=r[e];t=t}else t=r.slice();return t}function Kht(r,t){if(t!==void 0&&r!==t){for(let e=0,i=r.length;e<i;++e)t[e]=r[e];r=t}return r}function Hv(r){$O(r.getCode(),r),Eg(r,r,Ew)}function eF(r){r.forEach(Hv)}function ee(r){if(typeof r!="string")return r;const t=DO(r);if(t)return t;for(const e of tF){const i=e(r);if(i)return i}return null}function Yv(r,t,e,i){r=ee(r);let n;const s=r.getPointResolutionFunc();if(s){if(n=s(t,e),i&&i!==r.getUnits()){const o=r.getMetersPerUnit();o&&(n=n*o/ea[i])}}else{const o=r.getUnits();if(o=="degrees"&&!i||i=="degrees")n=t;else{const a=Tf(r,ee("EPSG:4326"));if(!a&&o!=="degrees")n=t*r.getMetersPerUnit();else{let c=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];c=a(c,c,2);const h=kS(c.slice(0,2),c.slice(2,4)),u=kS(c.slice(4,6),c.slice(6,8));n=(h+u)/2}const l=i?ea[i]:r.getMetersPerUnit();l!==void 0&&(n/=l)}}return n}function PS(r){eF(r),r.forEach(function(t){r.forEach(function(e){t!==e&&Eg(t,e,Ew)})})}function rF(r,t,e,i){r.forEach(function(n){t.forEach(function(s){Eg(n,s,e),Eg(s,n,i)})})}function Sw(r,t){return r?typeof r=="string"?ee(r):r:ee(t)}function iF(r){return(function(t,e,i,n){const s=t.length;i=i!==void 0?i:2,n=n??i,e=e!==void 0?e:new Array(s);for(let o=0;o<s;o+=n){const a=r(t.slice(o,o+i)),l=a.length;for(let c=0,h=n;c<h;++c)e[o+c]=c>=l?t[o+c]:a[c]}return e})}function Xv(r,t){return YM(),qs(r,"EPSG:4326",t!==void 0?t:"EPSG:3857")}function nF(r,t){const e=qs(r,t!==void 0?t:"EPSG:3857","EPSG:4326"),i=e[0];return(i<-180||i>180)&&(e[0]=cl(i+180,360)-180),e}function Mi(r,t){if(r===t)return!0;const e=r.getUnits()===t.getUnits();return(r.getCode()===t.getCode()||Tf(r,t)===Ew)&&e}function Tf(r,t){const e=r.getCode(),i=t.getCode();let n=Wy(e,i);if(n)return n;let s=null,o=null;for(const l of JO)s||(s=l(r)),o||(o=l(t));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)n=Vy(s.inverse,o.forward);else{const l=Wy(e,a);l&&(n=Vy(l,o.forward))}else{const l=Wy(a,i);l&&(n=Vy(s.inverse,l))}return n&&(Hv(r),Hv(t),Eg(r,t,n)),n}function Vy(r,t){return function(e,i,n,s){return i=r(e,i,n,s),t(i,i,n,s)}}function yo(r,t){const e=ee(r),i=ee(t);return Tf(e,i)}function qs(r,t,e){const i=yo(t,e);if(!i){const n=ee(t).getCode(),s=ee(e).getCode();throw new Error(`No transform available between ${n} and ${s}`)}return i(r,void 0,r.length)}function ru(r,t,e,i){const n=yo(t,e);return DM(r,n,void 0,i)}let sF=null;function oF(){return sF}function Tc(r,t){return r}function fr(r,t){return Zv&&!Xi(r,[0,0])&&r[0]>=-180&&r[0]<=180&&r[1]>=-90&&r[1]<=90&&(Zv=!1,zM("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),r}function l1(r,t){return r}function Cs(r,t){return r}function aF(){PS(ES),PS(TS),rF(TS,ES,LO,OO)}aF();function XM(r){return Math.pow(r,3)}function Tl(r){return 1-XM(1-r)}function lF(r){return 3*r*r-2*r*r*r}function cF(r){return r}const Cc=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",hF=Cc.includes("safari")&&!Cc.includes("chrom");hF&&(Cc.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Cc));const uF=Cc.includes("webkit")&&!Cc.includes("edge"),Tw=Cc.includes("macintosh"),KM=typeof devicePixelRatio<"u"?devicePixelRatio:1,Hn=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Cw=typeof Image<"u"&&Image.prototype.decode,QM=typeof createImageBitmap=="function",JM=(function(){let r=!1;try{const t=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return r})();function Or(r,t,e,i){let n;return e&&e.length?n=e.shift():Hn?n=new class extends OffscreenCanvas{style={}}(r??300,t??150):n=document.createElement("canvas"),r&&(n.width=r),t&&(n.height=t),n.getContext("2d",i)}let Zy;function N0(){return Zy||(Zy=Or(1,1)),Zy}function Cf(r){const t=r.canvas;t.width=1,t.height=1,r.clearRect(0,0,1,1)}function dF(r){let t=r.offsetWidth;const e=getComputedStyle(r);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),t}function gF(r){let t=r.offsetHeight;const e=getComputedStyle(r);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),t}function AS(r,t){const e=t.parentNode;e&&e.replaceChild(r,t)}function tR(r){for(;r.lastChild;)r.lastChild.remove()}function fF(r,t){const e=r.childNodes;for(let i=0;;++i){const n=e[i],s=t[i];if(!n&&!s)break;if(n!==s){if(!n){r.appendChild(s);continue}if(!s){r.removeChild(n),--i;continue}r.insertBefore(s,n)}}}function eR(){return new Proxy({childNodes:[],appendChild:function(r){return this.childNodes.push(r),r},remove:function(){},removeChild:function(r){const t=this.childNodes.indexOf(r);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),r},insertBefore:function(r,t){const e=this.childNodes.indexOf(t);if(e===-1)throw new Error("Reference node not found");return this.childNodes.splice(e,0,r),r},style:{}},{get(r,t,e){return t==="firstElementChild"?r.childNodes.length>0?r.childNodes[0]:null:Reflect.get(r,t,e)}})}function Ha(r){return typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas}const fp="ol-hidden",pF="ol-selectable",c1="ol-unselectable",Mw="ol-control",LS="ol-collapsed",mF=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),OS=["style","variant","weight","size","lineHeight","family"],Kv={normal:400,bold:700},Qv=function(r){const t=r.match(mF);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,n=OS.length;i<n;++i){const s=t[i+1];s!==void 0&&(e[OS[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(e.weight))&&e.weight in Kv&&(e.weight=Kv[e.weight]),e.families=e.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),e},rR="10px sans-serif",un="#000",ku="round",Ho=[],Yo=0,Eu="round",Sg=10,Tg="#000",Cg="center",D0="middle",Hl=[0,0,0,0],Mg=1,Ul=new zs;let yd=null,FS;const Jv={},yF=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function _F(r,t,e){return`${r} ${t} 16px "${e}"`}const iR=(function(){let r,t;async function e(n){await t.ready;const s=await t.load(n);if(s.length===0)return!1;const o=Qv(n),a=o.families[0].toLowerCase(),l=o.weight;return s.some(c=>{const h=c.family.replace(/^['"]|['"]$/g,"").toLowerCase(),u=Kv[c.weight]||c.weight;return h===a&&c.style===o.style&&u==l})}async function i(){await t.ready;let n=!0;const s=Ul.getProperties(),o=Object.keys(s).filter(a=>s[a]<100);for(let a=o.length-1;a>=0;--a){const l=o[a];let c=s[l];c<100&&(await e(l)?(Bu(Jv),Ul.set(l,100)):(c+=10,Ul.set(l,c,!0),c<100&&(n=!1)))}r=void 0,n||(r=setTimeout(i,100))}return async function(n){t||(t=Hn?self.fonts:document.fonts);const s=Qv(n);if(!s)return;const o=s.families;let a=!1;for(const l of o){if(yF.has(l))continue;const c=_F(s.style,s.weight,l);Ul.get(c)===void 0&&(Ul.set(c,0,!0),a=!0)}a&&(clearTimeout(r),r=setTimeout(i,100))}})(),vF=(function(){let r;return function(t){let e=Jv[t];if(e==null){if(Hn){const i=Qv(t),n=nR(t,"Å½g");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else r||(r=document.createElement("div"),r.innerHTML="M",r.style.minHeight="0",r.style.maxHeight="none",r.style.height="auto",r.style.padding="0",r.style.border="none",r.style.position="absolute",r.style.display="block",r.style.left="-99999px"),r.style.font=t,document.body.appendChild(r),e=r.offsetHeight,document.body.removeChild(r);Jv[t]=e}return e}})();function nR(r,t){return yd||(yd=Or(1,1)),r!=FS&&(yd.font=r,FS=yd.font),yd.measureText(t)}function sR(r,t){return nR(r,t).width}function NS(r,t,e){if(t in e)return e[t];const i=t.split(`
`).reduce((n,s)=>Math.max(n,sR(r,s)),0);return e[t]=i,i}function xF(r,t){const e=[],i=[],n=[];let s=0,o=0,a=0,l=0;for(let c=0,h=t.length;c<=h;c+=2){const u=t[c];if(u===`
`||c===h){s=Math.max(s,o),n.push(o),o=0,a+=l,l=0;continue}const d=t[c+1]||r.font,g=sR(d,u);e.push(g),o+=g;const f=vF(d);i.push(f),l=Math.max(l,f)}return{width:s,height:a,widths:e,heights:i,lineWidths:n}}function wF(r,t,e,i,n,s,o,a,l,c,h){r.save(),e!==1&&(r.globalAlpha===void 0?r.globalAlpha=u=>u.globalAlpha*=e:r.globalAlpha*=e),t&&r.transform.apply(r,t),i.contextInstructions?(r.translate(l,c),r.scale(h[0],h[1]),bF(i,r)):h[0]<0||h[1]<0?(r.translate(l,c),r.scale(h[0],h[1]),r.drawImage(i,n,s,o,a,0,0,o,a)):r.drawImage(i,n,s,o,a,l,c,o*h[0],a*h[1]),r.restore()}function bF(r,t){const e=r.contextInstructions;for(let i=0,n=e.length;i<n;i+=2)Array.isArray(e[i+1])?t[e[i]].apply(t,e[i+1]):t[e[i]]=e[i+1]}function oR(r,t,e=0,i=r.length-1,n=kF){for(;i>e;){if(i-e>600){const l=i-e+1,c=t-e+1,h=Math.log(l),u=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*u*(l-u)/l)*(c-l/2<0?-1:1),g=Math.max(e,Math.floor(t-c*u/l+d)),f=Math.min(i,Math.floor(t+(l-c)*u/l+d));oR(r,t,g,f,n)}const s=r[t];let o=e,a=i;for(_d(r,e,t),n(r[i],s)>0&&_d(r,e,i);o<a;){for(_d(r,o,a),o++,a--;n(r[o],s)<0;)o++;for(;n(r[a],s)>0;)a--}n(r[e],s)===0?_d(r,e,a):(a++,_d(r,a,i)),a<=t&&(e=a+1),t<=a&&(i=a-1)}}function _d(r,t,e){const i=r[t];r[t]=r[e],r[e]=i}function kF(r,t){return r<t?-1:r>t?1:0}let h1=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!mp(t,e))return i;const n=this.toBBox,s=[];for(;e;){for(let o=0;o<e.children.length;o++){const a=e.children[o],l=e.leaf?n(a):a;mp(t,l)&&(e.leaf?i.push(a):Yy(t,l)?this._all(a,i):s.push(a))}e=s.pop()}return i}collides(t){let e=this.data;if(!mp(t,e))return!1;const i=[];for(;e;){for(let n=0;n<e.children.length;n++){const s=e.children[n],o=e.leaf?this.toBBox(s):s;if(mp(t,o)){if(e.leaf||Yy(t,o))return!0;i.push(s)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Sh([]),this}remove(t,e){if(!t)return this;let i=this.data;const n=this.toBBox(t),s=[],o=[];let a,l,c;for(;i||s.length;){if(i||(i=s.pop(),l=s[s.length-1],a=o.pop(),c=!0),i.leaf){const h=EF(t,i.children,e);if(h!==-1)return i.children.splice(h,1),s.push(i),this._condense(s),this}!c&&!i.leaf&&Yy(i,n)?(s.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],c=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,n){const s=i-e+1;let o=this._maxEntries,a;if(s<=o)return a=Sh(t.slice(e,i+1)),sh(a,this.toBBox),a;n||(n=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,n-1))),a=Sh([]),a.leaf=!1,a.height=n;const l=Math.ceil(s/o),c=l*Math.ceil(Math.sqrt(o));DS(t,e,i,c,this.compareMinX);for(let h=e;h<=i;h+=c){const u=Math.min(h+c-1,i);DS(t,h,u,l,this.compareMinY);for(let d=h;d<=u;d+=l){const g=Math.min(d+l-1,u);a.children.push(this._build(t,d,g,n-1))}}return sh(a,this.toBBox),a}_chooseSubtree(t,e,i,n){for(;n.push(e),!(e.leaf||n.length-1===i);){let s=1/0,o=1/0,a;for(let l=0;l<e.children.length;l++){const c=e.children[l],h=Hy(c),u=CF(t,c)-h;u<o?(o=u,s=h<s?h:s,a=c):u===o&&h<s&&(s=h,a=c)}e=a||e.children[0]}return e}_insert(t,e,i){const n=i?t:this.toBBox(t),s=[],o=this._chooseSubtree(n,this.data,e,s);for(o.children.push(t),Od(o,n);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(n,s,e)}_split(t,e){const i=t[e],n=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,n);const o=this._chooseSplitIndex(i,s,n),a=Sh(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,sh(i,this.toBBox),sh(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)}_splitRoot(t,e){this.data=Sh([t,e]),this.data.height=t.height+1,this.data.leaf=!1,sh(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let n,s=1/0,o=1/0;for(let a=e;a<=i-e;a++){const l=Ld(t,0,a,this.toBBox),c=Ld(t,a,i,this.toBBox),h=MF(l,c),u=Hy(l)+Hy(c);h<s?(s=h,n=a,o=u<o?u:o):h===s&&u<o&&(o=u,n=a)}return n||i-e}_chooseSplitAxis(t,e,i){const n=t.leaf?this.compareMinX:SF,s=t.leaf?this.compareMinY:TF,o=this._allDistMargin(t,e,i,n),a=this._allDistMargin(t,e,i,s);o<a&&t.children.sort(n)}_allDistMargin(t,e,i,n){t.children.sort(n);const s=this.toBBox,o=Ld(t,0,e,s),a=Ld(t,i-e,i,s);let l=pp(o)+pp(a);for(let c=e;c<i-e;c++){const h=t.children[c];Od(o,t.leaf?s(h):h),l+=pp(o)}for(let c=i-e-1;c>=e;c--){const h=t.children[c];Od(a,t.leaf?s(h):h),l+=pp(a)}return l}_adjustParentBBoxes(t,e,i){for(let n=i;n>=0;n--)Od(e[n],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():sh(t[e],this.toBBox)}};function EF(r,t,e){if(!e)return t.indexOf(r);for(let i=0;i<t.length;i++)if(e(r,t[i]))return i;return-1}function sh(r,t){Ld(r,0,r.children.length,t,r)}function Ld(r,t,e,i,n){n||(n=Sh(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(let s=t;s<e;s++){const o=r.children[s];Od(n,r.leaf?i(o):o)}return n}function Od(r,t){return r.minX=Math.min(r.minX,t.minX),r.minY=Math.min(r.minY,t.minY),r.maxX=Math.max(r.maxX,t.maxX),r.maxY=Math.max(r.maxY,t.maxY),r}function SF(r,t){return r.minX-t.minX}function TF(r,t){return r.minY-t.minY}function Hy(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function pp(r){return r.maxX-r.minX+(r.maxY-r.minY)}function CF(r,t){return(Math.max(t.maxX,r.maxX)-Math.min(t.minX,r.minX))*(Math.max(t.maxY,r.maxY)-Math.min(t.minY,r.minY))}function MF(r,t){const e=Math.max(r.minX,t.minX),i=Math.max(r.minY,t.minY),n=Math.min(r.maxX,t.maxX),s=Math.min(r.maxY,t.maxY);return Math.max(0,n-e)*Math.max(0,s-i)}function Yy(r,t){return r.minX<=t.minX&&r.minY<=t.minY&&t.maxX<=r.maxX&&t.maxY<=r.maxY}function mp(r,t){return t.minX<=r.maxX&&t.minY<=r.maxY&&t.maxX>=r.minX&&t.maxY>=r.minY}function Sh(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function DS(r,t,e,i,n){const s=[t,e];for(;s.length;){if(e=s.pop(),t=s.pop(),e-t<=i)continue;const o=t+Math.ceil((e-t)/i/2)*i;oR(r,o,t,e,n),s.push(t,o,o,e)}}const yt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};let Mf=class extends kf{constructor(r,t,e){super(),e=e||{},this.tileCoord=r,this.state=t,this.key="",this.transition_=e.transition===void 0?250:e.transition,this.transitionStarts_={},this.interpolate=!!e.interpolate}changed(){this.dispatchEvent(Vt.CHANGE)}release(){this.setState(yt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(r){if(this.state!==yt.EMPTY){if(this.state!==yt.ERROR&&this.state>r)throw new Error("Tile load sequence violation");this.state=r,this.changed()}}load(){te()}getAlpha(r,t){if(!this.transition_)return 1;let e=this.transitionStarts_[r];if(!e)e=t,this.transitionStarts_[r]=e;else if(e===-1)return 1;const i=t-e+1e3/60;return i>=this.transition_?1:XM(i/this.transition_)}inTransition(r){return this.transition_?this.transitionStarts_[r]!==-1:!1}endTransition(r){this.transition_&&(this.transitionStarts_[r]=-1)}disposeInternal(){this.release(),super.disposeInternal()}},aR=class extends Mf{constructor(r,t,e,i,n,s){super(r,t,s),this.extent=null,this.format_=i,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=n,this.url_=e,this.key=e}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==yt.IDLE&&(this.setState(yt.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(r,t){this.setFeatures(r)}onError(){this.setState(yt.ERROR)}setFeatures(r){this.features_=r,this.setState(yt.LOADED)}setLoader(r){this.loader_=r}};const Su={PROPERTYCHANGE:"propertychange"},Bt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};let Rf=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function RF(r,t,e){let i,n;e=e||lo;let s=0,o=r.length,a=!1;for(;s<o;)i=s+(o-s>>1),n=+e(r[i],t),n<0?s=i+1:(o=i,a=!n);return a?s:~s}function lo(r,t){return r>t?1:r<t?-1:0}function lR(r,t){return r<t?1:r>t?-1:0}function u1(r,t,e){if(r[0]<=t)return 0;const i=r.length;if(t<=r[i-1])return i-1;if(typeof e=="function"){for(let n=1;n<i;++n){const s=r[n];if(s===t)return n;if(s<t)return e(t,r[n-1],s)>0?n-1:n}return i-1}if(e>0){for(let n=1;n<i;++n)if(r[n]<t)return n-1;return i-1}if(e<0){for(let n=1;n<i;++n)if(r[n]<=t)return n;return i-1}for(let n=1;n<i;++n){if(r[n]==t)return n;if(r[n]<t)return r[n-1]-t<t-r[n]?n-1:n}return i-1}function IF(r,t,e){for(;t<e;){const i=r[t];r[t]=r[e],r[e]=i,++t,--e}}function en(r,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let n=0;n<i;n++)r[r.length]=e[n]}function ga(r,t){const e=r.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(r[i]!==t[i])return!1;return!0}function PF(r,t){const e=r.length,i=Array(r.length);let n;for(n=0;n<e;n++)i[n]={index:n,value:r[n]};for(i.sort(function(s,o){return t(s.value,o.value)||s.index-o.index}),n=0;n<r.length;n++)r[n]=i[n].value}function AF(r,t,e){const i=t||lo;return r.every(function(n,s){if(s===0)return!0;const o=i(r[s-1],n);return!(o>0||o===0)})}function Rg(){return!0}function d1(){return!1}function Ig(){}function cR(r){let t,e,i;return function(){const n=Array.prototype.slice.call(arguments);return(!e||this!==i||!ga(n,e))&&(i=this,e=n,t=r.apply(this,arguments)),t}}function hR(r){function t(){let e;try{e=r()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function Vu(r){for(const t in r)delete r[t]}function _l(r){let t;for(t in r)return!1;return!t}let Eo=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},Zu=class extends Rf{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const s=e?new Eo(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let c=0,h=n.length;c<h;++c)if("handleEvent"in n[c]?l=n[c].handleEvent(s):l=n[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let c=a[i];for(delete a[i];c--;)this.removeEventListener(i,Ig);delete o[i]}return l}disposeInternal(){this.listeners_&&Vu(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const n=i.indexOf(e);n!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=Ig,++this.pendingRemovals_[t]):(i.splice(n,1),i.length===0&&delete this.listeners_[t]))}};function Se(r,t,e,i,n){if(n){const o=e;e=function(a){return r.removeEventListener(t,e),o.call(i??this,a)}}else i&&i!==r&&(e=e.bind(i));const s={target:r,type:t,listener:e};return r.addEventListener(t,e),s}function $0(r,t,e,i){return Se(r,t,e,i,!0)}function or(r){r&&r.target&&(r.target.removeEventListener(r.type,r.listener),Vu(r))}let If=class extends Zu{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Bt.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Se(this,t[s],e);return n}return Se(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let s=0;s<n;++s)i[s]=$0(this,t[s],e)}else i=$0(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)LF(i);else if(Array.isArray(t))for(let n=0,s=t.length;n<s;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}};If.prototype.on;If.prototype.once;If.prototype.un;function LF(r){if(Array.isArray(r))for(let t=0,e=r.length;t<e;++t)or(r[t]);else or(r)}function Qt(){throw new Error("Unimplemented abstract method.")}let OF=0;function Rt(r){return r.ol_uid||(r.ol_uid=String(++OF))}let $S=class extends Eo{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}},So=class extends If{constructor(t){super(),this.on,this.once,this.un,Rt(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new $S(i,t,e)),i=Su.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new $S(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const s=n[t];n[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],_l(this.values_)&&(this.values_=null),e||this.notify(t,i)}}};function _e(r,t){if(!r)throw new Error(t)}const mi={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Pg(r){const t=sn();for(let e=0,i=r.length;e<i;++e)Xd(t,r[e]);return t}function FF(r,t,e){const i=Math.min.apply(null,r),n=Math.min.apply(null,t),s=Math.max.apply(null,r),o=Math.max.apply(null,t);return Fs(i,n,s,o,e)}function ns(r,t,e){return e?(e[0]=r[0]-t,e[1]=r[1]-t,e[2]=r[2]+t,e[3]=r[3]+t,e):[r[0]-t,r[1]-t,r[2]+t,r[3]+t]}function uR(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r.slice()}function Uc(r,t,e){let i,n;return t<r[0]?i=r[0]-t:r[2]<t?i=t-r[2]:i=0,e<r[1]?n=r[1]-e:r[3]<e?n=e-r[3]:n=0,i*i+n*n}function Mc(r,t){return Rw(r,t[0],t[1])}function ro(r,t){return r[0]<=t[0]&&t[2]<=r[2]&&r[1]<=t[1]&&t[3]<=r[3]}function Rw(r,t,e){return r[0]<=t&&t<=r[2]&&r[1]<=e&&e<=r[3]}function tx(r,t){const e=r[0],i=r[1],n=r[2],s=r[3],o=t[0],a=t[1];let l=mi.UNKNOWN;return o<e?l=l|mi.LEFT:o>n&&(l=l|mi.RIGHT),a<i?l=l|mi.BELOW:a>s&&(l=l|mi.ABOVE),l===mi.UNKNOWN&&(l=mi.INTERSECTING),l}function sn(){return[1/0,1/0,-1/0,-1/0]}function Fs(r,t,e,i,n){return n?(n[0]=r,n[1]=t,n[2]=e,n[3]=i,n):[r,t,e,i]}function Hu(r){return Fs(1/0,1/0,-1/0,-1/0,r)}function Iw(r,t){const e=r[0],i=r[1];return Fs(e,i,e,i,t)}function Pw(r,t,e,i,n){const s=Hu(n);return gR(s,r,t,e,i)}function vl(r,t){return r[0]==t[0]&&r[2]==t[2]&&r[1]==t[1]&&r[3]==t[3]}function dR(r,t){return t[0]<r[0]&&(r[0]=t[0]),t[2]>r[2]&&(r[2]=t[2]),t[1]<r[1]&&(r[1]=t[1]),t[3]>r[3]&&(r[3]=t[3]),r}function Xd(r,t){t[0]<r[0]&&(r[0]=t[0]),t[0]>r[2]&&(r[2]=t[0]),t[1]<r[1]&&(r[1]=t[1]),t[1]>r[3]&&(r[3]=t[1])}function gR(r,t,e,i,n){for(;e<i;e+=n)NF(r,t[e],t[e+1]);return r}function NF(r,t,e){r[0]=Math.min(r[0],t),r[1]=Math.min(r[1],e),r[2]=Math.max(r[2],t),r[3]=Math.max(r[3],e)}function fR(r,t){let e;return e=t(lc(r)),e||(e=t(Tu(r)),e)||(e=t(cc(r)),e)||(e=t(_o(r)),e)?e:!1}function ex(r){let t=0;return fa(r)||(t=Te(r)*ti(r)),t}function lc(r){return[r[0],r[1]]}function Tu(r){return[r[2],r[1]]}function Ns(r){return[(r[0]+r[2])/2,(r[1]+r[3])/2]}function DF(r,t){let e;if(t==="bottom-left")e=lc(r);else if(t==="bottom-right")e=Tu(r);else if(t==="top-left")e=_o(r);else if(t==="top-right")e=cc(r);else throw new Error("Invalid corner");return e}function Ag(r,t,e,i,n){const[s,o,a,l,c,h,u,d]=Aw(r,t,e,i);return Fs(Math.min(s,a,c,u),Math.min(o,l,h,d),Math.max(s,a,c,u),Math.max(o,l,h,d),n)}function Aw(r,t,e,i){const n=t*i[0]/2,s=t*i[1]/2,o=Math.cos(e),a=Math.sin(e),l=n*o,c=n*a,h=s*o,u=s*a,d=r[0],g=r[1];return[d-l+u,g-c-h,d-l-u,g-c+h,d+l-u,g+c+h,d+l+u,g+c-h,d-l+u,g-c-h]}function ti(r){return r[3]-r[1]}function bn(r,t,e){const i=e||sn();return zr(r,t)?(r[0]>t[0]?i[0]=r[0]:i[0]=t[0],r[1]>t[1]?i[1]=r[1]:i[1]=t[1],r[2]<t[2]?i[2]=r[2]:i[2]=t[2],r[3]<t[3]?i[3]=r[3]:i[3]=t[3]):Hu(i),i}function _o(r){return[r[0],r[3]]}function cc(r){return[r[2],r[3]]}function Te(r){return r[2]-r[0]}function zr(r,t){return r[0]<=t[2]&&r[2]>=t[0]&&r[1]<=t[3]&&r[3]>=t[1]}function fa(r){return r[2]<r[0]||r[3]<r[1]}function $F(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r}function GF(r,t,e){let i=!1;const n=tx(r,t),s=tx(r,e);if(n===mi.INTERSECTING||s===mi.INTERSECTING)i=!0;else{const o=r[0],a=r[1],l=r[2],c=r[3],h=t[0],u=t[1],d=e[0],g=e[1],f=(g-u)/(d-h);let p,m;s&mi.ABOVE&&!(n&mi.ABOVE)&&(p=d-(g-c)/f,i=p>=o&&p<=l),!i&&s&mi.RIGHT&&!(n&mi.RIGHT)&&(m=g-(d-l)*f,i=m>=a&&m<=c),!i&&s&mi.BELOW&&!(n&mi.BELOW)&&(p=d-(g-a)/f,i=p>=o&&p<=l),!i&&s&mi.LEFT&&!(n&mi.LEFT)&&(m=g-(d-o)*f,i=m>=a&&m<=c)}return i}function jF(r,t,e,i){if(fa(r))return Hu(e);let n=[];if(i>1){const a=r[2]-r[0],l=r[3]-r[1];for(let c=0;c<i;++c)n.push(r[0]+a*c/i,r[1],r[2],r[1]+l*c/i,r[2]-a*c/i,r[3],r[0],r[3]-l*c/i)}else n=[r[0],r[1],r[2],r[1],r[2],r[3],r[0],r[3]];t(n,n,2);const s=[],o=[];for(let a=0,l=n.length;a<l;a+=2)s.push(n[a]),o.push(n[a+1]);return FF(s,o,e)}function pR(r,t){const e=t.getExtent(),i=Ns(r);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){const n=Te(e),s=Math.floor((i[0]-e[0])/n)*n;r[0]-=s,r[2]-=s}return r}function mR(r,t,e){if(t.canWrapX()){const i=t.getExtent();if(!isFinite(r[0])||!isFinite(r[2]))return[[i[0],r[1],i[2],r[3]]];pR(r,t);const n=Te(i);if(Te(r)>n&&!e)return[[i[0],r[1],i[2],r[3]]];if(r[0]<i[0])return[[r[0]+n,r[1],i[2],r[3]],[i[0],r[1],r[2],r[3]]];if(r[2]>i[2])return[[r[0],r[1],i[2],r[3]],[i[0],r[1],r[2]-n,r[3]]]}return[r]}function dr(r,t,e){return Math.min(Math.max(r,t),e)}function zF(r,t,e,i,n,s){const o=n-e,a=s-i;if(o!==0||a!==0){const l=((r-e)*o+(t-i)*a)/(o*o+a*a);l>1?(e=n,i=s):l>0&&(e+=o*l,i+=a*l)}return hc(r,t,e,i)}function hc(r,t,e,i){const n=e-r,s=i-t;return n*n+s*s}function qF(r){const t=r.length;for(let i=0;i<t;i++){let n=i,s=Math.abs(r[i][i]);for(let a=i+1;a<t;a++){const l=Math.abs(r[a][i]);l>s&&(s=l,n=a)}if(s===0)return null;const o=r[n];r[n]=r[i],r[i]=o;for(let a=i+1;a<t;a++){const l=-r[a][i]/r[i][i];for(let c=i;c<t+1;c++)i==c?r[a][c]=0:r[a][c]+=l*r[i][c]}}const e=new Array(t);for(let i=t-1;i>=0;i--){e[i]=r[i][t]/r[i][i];for(let n=i-1;n>=0;n--)r[n][t]-=r[n][i]*e[i]}return e}function GS(r){return r*180/Math.PI}function hl(r){return r*Math.PI/180}function uc(r,t){const e=r%t;return e*t<0?e+t:e}function In(r,t,e){return r+e*(t-r)}function Pf(r,t){const e=Math.pow(10,t);return Math.round(r*e)/e}function jS(r,t){return Math.round(Pf(r,t))}function qh(r,t){return Math.floor(Pf(r,t))}function Ya(r,t){return Math.ceil(Pf(r,t))}function rx(r,t,e){if(r>=t&&r<e)return r;const i=e-t;return((r-t)%i+i)%i+t}const BF=63710088e-1;function zS(r,t,e){e=e||BF;const i=hl(r[1]),n=hl(t[1]),s=(n-i)/2,o=hl(t[0]-r[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(n);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function yR(...r){console.warn(...r)}function _R(r,t){return r[0]+=+t[0],r[1]+=+t[1],r}function G0(r,t){let e=!0;for(let i=r.length-1;i>=0;--i)if(r[i]!=t[i]){e=!1;break}return e}function Lw(r,t){const e=Math.cos(t),i=Math.sin(t),n=r[0]*e-r[1]*i,s=r[1]*e+r[0]*i;return r[0]=n,r[1]=s,r}function vR(r,t){return r[0]*=t,r[1]*=t,r}function Ow(r,t){if(t.canWrapX()){const e=Te(t.getExtent()),i=xR(r,t,e);i&&(r[0]-=i*e)}return r}function xR(r,t,e){const i=t.getExtent();let n=0;return t.canWrapX()&&(r[0]<i[0]||r[0]>i[2])&&(e=e||Te(i),n=Math.floor((r[0]-i[0])/e)),n}function UF(r,t,e){const i=Math.sqrt((t[0]-r[0])*(t[0]-r[0])+(t[1]-r[1])*(t[1]-r[1])),n=[(t[0]-r[0])/i,(t[1]-r[1])/i],s=[-n[1],n[0]],o=Math.sqrt((e[0]-r[0])*(e[0]-r[0])+(e[1]-r[1])*(e[1]-r[1])),a=[(e[0]-r[0])/o,(e[1]-r[1])/o];let l=i===0||o===0?0:Math.acos(dr(a[0]*n[0]+a[1]*n[1],-1,1));return l=Math.max(l,1e-5),a[0]*s[0]+a[1]*s[1]>0?l:Math.PI*2-l}const Fw={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Af=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Fw[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const Lf=6378137,Bh=Math.PI*Lf,WF=[-Bh,-Bh,Bh,Bh],VF=[-180,-85,180,85],yp=Lf*Math.log(Math.tan(Math.PI/2));class oh extends Af{constructor(t){super({code:t,units:"m",extent:WF,global:!0,worldExtent:VF,getPointResolution:function(e,i){return e/Math.cosh(i[1]/Lf)}})}}const qS=[new oh("EPSG:3857"),new oh("EPSG:102100"),new oh("EPSG:102113"),new oh("EPSG:900913"),new oh("http://www.opengis.net/def/crs/EPSG/0/3857"),new oh("http://www.opengis.net/gml/srs/epsg.xml#3857")];function ZF(r,t,e,i){const n=r.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=r.slice():t=new Array(n));for(let s=0;s<n;s+=i){t[s]=Bh*r[s]/180;let o=Lf*Math.log(Math.tan(Math.PI*(+r[s+1]+90)/360));o>yp?o=yp:o<-yp&&(o=-yp),t[s+1]=o}return t}function HF(r,t,e,i){const n=r.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=r.slice():t=new Array(n));for(let s=0;s<n;s+=i)t[s]=180*r[s]/Bh,t[s+1]=360*Math.atan(Math.exp(r[s+1]/Lf))/Math.PI-90;return t}const YF=6378137,BS=[-180,-90,180,90],XF=Math.PI*YF/180;let Ll=class extends Af{constructor(t,e){super({code:t,units:"degrees",extent:BS,axisOrientation:e,global:!0,metersPerUnit:XF,worldExtent:BS})}};const US=[new Ll("CRS:84"),new Ll("EPSG:4326","neu"),new Ll("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ll("urn:ogc:def:crs:OGC:2:84"),new Ll("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ll("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ll("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ix={};function d0(r){return ix[r]||ix[r.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function KF(r,t){ix[r]=t}let iu={};function Rc(r,t,e){const i=r.getCode(),n=t.getCode();i in iu||(iu[i]={}),iu[i][n]=e}function g0(r,t){return r in iu&&t in iu[r]?iu[r][t]:null}const j0=.9996,ss=.00669438,g1=ss*ss,f1=g1*ss,Yl=ss/(1-ss),WS=Math.sqrt(1-ss),Cu=(1-WS)/(1+WS),wR=Cu*Cu,Nw=wR*Cu,Dw=Nw*Cu,bR=Dw*Cu,kR=1-ss/4-3*g1/64-5*f1/256,QF=3*ss/8+3*g1/32+45*f1/1024,JF=15*g1/256+45*f1/1024,tN=35*f1/3072,eN=3/2*Cu-27/32*Nw+269/512*bR,rN=21/16*wR-55/32*Dw,iN=151/96*Nw-417/128*bR,nN=1097/512*Dw,z0=6378137;function sN(r,t,e){const i=r-5e5,n=(e.north?t:t-1e7)/j0/(z0*kR),s=n+eN*Math.sin(2*n)+rN*Math.sin(4*n)+iN*Math.sin(6*n)+nN*Math.sin(8*n),o=Math.sin(s),a=o*o,l=Math.cos(s),c=o/l,h=c*c,u=h*h,d=1-ss*a,g=Math.sqrt(1-ss*a),f=z0/g,p=(1-ss)/d,m=Yl*l**2,y=m*m,_=i/(f*j0),x=_*_,v=x*_,w=v*_,b=w*_,E=b*_,C=s-c/p*(x/2-w/24*(5+3*h+10*m-4*y-9*Yl))+E/720*(61+90*h+298*m+45*u-252*Yl-3*y);let S=(_-v/6*(1+2*h+m)+b/120*(5-2*m+28*h-3*y+8*Yl+24*u))/l;return S=rx(S+hl(ER(e.number)),-Math.PI,Math.PI),[GS(S),GS(C)]}const VS=-80,ZS=84,oN=-180,aN=180;function lN(r,t,e){r=rx(r,oN,aN),t<VS?t=VS:t>ZS&&(t=ZS);const i=hl(t),n=Math.sin(i),s=Math.cos(i),o=n/s,a=o*o,l=a*a,c=hl(r),h=ER(e.number),u=hl(h),d=z0/Math.sqrt(1-ss*n**2),g=Yl*s**2,f=s*rx(c-u,-Math.PI,Math.PI),p=f*f,m=p*f,y=m*f,_=y*f,x=_*f,v=z0*(kR*i-QF*Math.sin(2*i)+JF*Math.sin(4*i)-tN*Math.sin(6*i)),w=j0*d*(f+m/6*(1-a+g)+_/120*(5-18*a+l+72*g-58*Yl))+5e5;let b=j0*(v+d*o*(p/2+y/24*(5-a+9*g+4*g**2)+x/720*(61-58*a+l+600*g-330*Yl)));return e.north||(b+=1e7),[w,b]}function ER(r){return(r-1)*6-180+3}const cN=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function SR(r){let t=0;for(const n of cN){const s=r.match(n);if(s){t=parseInt(s[1]);break}}if(!t)return null;let e=0,i=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(i=!0,e=t-32600),e?{number:e,north:i}:null}function HS(r,t){return function(e,i,n,s){const o=e.length;n=n>1?n:2,s=s??n,i||(n>2?i=e.slice():i=new Array(o));for(let a=0;a<o;a+=s){const l=e[a],c=e[a+1],h=r(l,c,t);i[a]=h[0],i[a+1]=h[1]}return i}}function hN(r){return SR(r)?new Af({code:r,units:"m"}):null}function uN(r){const t=SR(r.getCode());return t?{forward:HS(lN,t),inverse:HS(sN,t)}:null}const dN=[uN],gN=[hN];let nx=!0;function fN(r){nx=!1}function $w(r,t){if(t!==void 0){for(let e=0,i=r.length;e<i;++e)t[e]=r[e];t=t}else t=r.slice();return t}function Lg(r){KF(r.getCode(),r),Rc(r,r,$w)}function pN(r){r.forEach(Lg)}function Wt(r){if(typeof r!="string")return r;const t=d0(r);if(t)return t;for(const e of gN){const i=e(r);if(i)return i}return null}function YS(r,t,e,i){r=Wt(r);let n;const s=r.getPointResolutionFunc();if(s)n=s(t,e);else{const o=r.getUnits();if(o=="degrees"&&!i||i=="degrees")n=t;else{const a=p1(r,Wt("EPSG:4326"));if(!a&&o!=="degrees")n=t*r.getMetersPerUnit();else{let c=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];c=a(c,c,2);const h=zS(c.slice(0,2),c.slice(2,4)),u=zS(c.slice(4,6),c.slice(6,8));n=(h+u)/2}const l=r.getMetersPerUnit();l!==void 0&&(n/=l)}}return n}function sx(r){pN(r),r.forEach(function(t){r.forEach(function(e){t!==e&&Rc(t,e,$w)})})}function mN(r,t,e,i){r.forEach(function(n){t.forEach(function(s){Rc(n,s,e),Rc(s,n,i)})})}function Gw(r,t){return r?typeof r=="string"?Wt(r):r:Wt(t)}function ox(r){return(function(t,e,i,n){const s=t.length;i=i!==void 0?i:2,n=n??i,e=e!==void 0?e:new Array(s);for(let o=0;o<s;o+=n){const a=r(t.slice(o,o+i)),l=a.length;for(let c=0,h=n;c<h;++c)e[o+c]=c>=l?t[o+c]:a[c]}return e})}function yN(r,t,e,i){const n=Wt(r),s=Wt(t);Rc(n,s,ox(e)),Rc(s,n,ox(i))}function ci(r,t){if(r===t)return!0;const e=r.getUnits()===t.getUnits();return(r.getCode()===t.getCode()||p1(r,t)===$w)&&e}function p1(r,t){const e=r.getCode(),i=t.getCode();let n=g0(e,i);if(n)return n;let s=null,o=null;for(const l of dN)s||(s=l(r)),o||(o=l(t));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)n=Xy(s.inverse,o.forward);else{const l=g0(e,a);l&&(n=Xy(l,o.forward))}else{const l=g0(a,i);l&&(n=Xy(s.inverse,l))}return n&&(Lg(r),Lg(t),Rc(r,t,n)),n}function Xy(r,t){return function(e,i,n,s){return i=r(e,i,n,s),t(i,i,n,s)}}function Ic(r,t){const e=Wt(r),i=Wt(t);return p1(e,i)}function Mu(r,t,e){const i=Ic(t,e);if(!i){const n=Wt(t).getCode(),s=Wt(e).getCode();throw new Error(`No transform available between ${n} and ${s}`)}return i(r,void 0,r.length)}function dc(r,t,e,i){const n=Ic(t,e);return jF(r,n,void 0,i)}let _N=null;function vN(){return _N}function ax(r,t){return r}function Oo(r,t){return nx&&!G0(r,[0,0])&&r[0]>=-180&&r[0]<=180&&r[1]>=-90&&r[1]<=90&&(nx=!1,yR("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),r}function jw(r,t){return r}function Ms(r,t){return r}function XS(r,t,e){return function(i){let n,s;if(r.canWrapX()){const o=r.getExtent(),a=Te(o);i=i.slice(0),s=xR(i,r,a),s&&(i[0]=i[0]-s*a),i[0]=dr(i[0],o[0],o[2]),i[1]=dr(i[1],o[1],o[3]),n=e(i)}else n=e(i);return s&&t.canWrapX()&&(n[0]+=s*Te(t.getExtent())),n}}function xN(){sx(qS),sx(US),mN(US,qS,ZF,HF)}xN();const zw=new Array(6);function Er(){return[1,0,0,1,0,0]}function lx(r){return m1(r,1,0,0,1,0,0)}function Yu(r,t){const e=r[0],i=r[1],n=r[2],s=r[3],o=r[4],a=r[5],l=t[0],c=t[1],h=t[2],u=t[3],d=t[4],g=t[5];return r[0]=e*l+n*c,r[1]=i*l+s*c,r[2]=e*h+n*u,r[3]=i*h+s*u,r[4]=e*d+n*g+o,r[5]=i*d+s*g+a,r}function m1(r,t,e,i,n,s,o){return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r[4]=s,r[5]=o,r}function q0(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r}function Ir(r,t){const e=t[0],i=t[1];return t[0]=r[0]*e+r[2]*i+r[4],t[1]=r[1]*e+r[3]*i+r[5],t}function wN(r,t){const e=Math.cos(t),i=Math.sin(t);return Yu(r,m1(zw,e,i,-i,e,0,0))}function Kd(r,t,e){return Yu(r,m1(zw,t,0,0,e,0,0))}function y1(r,t,e){return Yu(r,m1(zw,1,0,0,1,t,e))}function us(r,t,e,i,n,s,o,a){const l=Math.sin(s),c=Math.cos(s);return r[0]=i*c,r[1]=n*l,r[2]=-i*l,r[3]=n*c,r[4]=o*i*c-a*i*l+t,r[5]=o*n*l+a*n*c+e,r}function Pc(r,t){const e=bN(t);_e(e!==0,"Transformation matrix cannot be inverted");const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],l=t[5];return r[0]=o/e,r[1]=-n/e,r[2]=-s/e,r[3]=i/e,r[4]=(s*l-o*a)/e,r[5]=-(i*l-n*a)/e,r}function bN(r){return r[0]*r[3]-r[1]*r[2]}const kN=[1e5,1e5,1e5,1e5,2,2];function EN(r){return"matrix("+r.join(", ")+")"}function cx(r){return r.substring(7,r.length-1).split(",").map(parseFloat)}function SN(r,t){const e=cx(r),i=cx(t);for(let n=0;n<6;++n)if(Math.round((e[n]-i[n])*kN[n])!==0)return!1;return!0}function co(r,t,e,i,n,s,o){s=s||[],o=o||2;let a=0;for(let l=t;l<e;l+=i){const c=r[l],h=r[l+1];s[a++]=n[0]*c+n[2]*h+n[4],s[a++]=n[1]*c+n[3]*h+n[5];for(let u=2;u<o;u++)s[a++]=r[l+u]}return s&&s.length!=a&&(s.length=a),s}function TR(r,t,e,i,n,s,o){o=o||[];const a=Math.cos(n),l=Math.sin(n),c=s[0],h=s[1];let u=0;for(let d=t;d<e;d+=i){const g=r[d]-c,f=r[d+1]-h;o[u++]=c+g*a-f*l,o[u++]=h+g*l+f*a;for(let p=d+2;p<d+i;++p)o[u++]=r[p]}return o&&o.length!=u&&(o.length=u),o}function TN(r,t,e,i,n,s,o,a){a=a||[];const l=o[0],c=o[1];let h=0;for(let u=t;u<e;u+=i){const d=r[u]-l,g=r[u+1]-c;a[h++]=l+n*d,a[h++]=c+s*g;for(let f=u+2;f<u+i;++f)a[h++]=r[f]}return a&&a.length!=h&&(a.length=h),a}function CN(r,t,e,i,n,s,o){o=o||[];let a=0;for(let l=t;l<e;l+=i){o[a++]=r[l]+n,o[a++]=r[l+1]+s;for(let c=l+2;c<l+i;++c)o[a++]=r[c]}return o&&o.length!=a&&(o.length=a),o}const KS=Er(),MN=[NaN,NaN];class qw extends So{constructor(){super(),this.extent_=sn(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=cR((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return Qt()}closestPointXY(t,e,i,n){return Qt()}containsXY(t,e){return this.closestPointXY(t,e,MN,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return Qt()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Hu(e),this.extentRevision_=this.getRevision()}return $F(this.extent_,t)}rotate(t,e){Qt()}scale(t,e,i){Qt()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return Qt()}getType(){return Qt()}applyTransform(t){Qt()}intersectsExtent(t){return Qt()}translate(t,e){Qt()}transform(t,e){const i=Wt(t),n=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),c=i.getWorldExtent(),h=ti(c)/ti(l);us(KS,c[0],c[3],h,-h,0,0,0);const u=co(s,0,s.length,a,KS,o),d=Ic(i,e);return d?d(u,u,a):u}:Ic(i,e);return this.applyTransform(n),this}}class Wc extends qw{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Pw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return Qt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=QS(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){Qt()}setLayout(t,e,i){let n;if(t)n=QS(t);else{for(let s=0;s<i;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}n=e.length,t=Vc(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();TR(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=Ns(this.getExtent()));const n=this.getFlatCoordinates();if(n){const s=this.getStride();TN(n,0,n.length,s,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();CN(i,0,i.length,n,t,e,i),this.changed()}}}function Vc(r){let t;return r==2?t="XY":r==3?t="XYZ":r==4&&(t="XYZM"),t}function QS(r){let t;return r=="XY"?t=2:r=="XYZ"||r=="XYM"?t=3:r=="XYZM"&&(t=4),t}function RN(r,t,e){const i=r.getFlatCoordinates();if(!i)return null;const n=r.getStride();return co(i,0,i.length,n,t,e)}function CR(r,t,e,i){let n=0;const s=r[e-i],o=r[e-i+1];let a=0,l=0;for(;t<e;t+=i){const c=r[t]-s,h=r[t+1]-o;n+=l*c-a*h,a=c,l=h}return n/2}function MR(r,t,e,i){let n=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];n+=CR(r,t,a,i),t=a}return n}function IN(r,t,e,i){let n=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];n+=MR(r,t,a,i),t=a[a.length-1]}return n}function JS(r,t,e,i,n,s,o){const a=r[t],l=r[t+1],c=r[e]-a,h=r[e+1]-l;let u;if(c===0&&h===0)u=t;else{const d=((n-a)*c+(s-l)*h)/(c*c+h*h);if(d>1)u=e;else if(d>0){for(let g=0;g<i;++g)o[g]=In(r[t+g],r[e+g],d);o.length=i;return}else u=t}for(let d=0;d<i;++d)o[d]=r[u+d];o.length=i}function Bw(r,t,e,i,n){let s=r[t],o=r[t+1];for(t+=i;t<e;t+=i){const a=r[t],l=r[t+1],c=hc(s,o,a,l);c>n&&(n=c),s=a,o=l}return n}function Uw(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){const a=e[s];n=Bw(r,t,a,i,n),t=a}return n}function PN(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){const a=e[s];n=Uw(r,t,a,i,n),t=a[a.length-1]}return n}function Ww(r,t,e,i,n,s,o,a,l,c,h){if(t==e)return c;let u,d;if(n===0){if(d=hc(o,a,r[t],r[t+1]),d<c){for(u=0;u<i;++u)l[u]=r[t+u];return l.length=i,d}return c}h=h||[NaN,NaN];let g=t+i;for(;g<e;)if(JS(r,g-i,g,i,o,a,h),d=hc(o,a,h[0],h[1]),d<c){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i,g+=i}else g+=i*Math.max((Math.sqrt(d)-Math.sqrt(c))/n|0,1);if(s&&(JS(r,e-i,t,i,o,a,h),d=hc(o,a,h[0],h[1]),d<c)){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i}return c}function Vw(r,t,e,i,n,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const g=e[u];c=Ww(r,t,g,i,n,s,o,a,l,c,h),t=g}return c}function AN(r,t,e,i,n,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const g=e[u];c=Vw(r,t,g,i,n,s,o,a,l,c,h),t=g[g.length-1]}return c}function LN(r,t,e,i){for(let n=0,s=e.length;n<s;++n)r[t++]=e[n];return t}function _1(r,t,e,i){for(let n=0,s=e.length;n<s;++n){const o=e[n];for(let a=0;a<i;++a)r[t++]=o[a]}return t}function Of(r,t,e,i,n){n=n||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=_1(r,t,e[o],i);n[s++]=l,t=l}return n.length=s,n}function RR(r,t,e,i,n){n=n||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=Of(r,t,e[o],i,n[s]);l.length===0&&(l[0]=t),n[s++]=l,t=l[l.length-1]}return n.length=s,n}function Xa(r,t,e,i,n){n=n!==void 0?n:[];let s=0;for(let o=t;o<e;o+=i)n[s++]=r.slice(o,o+i);return n.length=s,n}function Og(r,t,e,i,n){n=n!==void 0?n:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];n[s++]=Xa(r,t,l,i,n[s]),t=l}return n.length=s,n}function hx(r,t,e,i,n){n=n!==void 0?n:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];n[s++]=l.length===1&&l[0]===t?[]:Og(r,t,l,i,n[s]),t=l[l.length-1]}return n.length=s,n}function v1(r,t,e,i,n,s,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)s[o++]=r[t],s[o++]=r[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[t,e-i];let h=0;for(;c.length>0;){const u=c.pop(),d=c.pop();let g=0;const f=r[d],p=r[d+1],m=r[u],y=r[u+1];for(let _=d+i;_<u;_+=i){const x=r[_],v=r[_+1],w=zF(x,v,f,p,m,y);w>g&&(h=_,g=w)}g>n&&(l[(h-t)/i]=1,d+i<h&&c.push(d,h),h+i<u&&c.push(h,u))}for(let u=0;u<a;++u)l[u]&&(s[o++]=r[t+u*i],s[o++]=r[t+u*i+1]);return o}function IR(r,t,e,i,n,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=v1(r,t,h,i,n,s,o),a.push(o),t=h}return o}function zl(r,t){return t*Math.round(r/t)}function ON(r,t,e,i,n,s,o){if(t==e)return o;let a=zl(r[t],n),l=zl(r[t+1],n);t+=i,s[o++]=a,s[o++]=l;let c,h;do if(c=zl(r[t],n),h=zl(r[t+1],n),t+=i,t==e)return s[o++]=c,s[o++]=h,o;while(c==a&&h==l);for(;t<e;){const u=zl(r[t],n),d=zl(r[t+1],n);if(t+=i,u==c&&d==h)continue;const g=c-a,f=h-l,p=u-a,m=d-l;if(g*m==f*p&&(g<0&&p<g||g==p||g>0&&p>g)&&(f<0&&m<f||f==m||f>0&&m>f)){c=u,h=d;continue}s[o++]=c,s[o++]=h,a=c,l=h,c=u,h=d}return s[o++]=c,s[o++]=h,o}function Zw(r,t,e,i,n,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=ON(r,t,h,i,n,s,o),a.push(o),t=h}return o}function FN(r,t,e,i,n,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l],u=[];o=Zw(r,t,h,i,n,s,o,u),a.push(u),t=h[h.length-1]}return o}let ux=class dx extends Wc{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new dx(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<Uc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Bw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ww(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return CR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Xa(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=v1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new dx(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_1(this.flatCoordinates,0,t,this.stride),this.changed()}},xl=class PR extends Wc{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new PR(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const s=this.flatCoordinates,o=hc(t,e,s[0],s[1]);if(o<n){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Iw(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Rw(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=LN(this.flatCoordinates,0,t,this.stride),this.changed()}};function NN(r,t,e,i,n){return!fR(n,function(s){return!Xl(r,t,e,i,s[0],s[1])})}function Xl(r,t,e,i,n,s){let o=0,a=r[e-i],l=r[e-i+1];for(;t<e;t+=i){const c=r[t],h=r[t+1];l<=s?h>s&&(c-a)*(s-l)-(n-a)*(h-l)>0&&o++:h<=s&&(c-a)*(s-l)-(n-a)*(h-l)<0&&o--,a=c,l=h}return o!==0}function Hw(r,t,e,i,n,s){if(e.length===0||!Xl(r,t,e[0],i,n,s))return!1;for(let o=1,a=e.length;o<a;++o)if(Xl(r,e[o-1],e[o],i,n,s))return!1;return!0}function DN(r,t,e,i,n,s){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const l=e[o];if(Hw(r,t,l,i,n,s))return!0;t=l[l.length-1]}return!1}function Yw(r,t,e,i,n,s,o){let a,l,c,h,u,d,g;const f=n[s+1],p=[];for(let _=0,x=e.length;_<x;++_){const v=e[_];for(h=r[v-i],d=r[v-i+1],a=t;a<v;a+=i)u=r[a],g=r[a+1],(f<=d&&g<=f||d<=f&&f<=g)&&(c=(f-d)/(g-d)*(u-h)+h,p.push(c)),h=u,d=g}let m=NaN,y=-1/0;for(p.sort(lo),h=p[0],a=1,l=p.length;a<l;++a){u=p[a];const _=Math.abs(u-h);_>y&&(c=(h+u)/2,Hw(r,t,e,i,c,f)&&(m=c,y=_)),h=u}return isNaN(m)&&(m=n[s]),o?(o.push(m,f,y),o):[m,f,y]}function AR(r,t,e,i,n){let s=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];s=Yw(r,t,l,i,n,2*o,s),t=l[l.length-1]}return s}function LR(r,t,e,i,n){let s;for(t+=i;t<e;t+=i)if(s=n(r.slice(t-i,t),r.slice(t,t+i)),s)return s;return!1}function x1(r,t,e,i,n,s){return s=s??gR(sn(),r,t,e,i),zr(n,s)?s[0]>=n[0]&&s[2]<=n[2]||s[1]>=n[1]&&s[3]<=n[3]?!0:LR(r,t,e,i,function(o,a){return GF(n,o,a)}):!1}function $N(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){if(x1(r,t,e[s],i,n))return!0;t=e[s]}return!1}function OR(r,t,e,i,n){return!!(x1(r,t,e,i,n)||Xl(r,t,e,i,n[0],n[1])||Xl(r,t,e,i,n[0],n[3])||Xl(r,t,e,i,n[2],n[1])||Xl(r,t,e,i,n[2],n[3]))}function FR(r,t,e,i,n){if(!OR(r,t,e[0],i,n))return!1;if(e.length===1)return!0;for(let s=1,o=e.length;s<o;++s)if(NN(r,e[s-1],e[s],i,n)&&!x1(r,e[s-1],e[s],i,n))return!1;return!0}function GN(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(FR(r,t,a,i,n))return!0;t=a[a.length-1]}return!1}function jN(r,t,e,i){for(;t<e-i;){for(let n=0;n<i;++n){const s=r[t+n];r[t+n]=r[e-i+n],r[e-i+n]=s}t+=i,e-=i}}function Xw(r,t,e,i){let n=0,s=r[e-i],o=r[e-i+1];for(;t<e;t+=i){const a=r[t],l=r[t+1];n+=(a-s)*(l+o),s=a,o=l}return n===0?void 0:n>0}function Kw(r,t,e,i,n){n=n!==void 0?n:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=Xw(r,t,a,i);if(s===0){if(n&&l||!n&&!l)return!1}else if(n&&!l||!n&&l)return!1;t=a}return!0}function NR(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!Kw(r,t,a,i,n))return!1;a.length&&(t=a[a.length-1])}return!0}function B0(r,t,e,i,n){n=n!==void 0?n:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=Xw(r,t,a,i);(s===0?n&&l||!n&&!l:n&&!l||!n&&l)&&jN(r,t,a,i),t=a}return t}function gx(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s)t=B0(r,t,e[s],i,n);return t}function Qw(r,t){const e=[];let i=0,n=0,s;for(let o=0,a=t.length;o<a;++o){const l=t[o],c=Xw(r,i,l,2);if(s===void 0&&(s=c),c===s)e.push(t.slice(n,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[n])}n=o+1,i=l}return e}let ia=class fx extends Wc{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?en(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new fx(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Uc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Uw(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Vw(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return Hw(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return MR(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),B0(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Og(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Ns(this.getExtent());this.flatInteriorPoint_=Yw(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new xl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new ux(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=new ux(e.slice(s,l),t);n.push(c),s=l}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Kw(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=B0(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Zw(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new fx(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return FR(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Of(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}};function tT(r){if(fa(r))throw new Error("Cannot create polygon from empty extent");const t=r[0],e=r[1],i=r[2],n=r[3],s=[t,e,t,n,i,n,i,e,t,e];return new ia(s,"XY",[s.length])}function U0(r,t,e,i,n,s,o){let a,l;const c=(e-t)/i;if(c===1)a=t;else if(c===2)a=t,l=n;else if(c!==0){let h=r[t],u=r[t+1],d=0;const g=[0];for(let m=t+i;m<e;m+=i){const y=r[m],_=r[m+1];d+=Math.sqrt((y-h)*(y-h)+(_-u)*(_-u)),g.push(d),h=y,u=_}const f=n*d,p=RF(g,f);p<0?(l=(f-g[-p-2])/(g[-p-1]-g[-p-2]),a=t+(-p-2)*i):a=t+p*i}o=o>1?o:2,s=s||new Array(o);for(let h=0;h<o;++h)s[h]=a===void 0?NaN:l===void 0?r[a+h]:In(r[a+h],r[a+i+h],l);return s}function px(r,t,e,i,n,s){if(e==t)return null;let o;if(n<r[t+i-1])return s?(o=r.slice(t,t+i),o[i-1]=n,o):null;if(r[e-1]<n)return s?(o=r.slice(e-i,e),o[i-1]=n,o):null;if(n==r[t+i-1])return r.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const d=a+l>>1;n<r[(d+1)*i-1]?l=d:a=d+1}const c=r[a*i-1];if(n==c)return r.slice((a-1)*i,(a-1)*i+i);const h=r[(a+1)*i-1],u=(n-c)/(h-c);o=[];for(let d=0;d<i-1;++d)o.push(In(r[(a-1)*i+d],r[a*i+d],u));return o.push(n),o}function zN(r,t,e,i,n,s,o){if(o)return px(r,t,e[e.length-1],i,n,s);let a;if(n<r[i-1])return s?(a=r.slice(0,i),a[i-1]=n,a):null;if(r[r.length-1]<n)return s?(a=r.slice(r.length-i),a[i-1]=n,a):null;for(let l=0,c=e.length;l<c;++l){const h=e[l];if(t!=h){if(n<r[t+i-1])return null;if(n<=r[h-1])return px(r,t,h,i,n,!1);t=h}}return null}function Jw(r,t,e,i){let n=r[t],s=r[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=r[a],c=r[a+1];o+=Math.sqrt((l-n)*(l-n)+(c-s)*(c-s)),n=l,s=c}return o}const yi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Ac=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",qN=Ac.includes("safari")&&!Ac.includes("chrom"),BN=qN&&(Ac.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Ac)),UN=Ac.includes("webkit")&&!Ac.includes("edge"),DR=Ac.includes("macintosh"),$R=typeof devicePixelRatio<"u"?devicePixelRatio:1,Yn=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,tb=typeof Image<"u"&&Image.prototype.decode,GR=typeof createImageBitmap=="function",jR=(function(){let r=!1;try{const t=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return r})(),Nt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Hr(r,t,e,i){let n;return e&&e.length?n=e.shift():Yn?n=new class extends OffscreenCanvas{style={}}(r??300,t??150):n=document.createElement("canvas"),r&&(n.width=r),t&&(n.height=t),n.getContext("2d",i)}let Ky;function W0(){return Ky||(Ky=Hr(1,1)),Ky}function Ff(r){const t=r.canvas;t.width=1,t.height=1,r.clearRect(0,0,1,1)}function eT(r,t){const e=t.parentNode;e&&e.replaceChild(r,t)}function WN(r){for(;r.lastChild;)r.lastChild.remove()}function VN(r,t){const e=r.childNodes;for(let i=0;;++i){const n=e[i],s=t[i];if(!n&&!s)break;if(n!==s){if(!n){r.appendChild(s);continue}if(!s){r.removeChild(n),--i;continue}r.insertBefore(s,n)}}}function zR(){return new Proxy({childNodes:[],appendChild:function(r){return this.childNodes.push(r),r},remove:function(){},removeChild:function(r){const t=this.childNodes.indexOf(r);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),r},insertBefore:function(r,t){const e=this.childNodes.indexOf(t);if(e===-1)throw new Error("Reference node not found");return this.childNodes.splice(e,0,r),r},style:{}},{get(r,t,e){return t==="firstElementChild"?r.childNodes.length>0?r.childNodes[0]:null:Reflect.get(r,t,e)}})}function Ka(r){return typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas}const eb=[NaN,NaN,NaN,0];let Qy;function ZN(){return Qy||(Qy=Hr(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Qy}const HN=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,YN=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,XN=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,KN=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function _p(r,t){return r.endsWith("%")?Number(r.substring(0,r.length-1))/t:Number(r)}function Qd(r){throw new Error('failed to parse "'+r+'" as color')}function qR(r){if(r.toLowerCase().startsWith("rgb")){const s=r.match(YN)||r.match(HN)||r.match(XN);if(s){const o=s[4],a=100/255;return[dr(_p(s[1],a)+.5|0,0,255),dr(_p(s[2],a)+.5|0,0,255),dr(_p(s[3],a)+.5|0,0,255),o!==void 0?dr(_p(o,100),0,1):1]}Qd(r)}if(r.startsWith("#")){if(KN.test(r)){const s=r.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let h=parseInt(s.substring(l,l+o),16);o===1&&(h+=h<<4),a[l/o]=h}return a[3]=a[3]/255,a}Qd(r)}const t=ZN();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=r,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=r,t.fillStyle===e&&Qd(r));const i=t.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return qR(i);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const n=Array.from(t.getImageData(0,0,1,1).data);return n[3]=Pf(n[3]/255,3),n}function QN(r){return typeof r=="string"?r:ib(r)}const JN=1024,vd={};let Jy=0;function tD(r){if(r.length===4)return r;const t=r.slice();return t[3]=1,t}function t_(r){return r>.0031308?Math.pow(r,1/2.4)*269.025-14.025:r*3294.6}function e_(r){return r>.2068965?Math.pow(r,3):(r-4/29)*(108/841)}function r_(r){return r>10.314724?Math.pow((r+14.025)/269.025,2.4):r/3294.6}function i_(r){return r>.0088564?Math.pow(r,1/3):r/(108/841)+4/29}function rT(r){const t=r_(r[0]),e=r_(r[1]),i=r_(r[2]),n=i_(t*.222488403+e*.716873169+i*.06060791),s=500*(i_(t*.452247074+e*.399439023+i*.148375274)-n),o=200*(n-i_(t*.016863605+e*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*n-16,Math.sqrt(s*s+o*o),a<0?a+360:a,r[3]]}function eD(r){const t=(r[0]+16)/116,e=r[1],i=r[2]*Math.PI/180,n=e_(t),s=e_(t+e/500*Math.cos(i)),o=e_(t-e/200*Math.sin(i)),a=t_(s*3.021973625-n*1.617392459-o*.404875592),l=t_(s*-.943766287+n*1.916279586+o*.027607165),c=t_(s*.069407491-n*.22898585+o*1.159737864);return[dr(a+.5|0,0,255),dr(l+.5|0,0,255),dr(c+.5|0,0,255),r[3]]}function rb(r){if(r==="none")return eb;if(vd.hasOwnProperty(r))return vd[r];if(Jy>=JN){let e=0;for(const i in vd)(e++&3)===0&&(delete vd[i],--Jy)}const t=qR(r);t.length!==4&&Qd(r);for(const e of t)isNaN(e)&&Qd(r);return vd[r]=t,++Jy,t}function ds(r){return Array.isArray(r)?r:rb(r)}function ib(r){let t=r[0];t!=(t|0)&&(t=t+.5|0);let e=r[1];e!=(e|0)&&(e=e+.5|0);let i=r[2];i!=(i|0)&&(i=i+.5|0);const n=r[3]===void 0?1:Math.round(r[3]*1e3)/1e3;return"rgba("+t+","+e+","+i+","+n+")"}let nb=class extends Zu{constructor(t,e,i,n){super(),this.extent=t,this.pixelRatio_=i,this.resolution=e,this.state=typeof n=="function"?Nt.IDLE:n,this.image_=null,this.loader=typeof n=="function"?n:null}changed(){this.dispatchEvent(Bt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Nt.IDLE&&this.loader){this.state=Nt.LOADING,this.changed();const t=this.getResolution(),e=Array.isArray(t)?t[0]:t;hR(()=>this.loader(this.getExtent(),e,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||GR&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=Nt.LOADED}).catch(i=>{this.state=Nt.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}};function rD(r,t,e){const i=r;let n=!0,s=!1,o=!1;const a=[$0(i,Bt.LOAD,function(){o=!0,s||t()})];return i.src&&tb?(s=!0,i.decode().then(function(){n&&t()}).catch(function(l){n&&(o?t():e())})):a.push($0(i,Bt.ERROR,e)),function(){n=!1,a.forEach(or)}}function iD(r,t){return new Promise((e,i)=>{function n(){o(),e(r)}function s(){o(),i(new Error("Image load error"))}function o(){r.removeEventListener("load",n),r.removeEventListener("error",s)}r.addEventListener("load",n),r.addEventListener("error",s)})}function BR(r,t){return t&&(r.src=t),r.src&&tb?new Promise((e,i)=>r.decode().then(()=>e(r)).catch(n=>r.complete&&r.width?e(r):i(n))):iD(r)}function w1(r,t){return t&&(r.src=t),r.src&&tb&&GR?r.decode().then(()=>createImageBitmap(r)).catch(e=>{if(r.complete&&r.width)return r;throw e}):BR(r)}let nD=class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];(t++&3)===0&&!i.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e){const i=n_(t,e);return i in this.cache_?this.cache_[i]:null}getPattern(t,e){const i=n_(t,e);return i in this.patternCache_?this.patternCache_[i]:null}set(t,e,i,n){const s=n_(t,e),o=s in this.cache_;this.cache_[s]=i,n&&(i.getImageState()===Nt.IDLE&&i.load(),i.getImageState()===Nt.LOADING?i.ready().then(()=>{this.patternCache_[s]=W0().createPattern(i.getImage(1),"repeat")}):this.patternCache_[s]=W0().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};function n_(r,t){const e=t?ds(t):"null";return r+":"+e}const Xn=new nD;let xd=null;class UR extends Zu{constructor(t,e,i,n,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i?.crossOrigin,this.referrerPolicy_=i?.referrerPolicy,this.canvas_={},this.color_=s,this.imageState_=n===void 0?Nt.IDLE:n,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_),this.referrerPolicy_!==void 0&&(this.image_.referrerPolicy=this.referrerPolicy_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Nt.LOADED){xd||(xd=Hr(1,1,void 0,{willReadFrequently:!0})),xd.drawImage(this.image_,0,0);try{xd.getImageData(0,0,1,1),this.tainted_=!1}catch{xd=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Bt.CHANGE)}handleImageError_(){this.imageState_=Nt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Nt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}setImage(t){this.image_=t}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Hr(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Nt.IDLE){this.image_||this.initializeImage_(),this.imageState_=Nt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&BR(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==Nt.LOADED)return;const e=this.image_,i=Hr(Math.ceil(e.width*t),Math.ceil(e.height*t)),n=i.canvas;i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=QN(this.color_),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=n}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===Nt.LOADED||this.imageState_===Nt.ERROR)t();else{const e=()=>{(this.imageState_===Nt.LOADED||this.imageState_===Nt.ERROR)&&(this.removeEventListener(Bt.CHANGE,e),t())};this.addEventListener(Bt.CHANGE,e)}})),this.ready_}}function Jd(r,t,e,i,n,s){let o=t===void 0?void 0:Xn.get(t,n);return o||(o=new UR(r,r&&"src"in r?r.src||void 0:t,e,i,n),Xn.set(t,n,o,s)),s&&o&&!Xn.getPattern(t,n)&&Xn.set(t,n,o,s),o}function io(r){return r?Array.isArray(r)?ib(r):typeof r=="object"&&"src"in r?sD(r):r:null}function sD(r){if(!r.offset||!r.size)return Xn.getPattern(r.src,r.color);const t=r.src+":"+r.offset,e=Xn.getPattern(t,r.color);if(e)return e;const i=Xn.get(r.src,null);if(i.getImageState()!==Nt.LOADED)return null;const n=Hr(r.size[0],r.size[1]);return n.drawImage(i.getImage(1),r.offset[0],r.offset[1],r.size[0],r.size[1],0,0,r.size[0],r.size[1]),Jd(n.canvas,t,void 0,Nt.LOADED,r.color,!0),Xn.getPattern(t,r.color)}function oD(r,t,e,i,n,s){n=n??[],s=s??t;const o=r[0],a=r[1],l=r[r.length-4],c=r[r.length-3];let h,u,d,g,f,p,m,y,_=0;for(let x=0;x<r.length;x+=t){d=h,g=u,f=void 0,p=void 0,x+t<r.length&&(f=r[x+t],p=r[x+t+1]),i&&x===0&&(d=l,g=c),i&&x===r.length-2&&(f=o,p=a),h=r[x],u=r[x+1],[m,y]=f0(h,u,d,g,f,p,e),n[_++]=m,n[_++]=y;for(let v=2;v<s;v++)n[_++]=r[x+v]}return n.length!=_&&(n.length=_),n}function f0(r,t,e,i,n,s,o){let a,l;e!==void 0&&i!==void 0?(a=r-e,l=t-i):n!==void 0&&s!==void 0?(a=n-r,l=s-t):(a=1,l=0);const c=Math.hypot(a,l),h=a/c,u=l/c;if(a=-u,l=h,e===void 0||i===void 0)return[r+a*o,t+l*o];if(n===void 0||s===void 0)return[r+a*o,t+l*o];const d=UF([r,t],[e,i],[n,s]);if(Math.cos(d)>.998)return[r+h*o,t+u*o];const g=Math.cos(d/2),f=Math.sin(d/2),p=f*a+g*l,m=-g*a+f*l,y=p*(1/f),_=m*(1/f);return[r+y*o,t+_*o]}class WR{drawCustom(t,e,i,n,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const vp="ol-hidden",b1="ol-unselectable",sb="ol-control",iT="ol-collapsed",aD=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),nT=["style","variant","weight","size","lineHeight","family"],mx={normal:400,bold:700},yx=function(r){const t=r.match(aD);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,n=nT.length;i<n;++i){const s=t[i+1];s!==void 0&&(e[nT[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(e.weight))&&e.weight in mx&&(e.weight=mx[e.weight]),e.families=e.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),e},VR="10px sans-serif",dn="#000",Ru="round",Xo=[],Ko=0,Iu="round",Fg=10,lD=0,Ng="#000",Dg="center",V0="middle",Kl=[0,0,0,0],$g=1,Th=new So;let wd=null,sT;const _x={},cD=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function hD(r,t,e){return`${r} ${t} 16px "${e}"`}const uD=(function(){let r,t;async function e(n){await t.ready;const s=await t.load(n);if(s.length===0)return!1;const o=yx(n),a=o.families[0].toLowerCase(),l=o.weight;return s.some(c=>{const h=c.family.replace(/^['"]|['"]$/g,"").toLowerCase(),u=mx[c.weight]||c.weight;return h===a&&c.style===o.style&&u==l})}async function i(){await t.ready;let n=!0;const s=Th.getProperties(),o=Object.keys(s).filter(a=>s[a]<100);for(let a=o.length-1;a>=0;--a){const l=o[a];let c=s[l];c<100&&(await e(l)?(Vu(_x),Th.set(l,100)):(c+=10,Th.set(l,c,!0),c<100&&(n=!1)))}r=void 0,n||(r=setTimeout(i,100))}return async function(n){t||(t=Yn?self.fonts:document.fonts);const s=yx(n);if(!s)return;const o=s.families;let a=!1;for(const l of o){if(cD.has(l))continue;const c=hD(s.style,s.weight,l);Th.get(c)===void 0&&(Th.set(c,0,!0),a=!0)}a&&(clearTimeout(r),r=setTimeout(i,100))}})(),dD=(function(){let r;return function(t){let e=_x[t];if(e==null){if(Yn){const i=yx(t),n=ZR(t,"Å½g");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else r||(r=document.createElement("div"),r.innerHTML="M",r.style.minHeight="0",r.style.maxHeight="none",r.style.height="auto",r.style.padding="0",r.style.border="none",r.style.position="absolute",r.style.display="block",r.style.left="-99999px"),r.style.font=t,document.body.appendChild(r),e=r.offsetHeight,document.body.removeChild(r);_x[t]=e}return e}})();function ZR(r,t){return wd||(wd=Hr(1,1)),r!=sT&&(wd.font=r,sT=wd.font),wd.measureText(t)}function HR(r,t){return ZR(r,t).width}function oT(r,t,e){if(t in e)return e[t];const i=t.split(`
`).reduce((n,s)=>Math.max(n,HR(r,s)),0);return e[t]=i,i}function gD(r,t){const e=[],i=[],n=[];let s=0,o=0,a=0,l=0;for(let c=0,h=t.length;c<=h;c+=2){const u=t[c];if(u===`
`||c===h){s=Math.max(s,o),n.push(o),o=0,a+=l,l=0;continue}const d=t[c+1]||r.font,g=HR(d,u);e.push(g),o+=g;const f=dD(d);i.push(f),l=Math.max(l,f)}return{width:s,height:a,widths:e,heights:i,lineWidths:n}}function fD(r,t,e,i,n,s,o,a,l,c,h){r.save(),e!==1&&(r.globalAlpha===void 0?r.globalAlpha=u=>u.globalAlpha*=e:r.globalAlpha*=e),t&&r.transform.apply(r,t),i.contextInstructions?(r.translate(l,c),r.scale(h[0],h[1]),pD(i,r)):h[0]<0||h[1]<0?(r.translate(l,c),r.scale(h[0],h[1]),r.drawImage(i,n,s,o,a,0,0,o,a)):r.drawImage(i,n,s,o,a,l,c,o*h[0],a*h[1]),r.restore()}function pD(r,t){const e=r.contextInstructions;for(let i=0,n=e.length;i<n;i+=2)Array.isArray(e[i+1])?t[e[i]].apply(t,e[i+1]):t[e[i]]=e[i+1]}let mD=class extends WR{constructor(t,e,i,n,s,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?Pf(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Er()}drawImages_(t,e,i,n){if(!this.image_)return;const s=co(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,u=s.length;h<u;h+=2){const d=s[h]-this.imageAnchorX_,g=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const f=d+this.imageAnchorX_,p=g+this.imageAnchorY_;us(a,f,p,1,1,c,-f,-p),o.save(),o.transform.apply(o,a),o.translate(f,p),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,i,n){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=co(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=n){const l=s[e]+this.textOffsetX_,c=s[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(t,e,i,n,s,o){const a=this.context_;let l=co(t,e,i,n,this.transform_,this.pixelCoordinates_);Math.abs(o)>0&&(l=oD(l,n,o,s,l)),a.moveTo(l[0],l[1]);let c=l.length;s&&(c-=2);for(let h=2;h<c;h+=2)a.lineTo(l[h],l[h+1]);return s&&a.closePath(),i}drawRings_(t,e,i,n,s){for(let o=0,a=i.length;o<a;++o)e=this.moveToLineTo_(t,e,i[o],n,!0,s);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!zr(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=RN(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],s=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!zr(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1,this.strokeState_.strokeOffset),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(zr(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,n=t.getFlatCoordinates();let s=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(n,s,o[l],a,!1,this.strokeState_.strokeOffset);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!zr(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride(),this.strokeState_?.strokeOffset),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!zr(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const s=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];n=this.drawRings_(i,n,c,o,this.strokeState_?.strokeOffset)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),ga(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Dg;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:io(i||dn)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),n=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),h=s||Xo,u=e.getOffset();this.strokeState_={lineCap:n!==void 0?n:Ru,lineDash:this.pixelRatio_===1?h:h.map(d=>d*this.pixelRatio_),lineDashOffset:(o||Ko)*this.pixelRatio_,lineJoin:a!==void 0?a:Iu,lineWidth:(l!==void 0?l:$g)*this.pixelRatio_,miterLimit:c!==void 0?c:Fg,strokeStyle:io(i||Ng),strokeOffset:(u??0)*this.pixelRatio_}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const g=e.getColor();this.textFillState_={fillStyle:io(g||dn)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const g=i.getColor(),f=i.getLineCap(),p=i.getLineDash(),m=i.getLineDashOffset(),y=i.getLineJoin(),_=i.getWidth(),x=i.getMiterLimit();this.textStrokeState_={lineCap:f!==void 0?f:Ru,lineDash:p||Xo,lineDashOffset:m||Ko,lineJoin:y!==void 0?y:Iu,lineWidth:_!==void 0?_:$g,miterLimit:x!==void 0?x:Fg,strokeStyle:io(g||Ng)}}const n=t.getFont(),s=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),c=t.getScaleArray(),h=t.getText(),u=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:n!==void 0?n:VR,textAlign:u!==void 0?u:Dg,textBaseline:d!==void 0?d:V0},this.text_=h!==void 0?Array.isArray(h)?h.reduce((g,f,p)=>g+=p%2?" ":f,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}};const yD=.5,YR={Point:SD,LineString:bD,Polygon:CD,MultiPoint:TD,MultiLineString:kD,MultiPolygon:ED,GeometryCollection:wD,Circle:vD};function _D(r,t){return parseInt(Rt(r),10)-parseInt(Rt(t),10)}function vx(r,t){const e=XR(r,t);return e*e}function XR(r,t){return yD*r/t}function vD(r,t,e,i,n){const s=e.getFill(),o=e.getStroke();if(s||o){const l=r.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=r.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i)}}function Z0(r,t,e,i,n,s,o,a){const l=[],c=e.getImage();if(c){let d=!0;const g=c.getImageState();g==Nt.LOADED||g==Nt.ERROR?d=!1:g==Nt.IDLE&&c.load(),d&&l.push(c.ready())}const h=e.getFill();h&&h.loading()&&l.push(h.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>n(null)),xD(r,t,e,i,s,o,a),u}function xD(r,t,e,i,n,s,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(i,n);if(e.getRenderer())KR(r,l,e,t,o);else{const c=YR[l.getType()];c(r,l,e,t,o,s)}}function KR(r,t,e,i,n){if(t.getType()=="GeometryCollection"){const s=t.getGeometries();for(let o=0,a=s.length;o<a;++o)KR(r,s[o],e,i,n);return}r.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),n)}function wD(r,t,e,i,n,s){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=YR[o[a].getType()];c(r,o[a],e,i,n,s)}}function bD(r,t,e,i,n){const s=e.getStroke();if(s){const a=r.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=r.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function kD(r,t,e,i,n){const s=e.getStroke();if(s){const a=r.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=r.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function ED(r,t,e,i,n){const s=e.getFill(),o=e.getStroke();if(o||s){const l=r.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=r.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}function SD(r,t,e,i,n,s){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=Nt.LOADED)return;const h=r.getBuilder(e.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(t,i,n)}if(l){const h=r.getBuilder(e.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(t,i,n)}}function TD(r,t,e,i,n,s){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),c=l&&l.getText(),h=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=Nt.LOADED)return;const u=r.getBuilder(e.getZIndex(),"Image");u.setImageStyle(o,h),u.drawMultiPoint(t,i,n)}if(c){const u=r.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l,h),u.drawText(t,i,n)}}function CD(r,t,e,i,n){const s=e.getFill(),o=e.getStroke();if(s||o){const l=r.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=r.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}function QR(r,t,e,i){const n=[];let s=sn();for(let o=0,a=e.length;o<a;++o){const l=e[o];s=Pw(r,t,l[0],i),n.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=l[l.length-1]}return n}const aT=Er();let Pn=class xx{constructor(t,e,i,n,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Iw(this.flatCoordinates_):Pw(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=Ns(this.getExtent());this.flatInteriorPoints_=Yw(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=Qw(this.flatCoordinates_,this.ends_),e=QR(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=AR(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=U0(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,s=i.length;n<s;++n){const o=i[n],a=U0(t,e,o,2,.5);en(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=Wt(t);const e=t.getExtent(),i=t.getWorldExtent();if(e&&i){const n=ti(i)/ti(e);us(aT,i[0],i[3],n,-n,0,0,0),co(this.flatCoordinates_,0,this.flatCoordinates_.length,2,aT,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new xx(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=cR((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=v1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=IR(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=Zw(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n);break}return n&&(this.simplifiedGeometry_=new xx(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}};Pn.prototype.getFlatCoordinates=Pn.prototype.getOrientedFlatCoordinates;const Ni={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};let Ds=class JR{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new JR({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=Jd(null,t.src,{crossOrigin:"anonymous"},void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===Nt.IDLE&&e.load(),e.getImageState()===Nt.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?Rt(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:ds(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}},vo=class t4{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.offset_=t.offset,this.width_=t.width}clone(){const t=this.getColor();return new t4({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),offset:this.getOffset(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getOffset(){return this.offset_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setOffset(t){this.offset_=t}setWidth(t){this.width_=t}};function lT(r){return r[0]>0&&r[1]>0}function MD(r,t,e){return e===void 0&&(e=[0,0]),e[0]=r[0]*t+.5|0,e[1]=r[1]*t+.5|0,e}function _i(r,t){return Array.isArray(r)?r:(t===void 0?t=[r,r]:(t[0]=r,t[1]=r),t)}let e4=class r4{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=_i(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new r4({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Qt()}getImage(t){return Qt()}getHitDetectionImage(){return Qt()}getPixelRatio(t){return 1}getImageState(){return Qt()}getImageSize(){return Qt()}getOrigin(){return Qt()}getSize(){return Qt()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=_i(t)}listenImageChange(t){Qt()}load(){Qt()}unlistenImageChange(t){Qt()}ready(){return Promise.resolve()}},ob=class i4 extends e4{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Nt.LOADING:Nt.LOADED,this.imageState_===Nt.LOADING&&this.ready().then(()=>this.imageState_=Nt.LOADED),this.render()}clone(){const t=this.getScale(),e=new i4({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){const e=this.fill_?.getKey(),i=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let n=Xn.get(i,null)?.getImage(1);if(!n){const s=this.renderOptions_,o=Math.ceil(s.size*t),a=Hr(o,o);this.draw_(s,a,t),n=a.canvas;const l=new UR(n,void 0,null,Nt.LOADED,null);Xn.set(i,null,l),createImageBitmap(n).then(c=>{l.setImage(c)})}return n}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}setRadius(t){this.radius!==t&&(this.radius=t,this.render())}getRadius2(){return this.radius2_}setRadius2(t){this.radius2_!==t&&(this.radius2_=t,this.render())}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let n=this.radius,s=this.radius2_===void 0?n:this.radius2_;if(n<s){const v=n;n=s,s=v}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),h=n-c,u=Math.sqrt(l*l+h*h),d=u/l;if(t==="miter"&&d<=i)return d*e;const g=e/2/d,f=e/2*(h/u),p=Math.sqrt((n+g)*(n+g)+f*f)-n;if(this.radius2_===void 0||t==="bevel")return p*2;const m=n*Math.sin(a),y=Math.sqrt(n*n-m*m),_=s-y,x=Math.sqrt(m*m+_*_)/m;if(x<=i){const v=x*e/2-s-n;return 2*Math.max(p,v)}return p*2}createRenderOptions(){let t=Ru,e=Iu,i=0,n=null,s=0,o,a=0;this.stroke_&&(o=io(this.stroke_.getColor()??Ng),a=this.stroke_.getWidth()??$g,n=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Iu,t=this.stroke_.getLineCap()??Ru,i=this.stroke_.getMiterLimit()??Fg);const l=this.calculateLineJoinSize_(e,a,i),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:h,lineCap:t,lineDash:n,lineDashOffset:s,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let n=this.fill_.getColor();n===null&&(n=dn),e.fillStyle=io(n),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),n=0;typeof i=="string"&&(i=ds(i)),i===null?n=1:Array.isArray(i)&&(n=i.length===4?i[3]:1),n===0&&(e=Hr(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=s+a*o,c=a%2===0?i:n;t.lineTo(c*Math.cos(l),c*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=dn,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}},k1=class n4 extends ob{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new n4({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}},ii=class s4{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=cT,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new s4({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=cT,this.geometry_=t}setZIndex(t){this.zIndex_=t}};function RD(r){let t;if(typeof r=="function")t=r;else{let e;Array.isArray(r)?e=r:(_e(typeof r.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[r]),t=function(){return e}}return t}let s_=null;function o4(r,t){if(!s_){const e=new Ds({color:"rgba(255,255,255,0.4)"}),i=new vo({color:"#3399CC",width:1.25});s_=[new ii({image:new k1({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return s_}function cT(r){return r.getGeometry()}const ID="#333";let p0=class a4{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=_i(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new Ds({color:ID}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new a4({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Ds?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=_i(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}};const ur={ANIMATING:0,INTERACTING:1},Ut={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},xp=[Ut.FILL],Qa=[Ut.STROKE],Ql=[Ut.BEGIN_PATH],hT=[Ut.CLOSE_PATH];let Nf=class extends WR{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=t.length;a<l;a+=e)n[0]=t[a],n[1]=t[a+1],Mc(i,n)&&(s[o++]=n[0],s[o++]=n[1]);return o}appendFlatLineCoordinates(t,e,i,n,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(e+=n);let h=t[e],u=t[e+1];const d=this.tmpCoordinate_;let g=!0,f,p,m;for(f=e+n;f<i;f+=n)d[0]=t[f],d[1]=t[f+1],m=tx(c,d),m!==p?(g&&(a[l++]=h,a[l++]=u,g=!1),a[l++]=d[0],a[l++]=d[1]):m===mi.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],g=!1):g=!0,h=d[0],u=d[1],p=m;return(s&&g||f===e+n)&&(a[l++]=h,a[l++]=u),l}drawCustomCoordinates_(t,e,i,n,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],c=this.appendFlatLineCoordinates(t,e,l,n,!1,!1);s.push(c),e=l}return e}drawCustom(t,e,i,n,s){this.beginGeometry(t,e,s);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let c,h,u,d,g;switch(o){case"MultiPolygon":c=t.getOrientedFlatCoordinates(),d=[];const f=t.getEndss();g=0;for(let p=0,m=f.length;p<m;++p){const y=[];g=this.drawCustomCoordinates_(c,g,f[p],a,y),d.push(y)}this.instructions.push([Ut.CUSTOM,l,d,t,i,hx,s]),this.hitDetectionInstructions.push([Ut.CUSTOM,l,d,t,n||i,hx,s]);break;case"Polygon":case"MultiLineString":u=[],c=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),g=this.drawCustomCoordinates_(c,0,t.getEnds(),a,u),this.instructions.push([Ut.CUSTOM,l,u,t,i,Og,s]),this.hitDetectionInstructions.push([Ut.CUSTOM,l,u,t,n||i,Og,s]);break;case"LineString":case"Circle":c=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([Ut.CUSTOM,l,h,t,i,Xa,s]),this.hitDetectionInstructions.push([Ut.CUSTOM,l,h,t,n||i,Xa,s]);break;case"MultiPoint":c=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([Ut.CUSTOM,l,h,t,i,Xa,s]),this.hitDetectionInstructions.push([Ut.CUSTOM,l,h,t,n||i,Xa,s]));break;case"Point":c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([Ut.CUSTOM,l,h,t,i,void 0,s]),this.hitDetectionInstructions.push([Ut.CUSTOM,l,h,t,n||i,void 0,s]);break}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[Ut.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ut.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let n,s,o=-1;for(e=0;e<i;++e)n=t[e],s=n[0],s==Ut.END_GEOMETRY?o=e:s==Ut.BEGIN_GEOMETRY&&(n[2]=e,IF(this.hitDetectionInstructions,o,e),o=-1)}fillStyleToState(t,e={}){if(t){const i=t.getColor();e.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,e.fillStyle=io(i||dn)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){const i=t.getColor();e.strokeStyle=io(i||Ng);const n=t.getLineCap();e.lineCap=n!==void 0?n:Ru;const s=t.getLineDash();e.lineDash=s?s.slice():Xo;const o=t.getLineDashOffset();e.lineDashOffset=o||Ko;const a=t.getLineJoin();e.lineJoin=a!==void 0?a:Iu;const l=t.getWidth();e.lineWidth=l!==void 0?l:$g;const c=t.getMiterLimit();e.miterLimit=c!==void 0?c:Fg;const h=t.getOffset();e.strokeOffset=h??lD,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0,e.strokeOffset=void 0;return e}setFillStrokeStyle(t,e){const i=this.state;this.fillStyleToState(t,i),this.strokeStyleToState(e,i)}createFill(t){const e=t.fillStyle,i=[Ut.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Ut.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,s=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,c=t.miterLimit,h=t.strokeOffset;(t.currentStrokeStyle!=i||t.currentLineCap!=n||s!=t.currentLineDash&&!ga(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=c||t.currentStrokeOffset!=h)&&(e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=c,t.currentStrokeOffset=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Ut.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=uR(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;ns(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}};class PD extends Nf{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!Mc(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(n,s);this.instructions.push([Ut.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ut.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),s=[];for(let l=0,c=n.length;l<c;l+=t.getStride())(!this.maxExtent||Mc(this.maxExtent,n.slice(l,l+2)))&&s.push(n[l],n[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ut.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ut.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}let AD=class extends Nf{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n,s){const o=this.coordinates.length,a=this.appendFlatLineCoordinates(t,e,i,n,!1,!1);return this.instructions.push([Ut.MOVE_TO_LINE_TO,o,a,s*this.pixelRatio]),this.hitDetectionInstructions.push([Ut.MOVE_TO_LINE_TO,o,a,s]),i}drawLineString(t,e,i){const n=this.state,s=n.strokeStyle,o=n.lineWidth,a=n.strokeOffset;if(s===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([Ut.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Xo,Ko],Ql);const l=t.getFlatCoordinates(),c=t.getStride();this.drawFlatCoordinates_(l,0,l.length,c,a),this.hitDetectionInstructions.push(Qa),this.endGeometry(e)}drawMultiLineString(t,e,i){const n=this.state,s=n.strokeStyle,o=n.lineWidth,a=n.strokeOffset;if(s===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([Ut.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Xo,Ko],Ql);const l=t.getEnds(),c=t.getFlatCoordinates(),h=t.getStride();let u=0;for(let d=0,g=l.length;d<g;++d)u=this.drawFlatCoordinates_(c,u,l[d],h,a);this.hitDetectionInstructions.push(Qa),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Qa),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Qa),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Ql)}},uT=class extends Nf{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n,s){const o=this.state,a=o.fillStyle!==void 0,l=o.strokeStyle!==void 0,c=i.length;this.instructions.push(Ql),this.hitDetectionInstructions.push(Ql);for(let h=0;h<c;++h){const u=i[h],d=this.coordinates.length,g=this.appendFlatLineCoordinates(t,e,u,n,!0,!l);this.instructions.push([Ut.MOVE_TO_LINE_TO,d,g,s*this.pixelRatio,!0]),this.hitDetectionInstructions.push([Ut.MOVE_TO_LINE_TO,d,g,s,!0]),l&&(this.instructions.push(hT),this.hitDetectionInstructions.push(hT)),e=u}return a&&(this.instructions.push(xp),this.hitDetectionInstructions.push(xp)),l&&(this.instructions.push(Qa),this.hitDetectionInstructions.push(Qa)),e}drawCircle(t,e,i){const n=this.state,s=n.fillStyle,o=n.strokeStyle,a=n.strokeOffset;if(s===void 0&&o===void 0||this.handleStrokeOffset_(()=>this.drawCircle(t,e,i)))return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ut.SET_FILL_STYLE,dn]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ut.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Xo,Ko]);const l=t.getFlatCoordinates(),c=t.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,c,!1,!1);const u=[Ut.CIRCLE,h,a];this.instructions.push(Ql,u),this.hitDetectionInstructions.push(Ql,u),n.fillStyle!==void 0&&(this.instructions.push(xp),this.hitDetectionInstructions.push(xp)),n.strokeStyle!==void 0&&(this.instructions.push(Qa),this.hitDetectionInstructions.push(Qa)),this.endGeometry(e)}drawPolygon(t,e,i){const n=this.state,s=n.fillStyle,o=n.strokeStyle,a=n.strokeOffset;if(s===void 0&&o===void 0||this.handleStrokeOffset_(()=>this.drawPolygon(t,e,i)))return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ut.SET_FILL_STYLE,dn]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ut.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Xo,Ko]);const l=t.getEnds(),c=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(c,0,l,h,a),this.endGeometry(e)}drawMultiPolygon(t,e,i){const n=this.state,s=n.fillStyle,o=n.strokeStyle,a=n.strokeOffset;if(s===void 0&&o===void 0||this.handleStrokeOffset_(()=>this.drawMultiPolygon(t,e,i)))return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ut.SET_FILL_STYLE,dn]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ut.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Xo,Ko]);const l=t.getEndss(),c=t.getOrientedFlatCoordinates(),h=t.getStride();let u=0;for(let d=0,g=l.length;d<g;++d)u=this.drawFlatCoordinatess_(c,u,l[d],h,a);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=zl(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;this.updateFillStyle(t,this.createFill),this.updateStrokeStyle(t,this.applyStroke)}handleStrokeOffset_(t){const e=this.state,i=e.fillStyle,n=e.strokeStyle,s=e.strokeOffset;return Math.abs(s)>0&&i!==void 0&&n!==void 0?(e.strokeStyle=void 0,e.strokeOffset=0,t(),e.fillStyle=void 0,e.strokeStyle=n,e.strokeOffset=s,t(),e.fillStyle=i,!0):!1}};function LD(r,t,e,i,n){const s=[];let o=e,a=0,l=t.slice(e,2);for(;a<r&&o+n<i;){const[c,h]=l.slice(-2),u=t[o+n],d=t[o+n+1],g=Math.sqrt((u-c)*(u-c)+(d-h)*(d-h));if(a+=g,a>=r){const f=(r-a+g)/g,p=In(c,u,f),m=In(h,d,f);l.push(p,m),s.push(l),l=[p,m],a==r&&(o+=n),a=0}else if(a<r)l.push(t[o+n],t[o+n+1]),o+=n;else{const f=g-a,p=In(c,u,f/g),m=In(h,d,f/g);l.push(p,m),s.push(l),l=[p,m],a=0,o+=n}}return a>0&&s.push(l),s}function OD(r,t,e,i,n){let s=e,o=e,a=0,l=0,c=e,h,u,d,g,f,p,m,y,_,x;for(u=e;u<i;u+=n){const v=t[u],w=t[u+1];f!==void 0&&(_=v-f,x=w-p,g=Math.sqrt(_*_+x*x),m!==void 0&&(l+=d,h=Math.acos((m*_+y*x)/(d*g)),h>r&&(l>a&&(a=l,s=c,o=u),l=0,c=u-n)),d=g,m=_,y=x),f=v,p=w}return l+=g,l>a?[c,u]:[s,o]}const H0={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class FD extends Nf{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[dn]={fillStyle:dn},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const n=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!n&&!s)return;const a=this.coordinates;let l=a.length;const c=t.getType();let h=null,u=t.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!zr(this.maxExtent,t.getExtent()))return;let d;if(h=t.getFlatCoordinates(),c=="LineString")d=[h.length];else if(c=="MultiLineString")d=t.getEnds();else if(c=="Polygon")d=t.getEnds().slice(0,1);else if(c=="MultiPolygon"){const m=t.getEndss();d=[];for(let y=0,_=m.length;y<_;++y)d.push(m[y][0])}this.beginGeometry(t,e,i);const g=o.repeat,f=g?void 0:o.textAlign;let p=0;for(let m=0,y=d.length;m<y;++m){let _;g?_=LD(g*this.resolution,h,p,d[m],u):_=[h.slice(p,d[m])];for(let x=0,v=_.length;x<v;++x){const w=_[x];let b=0,E=w.length;if(f==null){const S=OD(o.maxAngle,w,0,w.length,2);b=S[0],E=S[1]}for(let S=b;S<E;S+=u)a.push(w[S],w[S+1]);const C=a.length;p=d[m],this.drawChars_(l,C),l=C}}this.endGeometry(e)}else{let d=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),u=2;break;case"Polygon":h=t.getFlatInteriorPoint(),o.overflow||d.push(h[2]/this.resolution),u=3;break;case"MultiPolygon":const v=t.getFlatInteriorPoints();h=[];for(let w=0,b=v.length;w<b;w+=3)o.overflow||d.push(v[w+2]/this.resolution),h.push(v[w],v[w+1]);if(h.length===0)return;u=2;break}const g=this.appendFlatPointCoordinates(h,u);if(g===l)return;if(d&&(g-l)/2!==h.length/u){let v=l/2;d=d.filter((w,b)=>{const E=a[(v+b)*2]===h[b*u]&&a[(v+b)*2+1]===h[b*u+1];return E||--v,E})}this.saveTextStates_();const f=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,p=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(t,e,i);let m=o.padding;if(m!=Kl&&(o.scale[0]<0||o.scale[1]<0)){let v=o.padding[0],w=o.padding[1],b=o.padding[2],E=o.padding[3];o.scale[0]<0&&(w=-w,E=-E),o.scale[1]<0&&(v=-v,b=-b),m=[v,w,b,E]}const y=this.pixelRatio;this.instructions.push([Ut.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,m==Kl?Kl:m.map(function(v){return v*y}),f,p,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const _=1/y,x=f?f.slice(0):null;x&&(x[1]=dn),this.hitDetectionInstructions.push([Ut.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[_,_],NaN,this.declutterMode_,this.declutterImageWithText_,m,x,p,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?dn:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||Dg,justify:e.justify,textBaseline:e.textBaseline||V0,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=H0[n.textBaseline],h=this.textOffsetY_*l,u=this.text_,d=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([Ut.DRAW_CHARS,t,e,c,n.overflow,a,n.maxAngle,l,h,s,d*l,u,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ut.DRAW_CHARS,t,e,c,n.overflow,a&&dn,n.maxAngle,l,h,s,d*l,u,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,n,s;if(!t)this.text_="";else{const o=t.getFill();o?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=io(o.getColor()||dn)):(n=null,this.textFillState_=n);const a=t.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const p=a.getLineDash(),m=a.getLineDashOffset(),y=a.getWidth(),_=a.getMiterLimit();s.lineCap=a.getLineCap()||Ru,s.lineDash=p?p.slice():Xo,s.lineDashOffset=m===void 0?Ko:m,s.lineJoin=a.getLineJoin()||Iu,s.lineWidth=y===void 0?$g:y,s.miterLimit=_===void 0?Fg:_,s.strokeStyle=io(a.getColor()||Ng)}i=this.textState_;const l=t.getFont()||VR;uD(l);const c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||V0,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Kl,i.scale=c===void 0?[1,1]:c;const h=t.getOffsetX(),u=t.getOffsetY(),d=t.getRotateWithView(),g=t.getKeepUpright(),f=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=d===void 0?!1:d,this.textKeepUpright_=g===void 0?!0:g,this.textRotation_=f===void 0?0:f,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Rt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?typeof n.fillStyle=="string"?n.fillStyle:"|"+Rt(n.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const ND={Circle:uT,Default:Nf,Image:PD,LineString:AD,Polygon:uT,Text:FD};class l4{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const s=i[n].finish();t[e][n]=s}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let n=this.buildersByZIndex_[i];n===void 0&&(n={},this.buildersByZIndex_[i]=n);let s=n[e];if(s===void 0){const o=ND[e];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=s}return s}}function DD(r,t,e,i,n,s,o,a,l,c,h,u,d=!0){let g=r[t],f=r[t+1],p=0,m=0,y=0,_=0;function x(){p=g,m=f,t+=i,g=r[t],f=r[t+1],_+=y,y=Math.sqrt((g-p)*(g-p)+(f-m)*(f-m))}do x();while(t<e-i&&_+y<s);let v=y===0?0:(s-_)/y;const w=In(p,g,v),b=In(m,f,v),E=t-i,C=_,S=s+a*l(c,n,h);for(;t<e-i&&_+y<S;)x();v=y===0?0:(S-_)/y;const R=In(p,g,v),I=In(m,f,v);let F=!1;if(d)if(u){const A=[w,b,R,I];TR(A,0,4,2,u,A,A),F=A[0]>A[2]}else F=w>R;const N=Math.PI,P=[],T=E+i===t;t=E,y=0,_=C,g=r[t],f=r[t+1];let D;if(T){x(),D=Math.atan2(f-m,g-p),F&&(D+=D>0?-N:N);const A=(R+w)/2,$=(I+b)/2;return P[0]=[A,$,(S-s)/2,D,n],P}n=n.replace(/\n/g," ");for(let A=0,$=n.length;A<$;){x();let z=Math.atan2(f-m,g-p);if(F&&(z+=z>0?-N:N),D!==void 0){let V=z-D;if(V+=V>N?-2*N:V<-N?2*N:0,Math.abs(V)>o)return null}D=z;const j=A;let et=0;for(;A<$;++A){const V=F?$-A-1:A,It=a*l(c,n[V],h);if(t+i<e&&_+y<s+et+It/2)break;et+=It}if(A===j)continue;const q=F?n.substring($-j,$-A):n.substring(j,A);v=y===0?0:(s+et/2-_)/y;const vt=In(p,g,v),jt=In(m,f,v);P.push([vt,jt,et/2,z,q]),s+=et}return P}let ab=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(W0(),{get:(t,e)=>{if(typeof W0()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,i)=>(this.push_(e,i),!0)})}push_(...t){const e=this.instructions_,i=this.zIndex+this.offset_;e[i]||(e[i]=[]),e[i].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,n=e.length;i<n;++i){const s=e[i];if(typeof s=="function"){s(t);continue}const o=e[++i];if(typeof t[s]=="function")t[s](...o);else{if(typeof o=="function"){t[s]=o(t);continue}t[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}};const ah=sn(),ba=[],Ro=[],Io=[],ka=[];function dT(r){return r[3].declutterBox}const gT=new RegExp("[Ö-à£¿ï¬-ï·¿ï¹°-ï»¼à -à¿¿î -î¿¿]");function o_(r,t){return t==="start"?t=gT.test(r)?"right":"left":t==="end"&&(t=gT.test(r)?"left":"right"),H0[t]}function $D(r,t,e){return e>0&&r.push(`
`,""),r.push(t,""),r}function GD(r,t,e){return e%2===0&&(r+=t),r}let jD=class{constructor(t,e,i,n,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=Er(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new ab:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,n){const s=t+e+i+n;if(this.labels_[s])return this.labels_[s];const o=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],u=l.justify?H0[l.justify]:o_(Array.isArray(t)?t[0]:t,l.textAlign||Dg),d=n&&o.lineWidth?o.lineWidth:0,g=Array.isArray(t)?t:String(t).split(`
`).reduce($D,[]),{width:f,height:p,widths:m,heights:y,lineWidths:_}=gD(l,g),x=f+d,v=[],w=(x+2)*h[0],b=(p+d)*h[1],E={width:w<0?Math.floor(w):Math.ceil(w),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:v};(h[0]!=1||h[1]!=1)&&v.push("scale",h),n&&(v.push("strokeStyle",o.strokeStyle),v.push("lineWidth",d),v.push("lineCap",o.lineCap),v.push("lineJoin",o.lineJoin),v.push("miterLimit",o.miterLimit),v.push("setLineDash",[o.lineDash]),v.push("lineDashOffset",o.lineDashOffset)),i&&v.push("fillStyle",a.fillStyle),v.push("textBaseline","middle"),v.push("textAlign","center");const C=.5-u;let S=u*x+C*d;const R=[],I=[];let F=0,N=0,P=0,T=0,D;for(let A=0,$=g.length;A<$;A+=2){const z=g[A];if(z===`
`){N+=F,F=0,S=u*x+C*d,++T;continue}const j=g[A+1]||l.font;j!==D&&(n&&R.push("font",j),i&&I.push("font",j),D=j),F=Math.max(F,y[P]);const et=[z,S+C*m[P]+u*(m[P]-_[T]),.5*(d+F)+N];S+=m[P],n&&R.push("strokeText",et),i&&I.push("fillText",et),++P}return Array.prototype.push.apply(v,R),Array.prototype.push.apply(v,I),this.labels_[s]=E,E}replayTextBackground_(t,e,i,n,s,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],t.fillStyle=o[1],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,s,o,a,l,c,h,u,d,g,f,p,m){a*=d[0],l*=d[1];let y=i-a,_=n-l;const x=s+c>t?t-c:s,v=o+h>e?e-h:o,w=f[3]+x*d[0]+f[1],b=f[0]+v*d[1]+f[2],E=y-f[3],C=_-f[0];(p||u!==0)&&(ba[0]=E,ka[0]=E,ba[1]=C,Ro[1]=C,Ro[0]=E+w,Io[0]=Ro[0],Io[1]=C+b,ka[1]=Io[1]);let S;return u!==0?(S=us(Er(),i,n,1,1,u,-i,-n),Ir(S,ba),Ir(S,Ro),Ir(S,Io),Ir(S,ka),Fs(Math.min(ba[0],Ro[0],Io[0],ka[0]),Math.min(ba[1],Ro[1],Io[1],ka[1]),Math.max(ba[0],Ro[0],Io[0],ka[0]),Math.max(ba[1],Ro[1],Io[1],ka[1]),ah)):Fs(Math.min(E,E+w),Math.min(C,C+b),Math.max(E,E+w),Math.max(C,C+b),ah),g&&(y=Math.round(y),_=Math.round(_)),{drawImageX:y,drawImageY:_,drawImageW:x,drawImageH:v,originX:c,originY:h,declutterBox:{minX:ah[0],minY:ah[1],maxX:ah[2],maxY:ah[3],value:m},canvasTransform:S,scale:d}}replayImageOrLabel_(t,e,i,n,s,o,a){const l=!!(o||a),c=n.declutterBox,h=a?a[2]*n.scale[0]/2:0;return c.minX-h<=e[0]&&c.maxX+h>=0&&c.minY-h<=e[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(t,ba,Ro,Io,ka,o,a),fD(t,n.canvasTransform,s,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=Ir(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(i[0]%n,i[1]%n),e!==1&&t.scale(e,e)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],e[1]&&(t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6]))}drawLabelWithPointPlacement_(t,e,i,n){const s=this.textStates[e],o=this.createLabel(t,e,n,i),a=this.strokeStates[i],l=this.pixelRatio,c=o_(Array.isArray(t)?t[0]:t,s.textAlign||Dg),h=H0[s.textBaseline||V0],u=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*s.scale[0],g=c*d+2*(.5-c)*u,f=h*o.height/l+2*(.5-h)*u;return{label:o,anchorX:g,anchorY:f}}execute_(t,e,i,n,s,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&ga(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=co(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),q0(this.renderedTransform_,i));let u=0;const d=n.length;let g=0,f,p,m,y,_,x,v,w,b,E,C,S,R,I,F,N,P=0,T=0;const D=this.coordinateCache_,A=this.viewRotation_,$=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,z={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:A},j=this.instructions!=n||this.overlaps?0:200;let et,q,vt,jt;for(;u<d;){const V=n[u];switch(V[0]){case Ut.BEGIN_GEOMETRY:et=V[1],jt=V[3],et.getGeometry()?a!==void 0&&!zr(a,jt.getExtent())?u=V[2]+1:++u:u=V[2],c&&(c.zIndex=V[4]);break;case Ut.BEGIN_PATH:P>j&&(this.fill_(t),P=0),T>j&&(t.stroke(),T=0),!P&&!T&&(t.beginPath(),w=NaN,b=NaN),++u;break;case Ut.CIRCLE:g=V[1],y=V[2]??0;const It=h[g],Et=h[g+1],Mt=h[g+2]-y,Ot=h[g+3]-y,Y=Mt-It,We=Ot-Et,L=Math.sqrt(Y*Y+We*We);t.moveTo(It+L,Et),t.arc(It,Et,L,0,2*Math.PI,!0),++u;break;case Ut.CLOSE_PATH:t.closePath(),++u;break;case Ut.CUSTOM:g=V[1],f=V[2];const O=V[3],U=V[4],X=V[5];z.geometry=O,z.feature=et,u in D||(D[u]=[]);const W=D[u];X?X(h,g,f,2,W):(W[0]=h[g],W[1]=h[g+1],W.length=2),c&&(c.zIndex=V[6]),U(W,z),++u;break;case Ut.DRAW_IMAGE:g=V[1],f=V[2],S=V[3],p=V[4],m=V[5];let K=V[6];const it=V[7],ot=V[8],rt=V[9],H=V[10];let ut=V[11];const mt=V[12];let dt=V[13];v=V[14]||"declutter";const pt=V[15];if(!S&&V.length>=20){R=V[19],I=V[20],F=V[21],N=V[22];const cr=this.drawLabelWithPointPlacement_(R,I,F,N);S=cr.label,V[3]=S;const Fr=V[23];p=(cr.anchorX-Fr)*this.pixelRatio,V[4]=p;const _r=V[24];m=(cr.anchorY-_r)*this.pixelRatio,V[5]=m,K=S.height,V[6]=K,dt=S.width,V[13]=dt}let kt;V.length>25&&(kt=V[25]);let Dt,wt,zt;V.length>17?(Dt=V[16],wt=V[17],zt=V[18]):(Dt=Kl,wt=null,zt=null),H&&$?ut+=A:!H&&!$&&(ut-=A);let Jt=0;for(;g<f;g+=2){if(kt&&kt[Jt++]<dt/this.pixelRatio)continue;const cr=this.calculateImageOrLabelDimensions_(S.width,S.height,h[g],h[g+1],dt,K,p,m,ot,rt,ut,mt,s,Dt,!!wt||!!zt,et),Fr=[t,e,S,cr,it,wt,zt];if(l){let _r,Nr,xe;if(pt){const ir=f-g;if(!pt[ir]){pt[ir]={args:Fr,declutterMode:v};continue}const oi=pt[ir];_r=oi.args,Nr=oi.declutterMode,delete pt[ir],xe=dT(_r)}let rr,Ur;if(_r&&(Nr!=="declutter"||!l.collides(xe))&&(rr=!0),(v!=="declutter"||!l.collides(cr.declutterBox))&&(Ur=!0),Nr==="declutter"&&v==="declutter"){const ir=rr&&Ur;rr=ir,Ur=ir}rr&&(Nr!=="none"&&l.insert(xe),this.replayImageOrLabel_.apply(this,_r)),Ur&&(v!=="none"&&l.insert(cr.declutterBox),this.replayImageOrLabel_.apply(this,Fr))}else this.replayImageOrLabel_.apply(this,Fr)}++u;break;case Ut.DRAW_CHARS:const ve=V[1],Ce=V[2],Ve=V[3],qr=V[4];N=V[5];const Pe=V[6],le=V[7],Cr=V[8];F=V[9];const er=V[10];R=V[11],Array.isArray(R)&&(R=R.reduce(GD,"")),I=V[12];const Br=[V[13],V[13]];v=V[14]||"declutter";const lr=V[15],Yr=this.textStates[I],Cn=Yr.font,an=[Yr.scale[0]*le,Yr.scale[1]*le];let Xr;Cn in this.widths_?Xr=this.widths_[Cn]:(Xr={},this.widths_[Cn]=Xr);const qn=Jw(h,ve,Ce,2),ki=Math.abs(an[0])*oT(Cn,R,Xr);if(qr||ki<=qn){const cr=this.textStates[I].textAlign,Fr=(qn-ki)*o_(R,cr),_r=DD(h,ve,Ce,2,R,Fr,Pe,Math.abs(an[0]),oT,Cn,Xr,$?0:this.viewRotation_,lr);t:if(_r){const Nr=[];let xe,rr,Ur,ir,oi;if(F)for(xe=0,rr=_r.length;xe<rr;++xe){oi=_r[xe],Ur=oi[4],ir=this.createLabel(Ur,I,"",F),p=oi[2]+(an[0]<0?-er:er),m=Ve*ir.height+(.5-Ve)*2*er*an[1]/an[0]-Cr;const ps=this.calculateImageOrLabelDimensions_(ir.width,ir.height,oi[0],oi[1],ir.width,ir.height,p,m,0,0,oi[3],Br,!1,Kl,!1,et);if(l&&v==="declutter"&&l.collides(ps.declutterBox))break t;Nr.push([t,e,ir,ps,1,null,null])}if(N)for(xe=0,rr=_r.length;xe<rr;++xe){oi=_r[xe],Ur=oi[4],ir=this.createLabel(Ur,I,N,""),p=oi[2],m=Ve*ir.height-Cr;const ps=this.calculateImageOrLabelDimensions_(ir.width,ir.height,oi[0],oi[1],ir.width,ir.height,p,m,0,0,oi[3],Br,!1,Kl,!1,et);if(l&&v==="declutter"&&l.collides(ps.declutterBox))break t;Nr.push([t,e,ir,ps,1,null,null])}l&&v!=="none"&&l.load(Nr.map(dT));for(let ps=0,ap=Nr.length;ps<ap;++ps)this.replayImageOrLabel_.apply(this,Nr[ps])}}++u;break;case Ut.END_GEOMETRY:if(o!==void 0){et=V[1];const cr=o(et,jt,v);if(cr)return cr}++u;break;case Ut.FILL:j?P++:this.fill_(t),++u;break;case Ut.MOVE_TO_LINE_TO:for(g=V[1],f=V[2],y=V[3],_=V[4]??!1,q=h[g],vt=h[g+1],y&&(x=g,[q,vt]=f0(q,vt,_?h[f-4]:void 0,_?h[f-3]:void 0,h[g+2],h[g+3],y)),t.moveTo(q,vt),w=q+.5|0,b=vt+.5|0,g+=2;g<f;g+=2)q=h[g],vt=h[g+1],E=q+.5|0,C=vt+.5|0,(g==f-2||E!==w||C!==b)&&(y&&(g==f-2?[q,vt]=f0(q,vt,h[g-2],h[g-1],_?h[x+2]:void 0,_?h[x+3]:void 0,y):[q,vt]=f0(q,vt,h[g-2],h[g-1],h[g+2],h[g+3],y)),t.lineTo(q,vt),w=E,b=C);++u;break;case Ut.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],P&&(this.fill_(t),P=0,T&&(t.stroke(),T=0)),t.fillStyle=V[1],++u;break;case Ut.SET_STROKE_STYLE:T&&(t.stroke(),T=0),this.setStrokeStyle_(t,V),++u;break;case Ut.STROKE:j?T++:t.stroke(),++u;break;default:++u;break}}P&&this.fill_(t),T&&t.stroke()}execute(t,e,i,n,s,o){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(t,e,i,n,s){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,n,s)}};const Wl=["Polygon","Circle","LineString","Image","Text","Default"],Y0=["Image","Text"],zD=Wl.filter(r=>!Y0.includes(r));let c4=!1,h4=!1;function qD(){let r=0;const t=e=>{const i=Hr(1,1,null,{willReadFrequently:e});let n=0;const s=performance.now();for(;performance.now()-s<50;++n)i.fillStyle=`rgba(255,0,${n%256},1)`,i.fillRect(0,0,1,1),i.getImageData(0,0,1,1);return r=n>r?n:r,n};c4={[t(!0)]:!0,[t(!1)]:!1,[t(void 0)]:void 0}[r],h4=!0}class u4{constructor(t,e,i,n,s,o,a){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Er(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let n=this.executorsByZIndex_[i];n===void 0&&(n={},this.executorsByZIndex_[i]=n);const s=t[i];for(const o in s){const a=s[o];n[o]=new jD(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let n=0,s=t.length;n<s;++n)if(t[n]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,s,o){h4===!1&&qD(),n=Math.round(n);const a=n*2+1,l=us(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Hr(a,a,null,{willReadFrequently:c4}));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=sn(),Xd(u,t),ns(u,e*(this.renderBuffer_+n),u));const d=BD(n);let g;function f(w,b,E){const C=h.getImageData(0,0,a,a).data;for(let S=0,R=d.length;S<R;S++)if(C[d[S]]>0){if(!o||E==="none"||g!=="Image"&&g!=="Text"||o.includes(w)){const I=(d[S]-3)/4,F=n-I%a,N=n-(I/a|0),P=s(w,b,F*F+N*N);if(P)return P}h.clearRect(0,0,a,a);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);p.sort(lo);let m,y,_,x,v;for(m=p.length-1;m>=0;--m){const w=p[m].toString();for(_=this.executorsByZIndex_[w],y=Wl.length-1;y>=0;--y)if(g=Wl[y],x=_[g],x!==void 0&&(v=x.executeHitDetection(h,l,i,f,u),v))return v}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],s=e[2],o=e[3],a=[i,n,i,o,s,o,s,n];return co(a,0,8,2,t,a),a}isEmpty(){return _l(this.executorsByZIndex_)}execute(t,e,i,n,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?lR:lo),o=o||Wl;const c=Wl.length;for(let h=0,u=l.length;h<u;++h){const d=l[h].toString(),g=this.executorsByZIndex_[d];for(let f=0,p=o.length;f<p;++f){const m=o[f],y=g[m];if(y!==void 0){const _=a===null?void 0:y.getZIndexContext(),x=_?_.getContext():t,v=this.maxExtent_&&m!=="Image"&&m!=="Text";if(v&&(x.save(),this.clip(x,i)),!_||m==="Text"||m==="Image"?y.execute(x,e,i,n,s,a):_.pushFunction(w=>y.execute(w,e,i,n,s,a)),v&&x.restore(),_){_.offset();const w=l[h]*c+Wl.indexOf(m);this.deferredZIndexContexts_[w]||(this.deferredZIndexContexts_[w]=[]),this.deferredZIndexContexts_[w].push(_)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(lo);for(let i=0,n=e.length;i<n;++i)t[e[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),t[e[i]].length=0}}const a_={};function BD(r){if(a_[r]!==void 0)return a_[r];const t=r*2+1,e=r*r,i=new Array(e+1);for(let s=0;s<=r;++s)for(let o=0;o<=r;++o){const a=s*s+o*o;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((r+s)*t+(r+o))*4+3),s>0&&l.push(((r-s)*t+(r+o))*4+3),o>0&&(l.push(((r+s)*t+(r-o))*4+3),s>0&&l.push(((r-s)*t+(r-o))*4+3))}const n=[];for(let s=0,o=i.length;s<o;++s)i[s]&&n.push(...i[s]);return a_[r]=n,n}function fT(r,t,e,i){return e!==void 0&&i!==void 0?[e/r,i/t]:e!==void 0?e/r:i!==void 0?i/t:1}let Df=class d4 extends e4{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,n=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:n,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null,this.referrerPolicy_=t.referrerPolicy;const o=t.img!==void 0?t.img:null;let a=t.src;_e(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||Rt(o)),_e(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),_e(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=Nt.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?Nt.LOADED:Nt.IDLE:l=Nt.LOADING:l=Nt.LOADED),this.color_=t.color!==void 0?ds(t.color):null,this.iconImage_=Jd(o,a,{crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_},l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let c,h;if(t.size)[c,h]=t.size;else{const u=this.getImage(1);if(u.width&&u.height)c=u.width,h=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=t;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const g=this.iconImage_.getSize();this.setScale(fT(g[0],g[1],t.width,t.height))};this.listenImageChange(d);return}}c!==void 0&&this.setScale(fT(c,h,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new d4({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const n=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!n)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=n[0]),this.anchorYUnits_=="fraction"&&(t[1]*=n[1])}if(this.anchorOrigin_!="top-left"){if(!n)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+n[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+n[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}setColor(t){const e=t?ds(t):null;if(this.color_===e||this.color_&&e&&this.color_.length===e.length&&this.color_.every((o,a)=>o===e[a]))return;this.color_=e;const i=this.getSrc(),n=i!==void 0?null:this.getHitDetectionImage(),s=i!==void 0?Nt.IDLE:this.iconImage_.getImageState();this.iconImage_=Jd(n,i,{crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_},s,this.color_)}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(t){this.iconImage_=Jd(null,t,{crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_},Nt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==Nt.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==Nt.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(Bt.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(Bt.CHANGE,t)}ready(){return this.iconImage_.ready()}};const On=.5;function g4(r,t,e,i,n,s,o,a,l){const c=l?jw(n):n,h=r[0]*On,u=r[1]*On,d=Hr(h,u);d.imageSmoothingEnabled=!1;const g=d.canvas,f=new mD(d,On,n,null,o,a,l?p1(vN(),l):null),p=e.length,m=Math.floor((256*256*256-1)/p),y={};for(let x=1;x<=p;++x){const v=e[x-1],w=v.getStyleFunction()||i;if(!w)continue;let b=w(v,s);if(!b)continue;Array.isArray(b)||(b=[b]);const E=(x*m).toString(16).padStart(7,"#00000");for(let C=0,S=b.length;C<S;++C){const R=b[C],I=R.getGeometryFunction()(v);if(!I||!zr(c,I.getExtent()))continue;const F=R.clone(),N=F.getFill();N&&N.setColor(E);const P=F.getStroke();P&&(P.setColor(E),P.setLineDash(null)),F.setText(void 0);const T=R.getImage();if(T){const z=T.getImageSize();if(!z)continue;const j=Hr(z[0],z[1],void 0,{alpha:!1}),et=j.canvas;j.fillStyle=E,j.fillRect(0,0,et.width,et.height),F.setImage(new Df({img:et,anchor:T.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:T.getOrigin(),opacity:1,size:T.getSize(),scale:T.getScale(),rotation:T.getRotation(),rotateWithView:T.getRotateWithView()}))}const D=F.getZIndex()||0;let A=y[D];A||(A={},y[D]=A,A.Polygon=[],A.Circle=[],A.LineString=[],A.Point=[]);const $=I.getType();if($==="GeometryCollection"){const z=I.getGeometriesArrayRecursive();for(let j=0,et=z.length;j<et;++j){const q=z[j];A[q.getType().replace("Multi","")].push(q,F)}}else A[$.replace("Multi","")].push(I,F)}}const _=Object.keys(y).map(Number).sort(lo);for(let x=0,v=_.length;x<v;++x){const w=y[_[x]];for(const b in w){const E=w[b];for(let C=0,S=E.length;C<S;C+=2){f.setStyle(E[C+1]);for(let R=0,I=t.length;R<I;++R)f.setTransform(t[R]),f.drawGeometry(E[C])}}}return d.getImageData(0,0,g.width,g.height)}function f4(r,t,e){const i=[];if(e){const n=Math.floor(Math.round(r[0])*On),s=Math.floor(Math.round(r[1])*On),o=(dr(n,0,e.width-1)+dr(s,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],c=e.data[o+2]+256*(l+256*a),h=Math.floor((256*256*256-1)/t.length);c&&c%h===0&&i.push(t[c/h-1])}return i}class tg extends Eo{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}}const UD=5;class p4 extends If{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=UD}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return Qt()}getData(t){return null}prepareFrame(t){return Qt()}renderFrame(t,e){return Qt()}forEachFeatureAtCoordinate(t,e,i,n,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===Nt.LOADED||e.getState()===Nt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=Nt.LOADED&&e!=Nt.ERROR&&t.addEventListener(Bt.CHANGE,this.boundHandleImageChange_),e==Nt.IDLE&&(t.load(),e=t.getState()),e==Nt.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const pT=[];let Ch=null;function WD(){Ch=Hr(1,1,void 0,{willReadFrequently:!0})}class lb extends p4{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=Er(),this.pixelTransform=Er(),this.inversePixelTransform=Er(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){Ch||WD(),Ch.clearRect(0,0,1,1);let n;try{Ch.drawImage(t,e,i,1,1,0,0,1,1),n=Ch.getImageData(0,0,1,1).data}catch{return Ch=null,null}return n}getBackground(t){let e=this.getLayer().getBackground();return typeof e=="function"&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let s,o;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&ga(ds(t.style.backgroundColor),ds(i)))){const a=t.firstElementChild;Ka(a)&&(o=a.getContext("2d"))}if(o&&SN(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Yn?zR():document.createElement("div"),s.className=n;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Hr();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=_o(i),s=cc(i),o=Tu(i),a=lc(i);Ir(e.coordinateToPixelTransform,n),Ir(e.coordinateToPixelTransform,s),Ir(e.coordinateToPixelTransform,o),Ir(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Ir(l,n),Ir(l,s),Ir(l,o),Ir(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const i=t.extent,n=t.viewState.resolution,s=t.viewState.rotation,o=t.pixelRatio,a=Math.round(Te(i)/n*o),l=Math.round(ti(i)/n*o);us(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,s,-a/2,-l/2),Pc(this.inversePixelTransform,this.pixelTransform);const c=EN(this.pixelTransform);if(this.useContainer(e,c,this.getBackground(t)),!this.containerReused){const h=this.context.canvas;h.width!=a||h.height!=l?(h.width=a,h.height=l):this.context.clearRect(0,0,a,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const s=new tg(t,this.inversePixelTransform,i,e);n.dispatchEvent(s)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(yi.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(yi.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new ab),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(yi.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(yi.POSTRENDER,this.context,t))}getRenderTransform(t,e,i,n,s,o,a){const l=s/2,c=o/2,h=n/e,u=-h,d=-t[0]+a,g=-t[1];return us(this.tempTransform,l,c,h,u,-i,d,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}let Zc=0;const hi=1<<Zc++,Pt=1<<Zc++,ui=1<<Zc++,br=1<<Zc++,En=1<<Zc++,Kn=1<<Zc++,wp=Math.pow(2,Zc)-1,cb={[hi]:"boolean",[Pt]:"number",[ui]:"string",[br]:"color",[En]:"number[]",[Kn]:"size"},VD=Object.keys(cb).map(Number).sort(lo);function ZD(r){return r in cb}function Uh(r){const t=[];for(const e of VD)Fd(r,e)&&t.push(cb[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function Fd(r,t){return(r&t)===t}function Zs(r,t){return r===t}let ai=class{constructor(t,e){if(!ZD(t))throw new Error(`literal expressions must have a specific type, got ${Uh(t)}`);this.type=t,this.value=e}};class m4{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function hb(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function vi(r,t,e){switch(typeof r){case"boolean":{if(Zs(t,ui))return new ai(ui,r?"true":"false");if(!Fd(t,hi))throw new Error(`got a boolean, but expected ${Uh(t)}`);return new ai(hi,r)}case"number":{if(Zs(t,Kn))return new ai(Kn,_i(r));if(Zs(t,hi))return new ai(hi,!!r);if(Zs(t,ui))return new ai(ui,r.toString());if(!Fd(t,Pt))throw new Error(`got a number, but expected ${Uh(t)}`);return new ai(Pt,r)}case"string":{if(Zs(t,br))return new ai(br,rb(r));if(Zs(t,hi))return new ai(hi,!!r);if(!Fd(t,ui))throw new Error(`got a string, but expected ${Uh(t)}`);return new ai(ui,r)}}if(!Array.isArray(r))throw new Error("expression must be an array or a primitive value");if(r.length===0)throw new Error("empty expression");if(typeof r[0]=="string")return n7(r,t,e);for(const i of r)if(typeof i!="number")throw new Error("expected an array of numbers");if(Zs(t,Kn)){if(r.length!==2)throw new Error(`expected an array of two values for a size, got ${r.length}`);return new ai(Kn,r)}if(Zs(t,br)){if(r.length===3)return new ai(br,[...r,1]);if(r.length===4)return new ai(br,r);throw new Error(`expected an array of 3 or 4 values for a color, got ${r.length}`)}if(!Fd(t,En))throw new Error(`got an array of numbers, but expected ${Uh(t)}`);return new ai(En,r)}const B={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},HD={[B.Get]:ne(fe(1,1/0),mT),[B.Var]:ne(fe(1,1),YD),[B.Has]:ne(fe(1,1/0),mT),[B.Id]:ne(XD,lh),[B.Concat]:ne(fe(2,1/0),ze(ui)),[B.GeometryType]:ne(KD,lh),[B.LineMetric]:ne(lh),[B.Resolution]:ne(l_,lh),[B.Zoom]:ne(l_,lh),[B.Time]:ne(l_,lh),[B.Any]:ne(fe(2,1/0),ze(hi)),[B.All]:ne(fe(2,1/0),ze(hi)),[B.Not]:ne(fe(1,1),ze(hi)),[B.Equal]:ne(fe(2,2),ze(wp)),[B.NotEqual]:ne(fe(2,2),ze(wp)),[B.GreaterThan]:ne(fe(2,2),ze(Pt)),[B.GreaterThanOrEqualTo]:ne(fe(2,2),ze(Pt)),[B.LessThan]:ne(fe(2,2),ze(Pt)),[B.LessThanOrEqualTo]:ne(fe(2,2),ze(Pt)),[B.Multiply]:ne(fe(2,1/0),yT),[B.Coalesce]:ne(fe(2,1/0),yT),[B.Divide]:ne(fe(2,2),ze(Pt)),[B.Add]:ne(fe(2,1/0),ze(Pt)),[B.Subtract]:ne(fe(2,2),ze(Pt)),[B.Clamp]:ne(fe(3,3),ze(Pt)),[B.Mod]:ne(fe(2,2),ze(Pt)),[B.Pow]:ne(fe(2,2),ze(Pt)),[B.Abs]:ne(fe(1,1),ze(Pt)),[B.Floor]:ne(fe(1,1),ze(Pt)),[B.Ceil]:ne(fe(1,1),ze(Pt)),[B.Round]:ne(fe(1,1),ze(Pt)),[B.Sin]:ne(fe(1,1),ze(Pt)),[B.Cos]:ne(fe(1,1),ze(Pt)),[B.Atan]:ne(fe(1,2),ze(Pt)),[B.Sqrt]:ne(fe(1,1),ze(Pt)),[B.Match]:ne(fe(4,1/0),_T,JD),[B.Between]:ne(fe(3,3),ze(Pt)),[B.Interpolate]:ne(fe(6,1/0),_T,t7),[B.Case]:ne(fe(3,1/0),QD,e7),[B.In]:ne(fe(2,2),r7),[B.Number]:ne(fe(1,1/0),ze(wp)),[B.String]:ne(fe(1,1/0),ze(wp)),[B.Array]:ne(fe(1,1/0),ze(Pt)),[B.Color]:ne(fe(1,4),ze(Pt)),[B.Band]:ne(fe(1,3),ze(Pt)),[B.Palette]:ne(fe(2,2),i7),[B.ToString]:ne(fe(1,1),ze(hi|Pt|ui|br))};function mT(r,t,e){const i=r.length-1,n=new Array(i);for(let s=0;s<i;++s){const o=r[s+1];switch(typeof o){case"number":{n[s]=new ai(Pt,o);break}case"string":{n[s]=new ai(ui,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&e.properties.add(String(o))}return n}function YD(r,t,e){const i=r[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return e.variables.add(i),[new ai(ui,i)]}function XD(r,t,e){e.featureId=!0}function KD(r,t,e){e.geometryType=!0}function l_(r,t,e){e.mapState=!0}function lh(r,t,e){const i=r[0];if(r.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function fe(r,t){return function(e,i,n){const s=e[0],o=e.length-1;if(r===t){if(o!==r){const a=r===1?"":"s";throw new Error(`expected ${r} argument${a} for ${s}, got ${o}`)}}else if(o<r||o>t){const a=t===1/0?`${r} or more`:`${r} to ${t}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function yT(r,t,e){const i=r.length-1,n=new Array(i);for(let s=0;s<i;++s){const o=vi(r[s+1],t,e);n[s]=o}return n}function ze(r){return function(t,e,i){const n=t.length-1,s=new Array(n);for(let o=0;o<n;++o){const a=vi(t[o+1],r,i);s[o]=a}return s}}function QD(r,t,e){const i=r[0],n=r.length-1;if(n%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${n} instead`)}function _T(r,t,e){const i=r[0],n=r.length-1;if(n%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${n} instead`)}function JD(r,t,e){const i=r.length-1,n=ui|Pt|hi,s=vi(r[1],n,e),o=vi(r[r.length-1],t,e),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const c=vi(r[l+2],s.type,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=vi(r[l+3],o.type,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function t7(r,t,e){const i=r[1];let n;switch(i[0]){case"linear":n=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);n=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new ai(Pt,n);let o;try{o=vi(r[2],Pt,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(r.length-3);for(let l=0;l<a.length;l+=2){try{const c=vi(r[l+3],Pt,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=vi(r[l+4],t,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function e7(r,t,e){const i=vi(r[r.length-1],t,e),n=new Array(r.length-1);for(let s=0;s<n.length-1;s+=2){try{const o=vi(r[s+1],hi,e);n[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=vi(r[s+2],i.type,e);n[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return n[n.length-1]=i,n}function r7(r,t,e){let i=r[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let n;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],n=ui}else n=Pt;const s=new Array(i.length);for(let o=0;o<s.length;o++)try{const a=vi(i[o],n,e);s[o]=a}catch(a){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${a.message}`)}return[vi(r[1],n,e),...s]}function i7(r,t,e){let i;try{i=vi(r[1],Pt,e)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const n=r[2];if(!Array.isArray(n))throw new Error("the second argument of palette must be an array");const s=new Array(n.length);for(let o=0;o<s.length;o++){let a;try{a=vi(n[o],br,e)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof ai))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function ne(...r){return function(t,e,i){const n=t[0];let s;for(let o=0;o<r.length;o++){const a=r[o](t,e,i);if(o==r.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new m4(e,n,...s)}}function n7(r,t,e){const i=r[0],n=HD[i];if(!n)throw new Error(`unknown operator: ${i}`);return n(r,t,e)}function ub(r){if(!r)return"";const t=r.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return ub(r.getGeometries()[0]);default:return""}}function y4(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function xo(r,t,e){const i=vi(r,t,e);return $s(i)}function $s(r,t){if(r instanceof ai){if(r.type===br&&typeof r.value=="string"){const i=rb(r.value);return function(){return i}}return function(){return r.value}}const e=r.operator;switch(e){case B.Number:case B.String:case B.Coalesce:return s7(r);case B.Get:case B.Var:case B.Has:return o7(r);case B.Id:return i=>i.featureId;case B.GeometryType:return i=>i.geometryType;case B.Concat:{const i=r.args.map(n=>$s(n));return n=>"".concat(...i.map(s=>s(n).toString()))}case B.Resolution:return i=>i.resolution;case B.Any:case B.All:case B.Between:case B.In:case B.Not:return l7(r);case B.Equal:case B.NotEqual:case B.LessThan:case B.LessThanOrEqualTo:case B.GreaterThan:case B.GreaterThanOrEqualTo:return a7(r);case B.Multiply:case B.Divide:case B.Add:case B.Subtract:case B.Clamp:case B.Mod:case B.Pow:case B.Abs:case B.Floor:case B.Ceil:case B.Round:case B.Sin:case B.Cos:case B.Atan:case B.Sqrt:return c7(r);case B.Case:return h7(r);case B.Match:return u7(r);case B.Interpolate:return d7(r);case B.ToString:return g7(r);default:throw new Error(`Unsupported operator ${e}`)}}function s7(r,t){const e=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=$s(r.args[s]);switch(e){case B.Coalesce:return s=>{for(let o=0;o<i;++o){const a=n[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case B.Number:case B.String:return s=>{for(let o=0;o<i;++o){const a=n[o](s);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function o7(r,t){const e=r.args[0].value;switch(r.operator){case B.Get:return i=>{const n=r.args;let s=i.properties[e];for(let o=1,a=n.length;o<a;++o){const l=n[o].value;s=s[l]}return s};case B.Var:return i=>i.variables[e];case B.Has:return i=>{const n=r.args;if(!(e in i.properties))return!1;let s=i.properties[e];for(let o=1,a=n.length;o<a;++o){const l=n[o].value;if(!s||!Object.hasOwn(s,l))return!1;s=s[l]}return!0};default:throw new Error(`Unsupported accessor operator ${r.operator}`)}}function a7(r,t){const e=r.operator,i=$s(r.args[0]),n=$s(r.args[1]);switch(e){case B.Equal:return s=>i(s)===n(s);case B.NotEqual:return s=>i(s)!==n(s);case B.LessThan:return s=>i(s)<n(s);case B.LessThanOrEqualTo:return s=>i(s)<=n(s);case B.GreaterThan:return s=>i(s)>n(s);case B.GreaterThanOrEqualTo:return s=>i(s)>=n(s);default:throw new Error(`Unsupported comparison operator ${e}`)}}function l7(r,t){const e=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=$s(r.args[s]);switch(e){case B.Any:return s=>{for(let o=0;o<i;++o)if(n[o](s))return!0;return!1};case B.All:return s=>{for(let o=0;o<i;++o)if(!n[o](s))return!1;return!0};case B.Between:return s=>{const o=n[0](s),a=n[1](s),l=n[2](s);return o>=a&&o<=l};case B.In:return s=>{const o=n[0](s);for(let a=1;a<i;++a)if(o===n[a](s))return!0;return!1};case B.Not:return s=>!n[0](s);default:throw new Error(`Unsupported logical operator ${e}`)}}function c7(r,t){const e=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=$s(r.args[s]);switch(e){case B.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=n[a](s);return o};case B.Divide:return s=>n[0](s)/n[1](s);case B.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=n[a](s);return o};case B.Subtract:return s=>n[0](s)-n[1](s);case B.Clamp:return s=>{const o=n[0](s),a=n[1](s);if(o<a)return a;const l=n[2](s);return o>l?l:o};case B.Mod:return s=>n[0](s)%n[1](s);case B.Pow:return s=>Math.pow(n[0](s),n[1](s));case B.Abs:return s=>Math.abs(n[0](s));case B.Floor:return s=>Math.floor(n[0](s));case B.Ceil:return s=>Math.ceil(n[0](s));case B.Round:return s=>Math.round(n[0](s));case B.Sin:return s=>Math.sin(n[0](s));case B.Cos:return s=>Math.cos(n[0](s));case B.Atan:return i===2?s=>Math.atan2(n[0](s),n[1](s)):s=>Math.atan(n[0](s));case B.Sqrt:return s=>Math.sqrt(n[0](s));default:throw new Error(`Unsupported numeric operator ${e}`)}}function h7(r,t){const e=r.args.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=$s(r.args[n]);return n=>{for(let s=0;s<e-1;s+=2)if(i[s](n))return i[s+1](n);return i[e-1](n)}}function u7(r,t){const e=r.args.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=$s(r.args[n]);return n=>{const s=i[0](n);for(let o=1;o<e-1;o+=2)if(s===i[o](n))return i[o+1](n);return i[e-1](n)}}function d7(r,t){const e=r.args.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=$s(r.args[n]);return n=>{const s=i[0](n),o=i[1](n);let a,l;for(let c=2;c<e;c+=2){const h=i[c](n);let u=i[c+1](n);const d=Array.isArray(u);if(d&&(u=tD(u)),h>=o)return c===2?u:d?f7(s,o,a,l,h,u):Nd(s,o,a,l,h,u);a=h,l=u}return l}}function g7(r,t){const e=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=$s(r.args[s]);switch(e){case B.ToString:return s=>{const o=n[0](s);return r.args[0].type===br?ib(o):o.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function Nd(r,t,e,i,n,s){const o=n-e;if(o===0)return i;const a=t-e,l=r===1?a/o:(Math.pow(r,a)-1)/(Math.pow(r,o)-1);return i+l*(s-i)}function f7(r,t,e,i,n,s){if(n-e===0)return i;const o=rT(i),a=rT(s);let l=a[2]-o[2];l>180?l-=360:l<-180&&(l+=360);const c=[Nd(r,t,e,o[0],n,a[0]),Nd(r,t,e,o[1],n,a[1]),o[2]+Nd(r,t,e,0,n,l),Nd(r,t,e,i[3],n,s[3])];return eD(c)}function p7(r){return!0}function m7(r){const t=hb(),e=y7(r,t),i=y4();return function(n,s){if(i.properties=n.getPropertiesInternal(),i.resolution=s,t.featureId){const o=n.getId();o!==void 0?i.featureId=o:i.featureId=null}return t.geometryType&&(i.geometryType=ub(n.getGeometry())),e(i)}}function vT(r){const t=hb(),e=r.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=wx(r[o],t);const n=y4(),s=new Array(e);return function(o,a){if(n.properties=o.getPropertiesInternal(),n.resolution=a,t.featureId){const c=o.getId();c!==void 0?n.featureId=c:n.featureId=null}let l=0;for(let c=0;c<e;++c){const h=i[c](n);h&&(s[l]=h,l+=1)}return s.length=l,s}}function y7(r,t){const e=r.length,i=new Array(e);for(let n=0;n<e;++n){const s=r[n],o="filter"in s?xo(s.filter,hi,t):p7;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=wx(s.style[c],t)}else a=[wx(s.style,t)];i[n]={filter:o,styles:a}}return function(n){const s=[];let o=!1;for(let a=0;a<e;++a){const l=i[a].filter;if(l(n)&&!(r[a].else&&o)){o=!0;for(const c of i[a].styles){const h=c(n);h&&s.push(h)}}}return s}}function wx(r,t){const e=Gg(r,"",t),i=jg(r,"",t),n=_7(r,t),s=v7(r,t),o=Ri(r,"z-index",t);if(!e&&!i&&!n&&!s&&!_l(r))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(r));const a=new ii;return function(l){let c=!0;if(e){const h=e(l);h&&(c=!1),a.setFill(h)}if(i){const h=i(l);h&&(c=!1),a.setStroke(h)}if(n){const h=n(l);h&&(c=!1),a.setText(h)}if(s){const h=s(l);h&&(c=!1),a.setImage(h)}return o&&a.setZIndex(o(l)),c?null:a}}function Gg(r,t,e){let i;if(t+"fill-pattern-src"in r)i=k7(r,t+"fill-",e);else{if(r[t+"fill-color"]==="none")return s=>null;i=E1(r,t+"fill-color",e)}if(!i)return null;const n=new Ds;return function(s){const o=i(s);return o===eb?null:(n.setColor(o),n)}}function jg(r,t,e){const i=Ri(r,t+"stroke-width",e),n=E1(r,t+"stroke-color",e);if(!i&&!n)return null;const s=$o(r,t+"stroke-line-cap",e),o=$o(r,t+"stroke-line-join",e),a=_4(r,t+"stroke-line-dash",e),l=Ri(r,t+"stroke-line-dash-offset",e),c=Ri(r,t+"stroke-miter-limit",e),h=Ri(r,t+"stroke-offset",e),u=new vo;return function(d){if(n){const g=n(d);if(g===eb)return null;u.setColor(g)}if(i&&u.setWidth(i(d)),s){const g=s(d);if(g!=="butt"&&g!=="round"&&g!=="square")throw new Error("Expected butt, round, or square line cap");u.setLineCap(g)}if(o){const g=o(d);if(g!=="bevel"&&g!=="round"&&g!=="miter")throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(g)}return a&&u.setLineDash(a(d)),l&&u.setLineDashOffset(l(d)),c&&u.setMiterLimit(c(d)),h&&u.setOffset(h(d)),u}}function _7(r,t){const e="text-",i=$o(r,e+"value",t);if(!i)return null;const n=Gg(r,e,t),s=Gg(r,e+"background-",t),o=jg(r,e,t),a=jg(r,e+"background-",t),l=$o(r,e+"font",t),c=Ri(r,e+"max-angle",t),h=Ri(r,e+"offset-x",t),u=Ri(r,e+"offset-y",t),d=nu(r,e+"overflow",t),g=$o(r,e+"placement",t),f=Ri(r,e+"repeat",t),p=S1(r,e+"scale",t),m=nu(r,e+"rotate-with-view",t),y=Ri(r,e+"rotation",t),_=$o(r,e+"align",t),x=$o(r,e+"justify",t),v=$o(r,e+"baseline",t),w=nu(r,e+"keep-upright",t),b=_4(r,e+"padding",t),E=T1(r,e+"declutter-mode"),C=new p0({declutterMode:E});return function(S){if(C.setText(i(S)),n&&C.setFill(n(S)),s&&C.setBackgroundFill(s(S)),o&&C.setStroke(o(S)),a&&C.setBackgroundStroke(a(S)),l&&C.setFont(l(S)),c&&C.setMaxAngle(c(S)),h&&C.setOffsetX(h(S)),u&&C.setOffsetY(u(S)),d&&C.setOverflow(d(S)),g){const R=g(S);if(R!=="point"&&R!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(R)}if(f&&C.setRepeat(f(S)),p&&C.setScale(p(S)),m&&C.setRotateWithView(m(S)),y&&C.setRotation(y(S)),_){const R=_(S);if(R!=="left"&&R!=="center"&&R!=="right"&&R!=="end"&&R!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(R)}if(x){const R=x(S);if(R!=="left"&&R!=="right"&&R!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(R)}if(v){const R=v(S);if(R!=="bottom"&&R!=="top"&&R!=="middle"&&R!=="alphabetic"&&R!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(R)}return b&&C.setPadding(b(S)),w&&C.setKeepUpright(w(S)),C}}function v7(r,t){return"icon-src"in r?x7(r,t):"shape-points"in r?w7(r,t):"circle-radius"in r?b7(r,t):null}function x7(r,t){const e="icon-",i=e+"src",n=v4(r[i],i),s=X0(r,e+"anchor",t),o=S1(r,e+"scale",t),a=Ri(r,e+"opacity",t),l=X0(r,e+"displacement",t),c=Ri(r,e+"rotation",t),h=nu(r,e+"rotate-with-view",t),u=wT(r,e+"anchor-origin"),d=bT(r,e+"anchor-x-units"),g=bT(r,e+"anchor-y-units"),f=pa(r,e+"color");let p,m=null;f!==void 0&&(Array.isArray(f)&&f.length>0&&typeof f[0]=="string"?m=E1(r,e+"color",t):p=x4(f,e+"color"));const y=S7(r,e+"cross-origin"),_=T7(r,e+"offset"),x=wT(r,e+"offset-origin"),v=bx(r,e+"width"),w=bx(r,e+"height"),b=E7(r,e+"size"),E=T1(r,e+"declutter-mode"),C={src:n,anchorOrigin:u,anchorXUnits:d,anchorYUnits:g,crossOrigin:y,offset:_,offsetOrigin:x,height:w,width:v,size:b,declutterMode:E};let S=null;return function(R){if(S)m&&S.setColor(m(R));else{const I=m?m(R):p;S=new Df(I!==void 0?Object.assign({},C,{color:I}):Object.assign({},C))}return a&&S.setOpacity(a(R)),l&&S.setDisplacement(l(R)),c&&S.setRotation(c(R)),h&&S.setRotateWithView(h(R)),o&&S.setScale(o(R)),s&&S.setAnchor(s(R)),S}}function w7(r,t){const e="shape-",i=e+"points",n=e+"radius",s=db(r[i],i);if(!(n in r))throw new Error(`Expected a number for ${n}`);const o=Ri(r,n,t),a=typeof r[n]=="number"?r[n]:5,l=e+"radius2",c=Ri(r,l,t),h=typeof r[l]=="number"?r[l]:void 0,u=Gg(r,e,t),d=jg(r,e,t),g=S1(r,e+"scale",t),f=X0(r,e+"displacement",t),p=Ri(r,e+"rotation",t),m=nu(r,e+"rotate-with-view",t),y=bx(r,e+"angle"),_=T1(r,e+"declutter-mode"),x=new ob({points:s,radius:a,radius2:h,angle:y,declutterMode:_});return function(v){return o&&x.setRadius(o(v)),c&&x.setRadius2(c(v)),u&&x.setFill(u(v)),d&&x.setStroke(d(v)),f&&x.setDisplacement(f(v)),p&&x.setRotation(p(v)),m&&x.setRotateWithView(m(v)),g&&x.setScale(g(v)),x}}function b7(r,t){const e="circle-",i=Gg(r,e,t),n=jg(r,e,t),s=Ri(r,e+"radius",t),o=S1(r,e+"scale",t),a=X0(r,e+"displacement",t),l=Ri(r,e+"rotation",t),c=nu(r,e+"rotate-with-view",t),h=T1(r,e+"declutter-mode"),u=new k1({radius:5,declutterMode:h});return function(d){return s&&u.setRadius(s(d)),i&&u.setFill(i(d)),n&&u.setStroke(n(d)),a&&u.setDisplacement(a(d)),l&&u.setRotation(l(d)),c&&u.setRotateWithView(c(d)),o&&u.setScale(o(d)),u}}function pa(r,t){if(!(t in r))return;const e=r[t];return e===void 0?void 0:e}function Ri(r,t,e){const i=pa(r,t);if(i===void 0)return;const n=xo(i,Pt,e);return function(s){return db(n(s),t)}}function $o(r,t,e){const i=pa(r,t);if(i===void 0)return null;const n=xo(i,ui,e);return function(s){return v4(n(s),t)}}function k7(r,t,e){const i=$o(r,t+"pattern-src",e),n=xT(r,t+"pattern-offset",e),s=xT(r,t+"pattern-size",e),o=E1(r,t+"color",e);return function(a){return{src:i(a),offset:n&&n(a),size:s&&s(a),color:o&&o(a)}}}function nu(r,t,e){const i=pa(r,t);if(i===void 0)return null;const n=xo(i,hi,e);return function(s){const o=n(s);if(typeof o!="boolean")throw new Error(`Expected a boolean for ${t}`);return o}}function E1(r,t,e){const i=pa(r,t);if(i===void 0)return null;const n=xo(i,br,e);return function(s){return x4(n(s),t)}}function _4(r,t,e){const i=pa(r,t);if(i===void 0)return null;if(Array.isArray(i)&&(i.length===0||typeof i[0]!="string")){const s=i.map((o,a)=>{if(typeof o=="number")return()=>o;const l=xo(o,Pt,e);return function(c){return db(l(c),`${t}[${a}]`)}});return function(o){const a=new Array(s.length);for(let l=0;l<s.length;++l)a[l]=s[l](o);return a}}const n=xo(i,En,e);return function(s){return $f(n(s),t)}}function X0(r,t,e){const i=pa(r,t);if(i===void 0)return null;const n=xo(i,En,e);return function(s){const o=$f(n(s),t);if(o.length!==2)throw new Error(`Expected two numbers for ${t}`);return o}}function xT(r,t,e){const i=pa(r,t);if(i===void 0)return null;const n=xo(i,En,e);return function(s){return w4(n(s),t)}}function S1(r,t,e){const i=pa(r,t);if(i===void 0)return null;const n=xo(i,En|Pt,e);return function(s){return C7(n(s),t)}}function bx(r,t){const e=r[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function E7(r,t){const e=r[t];if(e!==void 0){if(typeof e=="number")return _i(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function S7(r,t){const e=r[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function wT(r,t){const e=r[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function bT(r,t){const e=r[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function T7(r,t){const e=r[t];if(e!==void 0)return $f(e,t)}function T1(r,t){const e=r[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function $f(r,t){if(!Array.isArray(r))throw new Error(`Expected an array for ${t}`);const e=r.length;for(let i=0;i<e;++i)if(typeof r[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return r}function v4(r,t){if(typeof r!="string")throw new Error(`Expected a string for ${t}`);return r}function db(r,t){if(typeof r!="number")throw new Error(`Expected a number for ${t}`);return r}function x4(r,t){if(typeof r=="string")return r;const e=$f(r,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function w4(r,t){const e=$f(r,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function C7(r,t){return typeof r=="number"?r:w4(r,t)}const _s={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function kT(r,t,e){return(function(i,n,s,o,a){if(!i)return;if(!n&&!t)return i;const l=t?0:s[0]*n,c=t?0:s[1]*n,h=a?a[0]:0,u=a?a[1]:0;let d=r[0]+l/2+h,g=r[2]-l/2+h,f=r[1]+c/2+u,p=r[3]-c/2+u;d>g&&(d=(g+d)/2,g=d),f>p&&(f=(p+f)/2,p=f);let m=dr(i[0],d,g),y=dr(i[1],f,p);if(o&&e&&n){const _=30*n;m+=-_*Math.log(1+Math.max(0,d-i[0])/_)+_*Math.log(1+Math.max(0,i[0]-g)/_),y+=-_*Math.log(1+Math.max(0,f-i[1])/_)+_*Math.log(1+Math.max(0,i[1]-p)/_)}return[m,y]})}function M7(r){return r}function b4(r){return Math.pow(r,3)}function Xu(r){return 1-b4(1-r)}function R7(r){return 3*r*r-2*r*r*r}function I7(r){return r}function gb(r,t,e,i){const n=Te(t)/e[0],s=ti(t)/e[1];return i?Math.min(r,Math.max(n,s)):Math.min(r,Math.min(n,s))}function fb(r,t,e){let i=Math.min(r,t);const n=50;return i*=Math.log(1+n*Math.max(0,r/t-1))/n+1,e&&(i=Math.max(i,e),i/=Math.log(1+n*Math.max(0,e/r-1))/n+1),dr(i,e/2,t*2)}function P7(r,t,e,i){return t=t!==void 0?t:!0,(function(n,s,o,a){if(n!==void 0){const l=r[0],c=r[r.length-1],h=e?gb(l,e,o,i):l;if(a)return t?fb(n,h,c):dr(n,c,h);const u=Math.min(h,n),d=Math.floor(u1(r,u,s));return r[d]>h&&d<r.length-1?r[d+1]:r[d]}})}function A7(r,t,e,i,n,s){return i=i!==void 0?i:!0,e=e!==void 0?e:0,(function(o,a,l,c){if(o!==void 0){const h=n?gb(t,n,l,s):t;if(c)return i?fb(o,h,e):dr(o,e,h);const u=1e-9,d=Math.ceil(Math.log(t/h)/Math.log(r)-u),g=-a*(.5-u)+.5,f=Math.min(h,o),p=Math.floor(Math.log(t/f)/Math.log(r)+g),m=Math.max(d,p),y=t/Math.pow(r,m);return dr(y,e,h)}})}function ET(r,t,e,i,n){return e=e!==void 0?e:!0,(function(s,o,a,l){if(s!==void 0){const c=i?gb(r,i,a,n):r;return!e||!l?dr(s,t,c):fb(s,c,t)}})}function pb(r){if(r!==void 0)return 0}function ST(r){if(r!==void 0)return r}function L7(r){const t=2*Math.PI/r;return(function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e})}function O7(r){const t=hl(5);return(function(e,i){return i||e===void 0?e:Math.abs(e)<=t?0:e})}const k4=42,mb=256,c_=0;class Ks extends So{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Gw(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&fN(),t.center&&(t.center=Oo(t.center,this.projection_)),t.extent&&(t.extent=Ms(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in _s)delete e[a];this.setProperties(e,!0);const i=N7(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=F7(t),s=i.constraint,o=D7(t);this.constraints_={center:n,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),o=s/2*(n[3]-e[3]+e[1]-n[1]),a=s/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let n=arguments[i];n.center&&(n=Object.assign({},n),n.center=Oo(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=Oo(n.anchor,this.getProjection())),e[i]=n}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let n=0;for(;n<e&&!this.isDef();++n){const h=arguments[n];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(n===e){i&&bp(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;n<e;++n){const h=arguments[n],u={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||R7,callback:i};if(h.center&&(u.sourceCenter=o,u.targetCenter=h.center.slice(),o=u.targetCenter),h.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(h.zoom),a=u.targetResolution):h.resolution&&(u.sourceResolution=a,u.targetResolution=h.resolution,a=u.targetResolution),h.rotation!==void 0){u.sourceRotation=l;const d=uc(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+d,l=u.targetRotation}$7(u)?u.complete=!0:s+=u.duration,c.push(u)}this.animations_.push(c),this.setHint(ur.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ur.ANIMATING]>0}getInteracting(){return this.hints_[ur.INTERACTING]>0}cancelAnimations(){this.setHint(ur.ANIMATING,-this.hints_[ur.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){const n=this.animations_[e];if(n[0].callback&&bp(n[0].callback,!1),!t)for(let s=0,o=n.length;s<o;++s){const a=n[s];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let s=!0;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(l.complete)continue;const c=t-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const u=l.easing(h);if(l.sourceCenter){const d=l.sourceCenter[0],g=l.sourceCenter[1],f=l.targetCenter[0],p=l.targetCenter[1];this.nextCenter_=l.targetCenter;const m=d+u*(f-d),y=g+u*(p-g);this.targetCenter_=[m,y]}if(l.sourceResolution&&l.targetResolution){const d=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const g=this.getViewportSize_(this.getRotation()),f=this.constraints_.resolution(d,0,g,!0);this.targetCenter_=this.calculateCenterZoom(f,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=u===1?uc(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const g=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(g,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(ur.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=n[0].callback;o&&bp(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();return n!==void 0&&(i=[n[0]-e[0],n[1]-e[1]],Lw(i,t-this.getRotation()),_R(i,e)),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),s=this.getResolution();if(n!==void 0&&s!==void 0){const o=e[0]-t*(e[0]-n[0])/s,a=e[1]-t*(e[1]-n[1])/s;i=[o,a]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&ax(t,this.getProjection())}getCenterInternal(){return this.get(_s.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return jw(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();_e(e,"The view center is not defined");const i=this.getResolution();_e(i!==void 0,"The view resolution is not defined");const n=this.getRotation();return _e(n!==void 0,"The view rotation is not defined"),Ag(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(_s.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Ms(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=Te(t)/e[0],n=ti(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return(function(s){return e/Math.pow(t,s*n)})}getRotation(){return this.get(_s.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(i/n)/e;return(function(o){return Math.log(i/o)/e/s})}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();n=h_(n,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],e,i)}return{center:n.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,n;if(this.resolutions_){const s=u1(this.resolutions_,t,1);e=s,i=this.resolutions_[s],s==this.resolutions_.length-1?n=2:n=i/this.resolutions_[s+1]}else i=this.maxResolution_,n=this.zoomFactor_;return e+Math.log(i/t)/Math.log(n)}getResolutionForZoom(t){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const e=dr(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,dr(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(_e(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){_e(!fa(t),"Cannot fit empty extent provided as `geometry`");const n=Ms(t,this.getProjection());i=tT(n)}else if(t.getType()==="Circle"){const n=Ms(t.getExtent(),this.getProjection());i=tT(n),i.rotate(this.getRotation(),Ns(n))}else i=t;this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),s=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,c=-1/0,h=-1/0;for(let u=0,d=s.length;u<d;u+=o){const g=s[u]*i-s[u+1]*n,f=s[u]*n+s[u+1]*i;a=Math.min(a,g),l=Math.min(l,f),c=Math.max(c,g),h=Math.max(h,f)}return[a,l,c,h]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());const n=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),u=Math.cos(c),d=Ns(a);d[0]+=(n[1]-n[3])/2*l,d[1]+=(n[0]-n[2])/2*l;const g=d[0]*u-d[1]*h,f=d[1]*u+d[0]*h,p=this.getConstrainedCenter([g,f],l),m=e.callback?e.callback:Ig;e.duration!==void 0?this.animateInternal({resolution:l,center:p,duration:e.duration,easing:e.easing},m):(this.targetResolution_=l,this.targetCenter_=p,this.applyTargetState_(!1,!0),bp(m,!0))}centerOn(t,e,i){this.centerOnInternal(Oo(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(h_(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let s;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),l=h_(t,n,[a[0]/2+o[3],a[1]/2+o[0]],e,i);s=[t[0]-l[0],t[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=ax(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Oo(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Oo(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Oo(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,n,s));this.get(_s.ROTATION)!==n&&this.set(_s.ROTATION,n),this.get(_s.RESOLUTION)!==o&&(this.set(_s.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(_s.CENTER)||!G0(this.get(_s.CENTER),a))&&this.set(_s.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const n=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,n,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!G0(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:t,easing:Xu,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ur.INTERACTING,1)}endInteraction(t,e,i){i=i&&Oo(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(ur.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}}function bp(r,t){setTimeout(function(){r(t)},0)}function F7(r){if(r.extent!==void 0){const e=r.smoothExtentConstraint!==void 0?r.smoothExtentConstraint:!0;return kT(r.extent,r.constrainOnlyCenter,e)}const t=Gw(r.projection,"EPSG:3857");if(r.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,kT(e,!1,!1)}return M7}function N7(r){let t,e,i,n=r.minZoom!==void 0?r.minZoom:c_,s=r.maxZoom!==void 0?r.maxZoom:28;const o=r.zoomFactor!==void 0?r.zoomFactor:2,a=r.multiWorld!==void 0?r.multiWorld:!1,l=r.smoothResolutionConstraint!==void 0?r.smoothResolutionConstraint:!0,c=r.showFullExtent!==void 0?r.showFullExtent:!1,h=Gw(r.projection,"EPSG:3857"),u=h.getExtent();let d=r.constrainOnlyCenter,g=r.extent;if(!a&&!g&&h.isGlobal()&&(d=!1,g=u),r.resolutions!==void 0){const f=r.resolutions;e=f[n],i=f[s]!==void 0?f[s]:f[f.length-1],r.constrainResolution?t=P7(f,l,!d&&g,c):t=ET(e,i,l,!d&&g,c)}else{const f=(u?Math.max(Te(u),ti(u)):360*Fw.degrees/h.getMetersPerUnit())/mb/Math.pow(2,c_),p=f/Math.pow(2,28-c_);e=r.maxResolution,e!==void 0?n=0:e=f/Math.pow(o,n),i=r.minResolution,i===void 0&&(r.maxZoom!==void 0?r.maxResolution!==void 0?i=e/Math.pow(o,s):i=f/Math.pow(o,s):i=p),s=n+Math.floor(Math.log(e/i)/Math.log(o)),i=e/Math.pow(o,s-n),r.constrainResolution?t=A7(o,e,i,l,!d&&g,c):t=ET(e,i,l,!d&&g,c)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:n,zoomFactor:o}}function D7(r){if(r.enableRotation===void 0||r.enableRotation){const t=r.constrainRotation;return t===void 0||t===!0?O7():t===!1?ST:typeof t=="number"?L7(t):ST}return pb}function $7(r){return!(r.sourceCenter&&r.targetCenter&&!G0(r.sourceCenter,r.targetCenter)||r.sourceResolution!==r.targetResolution||r.sourceRotation!==r.targetRotation)}function h_(r,t,e,i,n){const s=Math.cos(-n);let o=Math.sin(-n),a=r[0]*s-r[1]*o,l=r[1]*s+r[0]*o;a+=(t[0]/2-e[0])*i,l+=(e[1]-t[1]/2)*i,o=-o;const c=a*s-l*o,h=l*s+a*o;return[c,h]}const Be={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class E4 extends So{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[Be.OPACITY]=t.opacity!==void 0?t.opacity:1,_e(typeof e[Be.OPACITY]=="number","Layer opacity must be a number"),e[Be.VISIBLE]=t.visible!==void 0?t.visible:!0,e[Be.Z_INDEX]=t.zIndex,e[Be.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[Be.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[Be.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[Be.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=dr(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return Qt()}getLayerStatesArray(t){return Qt()}getExtent(){return this.get(Be.EXTENT)}getMaxResolution(){return this.get(Be.MAX_RESOLUTION)}getMinResolution(){return this.get(Be.MIN_RESOLUTION)}getMinZoom(){return this.get(Be.MIN_ZOOM)}getMaxZoom(){return this.get(Be.MAX_ZOOM)}getOpacity(){return this.get(Be.OPACITY)}getSourceState(){return Qt()}getVisible(){return this.get(Be.VISIBLE)}getZIndex(){return this.get(Be.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Be.EXTENT,t)}setMaxResolution(t){this.set(Be.MAX_RESOLUTION,t)}setMinResolution(t){this.set(Be.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(Be.MAX_ZOOM,t)}setMinZoom(t){this.set(Be.MIN_ZOOM,t)}setOpacity(t){_e(typeof t=="number","Layer opacity must be a number"),this.set(Be.OPACITY,t)}setVisible(t){this.set(Be.VISIBLE,t)}setZIndex(t){this.set(Be.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}let Hc=class extends E4{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(Be.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(Be.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(or(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=Se(t,Bt.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof Ks?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let n;if(e.layerStatesArray){if(n=e.layerStatesArray.find(o=>o.layer===this),!n)return!1}else n=this.getLayerState();const s=this.getExtent();return yb(n,e.viewState)&&(!s||zr(s,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];const i=t instanceof Ks?t.getViewStateAndExtent():t;let n=e(i);return Array.isArray(n)||(n=[n]),n}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(Be.MAP,t)}getMapInternal(){return this.get(Be.MAP)}setMap(t){this.mapPrecomposeKey_&&(or(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(or(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Se(t,yi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Se(this,Bt.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);_e(!e.some(n=>n.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}setSource(t){this.set(Be.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}};function yb(r,t){if(!r.visible)return!1;const e=t.resolution;if(e<r.minResolution||e>=r.maxResolution)return!1;const i=t.zoom;return i>r.minZoom&&i<=r.maxZoom}const TT={RENDER_ORDER:"renderOrder"};class C1 extends Hc{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(TT.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter||(t.declutter[i]=new h1(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(TT.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?o4:t;const e=G7(t);this.styleFunction_=t===null?void 0:RD(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}}function G7(r){if(r===void 0)return o4;if(!r)return null;if(typeof r=="function"||r instanceof ii)return r;if(!Array.isArray(r))return vT([r]);if(r.length===0)return[];const t=r.length,e=r[0];if(e instanceof ii){const i=new Array(t);for(let n=0;n<t;++n){const s=r[n];if(!(s instanceof ii))throw new Error("Expected a list of style instances");i[n]=s}return i}if("style"in e){const i=new Array(t);for(let n=0;n<t;++n){const s=r[n];if(!("style"in s))throw new Error("Expected a list of rules with a style property");i[n]=s}return m7(i)}return vT(r)}const _t={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};let Gf=class extends Zu{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Bt.CHANGE)}release(){this.setState(_t.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==_t.EMPTY){if(this.state!==_t.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){Qt()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(!i)i=e,this.transitionStarts_[t]=i;else if(i===-1)return 1;const n=e-i+1e3/60;return n>=this.transition_?1:b4(n/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}},_b=class extends Gf{constructor(t,e,i,n,s,o){super(t,e,o),this.crossOrigin_=n?.crossOrigin,this.referrerPolicy_=n?.referrerPolicy,this.src_=i,this.key=i,this.image_,Yn?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_),this.referrerPolicy_!==void 0&&(this.image_.referrerPolicy=this.referrerPolicy_)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=_t.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}getReferrerPolicy(){return this.referrerPolicy_}handleImageError_(){this.state=_t.ERROR,this.unlistenImage_(),this.image_=j7(),this.changed()}handleImageLoad_(){if(Yn)this.state=_t.LOADED;else{const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=_t.LOADED:this.state=_t.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==_t.ERROR&&(this.state=_t.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_),this.referrerPolicy_!==void 0&&(this.image_.referrerPolicy=this.referrerPolicy_)),this.state==_t.IDLE&&(this.state=_t.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=rD(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}};function j7(){const r=Hr(1,1);return r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1),r.canvas}let M1=class{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}};function ch(r,t,e,i,n){return n!==void 0?(n.minX=r,n.maxX=t,n.minY=e,n.maxY=i,n):new M1(r,t,e,i)}const Vi={target:"map",epsg:"EPSG:25832",backgroundImage:"",extent:[51e4,585e4,625000.4,6e6],options:[{resolution:66.14579761460263,scale:25e4,zoomLevel:0},{resolution:26.458319045841044,scale:1e5,zoomLevel:1},{resolution:15.874991427504629,scale:6e4,zoomLevel:2},{resolution:10.583327618336419,scale:4e4,zoomLevel:3},{resolution:5.2916638091682096,scale:2e4,zoomLevel:4},{resolution:2.6458319045841048,scale:1e4,zoomLevel:5},{resolution:1.3229159522920524,scale:5e3,zoomLevel:6},{resolution:.6614579761460262,scale:2500,zoomLevel:7},{resolution:.2645831904584105,scale:1e3,zoomLevel:8},{resolution:.1322915952292052,scale:500,zoomLevel:9}],namedProjections:[["EPSG:25832","+proj=utm +zone=32 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"]],startResolution:15.874991427504629,startCenter:[565874,5934140],layerConf:"https://geodienste.hamburg.de/services-internet.json",layers:[{id:"453",visibility:!0}],gazetteerUrl:"https://geodienste.hamburg.de/HH_WFS_GAGES?service=WFS&request=GetFeature&version=2.0.0",showGeographicIdentifier:!1,sceneOptions:{camera:{enableTerrainAdjustmentWhenLoading:!0},globe:{depthTestAgainstTerrain:!0},highDynamicRange:!1,pickTranslucentDepth:!0,shadowMap:{darkness:.6,maximumDistance:5e3,size:2048},shadows:!1}};function kx(r){return r instanceof Image||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageBitmap?r:null}const z7=new Error("disposed"),q7=[256,256];class CT extends Gf{constructor(t){const e=_t.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=kx(this.data_);return t?[t.width,t.height]:q7}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==_t.IDLE&&this.state!==_t.ERROR)return;this.state=_t.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=_t.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=_t.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(z7),this.controller_=null),super.disposeInternal()}}let u_;const su=[];function MT(r,t,e,i,n){r.beginPath(),r.moveTo(0,0),r.lineTo(t,e),r.lineTo(i,n),r.closePath(),r.save(),r.clip(),r.fillRect(0,0,Math.max(t,i)+1,Math.max(e,n)),r.restore()}function d_(r,t){return Math.abs(r[t*4]-210)>2||Math.abs(r[t*4+3]-.75*255)>2}function B7(){if(u_===void 0){const r=Hr(6,6,su);r.globalCompositeOperation="lighter",r.fillStyle="rgba(210, 0, 0, 0.75)",MT(r,4,5,4,0),MT(r,4,5,0,5);const t=r.getImageData(0,0,3,3).data;u_=d_(t,0)||d_(t,4)||d_(t,8),Ff(r),su.push(r.canvas)}return u_}function zg(r,t,e,i){const n=Mu(e,t,r);let s=YS(t,i,e);const o=t.getMetersPerUnit();o!==void 0&&(s*=o);const a=r.getMetersPerUnit();a!==void 0&&(s/=a);const l=r.getExtent();if(!l||Mc(l,n)){const c=YS(r,s,n)/s;isFinite(c)&&c>0&&(s/=c)}return s}function U7(r,t,e,i){const n=Ns(e);let s=zg(r,t,n,i);return(!isFinite(s)||s<=0)&&fR(e,function(o){return s=zg(r,t,o,i),isFinite(s)&&s>0}),s}function S4(r,t,e,i,n,s,o,a,l,c,h,u,d,g){const f=Hr(Math.round(e*r),Math.round(e*t),su);if(u||(f.imageSmoothingEnabled=!1),l.length===0)return f.canvas;f.scale(e,e);function p(w){return Math.round(w*e)/e}f.globalCompositeOperation="lighter";const m=sn();l.forEach(function(w,b,E){dR(m,w.extent)});let y;const _=e/i,x=(u?1:1+Math.pow(2,-24))/_;(!d||l.length!==1||c!==0)&&(y=Hr(Math.round(Te(m)*_),Math.round(ti(m)*_),su),u||(y.imageSmoothingEnabled=!1),l.forEach(function(w,b,E){if(w.image.width>0&&w.image.height>0){if(w.clipExtent){y.save();const F=(w.clipExtent[0]-m[0])*_,N=-(w.clipExtent[3]-m[3])*_,P=Te(w.clipExtent)*_,T=ti(w.clipExtent)*_;y.rect(u?F:Math.round(F),u?N:Math.round(N),u?P:Math.round(F+P)-Math.round(F),u?T:Math.round(N+T)-Math.round(N)),y.clip()}const C=(w.extent[0]-m[0])*_,S=-(w.extent[3]-m[3])*_,R=Te(w.extent)*_,I=ti(w.extent)*_;y.drawImage(w.image,c,c,w.image.width-2*c,w.image.height-2*c,u?C:Math.round(C),u?S:Math.round(S),u?R:Math.round(C+R)-Math.round(C),u?I:Math.round(S+I)-Math.round(S)),w.clipExtent&&y.restore()}}));const v=_o(o);return a.getTriangles().forEach(function(w,b,E){const C=w.source,S=w.target;let R=C[0][0],I=C[0][1],F=C[1][0],N=C[1][1],P=C[2][0],T=C[2][1];const D=p((S[0][0]-v[0])/s),A=p(-(S[0][1]-v[1])/s),$=p((S[1][0]-v[0])/s),z=p(-(S[1][1]-v[1])/s),j=p((S[2][0]-v[0])/s),et=p(-(S[2][1]-v[1])/s),q=R,vt=I;R=0,I=0,F-=q,N-=vt,P-=q,T-=vt;const jt=[[F,N,0,0,$-D],[P,T,0,0,j-D],[0,0,F,N,z-A],[0,0,P,T,et-A]],V=qF(jt);if(!V)return;if(f.save(),f.beginPath(),B7()||!u){f.moveTo($,z);const Et=4,Mt=D-$,Ot=A-z;for(let Y=0;Y<Et;Y++)f.lineTo($+p((Y+1)*Mt/Et),z+p(Y*Ot/(Et-1))),Y!=Et-1&&f.lineTo($+p((Y+1)*Mt/Et),z+p((Y+1)*Ot/(Et-1)));f.lineTo(j,et)}else f.moveTo($,z),f.lineTo(D,A),f.lineTo(j,et);f.clip(),f.transform(V[0],V[2],V[1],V[3],D,A),f.translate(m[0]-q,m[3]-vt);let It;if(y)It=y.canvas,f.scale(x,-x);else{const Et=l[0],Mt=Et.extent;It=Et.image,f.scale(Te(Mt)/It.width,-ti(Mt)/It.height)}f.drawImage(It,0,0),f.restore()}),y&&(Ff(y),su.push(y.canvas)),h&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach(function(w,b,E){const C=w.target,S=(C[0][0]-v[0])/s,R=-(C[0][1]-v[1])/s,I=(C[1][0]-v[0])/s,F=-(C[1][1]-v[1])/s,N=(C[2][0]-v[0])/s,P=-(C[2][1]-v[1])/s;f.beginPath(),f.moveTo(I,F),f.lineTo(S,R),f.lineTo(N,P),f.closePath(),f.stroke()}),f.restore()),f.canvas}const W7=10,RT=.25;class T4{constructor(t,e,i,n,s,o,a){this.sourceProj_=t,this.targetProj_=e;let l={};const c=a?ox(x=>Ir(a,Mu(x,this.targetProj_,this.sourceProj_))):Ic(this.targetProj_,this.sourceProj_);this.transformInv_=function(x){const v=x[0]+"/"+x[1];return l[v]||(l[v]=c(x)),l[v]},this.maxSourceExtent_=n,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Te(n)>=Te(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Te(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Te(this.targetProj_.getExtent()):null;const h=_o(i),u=cc(i),d=Tu(i),g=lc(i),f=this.transformInv_(h),p=this.transformInv_(u),m=this.transformInv_(d),y=this.transformInv_(g),_=W7+(o?Math.max(0,Math.ceil(Math.log2(ex(i)/(o*o*256*256)))):0);if(this.addQuad_(h,u,d,g,f,p,m,y,_),this.wrapsXInSource_){let x=1/0;this.triangles_.forEach(function(v,w,b){x=Math.min(x,v.source[0][0],v.source[1][0],v.source[2][0])}),this.triangles_.forEach(v=>{if(Math.max(v.source[0][0],v.source[1][0],v.source[2][0])-x>this.sourceWorldWidth_/2){const w=[[v.source[0][0],v.source[0][1]],[v.source[1][0],v.source[1][1]],[v.source[2][0],v.source[2][1]]];w[0][0]-x>this.sourceWorldWidth_/2&&(w[0][0]-=this.sourceWorldWidth_),w[1][0]-x>this.sourceWorldWidth_/2&&(w[1][0]-=this.sourceWorldWidth_),w[2][0]-x>this.sourceWorldWidth_/2&&(w[2][0]-=this.sourceWorldWidth_);const b=Math.min(w[0][0],w[1][0],w[2][0]);Math.max(w[0][0],w[1][0],w[2][0])-b<this.sourceWorldWidth_/2&&(v.source=w)}})}l={}}addTriangle_(t,e,i,n,s,o){this.triangles_.push({source:[n,s,o],target:[t,e,i]})}addQuad_(t,e,i,n,s,o,a,l,c){const h=Pg([s,o,a,l]),u=this.sourceWorldWidth_?Te(h)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&u>.5&&u<1;let f=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const m=Pg([t,e,i,n]);f=Te(m)/this.targetWorldWidth_>RT||f}!g&&this.sourceProj_.isGlobal()&&u&&(f=u>RT||f)}if(!f&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!zr(h,this.maxSourceExtent_))return;let p=0;if(!f&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)f=!0;else if(p=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),p!=1&&p!=2&&p!=4&&p!=8)return}if(c>0){if(!f){const m=[(t[0]+i[0])/2,(t[1]+i[1])/2],y=this.transformInv_(m);let _;g?_=(uc(s[0],d)+uc(a[0],d))/2-uc(y[0],d):_=(s[0]+a[0])/2-y[0];const x=(s[1]+a[1])/2-y[1];f=_*_+x*x>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const m=[(e[0]+i[0])/2,(e[1]+i[1])/2],y=this.transformInv_(m),_=[(n[0]+t[0])/2,(n[1]+t[1])/2],x=this.transformInv_(_);this.addQuad_(t,e,m,_,s,o,y,x,c-1),this.addQuad_(_,m,i,n,x,y,a,l,c-1)}else{const m=[(t[0]+e[0])/2,(t[1]+e[1])/2],y=this.transformInv_(m),_=[(i[0]+n[0])/2,(i[1]+n[1])/2],x=this.transformInv_(_);this.addQuad_(t,m,_,n,s,y,x,l,c-1),this.addQuad_(m,e,i,_,y,o,a,x,c-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(p&11)==0&&this.addTriangle_(t,i,n,s,a,l),(p&14)==0&&this.addTriangle_(t,i,e,s,a,o),p&&((p&13)==0&&this.addTriangle_(e,n,t,o,l,s),(p&7)==0&&this.addTriangle_(e,n,i,o,l,a))}calculateSourceExtent(){const t=sn();return this.triangles_.forEach(function(e,i,n){const s=e.source;Xd(t,s[0]),Xd(t,s[1]),Xd(t,s[2])}),t}getTriangles(){return this.triangles_}}const C4=.5;let M4=class extends Gf{constructor(t,e,i,n,s,o,a,l,c,h,u,d){super(s,_t.IDLE,d),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const g=n.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const m=f?bn(g,f):g;if(ex(m)===0){this.state=_t.EMPTY;return}const y=t.getExtent();y&&(p?p=bn(p,y):p=y);const _=n.getResolution(this.wrappedTileCoord_[0]),x=U7(t,i,m,_);if(!isFinite(x)||x<=0){this.state=_t.EMPTY;return}const v=h!==void 0?h:C4;if(this.triangulation_=new T4(t,i,m,p,x*v,_),this.triangulation_.getTriangles().length===0){this.state=_t.EMPTY;return}this.sourceZ_=e.getZForResolution(x);let w=this.triangulation_.calculateSourceExtent();if(p&&(t.canWrapX()?(w[1]=dr(w[1],p[1],p[3]),w[3]=dr(w[3],p[1],p[3])):w=bn(w,p)),!ex(w))this.state=_t.EMPTY;else{let b=0,E=0;t.canWrapX()&&(b=Te(y),E=Math.floor((w[0]-y[0])/b)),mR(w.slice(),t,!0).forEach(C=>{const S=e.getTileRangeForExtentAndZ(C,this.sourceZ_);for(let R=S.minX;R<=S.maxX;R++)for(let I=S.minY;I<=S.maxY;I++){const F=E*b;this.sourceTiles_.push({getTile:()=>c(this.sourceZ_,R,I,a),offset:F})}++E}),this.sourceTiles_.length===0&&(this.state=_t.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{const i=e.tile;if(i&&i.getState()==_t.LOADED){const n=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);n[0]+=e.offset,n[2]+=e.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=e.offset,s[2]+=e.offset),t.push({extent:n,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=_t.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=S4(n,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=_t.LOADED}this.changed()}load(){for(const t of this.sourceTiles_)t.tile=t.getTile();if(this.state==_t.IDLE){this.state=_t.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(i==_t.IDLE||i==_t.LOADING){t++;const n=Se(e,Bt.CHANGE,s=>{const o=e.getState();(o==_t.LOADED||o==_t.ERROR||o==_t.EMPTY)&&(or(n),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},i,n){e.getState()==_t.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(or),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Ff(this.canvas_.getContext("2d")),su.push(this.canvas_),this.canvas_=null),this.sourceTiles_.length=0,super.release()}},Ex=class{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof Rf&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return _e(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return _e(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.key_;return t}getValues(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){_e(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function Pu(r,t,e,i){return i!==void 0?(i[0]=r,i[1]=t,i[2]=e,i):[r,t,e]}function R4(r,t,e){return r+"/"+t+"/"+e}function Mh(r){return R4(r[0],r[1],r[2])}function m0(r,t,e,i,n){return`${Rt(r)},${t},${R4(e,i,n)}`}function I4(r){return V7(r[0],r[1],r[2])}function V7(r,t,e){return(t<<r)+e}function Z7(r,t){const e=r[0],i=r[1],n=r[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const s=t.getFullTileRange(e);return s?s.containsXY(i,n):!0}function g_(r,t,e){if(!(e in r))return r[e]=new Set([t]),!0;const i=r[e],n=i.has(t);return n||i.add(t),!n}function H7(r,t,e){const i=r[e];return i?i.delete(t):!1}function IT(r,t){const e=r.layerStatesArray[r.layerIndex];e.extent&&(t=bn(t,Ms(e.extent,r.viewState.projection)));const i=e.layer.getRenderSource();if(!i.getWrapX()){const n=i.getTileGridForProjection(r.viewState.projection).getExtent();n&&(t=bn(t,n))}return t}let P4=class extends lb{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=sn(),this.tempTileRange_=new M1(0,0,0,0),this.tempTileCoord_=Pu(0,0,0);const i=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new Ex(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new Ex(512)),this.sourceTileCache_}getOrCreateTile(t,e,i,n){const s=this.tileCache_,o=this.getLayer().getSource(),a=m0(o,o.getKey(),t,e,i);let l;if(s.containsKey(a))l=s.get(a);else{const c=n.viewState.projection,h=o.getProjection();if(l=o.getTile(t,e,i,n.pixelRatio,c,!h||ci(h,c)?void 0:this.getSourceTileCache()),!l)return null;s.set(a,l)}return l}getTile(t,e,i,n){return this.getOrCreateTile(t,e,i,n)||null}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=Ir(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!Mc(s,n))return null;const o=e.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(e.pixelRatio);for(let h=l.getZForResolution(o.resolution);h>=l.getMinZoom();--h){const u=l.getTileCoordForCoordAndZ(n,h),d=this.getTile(h,u[1],u[2],e);if(!d||d.getState()!==_t.LOADED)continue;const g=l.getOrigin(h),f=_i(l.getTileSize(h)),p=l.getResolution(h);let m;if(d instanceof _b||d instanceof M4)m=d.getImage();else if(d instanceof CT){if(m=kx(d.getData()),!m)continue}else continue;const y=Math.floor(c*((n[0]-g[0])/p-u[1]*f[0])),_=Math.floor(c*((g[1]-n[1])/p-u[2]*f[1])),x=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(m,y+x,_+x)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const i=e.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===e.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(t,e,i,n,s){const o=t.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=Rt(l);h in t.wantedTiles||(t.wantedTiles[h]={});const u=t.wantedTiles[h],d=a.getMapInternal(),g=Math.max(i-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),f=o.rotation,p=f?Aw(o.center,o.resolution,f,t.size):void 0;for(let m=i;m>=g;--m){const y=c.getTileRangeForExtentAndZ(e,m,this.tempTileRange_),_=c.getResolution(m);for(let x=y.minX;x<=y.maxX;++x)for(let v=y.minY;v<=y.maxY;++v){if(f&&!c.tileCoordIntersectsViewport([m,x,v],p))continue;const w=this.getTile(m,x,v,t);if(!w||!g_(n,w,m))continue;const b=w.getKey();if(u[b]=!0,w.getState()===_t.IDLE&&!t.tileQueue.isKeyQueued(b)){const E=Pu(m,x,v,this.tempTileCoord_);t.tileQueue.enqueue([w,h,c.getTileCoordCenter(E),_])}}}}findStaleTile_(t,e){const i=this.tileCache_,n=t[0],s=t[1],o=t[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=m0(this.getLayer().getSource(),a[l],n,s,o);if(i.containsKey(c)){const h=i.peek(c);if(h.getState()===_t.LOADED)return h.endTransition(Rt(this)),g_(e,h,n),!0}}return!1}findAltTiles_(t,e,i,n){const s=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let u=s.minY;u<=s.maxY;++u){const d=m0(l,c,i,h,u);let g=!1;if(a.containsKey(d)){const f=a.peek(d);f.getState()===_t.LOADED&&(g_(n,f,i),g=!0)}g||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const i=t.layerStatesArray[t.layerIndex],n=t.viewState,s=n.projection,o=n.resolution,a=n.center,l=t.pixelRatio,c=this.getLayer(),h=c.getSource(),u=h.getTileGridForProjection(s),d=u.getZForResolution(o,h.zDirection),g=u.getResolution(d),f=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==f&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=f):this.renderedSourceKey_=f;let p=t.extent;const m=h.getTilePixelRatio(l);this.prepareContainer(t,e);const y=this.context.canvas.width,_=this.context.canvas.height,x=i.extent&&Ms(i.extent);x&&(p=bn(p,Ms(i.extent)));const v=g*y/2/m,w=g*_/2/m,b=[a[0]-v,a[1]-w,a[0]+v,a[1]+w],E={};this.renderedTiles.length=0;const C=c.getPreload();if(t.nextExtent&&this.enqueueTilesForNextExtent()){const $=u.getZForResolution(n.nextResolution,h.zDirection),z=IT(t,t.nextExtent);this.enqueueTiles(t,z,$,E,C)}const S=IT(t,p);if(this.enqueueTiles(t,S,d,E,0),C>0&&setTimeout(()=>{this.enqueueTiles(t,S,d-1,E,C-1)},0),!(d in E))return this.container;const R=Rt(this),I=t.time;for(const $ of E[d]){const z=$.getState();if(z===_t.EMPTY)continue;const j=$.tileCoord;if(z===_t.LOADED&&$.getAlpha(R,I)===1){$.endTransition(R);continue}if(z!==_t.ERROR&&(this.renderComplete=!1),this.findStaleTile_(j,E)){H7(E,$,d),t.animate=!0;continue}if(this.findAltTiles_(u,j,d+1,E))continue;const et=u.getMinZoom();for(let q=d-1;q>=et&&!this.findAltTiles_(u,j,q,E);--q);}const F=g/o*l/m,N=this.getRenderContext(t);us(this.tempTransform,y/2,_/2,F,F,0,-y/2,-_/2),i.extent&&this.clipUnrotated(N,t,x),h.getInterpolate()||(N.imageSmoothingEnabled=!1),this.preRender(N,t);const P=Object.keys(E).map(Number);P.sort(lo);let T;const D=[],A=[];for(let $=P.length-1;$>=0;--$){const z=P[$],j=h.getTilePixelSize(z,l,s),et=u.getResolution(z)/g,q=j[0]*et*F,vt=j[1]*et*F,jt=u.getTileCoordForCoordAndZ(_o(b),z),V=u.getTileCoordExtent(jt),It=Ir(this.tempTransform,[m*(V[0]-b[0])/g,m*(b[3]-V[3])/g]),Et=m*h.getGutterForProjection(s);for(const Mt of E[z]){if(Mt.getState()!==_t.LOADED)continue;const Ot=Mt.tileCoord,Y=jt[1]-Ot[1],We=Math.round(It[0]-(Y-1)*q),L=jt[2]-Ot[2],O=Math.round(It[1]-(L-1)*vt),U=Math.round(It[0]-Y*q),X=Math.round(It[1]-L*vt),W=We-U,K=O-X,it=P.length===1;let ot=!1;T=[U,X,U+W,X,U+W,X+K,U,X+K];for(let rt=0,H=D.length;rt<H;++rt)if(!it&&z<A[rt]){const ut=D[rt];zr([U,X,U+W,X+K],[ut[0],ut[3],ut[4],ut[7]])&&(ot||(N.save(),ot=!0),N.beginPath(),N.moveTo(T[0],T[1]),N.lineTo(T[2],T[3]),N.lineTo(T[4],T[5]),N.lineTo(T[6],T[7]),N.moveTo(ut[6],ut[7]),N.lineTo(ut[4],ut[5]),N.lineTo(ut[2],ut[3]),N.lineTo(ut[0],ut[1]),N.clip())}D.push(T),A.push(z),this.drawTile(Mt,t,U,X,W,K,Et,it),ot&&N.restore(),this.renderedTiles.unshift(Mt),this.updateUsedTiles(t.usedTiles,h,Mt)}}if(this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!vl(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=l,this.postRender(this.context,t),i.extent&&N.restore(),N.imageSmoothingEnabled=!0,this.renderComplete){const $=(z,j)=>{const et=Rt(h),q=j.wantedTiles[et],vt=q?Object.keys(q).length:0;this.updateCacheSize(vt),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};t.postRenderFunctions.push($)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,i,n,s,o,a,l){let c;if(t instanceof CT){if(c=kx(t.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(t);if(!c)return;const h=this.getRenderContext(e),u=Rt(this),d=e.layerStatesArray[e.layerIndex],g=d.opacity*(l?t.getAlpha(u,e.time):1),f=g!==h.globalAlpha;f&&(h.save(),h.globalAlpha=g),h.drawImage(c,a,a,c.width-2*a,c.height-2*a,i,n,s,o),f&&h.restore(),g!==d.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){const n=Rt(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}};const Ja={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};let A4={};function Y7(r){A4=r}const L4=new Df({crossOrigin:"anonymous",src:"../../../public/marker.svg",anchor:[.5,1]}),R1=new vo({width:2,color:"#005CA9"}),vb=new Ds({color:"#005CA915"}),PT=new ii({image:L4}),AT=new ii({stroke:R1}),LT=new ii({stroke:R1,fill:vb}),X7=new ii({stroke:R1,fill:vb}),K7=new ii({stroke:R1,fill:vb,image:L4}),Q7={Point:PT,LineString:AT,MultiLineString:AT,MultiPoint:PT,MultiPolygon:LT,Polygon:LT,GeometryCollection:K7,Circle:X7};function J7(r){const t=r.getGeometry().getType();return A4[t]||Q7[t]}let O4=class Sx{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(t,e){for(let i=0;i<t.length;i++)this.addFeature(t[i],e)}addFeature(t,e){let i=t.getGeometry();i&&(e&&(i=i.clone(),i.applyTransform(e)),this.addGeometry_(i,t))}clearFeatureEntryInPointBatch_(t){const e=Rt(t),i=this.pointBatch.entries[e];if(i)return this.pointBatch.geometriesCount-=i.flatCoordss.length,delete this.pointBatch.entries[e],i}clearFeatureEntryInLineStringBatch_(t){const e=Rt(t),i=this.lineStringBatch.entries[e];if(i)return this.lineStringBatch.verticesCount-=i.verticesCount,this.lineStringBatch.geometriesCount-=i.flatCoordss.length,delete this.lineStringBatch.entries[e],i}clearFeatureEntryInPolygonBatch_(t){const e=Rt(t),i=this.polygonBatch.entries[e];if(i)return this.polygonBatch.verticesCount-=i.verticesCount,this.polygonBatch.ringsCount-=i.ringsCount,this.polygonBatch.geometriesCount-=i.flatCoordss.length,delete this.polygonBatch.entries[e],i}addGeometry_(t,e){const i=t.getType();switch(i){case"GeometryCollection":{const n=t.getGeometriesArray();for(const s of n)this.addGeometry_(s,e);break}case"MultiPolygon":{const n=t;this.addCoordinates_(i,n.getFlatCoordinates(),n.getEndss(),e,Rt(e),n.getStride());break}case"MultiLineString":{const n=t;this.addCoordinates_(i,n.getFlatCoordinates(),n.getEnds(),e,Rt(e),n.getStride());break}case"MultiPoint":{const n=t;this.addCoordinates_(i,n.getFlatCoordinates(),null,e,Rt(e),n.getStride());break}case"Polygon":{const n=t;this.addCoordinates_(i,n.getFlatCoordinates(),n.getEnds(),e,Rt(e),n.getStride());break}case"Point":{const n=t;this.addCoordinates_(i,n.getFlatCoordinates(),null,e,Rt(e),n.getStride());break}case"LineString":case"LinearRing":{const n=t,s=n.getStride();this.addCoordinates_(i,n.getFlatCoordinates(),null,e,Rt(e),s,n.getLayout?.());break}}}addCoordinates_(t,e,i,n,s,o,a){let l;switch(t){case"MultiPolygon":{const c=i;for(let h=0,u=c.length;h<u;h++){let d=c[h];const g=h>0?c[h-1]:null,f=g?g[g.length-1]:0,p=d[d.length-1];d=f>0?d.map(m=>m-f):d,this.addCoordinates_("Polygon",e.slice(f,p),d,n,s,o,a)}break}case"MultiLineString":{const c=i;for(let h=0,u=c.length;h<u;h++){const d=h>0?c[h-1]:0;this.addCoordinates_("LineString",e.slice(d,c[h]),null,n,s,o,a)}break}case"MultiPoint":for(let c=0,h=e.length;c<h;c+=o)this.addCoordinates_("Point",e.slice(c,c+2),null,n,s,null,null);break;case"Polygon":{const c=i;if(n instanceof Pn){const d=Qw(e,c);if(d.length>1){this.addCoordinates_("MultiPolygon",e,d,n,s,o,a);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:n,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=e.length/o;const h=i.length,u=i.map((d,g,f)=>g>0?(d-f[g-1])/o:d/o);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=h,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(t$(e,o)),this.polygonBatch.entries[s].ringsVerticesCounts.push(u),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=h;for(let d=0,g=c.length;d<g;d++){const f=d>0?c[d-1]:0;this.addCoordinates_("LinearRing",e.slice(f,c[d]),null,n,s,o,a)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:n,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(e);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:n,flatCoordss:[],verticesCount:0})),l=e.length/o,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(e$(e,o,a)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(t,e){const i=this.uidToRef_.get(t),n=i||this.freeGlobalRef_.pop()||++this.globalCounter_;return e.ref=n,i||(this.refToFeature_.set(n,e.feature),this.uidToRef_.set(t,n)),e}removeRef_(t,e){if(!t)throw new Error("This feature has no ref: "+e);this.refToFeature_.delete(t),this.uidToRef_.delete(e),this.freeGlobalRef_.push(t)}changeFeature(t,e){if(!this.uidToRef_.get(Rt(t)))return;this.removeFeature(t);let i=t.getGeometry();i&&(e&&(i=i.clone(),i.applyTransform(e)),this.addGeometry_(i,t))}removeFeature(t){let e=this.clearFeatureEntryInPointBatch_(t);e=this.clearFeatureEntryInPolygonBatch_(t)||e,e=this.clearFeatureEntryInLineStringBatch_(t)||e,e&&this.removeRef_(e.ref,Rt(e.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(t){return this.refToFeature_.get(t)}isEmpty(){return this.globalCounter_===0}filter(t){const e=new Sx;e.globalCounter_=this.globalCounter_,e.uidToRef_=this.uidToRef_,e.refToFeature_=this.refToFeature_;let i=!0;for(const n of this.refToFeature_.values())t(n)&&(e.addFeature(n),i=!1);return i?new Sx:e}};function t$(r,t){return t===2?r:r.filter((e,i)=>i%t<2)}function e$(r,t,e){return t===3&&e==="XYM"?r:t===4?r.filter((i,n)=>n%t!==2):t===3?r.map((i,n)=>n%t!==2?i:0):new Array(r.length*1.5).fill(0).map((i,n)=>n%3===2?0:r[Math.round(n/1.5)])}const qg=34962,I1=34963,xb=35044,f_=35048,r$=5121,i$=5123,n$=5125,F4=5126,OT=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function s$(r,t){t=Object.assign({preserveDrawingBuffer:!0,antialias:!BN},t);const e=OT.length;for(let i=0;i<e;++i)try{const n=r.getContext(OT[i],t);if(n)return n}catch{}return null}const o$={STATIC_DRAW:xb};let eg=class{constructor(t,e){this.array_=null,this.type_=t,_e(t===qg||t===I1,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=e!==void 0?e:o$.STATIC_DRAW}ofSize(t){return this.array_=new(kp(this.type_))(t),this}fromArray(t){return this.array_=kp(this.type_).from(t),this}fromArrayBuffer(t){return this.array_=new(kp(this.type_))(t),this}getType(){return this.type_}getArray(){return this.array_}setArray(t){const e=kp(this.type_);if(!(t instanceof e))throw new Error(`Expected ${e}`);this.array_=t}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}};function kp(r){switch(r){case qg:return Float32Array;case I1:return Uint32Array;default:return Float32Array}}function P1(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Jl(r,t){return r[0]=t[0],r[1]=t[1],r[4]=t[2],r[5]=t[3],r[12]=t[4],r[13]=t[5],r}const Ep={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},a$=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,l$=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;let FT=class{constructor(t){this.gl_=t.webGlContext;const e=this.gl_;this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer(),this.depthBuffer_=e.createRenderbuffer();const i=e.createShader(e.VERTEX_SHADER);e.shaderSource(i,t.vertexShader||a$),e.compileShader(i);const n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,t.fragmentShader||l$),e.compileShader(n),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,i),e.attachShader(this.renderTargetProgram_,n),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array(s),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(o=>{this.uniforms_.push({value:t.uniforms[o],location:e.getUniformLocation(this.renderTargetProgram_,o)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(t){const e=this.getGL(),i=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.bindRenderbuffer(e.RENDERBUFFER,this.getDepthBuffer()),e.viewport(0,0,i[0],i[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==i[0]||this.renderTargetTextureSize_[1]!==i[1]){this.renderTargetTextureSize_=i;const n=0,s=e.RGBA,o=0,a=e.RGBA,l=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,n,s,i[0],i[1],o,a,l,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,i[0],i[1]),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthBuffer_)}}apply(t,e,i,n){const s=this.getGL(),o=t.size;if(s.bindFramebuffer(s.FRAMEBUFFER,e?e.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!e){const l=Rt(s.canvas);if(!t.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),t.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=t.layerStatesArray[t.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(t),i&&i(s,t),s.drawArrays(s.TRIANGLES,0,6),n&&n(s,t)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(t){const e=this.getGL();let i,n=1;this.uniforms_.forEach(function(s){if(i=typeof s.value=="function"?s.value(t):s.value,i instanceof HTMLCanvasElement||i instanceof ImageData)s.texture||(s.texture=e.createTexture()),e.activeTexture(e[`TEXTURE${n}`]),e.bindTexture(e.TEXTURE_2D,s.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i instanceof ImageData?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,i.width,i.height,0,e.UNSIGNED_BYTE,new Uint8Array(i.data)):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),e.uniform1i(s.location,n++);else if(Array.isArray(i))switch(i.length){case 2:e.uniform2f(s.location,i[0],i[1]);return;case 3:e.uniform3f(s.location,i[0],i[1],i[2]);return;case 4:e.uniform4f(s.location,i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&e.uniform1f(s.location,i)})}};const Fo={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},fi={UNSIGNED_BYTE:r$,UNSIGNED_SHORT:i$,UNSIGNED_INT:n$,FLOAT:F4},K0={};function NT(r){return"shared/"+r}let DT=0;function c$(){const r="unique/"+DT;return DT+=1,r}function h$(r){let t=K0[r];if(!t){const e=document.createElement("canvas");e.width=1,e.height=1,e.style.position="absolute",e.style.left="0",t={users:0,context:s$(e)},K0[r]=t}return t.users+=1,t.context}function u$(r){const t=K0[r];if(!t||(t.users-=1,t.users>0))return;const e=t.context,i=e.getExtension("WEBGL_lose_context");i&&i.loseContext();const n=e.canvas;n.width=1,n.height=1,delete K0[r]}let d$=class extends Rf{constructor(t){super(),t=t||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=t.canvasCacheKey?NT(t.canvasCacheKey):c$(),this.gl_=h$(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const e=this.gl_.canvas;e.addEventListener(Ep.LOST,this.boundHandleWebGLContextLost_),e.addEventListener(Ep.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=Er(),this.offsetScaleMatrix_=Er(),this.tmpMat4_=P1(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],t.uniforms&&this.setUniforms(t.uniforms),this.postProcessPasses_=t.postProcesses?t.postProcesses.map(i=>new FT({webGlContext:this.gl_,scaleRatio:i.scaleRatio,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,uniforms:i.uniforms})):[new FT({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(t){this.uniforms_=[],this.addUniforms(t)}addUniforms(t){for(const e in t)this.uniforms_.push({name:e,value:t[e]})}canvasCacheKeyMatches(t){return this.canvasCacheKey_===NT(t)}getExtension(t){if(t in this.extensionCache_)return this.extensionCache_[t];const e=this.gl_.getExtension(t);return this.extensionCache_[t]=e,e}getInstancedRenderingExtension_(){const t=this.getExtension("ANGLE_instanced_arrays");return _e(!!t,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),t}bindBuffer(t){const e=this.gl_,i=Rt(t);let n=this.bufferCache_[i];if(!n){const s=e.createBuffer();n={buffer:t,webGlBuffer:s},this.bufferCache_[i]=n}e.bindBuffer(t.getType(),n.webGlBuffer)}flushBufferData(t){const e=this.gl_;this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())}deleteBuffer(t){const e=Rt(t);delete this.bufferCache_[e]}disposeInternal(){const t=this.gl_.canvas;t.removeEventListener(Ep.LOST,this.boundHandleWebGLContextLost_),t.removeEventListener(Ep.RESTORED,this.boundHandleWebGLContextRestored_),u$(this.canvasCacheKey_),delete this.gl_}prepareDraw(t,e,i){const n=this.gl_,s=this.getCanvas(),o=t.size,a=t.pixelRatio;(s.width!==o[0]*a||s.height!==o[1]*a)&&(s.width=o[0]*a,s.height=o[1]*a,s.style.width=o[0]+"px",s.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(t);n.bindTexture(n.TEXTURE_2D,null),n.clearColor(0,0,0,0),n.depthRange(0,1),n.clearDepth(1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,e?n.ZERO:n.ONE_MINUS_SRC_ALPHA),i?(n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL)):n.disable(n.DEPTH_TEST)}bindFrameBuffer(t,e){const i=this.getGL();i.bindFramebuffer(i.FRAMEBUFFER,t),e&&i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0)}bindInitialFrameBuffer(){const t=this.getGL(),e=this.postProcessPasses_[0].getFrameBuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);const i=this.postProcessPasses_[0].getRenderTargetTexture();t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0)}bindTexture(t,e,i){const n=this.gl_;n.activeTexture(n.TEXTURE0+e),n.bindTexture(n.TEXTURE_2D,t),n.uniform1i(this.getUniformLocation(i),e)}bindAttribute(t,e,i){const n=this.getGL();this.bindBuffer(t);const s=this.getAttributeLocation(e);n.enableVertexAttribArray(s),n.vertexAttribPointer(s,i,n.FLOAT,!1,0,0)}prepareDrawToRenderTarget(t,e,i,n){const s=this.gl_,o=e.getSize();s.bindFramebuffer(s.FRAMEBUFFER,e.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,e.getDepthbuffer()),s.viewport(0,0,o[0],o[1]),s.bindTexture(s.TEXTURE_2D,e.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,i?s.ZERO:s.ONE_MINUS_SRC_ALPHA),n?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(t,e){const i=this.gl_;this.getExtension("OES_element_index_uint");const n=i.UNSIGNED_INT,s=4,o=e-t,a=t*s;i.drawElements(i.TRIANGLES,o,n,a)}drawElementsInstanced(t,e,i){const n=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),o=n.UNSIGNED_INT,a=4,l=e-t,c=t*a;s.drawElementsInstancedANGLE(n.TRIANGLES,l,o,c,i);for(let h=0;h<this.maxAttributeCount_;h++)s.vertexAttribDivisorANGLE(h,0)}finalizeDraw(t,e,i){for(let n=0,s=this.postProcessPasses_.length;n<s;n++)n===s-1?this.postProcessPasses_[n].apply(t,null,e,i):this.postProcessPasses_[n].apply(t,this.postProcessPasses_[n+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(t){const e=t.size,i=t.viewState.rotation,n=t.pixelRatio;this.setUniformFloatValue(Fo.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Fo.ZOOM,t.viewState.zoom),this.setUniformFloatValue(Fo.RESOLUTION,t.viewState.resolution),this.setUniformFloatValue(Fo.PIXEL_RATIO,n),this.setUniformFloatVec2(Fo.VIEWPORT_SIZE_PX,[e[0],e[1]]),this.setUniformFloatValue(Fo.ROTATION,i)}applyHitDetectionUniform(t){const e=this.getUniformLocation(Fo.HIT_DETECTION);this.getGL().uniform1i(e,t?1:0),t&&this.setUniformFloatValue(Fo.PIXEL_RATIO,.5)}applyUniforms(t){const e=this.gl_;let i,n=0;this.uniforms_.forEach(s=>{if(i=typeof s.value=="function"?s.value(t):s.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData||i instanceof WebGLTexture){i instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=i):s.texture||(s.prevValue=void 0,s.texture=e.createTexture()),this.bindTexture(s.texture,n,s.name),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const o=!(i instanceof HTMLImageElement)||i.complete;!(i instanceof WebGLTexture)&&o&&s.prevValue!==i&&(s.prevValue=i,e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i)),n++}else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(s.name,Jl(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:e.uniform2f(this.getUniformLocation(s.name),i[0],i[1]);return;case 3:e.uniform3f(this.getUniformLocation(s.name),i[0],i[1],i[2]);return;case 4:e.uniform4f(this.getUniformLocation(s.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&e.uniform1f(this.getUniformLocation(s.name),i)})}useProgram(t,e){this.disableAllAttributes_(),this.gl_.useProgram(t),this.currentProgram_=t,e&&(this.applyFrameState(e),this.applyUniforms(e))}compileShader(t,e){const i=this.gl_,n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}getProgram(t,e){const i=this.gl_,n=this.compileShader(t,i.FRAGMENT_SHADER),s=this.compileShader(e,i.VERTEX_SHADER),o=i.createProgram();if(i.attachShader(o,n),i.attachShader(o,s),i.linkProgram(o),!i.getShaderParameter(n,i.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${i.getShaderInfoLog(n)}`;throw new Error(a)}if(i.deleteShader(n),!i.getShaderParameter(s,i.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${i.getShaderInfoLog(s)}`;throw new Error(a)}if(i.deleteShader(s),!i.getProgramParameter(o,i.LINK_STATUS)){const a=`GL program linking failed: ${i.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(t){const e=Rt(this.currentProgram_);return this.uniformLocationsByProgram_[e]===void 0&&(this.uniformLocationsByProgram_[e]={}),this.uniformLocationsByProgram_[e][t]===void 0&&(this.uniformLocationsByProgram_[e][t]=this.gl_.getUniformLocation(this.currentProgram_,t)),this.uniformLocationsByProgram_[e][t]}getAttributeLocation(t){const e=Rt(this.currentProgram_);return this.attribLocationsByProgram_[e]===void 0&&(this.attribLocationsByProgram_[e]={}),this.attribLocationsByProgram_[e][t]===void 0&&(this.attribLocationsByProgram_[e][t]=this.gl_.getAttribLocation(this.currentProgram_,t)),this.attribLocationsByProgram_[e][t]}makeProjectionTransform(t,e){const i=t.size,n=t.viewState.rotation,s=t.viewState.resolution,o=t.viewState.center;return us(e,0,0,2/(s*i[0]),2/(s*i[1]),-n,-o[0],-o[1]),e}setUniformFloatValue(t,e){this.gl_.uniform1f(this.getUniformLocation(t),e)}setUniformFloatVec2(t,e){this.gl_.uniform2fv(this.getUniformLocation(t),e)}setUniformFloatVec4(t,e){this.gl_.uniform4fv(this.getUniformLocation(t),e)}setUniformMatrixValue(t,e){this.gl_.uniformMatrix4fv(this.getUniformLocation(t),!1,e)}disableAllAttributes_(){for(let t=0;t<this.maxAttributeCount_;t++)this.gl_.disableVertexAttribArray(t)}enableAttributeArray_(t,e,i,n,s,o){const a=this.getAttributeLocation(t);a<0||(this.gl_.enableVertexAttribArray(a),this.gl_.vertexAttribPointer(a,e,i,!1,n,s),o&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(a,1))}enableAttributes_(t,e){const i=g$(t);let n=0;for(let s=0;s<t.length;s++){const o=t[s];o.name&&this.enableAttributeArray_(o.name,o.size,o.type||F4,i,n,e),n+=o.size*N4(o.type)}}enableAttributes(t){this.enableAttributes_(t,!1)}enableAttributesInstanced(t){this.enableAttributes_(t,!0)}handleWebGLContextLost(t){Vu(this.bufferCache_),this.currentProgram_=null,t.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(t,e,i,n){const s=this.gl_;i=i||s.createTexture();const o=n?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,i),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const a=0,l=s.RGBA,c=0,h=s.RGBA,u=s.UNSIGNED_BYTE;return e instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,a,l,t[0],t[1],c,h,u,e):e?s.texImage2D(s.TEXTURE_2D,a,l,h,u,e):s.texImage2D(s.TEXTURE_2D,a,l,t[0],t[1],c,h,u,null),i}};function g$(r){let t=0;for(let e=0;e<r.length;e++){const i=r[e];t+=i.size*N4(i.type)}return t}function N4(r){switch(r){case fi.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case fi.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case fi.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case fi.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}function f$(){const r='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}function I(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function z(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const B=[],P={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function N(t,e,n,r,x){const o=t[e++],i=t[e++],f=B;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),P.instanceAttributesPosition=u,P}function R(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=I(f,[...l]),p=I(f,[...c]);let v=-1,b=-1,M=s;const m=null!==x;if(null!==r){v=E(h,p,I(f,[...[t[r],t[r+1]]])),Math.cos(v)<=.985&&(M+=Math.tan((v-Math.PI)/2))}if(m){b=E(p,h,I(f,[...[t[x],t[x+1]]])),Math.cos(b)<=.985&&(M+=Math.tan((Math.PI-b)/2))}const A=Math.pow(2,24),g=u%A,Z=Math.floor(u/A)*A;return o.push(l[0],l[1],a,c[0],c[1],y,v,b,g,Z,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:M}}function S(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const T="GENERATE_POLYGON_BUFFERS",_="GENERATE_POINT_BUFFERS",O="GENERATE_LINE_STRING_BUFFERS",U=self;U.onmessage=t=>{const e=t.data;switch(e.type){case _:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=N(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);U.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case O:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(z(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=R(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);U.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case T:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=S(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);U.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(r,"binary").toString("base64"):URL.createObjectURL(new Blob([r],{type:"application/javascript"})))}const p_={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function p$(r,t){t=t||[];const e=256,i=e-1,n=Math.floor(r/e/e/e)/i,s=Math.floor(r/e/e)%e/i,o=Math.floor(r/e)%e/i,a=r%e/i;return t[0]=n*256*255+s*255,t[1]=o*256*255+a*255,t}function m$(r){let t=0;const e=256,i=e-1;return t+=Math.round(r[0]*e*e*e*i),t+=Math.round(r[1]*e*e*i),t+=Math.round(r[2]*e*i),t+=Math.round(r[3]*i),t}let y$=class extends Zu{constructor(t){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter=t.gutter||0,this.helper=t.helper,this.loaded=!1,this.ready=!1}setTile(t){if(t!==this.tile)if(this.tile&&this.tile.removeEventListener(Bt.CHANGE,this.handleTileChange_),this.tile=t,this.loaded=t.getState()===_t.LOADED,this.loaded)this.uploadTile();else{if(t instanceof _b){const e=t.getImage();e instanceof Image&&!e.crossOrigin&&(e.crossOrigin="anonymous")}t.addEventListener(Bt.CHANGE,this.handleTileChange_)}}uploadTile(){Qt()}setReady(){this.ready=!0,this.dispatchEvent(Bt.CHANGE)}handleTileChange_(){this.tile.getState()===_t.LOADED&&(this.loaded=!0,this.uploadTile())}setHelper(t){this.helper=t,this.helper&&this.loaded&&this.uploadTile()}disposeInternal(){this.setHelper(null),this.tile.removeEventListener(Bt.CHANGE,this.handleTileChange_)}},D4=class $4 extends p4{constructor(t,e){super(t),e=e||{},this.inversePixelTransform_=Er(),this.postProcesses_=e.postProcesses,this.uniforms_=e.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},t.addChangeListener(Be.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(t,e){const i=this.getLayer();if(i.hasListener(yi.PRECOMPOSE)){const n=new tg(yi.PRECOMPOSE,void 0,e,t);i.dispatchEvent(n)}}dispatchPostComposeEvent(t,e){const i=this.getLayer();if(i.hasListener(yi.POSTCOMPOSE)){const n=new tg(yi.POSTCOMPOSE,void 0,e,t);i.dispatchEvent(n)}}reset(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(t){if(this.getLayer().getRenderSource()){let e=!0,i=-1,n;for(let o=0,a=t.layerStatesArray.length;o<a;o++){const l=t.layerStatesArray[o].layer,c=l.getRenderer();if(!(c instanceof $4)){e=!0;continue}const h=l.getClassName();if((e||h!==n)&&(i+=1,e=!1),n=h,c===this)break}const s="map/"+t.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new d$({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),n&&(this.helper.getCanvas().className=n),this.afterHelperCreated())}return this.prepareFrameInternal(t)}afterHelperCreated(){}prepareFrameInternal(t){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(Be.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){us(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);const s=new tg(t,this.inversePixelTransform_,i,e);n.dispatchEvent(s)}}preRender(t,e){this.dispatchRenderEvent_(yi.PRERENDER,t,e)}postRender(t,e){this.dispatchRenderEvent_(yi.POSTRENDER,t,e)}};const _$={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"};function $T(r){return 1/(r+2)}function v$(){return{tileIds:new Set,representationsByZ:{}}}function GT(r,t){return r.tileIds.has(Rt(t))}function jT(r,t,e){const i=r.representationsByZ;e in i||(i[e]=new Set),i[e].add(t),r.tileIds.add(Rt(t.tile))}function m_(r,t){const e=r.layerStatesArray[r.layerIndex];e.extent&&(t=bn(t,Ms(e.extent,r.viewState.projection)));const i=e.layer.getRenderSource();if(!i.getWrapX()){const n=i.getTileGridForProjection(r.viewState.projection).getExtent();n&&(t=bn(t,n))}return t}function zT(r,t){return`${Rt(r)},${r.getKey()},${Mh(t)}`}let x$=class extends D4{constructor(t,e){super(t,{uniforms:e.uniforms,postProcesses:e.postProcesses}),this.renderComplete=!1,this.tileTransform_=Er(),this.tempMat4=P1(),this.tempTileRange_=new M1(0,0,0,0),this.tempTileCoord_=Pu(0,0,0),this.tempSize_=[0,0];const i=e.cacheSize!==void 0?e.cacheSize:512;this.tileRepresentationCache=new Ex(i),this.frameState=null,this.renderedProjection_=void 0}reset(t){super.reset({uniforms:t.uniforms})}prepareFrameInternal(t){this.renderedProjection_?t.viewState.projection!==this.renderedProjection_&&(this.clearCache(),this.renderedProjection_=t.viewState.projection):this.renderedProjection_=t.viewState.projection;const e=this.getLayer().getRenderSource();return!e||fa(m_(t,t.extent))?!1:e.getState()==="ready"}createTileRepresentation(t){return Qt()}enqueueTiles(t,e,i,n,s){const o=t.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=l.getGutterForProjection(o.projection),u=Rt(l);u in t.wantedTiles||(t.wantedTiles[u]={});const d=t.wantedTiles[u],g=this.tileRepresentationCache,f=a.getMapInternal(),p=Math.max(i-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),m=o.rotation,y=m?Aw(o.center,o.resolution,m,t.size):void 0;for(let _=i;_>=p;--_){const x=c.getTileRangeForExtentAndZ(e,_,this.tempTileRange_),v=c.getResolution(_);for(let w=x.minX;w<=x.maxX;++w)for(let b=x.minY;b<=x.maxY;++b){if(m&&!c.tileCoordIntersectsViewport([_,w,b],y))continue;const E=Pu(_,w,b,this.tempTileCoord_),C=zT(l,E);let S,R;if(g.containsKey(C)&&(S=g.get(C),R=S.tile),(!S||S.tile.key!==l.getKey())&&(R=l.getTile(_,w,b,t.pixelRatio,o.projection),!R)||GT(n,R))continue;S?S.setTile(R):(S=this.createTileRepresentation({tile:R,grid:c,helper:this.helper,gutter:h}),g.set(C,S)),jT(n,S,_);const I=R.getKey();d[I]=!0,R.getState()===_t.IDLE&&(t.tileQueue.isKeyQueued(I)||t.tileQueue.enqueue([R,u,c.getTileCoordCenter(E),v]))}}}beforeTilesRender(t,e){this.helper.prepareDraw(this.frameState,!e,!0)}beforeTilesMaskRender(t){return!1}renderTile(t,e,i,n,s,o,a,l,c,h,u){}renderTileMask(t,e,i,n){}drawTile_(t,e,i,n,s,o,a){if(!e.ready)return;const l=e.tile.tileCoord,c=Mh(l),h=c in o?o[c]:1,u=a.getResolution(i),d=_i(a.getTileSize(i),this.tempSize_),g=a.getOrigin(i),f=a.getTileCoordExtent(l),p=h<1?-1:$T(i);h<1&&(t.animate=!0);const m=t.viewState,y=m.center[0],_=m.center[1],x=d[0]+2*n,v=d[1]+2*n,w=x/v,b=(y-g[0])/(d[0]*u),E=(g[1]-_)/(d[1]*u),C=m.resolution/u,S=l[1],R=l[2];lx(this.tileTransform_),Kd(this.tileTransform_,2/(t.size[0]*C/x),-2/(t.size[1]*C/x)),wN(this.tileTransform_,m.rotation),Kd(this.tileTransform_,1,1/w),y1(this.tileTransform_,(d[0]*(S-b)-n)/x,(d[1]*(R-E)-n)/v),this.renderTile(e,this.tileTransform_,t,s,u,d,g,f,p,n,h)}renderFrame(t){this.frameState=t,this.renderComplete=!0;const e=this.helper.getGL();this.preRender(e,t);const i=t.viewState,n=this.getLayer(),s=n.getRenderSource(),o=s.getTileGridForProjection(i.projection),a=s.getGutterForProjection(i.projection),l=m_(t,t.extent),c=o.getZForResolution(i.resolution,s.zDirection),h=v$(),u=n.getPreload();if(t.nextExtent){const y=o.getZForResolution(i.nextResolution,s.zDirection),_=m_(t,t.nextExtent);this.enqueueTiles(t,_,y,h,u)}this.enqueueTiles(t,l,c,h,0),u>0&&setTimeout(()=>{this.enqueueTiles(t,l,c-1,h,u-1)},0);const d={};let g=!1;const f=h.representationsByZ;if(c in f){const y=Rt(this),_=t.time;for(const x of f[c]){const v=x.tile;if(v.getState()===_t.EMPTY)continue;const w=v.tileCoord;if(x.ready){const E=v.getAlpha(y,_);if(E===1){v.endTransition(y);continue}g=!0;const C=Mh(w);d[C]=E}if(this.renderComplete=!1,this.findAltTiles_(o,w,c+1,h))continue;const b=o.getMinZoom();for(let E=c-1;E>=b&&!this.findAltTiles_(o,w,E,h);--E);}}const p=Object.keys(f).map(Number).sort(lR);if(this.beforeTilesMaskRender(t))for(let y=0,_=p.length;y<_;++y){const x=p[y];for(const v of f[x]){const w=v.tile.tileCoord;if(Mh(w)in d)continue;const b=o.getTileCoordExtent(w);this.renderTileMask(v,x,b,$T(x))}}this.beforeTilesRender(t,g);for(let y=0,_=p.length;y<_;++y){const x=p[y];for(const v of f[x]){const w=v.tile.tileCoord;Mh(w)in d||this.drawTile_(t,v,x,a,l,d,o)}}if(c in f)for(const y of f[c]){const _=y.tile.tileCoord;Mh(_)in d&&this.drawTile_(t,y,c,a,l,d,o)}this.beforeFinalize(t),this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const m=this.helper.getCanvas();return this.tileRepresentationCache.expireCache(),this.postRender(e,t),m}beforeFinalize(t){}findAltTiles_(t,e,i,n){const s=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileRepresentationCache,l=this.getLayer().getRenderSource();for(let c=s.minX;c<=s.maxX;++c)for(let h=s.minY;h<=s.maxY;++h){const u=zT(l,[i,c,h]);let d=!1;if(a.containsKey(u)){const g=a.get(u);g.ready&&!GT(n,g.tile)&&(jT(n,g,i),d=!0)}d||(o=!1)}return o}clearCache(){super.clearCache();const t=this.tileRepresentationCache;t.forEach(e=>e.dispose()),t.clear()}afterHelperCreated(){super.afterHelperCreated(),this.tileRepresentationCache.forEach(t=>t.setHelper(this.helper))}disposeInternal(){super.disposeInternal(),delete this.frameState}};const y_={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};let w$=class{constructor(t,e){this.name=t,this.data=e,this.texture_=null}getTexture(t){if(!this.texture_){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.data.length/4,1,0,t.RGBA,t.UNSIGNED_BYTE,this.data),this.texture_=e}return this.texture_}delete(t){this.texture_&&t.deleteTexture(this.texture_),this.texture_=null}};function b$(r,t){return`operator_${r}_${Object.keys(t.functions).length}`}function ul(r){const t=r.toString();return t.includes(".")?t:t+".0"}function wb(r){if(r.length<2||r.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${r.length}(${r.map(ul).join(", ")})`}function y0(r){const t=ds(r),e=t.length>3?t[3]:1;return wb([t[0]/255,t[1]/255,t[2]/255,e])}function k$(r){const t=_i(r);return wb(t)}const __={};let E$=0;function Bg(r){return r in __||(__[r]=E$++),__[r]}function Go(r){return ul(Bg(r))}function bb(r){return"u_var_"+r}function S$(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const v_="getBandValue",T$="u_paletteTextures",G4="featureId",j4="geometryType",Tx=-9999999;function C$(r,t,e,i){const n=vi(r,t,e);return kb(n,t,i)}function $e(r){return(t,e,i)=>{const n=e.args.length,s=new Array(n);for(let o=0;o<n;++o)s[o]=kb(e.args[o],i,t);return r(s,t)}}const M$={[B.Get]:(r,t)=>{const e=t.args[0].value;e in r.properties||(r.properties[e]={name:e,type:t.type});let i="a_prop_"+e;return Zs(t.type,hi)&&(i=`(${i} > 0.0)`),i},[B.Id]:r=>(r.featureId=!0,"a_"+G4),[B.GeometryType]:r=>(r.geometryType=!0,"a_"+j4),[B.LineMetric]:()=>"currentLineMetric",[B.Var]:(r,t)=>{const e=t.args[0].value;e in r.variables||(r.variables[e]={name:e,type:t.type});let i=bb(e);return Zs(t.type,hi)&&(i=`(${i} > 0.0)`),i},[B.Has]:(r,t)=>{const e=t.args[0].value;return e in r.properties||(r.properties[e]={name:e,type:t.type}),`(a_prop_${e} != ${ul(Tx)})`},[B.Resolution]:()=>"u_resolution",[B.Zoom]:()=>"u_zoom",[B.Time]:()=>"u_time",[B.Any]:$e(r=>`(${r.join(" || ")})`),[B.All]:$e(r=>`(${r.join(" && ")})`),[B.Not]:$e(([r])=>`(!${r})`),[B.Equal]:$e(([r,t])=>`(${r} == ${t})`),[B.NotEqual]:$e(([r,t])=>`(${r} != ${t})`),[B.GreaterThan]:$e(([r,t])=>`(${r} > ${t})`),[B.GreaterThanOrEqualTo]:$e(([r,t])=>`(${r} >= ${t})`),[B.LessThan]:$e(([r,t])=>`(${r} < ${t})`),[B.LessThanOrEqualTo]:$e(([r,t])=>`(${r} <= ${t})`),[B.Multiply]:$e(r=>`(${r.join(" * ")})`),[B.Divide]:$e(([r,t])=>`(${r} / ${t})`),[B.Add]:$e(r=>`(${r.join(" + ")})`),[B.Subtract]:$e(([r,t])=>`(${r} - ${t})`),[B.Clamp]:$e(([r,t,e])=>`clamp(${r}, ${t}, ${e})`),[B.Mod]:$e(([r,t])=>`mod(${r}, ${t})`),[B.Pow]:$e(([r,t])=>`pow(${r}, ${t})`),[B.Abs]:$e(([r])=>`abs(${r})`),[B.Floor]:$e(([r])=>`floor(${r})`),[B.Ceil]:$e(([r])=>`ceil(${r})`),[B.Round]:$e(([r])=>`floor(${r} + 0.5)`),[B.Sin]:$e(([r])=>`sin(${r})`),[B.Cos]:$e(([r])=>`cos(${r})`),[B.Atan]:$e(([r,t])=>t!==void 0?`atan(${r}, ${t})`:`atan(${r})`),[B.Sqrt]:$e(([r])=>`sqrt(${r})`),[B.Match]:$e(r=>{const t=r[0],e=r[r.length-1];let i=null;for(let n=r.length-3;n>=1;n-=2){const s=r[n],o=r[n+1];i=`(${t} == ${s} ? ${o} : ${i||e})`}return i}),[B.Between]:$e(([r,t,e])=>`(${r} >= ${t} && ${r} <= ${e})`),[B.Interpolate]:$e(([r,t,...e])=>{let i="";for(let n=0;n<e.length-2;n+=2){const s=e[n],o=i||e[n+1],a=e[n+2],l=e[n+3];let c;r===ul(1)?c=`(${t} - ${s}) / (${a} - ${s})`:c=`(pow(${r}, (${t} - ${s})) - 1.0) / (pow(${r}, (${a} - ${s})) - 1.0)`,i=`mix(${o}, ${l}, clamp(${c}, 0.0, 1.0))`}return i}),[B.Case]:$e(r=>{const t=r[r.length-1];let e=null;for(let i=r.length-3;i>=0;i-=2){const n=r[i],s=r[i+1];e=`(${n} ? ${s} : ${e||t})`}return e}),[B.In]:$e(([r,...t],e)=>{const i=b$("in",e),n=[];for(let s=0;s<t.length;s+=1)n.push(`  if (inputValue == ${t[s]}) { return true; }`);return e.functions[i]=`bool ${i}(float inputValue) {
${n.join(`
`)}
  return false;
}`,`${i}(${r})`}),[B.Array]:$e(r=>`vec${r.length}(${r.join(", ")})`),[B.Color]:$e(r=>{if(r.length===1)return`vec4(vec3(${r[0]} / 255.0), 1.0)`;if(r.length===2)return`vec4(vec3(${r[0]} / 255.0), ${r[1]})`;const t=r.slice(0,3).map(i=>`${i} / 255.0`);if(r.length===3)return`vec4(${t.join(", ")}, 1.0)`;const e=r[3];return`vec4(${t.join(", ")}, ${e})`}),[B.Band]:$e(([r,t,e],i)=>{if(!(v_ in i.functions)){let n="";const s=i.bandCount||1;for(let o=0;o<s;o++){const a=Math.floor(o/4);let l=o%4;o===s-1&&l===1&&(l=3);const c=`${y_.TILE_TEXTURE_ARRAY}[${a}]`;n+=`  if (band == ${o+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}i.functions[v_]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${y_.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${y_.TEXTURE_PIXEL_HEIGHT};
${n}
}`}return`${v_}(${r}, ${t??"0.0"}, ${e??"0.0"})`}),[B.Palette]:(r,t)=>{const[e,...i]=t.args,n=i.length,s=new Uint8Array(n*4);for(let c=0;c<i.length;c++){const h=i[c].value,u=ds(h),d=c*4;s[d]=u[0],s[d+1]=u[1],s[d+2]=u[2],s[d+3]=u[3]*255}r.paletteTextures||(r.paletteTextures=[]);const o=`${T$}[${r.paletteTextures.length}]`,a=new w$(o,s);r.paletteTextures.push(a);const l=kb(e,Pt,r);return`texture2D(${o}, vec2((${l} + 0.5) / ${n}.0, 0.5))`}};function kb(r,t,e){if(r instanceof m4){const i=M$[r.operator];if(i===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(r.operator)}`);return i(e,r,t)}if((r.type&Pt)>0)return ul(r.value);if((r.type&hi)>0)return r.value.toString();if((r.type&ui)>0)return Go(r.value.toString());if((r.type&br)>0)return y0(r.value);if((r.type&En)>0)return wb(r.value);if((r.type&Kn)>0)return k$(r.value);throw new Error(`Unexpected expression ${r.value} (expected type ${Uh(t)})`)}function Eb(r,t,e,i){let n=0;for(const s in t){const o=t[s],a=o.callback.call(e,e.feature);let l=a?.[0]??a;l===Tx&&console.warn('The "has" operator might return false positives.'),l===void 0?l=Tx:l===null&&(l=0),r[i+n++]=l,!(!o.size||o.size===1)&&(r[i+n++]=a[1],!(o.size<3)&&(r[i+n++]=a[2],!(o.size<4)&&(r[i+n++]=a[3])))}return n}function A1(r){return Object.keys(r).reduce((t,e)=>t+(r[e].size||1),0)}function R$(r,t,e,i){const n=(2+A1(e))*r.geometriesCount;(!t||t.length!==n)&&(t=new Float32Array(n));const s=[];let o=0;for(const a in r.entries){const l=r.entries[a];for(let c=0,h=l.flatCoordss.length;c<h;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Ir(i,s),t[o++]=s[0],t[o++]=s[1],o+=Eb(t,e,l,o)}return t}function I$(r,t,e,i){const n=3*r.verticesCount+(1+A1(e))*r.geometriesCount;(!t||t.length!==n)&&(t=new Float32Array(n));const s=[];let o=0;for(const a in r.entries){const l=r.entries[a];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,co(l.flatCoordss[c],0,s.length,3,i,s,3),o+=Eb(t,e,l,o),t[o++]=s.length/3;for(let u=0,d=s.length;u<d;u+=3)t[o++]=s[u],t[o++]=s[u+1],t[o++]=s[u+2]}}return t}function P$(r,t,e,i){const n=2*r.verticesCount+(1+A1(e))*r.geometriesCount+r.ringsCount;(!t||t.length!==n)&&(t=new Float32Array(n));const s=[];let o=0;for(const a in r.entries){const l=r.entries[a];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,co(l.flatCoordss[c],0,s.length,2,i,s),o+=Eb(t,e,l,o),t[o++]=l.ringsVerticesCounts[c].length;for(let u=0,d=l.ringsVerticesCounts[c].length;u<d;u++)t[o++]=l.ringsVerticesCounts[c][u];for(let u=0,d=s.length;u<d;u+=2)t[o++]=s[u],t[o++]=s[u+1]}}return t}function A$(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const qT=.985;function he(r,t,e){const i=hb();return C$(t,e,i,r)}function L$(r){const t=ds(r),e=t[0]*256,i=t[1],n=t[2]*256,s=Math.round(t[3]*255);return[e+i,n+s]}const O$=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function Sb(r){return r===br||r===Kn?2:r===En?4:1}function Cx(r){const t=Sb(r);return t>1?`vec${t}`:"float"}function F$(r,t){for(const e in t.variables){const i=t.variables[e],n=bb(i.name);let s=Cx(i.type);i.type===br&&(s="vec4"),r.addUniform(n,s)}for(const e in t.properties){const i=t.properties[e],n=Cx(i.type),s=`a_prop_${i.name}`;i.type===br?r.addAttribute(s,n,`unpackColor(${s})`,"vec4"):r.addAttribute(s,n)}for(const e in t.functions)r.addVertexShaderFunction(t.functions[e]),r.addFragmentShaderFunction(t.functions[e])}function N$(r,t){const e={};for(const i in r.variables){const n=r.variables[i],s=bb(n.name);e[s]=()=>{const o=t[n.name];if(typeof o=="number")return o;if(typeof o=="boolean")return o?1:0;if(n.type===br){const a=[...ds(o||"#eee")];return a[0]/=255,a[1]/=255,a[2]/=255,a[3]??=1,a}return typeof o=="string"?Bg(o):o}}return e}function D$(r){const t={};for(const e in r.properties){const i=r.properties[e],n=s=>{const o=s.get(i.name);return i.type===br?L$([...ds(o||"#eee")]):typeof o=="string"?Bg(o):typeof o=="boolean"?o?1:0:o};t[`prop_${i.name}`]={size:Sb(i.type),callback:n}}return t}const hh=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${O$}
`,uh=A$();let z4=class{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${ul(uh["circle-radius"])} + ${ul(uh["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=y0(uh["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=ul(uh["stroke-width"]),this.strokeColorExpression_=y0(uh["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=Go("round"),this.strokeJoinExpression_=Go("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=y0(uh["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(t,e){return this.uniforms_.push({name:t,type:e}),this}addAttribute(t,e,i,n){return this.attributes_.push({name:t,type:e,varyingName:t.replace(/^a_/,"v_"),varyingType:n??e,varyingExpression:i??t}),this}setSymbolSizeExpression(t){return this.hasSymbol_=!0,this.symbolSizeExpression_=t,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(t){return this.symbolRotationExpression_=t,this}setSymbolOffsetExpression(t){return this.symbolOffsetExpression_=t,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(t){return this.hasSymbol_=!0,this.symbolColorExpression_=t,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(t){return this.texCoordExpression_=t,this}setFragmentDiscardExpression(t){return this.discardExpression_=t,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(t){return this.symbolRotateWithView_=t,this}setStrokeWidthExpression(t){return this.hasStroke_=!0,this.strokeWidthExpression_=t,this}setStrokeColorExpression(t){return this.hasStroke_=!0,this.strokeColorExpression_=t,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(t){return this.strokeOffsetExpression_=t,this}setStrokeCapExpression(t){return this.strokeCapExpression_=t,this}setStrokeJoinExpression(t){return this.strokeJoinExpression_=t,this}setStrokeMiterLimitExpression(t){return this.strokeMiterLimitExpression_=t,this}setStrokeDistanceFieldExpression(t){return this.strokeDistanceFieldExpression_=t,this}setStrokePatternLengthExpression(t){return this.strokePatternLengthExpression_=t,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(t){return this.hasFill_=!0,this.fillColorExpression_=t,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(t){return this.vertexShaderFunctions_.includes(t)?this:(this.vertexShaderFunctions_.push(t),this)}addFragmentShaderFunction(t){return this.fragmentShaderFunctions_.includes(t)?this:(this.fragmentShaderFunctions_.push(t),this)}getSymbolVertexShader(){return this.hasSymbol_?`${hh}
${this.uniforms_.map(t=>`uniform ${t.type} ${t.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(t=>`attribute ${t.type} ${t.name};
varying ${t.varyingType} ${t.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(t=>`  ${t.varyingName} = ${t.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${hh}
${this.uniforms_.map(t=>`uniform ${t.type} ${t.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(t=>`varying ${t.varyingType} ${t.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(t=>`  ${t.varyingType} ${t.name} = ${t.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${hh}
${this.uniforms_.map(t=>`uniform ${t.type} ${t.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(t=>`attribute ${t.type} ${t.name};
varying ${t.varyingType} ${t.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${qT} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(t=>`  ${t.varyingName} = ${t.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${hh}
${this.uniforms_.map(t=>`uniform ${t.type} ${t.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(t=>`varying ${t.varyingType} ${t.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${qT}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${Go("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${Go("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${Go("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${Go("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(t=>`  ${t.varyingType} ${t.name} = ${t.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${hh}
${this.uniforms_.map(t=>`uniform ${t.type} ${t.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(t=>`attribute ${t.type} ${t.name};
varying ${t.varyingType} ${t.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(t=>`  ${t.varyingName} = ${t.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${hh}
${this.uniforms_.map(t=>`uniform ${t.type} ${t.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(t=>`varying ${t.varyingType} ${t.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(t=>`  ${t.varyingType} ${t.name} = ${t.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}};function Q0(r){return(JSON.stringify(r).split("").reduce((t,e)=>(t<<5)-t+e.charCodeAt(0),0)>>>0).toString()}function Tb(r,t,e,i){if(`${i}radius`in r&&i!=="icon-"){let n=he(e,r[`${i}radius`],Pt);if(`${i}radius2`in r){const s=he(e,r[`${i}radius2`],Pt);n=`max(${n}, ${s})`}`${i}stroke-width`in r&&(n=`(${n} + ${he(e,r[`${i}stroke-width`],Pt)} * 0.5)`),t.setSymbolSizeExpression(`vec2(${n} * 2. + 0.5)`)}if(`${i}scale`in r){const n=he(e,r[`${i}scale`],Kn);t.setSymbolSizeExpression(`${t.getSymbolSizeExpression()} * ${n}`)}`${i}displacement`in r&&t.setSymbolOffsetExpression(he(e,r[`${i}displacement`],En)),`${i}rotation`in r&&t.setSymbolRotationExpression(he(e,r[`${i}rotation`],Pt)),`${i}rotate-with-view`in r&&t.setSymbolRotateWithView(!!r[`${i}rotate-with-view`])}function q4(r,t,e,i,n){let s="vec4(0.)";if(t!==null&&(s=t),e!==null&&i!==null){const l=`smoothstep(-${i} + 0.63, -${i} - 0.58, ${r})`;s=`mix(${e}, ${s}, ${l})`}const o=`(1.0 - smoothstep(-0.63, 0.58, ${r}))`;let a=`${s} * vec4(1.0, 1.0, 1.0, ${o})`;return n!==null&&(a=`${a} * vec4(1.0, 1.0, 1.0, ${n})`),a}function Cb(r,t,e,i,n){const s=new Image;s.crossOrigin=r[`${i}cross-origin`]===void 0?"anonymous":r[`${i}cross-origin`],_e(typeof r[`${i}src`]=="string",`WebGL layers do not support expressions for the ${i}src style property`),s.src=r[`${i}src`],e[`u_texture${n}_size`]=()=>s.complete?[s.width,s.height]:[0,0],t.addUniform(`u_texture${n}_size`,"vec2");const o=`u_texture${n}_size`;return e[`u_texture${n}`]=s,t.addUniform(`u_texture${n}`,"sampler2D"),o}function Mb(r,t,e,i,n){let s=he(e,r[`${t}offset`],Kn);if(`${t}offset-origin`in r)switch(r[`${t}offset-origin`]){case"top-right":s=`vec2(${i}.x, 0.) + ${n} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${i}.y) + ${n} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${i} - ${n} - ${s}`;break}return s}function $$(r,t,e,i){i.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,Tb(r,t,i,"circle-");let n=null;"circle-opacity"in r&&(n=he(i,r["circle-opacity"],Pt));let s="coordsPx";"circle-scale"in r&&(s=`coordsPx / ${he(i,r["circle-scale"],Kn)}`);let o=null;"circle-fill-color"in r&&(o=he(i,r["circle-fill-color"],br));let a=null;"circle-stroke-color"in r&&(a=he(i,r["circle-stroke-color"],br));let l=he(i,r["circle-radius"],Pt),c=null;"circle-stroke-width"in r&&(c=he(i,r["circle-stroke-width"],Pt),l=`(${l} + ${c} * 0.5)`);const h=`circleDistanceField(${s}, ${l})`,u=q4(h,o,a,c,n);t.setSymbolColorExpression(u)}function G$(r,t,e,i){i.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,i.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,i.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,Tb(r,t,i,"shape-");let n=null;"shape-opacity"in r&&(n=he(i,r["shape-opacity"],Pt));let s="coordsPx";"shape-scale"in r&&(s=`coordsPx / ${he(i,r["shape-scale"],Kn)}`);let o=null;"shape-fill-color"in r&&(o=he(i,r["shape-fill-color"],br));let a=null;"shape-stroke-color"in r&&(a=he(i,r["shape-stroke-color"],br));let l=null;"shape-stroke-width"in r&&(l=he(i,r["shape-stroke-width"],Pt));const c=he(i,r["shape-points"],Pt);let h="0.";"shape-angle"in r&&(h=he(i,r["shape-angle"],Pt));let u,d=he(i,r["shape-radius"],Pt);if(l!==null&&(d=`${d} + ${l} * 0.5`),"shape-radius2"in r){let f=he(i,r["shape-radius2"],Pt);l!==null&&(f=`${f} + ${l} * 0.5`),u=`starDistanceField(${s}, ${c}, ${d}, ${f}, ${h})`}else u=`regularDistanceField(${s}, ${c}, ${d}, ${h})`;const g=q4(u,o,a,l,n);t.setSymbolColorExpression(g)}function j$(r,t,e,i){let n="vec4(1.0)";"icon-color"in r&&(n=he(i,r["icon-color"],br)),"icon-opacity"in r&&(n=`${n} * vec4(1.0, 1.0, 1.0, ${he(i,r["icon-opacity"],Pt)})`);const s=Q0(r["icon-src"]),o=Cb(r,t,e,"icon-",s);if(t.setSymbolColorExpression(`${n} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(o),"icon-width"in r&&"icon-height"in r&&t.setSymbolSizeExpression(`vec2(${he(i,r["icon-width"],Pt)}, ${he(i,r["icon-height"],Pt)})`),"icon-offset"in r&&"icon-size"in r){const a=he(i,r["icon-size"],En),l=t.getSymbolSizeExpression();t.setSymbolSizeExpression(a);const c=Mb(r,"icon-",i,"v_quadSizePx",a);t.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${a})) / (${l}).xyxy`)}if(Tb(r,t,i,"icon-"),"icon-anchor"in r){const a=he(i,r["icon-anchor"],En);let l="1.0";"icon-scale"in r&&(l=he(i,r["icon-scale"],Kn));let c;r["icon-anchor-x-units"]==="pixels"&&r["icon-anchor-y-units"]==="pixels"?c=`${a} * ${l}`:r["icon-anchor-x-units"]==="pixels"?c=`${a} * vec2(vec2(${l}).x, v_quadSizePx.y)`:r["icon-anchor-y-units"]==="pixels"?c=`${a} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${a} * v_quadSizePx`;let h=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in r)switch(r["icon-anchor-origin"]){case"top-right":h=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":h=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":h=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}t.setSymbolOffsetExpression(`${t.getSymbolOffsetExpression()} + ${h}`)}}function z$(r,t,e,i){if("stroke-color"in r&&t.setStrokeColorExpression(he(i,r["stroke-color"],br)),"stroke-pattern-src"in r){const n=Q0(r["stroke-pattern-src"]),s=Cb(r,t,e,"stroke-pattern-",n);let o=s,a="vec2(0.)";"stroke-pattern-offset"in r&&"stroke-pattern-size"in r&&(o=he(i,r["stroke-pattern-size"],En),a=Mb(r,"stroke-pattern-",i,s,o));let l="0.";"stroke-pattern-spacing"in r&&(l=he(i,r["stroke-pattern-spacing"],Pt));let c="0.";"stroke-pattern-start-offset"in r&&(c=he(i,r["stroke-pattern-start-offset"],Pt)),i.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const h=`u_texture${n}`;let u="1.";"stroke-color"in r&&(u=t.getStrokeColorExpression()),t.setStrokeColorExpression(`${u} * sampleStrokePattern(${h}, ${s}, ${a}, ${o}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),i.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,t.setStrokePatternLengthExpression(`computeStrokePatternLength(${o}, ${l}, v_width)`)}if("stroke-width"in r&&t.setStrokeWidthExpression(he(i,r["stroke-width"],Pt)),"stroke-offset"in r&&t.setStrokeOffsetExpression(he(i,r["stroke-offset"],Pt)),"stroke-line-cap"in r&&t.setStrokeCapExpression(he(i,r["stroke-line-cap"],ui)),"stroke-line-join"in r&&t.setStrokeJoinExpression(he(i,r["stroke-line-join"],ui)),"stroke-miter-limit"in r&&t.setStrokeMiterLimitExpression(he(i,r["stroke-miter-limit"],Pt)),"stroke-line-dash"in r){i.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${Go("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${Go("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let n=r["stroke-line-dash"].map(g=>he(i,g,Pt));n.length%2===1&&(n=[...n,...n]);let s="0.";"stroke-line-dash-offset"in r&&(s=he(i,r["stroke-line-dash-offset"],Pt));const o=`dashDistanceField_${Q0(r["stroke-line-dash"])}`,a=n.map((g,f)=>`float dashLength${f}`).join(", "),l=n.map((g,f)=>`dashLength${f}`).join(" + ");let c="0.",h=`getSingleDashDistance(distance, radius, ${c}, dashLength0, totalDashLength, capType, lineWidth)`;for(let g=2;g<n.length;g+=2)c=`${c} + dashLength${g-2} + dashLength${g-1}`,h=`min(${h}, getSingleDashDistance(distance, radius, ${c}, dashLength${g}, totalDashLength, capType, lineWidth))`;i.functions[o]=`float ${o}(float distance, float radius, float capType, float lineWidth, ${a}) {
  float totalDashLength = ${l};
  return ${h};
}`;const u=n.map((g,f)=>`${g}`).join(", ");t.setStrokeDistanceFieldExpression(`${o}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${u})`);let d=n.join(" + ");t.getStrokePatternLengthExpression()&&(i.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,d=`combinePatternLengths(${t.getStrokePatternLengthExpression()}, ${d})`),t.setStrokePatternLengthExpression(d)}}function q$(r,t,e,i){if("fill-color"in r&&t.setFillColorExpression(he(i,r["fill-color"],br)),"fill-pattern-src"in r){const n=Q0(r["fill-pattern-src"]),s=Cb(r,t,e,"fill-pattern-",n);let o=s,a="vec2(0.)";"fill-pattern-offset"in r&&"fill-pattern-size"in r&&(o=he(i,r["fill-pattern-size"],En),a=Mb(r,"fill-pattern-",i,s,o)),i.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${n}`;let c="1.";"fill-color"in r&&(c=t.getFillColorExpression()),t.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${a}, ${o}, pxOrigin, pxPos)`)}}function BT(r,t,e){const i=S$(),n=new z4,s={};if("icon-src"in r?j$(r,n,s,i):"shape-points"in r?G$(r,n,s,i):"circle-radius"in r&&$$(r,n,s,i),z$(r,n,s,i),q$(r,n,s,i),e){const l=he(i,e,hi);n.setFragmentDiscardExpression(`!${l}`)}const o={};function a(l,c,h,u){if(!i[l])return;const d=Cx(h),g=Sb(h);n.addAttribute(`a_${c}`,d),o[c]={size:g,callback:u}}return a("geometryType",j4,ui,l=>Bg(ub(l.getGeometry()))),a("featureId",G4,ui|Pt,l=>{const c=l.getId()??null;return typeof c=="string"?Bg(c):c}),F$(n,i),{builder:n,attributes:{...o,...D$(i)},uniforms:{...s,...N$(i,t)}}}const B$=[];let x_;function U$(){return x_||(x_=f$()),x_}let W$=0;const Un={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};let B4=class{constructor(t,e,i,n){this.helper_,this.hitDetectionEnabled_=!!n,this.styleShaders=U4(t,e),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return p$(this.ref,B$)},size:2});for(const s of this.styleShaders){for(const o in s.attributes)o in this.customAttributes_||(this.customAttributes_[o]=s.attributes[o]);for(const o in s.uniforms)o in this.uniforms_||(this.uniforms_[o]=s.uniforms[o])}this.renderPasses_=this.styleShaders.map(s=>{const o={},a=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:fi.FLOAT}));return s.builder.getFillVertexShader()&&(o.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:Un.POSITION,size:2,type:fi.FLOAT},...a],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(o.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:Un.LOCAL_POSITION,size:2,type:fi.FLOAT}],instancedAttributesDesc:[{name:Un.SEGMENT_START,size:2,type:fi.FLOAT},{name:Un.MEASURE_START,size:1,type:fi.FLOAT},{name:Un.SEGMENT_END,size:2,type:fi.FLOAT},{name:Un.MEASURE_END,size:1,type:fi.FLOAT},{name:Un.JOIN_ANGLES,size:2,type:fi.FLOAT},{name:Un.DISTANCE_LOW,size:1,type:fi.FLOAT},{name:Un.DISTANCE_HIGH,size:1,type:fi.FLOAT},{name:Un.ANGLE_TANGENT_SUM,size:1,type:fi.FLOAT},...a],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(o.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:Un.LOCAL_POSITION,size:2,type:fi.FLOAT}],instancedAttributesDesc:[{name:Un.POSITION,size:2,type:fi.FLOAT},...a],instancePrimitiveVertexCount:6}),o}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(i)}async generateBuffers(t,e){if(t.isEmpty())return null;const i=this.generateRenderInstructions_(t,e),[n,s,o]=await Promise.all([this.generateBuffersForType_(i.polygonInstructions,"Polygon",e),this.generateBuffersForType_(i.lineStringInstructions,"LineString",e),this.generateBuffersForType_(i.pointInstructions,"Point",e)]),a=Pc(Er(),e);return{polygonBuffers:n,lineStringBuffers:s,pointBuffers:o,invertVerticesTransform:a}}generateRenderInstructions_(t,e){const i=this.hasFill_?P$(t.polygonBatch,new Float32Array(0),this.customAttributes_,e):null,n=this.hasStroke_?I$(t.lineStringBatch,new Float32Array(0),this.customAttributes_,e):null,s=this.hasSymbol_?R$(t.pointBatch,new Float32Array(0),this.customAttributes_,e):null;return{polygonInstructions:i,lineStringInstructions:n,pointInstructions:s}}generateBuffersForType_(t,e,i){if(t===null)return null;const n=W$++;let s;switch(e){case"Polygon":s=p_.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=p_.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=p_.GENERATE_POINT_BUFFERS;break}const o={id:n,type:s,renderInstructions:t.buffer,renderInstructionsTransform:i,customAttributesSize:A1(this.customAttributes_)},a=U$();return a.postMessage(o,[t.buffer]),t=null,new Promise(l=>{const c=h=>{const u=h.data;if(u.id!==n||(a.removeEventListener("message",c),!this.helper_.getGL()))return;const d=new eg(I1,f_).fromArrayBuffer(u.indicesBuffer),g=new eg(qg,f_).fromArrayBuffer(u.vertexAttributesBuffer),f=new eg(qg,f_).fromArrayBuffer(u.instanceAttributesBuffer);this.helper_.flushBufferData(d),this.helper_.flushBufferData(g),this.helper_.flushBufferData(f),l([d,g,f])};a.addEventListener("message",c)})}render(t,e,i){for(const n of this.renderPasses_)n.fillRenderPass&&this.renderInternal_(t.polygonBuffers[0],t.polygonBuffers[1],t.polygonBuffers[2],n.fillRenderPass,e,i),n.strokeRenderPass&&this.renderInternal_(t.lineStringBuffers[0],t.lineStringBuffers[1],t.lineStringBuffers[2],n.strokeRenderPass,e,i),n.symbolRenderPass&&this.renderInternal_(t.pointBuffers[0],t.pointBuffers[1],t.pointBuffers[2],n.symbolRenderPass,e,i)}renderInternal_(t,e,i,n,s,o){const a=t.getSize();if(a===0)return;const l=n.instancedAttributesDesc.length;if(this.helper_.useProgram(n.program,s),this.helper_.bindBuffer(e),this.helper_.bindBuffer(t),this.helper_.enableAttributes(n.attributesDesc),this.helper_.bindBuffer(i),this.helper_.enableAttributesInstanced(n.instancedAttributesDesc),o(),l){const c=n.instancedAttributesDesc.reduce((u,d)=>u+(d.size||1),0),h=i.getSize()/c;this.helper_.drawElementsInstanced(0,a,h)}else this.helper_.drawElements(0,a)}setHelper(t,e=null){this.helper_=t;for(const i of this.renderPasses_)i.fillRenderPass&&(i.fillRenderPass.program=this.helper_.getProgram(i.fillRenderPass.fragmentShader,i.fillRenderPass.vertexShader)),i.strokeRenderPass&&(i.strokeRenderPass.program=this.helper_.getProgram(i.strokeRenderPass.fragmentShader,i.strokeRenderPass.vertexShader)),i.symbolRenderPass&&(i.symbolRenderPass.program=this.helper_.getProgram(i.symbolRenderPass.fragmentShader,i.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),e&&(e.polygonBuffers&&(this.helper_.flushBufferData(e.polygonBuffers[0]),this.helper_.flushBufferData(e.polygonBuffers[1]),this.helper_.flushBufferData(e.polygonBuffers[2])),e.lineStringBuffers&&(this.helper_.flushBufferData(e.lineStringBuffers[0]),this.helper_.flushBufferData(e.lineStringBuffers[1]),this.helper_.flushBufferData(e.lineStringBuffers[2])),e.pointBuffers&&(this.helper_.flushBufferData(e.pointBuffers[0]),this.helper_.flushBufferData(e.pointBuffers[1]),this.helper_.flushBufferData(e.pointBuffers[2])))}};function U4(r,t){const e=Array.isArray(r)?r:[r];if("style"in e[0]){const i=[],n=e,s=[];for(const o of n){const a=Array.isArray(o.style)?o.style:[o.style];let l=o.filter;o.else&&s.length&&(l=["all",...s.map(h=>["!",h])],o.filter&&l.push(o.filter),l.length<3&&(l=l[1])),o.filter&&s.push(o.filter);const c=a.map(h=>BT(h,t,l));i.push(...c)}return i}return"builder"in e[0]?e:e.map(i=>BT(i,t,null))}const Ws=new Uint8Array(4);let W4=class{constructor(t,e){this.helper_=t;const i=t.getGL();this.texture_=i.createTexture(),this.framebuffer_=i.createFramebuffer(),this.depthbuffer_=i.createRenderbuffer(),this.size_=e||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(t){ga(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const t=this.size_,e=this.helper_.getGL();e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.readPixels(0,0,t[0],t[1],e.RGBA,e.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(t,e){if(t<0||e<0||t>this.size_[0]||e>=this.size_[1])return Ws[0]=0,Ws[1]=0,Ws[2]=0,Ws[3]=0,Ws;this.readAll();const i=Math.floor(t)+(this.size_[1]-Math.floor(e)-1)*this.size_[0];return Ws[0]=this.data_[i*4],Ws[1]=this.data_[i*4+1],Ws[2]=this.data_[i*4+2],Ws[3]=this.data_[i*4+3],Ws}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const t=this.size_,e=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.viewport(0,0,t[0],t[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture_,0),e.bindRenderbuffer(e.RENDERBUFFER,this.depthbuffer_),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t[0],t[1]),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(t[0]*t[1]*4)}};function V$(r,t){const e=r.viewState.projection,i=t.getSource().getWrapX()&&e.canWrapX(),n=e.getExtent(),s=r.extent,o=i?Te(n):null,a=i?Math.ceil((s[2]-n[2])/o)+1:1;return[i?Math.floor((s[0]-n[0])/o):0,a,o]}const dh={...Fo,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};let V4=class extends D4{constructor(t,e){const i={[dh.RENDER_EXTENT]:[0,0,0,0],[dh.PATTERN_ORIGIN]:[0,0],[dh.GLOBAL_ALPHA]:1};super(t,{uniforms:i,postProcesses:e.postProcesses}),this.hitDetectionEnabled_=!e.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=sn(),this.currentTransform_=Er(),this.tmpCoords_=[0,0],this.tmpTransform_=Er(),this.tmpMat4_=P1(),this.currentFrameStateTransform_=Er(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(e),this.batch_=new O4,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(t){const e=this.getLayer().getSource();let i;this.batch_.addFeatures(e.getFeatures(),i),this.sourceListenKeys_=[Se(e,Ni.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,i)),Se(e,Ni.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,i),this),Se(e,Ni.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),Se(e,Ni.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(t){this.styleVariables_=t.variables,this.style_=t.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new B4(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(t){this.applyOptions_(t),this.helper&&this.createRenderers_(),super.reset(t)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new W4(this.helper))}handleSourceFeatureAdded_(t,e){const i=e.feature;this.batch_.addFeature(i,t)}handleSourceFeatureChanged_(t,e){const i=e.feature;this.batch_.changeFeature(i,t)}handleSourceFeatureDelete_(t){const e=t.feature;this.batch_.removeFeature(e)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(t){q0(this.tmpTransform_,this.currentFrameStateTransform_),Yu(this.tmpTransform_,t),this.helper.setUniformMatrixValue(dh.PROJECTION_MATRIX,Jl(this.tmpMat4_,this.tmpTransform_)),Pc(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(dh.SCREEN_TO_WORLD_MATRIX,Jl(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,Pc(this.tmpTransform_,t),Ir(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(dh.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(t){const e=this.helper.getGL();this.preRender(e,t);const[i,n,s]=V$(t,this.getLayer());this.helper.prepareDraw(t),this.renderWorlds(t,!1,i,n,s),this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const o=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(t,!0,i,n,s),this.hitRenderTarget_.clearCachedData()),this.postRender(e,t),o}prepareFrameInternal(t){this.initialFeaturesAdded_||(this.addInitialFeatures_(t),this.initialFeaturesAdded_=!0);const e=this.getLayer(),i=e.getSource(),n=t.viewState,s=!t.viewHints[ur.ANIMATING]&&!t.viewHints[ur.INTERACTING],o=!vl(this.previousExtent_,t.extent),a=this.sourceRevision_<i.getRevision();if(a&&(this.sourceRevision_=i.getRevision()),s&&(o||a)){const l=n.projection,c=n.resolution,h=e instanceof C1?e.getRenderBuffer():0,u=ns(t.extent,h*c);i.loadFeatures(u,c,l),this.ready=!1;const d=this.helper.makeProjectionTransform(t,Er());this.styleRenderer_.generateBuffers(this.batch_,d).then(g=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=g,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=t.extent.slice()}return!0}renderWorlds(t,e,i,n,s){let o=i;e&&(this.hitRenderTarget_.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.prepareDrawToRenderTarget(t,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(t,this.currentFrameStateTransform_),y1(this.currentFrameStateTransform_,o*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,t,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(e)});while(++o<n)}forEachFeatureAtCoordinate(t,e,i,n,s){if(_e(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const o=Ir(e.coordinateToPixelTransform,t.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],c=m$(l),h=this.batch_.getFeatureFromRef(c);if(h)return n(h,this.getLayer(),null)}disposeBuffers(t){const e=i=>{for(const n of i)n&&this.helper.deleteBuffer(n)};t.pointBuffers&&e(t.pointBuffers),t.lineStringBuffers&&e(t.lineStringBuffers),t.polygonBuffers&&e(t.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(t){or(t)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}};class Z$ extends y${constructor(t,e){super(t),this.batch_=new O4,this.styleRenderer_=e,this.buffers=null,this.maskVertices=new eg(qg,xb),this.setTile(t.tile)}generateMaskBuffer_(){const t=this.tile.getSourceTiles()[0].extent;this.maskVertices.fromArray([t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]]),this.helper.flushBufferData(this.maskVertices)}uploadTile(){this.generateMaskBuffer_(),this.batch_.clear();const t=this.tile.getSourceTiles(),e=t.reduce((o,a)=>o.concat(a.getFeatures()),[]);this.batch_.addFeatures(e);const i=t[0].extent[0],n=t[0].extent[1],s=y1(Er(),-i,-n);this.styleRenderer_.generateBuffers(this.batch_,s).then(o=>{this.buffers=o,this.setReady()})}disposeInternal(){if(this.buffers){const t=e=>{for(const i of e)i&&this.helper.deleteBuffer(i)};this.buffers.pointBuffers&&t(this.buffers.pointBuffers),this.buffers.lineStringBuffers&&t(this.buffers.lineStringBuffers),this.buffers.polygonBuffers&&t(this.buffers.polygonBuffers)}super.disposeInternal()}}const Kr={..._$,TILE_MASK_TEXTURE:"u_depthMask",TILE_ZOOM_LEVEL:"u_tileZoomLevel"},H$={POSITION:"a_position"};class Y$ extends x${constructor(t,e){super(t,{cacheSize:e.cacheSize,uniforms:{[Kr.PATTERN_ORIGIN]:[0,0],[Kr.TILE_MASK_TEXTURE]:()=>this.tileMaskTarget_.getTexture()}}),this.hitDetectionEnabled_=!e.disableHitDetection,this.style_=null,this.styleVariables_=e.variables||{},this.styleRenderer_=null,this.currentFrameStateTransform_=Er(),this.tmpTransform_=Er(),this.tmpMat4_=P1(),this.tileMaskTarget_=null,this.tileMaskIndices_=new eg(I1,xb),this.tileMaskIndices_.fromArray([0,1,3,1,2,3]),this.tileMaskAttributes_=[{name:H$.POSITION,size:2,type:fi.FLOAT}],this.tileMaskProgram_,this.applyOptions_(e)}reset(t){super.reset(t),this.applyOptions_(t),this.helper&&(this.createRenderers_(),this.initTileMask_())}applyOptions_(t){this.style_=t.style}createRenderers_(){function t(i){const n=i.getFragmentDiscardExpression(),s=`texture2D(${Kr.TILE_MASK_TEXTURE}, gl_FragCoord.xy / u_pixelRatio / u_viewportSizePx).r * 50. > ${Kr.TILE_ZOOM_LEVEL} + 0.5`;i.setFragmentDiscardExpression(n!=="false"?`(${n}) || (${s})`:s),i.addUniform(Kr.TILE_MASK_TEXTURE,"sampler2D"),i.addUniform(Kr.TILE_ZOOM_LEVEL,"float")}const e=U4(this.style_,this.styleVariables_);for(const i of e)t(i.builder);this.styleRenderer_=new B4(e,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}initTileMask_(){this.tileMaskTarget_=new W4(this.helper);const t=new z4().setFillColorExpression(`vec4(${Kr.TILE_ZOOM_LEVEL} / 50., 0., 0., 1.)`).addUniform(Kr.TILE_ZOOM_LEVEL,"float");this.tileMaskProgram_=this.helper.getProgram(t.getFillFragmentShader(),t.getFillVertexShader()),this.helper.flushBufferData(this.tileMaskIndices_)}afterHelperCreated(){this.createRenderers_(),this.initTileMask_()}createTileRepresentation(t){const e=new Z$(t,this.styleRenderer_),i=()=>{e.ready&&(this.getLayer().changed(),e.removeEventListener(Bt.CHANGE,i))};return e.addEventListener(Bt.CHANGE,i),e}beforeTilesRender(t,e){super.beforeTilesRender(t,!0),this.helper.makeProjectionTransform(t,this.currentFrameStateTransform_)}beforeTilesMaskRender(t){this.helper.makeProjectionTransform(t,this.currentFrameStateTransform_);const e=t.pixelRatio,i=t.size;return this.tileMaskTarget_.setSize([i[0]*e,i[1]*e]),this.helper.prepareDrawToRenderTarget(t,this.tileMaskTarget_,!0,!0),this.helper.useProgram(this.tileMaskProgram_,t),q0(this.tmpTransform_,this.currentFrameStateTransform_),this.helper.setUniformMatrixValue(Kr.PROJECTION_MATRIX,Jl(this.tmpMat4_,this.tmpTransform_)),Pc(this.tmpTransform_,this.currentFrameStateTransform_),this.helper.setUniformMatrixValue(Kr.SCREEN_TO_WORLD_MATRIX,Jl(this.tmpMat4_,this.tmpTransform_)),!0}renderTileMask(t,e,i,n){if(!t.ready)return;this.helper.setUniformFloatValue(Kr.DEPTH,n),this.helper.setUniformFloatValue(Kr.TILE_ZOOM_LEVEL,e),this.helper.setUniformFloatVec4(Kr.RENDER_EXTENT,i),this.helper.setUniformFloatValue(Kr.GLOBAL_ALPHA,1),this.helper.bindBuffer(t.maskVertices),this.helper.bindBuffer(this.tileMaskIndices_),this.helper.enableAttributes(this.tileMaskAttributes_);const s=this.tileMaskIndices_.getSize();this.helper.drawElements(0,s)}applyUniforms_(t,e,i,n,s){q0(this.tmpTransform_,this.currentFrameStateTransform_),Yu(this.tmpTransform_,i),this.helper.setUniformMatrixValue(Kr.PROJECTION_MATRIX,Jl(this.tmpMat4_,this.tmpTransform_)),Pc(this.tmpTransform_,this.currentFrameStateTransform_),this.helper.setUniformMatrixValue(Kr.SCREEN_TO_WORLD_MATRIX,Jl(this.tmpMat4_,this.tmpTransform_)),this.helper.setUniformFloatValue(Kr.GLOBAL_ALPHA,t),this.helper.setUniformFloatValue(Kr.DEPTH,s),this.helper.setUniformFloatValue(Kr.TILE_ZOOM_LEVEL,n),this.helper.setUniformFloatVec4(Kr.RENDER_EXTENT,e)}renderTile(t,e,i,n,s,o,a,l,c,h,u){const d=bn(l,n,l),g=t.tile.getTileCoord()[0],f=t.buffers;f&&this.styleRenderer_.render(f,i,()=>{this.applyUniforms_(u,d,f.invertVerticesTransform,g,c)})}renderDeclutter(t){}disposeInternal(){super.disposeInternal()}}const X$={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},UT={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class K$ extends P4{constructor(t,e){super(t,e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=Er(),this.tileClipContexts_=null}enqueueTilesForNextExtent(){return this.getLayer().getRenderMode()!=="vector"}drawTile(t,e,i,n,s,o,a,l){this.updateExecutorGroup_(t,e.pixelRatio,e.viewState.projection),this.tileImageNeedsRender_(t)&&this.renderTileImage_(t,e),super.drawTile(t,e,i,n,s,o,a,l)}getTile(t,e,i,n){const s=this.getOrCreateTile(t,e,i,n);if(!s)return null;const o=n.viewState,a=o.resolution,l=n.viewHints,c=this.getLayer().getSource(),h=c.getTileGridForProjection(o.projection),u=!(l[ur.ANIMATING]||l[ur.INTERACTING]),d=h.getZForResolution(a,c.zDirection)===t;return u&&d?s.wantedResolution=a:s.wantedResolution||(s.wantedResolution=h.getResolution(t)),s}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,i){const n=this.getLayer(),s=n.getRevision(),o=n.getRenderOrder()||null,a=t.wantedResolution,l=t.getReplayState(n);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==s&&l.renderedPixelRatio===e&&l.renderedRenderOrder==o)return;const c=n.getSource(),h=!!n.getDeclutter(),u=c.getTileGrid(),d=c.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),g=c.getSourceTiles(e,i,t),f=Rt(n);delete t.hitDetectionImageData[f],t.executorGroups[f]=[],l.dirty=!1;for(let p=0,m=g.length;p<m;++p){const y=g[p];if(y.getState()!=_t.LOADED)continue;const _=c.getProjection(),x=y.tileCoord;let v=u.getTileCoordExtent(x);i&&_&&!ci(i,_)&&(v=dc(v,_,i,32));const w=bn(d,v),b=ns(w,n.getRenderBuffer()*a,this.tempExtent),E=vl(v,w)?null:b,C=new l4(0,w,a,e),S=vx(a,e),R=function(T,D){let A;const $=T.getStyleFunction()||n.getStyleFunction();if($&&(A=$(T,a)),A){const z=this.renderFeature(T,S,A,C,h,D);l.dirty=l.dirty||z}},I=y.getFeatures();o&&o!==l.renderedRenderOrder&&I.sort(o);for(let T=0,D=I.length;T<D;++T){let A=I[T];i&&y.projection&&!ci(i,y.projection)&&(A=A.clone(),A.getGeometry().applyTransform(Ic(y.projection,i))),(!E||zr(E,A.getGeometry().getExtent()))&&R.call(this,A,T)}const F=C.finish(),N=n.getRenderMode()!=="vector"&&h&&g.length===1?null:w,P=new u4(N,a,e,c.getOverlaps(),F,n.getRenderBuffer(),!0);t.executorGroups[f].push(P)}l.renderedRevision=s,l.renderedPixelRatio=e,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(t,e,i,n,s){const o=e.viewState.resolution,a=e.viewState.rotation;i=i??0;const l=this.getLayer(),c=l.getSource().getTileGridForProjection(e.viewState.projection),h=Pg([t]);ns(h,o*i,h);const u={},d=function(_,x,v){let w=_.getId();w===void 0&&(w=Rt(_));const b=u[w];if(b){if(b!==!0&&v<b.distanceSq){if(v===0)return u[w]=!0,s.splice(s.lastIndexOf(b),1),n(_,l,x);b.geometry=x,b.distanceSq=v}}else{if(v===0)return u[w]=!0,n(_,l,x);s.push(u[w]={feature:_,layer:l,geometry:x,distanceSq:v,callback:n})}},g=this.renderedTiles,f=Rt(l),p=l.getDeclutter(),m=p?e.declutter?.[p]?.all().map(_=>_.value):null;let y;t:for(let _=0,x=g.length;_<x;++_){const v=g[_],w=c.getTileCoordExtent(v.wrappedTileCoord);if(!zr(w,h))continue;const b=v.executorGroups[f];for(let E=0,C=b.length;E<C;++E)if(y=b[E].forEachFeatureAtCoordinate(t,o,a,i,d,m),y)break t}return y}getFeatures(t){return this.renderedTiles.length===0?Promise.resolve([]):new Promise((e,i)=>{const n=this.getLayer(),s=n.getSource(),o=this.renderedProjection,a=o.getExtent(),l=this.renderedResolution,c=s.getTileGridForProjection(o),h=Ir(this.renderedPixelToCoordinateTransform_,t.slice()),u=c.getTileCoordForCoordAndResolution(h,l).toString(),d=this.renderedTiles.find(x=>x.tileCoord.toString()===u&&x.getState()===_t.LOADED);if(!d||d.loadingSourceTiles>0){e([]);return}s.getWrapX()&&o.canWrapX()&&!ro(a,c.getTileCoordExtent(d.tileCoord))&&Ow(h,o);const g=Rt(n),f=c.getTileCoordExtent(d.wrappedTileCoord),p=_o(f),m=[(h[0]-p[0])/l,(p[1]-h[1])/l],y=d.getSourceTiles().reduce((x,v)=>x.concat(v.getFeatures()),[]);let _=d.hitDetectionImageData[g];if(!_){const x=_i(c.getTileSize(c.getZForResolution(l,s.zDirection))),v=this.renderedRotation_,w=[this.getRenderTransform(c.getTileCoordCenter(d.wrappedTileCoord),l,0,On,x[0]*On,x[1]*On,0)];_=g4(x,w,y,n.getStyleFunction(),c.getTileCoordExtent(d.wrappedTileCoord),d.getReplayState(n).renderedResolution,v),d.hitDetectionImageData[g]=_}e(f4(m,y,_))})}getFeaturesInExtent(t){const e=[],i=this.getTileCache();if(i.getCount()===0)return e;const n=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),s=n.getZForResolution(this.renderedResolution),o={};return i.forEach(a=>{if(a.tileCoord[0]!==s||a.getState()!==_t.LOADED)return;const l=a.getSourceTiles();for(let c=0,h=l.length;c<h;++c){const u=l[c],d=u.getKey();if(d in o)continue;o[d]=!0;const g=u.tileCoord;if(zr(t,n.getTileCoordExtent(g))){const f=u.getFeatures();if(f)for(let p=0,m=f.length;p<m;++p){const y=f[p],_=y.getGeometry();zr(t,_.getExtent())&&e.push(y)}}}}),e}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.renderedLayerRevision_!==void 0&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t,e){const i=this.context,n=i.globalAlpha;i.globalAlpha=e.opacity;const s=t.viewHints,o=!(s[ur.ANIMATING]||s[ur.INTERACTING]),a=[this.context.canvas.width,this.context.canvas.height],l=this.getLayer().getDeclutter(),c=l?t.declutter?.[l]:void 0,h=Rt(this.getLayer()),u=this.renderedTiles;for(let d=0,g=u.length;d<g;++d){const f=u[d],p=f.executorGroups[h];if(p)for(let m=p.length-1;m>=0;--m)p[m].execute(this.context,a,this.getTileRenderTransform(f,t),t.viewState.rotation,o,Y0,c)}i.globalAlpha=n}renderDeferredInternal(t){const e=this.renderedTiles,i=Rt(this.getLayer()),n=e.reduce((a,l,c)=>(l.executorGroups[i].forEach(h=>a.push({executorGroup:h,index:c})),a),[]),s=n.map(({executorGroup:a})=>a.getDeferredZIndexContexts()),o={};for(let a=0,l=n.length;a<l;++a){const c=n[a].executorGroup.getDeferredZIndexContexts();for(const h in c)o[h]=!0}Object.keys(o).map(Number).sort(lo).forEach(a=>{s.forEach((l,c)=>{l[a]&&(l[a].forEach(h=>{const{executorGroup:u,index:d}=n[c],g=u.getRenderedContext(),f=g.globalAlpha;g.globalAlpha=this.renderedOpacity_;const p=this.tileClipContexts_[d];p&&p.draw(g),h.draw(g),p&&g.restore(),g.globalAlpha=f,h.clear()}),l[a].length=0)})})}getTileRenderTransform(t,e){const i=e.pixelRatio,n=e.viewState,s=n.center,o=n.resolution,a=n.rotation,l=e.size,c=Math.round(l[0]*i),h=Math.round(l[1]*i),u=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),d=t.tileCoord,g=u.getTileCoordExtent(t.wrappedTileCoord),f=u.getTileCoordExtent(d,this.tempExtent)[0]-g[0];return Yu(Kd(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(s,o,a,i,c,h,f))}postRender(t,e){const i=e.viewHints,n=!(i[ur.ANIMATING]||i[ur.INTERACTING]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation,this.renderedOpacity_=e.layerStatesArray[e.layerIndex].opacity;const s=this.getLayer(),o=s.getRenderMode(),a=t.globalAlpha;t.globalAlpha=this.renderedOpacity_;const l=s.getDeclutter(),c=l?UT[o].filter(v=>!Y0.includes(v)):UT[o],h=e.viewState,u=h.rotation,d=s.getSource(),g=d.getTileGridForProjection(h.projection).getZForResolution(h.resolution,d.zDirection),f=this.renderedTiles,p=[],m=[],y=[],_=Rt(s);let x=!0;for(let v=f.length-1;v>=0;--v){const w=f[v];x=x&&!w.getReplayState(s).dirty;const b=w.executorGroups[_].filter(N=>N.hasExecutors(c));if(b.length===0)continue;const E=this.getTileRenderTransform(w,e),C=w.tileCoord[0];let S=!1;const R=b[0].getClipCoords(E);let I=t,F;if(R){F=new ab,I=F.getContext();for(let N=0,P=p.length;N<P;++N)if(g!==C&&C<m[N]){const T=p[N];zr([R[0],R[3],R[4],R[7]],[T[0],T[3],T[4],T[7]])&&(S||(I.save(),S=!0),I.beginPath(),I.moveTo(R[0],R[1]),I.lineTo(R[2],R[3]),I.lineTo(R[4],R[5]),I.lineTo(R[6],R[7]),I.moveTo(T[6],T[7]),I.lineTo(T[4],T[5]),I.lineTo(T[2],T[3]),I.lineTo(T[0],T[1]),I.clip())}p.push(R),m.push(C)}for(let N=0,P=b.length;N<P;++N)b[N].execute(t,[t.canvas.width,t.canvas.height],E,u,n,c,e.declutter?.[l]);S&&(I===t?I.restore():y[v]=F)}t.globalAlpha=a,this.ready=x,this.tileClipContexts_=y,e.declutter||this.renderDeferredInternal(e),super.postRender(t,e)}renderFeature(t,e,i,n,s,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,c=i.length;l<c;++l)a=Z0(n,t,i[l],e,this.boundHandleStyleImageChange_,void 0,s,o)||a;else a=Z0(n,t,i,e,this.boundHandleStyleImageChange_,void 0,s,o);return a}tileImageNeedsRender_(t){const e=this.getLayer();if(e.getRenderMode()==="vector")return!1;const i=t.getReplayState(e),n=e.getRevision(),s=t.wantedResolution;return i.renderedTileResolution!==s||i.renderedTileRevision!==n}renderTileImage_(t,e){const i=this.getLayer(),n=t.getReplayState(i),s=i.getRevision(),o=t.executorGroups[Rt(i)];n.renderedTileRevision=s;const a=t.wrappedTileCoord,l=a[0],c=i.getSource();let h=e.pixelRatio;const u=e.viewState.projection,d=c.getTileGridForProjection(u),g=d.getResolution(t.tileCoord[0]),f=e.pixelRatio/t.wantedResolution*g,p=d.getResolution(l),m=t.getContext();h=Math.round(Math.max(h,f/h));const y=c.getTilePixelSize(l,h,u);m.canvas.width=y[0],m.canvas.height=y[1];const _=h/f;if(_!==1){const b=lx(this.tmpTransform_);Kd(b,_,_),m.setTransform.apply(m,b)}const x=d.getTileCoordExtent(a,this.tempExtent),v=f/p,w=lx(this.tmpTransform_);Kd(w,v,-v),y1(w,-x[0],-x[3]);for(let b=0,E=o.length;b<E;++b)o[b].execute(m,[m.canvas.width*_,m.canvas.height*_],w,0,!0,X$[i.getRenderMode()],null);n.renderedTileResolution=t.wantedResolution}}class Z4 extends C1{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload;const i=t.cacheSize===void 0?0:t.cacheSize;delete t.cacheSize,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i;const n=t.renderMode||"hybrid";_e(n=="hybrid"||n=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=n,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new K$(this,{cacheSize:this.cacheSize_})}getFeatures(t){return super.getFeatures(t)}getFeaturesInExtent(t){return this.getRenderer().getFeaturesInExtent(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(Ja.PRELOAD)}getUseInterimTilesOnError(){return this.get(Ja.USE_INTERIM_TILES_ON_ERROR)}setPreload(t){this.set(Ja.PRELOAD,t)}setUseInterimTilesOnError(t){this.set(Ja.USE_INTERIM_TILES_ON_ERROR,t)}}class Q$ extends Hc{constructor(t){const e=Object.assign({},t);super(e),this.styleVariables_=t.variables||{},this.style_=t.style,this.hitDetectionDisabled_=!!t.disableHitDetection}createRenderer(){return new V4(this,{style:this.style_,variables:this.styleVariables_,disableHitDetection:this.hitDetectionDisabled_})}updateStyleVariables(t){Object.assign(this.styleVariables_,t),this.changed()}setStyle(t){this.style_=t,this.clearRenderer(),this.changed()}}const Ai={background:[255,255,255,0],fill:[10,200,100,.5],stroke:[0,0,0,1],textFill:[255,255,255,1],textStroke:[0,0,0,0]},An={point:{feature:null,isClustered:!1,type:"circle",imagePath:"",imageName:"blank.png",imageWidth:1,imageHeight:1,imageScale:1,imageOffsetX:.5,imageOffsetY:.5,imageOffsetXUnit:"fraction",imageOffsetYUnit:"fraction",circleRadius:10,circleFillColor:Ai.fill,circleStrokeColor:Ai.stroke,circleStrokeWidth:2,clusterType:"circle",clusterCircleRadius:15,clusterCircleFillColor:Ai.fill,clusterCircleStrokeColor:Ai.stroke,clusterCircleStrokeWidth:2,clusterImageName:"blank.png",clusterImageWidth:1,clusterImageHeight:1,clusterImageScale:1,clusterImageOffsetX:.5,clusterImageOffsetY:.5,circleSegmentsRadius:10,circleSegmentsStrokeWidth:4,circleSegmentsBackgroundColor:Ai.background,scalingValueDefaultColor:Ai.stroke,circleSegmentsGap:10,circleBarScalingFactor:1,circleBarRadius:6,circleBarLineStroke:5,circleBarCircleFillColor:Ai.fill,circleBarCircleStrokeColor:Ai.stroke,circleBarCircleStrokeWidth:1,circleBarLineStrokeColor:Ai.stroke,scalingAttribute:"",rotation:0,rsRadius:10,rsRadius2:void 0,rsPoints:3,rsFillColor:[0,153,255,1],rsStrokeColor:[0,0,0,1],rsStrokeWidth:5,rsAngle:0,rsScale:void 0},line:{lineStrokeColor:Ai.stroke,lineStrokeWidth:5,lineStrokeCap:"round",lineStrokeJoin:"round",lineStrokeDash:void 0,lineStrokeDashOffset:0,lineStrokeMiterLimit:10},polygon:{polygonStrokeColor:Ai.stroke,polygonStrokeWidth:1,polygonStrokeCap:"round",polygonStrokeJoin:"round",polygonStrokeDash:void 0,polygonStrokeDashOffset:0,polygonStrokeMiterLimit:10,polygonFillColor:Ai.fill,polygonFillHatch:void 0},text:{textAlign:"center",textFont:"Comic Sans MS",textScale:2,textOffsetX:10,textOffsetY:-8,textFillColor:Ai.textFill,textStrokeColor:Ai.textStroke,textStrokeWidth:3,labelField:"",textSuffix:"",rotation:0,clusterTextType:"counter",clusterText:"",clusterTextAlign:"center",clusterTextFont:"Comic Sans MS",clusterTextScale:2,clusterTextOffsetX:0,clusterTextOffsetY:2,clusterTextFillColor:Ai.textFill,clusterTextStrokeColor:Ai.textStroke,clusterTextStrokeWidth:0},defaultMapMarkerPoint:{styleId:"defaultMapMarkerPoint",rules:[{style:{type:"icon",imageName:`<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='#E10019' class='bi bi-geo-alt-fill' viewBox='0 0 16 16'>
                    <path d='M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z'/>
                    </svg>`,imagePath:"",imageScale:2,imageOffsetY:16,imageOffsetYUnit:"pixels"}}]},defaultMapMarkerPolygon:{styleId:"defaultMapMarkerPolygon",rules:[{style:{polygonStrokeColor:[8,119,95,1],polygonStrokeWidth:4,polygonFillColor:[8,119,95,.3],polygonStrokeDash:[8]}}]},defaultAdditionalMapMarkerPolygon:{styleId:"defaultAdditionalMapMarkerPolygon",rules:[{style:{polygonStrokeColor:[255,255,0,1],polygonStrokeWidth:4,polygonFillColor:[255,255,0,.3],polygonStrokeDash:[8]}}]},defaultHighlightFeaturesPoint:{styleId:"defaultHighlightFeaturesPoint",rules:[{style:{type:"circle",circleFillColor:[255,255,0,.9],circleRadius:8}}]},defaultHighlightFeaturesPolygon:{styleId:"defaultHighlightFeaturesPolygon",rules:[{style:{polygonStrokeColor:[8,119,95,1],polygonStrokeWidth:4,polygonFillColor:[8,119,95,.3],polygonStrokeDash:[8]}}]},defaultHighlightFeaturesLine:{styleId:"defaultHighlightFeaturesLine",rules:[{style:{polygonStrokeColor:[8,119,95,1],polygonStrokeWidth:4,polygonFillColor:[8,119,95,.3],polygonStrokeDash:[8]}}]}};let Ug,Mx,Rx,Ix,Px,Ax,Lx,Ox,Fx,WT,Nx,H4;function J$(){const r=[];return Mx&&Mx.forEach(t=>{t.typ==="WFS"||t.typ==="GeoJSON"||t.typ==="SensorThings"||t.typ==="TileSet3D"||t.typ==="OAF"?t?.styleId&&r.push(t.styleId):t.typ==="GROUP"&&t.children.forEach(e=>{e?.styleId&&r.push(e.styleId)})}),r}function tG(){const r=[];return Rx&&Rx.forEach(t=>{t?.styleId&&(Array.isArray(t.styleId)?t.styleId.forEach(e=>{e instanceof Object?r.push(e.id):r.push(e)}):r.push(t.styleId))}),r}function eG(){let r;return Ix?r=Ix:r="defaultMapMarkerPoint",r}function rG(){let r;return Lx?r=Lx:r="defaultHighlightFeaturesPoint",r}function iG(){let r;return Fx?r=Fx:r="defaultHighlightFeaturesLine",r}function nG(){let r;return Px?r=Px:r="defaultMapMarkerPolygon",r}function sG(){let r;return Ax?r=Ax:r="defaultAdditionalMapMarkerPolygon",r}function oG(){let r;return Ox?r=Ox:r="defaultHighlightFeaturesPolygon",r}function aG(){const r=[];return Nx!==void 0&&Nx.forEach(t=>{r.push(t.styleId)}),r}function lG(r){const t=[...r];let e=[],i=[];return t.push({styleId:"default",rules:[{style:{}}]},An.defaultMapMarkerPoint,An.defaultMapMarkerPolygon,An.defaultAdditionalMapMarkerPolygon,An.defaultHighlightFeaturesPoint,An.defaultHighlightFeaturesPolygon,An.defaultHighlightFeaturesLine),e.push(J$(),eG(),nG(),sG(),rG(),oG(),iG(),tG(),aG(),H4),e=e.reduce((n,s)=>n.concat(s),[]).filter(n=>n),i=t.filter(n=>e.includes(n.styleId)),i}async function cG(r,t,e,i,n){return Mx=e,Rx=i,Ix=r.mapMarkerPointStyleId,Px=r.mapMarkerPolygonStyleId,Ax=r.additionalPolygonStyleId,Lx=r.highlightFeaturesPointStyleId,Ox=r.highlightFeaturesPolygonStyleId,Fx=r.highlightFeaturesLineStyleId,H4=r.zoomToFeatureId,WT=t.styleConf,Nx=t.featureViaURL?.layers,await fetch(WT).then(s=>s.json()).then(s=>{Ug=lG(s)}).catch(s=>{console.error(s),n(!1,!0)}),Ug}function hG(r){r.forEach(t=>{Ug.push(t)})}async function uG(r,t){let e;return await fetch(r.styleConf).then(i=>i.json()).then(i=>{e=i.find(n=>n.styleId===t),e&&Ug.push(e)}).catch(i=>{console.error(i)}),e}function dG(r){return Ug?.find(t=>t.styleId===r)}const Dx={initializeStyleList:cG,initStyleAndAddToList:uG,addToStyleList:hG,returnStyleObject:dG};function gG(r,t="."){const e=r.length,i=[];let n="",s="";for(let o=0;o<e;o++){if(n=r[o],n==="\\")o++,n=r[o];else if(n===t){i.push(s),s="";continue}s+=n}return s&&i.push(s),i}function Y4(r,t,e="@",i=".",n=20){if(typeof r!="object"||r===null||typeof t!="string"||typeof e=="string"&&t.substr(0,e.length)!==e)return;const s=gG(typeof e=="string"?t.substring(e.length):t,i),o=s.length;let a=r,l=0;for(let c=0;c<o;c++)if(typeof a!="object"||a===null||(a=a[s[c]],l++,typeof a>"u"||l>n))return;return a}function fG(r,t=".",e=","){if(typeof r!="number"&&typeof r!="string")return"";const i=typeof r!="string"?r.toString():r,n=i.indexOf("."),s=n>-1?i.substring(0,n):i,o=s.replace(/\B(?=(\d{3})+(?!\d),?.*)/g,t),a=n>-1?i.substring(n+1):!1;return a?o+e+a:o}var $x={exports:{}},pG=$x.exports,VT;function mG(){return VT||(VT=1,(function(r,t){(function(e,i){r.exports=i()})(pG,(function(){var e=1e3,i=6e4,n=36e5,s="millisecond",o="second",a="minute",l="hour",c="day",h="week",u="month",d="quarter",g="year",f="date",p="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(P){var T=["th","st","nd","rd"],D=P%100;return"["+P+(T[(D-20)%10]||T[D]||T[0])+"]"}},x=function(P,T,D){var A=String(P);return!A||A.length>=T?P:""+Array(T+1-A.length).join(D)+P},v={s:x,z:function(P){var T=-P.utcOffset(),D=Math.abs(T),A=Math.floor(D/60),$=D%60;return(T<=0?"+":"-")+x(A,2,"0")+":"+x($,2,"0")},m:function P(T,D){if(T.date()<D.date())return-P(D,T);var A=12*(D.year()-T.year())+(D.month()-T.month()),$=T.clone().add(A,u),z=D-$<0,j=T.clone().add(A+(z?-1:1),u);return+(-(A+(D-$)/(z?$-j:j-$))||0)},a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:u,y:g,w:h,d:c,D:f,h:l,m:a,s:o,ms:s,Q:d}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},w="en",b={};b[w]=_;var E="$isDayjsObject",C=function(P){return P instanceof F||!(!P||!P[E])},S=function P(T,D,A){var $;if(!T)return w;if(typeof T=="string"){var z=T.toLowerCase();b[z]&&($=z),D&&(b[z]=D,$=z);var j=T.split("-");if(!$&&j.length>1)return P(j[0])}else{var et=T.name;b[et]=T,$=et}return!A&&$&&(w=$),$||!A&&w},R=function(P,T){if(C(P))return P.clone();var D=typeof T=="object"?T:{};return D.date=P,D.args=arguments,new F(D)},I=v;I.l=S,I.i=C,I.w=function(P,T){return R(P,{locale:T.$L,utc:T.$u,x:T.$x,$offset:T.$offset})};var F=(function(){function P(D){this.$L=S(D.locale,null,!0),this.parse(D),this.$x=this.$x||D.x||{},this[E]=!0}var T=P.prototype;return T.parse=function(D){this.$d=(function(A){var $=A.date,z=A.utc;if($===null)return new Date(NaN);if(I.u($))return new Date;if($ instanceof Date)return new Date($);if(typeof $=="string"&&!/Z$/i.test($)){var j=$.match(m);if(j){var et=j[2]-1||0,q=(j[7]||"0").substring(0,3);return z?new Date(Date.UTC(j[1],et,j[3]||1,j[4]||0,j[5]||0,j[6]||0,q)):new Date(j[1],et,j[3]||1,j[4]||0,j[5]||0,j[6]||0,q)}}return new Date($)})(D),this.init()},T.init=function(){var D=this.$d;this.$y=D.getFullYear(),this.$M=D.getMonth(),this.$D=D.getDate(),this.$W=D.getDay(),this.$H=D.getHours(),this.$m=D.getMinutes(),this.$s=D.getSeconds(),this.$ms=D.getMilliseconds()},T.$utils=function(){return I},T.isValid=function(){return this.$d.toString()!==p},T.isSame=function(D,A){var $=R(D);return this.startOf(A)<=$&&$<=this.endOf(A)},T.isAfter=function(D,A){return R(D)<this.startOf(A)},T.isBefore=function(D,A){return this.endOf(A)<R(D)},T.$g=function(D,A,$){return I.u(D)?this[A]:this.set($,D)},T.unix=function(){return Math.floor(this.valueOf()/1e3)},T.valueOf=function(){return this.$d.getTime()},T.startOf=function(D,A){var $=this,z=!!I.u(A)||A,j=I.p(D),et=function(Ot,Y){var We=I.w($.$u?Date.UTC($.$y,Y,Ot):new Date($.$y,Y,Ot),$);return z?We:We.endOf(c)},q=function(Ot,Y){return I.w($.toDate()[Ot].apply($.toDate("s"),(z?[0,0,0,0]:[23,59,59,999]).slice(Y)),$)},vt=this.$W,jt=this.$M,V=this.$D,It="set"+(this.$u?"UTC":"");switch(j){case g:return z?et(1,0):et(31,11);case u:return z?et(1,jt):et(0,jt+1);case h:var Et=this.$locale().weekStart||0,Mt=(vt<Et?vt+7:vt)-Et;return et(z?V-Mt:V+(6-Mt),jt);case c:case f:return q(It+"Hours",0);case l:return q(It+"Minutes",1);case a:return q(It+"Seconds",2);case o:return q(It+"Milliseconds",3);default:return this.clone()}},T.endOf=function(D){return this.startOf(D,!1)},T.$set=function(D,A){var $,z=I.p(D),j="set"+(this.$u?"UTC":""),et=($={},$[c]=j+"Date",$[f]=j+"Date",$[u]=j+"Month",$[g]=j+"FullYear",$[l]=j+"Hours",$[a]=j+"Minutes",$[o]=j+"Seconds",$[s]=j+"Milliseconds",$)[z],q=z===c?this.$D+(A-this.$W):A;if(z===u||z===g){var vt=this.clone().set(f,1);vt.$d[et](q),vt.init(),this.$d=vt.set(f,Math.min(this.$D,vt.daysInMonth())).$d}else et&&this.$d[et](q);return this.init(),this},T.set=function(D,A){return this.clone().$set(D,A)},T.get=function(D){return this[I.p(D)]()},T.add=function(D,A){var $,z=this;D=Number(D);var j=I.p(A),et=function(jt){var V=R(z);return I.w(V.date(V.date()+Math.round(jt*D)),z)};if(j===u)return this.set(u,this.$M+D);if(j===g)return this.set(g,this.$y+D);if(j===c)return et(1);if(j===h)return et(7);var q=($={},$[a]=i,$[l]=n,$[o]=e,$)[j]||1,vt=this.$d.getTime()+D*q;return I.w(vt,this)},T.subtract=function(D,A){return this.add(-1*D,A)},T.format=function(D){var A=this,$=this.$locale();if(!this.isValid())return $.invalidDate||p;var z=D||"YYYY-MM-DDTHH:mm:ssZ",j=I.z(this),et=this.$H,q=this.$m,vt=this.$M,jt=$.weekdays,V=$.months,It=$.meridiem,Et=function(Y,We,L,O){return Y&&(Y[We]||Y(A,z))||L[We].slice(0,O)},Mt=function(Y){return I.s(et%12||12,Y,"0")},Ot=It||function(Y,We,L){var O=Y<12?"AM":"PM";return L?O.toLowerCase():O};return z.replace(y,(function(Y,We){return We||(function(L){switch(L){case"YY":return String(A.$y).slice(-2);case"YYYY":return I.s(A.$y,4,"0");case"M":return vt+1;case"MM":return I.s(vt+1,2,"0");case"MMM":return Et($.monthsShort,vt,V,3);case"MMMM":return Et(V,vt);case"D":return A.$D;case"DD":return I.s(A.$D,2,"0");case"d":return String(A.$W);case"dd":return Et($.weekdaysMin,A.$W,jt,2);case"ddd":return Et($.weekdaysShort,A.$W,jt,3);case"dddd":return jt[A.$W];case"H":return String(et);case"HH":return I.s(et,2,"0");case"h":return Mt(1);case"hh":return Mt(2);case"a":return Ot(et,q,!0);case"A":return Ot(et,q,!1);case"m":return String(q);case"mm":return I.s(q,2,"0");case"s":return String(A.$s);case"ss":return I.s(A.$s,2,"0");case"SSS":return I.s(A.$ms,3,"0");case"Z":return j}return null})(Y)||j.replace(":","")}))},T.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},T.diff=function(D,A,$){var z,j=this,et=I.p(A),q=R(D),vt=(q.utcOffset()-this.utcOffset())*i,jt=this-q,V=function(){return I.m(j,q)};switch(et){case g:z=V()/12;break;case u:z=V();break;case d:z=V()/3;break;case h:z=(jt-vt)/6048e5;break;case c:z=(jt-vt)/864e5;break;case l:z=jt/n;break;case a:z=jt/i;break;case o:z=jt/e;break;default:z=jt}return $?z:I.a(z)},T.daysInMonth=function(){return this.endOf(u).$D},T.$locale=function(){return b[this.$L]},T.locale=function(D,A){if(!D)return this.$L;var $=this.clone(),z=S(D,A,!0);return z&&($.$L=z),$},T.clone=function(){return I.w(this.$d,this)},T.toDate=function(){return new Date(this.valueOf())},T.toJSON=function(){return this.isValid()?this.toISOString():null},T.toISOString=function(){return this.$d.toISOString()},T.toString=function(){return this.$d.toUTCString()},P})(),N=F.prototype;return R.prototype=N,[["$ms",s],["$s",o],["$m",a],["$H",l],["$W",c],["$M",u],["$y",g],["$D",f]].forEach((function(P){N[P[1]]=function(T){return this.$g(T,P[0],P[1])}})),R.extend=function(P,T){return P.$i||(P(T,F,R),P.$i=!0),R},R.locale=S,R.isDayjs=C,R.unix=function(P){return R(1e3*P)},R.en=b[w],R.Ls=b,R.p={},R}))})($x)),$x.exports}var yG=mG();const _G=AM(yG);function Wg(r){return typeof r=="string"&&r.startsWith("@")}function Vg(r,t){Object.keys(r).forEach(n=>{r[n]&&typeof r[n]=="object"&&Object.keys(r[n]).forEach(s=>{r[n+"."+s]=r[n][s]})});const e=Wg(t);let i=r[Object.keys(r).find(n=>n.toLowerCase()===t.toLowerCase())];return e&&(i=Y4(r,t)),i}function vG(r,t){let e=String(r);return Object.prototype.hasOwnProperty.call(t,r)&&(e=t[r]),e}function xG(r,t){let e=r;return t&&(e=String(e)+" "+t),e}function wG(r,t){let e=r;return t&&(e=t+String(e)),e}function bG(r,t,e){let i,n;return t==="contains"?(n=Object.keys(e).filter(s=>s.includes(r))[0],i=e[n]):t==="startsWith"?(n=Object.keys(e).filter(s=>s.startsWith(r))[0],i=e[n]):t==="endsWith"?(n=Object.keys(e).filter(s=>s.endsWith(r))[0],i=e[n]):i=e[r],i}function kG(r,t,e){const i=r;return t&&Object.keys(t).forEach(n=>{t[n]==="%value%"?i.setAttribute(n,e):i.setAttribute(n,t[n])}),i}function ZT(r,t,e){const i=t?.type?t.type:"string",n=t?.condition?t.condition:null,s=new XMLSerializer;let o=Vg(e,r),a=t?.format?t.format:"YYYY-MM-DDTHH:mm:ss.SSSZ",l,c;switch(n&&(o=bG(r,n,e)),i){case"date":{if(l=new Date(String(o)),a==="YYYY-MM-DDTHH:mm:ss.SSSZ"){const h=l.getTimezoneOffset();let u=h/60%24,d=h%60;u=u<0?"+"+("0"+Math.abs(u)).slice(-2):"-"+("0"+Math.abs(u)).slice(-2),d=d<0?":"+("0"+Math.abs(d)).slice(-2):":"+("0"+d).slice(-2),o=l.toISOString().slice(0,-1)+u+d}else isNaN(l.getDay())?console.warn("If the attribute is missing, ISO 8601 is used."):o=_G(String(o)).format(a);break}case"number":{o=fG(o);break}case"linechart":{o=Object.assign({name:r,staObject:o},t);break}case"boolean":{a=a==="DD.MM.YYYY HH:mm:ss"?{true:"true",false:"false"}:a,o=vG(o,a);break}case"html":{o!==void 0&&(t?.html?.tag&&(c=document.createElement(t?.html?.tag)),t?.html?.innerHTML==="%value%"?c.innerHTML=o:t?.html?.innerHTML&&(c.innerHTML=t?.html?.innerHTML),c&&(t?.html?.properties&&(c=kG(c,t?.html?.properties,o)),o=s.serializeToString(c),o=o.replace(/ xmlns="(.*?)"/g,"")));break}default:o=String(o)}return o&&t.suffix&&o!=="undefined"&&(o=xG(o,t.suffix)),o&&t.prefix&&o!=="undefined"&&(o=wG(o,t.prefix)),o}function J0(r,t,e=!0){let i;return t?(e?(i={},Object.keys(t).forEach(n=>{let s=t[n],o=Vg(r,n);typeof s=="object"&&(o=ZT(n,s,r),s=s.name),o&&o!=="undefined"&&(i[s]=o)})):typeof t=="string"?i=Vg(r,t):i=ZT(t.name,t,r),i):!1}function HT(r){return typeof r=="string"&&r.indexOf(",")>-1?parseFloat(r.replace(",",".")):r}function EG(r,t){const e=Wg(t);let i=t;return e&&(i=J0(r,i,!1)),Array.isArray(i)&&i.forEach((n,s,o)=>{Wg(n)&&(o[s]=J0(r,n,!1))}),i}function SG(r,t){let e=r;if(typeof r=="string"&&typeof t=="string"&&r===t)return!0;if(typeof r=="boolean"&&typeof t=="boolean"){if(r===t)return!0}else if(typeof t=="number"){if(e=parseFloat(e),!isNaN(r)&&e===parseFloat(t))return!0}else if(Array.isArray(t)&&t.every(i=>typeof i=="number"||i===null)&&(t.length===2||t.length===4)&&(e=parseFloat(HT(e)),!isNaN(HT(r))))return t.length===2||t.length===4&&(e=1/(parseFloat(t[3],10)-parseFloat(t[2],10))*(e-parseFloat(t[2],10))),t[0]===null&&t[1]===null?!0:t[0]===null?e<parseFloat(t[1]):t[1]===null?e>=parseFloat(t[0]):e>=parseFloat(t[0])&&e<parseFloat(t[1]);return!1}function YT(r,t,e){let i=r;typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"features")&&Array.isArray(r.features)&&r.features.length>0&&(i=r.features[0].getProperties());const n=J0(i,t,!1),s=EG(i,e);return(typeof n=="boolean"||typeof n=="string"||typeof n=="number")&&(typeof s=="boolean"||typeof s=="string"||typeof s=="number"||Array.isArray(s)&&s.every(o=>typeof o=="number"||o===null)&&(s.length===2||s.length===4))?SG(n,s):!1}function TG(r,t){if(t?.conditions?.properties&&r){const e=r.getProperties(),i=t.conditions.properties;let n,s;if(Array.isArray(i))for(s in i){const o=i[s].value;if(n=i[s].attrName,!YT(e,n,o))return!1}else for(n in i){const o=i[n];if(!YT(e,n,o))return!1}return!0}return!0}function X4(r,t){return r.rules.forEach(e=>{typeof t?.get("rotation")<"u"&&(e.style.rotation=t.get("rotation"))}),r.rules.filter(e=>TG(t,e))}function CG(r,t){return r.find(e=>{const i=e.conditions?.sequence?e.conditions.sequence:null,n=i&&Array.isArray(i)&&i.every(a=>typeof a=="number")&&i.length===2&&i[1]>=i[0],s=n?i[0]:-1,o=n?i[1]:-1;return t>=s&&t<=o})}function MG(r,t){const e=CG(r,t),i=r.find(s=>s?.conditions&&!Object.prototype.hasOwnProperty.call(s.conditions,"sequence")),n=r.find(s=>!s?.conditions);return e||i||n||null}function RG(r){const t=[1,1,1,1];return r.concat(t).slice(0,4)}function IG(r){const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,e=r.replace(t,function(n,s,o,a){return s+s+o+o+a+a});let i;return i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,i=i.exec(e),i?[parseFloat(i[1],16),parseFloat(i[2],16),parseFloat(i[3],16)]:null}function w_(r){const t=Number(r).toString(16);return t.length===1?"0"+t:t}function PG(r,t,e){return"#"+w_(r)+w_(t)+w_(e)}function Bi(r,t){let e,i=r,n=[];return Array.isArray(i)?e="rgb":typeof i=="string"&&i.indexOf("#")===0?e="hex":typeof i=="string"&&i.indexOf("#")===-1&&(e="rgb",n=i.replace("[","").replace("]","").replace(/ /g,"").split(","),i=[n[0],n[1],n[2],n[3]]),e==="hex"&&t==="rgb"?i=IG(i):e==="rgb"&&t==="hex"?i=PG(i[0],i[1],i[2]):e==="rgb"&&t==="rgba"&&(i="rgba("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"),i=t==="rgb"?RG(i):i,i}const tm=[{style:{"circle-fill-color":["match",["get","selected"],1,"#0c2026","#006688"],"circle-radius":["interpolate",["exponential",1.5],["zoom"],3,6,6,10,9,20,12,35,15,60,18,110],"circle-rotate-with-view":!1,"circle-displacement":[0,0],"circle-opacity":.6}}],Ea={fillColor:"#006688",strokeColor:"#006688",strokeWidth:1,opacity:1},K4=Object.assign({"stroke-color":["get","strokeColor"],"stroke-width":["get","strokeWidth","number"],"fill-color":["get","fillColor"],opacity:["get","opacity","number"],size:["get","circleSize","number"]},tm);function AG(){class r extends Hc{constructor(e){super(e),this.styleVariables=e.styleVariables||{}}createRenderer(){return new V4(this,{style:K4})}getStyleVariables(){return this.styleVariables}}return r}function LG(r){class t extends Z4{createRenderer(){return new Y$(this,{style:r.style?r.style:K4})}}return t}function OG(r,t){let e;if(t&&(e=X4(t,r)[0]),e?.style){r.styleRule=e;const i=Bi(e.style.polygonFillColor,"rgba"),n=Bi(e.style.circleFillColor,"hex"),s=i||n,o=Bi(e.style.polygonStrokeColor||e.style.lineStrokeColor,"hex"),a=e.style.polygonStrokeWidth||e.style.lineStrokeWidth,l=e.style.circleRadius;r.set("fillColor",s||Ea.fillColor),r.set("strokeColor",o||Ea.strokeColor),r.set("strokeWidth",a||Ea.strokeWidth),r.set("opacity",s?(e.style.polygonFillColor||e.style.circleFillColor)[3]:Ea.opacity),r.set("circleSize",l||tm["circle-radius"]*2)}else r.set("fillColor",Ea.fillColor),r.set("strokeColor",Ea.strokeColor),r.set("strokeWidth",Ea.strokeWidth),r.set("opacity",Ea.opacity),r.set("circleSize",tm["circle-radius"]*2)}function FG(r){r.getGeometry()?.setCoordinates?.(r.getGeometry().getCoordinates(),"XY")}function NG(r,t=["boolean"]){for(const e in r.getProperties()){const i=parseFloat(r.get(e)),n=typeof r.get(e)=="string"&&r.get(e).toLowerCase()==="true"?!0:void 0,s=typeof r.get(e)=="string"&&r.get(e).toLowerCase()==="false"?!1:void 0;!isNaN(parseFloat(r.get(e)))&&!t?.includes("number")&&r.set(e,i),n===!0&&!t.includes("boolean")&&r.set(e,n),s===!1&&!t.includes("boolean")&&r.set(e,s)}}function Au(r,t,e,i){const n=Dx.returnStyleObject(t);Array.isArray(r)&&r.forEach(s=>{i&&s.getGeometry().getType()==="MultiPoint"&&s.setGeometry(s.getGeometry().getPoint(0)),FG(s),OG(s,n),NG(s,e)})}function L1(r){let t=Q$;const e={id:r.id,source:r.source,disableHitDetection:!1,name:r.name,typ:r.typ,gfiAttributes:r.gfiAttributes,gfiTheme:r.gfiTheme,hitTolerance:r.hitTolerance||10,opacity:r.transparency?(100-r.transparency)/100:r.opacity,renderer:"webgl",styleId:r.styleId,excludeTypesFromParsing:r.excludeTypesFromParsing,extent:r.extent,zIndex:r.zIndex};return r.isPointLayer?new t({style:r.style||tm,disableHitDetection:!1,...e,isPointLayer:!0}):(r.typ==="VectorTile"?t=LG(r):t=AG(),new t({...e,isPointLayer:!1}))}var XT={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},bd=" ",KT=/(italic|oblique)$/i,QT={};function Gx(r,t,e){var i=QT[r];if(!i){Array.isArray(r)||(r=[r]);for(var n=400,s="normal",o=[],a,l,c=0,h=r.length;c<h;++c){var u=r[c],d=u.split(" "),g=d[d.length-1].toLowerCase();g=="normal"||g=="italic"||g=="oblique"?(s=l?s:g,l=!0,d.pop(),g=d[d.length-1].toLowerCase()):KT.test(g)&&(g=g.replace(KT,""),s=l?s:d[d.length-1].replace(g,""),l=!0);for(var f in XT){var p=d.length>1?d[d.length-2].toLowerCase():"";if(g==f||g==f.replace("-","")||p+"-"+g==f){n=a?n:XT[f],d.pop(),p&&f.startsWith(p)&&d.pop();break}}!a&&typeof g=="number"&&(n=g,a=!0);var m=d.join(bd).replace("Klokantech Noto Sans","Noto Sans").replace("DIN Pro","Barlow").replace("Arial Unicode MS","Arial");m.indexOf(bd)!==-1&&(m='"'+m+'"'),o.push(m)}i=QT[r]=[s,n,o]}return i[0]+bd+i[1]+bd+t+"px"+(e?"/"+e:"")+bd+i[2]}const Q4="https://api.mapbox.com";function Rb(r){const t="mapbox://";return r.indexOf(t)!==0?"":r.slice(t.length)}function DG(r,t,e){const i=Rb(r);if(!i)return decodeURI(new URL(r,e).href);const n="sprites/";if(i.indexOf(n)!==0)throw new Error(`unexpected sprites url: ${r}`);const s=i.slice(n.length);return`${Q4}/styles/v1/${s}/sprite?access_token=${t}`}function em(r,t){const e=Rb(r);if(!e)return decodeURI(new URL(r,location.href).href);const i="styles/";if(e.indexOf(i)!==0)throw new Error(`unexpected style url: ${r}`);const n=e.slice(i.length);return`${Q4}/styles/v1/${n}?&access_token=${t}`}const $G=["a","b","c","d"];function _0(r,t,e,i){const n=new URL(r,i||location.href),s=Rb(r);if(!s)return t?(n.searchParams.has(e)||n.searchParams.set(e,t),[decodeURI(n.href)]):[decodeURI(n.href)];if(s==="mapbox.satellite"){const o=window.devicePixelRatio>=1.5?"@2x":"";return[`https://api.mapbox.com/v4/${s}/{z}/{x}/{y}${o}.webp?access_token=${t}`]}return $G.map(o=>`https://${o}.tiles.mapbox.com/v4/${s}/{z}/{x}/{y}.vector.pbf?access_token=${t}`)}const JT={},tC={};let GG=0;function Ib(r){return r.id||(r.id=GG++),r.id}function jG(r,t){return Ib(r)+"."+$t(t)}function J4(r){let t=JT[r.id];return t||(t={},JT[Ib(r)]=t),t}function zG(r){let t=tC[r.id];return t||(t={},tC[Ib(r)]=t),t}function b_(r){return r*Math.PI/180}const ho=(function(){const r=[];for(let t=78271.51696402048;r.length<=24;t/=2)r.push(t);return r})();function O1(r,t){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof OffscreenCanvas<"u")return new OffscreenCanvas(r,t);const e=document.createElement("canvas");return e.width=r,e.height=t,e}function Pb(r,t){let e=0;const i=t.length;for(;e<i;++e)if(t[e]<r&&e+1<i){const n=t[e]/t[e+1];return e+Math.log(t[e]/r)/Math.log(n)}return i-1}function Dd(r,t){const e=Math.floor(r),i=Math.pow(2,r-e);return t[e]/i}const gh={};function Lu(r,t,e={},i){if(t in gh)return i&&(i.url=gh[t][0].url),gh[t][1];const n=e.transformRequest&&e.transformRequest(t,r)||t,s=function(l){return delete gh[t],Promise.reject(new Error("Error fetching source "+t))},o=function(l){return delete gh[t],l.ok?l.json():Promise.reject(new Error("Error fetching source "+t))},a=xu(()=>n).then(l=>l instanceof Response?(i&&(i.url=l.url),o(l)):(l instanceof Request||(l=new Request(l)),l.headers.get("Accept")||l.headers.set("Accept","application/json"),i&&(i.url=l.url),fetch(l).then(o).catch(s))).catch(s);return gh[t]=[n,a],a}function tI(r,t){if(typeof r=="string")if(r.trim().startsWith("{"))try{const e=JSON.parse(r);return Promise.resolve(e)}catch(e){return Promise.reject(e)}else return r=em(r,t.accessToken),Lu("Style",r,t);else return Promise.resolve(r)}const eC={};function eI(r,t,e={}){const i=[t,JSON.stringify(r)].toString();let n=eC[i];if(!n||e.transformRequest){let s;e.transformRequest&&(s=(a,l)=>{const c=e.transformRequest&&e.transformRequest(l,"Tiles")||l;if(a instanceof aR)a.setLoader((h,u,d)=>{const g=function(f){f.arrayBuffer().then(p=>{const m=a.getFormat().readFeatures(p,{extent:h,featureProjection:d});a.setFeatures(m)})};xu(()=>c).then(f=>{if(f instanceof Response)return g(f);fetch(f).then(g).catch(p=>a.setState(yt.ERROR))}).catch(f=>a.setState(yt.ERROR))});else{const h=a.getImage();xu(()=>c).then(u=>{if(typeof u=="string"){h.src=u;return}const d=g=>g.blob().then(f=>{const p=URL.createObjectURL(f);h.addEventListener("load",()=>URL.revokeObjectURL(p)),h.addEventListener("error",()=>URL.revokeObjectURL(p)),h.src=p});if(u instanceof Response)return d(u);fetch(u).then(d).catch(g=>a.setState(yt.ERROR))}).catch(u=>a.setState(yt.ERROR))}});const o=r.url;if(o&&!r.tiles){const a=_0(o,e.accessToken,e.accessTokenParam||"access_token",t||location.href);if(o.startsWith("mapbox://"))n=Promise.resolve({tileJson:Object.assign({},r,{url:void 0,tiles:a}),tileLoadFunction:s});else{const l={};n=Lu("Source",a[0],e,l).then(function(c){return c.tiles=c.tiles.map(function(h){return c.scheme==="tms"&&(h=h.replace("{y}","{-y}")),_0(h,e.accessToken,e.accessTokenParam||"access_token",l.url)[0]}),Promise.resolve({tileJson:c,tileLoadFunction:s})})}}else r=Object.assign({},r,{tiles:r.tiles.map(function(a){return r.scheme==="tms"&&(a=a.replace("{y}","{-y}")),_0(a,e.accessToken,e.accessTokenParam||"access_token",t||location.href)[0]})}),n=Promise.resolve({tileJson:Object.assign({},r),tileLoadFunction:s});eC[i]=n}return n}function rC(r,t,e,i){const n=[2*e*t.pixelRatio+t.width,2*e*t.pixelRatio+t.height],s=O1(n[0],n[1]),o=s.getContext("2d");o.drawImage(r,t.x,t.y,t.width,t.height,e*t.pixelRatio,e*t.pixelRatio,t.width,t.height);const a=o.getImageData(0,0,n[0],n[1]);o.globalCompositeOperation="destination-over",o.fillStyle=`rgba(${i.r*255},${i.g*255},${i.b*255},${i.a})`;const l=a.data;for(let c=0,h=a.width;c<h;++c)for(let u=0,d=a.height;u<d;++u){const g=(u*h+c)*4;l[g+3]>0&&o.arc(c,u,e*t.pixelRatio,0,2*Math.PI)}return o.fill(),s}function qG(r,t,e){const i=Math.max(0,Math.min(1,(e-r)/(t-r)));return i*i*(3-2*i)}function iC(r,t,e){const i=O1(t.width,t.height),n=i.getContext("2d");n.drawImage(r,t.x,t.y,t.width,t.height,0,0,t.width,t.height);const s=n.getImageData(0,0,t.width,t.height),o=s.data;for(let a=0,l=s.width;a<l;++a)for(let c=0,h=s.height;c<h;++c){const u=(c*l+a)*4,d=o[u+3]/255,g=.75,f=.1,p=qG(g-f,g+f,d);p>0?(o[u+0]=Math.round(255*e.r*p),o[u+1]=Math.round(255*e.g*p),o[u+2]=Math.round(255*e.b*p),o[u+3]=Math.round(255*p)):o[u+3]=0}return n.putImageData(s,0,0),i}const BG=Array(256).join("â");function jx(r,t){if(t>=.05){let e="";const i=r.split(`
`),n=BG.slice(0,Math.round(t/.1));for(let s=0,o=i.length;s<o;++s)s>0&&(e+=`
`),e+=i[s].split("").join(n);return e}return r}let k_;function rI(){return k_||(k_=O1(1,1).getContext("2d")),k_}function Ol(r,t){return rI().measureText(r).width+(r.length-1)*t}const nC={};function zx(r,t,e,i){if(r.indexOf(`
`)!==-1){const o=r.split(`
`),a=[];for(let l=0,c=o.length;l<c;++l)a.push(zx(o[l],t,e,i));return a.join(`
`)}const n=e+","+t+","+r+","+i;let s=nC[n];if(!s){const o=r.split(" ");if(o.length>1){const a=rI();a.font=t;const l=a.measureText("M").width*e;let c="";const h=[];for(let u=0,d=o.length;u<d;++u){const g=o[u],f=c+(c?" ":"")+g;Ol(f,i)<=l?c=f:(c&&h.push(c),c=g)}c&&h.push(c);for(let u=0,d=h.length;u<d&&d>1;++u){const g=h[u];if(Ol(g,i)<l*.35){const f=u>0?Ol(h[u-1],i):1/0,p=u<d-1?Ol(h[u+1],i):1/0;h.splice(u,1),d-=1,f<p?(h[u-1]+=" "+g,u-=1):h[u]=g+" "+h[u]}}for(let u=0,d=h.length-1;u<d;++u){const g=h[u],f=h[u+1];if(Ol(g,i)>l*.7&&Ol(f,i)<l*.6){const p=g.split(" "),m=p.pop();Ol(m,i)<l*.2&&(h[u]=p.join(" "),h[u+1]=m+" "+f),d-=1}}s=h.join(`
`)}else s=r;s=jx(s,i),nC[n]=s}return s}const UG=/font-family: ?([^;]*);/,WG=/("|')/g;let Sp;function VG(r){if(!Sp){Sp={};const t=document.styleSheets;for(let e=0,i=t.length;e<i;++e){const n=t[e];try{const s=n.rules||n.cssRules;if(s)for(let o=0,a=s.length;o<a;++o){const l=s[o];if(l.type==5){const c=l.cssText.match(UG);Sp[c[1].replace(WG,"")]=!0}}}catch{}}}return r in Sp}const E_={};function ZG(r,t="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){const e=r.toString();if(e in E_)return E_[e];const i=[];for(let n=0,s=r.length;n<s;++n){r[n]=r[n].replace("Arial Unicode MS","Arial");const o=r[n],a=Gx(o,1);iR(a);const l=a.split(" ");i.push([l.slice(3).join(" ").replace(/"/g,""),l[1],l[0]])}for(let n=0,s=i.length;n<s;++n){const o=i[n],a=o[0];if(!VG(a)&&Ul.get(`${o[2]}
${o[1]} 
${a}`)!==100){const l=t.replace("{font-family}",a.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",a.replace(/ /g,"+")).replace("{fontweight}",o[1]).replace("{-fontstyle}",o[2].replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",o[2]);if(!document.querySelector('link[href="'+l+'"]')){const c=document.createElement("link");c.href=l,c.rel="stylesheet",document.head.appendChild(c)}}}return E_[e]=r,r}function HG(r){r("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),r("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),r("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)r("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),r("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");r("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),r("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),r.WGS84=r["EPSG:4326"],r["EPSG:3785"]=r["EPSG:3857"],r.GOOGLE=r["EPSG:3857"],r["EPSG:900913"]=r["EPSG:3857"],r["EPSG:102113"]=r["EPSG:3857"]}var Lc=1,Oc=2,ou=3,YG=4,qx=5,sC=6378137,XG=6356752314e-3,oC=.0066943799901413165,rg=484813681109536e-20,st=Math.PI/2,KG=.16666666666666666,QG=.04722222222222222,JG=.022156084656084655,ft=1e-10,$r=.017453292519943295,wn=57.29577951308232,He=Math.PI/4,Zg=Math.PI*2,Wr=3.14159265359,Sn={};Sn.greenwich=0;Sn.lisbon=-9.131906111111;Sn.paris=2.337229166667;Sn.bogota=-74.080916666667;Sn.madrid=-3.687938888889;Sn.rome=12.452333333333;Sn.bern=7.439583333333;Sn.jakarta=106.807719444444;Sn.ferro=-17.666666666667;Sn.brussels=4.367975;Sn.stockholm=18.058277777778;Sn.athens=23.7163375;Sn.oslo=10.722916666667;const t9={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var aC=/[\s_\-\/\(\)]/g;function wl(r,t){if(r[t])return r[t];for(var e=Object.keys(r),i=t.toLowerCase().replace(aC,""),n=-1,s,o;++n<e.length;)if(s=e[n],o=s.toLowerCase().replace(aC,""),o===i)return r[s]}function Bx(r){var t={},e=r.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,l){var c=l.split("=");return c.push(!0),a[c[0].toLowerCase()]=c[1],a},{}),i,n,s,o={proj:"projName",datum:"datumCode",rf:function(a){t.rf=parseFloat(a)},lat_0:function(a){t.lat0=a*$r},lat_1:function(a){t.lat1=a*$r},lat_2:function(a){t.lat2=a*$r},lat_ts:function(a){t.lat_ts=a*$r},lon_0:function(a){t.long0=a*$r},lon_1:function(a){t.long1=a*$r},lon_2:function(a){t.long2=a*$r},alpha:function(a){t.alpha=parseFloat(a)*$r},gamma:function(a){t.rectified_grid_angle=parseFloat(a)*$r},lonc:function(a){t.longc=a*$r},x_0:function(a){t.x0=parseFloat(a)},y_0:function(a){t.y0=parseFloat(a)},k_0:function(a){t.k0=parseFloat(a)},k:function(a){t.k0=parseFloat(a)},a:function(a){t.a=parseFloat(a)},b:function(a){t.b=parseFloat(a)},r:function(a){t.a=t.b=parseFloat(a)},r_a:function(){t.R_A=!0},zone:function(a){t.zone=parseInt(a,10)},south:function(){t.utmSouth=!0},towgs84:function(a){t.datum_params=a.split(",").map(function(l){return parseFloat(l)})},to_meter:function(a){t.to_meter=parseFloat(a)},units:function(a){t.units=a;var l=wl(t9,a);l&&(t.to_meter=l.to_meter)},from_greenwich:function(a){t.from_greenwich=a*$r},pm:function(a){var l=wl(Sn,a);t.from_greenwich=(l||parseFloat(a))*$r},nadgrids:function(a){a==="@null"?t.datumCode="none":t.nadgrids=a},axis:function(a){var l="ewnsud";a.length===3&&l.indexOf(a.substr(0,1))!==-1&&l.indexOf(a.substr(1,1))!==-1&&l.indexOf(a.substr(2,1))!==-1&&(t.axis=a)},approx:function(){t.approx=!0},over:function(){t.over=!0}};for(i in e)n=e[i],i in o?(s=o[i],typeof s=="function"?s(n):t[s]=n):t[i]=n;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t.projStr=r,t}let iI=class{static getId(t){const e=t.find(i=>Array.isArray(i)&&i[0]==="ID");return e&&e.length>=3?{authority:e[1],code:parseInt(e[2],10)}:null}static convertUnit(t,e="unit"){if(!t||t.length<3)return{type:e,name:"unknown",conversion_factor:null};const i=t[1],n=parseFloat(t[2])||null,s=t.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:e,name:i,conversion_factor:n,id:o}}static convertAxis(t){const e=t[1]||"Unknown";let i;const n=e.match(/^\((.)\)$/);if(n){const c=n[1].toUpperCase();if(c==="E")i="east";else if(c==="N")i="north";else if(c==="U")i="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else i=t[2]?t[2].toLowerCase():"unknown";const s=t.find(c=>Array.isArray(c)&&c[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=t.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(a);return{name:e,direction:i,unit:l,order:o}}static extractAxes(t){return t.filter(e=>Array.isArray(e)&&e[0]==="AXIS").map(e=>this.convertAxis(e)).sort((e,i)=>(e.order||0)-(i.order||0))}static convert(t,e={}){switch(t[0]){case"PROJCRS":e.type="ProjectedCRS",e.name=t[1],e.base_crs=t.find(d=>Array.isArray(d)&&d[0]==="BASEGEOGCRS")?this.convert(t.find(d=>Array.isArray(d)&&d[0]==="BASEGEOGCRS")):null,e.conversion=t.find(d=>Array.isArray(d)&&d[0]==="CONVERSION")?this.convert(t.find(d=>Array.isArray(d)&&d[0]==="CONVERSION")):null;const i=t.find(d=>Array.isArray(d)&&d[0]==="CS");i&&(e.coordinate_system={type:i[1],axis:this.extractAxes(t)});const n=t.find(d=>Array.isArray(d)&&d[0]==="LENGTHUNIT");if(n){const d=this.convertUnit(n);e.coordinate_system.unit=d}e.id=this.getId(t);break;case"BASEGEOGCRS":case"GEOGCRS":e.type="GeographicCRS",e.name=t[1];const s=t.find(d=>Array.isArray(d)&&(d[0]==="DATUM"||d[0]==="ENSEMBLE"));if(s){const d=this.convert(s);s[0]==="ENSEMBLE"?e.datum_ensemble=d:e.datum=d;const g=t.find(f=>Array.isArray(f)&&f[0]==="PRIMEM");g&&g[1]!=="Greenwich"&&(d.prime_meridian={name:g[1],longitude:parseFloat(g[2])})}e.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(t)},e.id=this.getId(t);break;case"DATUM":e.type="GeodeticReferenceFrame",e.name=t[1],e.ellipsoid=t.find(d=>Array.isArray(d)&&d[0]==="ELLIPSOID")?this.convert(t.find(d=>Array.isArray(d)&&d[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":e.type="DatumEnsemble",e.name=t[1],e.members=t.filter(d=>Array.isArray(d)&&d[0]==="MEMBER").map(d=>({type:"DatumEnsembleMember",name:d[1],id:this.getId(d)}));const o=t.find(d=>Array.isArray(d)&&d[0]==="ENSEMBLEACCURACY");o&&(e.accuracy=parseFloat(o[1]));const a=t.find(d=>Array.isArray(d)&&d[0]==="ELLIPSOID");a&&(e.ellipsoid=this.convert(a)),e.id=this.getId(t);break;case"ELLIPSOID":e.type="Ellipsoid",e.name=t[1],e.semi_major_axis=parseFloat(t[2]),e.inverse_flattening=parseFloat(t[3]),t.find(d=>Array.isArray(d)&&d[0]==="LENGTHUNIT")&&this.convert(t.find(d=>Array.isArray(d)&&d[0]==="LENGTHUNIT"),e);break;case"CONVERSION":e.type="Conversion",e.name=t[1],e.method=t.find(d=>Array.isArray(d)&&d[0]==="METHOD")?this.convert(t.find(d=>Array.isArray(d)&&d[0]==="METHOD")):null,e.parameters=t.filter(d=>Array.isArray(d)&&d[0]==="PARAMETER").map(d=>this.convert(d));break;case"METHOD":e.type="Method",e.name=t[1],e.id=this.getId(t);break;case"PARAMETER":e.type="Parameter",e.name=t[1],e.value=parseFloat(t[2]),e.unit=this.convertUnit(t.find(d=>Array.isArray(d)&&(d[0]==="LENGTHUNIT"||d[0]==="ANGLEUNIT"||d[0]==="SCALEUNIT"))),e.id=this.getId(t);break;case"BOUNDCRS":e.type="BoundCRS";const l=t.find(d=>Array.isArray(d)&&d[0]==="SOURCECRS");if(l){const d=l.find(g=>Array.isArray(g));e.source_crs=d?this.convert(d):null}const c=t.find(d=>Array.isArray(d)&&d[0]==="TARGETCRS");if(c){const d=c.find(g=>Array.isArray(g));e.target_crs=d?this.convert(d):null}const h=t.find(d=>Array.isArray(d)&&d[0]==="ABRIDGEDTRANSFORMATION");h?e.transformation=this.convert(h):e.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(e.type="Transformation",e.name=t[1],e.method=t.find(d=>Array.isArray(d)&&d[0]==="METHOD")?this.convert(t.find(d=>Array.isArray(d)&&d[0]==="METHOD")):null,e.parameters=t.filter(d=>Array.isArray(d)&&(d[0]==="PARAMETER"||d[0]==="PARAMETERFILE")).map(d=>{if(d[0]==="PARAMETER")return this.convert(d);if(d[0]==="PARAMETERFILE")return{name:d[1],value:d[2],id:{authority:"EPSG",code:8656}}}),e.parameters.length===7){const d=e.parameters[6];d.name==="Scale difference"&&(d.value=Math.round((d.value-1)*1e12)/1e6)}e.id=this.getId(t);break;case"AXIS":e.coordinate_system||(e.coordinate_system={type:"unspecified",axis:[]}),e.coordinate_system.axis.push(this.convertAxis(t));break;case"LENGTHUNIT":const u=this.convertUnit(t,"LinearUnit");e.coordinate_system&&e.coordinate_system.axis&&e.coordinate_system.axis.forEach(d=>{d.unit||(d.unit=u)}),u.conversion_factor&&u.conversion_factor!==1&&e.semi_major_axis&&(e.semi_major_axis={value:e.semi_major_axis,unit:u});break;default:e.keyword=t[0];break}return e}},e9=class extends iI{static convert(t,e={}){return super.convert(t,e),e.coordinate_system&&e.coordinate_system.subtype==="Cartesian"&&delete e.coordinate_system,e.usage&&delete e.usage,e}},r9=class extends iI{static convert(t,e={}){super.convert(t,e);const i=t.find(s=>Array.isArray(s)&&s[0]==="CS");i&&(e.coordinate_system={subtype:i[1],axis:this.extractAxes(t)});const n=t.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(n){const s=n.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),o=n.find(l=>Array.isArray(l)&&l[0]==="AREA"),a=n.find(l=>Array.isArray(l)&&l[0]==="BBOX");e.usage={},s&&(e.usage.scope=s[1]),o&&(e.usage.area=o[1]),a&&(e.usage.bbox=a.slice(1))}return e}};function i9(r){return r.find(t=>Array.isArray(t)&&t[0]==="USAGE")?"2019":(r.find(t=>Array.isArray(t)&&t[0]==="CS")||r[0]==="BOUNDCRS"||r[0]==="PROJCRS"||r[0],"2015")}function n9(r){return(i9(r)==="2019"?r9:e9).convert(r)}function s9(r){const t=r.toUpperCase();return t.includes("PROJCRS")||t.includes("GEOGCRS")||t.includes("BOUNDCRS")||t.includes("VERTCRS")||t.includes("LENGTHUNIT")||t.includes("ANGLEUNIT")||t.includes("SCALEUNIT")?"WKT2":(t.includes("PROJCS")||t.includes("GEOGCS")||t.includes("LOCAL_CS")||t.includes("VERT_CS")||t.includes("UNIT"),"WKT1")}var Hg=1,nI=2,sI=3,rm=4,oI=5,Ab=-1,o9=/\s/,a9=/[A-Za-z]/,l9=/[A-Za-z84_]/,F1=/[,\]]/,aI=/[\d\.E\-\+]/;function ma(r){if(typeof r!="string")throw new Error("not a string");this.text=r.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Hg}ma.prototype.readCharicter=function(){var r=this.text[this.place++];if(this.state!==rm)for(;o9.test(r);){if(this.place>=this.text.length)return;r=this.text[this.place++]}switch(this.state){case Hg:return this.neutral(r);case nI:return this.keyword(r);case rm:return this.quoted(r);case oI:return this.afterquote(r);case sI:return this.number(r);case Ab:return}};ma.prototype.afterquote=function(r){if(r==='"'){this.word+='"',this.state=rm;return}if(F1.test(r)){this.word=this.word.trim(),this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in afterquote yet, index '+this.place)};ma.prototype.afterItem=function(r){if(r===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Hg;return}if(r==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Hg,this.currentObject=this.stack.pop(),this.currentObject||(this.state=Ab);return}};ma.prototype.number=function(r){if(aI.test(r)){this.word+=r;return}if(F1.test(r)){this.word=parseFloat(this.word),this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in number yet, index '+this.place)};ma.prototype.quoted=function(r){if(r==='"'){this.state=oI;return}this.word+=r};ma.prototype.keyword=function(r){if(l9.test(r)){this.word+=r;return}if(r==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=Hg;return}if(F1.test(r)){this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in keyword yet, index '+this.place)};ma.prototype.neutral=function(r){if(a9.test(r)){this.word=r,this.state=nI;return}if(r==='"'){this.word="",this.state=rm;return}if(aI.test(r)){this.word=r,this.state=sI;return}if(F1.test(r)){this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in neutral yet, index '+this.place)};ma.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===Ab)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function c9(r){var t=new ma(r);return t.output()}function S_(r,t,e){Array.isArray(t)&&(e.unshift(t),t=null);var i=t?{}:r,n=e.reduce(function(s,o){return Wh(o,s),s},i);t&&(r[t]=n)}function Wh(r,t){if(!Array.isArray(r)){t[r]=!0;return}var e=r.shift();if(e==="PARAMETER"&&(e=r.shift()),r.length===1){if(Array.isArray(r[0])){t[e]={},Wh(r[0],t[e]);return}t[e]=r[0];return}if(!r.length){t[e]=!0;return}if(e==="TOWGS84"){t[e]=r;return}if(e==="AXIS"){e in t||(t[e]=[]),t[e].push(r);return}Array.isArray(e)||(t[e]={});var i;switch(e){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[e]={name:r[0].toLowerCase(),convert:r[1]},r.length===3&&Wh(r[2],t[e]);return;case"SPHEROID":case"ELLIPSOID":t[e]={name:r[0],a:r[1],rf:r[2]},r.length===4&&Wh(r[3],t[e]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":r[0]=["name",r[0]],S_(t,e,r);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":r[0]=["name",r[0]],S_(t,e,r),t[e].type=e;return;default:for(i=-1;++i<r.length;)if(!Array.isArray(r[i]))return Wh(r,t[e]);return S_(t,e,r)}}var h9=.017453292519943295;function xs(r){return r*h9}function lI(r){const t=(r.projName||"").toLowerCase().replace(/_/g," ");!r.long0&&r.longc&&(t==="albers conic equal area"||t==="lambert azimuthal equal area")&&(r.long0=r.longc),!r.lat_ts&&r.lat1&&(t==="stereographic south pole"||t==="polar stereographic (variant b)")?(r.lat0=xs(r.lat1>0?90:-90),r.lat_ts=r.lat1,delete r.lat1):!r.lat_ts&&r.lat0&&(t==="polar stereographic"||t==="polar stereographic (variant a)")&&(r.lat_ts=r.lat0,r.lat0=xs(r.lat0>0?90:-90),delete r.lat1)}function lC(r){let t={units:null,to_meter:void 0};return typeof r=="string"?(t.units=r.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.units==="meter"&&(t.to_meter=1)):r&&r.name&&(t.units=r.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.to_meter=r.conversion_factor),t}function cC(r){return typeof r=="object"?r.value*r.unit.conversion_factor:r}function hC(r,t){r.ellipsoid.radius?(t.a=r.ellipsoid.radius,t.rf=0):(t.a=cC(r.ellipsoid.semi_major_axis),r.ellipsoid.inverse_flattening!==void 0?t.rf=r.ellipsoid.inverse_flattening:r.ellipsoid.semi_major_axis!==void 0&&r.ellipsoid.semi_minor_axis!==void 0&&(t.rf=t.a/(t.a-cC(r.ellipsoid.semi_minor_axis))))}function im(r,t={}){return!r||typeof r!="object"?r:r.type==="BoundCRS"?(im(r.source_crs,t),r.transformation&&(r.transformation.method&&r.transformation.method.name==="NTv2"?t.nadgrids=r.transformation.parameters[0].value:t.datum_params=r.transformation.parameters.map(e=>e.value)),t):(Object.keys(r).forEach(e=>{const i=r[e];if(i!==null)switch(e){case"name":if(t.srsCode)break;t.name=i,t.srsCode=i;break;case"type":i==="GeographicCRS"?t.projName="longlat":i==="ProjectedCRS"&&r.conversion&&r.conversion.method&&(t.projName=r.conversion.method.name);break;case"datum":case"datum_ensemble":i.ellipsoid&&(t.ellps=i.ellipsoid.name,hC(i,t)),i.prime_meridian&&(t.from_greenwich=i.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":t.ellps=i.name,hC(i,t);break;case"prime_meridian":t.long0=(i.longitude||0)*Math.PI/180;break;case"coordinate_system":if(i.axis){if(t.axis=i.axis.map(n=>{const s=n.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",i.unit){const{units:n,to_meter:s}=lC(i.unit);t.units=n,t.to_meter=s}else if(i.axis[0]&&i.axis[0].unit){const{units:n,to_meter:s}=lC(i.axis[0].unit);t.units=n,t.to_meter=s}}break;case"id":i.authority&&i.code&&(t.title=i.authority+":"+i.code);break;case"conversion":i.method&&i.method.name&&(t.projName=i.method.name),i.parameters&&i.parameters.forEach(n=>{const s=n.name.toLowerCase().replace(/\s+/g,"_"),o=n.value;n.unit&&n.unit.conversion_factor?t[s]=o*n.unit.conversion_factor:n.unit==="degree"?t[s]=o*Math.PI/180:t[s]=o});break;case"unit":i.name&&(t.units=i.name.toLowerCase(),t.units==="metre"&&(t.units="meter")),i.conversion_factor&&(t.to_meter=i.conversion_factor);break;case"base_crs":im(i,t),t.datumCode=i.id?i.id.authority+"_"+i.id.code:i.name;break}}),t.latitude_of_false_origin!==void 0&&(t.lat0=t.latitude_of_false_origin),t.longitude_of_false_origin!==void 0&&(t.long0=t.longitude_of_false_origin),t.latitude_of_standard_parallel!==void 0&&(t.lat0=t.latitude_of_standard_parallel,t.lat1=t.latitude_of_standard_parallel),t.latitude_of_1st_standard_parallel!==void 0&&(t.lat1=t.latitude_of_1st_standard_parallel),t.latitude_of_2nd_standard_parallel!==void 0&&(t.lat2=t.latitude_of_2nd_standard_parallel),t.latitude_of_projection_centre!==void 0&&(t.lat0=t.latitude_of_projection_centre),t.longitude_of_projection_centre!==void 0&&(t.longc=t.longitude_of_projection_centre),t.easting_at_false_origin!==void 0&&(t.x0=t.easting_at_false_origin),t.northing_at_false_origin!==void 0&&(t.y0=t.northing_at_false_origin),t.latitude_of_natural_origin!==void 0&&(t.lat0=t.latitude_of_natural_origin),t.longitude_of_natural_origin!==void 0&&(t.long0=t.longitude_of_natural_origin),t.longitude_of_origin!==void 0&&(t.long0=t.longitude_of_origin),t.false_easting!==void 0&&(t.x0=t.false_easting),t.easting_at_projection_centre&&(t.x0=t.easting_at_projection_centre),t.false_northing!==void 0&&(t.y0=t.false_northing),t.northing_at_projection_centre&&(t.y0=t.northing_at_projection_centre),t.standard_parallel_1!==void 0&&(t.lat1=t.standard_parallel_1),t.standard_parallel_2!==void 0&&(t.lat2=t.standard_parallel_2),t.scale_factor_at_natural_origin!==void 0&&(t.k0=t.scale_factor_at_natural_origin),t.scale_factor_at_projection_centre!==void 0&&(t.k0=t.scale_factor_at_projection_centre),t.scale_factor_on_pseudo_standard_parallel!==void 0&&(t.k0=t.scale_factor_on_pseudo_standard_parallel),t.azimuth!==void 0&&(t.alpha=t.azimuth),t.azimuth_at_projection_centre!==void 0&&(t.alpha=t.azimuth_at_projection_centre),t.angle_from_rectified_to_skew_grid&&(t.rectified_grid_angle=t.angle_from_rectified_to_skew_grid),lI(t),t)}var u9=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function d9(r,t){var e=t[0],i=t[1];!(e in r)&&i in r&&(r[e]=r[i],t.length===3&&(r[e]=t[2](r[e])))}function cI(r){for(var t=Object.keys(r),e=0,i=t.length;e<i;++e){var n=t[e];u9.indexOf(n)!==-1&&g9(r[n]),typeof r[n]=="object"&&cI(r[n])}}function g9(r){if(r.AUTHORITY){var t=Object.keys(r.AUTHORITY)[0];t&&t in r.AUTHORITY&&(r.title=t+":"+r.AUTHORITY[t])}if(r.type==="GEOGCS"?r.projName="longlat":r.type==="LOCAL_CS"?(r.projName="identity",r.local=!0):typeof r.PROJECTION=="object"?r.projName=Object.keys(r.PROJECTION)[0]:r.projName=r.PROJECTION,r.AXIS){for(var e="",i=0,n=r.AXIS.length;i<n;++i){var s=[r.AXIS[i][0].toLowerCase(),r.AXIS[i][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?e+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?e+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?e+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(e+="w")}e.length===2&&(e+="u"),e.length===3&&(r.axis=e)}r.UNIT&&(r.units=r.UNIT.name.toLowerCase(),r.units==="metre"&&(r.units="meter"),r.UNIT.convert&&(r.type==="GEOGCS"?r.DATUM&&r.DATUM.SPHEROID&&(r.to_meter=r.UNIT.convert*r.DATUM.SPHEROID.a):r.to_meter=r.UNIT.convert));var o=r.GEOGCS;r.type==="GEOGCS"&&(o=r),o&&(o.DATUM?r.datumCode=o.DATUM.name.toLowerCase():r.datumCode=o.name.toLowerCase(),r.datumCode.slice(0,2)==="d_"&&(r.datumCode=r.datumCode.slice(2)),r.datumCode==="new_zealand_1949"&&(r.datumCode="nzgd49"),(r.datumCode==="wgs_1984"||r.datumCode==="world_geodetic_system_1984")&&(r.PROJECTION==="Mercator_Auxiliary_Sphere"&&(r.sphere=!0),r.datumCode="wgs84"),r.datumCode==="belge_1972"&&(r.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(r.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),r.ellps.toLowerCase().slice(0,13)==="international"&&(r.ellps="intl"),r.a=o.DATUM.SPHEROID.a,r.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(r.datum_params=o.DATUM.TOWGS84),~r.datumCode.indexOf("osgb_1936")&&(r.datumCode="osgb36"),~r.datumCode.indexOf("osni_1952")&&(r.datumCode="osni52"),(~r.datumCode.indexOf("tm65")||~r.datumCode.indexOf("geodetic_datum_of_1965"))&&(r.datumCode="ire65"),r.datumCode==="ch1903+"&&(r.datumCode="ch1903"),~r.datumCode.indexOf("israel")&&(r.datumCode="isr93")),r.b&&!isFinite(r.b)&&(r.b=r.a),r.rectified_grid_angle&&(r.rectified_grid_angle=xs(r.rectified_grid_angle));function a(h){var u=r.to_meter||1;return h*u}var l=function(h){return d9(r,h)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",xs],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",xs],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",xs],["lat0","latitude_of_origin",xs],["lat0","standard_parallel_1",xs],["lat1","standard_parallel_1",xs],["lat2","standard_parallel_2",xs],["azimuth","Azimuth"],["alpha","azimuth",xs],["srsCode","name"]];c.forEach(l),lI(r)}function nm(r){if(typeof r=="object")return im(r);const t=s9(r);var e=c9(r);if(t==="WKT2"){const s=n9(e);return im(s)}var i=e[0],n={};return Wh(e,n),cI(n),n[i]}function Si(r){var t=this;if(arguments.length===2){var e=arguments[1];typeof e=="string"?e.charAt(0)==="+"?Si[r]=Bx(arguments[1]):Si[r]=nm(arguments[1]):e&&typeof e=="object"&&!("projName"in e)?Si[r]=nm(arguments[1]):(Si[r]=e,e||delete Si[r])}else if(arguments.length===1){if(Array.isArray(r))return r.map(function(i){return Array.isArray(i)?Si.apply(t,i):Si(i)});if(typeof r=="string"){if(r in Si)return Si[r]}else"EPSG"in r?Si["EPSG:"+r.EPSG]=r:"ESRI"in r?Si["ESRI:"+r.ESRI]=r:"IAU2000"in r?Si["IAU2000:"+r.IAU2000]=r:console.log(r);return}}HG(Si);function f9(r){return typeof r=="string"}function p9(r){return r in Si}function m9(r){return r.indexOf("+")!==0&&r.indexOf("[")!==-1||typeof r=="object"&&!("srsCode"in r)}var y9=["3857","900913","3785","102113"];function _9(r){var t=wl(r,"authority");if(t){var e=wl(t,"epsg");return e&&y9.indexOf(e)>-1}}function v9(r){var t=wl(r,"extension");if(t)return wl(t,"proj4")}function x9(r){return r[0]==="+"}function w9(r){if(f9(r)){if(p9(r))return Si[r];if(m9(r)){var t=nm(r);if(_9(t))return Si["EPSG:3857"];var e=v9(t);return e?Bx(e):t}if(x9(r))return Bx(r)}else return"projName"in r?r:nm(r)}function uC(r,t){r=r||{};var e,i;if(!t)return r;for(i in t)e=t[i],e!==void 0&&(r[i]=e);return r}function wo(r,t,e){var i=r*t;return e/Math.sqrt(1-i*i)}function jf(r){return r<0?-1:1}function xt(r,t){return t||Math.abs(r)<=Wr?r:r-jf(r)*Zg}function Ls(r,t,e){var i=r*e,n=.5*r;return i=Math.pow((1-i)/(1+i),n),Math.tan(.5*(st-t))/i}function Yg(r,t){for(var e=.5*r,i,n,s=st-2*Math.atan(t),o=0;o<=15;o++)if(i=r*Math.sin(s),n=st-2*Math.atan(t*Math.pow((1-i)/(1+i),e))-s,s+=n,Math.abs(n)<=1e-10)return s;return-9999}function b9(){var r=this.b/this.a;this.es=1-r*r,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=wo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function k9(r){var t=r.x,e=r.y;if(e*wn>90&&e*wn<-90&&t*wn>180&&t*wn<-180)return null;var i,n;if(Math.abs(Math.abs(e)-st)<=ft)return null;if(this.sphere)i=this.x0+this.a*this.k0*xt(t-this.long0,this.over),n=this.y0+this.a*this.k0*Math.log(Math.tan(He+.5*e));else{var s=Math.sin(e),o=Ls(this.e,e,s);i=this.x0+this.a*this.k0*xt(t-this.long0,this.over),n=this.y0-this.a*this.k0*Math.log(o)}return r.x=i,r.y=n,r}function E9(r){var t=r.x-this.x0,e=r.y-this.y0,i,n;if(this.sphere)n=st-2*Math.atan(Math.exp(-e/(this.a*this.k0)));else{var s=Math.exp(-e/(this.a*this.k0));if(n=Yg(this.e,s),n===-9999)return null}return i=xt(this.long0+t/(this.a*this.k0),this.over),r.x=i,r.y=n,r}var S9=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const T9={init:b9,forward:k9,inverse:E9,names:S9};function C9(){}function dC(r){return r}var hI=["longlat","identity"];const M9={init:C9,forward:dC,inverse:dC,names:hI};var R9=[T9,M9],Rh={},ig=[];function uI(r,t){var e=ig.length;return r.names?(ig[e]=r,r.names.forEach(function(i){Rh[i.toLowerCase()]=e}),this):(console.log(t),!0)}function dI(r){return r.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function I9(r){if(!r)return!1;var t=r.toLowerCase();if(typeof Rh[t]<"u"&&ig[Rh[t]]||(t=dI(t),t in Rh&&ig[Rh[t]]))return ig[Rh[t]]}function P9(){R9.forEach(uI)}const A9={start:P9,add:uI,get:I9};var gI={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const L9=gI.WGS84;function O9(r,t,e,i){var n=r*r,s=t*t,o=(n-s)/n,a=0;i?(r*=1-o*(KG+o*(QG+o*JG)),n=r*r,o=0):a=Math.sqrt(o);var l=(n-s)/s;return{es:o,e:a,ep2:l}}function F9(r,t,e,i,n){if(!r){var s=wl(gI,i);s||(s=L9),r=s.a,t=s.b,e=s.rf}return e&&!t&&(t=(1-1/e)*r),(e===0||Math.abs(r-t)<ft)&&(n=!0,t=r),{a:r,b:t,rf:e,sphere:n}}var v0={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var N9 in v0){var T_=v0[N9];T_.datumName&&(v0[T_.datumName]=T_)}function D9(r,t,e,i,n,s,o){var a={};return r===void 0||r==="none"?a.datum_type=qx:a.datum_type=YG,t&&(a.datum_params=t.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=Lc),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=Oc,a.datum_params[3]*=rg,a.datum_params[4]*=rg,a.datum_params[5]*=rg,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=ou,a.grids=o),a.a=e,a.b=i,a.es=n,a.ep2=s,a}var Lb={};function $9(r,t,e){return t instanceof ArrayBuffer?G9(r,t,e):{ready:j9(r,t)}}function G9(r,t,e){var i=!0;e!==void 0&&e.includeErrorFields===!1&&(i=!1);var n=new DataView(t),s=B9(n),o=U9(n,s),a=W9(n,o,s,i),l={header:o,subgrids:a};return Lb[r]=l,l}async function j9(r,t){for(var e=[],i=await t.getImageCount(),n=i-1;n>=0;n--){var s=await t.getImage(n),o=await s.readRasters(),a=o,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(gC),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(gC),u=c[0]+(l[0]-1)*h[0],d=c[3]-(l[1]-1)*h[1],g=a[0],f=a[1],p=[];for(let _=l[1]-1;_>=0;_--)for(let x=l[0]-1;x>=0;x--){var m=_*l[0]+x;p.push([-tl(f[m]),tl(g[m])])}e.push({del:h,lim:l,ll:[-u,d],cvs:p})}var y={header:{nSubgrids:i},subgrids:e};return Lb[r]=y,y}function z9(r){if(r===void 0)return null;var t=r.split(",");return t.map(q9)}function q9(r){if(r.length===0)return null;var t=r[0]==="@";return t&&(r=r.slice(1)),r==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:r,mandatory:!t,grid:Lb[r]||null,isNull:!1}}function gC(r){return r*Math.PI/180}function tl(r){return r/3600*Math.PI/180}function B9(r){var t=r.getInt32(8,!1);return t===11?!1:(t=r.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function U9(r,t){return{nFields:r.getInt32(8,t),nSubgridFields:r.getInt32(24,t),nSubgrids:r.getInt32(40,t),shiftType:Ux(r,56,64).trim(),fromSemiMajorAxis:r.getFloat64(120,t),fromSemiMinorAxis:r.getFloat64(136,t),toSemiMajorAxis:r.getFloat64(152,t),toSemiMinorAxis:r.getFloat64(168,t)}}function Ux(r,t,e){return String.fromCharCode.apply(null,new Uint8Array(r.buffer.slice(t,e)))}function W9(r,t,e,i){for(var n=176,s=[],o=0;o<t.nSubgrids;o++){var a=Z9(r,n,e),l=H9(r,n,a,e,i),c=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),h=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[tl(a.lowerLongitude),tl(a.lowerLatitude)],del:[tl(a.longitudeInterval),tl(a.latitudeInterval)],lim:[c,h],count:a.gridNodeCount,cvs:V9(l)});var u=16;i===!1&&(u=8),n+=176+a.gridNodeCount*u}return s}function V9(r){return r.map(function(t){return[tl(t.longitudeShift),tl(t.latitudeShift)]})}function Z9(r,t,e){return{name:Ux(r,t+8,t+16).trim(),parent:Ux(r,t+24,t+24+8).trim(),lowerLatitude:r.getFloat64(t+72,e),upperLatitude:r.getFloat64(t+88,e),lowerLongitude:r.getFloat64(t+104,e),upperLongitude:r.getFloat64(t+120,e),latitudeInterval:r.getFloat64(t+136,e),longitudeInterval:r.getFloat64(t+152,e),gridNodeCount:r.getInt32(t+168,e)}}function H9(r,t,e,i,n){var s=t+176,o=16;n===!1&&(o=8);for(var a=[],l=0;l<e.gridNodeCount;l++){var c={latitudeShift:r.getFloat32(s+l*o,i),longitudeShift:r.getFloat32(s+l*o+4,i)};n!==!1&&(c.latitudeAccuracy=r.getFloat32(s+l*o+8,i),c.longitudeAccuracy=r.getFloat32(s+l*o+12,i)),a.push(c)}return a}function os(r,t){if(!(this instanceof os))return new os(r);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,t=t||function(c){if(c)throw c};var e=w9(r);if(typeof e!="object"){t("Could not parse to valid json: "+r);return}var i=os.projections.get(e.projName);if(!i){t("Could not get projection name from: "+r);return}if(e.datumCode&&e.datumCode!=="none"){var n=wl(v0,e.datumCode);n&&(e.datum_params=e.datum_params||(n.towgs84?n.towgs84.split(","):null),e.ellps=n.ellipse,e.datumName=n.datumName?n.datumName:e.datumCode)}e.k0=e.k0||1,e.axis=e.axis||"enu",e.ellps=e.ellps||"wgs84",e.lat1=e.lat1||e.lat0;var s=F9(e.a,e.b,e.rf,e.ellps,e.sphere),o=O9(s.a,s.b,s.rf,e.R_A),a=z9(e.nadgrids),l=e.datum||D9(e.datumCode,e.datum_params,s.a,s.b,o.es,o.ep2,a);uC(this,e),uC(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),t(null,this)}os.projections=A9;os.projections.start();function Y9(r,t){return r.datum_type!==t.datum_type||r.a!==t.a||Math.abs(r.es-t.es)>5e-11?!1:r.datum_type===Lc?r.datum_params[0]===t.datum_params[0]&&r.datum_params[1]===t.datum_params[1]&&r.datum_params[2]===t.datum_params[2]:r.datum_type===Oc?r.datum_params[0]===t.datum_params[0]&&r.datum_params[1]===t.datum_params[1]&&r.datum_params[2]===t.datum_params[2]&&r.datum_params[3]===t.datum_params[3]&&r.datum_params[4]===t.datum_params[4]&&r.datum_params[5]===t.datum_params[5]&&r.datum_params[6]===t.datum_params[6]:!0}function fI(r,t,e){var i=r.x,n=r.y,s=r.z?r.z:0,o,a,l,c;if(n<-st&&n>-1.001*st)n=-st;else if(n>st&&n<1.001*st)n=st;else{if(n<-st)return{x:-1/0,y:-1/0,z:r.z};if(n>st)return{x:1/0,y:1/0,z:r.z}}return i>Math.PI&&(i-=2*Math.PI),a=Math.sin(n),c=Math.cos(n),l=a*a,o=e/Math.sqrt(1-t*l),{x:(o+s)*c*Math.cos(i),y:(o+s)*c*Math.sin(i),z:(o*(1-t)+s)*a}}function pI(r,t,e,i){var n=1e-12,s=n*n,o=30,a,l,c,h,u,d,g,f,p,m,y,_,x,v=r.x,w=r.y,b=r.z?r.z:0,E,C,S;if(a=Math.sqrt(v*v+w*w),l=Math.sqrt(v*v+w*w+b*b),a/e<n){if(E=0,l/e<n)return C=st,S=-i,{x:r.x,y:r.y,z:r.z}}else E=Math.atan2(w,v);c=b/l,h=a/l,u=1/Math.sqrt(1-t*(2-t)*h*h),f=h*(1-t)*u,p=c*u,x=0;do x++,g=e/Math.sqrt(1-t*p*p),S=a*f+b*p-g*(1-t*p*p),d=t*g/(g+S),u=1/Math.sqrt(1-d*(2-d)*h*h),m=h*(1-d)*u,y=c*u,_=y*f-m*p,f=m,p=y;while(_*_>s&&x<o);return C=Math.atan(y/Math.abs(m)),{x:E,y:C,z:S}}function X9(r,t,e){if(t===Lc)return{x:r.x+e[0],y:r.y+e[1],z:r.z+e[2]};if(t===Oc){var i=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6];return{x:c*(r.x-l*r.y+a*r.z)+i,y:c*(l*r.x+r.y-o*r.z)+n,z:c*(-a*r.x+o*r.y+r.z)+s}}}function K9(r,t,e){if(t===Lc)return{x:r.x-e[0],y:r.y-e[1],z:r.z-e[2]};if(t===Oc){var i=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],h=(r.x-i)/c,u=(r.y-n)/c,d=(r.z-s)/c;return{x:h+l*u-a*d,y:-l*h+u+o*d,z:a*h-o*u+d}}}function Tp(r){return r===Lc||r===Oc}function Q9(r,t,e){if(Y9(r,t)||r.datum_type===qx||t.datum_type===qx)return e;var i=r.a,n=r.es;if(r.datum_type===ou){var s=fC(r,!1,e);if(s!==0)return;i=sC,n=oC}var o=t.a,a=t.b,l=t.es;if(t.datum_type===ou&&(o=sC,a=XG,l=oC),n===l&&i===o&&!Tp(r.datum_type)&&!Tp(t.datum_type))return e;if(e=fI(e,n,i),Tp(r.datum_type)&&(e=X9(e,r.datum_type,r.datum_params)),Tp(t.datum_type)&&(e=K9(e,t.datum_type,t.datum_params)),e=pI(e,l,o,a),t.datum_type===ou){var c=fC(t,!0,e);if(c!==0)return}return e}function fC(r,t,e){if(r.grids===null||r.grids.length===0)return console.log("Grid shift grids not found"),-1;var i={x:-e.x,y:e.y},n={x:Number.NaN,y:Number.NaN},s=[];t:for(var o=0;o<r.grids.length;o++){var a=r.grids[o];if(s.push(a.name),a.isNull){n=i;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var l=a.grid.subgrids,c=0,h=l.length;c<h;c++){var u=l[c],d=(Math.abs(u.del[1])+Math.abs(u.del[0]))/1e4,g=u.ll[0]-d,f=u.ll[1]-d,p=u.ll[0]+(u.lim[0]-1)*u.del[0]+d,m=u.ll[1]+(u.lim[1]-1)*u.del[1]+d;if(!(f>i.y||g>i.x||m<i.y||p<i.x)&&(n=J9(i,t,u),!isNaN(n.x)))break t}}return isNaN(n.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*wn+" "+i.y*wn+" tried: '"+s+"'"),-1):(e.x=-n.x,e.y=n.y,0)}function J9(r,t,e){var i={x:Number.NaN,y:Number.NaN};if(isNaN(r.x))return i;var n={x:r.x,y:r.y};n.x-=e.ll[0],n.y-=e.ll[1],n.x=xt(n.x-Math.PI)+Math.PI;var s=pC(n,e);if(t){if(isNaN(s.x))return i;s.x=n.x-s.x,s.y=n.y-s.y;var o=9,a=1e-12,l,c;do{if(c=pC(s,e),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:n.x-(c.x+s.x),y:n.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(o--&&Math.abs(l.x)>a&&Math.abs(l.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=xt(s.x+e.ll[0]),i.y=s.y+e.ll[1]}else isNaN(s.x)||(i.x=r.x+s.x,i.y=r.y+s.y);return i}function pC(r,t){var e={x:r.x/t.del[0],y:r.y/t.del[1]},i={x:Math.floor(e.x),y:Math.floor(e.y)},n={x:e.x-1*i.x,y:e.y-1*i.y},s={x:Number.NaN,y:Number.NaN},o;if(i.x<0||i.x>=t.lim[0]||i.y<0||i.y>=t.lim[1])return s;o=i.y*t.lim[0]+i.x;var a={x:t.cvs[o][0],y:t.cvs[o][1]};o++;var l={x:t.cvs[o][0],y:t.cvs[o][1]};o+=t.lim[0];var c={x:t.cvs[o][0],y:t.cvs[o][1]};o--;var h={x:t.cvs[o][0],y:t.cvs[o][1]},u=n.x*n.y,d=n.x*(1-n.y),g=(1-n.x)*(1-n.y),f=(1-n.x)*n.y;return s.x=g*a.x+d*l.x+f*h.x+u*c.x,s.y=g*a.y+d*l.y+f*h.y+u*c.y,s}function mC(r,t,e){var i=e.x,n=e.y,s=e.z||0,o,a,l,c={};for(l=0;l<3;l++)if(!(t&&l===2&&e.z===void 0))switch(l===0?(o=i,"ew".indexOf(r.axis[l])!==-1?a="x":a="y"):l===1?(o=n,"ns".indexOf(r.axis[l])!==-1?a="y":a="x"):(o=s,a="z"),r.axis[l]){case"e":c[a]=o;break;case"w":c[a]=-o;break;case"n":c[a]=o;break;case"s":c[a]=-o;break;case"u":e[a]!==void 0&&(c.z=o);break;case"d":e[a]!==void 0&&(c.z=-o);break;default:return null}return c}function mI(r){var t={x:r[0],y:r[1]};return r.length>2&&(t.z=r[2]),r.length>3&&(t.m=r[3]),t}function tj(r){yC(r.x),yC(r.y)}function yC(r){if(typeof Number.isFinite=="function"){if(Number.isFinite(r))return;throw new TypeError("coordinates must be finite numbers")}if(typeof r!="number"||r!==r||!isFinite(r))throw new TypeError("coordinates must be finite numbers")}function ej(r,t){return(r.datum.datum_type===Lc||r.datum.datum_type===Oc||r.datum.datum_type===ou)&&t.datumCode!=="WGS84"||(t.datum.datum_type===Lc||t.datum.datum_type===Oc||t.datum.datum_type===ou)&&r.datumCode!=="WGS84"}function sm(r,t,e,i){var n;Array.isArray(e)?e=mI(e):e={x:e.x,y:e.y,z:e.z,m:e.m};var s=e.z!==void 0;if(tj(e),r.datum&&t.datum&&ej(r,t)&&(n=new os("WGS84"),e=sm(r,n,e,i),r=n),i&&r.axis!=="enu"&&(e=mC(r,!1,e)),r.projName==="longlat")e={x:e.x*$r,y:e.y*$r,z:e.z||0};else if(r.to_meter&&(e={x:e.x*r.to_meter,y:e.y*r.to_meter,z:e.z||0}),e=r.inverse(e),!e)return;if(r.from_greenwich&&(e.x+=r.from_greenwich),e=Q9(r.datum,t.datum,e),!!e)return e=e,t.from_greenwich&&(e={x:e.x-t.from_greenwich,y:e.y,z:e.z||0}),t.projName==="longlat"?e={x:e.x*wn,y:e.y*wn,z:e.z||0}:(e=t.forward(e),t.to_meter&&(e={x:e.x/t.to_meter,y:e.y/t.to_meter,z:e.z||0})),i&&t.axis!=="enu"?mC(t,!0,e):(e&&!s&&delete e.z,e)}var _C=os("WGS84");function C_(r,t,e,i){var n,s,o;return Array.isArray(e)?(n=sm(r,t,e,i)||{x:NaN,y:NaN},e.length>2?typeof r.name<"u"&&r.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof n.z=="number"?[n.x,n.y,n.z].concat(e.slice(3)):[n.x,n.y,e[2]].concat(e.slice(3)):[n.x,n.y].concat(e.slice(2)):[n.x,n.y]):(s=sm(r,t,e,i),o=Object.keys(e),o.length===2||o.forEach(function(a){if(typeof r.name<"u"&&r.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=e[a]}),s)}function Cp(r){return r instanceof os?r:typeof r=="object"&&"oProj"in r?r.oProj:os(r)}function rj(r,t,e){var i,n,s=!1,o;return typeof t>"u"?(n=Cp(r),i=_C,s=!0):(typeof t.x<"u"||Array.isArray(t))&&(e=t,n=Cp(r),i=_C,s=!0),i||(i=Cp(r)),n||(n=Cp(t)),e?C_(i,n,e):(o={forward:function(a,l){return C_(i,n,a,l)},inverse:function(a,l){return C_(n,i,a,l)}},s&&(o.oProj=n),o)}var vC=6,yI="AJSAJS",_I="AFAFAF",Vh=65,ln=73,Zn=79,$d=86,Gd=90;const ij={forward:vI,inverse:nj,toPoint:xI};function vI(r,t){return t=t||5,aj(sj({lat:r[1],lon:r[0]}),t)}function nj(r){var t=Ob(bI(r.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function xI(r){var t=Ob(bI(r.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function M_(r){return r*(Math.PI/180)}function xC(r){return 180*(r/Math.PI)}function sj(r){var t=r.lat,e=r.lon,i=6378137,n=.00669438,s=.9996,o,a,l,c,h,u,d,g=M_(t),f=M_(e),p,m;m=Math.floor((e+180)/6)+1,e===180&&(m=60),t>=56&&t<64&&e>=3&&e<12&&(m=32),t>=72&&t<84&&(e>=0&&e<9?m=31:e>=9&&e<21?m=33:e>=21&&e<33?m=35:e>=33&&e<42&&(m=37)),o=(m-1)*6-180+3,p=M_(o),a=n/(1-n),l=i/Math.sqrt(1-n*Math.sin(g)*Math.sin(g)),c=Math.tan(g)*Math.tan(g),h=a*Math.cos(g)*Math.cos(g),u=Math.cos(g)*(f-p),d=i*((1-n/4-3*n*n/64-5*n*n*n/256)*g-(3*n/8+3*n*n/32+45*n*n*n/1024)*Math.sin(2*g)+(15*n*n/256+45*n*n*n/1024)*Math.sin(4*g)-35*n*n*n/3072*Math.sin(6*g));var y=s*l*(u+(1-c+h)*u*u*u/6+(5-18*c+c*c+72*h-58*a)*u*u*u*u*u/120)+5e5,_=s*(d+l*Math.tan(g)*(u*u/2+(5-c+9*h+4*h*h)*u*u*u*u/24+(61-58*c+c*c+600*h-330*a)*u*u*u*u*u*u/720));return t<0&&(_+=1e7),{northing:Math.round(_),easting:Math.round(y),zoneNumber:m,zoneLetter:oj(t)}}function Ob(r){var t=r.northing,e=r.easting,i=r.zoneLetter,n=r.zoneNumber;if(n<0||n>60)return null;var s=.9996,o=6378137,a=.00669438,l,c=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),h,u,d,g,f,p,m,y,_,x=e-5e5,v=t;i<"N"&&(v-=1e7),m=(n-1)*6-180+3,l=a/(1-a),p=v/s,y=p/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),_=y+(3*c/2-27*c*c*c/32)*Math.sin(2*y)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*y)+151*c*c*c/96*Math.sin(6*y),h=o/Math.sqrt(1-a*Math.sin(_)*Math.sin(_)),u=Math.tan(_)*Math.tan(_),d=l*Math.cos(_)*Math.cos(_),g=o*(1-a)/Math.pow(1-a*Math.sin(_)*Math.sin(_),1.5),f=x/(h*s);var w=_-h*Math.tan(_)/g*(f*f/2-(5+3*u+10*d-4*d*d-9*l)*f*f*f*f/24+(61+90*u+298*d+45*u*u-252*l-3*d*d)*f*f*f*f*f*f/720);w=xC(w);var b=(f-(1+2*u+d)*f*f*f/6+(5-2*d+28*u-3*d*d+8*l+24*u*u)*f*f*f*f*f/120)/Math.cos(_);b=m+xC(b);var E;if(r.accuracy){var C=Ob({northing:r.northing+r.accuracy,easting:r.easting+r.accuracy,zoneLetter:r.zoneLetter,zoneNumber:r.zoneNumber});E={top:C.lat,right:C.lon,bottom:w,left:b}}else E={lat:w,lon:b};return E}function oj(r){var t="Z";return 84>=r&&r>=72?t="X":72>r&&r>=64?t="W":64>r&&r>=56?t="V":56>r&&r>=48?t="U":48>r&&r>=40?t="T":40>r&&r>=32?t="S":32>r&&r>=24?t="R":24>r&&r>=16?t="Q":16>r&&r>=8?t="P":8>r&&r>=0?t="N":0>r&&r>=-8?t="M":-8>r&&r>=-16?t="L":-16>r&&r>=-24?t="K":-24>r&&r>=-32?t="J":-32>r&&r>=-40?t="H":-40>r&&r>=-48?t="G":-48>r&&r>=-56?t="F":-56>r&&r>=-64?t="E":-64>r&&r>=-72?t="D":-72>r&&r>=-80&&(t="C"),t}function aj(r,t){var e="00000"+r.easting,i="00000"+r.northing;return r.zoneNumber+r.zoneLetter+lj(r.easting,r.northing,r.zoneNumber)+e.substr(e.length-5,t)+i.substr(i.length-5,t)}function lj(r,t,e){var i=wI(e),n=Math.floor(r/1e5),s=Math.floor(t/1e5)%20;return cj(n,s,i)}function wI(r){var t=r%vC;return t===0&&(t=vC),t}function cj(r,t,e){var i=e-1,n=yI.charCodeAt(i),s=_I.charCodeAt(i),o=n+r-1,a=s+t,l=!1;o>Gd&&(o=o-Gd+Vh-1,l=!0),(o===ln||n<ln&&o>ln||(o>ln||n<ln)&&l)&&o++,(o===Zn||n<Zn&&o>Zn||(o>Zn||n<Zn)&&l)&&(o++,o===ln&&o++),o>Gd&&(o=o-Gd+Vh-1),a>$d?(a=a-$d+Vh-1,l=!0):l=!1,(a===ln||s<ln&&a>ln||(a>ln||s<ln)&&l)&&a++,(a===Zn||s<Zn&&a>Zn||(a>Zn||s<Zn)&&l)&&(a++,a===ln&&a++),a>$d&&(a=a-$d+Vh-1);var c=String.fromCharCode(o)+String.fromCharCode(a);return c}function bI(r){if(r&&r.length===0)throw"MGRSPoint coverting from nothing";for(var t=r.length,e=null,i="",n,s=0;!/[A-Z]/.test(n=r.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+r;i+=n,s++}var o=parseInt(i,10);if(s===0||s+3>t)throw"MGRSPoint bad conversion from: "+r;var a=r.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+r;e=r.substring(s,s+=2);for(var l=wI(o),c=hj(e.charAt(0),l),h=uj(e.charAt(1),l);h<dj(a);)h+=2e6;var u=t-s;if(u%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+r;var d=u/2,g=0,f=0,p,m,y,_,x;return d>0&&(p=1e5/Math.pow(10,d),m=r.substring(s,s+d),g=parseFloat(m)*p,y=r.substring(s+d),f=parseFloat(y)*p),_=g+c,x=f+h,{easting:_,northing:x,zoneLetter:a,zoneNumber:o,accuracy:p}}function hj(r,t){for(var e=yI.charCodeAt(t-1),i=1e5,n=!1;e!==r.charCodeAt(0);){if(e++,e===ln&&e++,e===Zn&&e++,e>Gd){if(n)throw"Bad character: "+r;e=Vh,n=!0}i+=1e5}return i}function uj(r,t){if(r>"V")throw"MGRSPoint given invalid Northing "+r;for(var e=_I.charCodeAt(t-1),i=0,n=!1;e!==r.charCodeAt(0);){if(e++,e===ln&&e++,e===Zn&&e++,e>$d){if(n)throw"Bad character: "+r;e=Vh,n=!0}i+=1e5}return i}function dj(r){var t;switch(r){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+r}function Ou(r,t,e){if(!(this instanceof Ou))return new Ou(r,t,e);if(Array.isArray(r))this.x=r[0],this.y=r[1],this.z=r[2]||0;else if(typeof r=="object")this.x=r.x,this.y=r.y,this.z=r.z||0;else if(typeof r=="string"&&typeof t>"u"){var i=r.split(",");this.x=parseFloat(i[0]),this.y=parseFloat(i[1]),this.z=parseFloat(i[2])||0}else this.x=r,this.y=t,this.z=e||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Ou.fromMGRS=function(r){return new Ou(xI(r))};Ou.prototype.toMGRS=function(r){return vI([this.x,this.y],r)};var gj=1,fj=.25,wC=.046875,bC=.01953125,kC=.01068115234375,pj=.75,mj=.46875,yj=.013020833333333334,_j=.007120768229166667,vj=.3645833333333333,xj=.005696614583333333,wj=.3076171875;function Fb(r){var t=[];t[0]=gj-r*(fj+r*(wC+r*(bC+r*kC))),t[1]=r*(pj-r*(wC+r*(bC+r*kC)));var e=r*r;return t[2]=e*(mj-r*(yj+r*_j)),e*=r,t[3]=e*(vj-r*xj),t[4]=e*r*wj,t}function Ku(r,t,e,i){return e*=t,t*=t,i[0]*r-e*(i[1]+t*(i[2]+t*(i[3]+t*i[4])))}var bj=20;function Nb(r,t,e){for(var i=1/(1-t),n=r,s=bj;s;--s){var o=Math.sin(n),a=1-t*o*o;if(a=(Ku(n,o,Math.cos(n),e)-r)*(a*Math.sqrt(a))*i,n-=a,Math.abs(a)<ft)return n}return n}function kj(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=Fb(this.es),this.ml0=Ku(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Ej(r){var t=r.x,e=r.y,i=xt(t-this.long0,this.over),n,s,o,a=Math.sin(e),l=Math.cos(e);if(this.es){var c=l*i,h=Math.pow(c,2),u=this.ep2*Math.pow(l,2),d=Math.pow(u,2),g=Math.abs(l)>ft?Math.tan(e):0,f=Math.pow(g,2),p=Math.pow(f,2);n=1-this.es*Math.pow(a,2),c=c/Math.sqrt(n);var m=Ku(e,a,l,this.en);s=this.a*(this.k0*c*(1+h/6*(1-f+u+h/20*(5-18*f+p+14*u-58*f*u+h/42*(61+179*p-p*f-479*f)))))+this.x0,o=this.a*(this.k0*(m-this.ml0+a*i*c/2*(1+h/12*(5-f+9*u+4*d+h/30*(61+p-58*f+270*u-330*f*u+h/56*(1385+543*p-p*f-3111*f))))))+this.y0}else{var y=l*Math.sin(i);if(Math.abs(Math.abs(y)-1)<ft)return 93;if(s=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,o=l*Math.cos(i)/Math.sqrt(1-Math.pow(y,2)),y=Math.abs(o),y>=1){if(y-1>ft)return 93;o=0}else o=Math.acos(o);e<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return r.x=s,r.y=o,r}function Sj(r){var t,e,i,n,s=(r.x-this.x0)*(1/this.a),o=(r.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+o/this.k0,e=Nb(t,this.es,this.en),Math.abs(e)<st){var a=Math.sin(e),l=Math.cos(e),c=Math.abs(l)>ft?Math.tan(e):0,h=this.ep2*Math.pow(l,2),u=Math.pow(h,2),d=Math.pow(c,2),g=Math.pow(d,2);t=1-this.es*Math.pow(a,2);var f=s*Math.sqrt(t)/this.k0,p=Math.pow(f,2);t=t*c,i=e-t*p/(1-this.es)*.5*(1-p/12*(5+3*d-9*h*d+h-4*u-p/30*(61+90*d-252*h*d+45*g+46*h-p/56*(1385+3633*d+4095*g+1574*g*d)))),n=xt(this.long0+f*(1-p/6*(1+2*d+h-p/20*(5+28*d+24*g+8*h*d+6*h-p/42*(61+662*d+1320*g+720*g*d))))/l,this.over)}else i=st*jf(o),n=0;else{var m=Math.exp(s/this.k0),y=.5*(m-1/m),_=this.lat0+o/this.k0,x=Math.cos(_);t=Math.sqrt((1-Math.pow(x,2))/(1+Math.pow(y,2))),i=Math.asin(t),o<0&&(i=-i),y===0&&x===0?n=0:n=xt(Math.atan2(y,x)+this.long0,this.over)}return r.x=n,r.y=i,r}var Tj=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const x0={init:kj,forward:Ej,inverse:Sj,names:Tj};function kI(r){var t=Math.exp(r);return t=(t-1/t)/2,t}function _n(r,t){r=Math.abs(r),t=Math.abs(t);var e=Math.max(r,t),i=Math.min(r,t)/(e||1);return e*Math.sqrt(1+Math.pow(i,2))}function Cj(r){var t=1+r,e=t-1;return e===0?r:r*Math.log(t)/e}function Mj(r){var t=Math.abs(r);return t=Cj(t*(1+t/(_n(1,t)+1))),r<0?-t:t}function Db(r,t){for(var e=2*Math.cos(2*t),i=r.length-1,n=r[i],s=0,o;--i>=0;)o=-s+e*n+r[i],s=n,n=o;return t+o*Math.sin(2*t)}function Rj(r,t){for(var e=2*Math.cos(t),i=r.length-1,n=r[i],s=0,o;--i>=0;)o=-s+e*n+r[i],s=n,n=o;return Math.sin(t)*o}function Ij(r){var t=Math.exp(r);return t=(t+1/t)/2,t}function EI(r,t,e){for(var i=Math.sin(t),n=Math.cos(t),s=kI(e),o=Ij(e),a=2*n*o,l=-2*i*s,c=r.length-1,h=r[c],u=0,d=0,g=0,f,p;--c>=0;)f=d,p=u,d=h,u=g,h=-f+a*d-l*u+r[c],g=-p+l*d+a*u;return a=i*o,l=n*s,[a*h-l*g,a*g+l*h]}function Pj(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(x0.init.apply(this),this.forward=x0.forward,this.inverse=x0.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var r=this.es/(1+Math.sqrt(1-this.es)),t=r/(2-r),e=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),e=e*t,this.cgb[1]=e*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=e*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),e=e*t,this.cgb[2]=e*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=e*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),e=e*t,this.cgb[3]=e*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=e*(1237/630+t*(-12/5+t*(-24832/14175))),e=e*t,this.cgb[4]=e*(4174/315+t*(-144838/6237)),this.cbg[4]=e*(-734/315+t*(109598/31185)),e=e*t,this.cgb[5]=e*(601676/22275),this.cbg[5]=e*(444337/155925),e=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+e*(1/4+e*(1/64+e/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=e*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=e*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),e=e*t,this.utg[2]=e*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=e*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),e=e*t,this.utg[3]=e*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=e*(49561/161280+t*(-179/168+t*(6601661/7257600))),e=e*t,this.utg[4]=e*(-4583/161280+t*(108847/3991680)),this.gtu[4]=e*(34729/80640+t*(-3418889/1995840)),e=e*t,this.utg[5]=e*(-20648693/638668800),this.gtu[5]=e*(212378941/319334400);var i=Db(this.cbg,this.lat0);this.Zb=-this.Qn*(i+Rj(this.gtu,2*i))}function Aj(r){var t=xt(r.x-this.long0,this.over),e=r.y;e=Db(this.cbg,e);var i=Math.sin(e),n=Math.cos(e),s=Math.sin(t),o=Math.cos(t);e=Math.atan2(i,o*n),t=Math.atan2(s*n,_n(i,n*o)),t=Mj(Math.tan(t));var a=EI(this.gtu,2*e,2*t);e=e+a[0],t=t+a[1];var l,c;return Math.abs(t)<=2.623395162778?(l=this.a*(this.Qn*t)+this.x0,c=this.a*(this.Qn*e+this.Zb)+this.y0):(l=1/0,c=1/0),r.x=l,r.y=c,r}function Lj(r){var t=(r.x-this.x0)*(1/this.a),e=(r.y-this.y0)*(1/this.a);e=(e-this.Zb)/this.Qn,t=t/this.Qn;var i,n;if(Math.abs(t)<=2.623395162778){var s=EI(this.utg,2*e,2*t);e=e+s[0],t=t+s[1],t=Math.atan(kI(t));var o=Math.sin(e),a=Math.cos(e),l=Math.sin(t),c=Math.cos(t);e=Math.atan2(o*c,_n(l,c*a)),t=Math.atan2(l,c*a),i=xt(t+this.long0,this.over),n=Db(this.cgb,e)}else i=1/0,n=1/0;return r.x=i,r.y=n,r}var Oj=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const w0={init:Pj,forward:Aj,inverse:Lj,names:Oj};function Fj(r,t){if(r===void 0){if(r=Math.floor((xt(t)+Math.PI)*30/Math.PI)+1,r<0)return 0;if(r>60)return 60}return r}var Nj="etmerc";function Dj(){var r=Fj(this.zone,this.long0);if(r===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(r)-183)*$r,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,w0.init.apply(this),this.forward=w0.forward,this.inverse=w0.inverse}var $j=["Universal Transverse Mercator System","utm"];const Gj={init:Dj,names:$j,dependsOn:Nj};function $b(r,t){return Math.pow((1-r)/(1+r),t)}var jj=20;function zj(){var r=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*r*r),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(r/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+He)/(Math.pow(Math.tan(.5*this.lat0+He),this.C)*$b(this.e*r,this.ratexp))}function qj(r){var t=r.x,e=r.y;return r.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*e+He),this.C)*$b(this.e*Math.sin(e),this.ratexp))-st,r.x=this.C*t,r}function Bj(r){for(var t=1e-14,e=r.x/this.C,i=r.y,n=Math.pow(Math.tan(.5*i+He)/this.K,1/this.C),s=jj;s>0&&(i=2*Math.atan(n*$b(this.e*Math.sin(r.y),-.5*this.e))-st,!(Math.abs(i-r.y)<t));--s)r.y=i;return s?(r.x=e,r.y=i,r):null}const Gb={init:zj,forward:qj,inverse:Bj};function Uj(){Gb.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Wj(r){var t,e,i,n;return r.x=xt(r.x-this.long0,this.over),Gb.forward.apply(this,[r]),t=Math.sin(r.y),e=Math.cos(r.y),i=Math.cos(r.x),n=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*e*i),r.x=n*e*Math.sin(r.x),r.y=n*(this.cosc0*t-this.sinc0*e*i),r.x=this.a*r.x+this.x0,r.y=this.a*r.y+this.y0,r}function Vj(r){var t,e,i,n,s;if(r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,r.x/=this.k0,r.y/=this.k0,s=_n(r.x,r.y)){var o=2*Math.atan2(s,this.R2);t=Math.sin(o),e=Math.cos(o),n=Math.asin(e*this.sinc0+r.y*t*this.cosc0/s),i=Math.atan2(r.x*t,s*this.cosc0*e-r.y*this.sinc0*t)}else n=this.phic0,i=0;return r.x=i,r.y=n,Gb.inverse.apply(this,[r]),r.x=xt(r.x+this.long0,this.over),r}var Zj=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Hj={init:Uj,forward:Wj,inverse:Vj,names:Zj};function jb(r,t,e){return t*=e,Math.tan(.5*(st+r))*Math.pow((1-t)/(1+t),.5*e)}function Yj(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ft&&(this.k0=.5*(1+jf(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ft&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ft&&Math.abs(Math.cos(this.lat_ts))>ft&&(this.k0=.5*this.cons*wo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Ls(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=wo(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(jb(this.lat0,this.sinlat0,this.e))-st,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Xj(r){var t=r.x,e=r.y,i=Math.sin(e),n=Math.cos(e),s,o,a,l,c,h,u=xt(t-this.long0,this.over);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=ft&&Math.abs(e+this.lat0)<=ft?(r.x=NaN,r.y=NaN,r):this.sphere?(s=2*this.k0/(1+this.sinlat0*i+this.coslat0*n*Math.cos(u)),r.x=this.a*s*n*Math.sin(u)+this.x0,r.y=this.a*s*(this.coslat0*i-this.sinlat0*n*Math.cos(u))+this.y0,r):(o=2*Math.atan(jb(e,i,this.e))-st,l=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=ft?(c=Ls(this.e,e*this.con,this.con*i),h=2*this.a*this.k0*c/this.cons,r.x=this.x0+h*Math.sin(t-this.long0),r.y=this.y0-this.con*h*Math.cos(t-this.long0),r):(Math.abs(this.sinlat0)<ft?(s=2*this.a*this.k0/(1+l*Math.cos(u)),r.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*l*Math.cos(u))),r.y=s*(this.cosX0*a-this.sinX0*l*Math.cos(u))+this.y0),r.x=s*l*Math.sin(u)+this.x0,r))}function Kj(r){r.x-=this.x0,r.y-=this.y0;var t,e,i,n,s,o=Math.sqrt(r.x*r.x+r.y*r.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return t=this.long0,e=this.lat0,o<=ft?(r.x=t,r.y=e,r):(e=Math.asin(Math.cos(a)*this.sinlat0+r.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<ft?this.lat0>0?t=xt(this.long0+Math.atan2(r.x,-1*r.y),this.over):t=xt(this.long0+Math.atan2(r.x,r.y),this.over):t=xt(this.long0+Math.atan2(r.x*Math.sin(a),o*this.coslat0*Math.cos(a)-r.y*this.sinlat0*Math.sin(a)),this.over),r.x=t,r.y=e,r)}else if(Math.abs(this.coslat0)<=ft){if(o<=ft)return e=this.lat0,t=this.long0,r.x=t,r.y=e,r;r.x*=this.con,r.y*=this.con,i=o*this.cons/(2*this.a*this.k0),e=this.con*Yg(this.e,i),t=this.con*xt(this.con*this.long0+Math.atan2(r.x,-1*r.y),this.over)}else n=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,o<=ft?s=this.X0:(s=Math.asin(Math.cos(n)*this.sinX0+r.y*Math.sin(n)*this.cosX0/o),t=xt(this.long0+Math.atan2(r.x*Math.sin(n),o*this.cosX0*Math.cos(n)-r.y*this.sinX0*Math.sin(n)),this.over)),e=-1*Yg(this.e,Math.tan(.5*(st+s)));return r.x=t,r.y=e,r}var Qj=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Jj={init:Yj,forward:Xj,inverse:Kj,names:Qj,ssfn_:jb};function tz(){var r=this.lat0;this.lambda0=this.long0;var t=Math.sin(r),e=this.a,i=this.rf,n=1/i,s=2*n-Math.pow(n,2),o=this.e=Math.sqrt(s);this.R=this.k0*e*Math.sqrt(1-s)/(1-s*Math.pow(t,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(r),4)),this.b0=Math.asin(t/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+r/2)),c=Math.log((1+o*t)/(1-o*t));this.K=a-this.alpha*l+this.alpha*o/2*c}function ez(r){var t=Math.log(Math.tan(Math.PI/4-r.y/2)),e=this.e/2*Math.log((1+this.e*Math.sin(r.y))/(1-this.e*Math.sin(r.y))),i=-this.alpha*(t+e)+this.K,n=2*(Math.atan(Math.exp(i))-Math.PI/4),s=this.alpha*(r.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(n)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(n)-Math.sin(this.b0)*Math.cos(n)*Math.cos(s));return r.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,r.x=this.R*o+this.x0,r}function rz(r){for(var t=r.x-this.x0,e=r.y-this.y0,i=t/this.R,n=2*(Math.atan(Math.exp(e/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(n)+Math.sin(this.b0)*Math.cos(n)*Math.cos(i)),o=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(n))),a=this.lambda0+o/this.alpha,l=0,c=s,h=-1e3,u=0;Math.abs(c-h)>1e-7;){if(++u>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),h=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return r.x=a,r.y=c,r}var iz=["somerc"];const nz={init:tz,forward:ez,inverse:rz,names:iz};var Ih=1e-7;function sz(r){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],e=typeof r.projName=="object"?Object.keys(r.projName)[0]:r.projName;return"no_uoff"in r||"no_off"in r||t.indexOf(e)!==-1||t.indexOf(dI(e))!==-1}function oz(){var r,t,e,i,n,s,o,a,l,c,h=0,u,d=0,g=0,f=0,p=0,m=0,y=0;this.no_off=sz(this),this.no_rot="no_rot"in this;var _=!1;"alpha"in this&&(_=!0);var x=!1;if("rectified_grid_angle"in this&&(x=!0),_&&(y=this.alpha),x&&(h=this.rectified_grid_angle),_||x)d=this.longc;else if(g=this.long1,p=this.lat1,f=this.long2,m=this.lat2,Math.abs(p-m)<=Ih||(r=Math.abs(p))<=Ih||Math.abs(r-st)<=Ih||Math.abs(Math.abs(this.lat0)-st)<=Ih||Math.abs(Math.abs(m)-st)<=Ih)throw new Error;var v=1-this.es;t=Math.sqrt(v),Math.abs(this.lat0)>ft?(a=Math.sin(this.lat0),e=Math.cos(this.lat0),r=1-this.es*a*a,this.B=e*e,this.B=Math.sqrt(1+this.es*this.B*this.B/v),this.A=this.B*this.k0*t/r,i=this.B*t/(e*Math.sqrt(r)),n=i*i-1,n<=0?n=0:(n=Math.sqrt(n),this.lat0<0&&(n=-n)),this.E=n+=i,this.E*=Math.pow(Ls(this.e,this.lat0,a),this.B)):(this.B=1/t,this.A=this.k0,this.E=i=n=1),_||x?(_?(u=Math.asin(Math.sin(y)/i),x||(h=y)):(u=h,y=Math.asin(i*Math.sin(u))),this.lam0=d-Math.asin(.5*(n-1/n)*Math.tan(u))/this.B):(s=Math.pow(Ls(this.e,p,Math.sin(p)),this.B),o=Math.pow(Ls(this.e,m,Math.sin(m)),this.B),n=this.E/s,l=(o-s)/(o+s),c=this.E*this.E,c=(c-o*s)/(c+o*s),r=g-f,r<-Math.PI?f-=Zg:r>Math.PI&&(f+=Zg),this.lam0=xt(.5*(g+f)-Math.atan(c*Math.tan(.5*this.B*(g-f))/l)/this.B,this.over),u=Math.atan(2*Math.sin(this.B*xt(g-this.lam0,this.over))/(n-1/n)),h=y=Math.asin(i*Math.sin(u))),this.singam=Math.sin(u),this.cosgam=Math.cos(u),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(y))),this.lat0<0&&(this.u_0=-this.u_0)),n=.5*u,this.v_pole_n=this.ArB*Math.log(Math.tan(He-n)),this.v_pole_s=this.ArB*Math.log(Math.tan(He+n))}function az(r){var t={},e,i,n,s,o,a,l,c;if(r.x=r.x-this.lam0,Math.abs(Math.abs(r.y)-st)>ft){if(o=this.E/Math.pow(Ls(this.e,r.y,Math.sin(r.y)),this.B),a=1/o,e=.5*(o-a),i=.5*(o+a),s=Math.sin(this.B*r.x),n=(e*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(n)-1)<ft)throw new Error;c=.5*this.ArB*Math.log((1-n)/(1+n)),a=Math.cos(this.B*r.x),Math.abs(a)<Ih?l=this.A*r.x:l=this.ArB*Math.atan2(e*this.cosgam+s*this.singam,a)}else c=r.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*r.y;return this.no_rot?(t.x=l,t.y=c):(l-=this.u_0,t.x=c*this.cosrot+l*this.sinrot,t.y=l*this.cosrot-c*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function lz(r){var t,e,i,n,s,o,a,l={};if(r.x=(r.x-this.x0)*(1/this.a),r.y=(r.y-this.y0)*(1/this.a),this.no_rot?(e=r.y,t=r.x):(e=r.x*this.cosrot-r.y*this.sinrot,t=r.y*this.cosrot+r.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*e),n=.5*(i-1/i),s=.5*(i+1/i),o=Math.sin(this.BrA*t),a=(o*this.cosgam+n*this.singam)/s,Math.abs(Math.abs(a)-1)<ft)l.x=0,l.y=a<0?-st:st;else{if(l.y=this.E/Math.sqrt((1+a)/(1-a)),l.y=Yg(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(n*this.cosgam-o*this.singam,Math.cos(this.BrA*t))}return l.x+=this.lam0,l}var cz=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const hz={init:oz,forward:az,inverse:lz,names:cz};function uz(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ft)){var r=this.b/this.a;this.e=Math.sqrt(1-r*r);var t=Math.sin(this.lat1),e=Math.cos(this.lat1),i=wo(this.e,t,e),n=Ls(this.e,this.lat1,t),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=wo(this.e,s,o),l=Ls(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-st)<ft?0:Ls(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ft?this.ns=Math.log(i/a)/Math.log(n/l):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=i/(this.ns*Math.pow(n,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function dz(r){var t=r.x,e=r.y;Math.abs(2*Math.abs(e)-Math.PI)<=ft&&(e=jf(e)*(st-2*ft));var i=Math.abs(Math.abs(e)-st),n,s;if(i>ft)n=Ls(this.e,e,Math.sin(e)),s=this.a*this.f0*Math.pow(n,this.ns);else{if(i=e*this.ns,i<=0)return null;s=0}var o=this.ns*xt(t-this.long0,this.over);return r.x=this.k0*(s*Math.sin(o))+this.x0,r.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,r}function gz(r){var t,e,i,n,s,o=(r.x-this.x0)/this.k0,a=this.rh-(r.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(o*o+a*a),e=1):(t=-Math.sqrt(o*o+a*a),e=-1);var l=0;if(t!==0&&(l=Math.atan2(e*o,e*a)),t!==0||this.ns>0){if(e=1/this.ns,i=Math.pow(t/(this.a*this.f0),e),n=Yg(this.e,i),n===-9999)return null}else n=-st;return s=xt(l/this.ns+this.long0,this.over),r.x=s,r.y=n,r}var fz=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const pz={init:uz,forward:dz,inverse:gz,names:fz};function mz(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function yz(r){var t,e,i,n,s,o,a,l=r.x,c=r.y,h=xt(l-this.long0,this.over);return t=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),e=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/t)-this.s45),i=-h*this.alfa,n=Math.asin(Math.cos(this.ad)*Math.sin(e)+Math.sin(this.ad)*Math.cos(e)*Math.cos(i)),s=Math.asin(Math.cos(e)*Math.sin(i)/Math.cos(n)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(n/2+this.s45),this.n),r.y=a*Math.cos(o)/1,r.x=a*Math.sin(o)/1,this.czech||(r.y*=-1,r.x*=-1),r}function _z(r){var t,e,i,n,s,o,a,l,c=r.x;r.x=r.y,r.y=c,this.czech||(r.y*=-1,r.x*=-1),o=Math.sqrt(r.x*r.x+r.y*r.y),s=Math.atan2(r.y,r.x),n=s/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),e=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(t)),r.x=this.long0-e/this.alfa,a=t,l=0;var h=0;do r.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-r.y)<1e-10&&(l=1),a=r.y,h+=1;while(l===0&&h<15);return h>=15?null:r}var vz=["Krovak","krovak"];const xz={init:mz,forward:yz,inverse:_z,names:vz};function Ji(r,t,e,i,n){return r*n-t*Math.sin(2*n)+e*Math.sin(4*n)-i*Math.sin(6*n)}function zf(r){return 1-.25*r*(1+r/16*(3+1.25*r))}function qf(r){return .375*r*(1+.25*r*(1+.46875*r))}function Bf(r){return .05859375*r*r*(1+.75*r)}function Uf(r){return r*r*r*(35/3072)}function zb(r,t,e){var i=t*e;return r/Math.sqrt(1-i*i)}function Cl(r){return Math.abs(r)<st?r:r-jf(r)*Math.PI}function om(r,t,e,i,n){var s,o;s=r/t;for(var a=0;a<15;a++)if(o=(r-(t*s-e*Math.sin(2*s)+i*Math.sin(4*s)-n*Math.sin(6*s)))/(t-2*e*Math.cos(2*s)+4*i*Math.cos(4*s)-6*n*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function wz(){this.sphere||(this.e0=zf(this.es),this.e1=qf(this.es),this.e2=Bf(this.es),this.e3=Uf(this.es),this.ml0=this.a*Ji(this.e0,this.e1,this.e2,this.e3,this.lat0))}function bz(r){var t,e,i=r.x,n=r.y;if(i=xt(i-this.long0,this.over),this.sphere)t=this.a*Math.asin(Math.cos(n)*Math.sin(i)),e=this.a*(Math.atan2(Math.tan(n),Math.cos(i))-this.lat0);else{var s=Math.sin(n),o=Math.cos(n),a=zb(this.a,this.e,s),l=Math.tan(n)*Math.tan(n),c=i*Math.cos(n),h=c*c,u=this.es*o*o/(1-this.es),d=this.a*Ji(this.e0,this.e1,this.e2,this.e3,n);t=a*c*(1-h*l*(1/6-(8-l+8*u)*h/120)),e=d-this.ml0+a*s/o*h*(.5+(5-l+6*u)*h/24)}return r.x=t+this.x0,r.y=e+this.y0,r}function kz(r){r.x-=this.x0,r.y-=this.y0;var t=r.x/this.a,e=r.y/this.a,i,n;if(this.sphere){var s=e+this.lat0;i=Math.asin(Math.sin(s)*Math.cos(t)),n=Math.atan2(Math.tan(t),Math.cos(s))}else{var o=this.ml0/this.a+e,a=om(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-st)<=ft)return r.x=this.long0,r.y=st,e<0&&(r.y*=-1),r;var l=zb(this.a,this.e,Math.sin(a)),c=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(a),2),u=t*this.a/l,d=u*u;i=a-l*Math.tan(a)/c*u*u*(.5-(1+3*h)*u*u/24),n=u*(1-d*(h/3+(1+3*h)*h*d/15))/Math.cos(a)}return r.x=xt(n+this.long0,this.over),r.y=Cl(i),r}var Ez=["Cassini","Cassini_Soldner","cass"];const Sz={init:wz,forward:bz,inverse:kz,names:Ez};function dl(r,t){var e;return r>1e-7?(e=r*t,(1-r*r)*(t/(1-e*e)-.5/r*Math.log((1-e)/(1+e)))):2*t}var Wx=1,Vx=2,Zx=3,b0=4;function Tz(){var r=Math.abs(this.lat0);if(Math.abs(r-st)<ft?this.mode=this.lat0<0?Wx:Vx:Math.abs(r)<ft?this.mode=Zx:this.mode=b0,this.es>0){var t;switch(this.qp=dl(this.e,1),this.mmf=.5/(1-this.es),this.apa=Fz(this.es),this.mode){case Vx:this.dd=1;break;case Wx:this.dd=1;break;case Zx:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case b0:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=dl(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===b0&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Cz(r){var t,e,i,n,s,o,a,l,c,h,u=r.x,d=r.y;if(u=xt(u-this.long0,this.over),this.sphere){if(s=Math.sin(d),h=Math.cos(d),i=Math.cos(u),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e=this.mode===this.EQUIT?1+h*i:1+this.sinph0*s+this.cosph0*h*i,e<=ft)return null;e=Math.sqrt(2/e),t=e*h*Math.sin(u),e*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(d+this.lat0)<ft)return null;e=He-d*.5,e=2*(this.mode===this.S_POLE?Math.cos(e):Math.sin(e)),t=e*Math.sin(u),e*=i}}else{switch(a=0,l=0,c=0,i=Math.cos(u),n=Math.sin(u),s=Math.sin(d),o=dl(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:c=1+this.sinb1*a+this.cosb1*l*i;break;case this.EQUIT:c=1+l*i;break;case this.N_POLE:c=st+d,o=this.qp-o;break;case this.S_POLE:c=d-st,o=this.qp+o;break}if(Math.abs(c)<ft)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?e=this.ymf*c*(this.cosb1*a-this.sinb1*l*i):e=(c=Math.sqrt(2/(1+l*i)))*a*this.ymf,t=this.xmf*c*l*n;break;case this.N_POLE:case this.S_POLE:o>=0?(t=(c=Math.sqrt(o))*n,e=i*(this.mode===this.S_POLE?c:-c)):t=e=0;break}}return r.x=this.a*t+this.x0,r.y=this.a*e+this.y0,r}function Mz(r){r.x-=this.x0,r.y-=this.y0;var t=r.x/this.a,e=r.y/this.a,i,n,s,o,a,l,c;if(this.sphere){var h=0,u,d=0;if(u=Math.sqrt(t*t+e*e),n=u*.5,n>1)return null;switch(n=2*Math.asin(n),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(d=Math.sin(n),h=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(u)<=ft?0:Math.asin(e*d/u),t*=d,e=h*u;break;case this.OBLIQ:n=Math.abs(u)<=ft?this.lat0:Math.asin(h*this.sinph0+e*d*this.cosph0/u),t*=d*this.cosph0,e=(h-Math.sin(n)*this.sinph0)*u;break;case this.N_POLE:e=-e,n=st-n;break;case this.S_POLE:n-=st;break}i=e===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,e)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,e*=this.dd,l=Math.sqrt(t*t+e*e),l<ft)return r.x=this.long0,r.y=this.lat0,r;o=2*Math.asin(.5*l/this.rq),s=Math.cos(o),t*=o=Math.sin(o),this.mode===this.OBLIQ?(c=s*this.sinb1+e*o*this.cosb1/l,a=this.qp*c,e=l*this.cosb1*s-e*this.sinb1*o):(c=e*o/l,a=this.qp*c,e=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(e=-e),a=t*t+e*e,!a)return r.x=this.long0,r.y=this.lat0,r;c=1-a/this.qp,this.mode===this.S_POLE&&(c=-c)}i=Math.atan2(t,e),n=Nz(Math.asin(c),this.apa)}return r.x=xt(this.long0+i,this.over),r.y=n,r}var Rz=.3333333333333333,Iz=.17222222222222222,Pz=.10257936507936508,Az=.06388888888888888,Lz=.0664021164021164,Oz=.016415012942191543;function Fz(r){var t,e=[];return e[0]=r*Rz,t=r*r,e[0]+=t*Iz,e[1]=t*Az,t*=r,e[0]+=t*Pz,e[1]+=t*Lz,e[2]=t*Oz,e}function Nz(r,t){var e=r+r;return r+t[0]*Math.sin(e)+t[1]*Math.sin(e+e)+t[2]*Math.sin(e+e+e)}var Dz=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const $z={init:Tz,forward:Cz,inverse:Mz,names:Dz,S_POLE:Wx,N_POLE:Vx,EQUIT:Zx,OBLIQ:b0};function bl(r){return Math.abs(r)>1&&(r=r>1?1:-1),Math.asin(r)}function Gz(){Math.abs(this.lat1+this.lat2)<ft||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=wo(this.e3,this.sin_po,this.cos_po),this.qs1=dl(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=wo(this.e3,this.sin_po,this.cos_po),this.qs2=dl(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=dl(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>ft?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function jz(r){var t=r.x,e=r.y;this.sin_phi=Math.sin(e),this.cos_phi=Math.cos(e);var i=dl(this.e3,this.sin_phi),n=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*xt(t-this.long0,this.over),o=n*Math.sin(s)+this.x0,a=this.rh-n*Math.cos(s)+this.y0;return r.x=o,r.y=a,r}function zz(r){var t,e,i,n,s,o;return r.x-=this.x0,r.y=this.rh-r.y+this.y0,this.ns0>=0?(t=Math.sqrt(r.x*r.x+r.y*r.y),i=1):(t=-Math.sqrt(r.x*r.x+r.y*r.y),i=-1),n=0,t!==0&&(n=Math.atan2(i*r.x,i*r.y)),i=t*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(e=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,e)),s=xt(n/this.ns0+this.long0,this.over),r.x=s,r.y=o,r}function qz(r,t){var e,i,n,s,o,a=bl(.5*t);if(r<ft)return a;for(var l=r*r,c=1;c<=25;c++)if(e=Math.sin(a),i=Math.cos(a),n=r*e,s=1-n*n,o=.5*s*s/i*(t/(1-l)-e/s+.5/r*Math.log((1-n)/(1+n))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var Bz=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const Uz={init:Gz,forward:jz,inverse:zz,names:Bz,phi1z:qz};function Wz(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Vz(r){var t,e,i,n,s,o,a,l,c=r.x,h=r.y;return i=xt(c-this.long0,this.over),t=Math.sin(h),e=Math.cos(h),n=Math.cos(i),o=this.sin_p14*t+this.cos_p14*e*n,s=1,o>0||Math.abs(o)<=ft?(a=this.x0+this.a*s*e*Math.sin(i)/o,l=this.y0+this.a*s*(this.cos_p14*t-this.sin_p14*e*n)/o):(a=this.x0+this.infinity_dist*e*Math.sin(i),l=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*e*n)),r.x=a,r.y=l,r}function Zz(r){var t,e,i,n,s,o;return r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,r.x/=this.k0,r.y/=this.k0,(t=Math.sqrt(r.x*r.x+r.y*r.y))?(n=Math.atan2(t,this.rc),e=Math.sin(n),i=Math.cos(n),o=bl(i*this.sin_p14+r.y*e*this.cos_p14/t),s=Math.atan2(r.x*e,t*this.cos_p14*i-r.y*this.sin_p14*e),s=xt(this.long0+s,this.over)):(o=this.phic0,s=0),r.x=s,r.y=o,r}var Hz=["gnom"];const Yz={init:Wz,forward:Vz,inverse:Zz,names:Hz};function Xz(r,t){var e=1-(1-r*r)/(2*r)*Math.log((1-r)/(1+r));if(Math.abs(Math.abs(t)-e)<1e-6)return t<0?-1*st:st;for(var i=Math.asin(.5*t),n,s,o,a,l=0;l<30;l++)if(s=Math.sin(i),o=Math.cos(i),a=r*s,n=Math.pow(1-a*a,2)/(2*o)*(t/(1-r*r)-s/(1-a*a)+.5/r*Math.log((1-a)/(1+a))),i+=n,Math.abs(n)<=1e-10)return i;return NaN}function Kz(){this.sphere||(this.k0=wo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Qz(r){var t=r.x,e=r.y,i,n,s=xt(t-this.long0,this.over);if(this.sphere)i=this.x0+this.a*s*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(e)/Math.cos(this.lat_ts);else{var o=dl(this.e,Math.sin(e));i=this.x0+this.a*this.k0*s,n=this.y0+this.a*o*.5/this.k0}return r.x=i,r.y=n,r}function Jz(r){r.x-=this.x0,r.y-=this.y0;var t,e;return this.sphere?(t=xt(this.long0+r.x/this.a/Math.cos(this.lat_ts),this.over),e=Math.asin(r.y/this.a*Math.cos(this.lat_ts))):(e=Xz(this.e,2*r.y*this.k0/this.a),t=xt(this.long0+r.x/(this.a*this.k0),this.over)),r.x=t,r.y=e,r}var tq=["cea"];const eq={init:Kz,forward:Qz,inverse:Jz,names:tq};function rq(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function iq(r){var t=r.x,e=r.y,i=xt(t-this.long0,this.over),n=Cl(e-this.lat0);return r.x=this.x0+this.a*i*this.rc,r.y=this.y0+this.a*n,r}function nq(r){var t=r.x,e=r.y;return r.x=xt(this.long0+(t-this.x0)/(this.a*this.rc),this.over),r.y=Cl(this.lat0+(e-this.y0)/this.a),r}var sq=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const oq={init:rq,forward:iq,inverse:nq,names:sq};var EC=20;function aq(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=zf(this.es),this.e1=qf(this.es),this.e2=Bf(this.es),this.e3=Uf(this.es),this.ml0=this.a*Ji(this.e0,this.e1,this.e2,this.e3,this.lat0)}function lq(r){var t=r.x,e=r.y,i,n,s,o=xt(t-this.long0,this.over);if(s=o*Math.sin(e),this.sphere)Math.abs(e)<=ft?(i=this.a*o,n=-1*this.a*this.lat0):(i=this.a*Math.sin(s)/Math.tan(e),n=this.a*(Cl(e-this.lat0)+(1-Math.cos(s))/Math.tan(e)));else if(Math.abs(e)<=ft)i=this.a*o,n=-1*this.ml0;else{var a=zb(this.a,this.e,Math.sin(e))/Math.tan(e);i=a*Math.sin(s),n=this.a*Ji(this.e0,this.e1,this.e2,this.e3,e)-this.ml0+a*(1-Math.cos(s))}return r.x=i+this.x0,r.y=n+this.y0,r}function cq(r){var t,e,i,n,s,o,a,l,c;if(i=r.x-this.x0,n=r.y-this.y0,this.sphere)if(Math.abs(n+this.a*this.lat0)<=ft)t=xt(i/this.a+this.long0,this.over),e=0;else{o=this.lat0+n/this.a,a=i*i/this.a/this.a+o*o,l=o;var h;for(s=EC;s;--s)if(h=Math.tan(l),c=-1*(o*(l*h+1)-l-.5*(l*l+a)*h)/((l-o)/h-1),l+=c,Math.abs(c)<=ft){e=l;break}t=xt(this.long0+Math.asin(i*Math.tan(l)/this.a)/Math.sin(e),this.over)}else if(Math.abs(n+this.ml0)<=ft)e=0,t=xt(this.long0+i/this.a,this.over);else{o=(this.ml0+n)/this.a,a=i*i/this.a/this.a+o*o,l=o;var u,d,g,f,p;for(s=EC;s;--s)if(p=this.e*Math.sin(l),u=Math.sqrt(1-p*p)*Math.tan(l),d=this.a*Ji(this.e0,this.e1,this.e2,this.e3,l),g=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),f=d/this.a,c=(o*(u*f+1)-f-.5*u*(f*f+a))/(this.es*Math.sin(2*l)*(f*f+a-2*o*f)/(4*u)+(o-f)*(u*g-2/Math.sin(2*l))-g),l-=c,Math.abs(c)<=ft){e=l;break}u=Math.sqrt(1-this.es*Math.pow(Math.sin(e),2))*Math.tan(e),t=xt(this.long0+Math.asin(i*u/this.a)/Math.sin(e),this.over)}return r.x=t,r.y=e,r}var hq=["Polyconic","American_Polyconic","poly"];const uq={init:aq,forward:lq,inverse:cq,names:hq};function dq(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function gq(r){var t,e=r.x,i=r.y,n=i-this.lat0,s=e-this.long0,o=n/rg*1e-5,a=s,l=1,c=0;for(t=1;t<=10;t++)l=l*o,c=c+this.A[t]*l;var h=c,u=a,d=1,g=0,f,p,m=0,y=0;for(t=1;t<=6;t++)f=d*h-g*u,p=g*h+d*u,d=f,g=p,m=m+this.B_re[t]*d-this.B_im[t]*g,y=y+this.B_im[t]*d+this.B_re[t]*g;return r.x=y*this.a+this.x0,r.y=m*this.a+this.y0,r}function fq(r){var t,e=r.x,i=r.y,n=e-this.x0,s=i-this.y0,o=s/this.a,a=n/this.a,l=1,c=0,h,u,d=0,g=0;for(t=1;t<=6;t++)h=l*o-c*a,u=c*o+l*a,l=h,c=u,d=d+this.C_re[t]*l-this.C_im[t]*c,g=g+this.C_im[t]*l+this.C_re[t]*c;for(var f=0;f<this.iterations;f++){var p=d,m=g,y,_,x=o,v=a;for(t=2;t<=6;t++)y=p*d-m*g,_=m*d+p*g,p=y,m=_,x=x+(t-1)*(this.B_re[t]*p-this.B_im[t]*m),v=v+(t-1)*(this.B_im[t]*p+this.B_re[t]*m);p=1,m=0;var w=this.B_re[1],b=this.B_im[1];for(t=2;t<=6;t++)y=p*d-m*g,_=m*d+p*g,p=y,m=_,w=w+t*(this.B_re[t]*p-this.B_im[t]*m),b=b+t*(this.B_im[t]*p+this.B_re[t]*m);var E=w*w+b*b;d=(x*w+v*b)/E,g=(v*w-x*b)/E}var C=d,S=g,R=1,I=0;for(t=1;t<=9;t++)R=R*C,I=I+this.D[t]*R;var F=this.lat0+I*rg*1e5,N=this.long0+S;return r.x=N,r.y=F,r}var pq=["New_Zealand_Map_Grid","nzmg"];const mq={init:dq,forward:gq,inverse:fq,names:pq};function yq(){}function _q(r){var t=r.x,e=r.y,i=xt(t-this.long0,this.over),n=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+e/2.5))*1.25;return r.x=n,r.y=s,r}function vq(r){r.x-=this.x0,r.y-=this.y0;var t=xt(this.long0+r.x/this.a,this.over),e=2.5*(Math.atan(Math.exp(.8*r.y/this.a))-Math.PI/4);return r.x=t,r.y=e,r}var xq=["Miller_Cylindrical","mill"];const wq={init:yq,forward:_q,inverse:vq,names:xq};var bq=20;function kq(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Fb(this.es)}function Eq(r){var t,e,i=r.x,n=r.y;if(i=xt(i-this.long0,this.over),this.sphere){if(!this.m)n=this.n!==1?Math.asin(this.n*Math.sin(n)):n;else for(var s=this.n*Math.sin(n),o=bq;o;--o){var a=(this.m*n+Math.sin(n)-s)/(this.m+Math.cos(n));if(n-=a,Math.abs(a)<ft)break}t=this.a*this.C_x*i*(this.m+Math.cos(n)),e=this.a*this.C_y*n}else{var l=Math.sin(n),c=Math.cos(n);e=this.a*Ku(n,l,c,this.en),t=this.a*i*c/Math.sqrt(1-this.es*l*l)}return r.x=t,r.y=e,r}function Sq(r){var t,e,i,n;return r.x-=this.x0,i=r.x/this.a,r.y-=this.y0,t=r.y/this.a,this.sphere?(t/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(t))),this.m?t=bl((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=bl(Math.sin(t)/this.n)),i=xt(i+this.long0,this.over),t=Cl(t)):(t=Nb(r.y/this.a,this.es,this.en),n=Math.abs(t),n<st?(n=Math.sin(t),e=this.long0+r.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(t)),i=xt(e,this.over)):n-ft<st&&(i=this.long0)),r.x=i,r.y=t,r}var Tq=["Sinusoidal","sinu"];const Cq={init:kq,forward:Eq,inverse:Sq,names:Tq};function Mq(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function Rq(r){for(var t=r.x,e=r.y,i=xt(t-this.long0,this.over),n=e,s=Math.PI*Math.sin(e);;){var o=-(n+Math.sin(n)-s)/(1+Math.cos(n));if(n+=o,Math.abs(o)<ft)break}n/=2,Math.PI/2-Math.abs(e)<ft&&(i=0);var a=.900316316158*this.a*i*Math.cos(n)+this.x0,l=1.4142135623731*this.a*Math.sin(n)+this.y0;return r.x=a,r.y=l,r}function Iq(r){var t,e;r.x-=this.x0,r.y-=this.y0,e=r.y/(1.4142135623731*this.a),Math.abs(e)>.999999999999&&(e=.999999999999),t=Math.asin(e);var i=xt(this.long0+r.x/(.900316316158*this.a*Math.cos(t)),this.over);i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),e=(2*t+Math.sin(2*t))/Math.PI,Math.abs(e)>1&&(e=1);var n=Math.asin(e);return r.x=i,r.y=n,r}var Pq=["Mollweide","moll"];const Aq={init:Mq,forward:Rq,inverse:Iq,names:Pq};function Lq(){Math.abs(this.lat1+this.lat2)<ft||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=zf(this.es),this.e1=qf(this.es),this.e2=Bf(this.es),this.e3=Uf(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=wo(this.e,this.sin_phi,this.cos_phi),this.ml1=Ji(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ft?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=wo(this.e,this.sin_phi,this.cos_phi),this.ml2=Ji(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ji(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Oq(r){var t=r.x,e=r.y,i;if(this.sphere)i=this.a*(this.g-e);else{var n=Ji(this.e0,this.e1,this.e2,this.e3,e);i=this.a*(this.g-n)}var s=this.ns*xt(t-this.long0,this.over),o=this.x0+i*Math.sin(s),a=this.y0+this.rh-i*Math.cos(s);return r.x=o,r.y=a,r}function Fq(r){r.x-=this.x0,r.y=this.rh-r.y+this.y0;var t,e,i,n;this.ns>=0?(e=Math.sqrt(r.x*r.x+r.y*r.y),t=1):(e=-Math.sqrt(r.x*r.x+r.y*r.y),t=-1);var s=0;if(e!==0&&(s=Math.atan2(t*r.x,t*r.y)),this.sphere)return n=xt(this.long0+s/this.ns,this.over),i=Cl(this.g-e/this.a),r.x=n,r.y=i,r;var o=this.g-e/this.a;return i=om(o,this.e0,this.e1,this.e2,this.e3),n=xt(this.long0+s/this.ns,this.over),r.x=n,r.y=i,r}var Nq=["Equidistant_Conic","eqdc"];const Dq={init:Lq,forward:Oq,inverse:Fq,names:Nq};function $q(){this.R=this.a}function Gq(r){var t=r.x,e=r.y,i=xt(t-this.long0,this.over),n,s;Math.abs(e)<=ft&&(n=this.x0+this.R*i,s=this.y0);var o=bl(2*Math.abs(e/Math.PI));(Math.abs(i)<=ft||Math.abs(Math.abs(e)-st)<=ft)&&(n=this.x0,e>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/i-i/Math.PI),l=a*a,c=Math.sin(o),h=Math.cos(o),u=h/(c+h-1),d=u*u,g=u*(2/c-1),f=g*g,p=Math.PI*this.R*(a*(u-f)+Math.sqrt(l*(u-f)*(u-f)-(f+l)*(d-f)))/(f+l);i<0&&(p=-p),n=this.x0+p;var m=l+u;return p=Math.PI*this.R*(g*m-a*Math.sqrt((f+l)*(l+1)-m*m))/(f+l),e>=0?s=this.y0+p:s=this.y0-p,r.x=n,r.y=s,r}function jq(r){var t,e,i,n,s,o,a,l,c,h,u,d,g;return r.x-=this.x0,r.y-=this.y0,u=Math.PI*this.R,i=r.x/u,n=r.y/u,s=i*i+n*n,o=-Math.abs(n)*(1+s),a=o-2*n*n+i*i,l=-2*o+1+2*n*n+s*s,g=n*n/l+(2*a*a*a/l/l/l-9*o*a/l/l)/27,c=(o-a*a/3/l)/l,h=2*Math.sqrt(-c/3),u=3*g/c/h,Math.abs(u)>1&&(u>=0?u=1:u=-1),d=Math.acos(u)/3,r.y>=0?e=(-h*Math.cos(d+Math.PI/3)-a/3/l)*Math.PI:e=-(-h*Math.cos(d+Math.PI/3)-a/3/l)*Math.PI,Math.abs(i)<ft?t=this.long0:t=xt(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(i*i-n*n)+s*s))/2/i,this.over),r.x=t,r.y=e,r}var zq=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const qq={init:$q,forward:Gq,inverse:jq,names:zq};function Bq(r,t,e,i,n,s){const o=i-t,a=Math.atan((1-s)*Math.tan(r)),l=Math.atan((1-s)*Math.tan(e)),c=Math.sin(a),h=Math.cos(a),u=Math.sin(l),d=Math.cos(l);let g=o,f,p=100,m,y,_,x,v,w,b,E,C,S,R,I,F,N;do{if(m=Math.sin(g),y=Math.cos(g),_=Math.sqrt(d*m*(d*m)+(h*u-c*d*y)*(h*u-c*d*y)),_===0)return{azi1:0,s12:0};x=c*u+h*d*y,v=Math.atan2(_,x),w=h*d*m/_,b=1-w*w,E=b!==0?x-2*c*u/b:0,C=s/16*b*(4+s*(4-3*b)),f=g,g=o+(1-C)*s*w*(v+C*_*(E+C*x*(-1+2*E*E)))}while(Math.abs(g-f)>1e-12&&--p>0);return p===0?{azi1:NaN,s12:NaN}:(S=b*(n*n-n*(1-s)*(n*(1-s)))/(n*(1-s)*(n*(1-s))),R=1+S/16384*(4096+S*(-768+S*(320-175*S))),I=S/1024*(256+S*(-128+S*(74-47*S))),F=I*_*(E+I/4*(x*(-1+2*E*E)-I/6*E*(-3+4*_*_)*(-3+4*E*E))),N=n*(1-s)*R*(v-F),{azi1:Math.atan2(d*m,h*u-c*d*y),s12:N})}function Uq(r,t,e,i,n,s){const o=Math.atan((1-s)*Math.tan(r)),a=Math.sin(o),l=Math.cos(o),c=Math.sin(e),h=Math.cos(e),u=Math.atan2(a,l*h),d=l*c,g=1-d*d,f=g*(n*n-n*(1-s)*(n*(1-s)))/(n*(1-s)*(n*(1-s))),p=1+f/16384*(4096+f*(-768+f*(320-175*f))),m=f/1024*(256+f*(-128+f*(74-47*f)));let y=i/(n*(1-s)*p),_,x=100,v,w,b,E;do v=Math.cos(2*u+y),w=Math.sin(y),b=Math.cos(y),E=m*w*(v+m/4*(b*(-1+2*v*v)-m/6*v*(-3+4*w*w)*(-3+4*v*v))),_=y,y=i/(n*(1-s)*p)+E;while(Math.abs(y-_)>1e-12&&--x>0);if(x===0)return{lat2:NaN,lon2:NaN};const C=a*w-l*b*h,S=Math.atan2(a*b+l*w*h,(1-s)*Math.sqrt(d*d+C*C)),R=Math.atan2(w*c,l*b-a*w*h),I=s/16*g*(4+s*(4-3*g)),F=R-(1-I)*s*d*(y+I*w*(v+I*b*(-1+2*v*v))),N=t+F;return{lat2:S,lon2:N}}function Wq(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Vq(r){var t=r.x,e=r.y,i=Math.sin(r.y),n=Math.cos(r.y),s=xt(t-this.long0,this.over),o,a,l,c,h,u,d,g,f,p,m;return this.sphere?Math.abs(this.sin_p12-1)<=ft?(r.x=this.x0+this.a*(st-e)*Math.sin(s),r.y=this.y0-this.a*(st-e)*Math.cos(s),r):Math.abs(this.sin_p12+1)<=ft?(r.x=this.x0+this.a*(st+e)*Math.sin(s),r.y=this.y0+this.a*(st+e)*Math.cos(s),r):(f=this.sin_p12*i+this.cos_p12*n*Math.cos(s),d=Math.acos(f),g=d?d/Math.sin(d):1,r.x=this.x0+this.a*g*n*Math.sin(s),r.y=this.y0+this.a*g*(this.cos_p12*i-this.sin_p12*n*Math.cos(s)),r):(o=zf(this.es),a=qf(this.es),l=Bf(this.es),c=Uf(this.es),Math.abs(this.sin_p12-1)<=ft?(h=this.a*Ji(o,a,l,c,st),u=this.a*Ji(o,a,l,c,e),r.x=this.x0+(h-u)*Math.sin(s),r.y=this.y0-(h-u)*Math.cos(s),r):Math.abs(this.sin_p12+1)<=ft?(h=this.a*Ji(o,a,l,c,st),u=this.a*Ji(o,a,l,c,e),r.x=this.x0+(h+u)*Math.sin(s),r.y=this.y0+(h+u)*Math.cos(s),r):Math.abs(t)<ft&&Math.abs(e-this.lat0)<ft?(r.x=r.y=0,r):(p=Bq(this.lat0,this.long0,e,t,this.a,this.f),m=p.azi1,r.x=p.s12*Math.sin(m),r.y=p.s12*Math.cos(m),r))}function Zq(r){r.x-=this.x0,r.y-=this.y0;var t,e,i,n,s,o,a,l,c,h,u,d,g,f,p,m;return this.sphere?(t=Math.sqrt(r.x*r.x+r.y*r.y),t>2*st*this.a?void 0:(e=t/this.a,i=Math.sin(e),n=Math.cos(e),s=this.long0,Math.abs(t)<=ft?o=this.lat0:(o=bl(n*this.sin_p12+r.y*i*this.cos_p12/t),a=Math.abs(this.lat0)-st,Math.abs(a)<=ft?this.lat0>=0?s=xt(this.long0+Math.atan2(r.x,-r.y),this.over):s=xt(this.long0-Math.atan2(-r.x,r.y),this.over):s=xt(this.long0+Math.atan2(r.x*i,t*this.cos_p12*n-r.y*this.sin_p12*i),this.over)),r.x=s,r.y=o,r)):(l=zf(this.es),c=qf(this.es),h=Bf(this.es),u=Uf(this.es),Math.abs(this.sin_p12-1)<=ft?(d=this.a*Ji(l,c,h,u,st),t=Math.sqrt(r.x*r.x+r.y*r.y),g=d-t,o=om(g/this.a,l,c,h,u),s=xt(this.long0+Math.atan2(r.x,-1*r.y),this.over),r.x=s,r.y=o,r):Math.abs(this.sin_p12+1)<=ft?(d=this.a*Ji(l,c,h,u,st),t=Math.sqrt(r.x*r.x+r.y*r.y),g=t-d,o=om(g/this.a,l,c,h,u),s=xt(this.long0+Math.atan2(r.x,r.y),this.over),r.x=s,r.y=o,r):(f=Math.atan2(r.x,r.y),p=Math.sqrt(r.x*r.x+r.y*r.y),m=Uq(this.lat0,this.long0,f,p,this.a,this.f),r.x=m.lon2,r.y=m.lat2,r))}var Hq=["Azimuthal_Equidistant","aeqd"];const Yq={init:Wq,forward:Vq,inverse:Zq,names:Hq};function Xq(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Kq(r){var t,e,i,n,s,o,a,l,c=r.x,h=r.y;return i=xt(c-this.long0,this.over),t=Math.sin(h),e=Math.cos(h),n=Math.cos(i),o=this.sin_p14*t+this.cos_p14*e*n,s=1,(o>0||Math.abs(o)<=ft)&&(a=this.a*s*e*Math.sin(i),l=this.y0+this.a*s*(this.cos_p14*t-this.sin_p14*e*n)),r.x=a,r.y=l,r}function Qq(r){var t,e,i,n,s,o,a;return r.x-=this.x0,r.y-=this.y0,t=Math.sqrt(r.x*r.x+r.y*r.y),e=bl(t/this.a),i=Math.sin(e),n=Math.cos(e),o=this.long0,Math.abs(t)<=ft?(a=this.lat0,r.x=o,r.y=a,r):(a=bl(n*this.sin_p14+r.y*i*this.cos_p14/t),s=Math.abs(this.lat0)-st,Math.abs(s)<=ft?(this.lat0>=0?o=xt(this.long0+Math.atan2(r.x,-r.y),this.over):o=xt(this.long0-Math.atan2(-r.x,r.y),this.over),r.x=o,r.y=a,r):(o=xt(this.long0+Math.atan2(r.x*i,t*this.cos_p14*n-r.y*this.sin_p14*i),this.over),r.x=o,r.y=a,r))}var Jq=["ortho"];const tB={init:Xq,forward:Kq,inverse:Qq,names:Jq};var Rr={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Ye={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function eB(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=st-He/2?this.face=Rr.TOP:this.lat0<=-(st-He/2)?this.face=Rr.BOTTOM:Math.abs(this.long0)<=He?this.face=Rr.FRONT:Math.abs(this.long0)<=st+He?this.face=this.long0>0?Rr.RIGHT:Rr.LEFT:this.face=Rr.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function rB(r){var t={x:0,y:0},e,i,n,s,o,a,l={value:0};if(r.x-=this.long0,this.es!==0?e=Math.atan(this.one_minus_f_squared*Math.tan(r.y)):e=r.y,i=r.x,this.face===Rr.TOP)s=st-e,i>=He&&i<=st+He?(l.value=Ye.AREA_0,n=i-st):i>st+He||i<=-(st+He)?(l.value=Ye.AREA_1,n=i>0?i-Wr:i+Wr):i>-(st+He)&&i<=-He?(l.value=Ye.AREA_2,n=i+st):(l.value=Ye.AREA_3,n=i);else if(this.face===Rr.BOTTOM)s=st+e,i>=He&&i<=st+He?(l.value=Ye.AREA_0,n=-i+st):i<He&&i>=-He?(l.value=Ye.AREA_1,n=-i):i<-He&&i>=-(st+He)?(l.value=Ye.AREA_2,n=-i-st):(l.value=Ye.AREA_3,n=i>0?-i+Wr:-i-Wr);else{var c,h,u,d,g,f,p;this.face===Rr.RIGHT?i=au(i,+st):this.face===Rr.BACK?i=au(i,+Wr):this.face===Rr.LEFT&&(i=au(i,-st)),d=Math.sin(e),g=Math.cos(e),f=Math.sin(i),p=Math.cos(i),c=g*p,h=g*f,u=d,this.face===Rr.FRONT?(s=Math.acos(c),n=Mp(s,u,h,l)):this.face===Rr.RIGHT?(s=Math.acos(h),n=Mp(s,u,-c,l)):this.face===Rr.BACK?(s=Math.acos(-c),n=Mp(s,u,-h,l)):this.face===Rr.LEFT?(s=Math.acos(-h),n=Mp(s,u,c,l)):(s=n=0,l.value=Ye.AREA_0)}return a=Math.atan(12/Wr*(n+Math.acos(Math.sin(n)*Math.cos(He))-st)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(n))))),l.value===Ye.AREA_1?a+=st:l.value===Ye.AREA_2?a+=Wr:l.value===Ye.AREA_3&&(a+=1.5*Wr),t.x=o*Math.cos(a),t.y=o*Math.sin(a),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,r.x=t.x,r.y=t.y,r}function iB(r){var t={lam:0,phi:0},e,i,n,s,o,a,l,c,h,u={value:0};if(r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,i=Math.atan(Math.sqrt(r.x*r.x+r.y*r.y)),e=Math.atan2(r.y,r.x),r.x>=0&&r.x>=Math.abs(r.y)?u.value=Ye.AREA_0:r.y>=0&&r.y>=Math.abs(r.x)?(u.value=Ye.AREA_1,e-=st):r.x<0&&-r.x>=Math.abs(r.y)?(u.value=Ye.AREA_2,e=e<0?e+Wr:e-Wr):(u.value=Ye.AREA_3,e+=st),h=Wr/12*Math.tan(e),o=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),a=Math.atan(o),n=Math.cos(e),s=Math.tan(i),l=1-n*n*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),l<-1?l=-1:l>1&&(l=1),this.face===Rr.TOP)c=Math.acos(l),t.phi=st-c,u.value===Ye.AREA_0?t.lam=a+st:u.value===Ye.AREA_1?t.lam=a<0?a+Wr:a-Wr:u.value===Ye.AREA_2?t.lam=a-st:t.lam=a;else if(this.face===Rr.BOTTOM)c=Math.acos(l),t.phi=c-st,u.value===Ye.AREA_0?t.lam=-a+st:u.value===Ye.AREA_1?t.lam=-a:u.value===Ye.AREA_2?t.lam=-a-st:t.lam=a<0?-a-Wr:-a+Wr;else{var d,g,f;d=l,h=d*d,h>=1?f=0:f=Math.sqrt(1-h)*Math.sin(a),h+=f*f,h>=1?g=0:g=Math.sqrt(1-h),u.value===Ye.AREA_1?(h=g,g=-f,f=h):u.value===Ye.AREA_2?(g=-g,f=-f):u.value===Ye.AREA_3&&(h=g,g=f,f=-h),this.face===Rr.RIGHT?(h=d,d=-g,g=h):this.face===Rr.BACK?(d=-d,g=-g):this.face===Rr.LEFT&&(h=d,d=g,g=-h),t.phi=Math.acos(-f)-st,t.lam=Math.atan2(g,d),this.face===Rr.RIGHT?t.lam=au(t.lam,-st):this.face===Rr.BACK?t.lam=au(t.lam,-Wr):this.face===Rr.LEFT&&(t.lam=au(t.lam,+st))}if(this.es!==0){var p,m,y;p=t.phi<0?1:0,m=Math.tan(t.phi),y=this.b/Math.sqrt(m*m+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-y*y)/(this.one_minus_f*y)),p&&(t.phi=-t.phi)}return t.lam+=this.long0,r.x=t.lam,r.y=t.phi,r}function Mp(r,t,e,i){var n;return r<ft?(i.value=Ye.AREA_0,n=0):(n=Math.atan2(t,e),Math.abs(n)<=He?i.value=Ye.AREA_0:n>He&&n<=st+He?(i.value=Ye.AREA_1,n-=st):n>st+He||n<=-(st+He)?(i.value=Ye.AREA_2,n=n>=0?n-Wr:n+Wr):(i.value=Ye.AREA_3,n+=st)),n}function au(r,t){var e=r+t;return e<-Wr?e+=Zg:e>+Wr&&(e-=Zg),e}var nB=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const sB={init:eB,forward:rB,inverse:iB,names:nB};var Hx=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],jd=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],SI=.8487,TI=1.3523,CI=wn/5,oB=1/CI,Zh=18,am=function(r,t){return r[0]+t*(r[1]+t*(r[2]+t*r[3]))},aB=function(r,t){return r[1]+t*(2*r[2]+t*3*r[3])};function lB(r,t,e,i){for(var n=t;i;--i){var s=r(n);if(n-=s,Math.abs(s)<e)break}return n}function cB(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function hB(r){var t=xt(r.x-this.long0,this.over),e=Math.abs(r.y),i=Math.floor(e*CI);i<0?i=0:i>=Zh&&(i=Zh-1),e=wn*(e-oB*i);var n={x:am(Hx[i],e)*t,y:am(jd[i],e)};return r.y<0&&(n.y=-n.y),n.x=n.x*this.a*SI+this.x0,n.y=n.y*this.a*TI+this.y0,n}function uB(r){var t={x:(r.x-this.x0)/(this.a*SI),y:Math.abs(r.y-this.y0)/(this.a*TI)};if(t.y>=1)t.x/=Hx[Zh][0],t.y=r.y<0?-st:st;else{var e=Math.floor(t.y*Zh);for(e<0?e=0:e>=Zh&&(e=Zh-1);;)if(jd[e][0]>t.y)--e;else if(jd[e+1][0]<=t.y)++e;else break;var i=jd[e],n=5*(t.y-i[0])/(jd[e+1][0]-i[0]);n=lB(function(s){return(am(i,s)-t.y)/aB(i,s)},n,ft,100),t.x/=am(Hx[e],n),t.y=(5*e+n)*$r,r.y<0&&(t.y=-t.y)}return t.x=xt(t.x+this.long0,this.over),t}var dB=["Robinson","robin"];const gB={init:cB,forward:hB,inverse:uB,names:dB};function fB(){this.name="geocent"}function pB(r){var t=fI(r,this.es,this.a);return t}function mB(r){var t=pI(r,this.es,this.a,this.b);return t}var yB=["Geocentric","geocentric","geocent","Geocent"];const _B={init:fB,forward:pB,inverse:mB,names:yB};var $i={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},kd={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function vB(){if(Object.keys(kd).forEach((function(e){if(typeof this[e]>"u")this[e]=kd[e].def;else{if(kd[e].num&&isNaN(this[e]))throw new Error("Invalid parameter value, must be numeric "+e+" = "+this[e]);kd[e].num&&(this[e]=parseFloat(this[e]))}kd[e].degrees&&(this[e]=this[e]*$r)}).bind(this)),Math.abs(Math.abs(this.lat0)-st)<ft?this.mode=this.lat0<0?$i.S_POLE:$i.N_POLE:Math.abs(this.lat0)<ft?this.mode=$i.EQUIT:(this.mode=$i.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var r=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(r),this.sw=Math.sin(r)}function xB(r){r.x-=this.long0;var t=Math.sin(r.y),e=Math.cos(r.y),i=Math.cos(r.x),n,s;switch(this.mode){case $i.OBLIQ:s=this.sinph0*t+this.cosph0*e*i;break;case $i.EQUIT:s=e*i;break;case $i.S_POLE:s=-t;break;case $i.N_POLE:s=t;break}switch(s=this.pn1/(this.p-s),n=s*e*Math.sin(r.x),this.mode){case $i.OBLIQ:s*=this.cosph0*t-this.sinph0*e*i;break;case $i.EQUIT:s*=t;break;case $i.N_POLE:s*=-(e*i);break;case $i.S_POLE:s*=e*i;break}var o,a;return o=s*this.cg+n*this.sg,a=1/(o*this.sw*this.h1+this.cw),n=(n*this.cg-s*this.sg)*this.cw*a,s=o*a,r.x=n*this.a,r.y=s*this.a,r}function wB(r){r.x/=this.a,r.y/=this.a;var t={x:r.x,y:r.y},e,i,n;n=1/(this.pn1-r.y*this.sw),e=this.pn1*r.x*n,i=this.pn1*r.y*this.cw*n,r.x=e*this.cg+i*this.sg,r.y=i*this.cg-e*this.sg;var s=_n(r.x,r.y);if(Math.abs(s)<ft)t.x=0,t.y=r.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case $i.OBLIQ:t.y=Math.asin(o*this.sinph0+r.y*a*this.cosph0/s),r.y=(o-this.sinph0*Math.sin(t.y))*s,r.x*=a*this.cosph0;break;case $i.EQUIT:t.y=Math.asin(r.y*a/s),r.y=o*s,r.x*=a;break;case $i.N_POLE:t.y=Math.asin(o),r.y=-r.y;break;case $i.S_POLE:t.y=-Math.asin(o);break}t.x=Math.atan2(r.x,r.y)}return r.x=t.x+this.long0,r.y=t.y,r}var bB=["Tilted_Perspective","tpers"];const kB={init:vB,forward:xB,inverse:wB,names:bB};function EB(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var r=1-this.es,t=1/r;this.radius_p=Math.sqrt(r),this.radius_p2=r,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function SB(r){var t=r.x,e=r.y,i,n,s,o;if(t=t-this.long0,this.shape==="ellipse"){e=Math.atan(this.radius_p2*Math.tan(e));var a=this.radius_p/_n(this.radius_p*Math.cos(e),Math.sin(e));if(n=a*Math.cos(t)*Math.cos(e),s=a*Math.sin(t)*Math.cos(e),o=a*Math.sin(e),(this.radius_g-n)*n-s*s-o*o*this.radius_p_inv2<0)return r.x=Number.NaN,r.y=Number.NaN,r;i=this.radius_g-n,this.flip_axis?(r.x=this.radius_g_1*Math.atan(s/_n(o,i)),r.y=this.radius_g_1*Math.atan(o/i)):(r.x=this.radius_g_1*Math.atan(s/i),r.y=this.radius_g_1*Math.atan(o/_n(s,i)))}else this.shape==="sphere"&&(i=Math.cos(e),n=Math.cos(t)*i,s=Math.sin(t)*i,o=Math.sin(e),i=this.radius_g-n,this.flip_axis?(r.x=this.radius_g_1*Math.atan(s/_n(o,i)),r.y=this.radius_g_1*Math.atan(o/i)):(r.x=this.radius_g_1*Math.atan(s/i),r.y=this.radius_g_1*Math.atan(o/_n(s,i))));return r.x=r.x*this.a,r.y=r.y*this.a,r}function TB(r){var t=-1,e=0,i=0,n,s,o,a;if(r.x=r.x/this.a,r.y=r.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(r.y/this.radius_g_1),e=Math.tan(r.x/this.radius_g_1)*_n(1,i)):(e=Math.tan(r.x/this.radius_g_1),i=Math.tan(r.y/this.radius_g_1)*_n(1,e));var l=i/this.radius_p;if(n=e*e+l*l+t*t,s=2*this.radius_g*t,o=s*s-4*n*this.C,o<0)return r.x=Number.NaN,r.y=Number.NaN,r;a=(-s-Math.sqrt(o))/(2*n),t=this.radius_g+a*t,e*=a,i*=a,r.x=Math.atan2(e,t),r.y=Math.atan(i*Math.cos(r.x)/t),r.y=Math.atan(this.radius_p_inv2*Math.tan(r.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(r.y/this.radius_g_1),e=Math.tan(r.x/this.radius_g_1)*Math.sqrt(1+i*i)):(e=Math.tan(r.x/this.radius_g_1),i=Math.tan(r.y/this.radius_g_1)*Math.sqrt(1+e*e)),n=e*e+i*i+t*t,s=2*this.radius_g*t,o=s*s-4*n*this.C,o<0)return r.x=Number.NaN,r.y=Number.NaN,r;a=(-s-Math.sqrt(o))/(2*n),t=this.radius_g+a*t,e*=a,i*=a,r.x=Math.atan2(e,t),r.y=Math.atan(i*Math.cos(r.x)/t)}return r.x=r.x+this.long0,r}var CB=["Geostationary Satellite View","Geostationary_Satellite","geos"];const MB={init:EB,forward:SB,inverse:TB,names:CB};var ng=1.340264,sg=-.081106,og=893e-6,ag=.003796,lm=Math.sqrt(3)/2;function RB(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function IB(r){var t=xt(r.x-this.long0,this.over),e=r.y,i=Math.asin(lm*Math.sin(e)),n=i*i,s=n*n*n;return r.x=t*Math.cos(i)/(lm*(ng+3*sg*n+s*(7*og+9*ag*n))),r.y=i*(ng+sg*n+s*(og+ag*n)),r.x=this.a*r.x+this.x0,r.y=this.a*r.y+this.y0,r}function PB(r){r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a;var t=1e-9,e=12,i=r.y,n,s,o,a,l,c;for(c=0;c<e&&(n=i*i,s=n*n*n,o=i*(ng+sg*n+s*(og+ag*n))-r.y,a=ng+3*sg*n+s*(7*og+9*ag*n),i-=l=o/a,!(Math.abs(l)<t));++c);return n=i*i,s=n*n*n,r.x=lm*r.x*(ng+3*sg*n+s*(7*og+9*ag*n))/Math.cos(i),r.y=Math.asin(Math.sin(i)/lm),r.x=xt(r.x+this.long0,this.over),r}var AB=["eqearth","Equal Earth","Equal_Earth"];const LB={init:RB,forward:IB,inverse:PB,names:AB};var Xg=1e-10;function OB(){var r;if(this.phi1=this.lat1,Math.abs(this.phi1)<Xg)throw new Error;this.es?(this.en=Fb(this.es),this.m1=Ku(this.phi1,this.am1=Math.sin(this.phi1),r=Math.cos(this.phi1),this.en),this.am1=r/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=NB,this.forward=FB):(Math.abs(this.phi1)+Xg>=st?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=$B,this.forward=DB)}function FB(r){var t=xt(r.x-(this.long0||0),this.over),e=r.y,i,n,s;return i=this.am1+this.m1-Ku(e,n=Math.sin(e),s=Math.cos(e),this.en),n=s*t/(i*Math.sqrt(1-this.es*n*n)),r.x=i*Math.sin(n),r.y=this.am1-i*Math.cos(n),r.x=this.a*r.x+(this.x0||0),r.y=this.a*r.y+(this.y0||0),r}function NB(r){r.x=(r.x-(this.x0||0))/this.a,r.y=(r.y-(this.y0||0))/this.a;var t,e,i,n;if(e=_n(r.x,r.y=this.am1-r.y),n=Nb(this.am1+this.m1-e,this.es,this.en),(t=Math.abs(n))<st)t=Math.sin(n),i=e*Math.atan2(r.x,r.y)*Math.sqrt(1-this.es*t*t)/Math.cos(n);else if(Math.abs(t-st)<=Xg)i=0;else throw new Error;return r.x=xt(i+(this.long0||0),this.over),r.y=Cl(n),r}function DB(r){var t=xt(r.x-(this.long0||0),this.over),e=r.y,i,n;return n=this.cphi1+this.phi1-e,Math.abs(n)>Xg?(r.x=n*Math.sin(i=t*Math.cos(e)/n),r.y=this.cphi1-n*Math.cos(i)):r.x=r.y=0,r.x=this.a*r.x+(this.x0||0),r.y=this.a*r.y+(this.y0||0),r}function $B(r){r.x=(r.x-(this.x0||0))/this.a,r.y=(r.y-(this.y0||0))/this.a;var t,e,i=_n(r.x,r.y=this.cphi1-r.y);if(e=this.cphi1+this.phi1-i,Math.abs(e)>st)throw new Error;return Math.abs(Math.abs(e)-st)<=Xg?t=0:t=i*Math.atan2(r.x,r.y)/Math.cos(e),r.x=xt(t+(this.long0||0),this.over),r.y=Cl(e),r}var GB=["bonne","Bonne (Werner lat_1=90)"];const jB={init:OB,names:GB},SC={OBLIQUE:{forward:WB,inverse:ZB},TRANSVERSE:{forward:VB,inverse:HB}},cm={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function zB(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=hI.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const r=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),t=os(r);if(!t)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);t.long0=0,this.obliqueProjection=t;let e;const i=Object.keys(cm),n=a=>{if(typeof this[a]>"u")return;const l=parseFloat(this[a])*$r;if(isNaN(l))throw new Error("Invalid value for "+a+": "+this[a]);return l};for(let a=0;a<i.length;a++){const l=i[a],c=cm[l],h=Object.entries(c);if(h.some(([u])=>typeof this[u]<"u")){e=c;for(let u=0;u<h.length;u++){const[d,g]=h[u],f=n(d);if(typeof f>"u")throw new Error("Missing parameter: "+d+".");this[g]=f}break}}if(!e)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=UB(this,e);this.lamp=s,Math.abs(o)>ft?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=SC.OBLIQUE):this.projectionType=SC.TRANSVERSE}function qB(r){return this.projectionType.forward(this,r)}function BB(r){return this.projectionType.inverse(this,r)}function UB(r,t){let e,i;if(t===cm.ROTATE){let n=r.oLongC,s=r.oLatC,o=r.oAlpha;if(Math.abs(Math.abs(s)-st)<=ft)throw new Error("Invalid value for o_lat_c: "+r.o_lat_c+" should be < 90Â°");i=n+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),e=Math.asin(Math.cos(s)*Math.sin(o))}else if(t===cm.NEW_POLE)i=r.oLongP,e=r.oLatP;else{let n=r.oLong1,s=r.oLat1,o=r.oLong2,a=r.oLat2,l=Math.abs(s);if(Math.abs(s)>st-ft)throw new Error("Invalid value for o_lat_1: "+r.o_lat_1+" should be < 90Â°");if(Math.abs(a)>st-ft)throw new Error("Invalid value for o_lat_2: "+r.o_lat_2+" should be < 90Â°");if(Math.abs(s-a)<ft)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<ft)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");i=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(n)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(n)),e=Math.atan(-1*Math.cos(i-n)/Math.tan(s))}return{lamp:i,phip:e}}function WB(r,t){let{x:e,y:i}=t;e+=r.long0;const n=Math.cos(e),s=Math.sin(i),o=Math.cos(i);t.x=xt(Math.atan2(o*Math.sin(e),r.sphip*o*n+r.cphip*s)+r.lamp),t.y=Math.asin(r.sphip*s-r.cphip*o*n);const a=r.obliqueProjection.forward(t);return r.isIdentity&&(a.x*=wn,a.y*=wn),a}function VB(r,t){let{x:e,y:i}=t;e+=r.long0;const n=Math.cos(i),s=Math.cos(e);t.x=xt(Math.atan2(n*Math.sin(e),Math.sin(i))+r.lamp),t.y=Math.asin(-1*n*s);const o=r.obliqueProjection.forward(t);return r.isIdentity&&(o.x*=wn,o.y*=wn),o}function ZB(r,t){r.isIdentity&&(t.x*=$r,t.y*=$r);const e=r.obliqueProjection.inverse(t);let{x:i,y:n}=e;if(i<Number.MAX_VALUE){i-=r.lamp;const s=Math.cos(i),o=Math.sin(n),a=Math.cos(n);t.x=Math.atan2(a*Math.sin(i),r.sphip*a*s-r.cphip*o),t.y=Math.asin(r.sphip*o+r.cphip*a*s)}return t.x=xt(t.x+r.long0),t}function HB(r,t){r.isIdentity&&(t.x*=$r,t.y*=$r);const e=r.obliqueProjection.inverse(t);let{x:i,y:n}=e;if(i<Number.MAX_VALUE){const s=Math.cos(n);i-=r.lamp,t.x=Math.atan2(s*Math.sin(i),-1*Math.sin(n)),t.y=Math.asin(s*Math.cos(i))}return t.x=xt(t.x+r.long0),t}var YB=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const XB={init:zB,forward:qB,inverse:BB,names:YB};function KB(r){r.Proj.projections.add(x0),r.Proj.projections.add(w0),r.Proj.projections.add(Gj),r.Proj.projections.add(Hj),r.Proj.projections.add(Jj),r.Proj.projections.add(nz),r.Proj.projections.add(hz),r.Proj.projections.add(pz),r.Proj.projections.add(xz),r.Proj.projections.add(Sz),r.Proj.projections.add($z),r.Proj.projections.add(Uz),r.Proj.projections.add(Yz),r.Proj.projections.add(eq),r.Proj.projections.add(oq),r.Proj.projections.add(uq),r.Proj.projections.add(mq),r.Proj.projections.add(wq),r.Proj.projections.add(Cq),r.Proj.projections.add(Aq),r.Proj.projections.add(Dq),r.Proj.projections.add(qq),r.Proj.projections.add(Yq),r.Proj.projections.add(tB),r.Proj.projections.add(sB),r.Proj.projections.add(gB),r.Proj.projections.add(_B),r.Proj.projections.add(kB),r.Proj.projections.add(MB),r.Proj.projections.add(LB),r.Proj.projections.add(jB),r.Proj.projections.add(XB)}const as=Object.assign(rj,{defaultDatum:"WGS84",Proj:os,WGS84:new os("WGS84"),Point:Ou,toPoint:mI,defs:Si,nadgrid:$9,transform:sm,mgrs:ij,version:"__VERSION__"});KB(as);let QB=Vi.showGeographicIdentifier;function Rp(){return QB}let MI=Vi.gazetteerUrl;function RI(r){r&&(MI=r)}function JB(){return MI}function N1(r,t){const e=(""+r).split("."),i=(""+t).split(".");for(let n=0;n<Math.max(e.length,i.length);n++){const s=parseInt(e[n]||"0",10),o=parseInt(i[n]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}let Hh=[];function tU(r=Vi.layerConf,t){if(Array.isArray(r)){if(Hh=r,typeof t=="function"){t(Hh);return}return}fetch(r,{method:"GET",timeout:1e4}).then(e=>{e.json().then(i=>(Hh=i,typeof t=="function"?t(Hh):!0)).catch(i=>(console.error("An error occured when parsing the response after loading '"+r+"':",i),t(!1,i)))}).catch(e=>{console.error("An error occured when trying to fetch services from '"+r+"':",e),t(!1,e)})}function II(r){const t=Object.keys(r);return Hh.find(e=>t.every(i=>e[i]===r[i]))||null}function eU(){return Hh}function rU(r,t){const e=II({id:r});if(e&&typeof t=="string"){const i=e.gfiAttributes&&e.gfiAttributes[t];return typeof i=="string"?i:null}else if(e)return e.gfiAttributes||null;return null}const Ml={getLayerWhere:II,getDisplayNamesOfFeatureAttributes:rU,initializeLayerList:tU,getLayerList:eU};function Re(r,t){if(!r)throw new Error(t)}const PI=new Array(6);function rn(){return[1,0,0,1,0,0]}function TC(r){return Bb(r,1,0,0,1,0,0)}function qb(r,t){const e=r[0],i=r[1],n=r[2],s=r[3],o=r[4],a=r[5],l=t[0],c=t[1],h=t[2],u=t[3],d=t[4],g=t[5];return r[0]=e*l+n*c,r[1]=i*l+s*c,r[2]=e*h+n*u,r[3]=i*h+s*u,r[4]=e*d+n*g+o,r[5]=i*d+s*g+a,r}function Bb(r,t,e,i,n,s,o){return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r[4]=s,r[5]=o,r}function iU(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r}function Qr(r,t){const e=t[0],i=t[1];return t[0]=r[0]*e+r[2]*i+r[4],t[1]=r[1]*e+r[3]*i+r[5],t}function k0(r,t,e){return qb(r,Bb(PI,t,0,0,e,0,0))}function nU(r,t,e){return qb(r,Bb(PI,1,0,0,1,t,e))}function bo(r,t,e,i,n,s,o,a){const l=Math.sin(s),c=Math.cos(s);return r[0]=i*c,r[1]=n*l,r[2]=-i*l,r[3]=n*c,r[4]=o*i*c-a*i*l+t,r[5]=o*n*l+a*n*c+e,r}function AI(r,t){const e=sU(t);Re(e!==0,"Transformation matrix cannot be inverted");const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],l=t[5];return r[0]=o/e,r[1]=-n/e,r[2]=-s/e,r[3]=i/e,r[4]=(s*l-o*a)/e,r[5]=-(i*l-n*a)/e,r}function sU(r){return r[0]*r[3]-r[1]*r[2]}const oU=[1e5,1e5,1e5,1e5,2,2];function aU(r){return"matrix("+r.join(", ")+")"}function Yx(r){return r.substring(7,r.length-1).split(",").map(parseFloat)}function lU(r,t){const e=Yx(r),i=Yx(t);for(let n=0;n<6;++n)if(Math.round((e[n]-i[n])*oU[n])!==0)return!1;return!0}function gl(r,t,e,i,n,s,o){s=s||[],o=o||2;let a=0;for(let l=t;l<e;l+=i){const c=r[l],h=r[l+1];s[a++]=n[0]*c+n[2]*h+n[4],s[a++]=n[1]*c+n[3]*h+n[5];for(let u=2;u<o;u++)s[a++]=r[l+u]}return s&&s.length!=a&&(s.length=a),s}function Ub(r,t,e,i,n,s,o){o=o||[];const a=Math.cos(n),l=Math.sin(n),c=s[0],h=s[1];let u=0;for(let d=t;d<e;d+=i){const g=r[d]-c,f=r[d+1]-h;o[u++]=c+g*a-f*l,o[u++]=h+g*l+f*a;for(let p=d+2;p<d+i;++p)o[u++]=r[p]}return o&&o.length!=u&&(o.length=u),o}function cU(r,t,e,i,n,s,o,a){a=a||[];const l=o[0],c=o[1];let h=0;for(let u=t;u<e;u+=i){const d=r[u]-l,g=r[u+1]-c;a[h++]=l+n*d,a[h++]=c+s*g;for(let f=u+2;f<u+i;++f)a[h++]=r[f]}return a&&a.length!=h&&(a.length=h),a}function hU(r,t,e,i,n,s,o){o=o||[];let a=0;for(let l=t;l<e;l+=i){o[a++]=r[l]+n,o[a++]=r[l+1]+s;for(let c=l+2;c<l+i;++c)o[a++]=r[c]}return o&&o.length!=a&&(o.length=a),o}const CC=rn(),uU=[NaN,NaN];let Kg=class extends zs{constructor(){super(),this.extent_=nn(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=LM((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return te()}closestPointXY(t,e,i,n){return te()}containsXY(t,e){return this.closestPointXY(t,e,uU,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return te()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Uu(e),this.extentRevision_=this.getRevision()}return EO(this.extent_,t)}rotate(t,e){te()}scale(t,e,i){te()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return te()}getType(){return te()}applyTransform(t){te()}intersectsExtent(t){return te()}translate(t,e){te()}transform(t,e){const i=ee(t),n=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),c=i.getWorldExtent(),h=Ar(c)/Ar(l);bo(CC,c[0],c[3],h,-h,0,0,0);const u=gl(s,0,s.length,a,CC,o),d=yo(i,e);return d?d(u,u,a):u}:yo(i,e);return this.applyTransform(n),this}},ya=class extends Kg{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return mw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return te()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=hm(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){te()}setLayout(t,e,i){let n;if(t)n=hm(t);else{for(let s=0;s<i;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}n=e.length,t=Yc(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Ub(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=Wi(this.getExtent()));const n=this.getFlatCoordinates();if(n){const s=this.getStride();cU(n,0,n.length,s,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();hU(i,0,i.length,n,t,e,i),this.changed()}}};function Yc(r){let t;return r==2?t="XY":r==3?t="XYZ":r==4&&(t="XYZM"),t}function hm(r){let t;return r=="XY"?t=2:r=="XYZ"||r=="XYM"?t=3:r=="XYZM"&&(t=4),t}function dU(r,t,e){const i=r.getFlatCoordinates();if(!i)return null;const n=r.getStride();return gl(i,0,i.length,n,t,e)}function LI(r,t,e,i){for(let n=0,s=e.length;n<s;++n)r[t++]=e[n];return t}function D1(r,t,e,i){for(let n=0,s=e.length;n<s;++n){const o=e[n];for(let a=0;a<i;++a)r[t++]=o[a]}return t}function Wf(r,t,e,i,n){n=n||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=D1(r,t,e[o],i);n[s++]=l,t=l}return n.length=s,n}function OI(r,t,e,i,n){n=n||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=Wf(r,t,e[o],i,n[s]);l.length===0&&(l[0]=t),n[s++]=l,t=l[l.length-1]}return n.length=s,n}let Pi=class FI extends ya{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new FI(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const s=this.flatCoordinates,o=Zo(t,e,s[0],s[1]);if(o<n){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return tu(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return pw(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=LI(this.flatCoordinates,0,t,this.stride),this.changed()}},zi=class NI extends zs{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new NI(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(sr(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=Oe(t,Vt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?gU(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function gU(r){if(typeof r=="function")return r;let t;return Array.isArray(r)?t=r:(Re(typeof r.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[r]),function(){return t}}function DI(r,t,e,i){let n=0;const s=r[e-i],o=r[e-i+1];let a=0,l=0;for(;t<e;t+=i){const c=r[t]-s,h=r[t+1]-o;n+=l*c-a*h,a=c,l=h}return n/2}function $I(r,t,e,i){let n=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];n+=DI(r,t,a,i),t=a}return n}function fU(r,t,e,i){let n=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];n+=$I(r,t,a,i),t=a[a.length-1]}return n}function MC(r,t,e,i,n,s,o){const a=r[t],l=r[t+1],c=r[e]-a,h=r[e+1]-l;let u;if(c===0&&h===0)u=t;else{const d=((n-a)*c+(s-l)*h)/(c*c+h*h);if(d>1)u=e;else if(d>0){for(let g=0;g<i;++g)o[g]=Rn(r[t+g],r[e+g],d);o.length=i;return}else u=t}for(let d=0;d<i;++d)o[d]=r[u+d];o.length=i}function Wb(r,t,e,i,n){let s=r[t],o=r[t+1];for(t+=i;t<e;t+=i){const a=r[t],l=r[t+1],c=Zo(s,o,a,l);c>n&&(n=c),s=a,o=l}return n}function Vb(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){const a=e[s];n=Wb(r,t,a,i,n),t=a}return n}function pU(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){const a=e[s];n=Vb(r,t,a,i,n),t=a[a.length-1]}return n}function Zb(r,t,e,i,n,s,o,a,l,c,h){if(t==e)return c;let u,d;if(n===0){if(d=Zo(o,a,r[t],r[t+1]),d<c){for(u=0;u<i;++u)l[u]=r[t+u];return l.length=i,d}return c}h=h||[NaN,NaN];let g=t+i;for(;g<e;)if(MC(r,g-i,g,i,o,a,h),d=Zo(o,a,h[0],h[1]),d<c){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i,g+=i}else g+=i*Math.max((Math.sqrt(d)-Math.sqrt(c))/n|0,1);if(s&&(MC(r,e-i,t,i,o,a,h),d=Zo(o,a,h[0],h[1]),d<c)){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i}return c}function Hb(r,t,e,i,n,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const g=e[u];c=Zb(r,t,g,i,n,s,o,a,l,c,h),t=g}return c}function mU(r,t,e,i,n,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const g=e[u];c=Hb(r,t,g,i,n,s,o,a,l,c,h),t=g[g.length-1]}return c}function el(r,t,e,i,n){n=n!==void 0?n:[];let s=0;for(let o=t;o<e;o+=i)n[s++]=r.slice(o,o+i);return n.length=s,n}function Qg(r,t,e,i,n){n=n!==void 0?n:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];n[s++]=el(r,t,l,i,n[s]),t=l}return n.length=s,n}function Xx(r,t,e,i,n){n=n!==void 0?n:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];n[s++]=l.length===1&&l[0]===t?[]:Qg(r,t,l,i,n[s]),t=l[l.length-1]}return n.length=s,n}function $1(r,t,e,i,n,s,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)s[o++]=r[t],s[o++]=r[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[t,e-i];let h=0;for(;c.length>0;){const u=c.pop(),d=c.pop();let g=0;const f=r[d],p=r[d+1],m=r[u],y=r[u+1];for(let _=d+i;_<u;_+=i){const x=r[_],v=r[_+1],w=TO(x,v,f,p,m,y);w>g&&(h=_,g=w)}g>n&&(l[(h-t)/i]=1,d+i<h&&c.push(d,h),h+i<u&&c.push(h,u))}for(let u=0;u<a;++u)l[u]&&(s[o++]=r[t+u*i],s[o++]=r[t+u*i+1]);return o}function GI(r,t,e,i,n,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=$1(r,t,h,i,n,s,o),a.push(o),t=h}return o}function ql(r,t){return t*Math.round(r/t)}function yU(r,t,e,i,n,s,o){if(t==e)return o;let a=ql(r[t],n),l=ql(r[t+1],n);t+=i,s[o++]=a,s[o++]=l;let c,h;do if(c=ql(r[t],n),h=ql(r[t+1],n),t+=i,t==e)return s[o++]=c,s[o++]=h,o;while(c==a&&h==l);for(;t<e;){const u=ql(r[t],n),d=ql(r[t+1],n);if(t+=i,u==c&&d==h)continue;const g=c-a,f=h-l,p=u-a,m=d-l;if(g*m==f*p&&(g<0&&p<g||g==p||g>0&&p>g)&&(f<0&&m<f||f==m||f>0&&m>f)){c=u,h=d;continue}s[o++]=c,s[o++]=h,a=c,l=h,c=u,h=d}return s[o++]=c,s[o++]=h,o}function Yb(r,t,e,i,n,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=yU(r,t,h,i,n,s,o),a.push(o),t=h}return o}function _U(r,t,e,i,n,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l],u=[];o=Yb(r,t,h,i,n,s,o,u),a.push(u),t=h[h.length-1]}return o}let um=class Kx extends ya{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Kx(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<qc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Zb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return DI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return el(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=$1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Kx(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=D1(this.flatCoordinates,0,t,this.stride),this.changed()}};function vU(r,t,e,i,n){return!_w(n,function(s){return!tc(r,t,e,i,s[0],s[1])})}function tc(r,t,e,i,n,s){let o=0,a=r[e-i],l=r[e-i+1];for(;t<e;t+=i){const c=r[t],h=r[t+1];l<=s?h>s&&(c-a)*(s-l)-(n-a)*(h-l)>0&&o++:h<=s&&(c-a)*(s-l)-(n-a)*(h-l)<0&&o--,a=c,l=h}return o!==0}function Xb(r,t,e,i,n,s){if(e.length===0||!tc(r,t,e[0],i,n,s))return!1;for(let o=1,a=e.length;o<a;++o)if(tc(r,e[o-1],e[o],i,n,s))return!1;return!0}function xU(r,t,e,i,n,s){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const l=e[o];if(Xb(r,t,l,i,n,s))return!0;t=l[l.length-1]}return!1}function Kb(r,t,e,i,n,s,o){let a,l,c,h,u,d,g;const f=n[s+1],p=[];for(let _=0,x=e.length;_<x;++_){const v=e[_];for(h=r[v-i],d=r[v-i+1],a=t;a<v;a+=i)u=r[a],g=r[a+1],(f<=d&&g<=f||d<=f&&f<=g)&&(c=(f-d)/(g-d)*(u-h)+h,p.push(c)),h=u,d=g}let m=NaN,y=-1/0;for(p.sort(oo),h=p[0],a=1,l=p.length;a<l;++a){u=p[a];const _=Math.abs(u-h);_>y&&(c=(h+u)/2,Xb(r,t,e,i,c,f)&&(m=c,y=_)),h=u}return isNaN(m)&&(m=n[s]),o?(o.push(m,f,y),o):[m,f,y]}function jI(r,t,e,i,n){let s=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];s=Kb(r,t,l,i,n,2*o,s),t=l[l.length-1]}return s}function zI(r,t,e,i,n){let s;for(t+=i;t<e;t+=i)if(s=n(r.slice(t-i,t),r.slice(t,t+i)),s)return s;return!1}function G1(r,t,e,i,n,s){return s=s??FM(nn(),r,t,e,i),wr(n,s)?s[0]>=n[0]&&s[2]<=n[2]||s[1]>=n[1]&&s[3]<=n[3]?!0:zI(r,t,e,i,function(o,a){return SO(n,o,a)}):!1}function wU(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){if(G1(r,t,e[s],i,n))return!0;t=e[s]}return!1}function qI(r,t,e,i,n){return!!(G1(r,t,e,i,n)||tc(r,t,e,i,n[0],n[1])||tc(r,t,e,i,n[0],n[3])||tc(r,t,e,i,n[2],n[1])||tc(r,t,e,i,n[2],n[3]))}function BI(r,t,e,i,n){if(!qI(r,t,e[0],i,n))return!1;if(e.length===1)return!0;for(let s=1,o=e.length;s<o;++s)if(vU(r,e[s-1],e[s],i,n)&&!G1(r,e[s-1],e[s],i,n))return!1;return!0}function bU(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(BI(r,t,a,i,n))return!0;t=a[a.length-1]}return!1}function kU(r,t,e,i){for(;t<e-i;){for(let n=0;n<i;++n){const s=r[t+n];r[t+n]=r[e-i+n],r[e-i+n]=s}t+=i,e-=i}}function Qb(r,t,e,i){let n=0,s=r[e-i],o=r[e-i+1];for(;t<e;t+=i){const a=r[t],l=r[t+1];n+=(a-s)*(l+o),s=a,o=l}return n===0?void 0:n>0}function Jb(r,t,e,i,n){n=n!==void 0?n:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=Qb(r,t,a,i);if(s===0){if(n&&l||!n&&!l)return!1}else if(n&&!l||!n&&l)return!1;t=a}return!0}function UI(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!Jb(r,t,a,i,n))return!1;a.length&&(t=a[a.length-1])}return!0}function dm(r,t,e,i,n){n=n!==void 0?n:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=Qb(r,t,a,i);(s===0?n&&l||!n&&!l:n&&!l||!n&&l)&&kU(r,t,a,i),t=a}return t}function Qx(r,t,e,i,n){for(let s=0,o=e.length;s<o;++s)t=dm(r,t,e[s],i,n);return t}function WI(r,t){const e=[];let i=0,n=0,s;for(let o=0,a=t.length;o<a;++o){const l=t[o],c=Qb(r,i,l,2);if(s===void 0&&(s=c),c===s)e.push(t.slice(n,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[n])}n=o+1,i=l}return e}let gs=class Jx extends ya{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?wi(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Jx(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<qc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Vb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Hb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return Xb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return $I(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),dm(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Qg(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Wi(this.getExtent());this.flatInteriorPoint_=Kb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Pi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new um(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=new um(e.slice(s,l),t);n.push(c),s=l}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Jb(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=dm(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Yb(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Jx(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return BI(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Wf(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}};function EU(r,t,e,i){e=e||32;const n=[];for(let s=0;s<e;++s)wi(n,MO(r,t,2*Math.PI*s/e,i));return n.push(n[0],n[1]),new gs(n,"XY",[n.length])}function RC(r){if(Bc(r))throw new Error("Cannot create polygon from empty extent");const t=r[0],e=r[1],i=r[2],n=r[3],s=[t,e,t,n,i,n,i,e,t,e];return new gs(s,"XY",[s.length])}function gm(r,t,e,i,n,s,o){let a,l;const c=(e-t)/i;if(c===1)a=t;else if(c===2)a=t,l=n;else if(c!==0){let h=r[t],u=r[t+1],d=0;const g=[0];for(let m=t+i;m<e;m+=i){const y=r[m],_=r[m+1];d+=Math.sqrt((y-h)*(y-h)+(_-u)*(_-u)),g.push(d),h=y,u=_}const f=n*d,p=mO(g,f);p<0?(l=(f-g[-p-2])/(g[-p-1]-g[-p-2]),a=t+(-p-2)*i):a=t+p*i}o=o>1?o:2,s=s||new Array(o);for(let h=0;h<o;++h)s[h]=a===void 0?NaN:l===void 0?r[a+h]:Rn(r[a+h],r[a+i+h],l);return s}function t2(r,t,e,i,n,s){if(e==t)return null;let o;if(n<r[t+i-1])return s?(o=r.slice(t,t+i),o[i-1]=n,o):null;if(r[e-1]<n)return s?(o=r.slice(e-i,e),o[i-1]=n,o):null;if(n==r[t+i-1])return r.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const d=a+l>>1;n<r[(d+1)*i-1]?l=d:a=d+1}const c=r[a*i-1];if(n==c)return r.slice((a-1)*i,(a-1)*i+i);const h=r[(a+1)*i-1],u=(n-c)/(h-c);o=[];for(let d=0;d<i-1;++d)o.push(Rn(r[(a-1)*i+d],r[a*i+d],u));return o.push(n),o}function SU(r,t,e,i,n,s,o){if(o)return t2(r,t,e[e.length-1],i,n,s);let a;if(n<r[i-1])return s?(a=r.slice(0,i),a[i-1]=n,a):null;if(r[r.length-1]<n)return s?(a=r.slice(r.length-i),a[i-1]=n,a):null;for(let l=0,c=e.length;l<c;++l){const h=e[l];if(t!=h){if(n<r[t+i-1])return null;if(n<=r[h-1])return t2(r,t,h,i,n,!1);t=h}}return null}function tk(r,t,e,i){let n=r[t],s=r[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=r[a],c=r[a+1];o+=Math.sqrt((l-n)*(l-n)+(c-s)*(c-s)),n=l,s=c}return o}function VI(r,t,e,i){const n=[];let s=nn();for(let o=0,a=e.length;o<a;++o){const l=e[o];s=mw(r,t,l[0],i),n.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=l[l.length-1]}return n}const IC=rn();let Gi=class e2{constructor(t,e,i,n,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?tu(this.flatCoordinates_):mw(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=Wi(this.getExtent());this.flatInteriorPoints_=Kb(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=WI(this.flatCoordinates_,this.ends_),e=VI(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=jI(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=gm(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,s=i.length;n<s;++n){const o=i[n],a=gm(t,e,o,2,.5);wi(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=ee(t);const e=t.getExtent(),i=t.getWorldExtent();if(e&&i){const n=Ar(i)/Ar(e);bo(IC,i[0],i[3],n,-n,0,0,0),gl(this.flatCoordinates_,0,this.flatCoordinates_.length,2,IC,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new e2(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=LM((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=$1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=GI(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=Yb(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n);break}return n&&(this.simplifiedGeometry_=new e2(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}};Gi.prototype.getFlatCoordinates=Gi.prototype.getOrientedFlatCoordinates;function ZI(r){return Ct(()=>(ar().language,r()))}const TU="modulepreload",CU=function(r,t){return new URL(r,t).href},PC={},Es=function(t,e,i){let n=Promise.resolve();if(e&&e.length>0){let c=function(h){return Promise.all(h.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");n=c(e.map(h=>{if(h=CU(h,i),h in PC)return;PC[h]=!0;const u=h.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(i)for(let f=o.length-1;f>=0;f--){const p=o[f];if(p.href===h&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${d}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":TU,u||(g.as="script"),g.crossOrigin="",g.href=h,l&&g.setAttribute("nonce",l),document.head.appendChild(g),u)return new Promise((f,p)=>{g.addEventListener("load",f),g.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})},Jg="toast",ek=Sl("plugins/toast",()=>{const r=ar(),t=Ct(()=>r.configuration[Jg]),e=me([]);function i(s,o){const a=Lr({timeout:s.severity==="error"?null:5e3},o||{});s.theme=Lr(t.value[s.severity]||{},s.theme||{});const l={toast:s};e.value.push(l),typeof a.timeout=="number"&&(l.timeout=setTimeout(()=>n(s),a.timeout))}function n(s){const o=e.value.findIndex(l=>to(l.toast)===to(s));if(o<0)return!1;const[a]=e.value.splice(o,1);return a?.timeout&&clearTimeout(a.timeout),!0}return{toasts:Ct(()=>e.value.map(({toast:s})=>s)),addToast:i,removeToast:n}});if(import.meta.vitest){const{expect:r,test:t,vi:e}=import.meta.vitest,{createPinia:i,setActivePinia:n}=await Es(async()=>{const{createPinia:l,setActivePinia:c}=await import("./pinia-DFMOV6lD-BZLsqLPB.js");return{createPinia:l,setActivePinia:c}},__vite__mapDeps([0,1]),import.meta.url),{reactive:s}=await Es(async()=>{const{reactive:l}=await import("./vue.runtime.esm-bundler-CYHrvVzW-BTeeWO83.js");return{reactive:l}},[],import.meta.url),o=await Es(()=>import("./indicateLoading-C_uppgjV-DVX-YvQI.js").then(l=>l.s),__vite__mapDeps([2,0,1,3]),import.meta.url),a=t.extend({coreStore:[async({},l)=>{const c=s({configuration:{[Jg]:{}}});e.spyOn(o,"useCoreStore").mockReturnValue(c),await l(c)},{auto:!0}],store:async({},l)=>{n(i());const c=ek();await l(c)},timer:[async({},l)=>{e.useFakeTimers(),await l(null),e.resetAllMocks()},{auto:!0}]});a("Toast can be added and safely removed",({store:l})=>{const c={text:"TOAST",severity:"error"};l.addToast(c),r(l.toasts.length).toBe(1),r(to(l.toasts[0])).toEqual(c),r(l.removeToast(c)).toBe(!0),r(l.toasts.length).toBe(0),r(l.removeToast(c)).toBe(!1)}),a.for([{severity:"error",timeout:null},{severity:"warning",timeout:5},{severity:"info",timeout:5},{severity:"success",timeout:5}])("Toast with severity $severity is automatically removed after $timeout seconds (null = never)",({severity:l,timeout:c},{store:h})=>{h.addToast({text:"TOAST",severity:l}),c?(e.advanceTimersByTime(c*1e3-1),r(h.toasts.length).toBe(1),e.advanceTimersByTime(1),r(h.toasts.length).toBe(0)):(e.runAllTimers(),r(h.toasts.length).toBe(1))}),a.for([{config:{color:"SC",icon:"SI"},options:{icon:"OI"},result:{color:"SC",icon:"OI"}},{config:{icon:"SI"},options:{},result:{icon:"SI"}}])("Toast consideres theme settings in the right precedence",({config:l,options:c,result:h},{coreStore:u,store:d})=>{u.configuration[Jg].info=l,d.addToast({text:"TEXT",severity:"info",theme:c}),r(d.toasts.length).toBe(1),r(d.toasts[0]?.theme).toEqual(h)})}const Jr={ADD:"add",REMOVE:"remove"},AC={LENGTH:"length"};let Ip=class extends on{constructor(t,e,i){super(t),this.element=e,this.index=i}},xi=class extends zs{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t??[],this.unique_)for(let i=1,n=this.array_.length;i<n;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(AC.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ip(Jr.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ip(Jr.REMOVE,e,t)),e}setAt(t,e){const i=this.getLength();if(t>=i){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ip(Jr.REMOVE,n,t)),this.dispatchEvent(new Ip(Jr.ADD,e,t))}updateLength_(){this.set(AC.LENGTH,this.array_.length)}assertUnique_(t,e){const i=this.array_;for(let n=0,s=i.length;n<s;++n)if(i[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}};const Qn={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},St={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},rk=[NaN,NaN,NaN,0];let R_;function MU(){return R_||(R_=Or(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),R_}const RU=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,IU=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,PU=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,AU=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Pp(r,t){return r.endsWith("%")?Number(r.substring(0,r.length-1))/t:Number(r)}function lg(r){throw new Error('failed to parse "'+r+'" as color')}function HI(r){if(r.toLowerCase().startsWith("rgb")){const s=r.match(IU)||r.match(RU)||r.match(PU);if(s){const o=s[4],a=100/255;return[kr(Pp(s[1],a)+.5|0,0,255),kr(Pp(s[2],a)+.5|0,0,255),kr(Pp(s[3],a)+.5|0,0,255),o!==void 0?kr(Pp(o,100),0,1):1]}lg(r)}if(r.startsWith("#")){if(AU.test(r)){const s=r.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let h=parseInt(s.substring(l,l+o),16);o===1&&(h+=h<<4),a[l/o]=h}return a[3]=a[3]/255,a}lg(r)}const t=MU();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=r,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=r,t.fillStyle===e&&lg(r));const i=t.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return HI(i);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const n=Array.from(t.getImageData(0,0,1,1).data);return n[3]=Wu(n[3]/255,3),n}function LU(r){return typeof r=="string"?r:nk(r)}const OU=1024,Ed={};let I_=0;function FU(r){if(r.length===4)return r;const t=r.slice();return t[3]=1,t}function P_(r){return r>.0031308?Math.pow(r,1/2.4)*269.025-14.025:r*3294.6}function A_(r){return r>.2068965?Math.pow(r,3):(r-4/29)*(108/841)}function L_(r){return r>10.314724?Math.pow((r+14.025)/269.025,2.4):r/3294.6}function O_(r){return r>.0088564?Math.pow(r,1/3):r/(108/841)+4/29}function LC(r){const t=L_(r[0]),e=L_(r[1]),i=L_(r[2]),n=O_(t*.222488403+e*.716873169+i*.06060791),s=500*(O_(t*.452247074+e*.399439023+i*.148375274)-n),o=200*(n-O_(t*.016863605+e*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*n-16,Math.sqrt(s*s+o*o),a<0?a+360:a,r[3]]}function NU(r){const t=(r[0]+16)/116,e=r[1],i=r[2]*Math.PI/180,n=A_(t),s=A_(t+e/500*Math.cos(i)),o=A_(t-e/200*Math.sin(i)),a=P_(s*3.021973625-n*1.617392459-o*.404875592),l=P_(s*-.943766287+n*1.916279586+o*.027607165),c=P_(s*.069407491-n*.22898585+o*1.159737864);return[kr(a+.5|0,0,255),kr(l+.5|0,0,255),kr(c+.5|0,0,255),r[3]]}function ik(r){if(r==="none")return rk;if(Ed.hasOwnProperty(r))return Ed[r];if(I_>=OU){let e=0;for(const i in Ed)(e++&3)===0&&(delete Ed[i],--I_)}const t=HI(r);t.length!==4&&lg(r);for(const e of t)isNaN(e)&&lg(r);return Ed[r]=t,++I_,t}function Fu(r){return Array.isArray(r)?r:ik(r)}function nk(r){let t=r[0];t!=(t|0)&&(t=t+.5|0);let e=r[1];e!=(e|0)&&(e=e+.5|0);let i=r[2];i!=(i|0)&&(i=i+.5|0);const n=r[3]===void 0?1:Math.round(r[3]*1e3)/1e3;return"rgba("+t+","+e+","+i+","+n+")"}let j1=class extends kf{constructor(t,e,i,n){super(),this.extent=t,this.pixelRatio_=i,this.resolution=e,this.state=typeof n=="function"?St.IDLE:n,this.image_=null,this.loader=typeof n=="function"?n:null}changed(){this.dispatchEvent(Vt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==St.IDLE&&this.loader){this.state=St.LOADING,this.changed();const t=this.getResolution(),e=Array.isArray(t)?t[0]:t;xu(()=>this.loader(this.getExtent(),e,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||QM&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=St.LOADED}).catch(i=>{this.state=St.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}};function DU(r,t,e){const i=r;let n=!0,s=!1,o=!1;const a=[A0(i,Vt.LOAD,function(){o=!0,s||t()})];return i.src&&Cw?(s=!0,i.decode().then(function(){n&&t()}).catch(function(l){n&&(o?t():e())})):a.push(A0(i,Vt.ERROR,e)),function(){n=!1,a.forEach(sr)}}function $U(r,t){return new Promise((e,i)=>{function n(){o(),e(r)}function s(){o(),i(new Error("Image load error"))}function o(){r.removeEventListener("load",n),r.removeEventListener("error",s)}r.addEventListener("load",n),r.addEventListener("error",s)})}function YI(r,t){return t&&(r.src=t),r.src&&Cw?new Promise((e,i)=>r.decode().then(()=>e(r)).catch(n=>r.complete&&r.width?e(r):i(n))):$U(r)}function z1(r,t){return t&&(r.src=t),r.src&&Cw&&QM?r.decode().then(()=>createImageBitmap(r)).catch(e=>{if(r.complete&&r.width)return r;throw e}):YI(r)}let GU=class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];(t++&3)===0&&!i.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const n=F_(t,e,i);return n in this.cache_?this.cache_[n]:null}getPattern(t,e,i){const n=F_(t,e,i);return n in this.patternCache_?this.patternCache_[n]:null}set(t,e,i,n,s){const o=F_(t,e,i),a=o in this.cache_;this.cache_[o]=n,s&&(n.getImageState()===St.IDLE&&n.load(),n.getImageState()===St.LOADING?n.ready().then(()=>{this.patternCache_[o]=N0().createPattern(n.getImage(1),"repeat")}):this.patternCache_[o]=N0().createPattern(n.getImage(1),"repeat")),a||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};function F_(r,t,e){const i=e?Fu(e):"null";return t+":"+r+":"+i}const Jn=new GU;let Sd=null,XI=class extends kf{constructor(t,e,i,n,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=n===void 0?St.IDLE:n,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===St.LOADED){Sd||(Sd=Or(1,1,void 0,{willReadFrequently:!0})),Sd.drawImage(this.image_,0,0);try{Sd.getImageData(0,0,1,1),this.tainted_=!1}catch{Sd=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Vt.CHANGE)}handleImageError_(){this.imageState_=St.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=St.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Or(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===St.IDLE){this.image_||this.initializeImage_(),this.imageState_=St.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&YI(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==St.LOADED)return;const e=this.image_,i=Or(Math.ceil(e.width*t),Math.ceil(e.height*t)),n=i.canvas;i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=LU(this.color_),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=n}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===St.LOADED||this.imageState_===St.ERROR)t();else{const e=()=>{(this.imageState_===St.LOADED||this.imageState_===St.ERROR)&&(this.removeEventListener(Vt.CHANGE,e),t())};this.addEventListener(Vt.CHANGE,e)}})),this.ready_}};function fm(r,t,e,i,n,s){let o=t===void 0?void 0:Jn.get(t,e,n);return o||(o=new XI(r,r&&"src"in r?r.src||void 0:t,e,i,n),Jn.set(t,e,n,o,s)),s&&o&&!Jn.getPattern(t,e,n)&&Jn.set(t,e,n,o,s),o}function no(r){return r?Array.isArray(r)?nk(r):typeof r=="object"&&"src"in r?jU(r):r:null}function jU(r){if(!r.offset||!r.size)return Jn.getPattern(r.src,"anonymous",r.color);const t=r.src+":"+r.offset,e=Jn.getPattern(t,void 0,r.color);if(e)return e;const i=Jn.get(r.src,"anonymous",null);if(i.getImageState()!==St.LOADED)return null;const n=Or(r.size[0],r.size[1]);return n.drawImage(i.getImage(1),r.offset[0],r.offset[1],r.size[0],r.size[1],0,0,r.size[0],r.size[1]),fm(n.canvas,t,void 0,St.LOADED,r.color,!0),Jn.getPattern(t,void 0,r.color)}class KI{drawCustom(t,e,i,n,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}let QI=class extends KI{constructor(t,e,i,n,s,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?Wu(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=rn()}drawImages_(t,e,i,n){if(!this.image_)return;const s=gl(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,u=s.length;h<u;h+=2){const d=s[h]-this.imageAnchorX_,g=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const f=d+this.imageAnchorX_,p=g+this.imageAnchorY_;bo(a,f,p,1,1,c,-f,-p),o.save(),o.transform.apply(o,a),o.translate(f,p),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,i,n){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=gl(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=n){const l=s[e]+this.textOffsetX_,c=s[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(t,e,i,n,s){const o=this.context_,a=gl(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),i}drawRings_(t,e,i,n){for(let s=0,o=i.length;s<o;++s)e=this.moveToLineTo_(t,e,i[s],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!wr(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=dU(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],s=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!wr(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(wr(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,n=t.getFlatCoordinates();let s=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(n,s,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!wr(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!wr(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const s=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];n=this.drawRings_(i,n,c,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),ua(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Cg;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:no(i||un)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),n=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),h=s||Ho;this.strokeState_={lineCap:n!==void 0?n:ku,lineDash:this.pixelRatio_===1?h:h.map(u=>u*this.pixelRatio_),lineDashOffset:(o||Yo)*this.pixelRatio_,lineJoin:a!==void 0?a:Eu,lineWidth:(l!==void 0?l:Mg)*this.pixelRatio_,miterLimit:c!==void 0?c:Sg,strokeStyle:no(i||Tg)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const g=e.getColor();this.textFillState_={fillStyle:no(g||un)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const g=i.getColor(),f=i.getLineCap(),p=i.getLineDash(),m=i.getLineDashOffset(),y=i.getLineJoin(),_=i.getWidth(),x=i.getMiterLimit();this.textStrokeState_={lineCap:f!==void 0?f:ku,lineDash:p||Ho,lineDashOffset:m||Yo,lineJoin:y!==void 0?y:Eu,lineWidth:_!==void 0?_:Mg,miterLimit:x!==void 0?x:Sg,strokeStyle:no(g||Tg)}}const n=t.getFont(),s=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),c=t.getScaleArray(),h=t.getText(),u=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:n!==void 0?n:rR,textAlign:u!==void 0?u:Cg,textBaseline:d!==void 0?d:D0},this.text_=h!==void 0?Array.isArray(h)?h.reduce((g,f,p)=>g+=p%2?" ":f,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}};const zU=.5,JI={Point:YU,LineString:VU,Polygon:KU,MultiPoint:XU,MultiLineString:ZU,MultiPolygon:HU,GeometryCollection:WU,Circle:BU};function qU(r,t){return parseInt($t(r),10)-parseInt($t(t),10)}function r2(r,t){const e=tP(r,t);return e*e}function tP(r,t){return zU*r/t}function BU(r,t,e,i,n){const s=e.getFill(),o=e.getStroke();if(s||o){const l=r.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=r.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i)}}function pm(r,t,e,i,n,s,o,a){const l=[],c=e.getImage();if(c){let d=!0;const g=c.getImageState();g==St.LOADED||g==St.ERROR?d=!1:g==St.IDLE&&c.load(),d&&l.push(c.ready())}const h=e.getFill();h&&h.loading()&&l.push(h.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>n(null)),UU(r,t,e,i,s,o,a),u}function UU(r,t,e,i,n,s,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(i,n);if(e.getRenderer())eP(r,l,e,t,o);else{const c=JI[l.getType()];c(r,l,e,t,o,s)}}function eP(r,t,e,i,n){if(t.getType()=="GeometryCollection"){const s=t.getGeometries();for(let o=0,a=s.length;o<a;++o)eP(r,s[o],e,i,n);return}r.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),n)}function WU(r,t,e,i,n,s){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=JI[o[a].getType()];c(r,o[a],e,i,n,s)}}function VU(r,t,e,i,n){const s=e.getStroke();if(s){const a=r.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=r.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function ZU(r,t,e,i,n){const s=e.getStroke();if(s){const a=r.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=r.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function HU(r,t,e,i,n){const s=e.getFill(),o=e.getStroke();if(o||s){const l=r.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=r.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}function YU(r,t,e,i,n,s){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=St.LOADED)return;const h=r.getBuilder(e.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(t,i,n)}if(l){const h=r.getBuilder(e.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(t,i,n)}}function XU(r,t,e,i,n,s){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),c=l&&l.getText(),h=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=St.LOADED)return;const u=r.getBuilder(e.getZIndex(),"Image");u.setImageStyle(o,h),u.drawMultiPoint(t,i,n)}if(c){const u=r.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l,h),u.drawText(t,i,n)}}function KU(r,t,e,i,n){const s=e.getFill(),o=e.getStroke();if(s||o){const l=r.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=r.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}let QU=!1;function rP(r,t,e,i,n,s,o){const a=new XMLHttpRequest;a.open("GET",typeof r=="function"?r(e,i,n):r,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=QU,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=t.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?s(t.readFeatures(h,{extent:e,featureProjection:n}),t.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function OC(r,t){return function(e,i,n,s,o){rP(r,t,e,i,n,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function JU(r,t){return[[-1/0,-1/0,1/0,1/0]]}function tW(r,t){return[r]}class i2{constructor(t){this.rbush_=new h1(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[$t(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,s=e.length;n<s;n++){const o=t[n],a=e[n],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[n]=l,this.items_[$t(a)]=l}this.rbush_.load(i)}remove(t){const e=$t(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[$t(e)],n=[i.minX,i.minY,i.maxX,i.maxY];ra(n,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(i){return i.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,s=t.length;n<s;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return yl(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return hs(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}let Qu=class extends zs{constructor(t){super(),this.projection=ee(t.projection),this.attributions_=FC(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,n){e.viewResolver=i,e.viewRejector=n})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=FC(t),this.changed()}setState(t){this.state_=t,this.changed()}};function FC(r){return r?typeof r=="function"?r:(Array.isArray(r)||(r=[r]),t=>r):null}const cn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};let Sa=class extends on{constructor(t,e,i){super(t),this.feature=e,this.features=i}},ls=class extends Qu{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=bg,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(Re(this.format_,"`format` must be set when `url` is set"),this.loader_=OC(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:JU;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new i2:null,this.loadedExtentsRtree_=new i2,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,n;Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),!e&&i===void 0&&(i=new xi(n)),n!==void 0&&this.addFeaturesInternal(n),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=$t(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Sa(cn.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof Gi||(this.featureChangeKeys_[t]=[Oe(e,Vt.CHANGE,this.handleFeatureChange_,this),Oe(e,vu.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const n=String(e.getId());if(!(n in this.idIndex_))this.idIndex_[n]=e;else if(e instanceof Gi){const s=this.idIndex_[n];s instanceof Gi?Array.isArray(s)?s.push(e):this.idIndex_[n]=[s,e]:i=!1}else i=!1}return i&&(Re(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=$t(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=$t(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();e.push(h),n.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(cn.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Sa(cn.ADDFEATURE,i[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(cn.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(cn.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(Jr.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(Jr.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(sr);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Sa(cn.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(n){const s=n.getGeometry();if(s instanceof Gi||s.intersectsCoordinate(t))return e(n)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const n=i.getGeometry();if(n instanceof Gi||n.intersectsExtent(t)){const s=e(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),yl(this.nullGeometryFeatures_)||wi(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=GM(t,e);return[].concat(...i.map(n=>this.featuresRtree_.getInExtent(n)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||mo,this.featuresRtree_.forEachInExtent(l,function(c){if(e(c)){const h=c.getGeometry(),u=a;if(a=h instanceof Gi?0:h.closestPointXY(i,n,o,a),a<u){s=c;const d=Math.sqrt(a);l[0]=i-d,l[1]=n-d,l[2]=i+d,l[3]=n+d}}}),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=$t(e),n=e.getGeometry();if(!n)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const s=e.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Sa(cn.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:$t(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&yl(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,s=this.strategy_(t,e,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];n.forEachInExtent(l,function(c){return eo(c.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Sa(cn.FEATURESLOADSTART)),this.loader_.call(this,l,e,i,c=>{--this.loadingExtentsCount_,this.dispatchEvent(new Sa(cn.FEATURESLOADEND,void 0,c))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Sa(cn.FEATURESLOADERROR))}),n.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_,i=e.forEachInExtent(t,function(n){if(ra(n.extent,t))return n});i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,n=t.length;i<n;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){t&&this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=$t(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.featureChangeKeys_[e]?.forEach(sr),delete this.featureChangeKeys_[e];const i=t.getId();if(i!==void 0){const n=i.toString(),s=this.idIndex_[n];s===t?delete this.idIndex_[n]:Array.isArray(s)&&(s.splice(s.indexOf(t),1),s.length===1&&(this.idIndex_[n]=s[0]))}return delete this.uidIndex_[e],this.hasListener(cn.REMOVEFEATURE)&&this.dispatchEvent(new Sa(cn.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){Re(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(OC(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}};class ts{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new ts({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=fm(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===St.IDLE&&e.load(),e.getImageState()===St.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?$t(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:Fu(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}let so=class iP{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new iP({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}};function NC(r){return r[0]>0&&r[1]>0}function eW(r,t,e){return e===void 0&&(e=[0,0]),e[0]=r[0]*t+.5|0,e[1]=r[1]*t+.5|0,e}function Ui(r,t){return Array.isArray(r)?r:(t===void 0?t=[r,r]:(t[0]=r,t[1]=r),t)}class q1{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Ui(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new q1({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return te()}getImage(t){return te()}getHitDetectionImage(){return te()}getPixelRatio(t){return 1}getImageState(){return te()}getImageSize(){return te()}getOrigin(){return te()}getSize(){return te()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ui(t)}listenImageChange(t){te()}load(){te()}unlistenImageChange(t){te()}ready(){return Promise.resolve()}}let nP=class sP extends q1{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?St.LOADING:St.LOADED,this.imageState_===St.LOADING&&this.ready().then(()=>this.imageState_=St.LOADED),this.render()}clone(){const t=this.getScale(),e=new sP({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){const e=this.fill_?.getKey(),i=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let n=Jn.get(i,null,null)?.getImage(1);if(!n){const s=this.renderOptions_,o=Math.ceil(s.size*t),a=Or(o,o);this.draw_(s,a,t),n=a.canvas,Jn.set(i,null,null,new XI(n,void 0,null,St.LOADED,null))}return n}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let n=this.radius,s=this.radius2_===void 0?n:this.radius2_;if(n<s){const v=n;n=s,s=v}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),h=n-c,u=Math.sqrt(l*l+h*h),d=u/l;if(t==="miter"&&d<=i)return d*e;const g=e/2/d,f=e/2*(h/u),p=Math.sqrt((n+g)*(n+g)+f*f)-n;if(this.radius2_===void 0||t==="bevel")return p*2;const m=n*Math.sin(a),y=Math.sqrt(n*n-m*m),_=s-y,x=Math.sqrt(m*m+_*_)/m;if(x<=i){const v=x*e/2-s-n;return 2*Math.max(p,v)}return p*2}createRenderOptions(){let t=ku,e=Eu,i=0,n=null,s=0,o,a=0;this.stroke_&&(o=no(this.stroke_.getColor()??Tg),a=this.stroke_.getWidth()??Mg,n=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Eu,t=this.stroke_.getLineCap()??ku,i=this.stroke_.getMiterLimit()??Sg);const l=this.calculateLineJoinSize_(e,a,i),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:h,lineCap:t,lineDash:n,lineDashOffset:s,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let n=this.fill_.getColor();n===null&&(n=un),e.fillStyle=no(n),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),n=0;typeof i=="string"&&(i=Fu(i)),i===null?n=1:Array.isArray(i)&&(n=i.length===4?i[3]:1),n===0&&(e=Or(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=s+a*o,c=a%2===0?i:n;t.lineTo(c*Math.cos(l),c*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=un,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}},B1=class oP extends nP{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new oP({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}};class Vr{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=DC,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Vr({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=DC,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function rW(r){let t;if(typeof r=="function")t=r;else{let e;Array.isArray(r)?e=r:(Re(typeof r.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[r]),t=function(){return e}}return t}let N_=null;function aP(r,t){if(!N_){const e=new ts({color:"rgba(255,255,255,0.4)"}),i=new so({color:"#3399CC",width:1.25});N_=[new Vr({image:new B1({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return N_}function sk(){const r={},t=[255,255,255,1],e=[0,153,255,1],i=3;return r.Polygon=[new Vr({fill:new ts({color:[255,255,255,.5]})})],r.MultiPolygon=r.Polygon,r.LineString=[new Vr({stroke:new so({color:t,width:i+2})}),new Vr({stroke:new so({color:e,width:i})})],r.MultiLineString=r.LineString,r.Circle=r.Polygon.concat(r.LineString),r.Point=[new Vr({image:new B1({radius:i*2,fill:new ts({color:e}),stroke:new so({color:t,width:i/2})}),zIndex:1/0})],r.MultiPoint=r.Point,r.GeometryCollection=r.Polygon.concat(r.LineString,r.Point),r}function DC(r){return r.getGeometry()}const iW="#333";let lP=class cP{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=Ui(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new ts({color:iW}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new cP({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof ts?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ui(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}};const vr={ANIMATING:0,INTERACTING:1},Ht={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ap=[Ht.FILL],rl=[Ht.STROKE],ec=[Ht.BEGIN_PATH],$C=[Ht.CLOSE_PATH];let Vf=class extends KI{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=t.length;a<l;a+=e)n[0]=t[a],n[1]=t[a+1],Sc(i,n)&&(s[o++]=n[0],s[o++]=n[1]);return o}appendFlatLineCoordinates(t,e,i,n,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(e+=n);let h=t[e],u=t[e+1];const d=this.tmpCoordinate_;let g=!0,f,p,m;for(f=e+n;f<i;f+=n)d[0]=t[f],d[1]=t[f+1],m=Bv(c,d),m!==p?(g&&(a[l++]=h,a[l++]=u,g=!1),a[l++]=d[0],a[l++]=d[1]):m===pi.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],g=!1):g=!0,h=d[0],u=d[1],p=m;return(s&&g||f===e+n)&&(a[l++]=h,a[l++]=u),l}drawCustomCoordinates_(t,e,i,n,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],c=this.appendFlatLineCoordinates(t,e,l,n,!1,!1);s.push(c),e=l}return e}drawCustom(t,e,i,n,s){this.beginGeometry(t,e,s);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let c,h,u,d,g;switch(o){case"MultiPolygon":c=t.getOrientedFlatCoordinates(),d=[];const f=t.getEndss();g=0;for(let p=0,m=f.length;p<m;++p){const y=[];g=this.drawCustomCoordinates_(c,g,f[p],a,y),d.push(y)}this.instructions.push([Ht.CUSTOM,l,d,t,i,Xx,s]),this.hitDetectionInstructions.push([Ht.CUSTOM,l,d,t,n||i,Xx,s]);break;case"Polygon":case"MultiLineString":u=[],c=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),g=this.drawCustomCoordinates_(c,0,t.getEnds(),a,u),this.instructions.push([Ht.CUSTOM,l,u,t,i,Qg,s]),this.hitDetectionInstructions.push([Ht.CUSTOM,l,u,t,n||i,Qg,s]);break;case"LineString":case"Circle":c=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([Ht.CUSTOM,l,h,t,i,el,s]),this.hitDetectionInstructions.push([Ht.CUSTOM,l,h,t,n||i,el,s]);break;case"MultiPoint":c=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([Ht.CUSTOM,l,h,t,i,el,s]),this.hitDetectionInstructions.push([Ht.CUSTOM,l,h,t,n||i,el,s]));break;case"Point":c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([Ht.CUSTOM,l,h,t,i,void 0,s]),this.hitDetectionInstructions.push([Ht.CUSTOM,l,h,t,n||i,void 0,s]);break}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[Ht.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ht.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let n,s,o=-1;for(e=0;e<i;++e)n=t[e],s=n[0],s==Ht.END_GEOMETRY?o=e:s==Ht.BEGIN_GEOMETRY&&(n[2]=e,_O(this.hitDetectionInstructions,o,e),o=-1)}fillStyleToState(t,e={}){if(t){const i=t.getColor();e.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,e.fillStyle=no(i||un)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){const i=t.getColor();e.strokeStyle=no(i||Tg);const n=t.getLineCap();e.lineCap=n!==void 0?n:ku;const s=t.getLineDash();e.lineDash=s?s.slice():Ho;const o=t.getLineDashOffset();e.lineDashOffset=o||Yo;const a=t.getLineJoin();e.lineJoin=a!==void 0?a:Eu;const l=t.getWidth();e.lineWidth=l!==void 0?l:Mg;const c=t.getMiterLimit();e.miterLimit=c!==void 0?c:Sg,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){const i=this.state;this.fillStyleToState(t,i),this.strokeStyleToState(e,i)}createFill(t){const e=t.fillStyle,i=[Ht.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Ht.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,s=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,c=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||s!=t.currentLineDash&&!ua(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=c)&&(e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=c)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Ht.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=OM(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;rs(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},nW=class extends Vf{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!Sc(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(n,s);this.instructions.push([Ht.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ht.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),s=[];for(let l=0,c=n.length;l<c;l+=t.getStride())(!this.maxExtent||Sc(this.maxExtent,n.slice(l,l+2)))&&s.push(n[l],n[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ht.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ht.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},sW=class extends Vf{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),a=[Ht.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e,i){const n=this.state,s=n.strokeStyle,o=n.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([Ht.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ho,Yo],ec);const a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(rl),this.endGeometry(e)}drawMultiLineString(t,e,i){const n=this.state,s=n.strokeStyle,o=n.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([Ht.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ho,Yo],ec);const a=t.getEnds(),l=t.getFlatCoordinates(),c=t.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinates_(l,h,a[u],c);this.hitDetectionInstructions.push(rl),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(rl),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(rl),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(ec)}},GC=class extends Vf{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=i.length;this.instructions.push(ec),this.hitDetectionInstructions.push(ec);for(let c=0;c<l;++c){const h=i[c],u=this.coordinates.length,d=this.appendFlatLineCoordinates(t,e,h,n,!0,!a),g=[Ht.MOVE_TO_LINE_TO,u,d];this.instructions.push(g),this.hitDetectionInstructions.push(g),a&&(this.instructions.push($C),this.hitDetectionInstructions.push($C)),e=h}return o&&(this.instructions.push(Ap),this.hitDetectionInstructions.push(Ap)),a&&(this.instructions.push(rl),this.hitDetectionInstructions.push(rl)),e}drawCircle(t,e,i){const n=this.state,s=n.fillStyle,o=n.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ht.SET_FILL_STYLE,un]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ht.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ho,Yo]);const a=t.getFlatCoordinates(),l=t.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[Ht.CIRCLE,c];this.instructions.push(ec,h),this.hitDetectionInstructions.push(ec,h),n.fillStyle!==void 0&&(this.instructions.push(Ap),this.hitDetectionInstructions.push(Ap)),n.strokeStyle!==void 0&&(this.instructions.push(rl),this.hitDetectionInstructions.push(rl)),this.endGeometry(e)}drawPolygon(t,e,i){const n=this.state,s=n.fillStyle,o=n.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ht.SET_FILL_STYLE,un]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ht.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ho,Yo]);const a=t.getEnds(),l=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(e)}drawMultiPolygon(t,e,i){const n=this.state,s=n.fillStyle,o=n.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ht.SET_FILL_STYLE,un]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ht.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ho,Yo]);const a=t.getEndss(),l=t.getOrientedFlatCoordinates(),c=t.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinatess_(l,h,a[u],c);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=ql(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;this.updateFillStyle(t,this.createFill),this.updateStrokeStyle(t,this.applyStroke)}};function oW(r,t,e,i,n){const s=[];let o=e,a=0,l=t.slice(e,2);for(;a<r&&o+n<i;){const[c,h]=l.slice(-2),u=t[o+n],d=t[o+n+1],g=Math.sqrt((u-c)*(u-c)+(d-h)*(d-h));if(a+=g,a>=r){const f=(r-a+g)/g,p=Rn(c,u,f),m=Rn(h,d,f);l.push(p,m),s.push(l),l=[p,m],a==r&&(o+=n),a=0}else if(a<r)l.push(t[o+n],t[o+n+1]),o+=n;else{const f=g-a,p=Rn(c,u,f/g),m=Rn(h,d,f/g);l.push(p,m),s.push(l),l=[p,m],a=0,o+=n}}return a>0&&s.push(l),s}function aW(r,t,e,i,n){let s=e,o=e,a=0,l=0,c=e,h,u,d,g,f,p,m,y,_,x;for(u=e;u<i;u+=n){const v=t[u],w=t[u+1];f!==void 0&&(_=v-f,x=w-p,g=Math.sqrt(_*_+x*x),m!==void 0&&(l+=d,h=Math.acos((m*_+y*x)/(d*g)),h>r&&(l>a&&(a=l,s=c,o=u),l=0,c=u-n)),d=g,m=_,y=x),f=v,p=w}return l+=g,l>a?[c,u]:[s,o]}const mm={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class lW extends Vf{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[un]={fillStyle:un},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const n=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!n&&!s)return;const a=this.coordinates;let l=a.length;const c=t.getType();let h=null,u=t.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!wr(this.maxExtent,t.getExtent()))return;let d;if(h=t.getFlatCoordinates(),c=="LineString")d=[h.length];else if(c=="MultiLineString")d=t.getEnds();else if(c=="Polygon")d=t.getEnds().slice(0,1);else if(c=="MultiPolygon"){const m=t.getEndss();d=[];for(let y=0,_=m.length;y<_;++y)d.push(m[y][0])}this.beginGeometry(t,e,i);const g=o.repeat,f=g?void 0:o.textAlign;let p=0;for(let m=0,y=d.length;m<y;++m){let _;g?_=oW(g*this.resolution,h,p,d[m],u):_=[h.slice(p,d[m])];for(let x=0,v=_.length;x<v;++x){const w=_[x];let b=0,E=w.length;if(f==null){const S=aW(o.maxAngle,w,0,w.length,2);b=S[0],E=S[1]}for(let S=b;S<E;S+=u)a.push(w[S],w[S+1]);const C=a.length;p=d[m],this.drawChars_(l,C),l=C}}this.endGeometry(e)}else{let d=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),u=2;break;case"Polygon":h=t.getFlatInteriorPoint(),o.overflow||d.push(h[2]/this.resolution),u=3;break;case"MultiPolygon":const v=t.getFlatInteriorPoints();h=[];for(let w=0,b=v.length;w<b;w+=3)o.overflow||d.push(v[w+2]/this.resolution),h.push(v[w],v[w+1]);if(h.length===0)return;u=2;break}const g=this.appendFlatPointCoordinates(h,u);if(g===l)return;if(d&&(g-l)/2!==h.length/u){let v=l/2;d=d.filter((w,b)=>{const E=a[(v+b)*2]===h[b*u]&&a[(v+b)*2+1]===h[b*u+1];return E||--v,E})}this.saveTextStates_();const f=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,p=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(t,e,i);let m=o.padding;if(m!=Hl&&(o.scale[0]<0||o.scale[1]<0)){let v=o.padding[0],w=o.padding[1],b=o.padding[2],E=o.padding[3];o.scale[0]<0&&(w=-w,E=-E),o.scale[1]<0&&(v=-v,b=-b),m=[v,w,b,E]}const y=this.pixelRatio;this.instructions.push([Ht.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,m==Hl?Hl:m.map(function(v){return v*y}),f,p,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const _=1/y,x=f?f.slice(0):null;x&&(x[1]=un),this.hitDetectionInstructions.push([Ht.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[_,_],NaN,this.declutterMode_,this.declutterImageWithText_,m,x,p,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?un:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||Cg,justify:e.justify,textBaseline:e.textBaseline||D0,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=mm[n.textBaseline],h=this.textOffsetY_*l,u=this.text_,d=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([Ht.DRAW_CHARS,t,e,c,n.overflow,a,n.maxAngle,l,h,s,d*l,u,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ht.DRAW_CHARS,t,e,c,n.overflow,a&&un,n.maxAngle,l,h,s,d*l,u,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,n,s;if(!t)this.text_="";else{const o=t.getFill();o?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=no(o.getColor()||un)):(n=null,this.textFillState_=n);const a=t.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const p=a.getLineDash(),m=a.getLineDashOffset(),y=a.getWidth(),_=a.getMiterLimit();s.lineCap=a.getLineCap()||ku,s.lineDash=p?p.slice():Ho,s.lineDashOffset=m===void 0?Yo:m,s.lineJoin=a.getLineJoin()||Eu,s.lineWidth=y===void 0?Mg:y,s.miterLimit=_===void 0?Sg:_,s.strokeStyle=no(a.getColor()||Tg)}i=this.textState_;const l=t.getFont()||rR;iR(l);const c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||D0,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Hl,i.scale=c===void 0?[1,1]:c;const h=t.getOffsetX(),u=t.getOffsetY(),d=t.getRotateWithView(),g=t.getKeepUpright(),f=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=d===void 0?!1:d,this.textKeepUpright_=g===void 0?!0:g,this.textRotation_=f===void 0?0:f,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:$t(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?typeof n.fillStyle=="string"?n.fillStyle:"|"+$t(n.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const cW={Circle:GC,Default:Vf,Image:nW,LineString:sW,Polygon:GC,Text:lW};let hP=class{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const s=i[n].finish();t[e][n]=s}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let n=this.buildersByZIndex_[i];n===void 0&&(n={},this.buildersByZIndex_[i]=n);let s=n[e];if(s===void 0){const o=cW[e];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=s}return s}};function hW(r,t,e,i,n,s,o,a,l,c,h,u,d=!0){let g=r[t],f=r[t+1],p=0,m=0,y=0,_=0;function x(){p=g,m=f,t+=i,g=r[t],f=r[t+1],_+=y,y=Math.sqrt((g-p)*(g-p)+(f-m)*(f-m))}do x();while(t<e-i&&_+y<s);let v=y===0?0:(s-_)/y;const w=Rn(p,g,v),b=Rn(m,f,v),E=t-i,C=_,S=s+a*l(c,n,h);for(;t<e-i&&_+y<S;)x();v=y===0?0:(S-_)/y;const R=Rn(p,g,v),I=Rn(m,f,v);let F=!1;if(d)if(u){const A=[w,b,R,I];Ub(A,0,4,2,u,A,A),F=A[0]>A[2]}else F=w>R;const N=Math.PI,P=[],T=E+i===t;t=E,y=0,_=C,g=r[t],f=r[t+1];let D;if(T){x(),D=Math.atan2(f-m,g-p),F&&(D+=D>0?-N:N);const A=(R+w)/2,$=(I+b)/2;return P[0]=[A,$,(S-s)/2,D,n],P}n=n.replace(/\n/g," ");for(let A=0,$=n.length;A<$;){x();let z=Math.atan2(f-m,g-p);if(F&&(z+=z>0?-N:N),D!==void 0){let V=z-D;if(V+=V>N?-2*N:V<-N?2*N:0,Math.abs(V)>o)return null}D=z;const j=A;let et=0;for(;A<$;++A){const V=F?$-A-1:A,It=a*l(c,n[V],h);if(t+i<e&&_+y<s+et+It/2)break;et+=It}if(A===j)continue;const q=F?n.substring($-j,$-A):n.substring(j,A);v=y===0?0:(s+et/2-_)/y;const vt=Rn(p,g,v),jt=Rn(m,f,v);P.push([vt,jt,et/2,z,q]),s+=et}return P}let ok=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(N0(),{get:(t,e)=>{if(typeof N0()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,i)=>(this.push_(e,i),!0)})}push_(...t){const e=this.instructions_,i=this.zIndex+this.offset_;e[i]||(e[i]=[]),e[i].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,n=e.length;i<n;++i){const s=e[i];if(typeof s=="function"){s(t);continue}const o=e[++i];if(typeof t[s]=="function")t[s](...o);else{if(typeof o=="function"){t[s]=o(t);continue}t[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}};const fh=nn(),Ta=[],Po=[],Ao=[],Ca=[];function jC(r){return r[3].declutterBox}const zC=new RegExp("[Ö-à£¿ï¬-ï·¿ï¹°-ï»¼à -à¿¿î -î¿¿]");function D_(r,t){return t==="start"?t=zC.test(r)?"right":"left":t==="end"&&(t=zC.test(r)?"left":"right"),mm[t]}function uW(r,t,e){return e>0&&r.push(`
`,""),r.push(t,""),r}function dW(r,t,e){return e%2===0&&(r+=t),r}class gW{constructor(t,e,i,n,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=rn(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new ok:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,n){const s=t+e+i+n;if(this.labels_[s])return this.labels_[s];const o=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],u=l.justify?mm[l.justify]:D_(Array.isArray(t)?t[0]:t,l.textAlign||Cg),d=n&&o.lineWidth?o.lineWidth:0,g=Array.isArray(t)?t:String(t).split(`
`).reduce(uW,[]),{width:f,height:p,widths:m,heights:y,lineWidths:_}=xF(l,g),x=f+d,v=[],w=(x+2)*h[0],b=(p+d)*h[1],E={width:w<0?Math.floor(w):Math.ceil(w),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:v};(h[0]!=1||h[1]!=1)&&v.push("scale",h),n&&(v.push("strokeStyle",o.strokeStyle),v.push("lineWidth",d),v.push("lineCap",o.lineCap),v.push("lineJoin",o.lineJoin),v.push("miterLimit",o.miterLimit),v.push("setLineDash",[o.lineDash]),v.push("lineDashOffset",o.lineDashOffset)),i&&v.push("fillStyle",a.fillStyle),v.push("textBaseline","middle"),v.push("textAlign","center");const C=.5-u;let S=u*x+C*d;const R=[],I=[];let F=0,N=0,P=0,T=0,D;for(let A=0,$=g.length;A<$;A+=2){const z=g[A];if(z===`
`){N+=F,F=0,S=u*x+C*d,++T;continue}const j=g[A+1]||l.font;j!==D&&(n&&R.push("font",j),i&&I.push("font",j),D=j),F=Math.max(F,y[P]);const et=[z,S+C*m[P]+u*(m[P]-_[T]),.5*(d+F)+N];S+=m[P],n&&R.push("strokeText",et),i&&I.push("fillText",et),++P}return Array.prototype.push.apply(v,R),Array.prototype.push.apply(v,I),this.labels_[s]=E,E}replayTextBackground_(t,e,i,n,s,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],t.fillStyle=o[1],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,s,o,a,l,c,h,u,d,g,f,p,m){a*=d[0],l*=d[1];let y=i-a,_=n-l;const x=s+c>t?t-c:s,v=o+h>e?e-h:o,w=f[3]+x*d[0]+f[1],b=f[0]+v*d[1]+f[2],E=y-f[3],C=_-f[0];(p||u!==0)&&(Ta[0]=E,Ca[0]=E,Ta[1]=C,Po[1]=C,Po[0]=E+w,Ao[0]=Po[0],Ao[1]=C+b,Ca[1]=Ao[1]);let S;return u!==0?(S=bo(rn(),i,n,1,1,u,-i,-n),Qr(S,Ta),Qr(S,Po),Qr(S,Ao),Qr(S,Ca),hs(Math.min(Ta[0],Po[0],Ao[0],Ca[0]),Math.min(Ta[1],Po[1],Ao[1],Ca[1]),Math.max(Ta[0],Po[0],Ao[0],Ca[0]),Math.max(Ta[1],Po[1],Ao[1],Ca[1]),fh)):hs(Math.min(E,E+w),Math.min(C,C+b),Math.max(E,E+w),Math.max(C,C+b),fh),g&&(y=Math.round(y),_=Math.round(_)),{drawImageX:y,drawImageY:_,drawImageW:x,drawImageH:v,originX:c,originY:h,declutterBox:{minX:fh[0],minY:fh[1],maxX:fh[2],maxY:fh[3],value:m},canvasTransform:S,scale:d}}replayImageOrLabel_(t,e,i,n,s,o,a){const l=!!(o||a),c=n.declutterBox,h=a?a[2]*n.scale[0]/2:0;return c.minX-h<=e[0]&&c.maxX+h>=0&&c.minY-h<=e[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(t,Ta,Po,Ao,Ca,o,a),wF(t,n.canvasTransform,s,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=Qr(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(i[0]%n,i[1]%n),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],e[1]&&(t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6]))}drawLabelWithPointPlacement_(t,e,i,n){const s=this.textStates[e],o=this.createLabel(t,e,n,i),a=this.strokeStates[i],l=this.pixelRatio,c=D_(Array.isArray(t)?t[0]:t,s.textAlign||Cg),h=mm[s.textBaseline||D0],u=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*s.scale[0],g=c*d+2*(.5-c)*u,f=h*o.height/l+2*(.5-h)*u;return{label:o,anchorX:g,anchorY:f}}execute_(t,e,i,n,s,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&ua(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=gl(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),iU(this.renderedTransform_,i));let u=0;const d=n.length;let g=0,f,p,m,y,_,x,v,w,b,E,C,S,R,I=0,F=0;const N=this.coordinateCache_,P=this.viewRotation_,T=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,D={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P},A=this.instructions!=n||this.overlaps?0:200;let $,z,j,et;for(;u<d;){const q=n[u];switch(q[0]){case Ht.BEGIN_GEOMETRY:$=q[1],et=q[3],$.getGeometry()?a!==void 0&&!wr(a,et.getExtent())?u=q[2]+1:++u:u=q[2],c&&(c.zIndex=q[4]);break;case Ht.BEGIN_PATH:I>A&&(this.fill_(t),I=0),F>A&&(t.stroke(),F=0),!I&&!F&&(t.beginPath(),_=NaN,x=NaN),++u;break;case Ht.CIRCLE:g=q[1];const vt=h[g],jt=h[g+1],V=h[g+2],It=h[g+3],Et=V-vt,Mt=It-jt,Ot=Math.sqrt(Et*Et+Mt*Mt);t.moveTo(vt+Ot,jt),t.arc(vt,jt,Ot,0,2*Math.PI,!0),++u;break;case Ht.CLOSE_PATH:t.closePath(),++u;break;case Ht.CUSTOM:g=q[1],f=q[2];const Y=q[3],We=q[4],L=q[5];D.geometry=Y,D.feature=$,u in N||(N[u]=[]);const O=N[u];L?L(h,g,f,2,O):(O[0]=h[g],O[1]=h[g+1],O.length=2),c&&(c.zIndex=q[6]),We(O,D),++u;break;case Ht.DRAW_IMAGE:g=q[1],f=q[2],b=q[3],p=q[4],m=q[5];let U=q[6];const X=q[7],W=q[8],K=q[9],it=q[10];let ot=q[11];const rt=q[12];let H=q[13];y=q[14]||"declutter";const ut=q[15];if(!b&&q.length>=20){E=q[19],C=q[20],S=q[21],R=q[22];const Xr=this.drawLabelWithPointPlacement_(E,C,S,R);b=Xr.label,q[3]=b;const qn=q[23];p=(Xr.anchorX-qn)*this.pixelRatio,q[4]=p;const ki=q[24];m=(Xr.anchorY-ki)*this.pixelRatio,q[5]=m,U=b.height,q[6]=U,H=b.width,q[13]=H}let mt;q.length>25&&(mt=q[25]);let dt,pt,kt;q.length>17?(dt=q[16],pt=q[17],kt=q[18]):(dt=Hl,pt=null,kt=null),it&&T?ot+=P:!it&&!T&&(ot-=P);let Dt=0;for(;g<f;g+=2){if(mt&&mt[Dt++]<H/this.pixelRatio)continue;const Xr=this.calculateImageOrLabelDimensions_(b.width,b.height,h[g],h[g+1],H,U,p,m,W,K,ot,rt,s,dt,!!pt||!!kt,$),qn=[t,e,b,Xr,X,pt,kt];if(l){let ki,cr,Fr;if(ut){const xe=f-g;if(!ut[xe]){ut[xe]={args:qn,declutterMode:y};continue}const rr=ut[xe];ki=rr.args,cr=rr.declutterMode,delete ut[xe],Fr=jC(ki)}let _r,Nr;if(ki&&(cr!=="declutter"||!l.collides(Fr))&&(_r=!0),(y!=="declutter"||!l.collides(Xr.declutterBox))&&(Nr=!0),cr==="declutter"&&y==="declutter"){const xe=_r&&Nr;_r=xe,Nr=xe}_r&&(cr!=="none"&&l.insert(Fr),this.replayImageOrLabel_.apply(this,ki)),Nr&&(y!=="none"&&l.insert(Xr.declutterBox),this.replayImageOrLabel_.apply(this,qn))}else this.replayImageOrLabel_.apply(this,qn)}++u;break;case Ht.DRAW_CHARS:const wt=q[1],zt=q[2],Jt=q[3],ve=q[4];R=q[5];const Ce=q[6],Ve=q[7],qr=q[8];S=q[9];const Pe=q[10];E=q[11],Array.isArray(E)&&(E=E.reduce(dW,"")),C=q[12];const le=[q[13],q[13]];y=q[14]||"declutter";const Cr=q[15],er=this.textStates[C],Br=er.font,lr=[er.scale[0]*Ve,er.scale[1]*Ve];let Yr;Br in this.widths_?Yr=this.widths_[Br]:(Yr={},this.widths_[Br]=Yr);const Cn=tk(h,wt,zt,2),an=Math.abs(lr[0])*NS(Br,E,Yr);if(ve||an<=Cn){const Xr=this.textStates[C].textAlign,qn=(Cn-an)*D_(E,Xr),ki=hW(h,wt,zt,2,E,qn,Ce,Math.abs(lr[0]),NS,Br,Yr,T?0:this.viewRotation_,Cr);t:if(ki){const cr=[];let Fr,_r,Nr,xe,rr;if(S)for(Fr=0,_r=ki.length;Fr<_r;++Fr){rr=ki[Fr],Nr=rr[4],xe=this.createLabel(Nr,C,"",S),p=rr[2]+(lr[0]<0?-Pe:Pe),m=Jt*xe.height+(.5-Jt)*2*Pe*lr[1]/lr[0]-qr;const Ur=this.calculateImageOrLabelDimensions_(xe.width,xe.height,rr[0],rr[1],xe.width,xe.height,p,m,0,0,rr[3],le,!1,Hl,!1,$);if(l&&y==="declutter"&&l.collides(Ur.declutterBox))break t;cr.push([t,e,xe,Ur,1,null,null])}if(R)for(Fr=0,_r=ki.length;Fr<_r;++Fr){rr=ki[Fr],Nr=rr[4],xe=this.createLabel(Nr,C,R,""),p=rr[2],m=Jt*xe.height-qr;const Ur=this.calculateImageOrLabelDimensions_(xe.width,xe.height,rr[0],rr[1],xe.width,xe.height,p,m,0,0,rr[3],le,!1,Hl,!1,$);if(l&&y==="declutter"&&l.collides(Ur.declutterBox))break t;cr.push([t,e,xe,Ur,1,null,null])}l&&y!=="none"&&l.load(cr.map(jC));for(let Ur=0,ir=cr.length;Ur<ir;++Ur)this.replayImageOrLabel_.apply(this,cr[Ur])}}++u;break;case Ht.END_GEOMETRY:if(o!==void 0){$=q[1];const Xr=o($,et,y);if(Xr)return Xr}++u;break;case Ht.FILL:A?I++:this.fill_(t),++u;break;case Ht.MOVE_TO_LINE_TO:for(g=q[1],f=q[2],z=h[g],j=h[g+1],t.moveTo(z,j),_=z+.5|0,x=j+.5|0,g+=2;g<f;g+=2)z=h[g],j=h[g+1],v=z+.5|0,w=j+.5|0,(g==f-2||v!==_||w!==x)&&(t.lineTo(z,j),_=v,x=w);++u;break;case Ht.SET_FILL_STYLE:this.alignAndScaleFill_=q[2],I&&(this.fill_(t),I=0,F&&(t.stroke(),F=0)),t.fillStyle=q[1],++u;break;case Ht.SET_STROKE_STYLE:F&&(t.stroke(),F=0),this.setStrokeStyle_(t,q),++u;break;case Ht.STROKE:A?F++:t.stroke(),++u;break;default:++u;break}}I&&this.fill_(t),F&&t.stroke()}execute(t,e,i,n,s,o){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(t,e,i,n,s){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,n,s)}}const Vl=["Polygon","Circle","LineString","Image","Text","Default"],ym=["Image","Text"],fW=Vl.filter(r=>!ym.includes(r));class uP{constructor(t,e,i,n,s,o,a){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=rn(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let n=this.executorsByZIndex_[i];n===void 0&&(n={},this.executorsByZIndex_[i]=n);const s=t[i];for(const o in s){const a=s[o];n[o]=new gW(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let n=0,s=t.length;n<s;++n)if(t[n]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,s,o){n=Math.round(n);const a=n*2+1,l=bo(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Or(a,a));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=nn(),Yd(u,t),rs(u,e*(this.renderBuffer_+n),u));const d=pW(n);let g;function f(w,b,E){const C=h.getImageData(0,0,a,a).data;for(let S=0,R=d.length;S<R;S++)if(C[d[S]]>0){if(!o||E==="none"||g!=="Image"&&g!=="Text"||o.includes(w)){const I=(d[S]-3)/4,F=n-I%a,N=n-(I/a|0),P=s(w,b,F*F+N*N);if(P)return P}h.clearRect(0,0,a,a);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);p.sort(oo);let m,y,_,x,v;for(m=p.length-1;m>=0;--m){const w=p[m].toString();for(_=this.executorsByZIndex_[w],y=Vl.length-1;y>=0;--y)if(g=Vl[y],x=_[g],x!==void 0&&(v=x.executeHitDetection(h,l,i,f,u),v))return v}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],s=e[2],o=e[3],a=[i,n,i,o,s,o,s,n];return gl(a,0,8,2,t,a),a}isEmpty(){return yl(this.executorsByZIndex_)}execute(t,e,i,n,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?yO:oo),o=o||Vl;const c=Vl.length;for(let h=0,u=l.length;h<u;++h){const d=l[h].toString(),g=this.executorsByZIndex_[d];for(let f=0,p=o.length;f<p;++f){const m=o[f],y=g[m];if(y!==void 0){const _=a===null?void 0:y.getZIndexContext(),x=_?_.getContext():t,v=this.maxExtent_&&m!=="Image"&&m!=="Text";if(v&&(x.save(),this.clip(x,i)),!_||m==="Text"||m==="Image"?y.execute(x,e,i,n,s,a):_.pushFunction(w=>y.execute(w,e,i,n,s,a)),v&&x.restore(),_){_.offset();const w=l[h]*c+Vl.indexOf(m);this.deferredZIndexContexts_[w]||(this.deferredZIndexContexts_[w]=[]),this.deferredZIndexContexts_[w].push(_)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(oo);for(let i=0,n=e.length;i<n;++i)t[e[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),t[e[i]].length=0}}const $_={};function pW(r){if($_[r]!==void 0)return $_[r];const t=r*2+1,e=r*r,i=new Array(e+1);for(let s=0;s<=r;++s)for(let o=0;o<=r;++o){const a=s*s+o*o;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((r+s)*t+(r+o))*4+3),s>0&&l.push(((r-s)*t+(r+o))*4+3),o>0&&(l.push(((r+s)*t+(r-o))*4+3),s>0&&l.push(((r-s)*t+(r-o))*4+3))}const n=[];for(let s=0,o=i.length;s<o;++s)i[s]&&n.push(...i[s]);return $_[r]=n,n}function qC(r,t,e,i){return e!==void 0&&i!==void 0?[e/r,i/t]:e!==void 0?e/r:i!==void 0?i/t:1}let kl=class dP extends q1{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,n=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:n,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;let a=t.src;Re(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||$t(o)),Re(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),Re(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=St.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?St.LOADED:St.IDLE:l=St.LOADING:l=St.LOADED),this.color_=t.color!==void 0?Fu(t.color):null,this.iconImage_=fm(o,a,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let c,h;if(t.size)[c,h]=t.size;else{const u=this.getImage(1);if(u.width&&u.height)c=u.width,h=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=t;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const g=this.iconImage_.getSize();this.setScale(qC(g[0],g[1],t.width,t.height))};this.listenImageChange(d);return}}c!==void 0&&this.setScale(qC(c,h,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new dP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const n=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!n)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=n[0]),this.anchorYUnits_=="fraction"&&(t[1]*=n[1])}if(this.anchorOrigin_!="top-left"){if(!n)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+n[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+n[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(t){this.iconImage_=fm(null,t,this.crossOrigin_,St.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==St.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==St.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(Vt.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(Vt.CHANGE,t)}ready(){return this.iconImage_.ready()}};const Fn=.5;function gP(r,t,e,i,n,s,o,a,l){const c=l?l1(n):n,h=r[0]*Fn,u=r[1]*Fn,d=Or(h,u);d.imageSmoothingEnabled=!1;const g=d.canvas,f=new QI(d,Fn,n,null,o,a,l?Tf(oF(),l):null),p=e.length,m=Math.floor((256*256*256-1)/p),y={};for(let x=1;x<=p;++x){const v=e[x-1],w=v.getStyleFunction()||i;if(!w)continue;let b=w(v,s);if(!b)continue;Array.isArray(b)||(b=[b]);const E=(x*m).toString(16).padStart(7,"#00000");for(let C=0,S=b.length;C<S;++C){const R=b[C],I=R.getGeometryFunction()(v);if(!I||!wr(c,I.getExtent()))continue;const F=R.clone(),N=F.getFill();N&&N.setColor(E);const P=F.getStroke();P&&(P.setColor(E),P.setLineDash(null)),F.setText(void 0);const T=R.getImage();if(T){const z=T.getImageSize();if(!z)continue;const j=Or(z[0],z[1],void 0,{alpha:!1}),et=j.canvas;j.fillStyle=E,j.fillRect(0,0,et.width,et.height),F.setImage(new kl({img:et,anchor:T.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:T.getOrigin(),opacity:1,size:T.getSize(),scale:T.getScale(),rotation:T.getRotation(),rotateWithView:T.getRotateWithView()}))}const D=F.getZIndex()||0;let A=y[D];A||(A={},y[D]=A,A.Polygon=[],A.Circle=[],A.LineString=[],A.Point=[]);const $=I.getType();if($==="GeometryCollection"){const z=I.getGeometriesArrayRecursive();for(let j=0,et=z.length;j<et;++j){const q=z[j];A[q.getType().replace("Multi","")].push(q,F)}}else A[$.replace("Multi","")].push(I,F)}}const _=Object.keys(y).map(Number).sort(oo);for(let x=0,v=_.length;x<v;++x){const w=y[_[x]];for(const b in w){const E=w[b];for(let C=0,S=E.length;C<S;C+=2){f.setStyle(E[C+1]);for(let R=0,I=t.length;R<I;++R)f.setTransform(t[R]),f.drawGeometry(E[C])}}}return d.getImageData(0,0,g.width,g.height)}function fP(r,t,e){const i=[];if(e){const n=Math.floor(Math.round(r[0])*Fn),s=Math.floor(Math.round(r[1])*Fn),o=(kr(n,0,e.width-1)+kr(s,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],c=e.data[o+2]+256*(l+256*a),h=Math.floor((256*256*256-1)/t.length);c&&c%h===0&&i.push(t[c/h-1])}return i}class pP extends on{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}}const mW=5;class yW extends Ef{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=mW}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return te()}getData(t){return null}prepareFrame(t){return te()}renderFrame(t,e){return te()}forEachFeatureAtCoordinate(t,e,i,n,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===St.LOADED||e.getState()===St.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=St.LOADED&&e!=St.ERROR&&t.addEventListener(Vt.CHANGE,this.boundHandleImageChange_),e==St.IDLE&&(t.load(),e=t.getState()),e==St.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const BC=[];let Ph=null;function _W(){Ph=Or(1,1,void 0,{willReadFrequently:!0})}let ak=class extends yW{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=rn(),this.pixelTransform=rn(),this.inversePixelTransform=rn(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){Ph||_W(),Ph.clearRect(0,0,1,1);let n;try{Ph.drawImage(t,e,i,1,1,0,0,1,1),n=Ph.getImageData(0,0,1,1).data}catch{return Ph=null,null}return n}getBackground(t){let e=this.getLayer().getBackground();return typeof e=="function"&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let s,o;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&ua(Fu(t.style.backgroundColor),Fu(i)))){const a=t.firstElementChild;Ha(a)&&(o=a.getContext("2d"))}if(o&&lU(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Hn?eR():document.createElement("div"),s.className=n;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Or();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=da(i),s=n1(i),o=i1(i),a=r1(i);Qr(e.coordinateToPixelTransform,n),Qr(e.coordinateToPixelTransform,s),Qr(e.coordinateToPixelTransform,o),Qr(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Qr(l,n),Qr(l,s),Qr(l,o),Qr(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const i=t.extent,n=t.viewState.resolution,s=t.viewState.rotation,o=t.pixelRatio,a=Math.round(Me(i)/n*o),l=Math.round(Ar(i)/n*o);bo(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,s,-a/2,-l/2),AI(this.inversePixelTransform,this.pixelTransform);const c=aU(this.pixelTransform);if(this.useContainer(e,c,this.getBackground(t)),!this.containerReused){const h=this.context.canvas;h.width!=a||h.height!=l?(h.width=a,h.height=l):this.context.clearRect(0,0,a,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const s=new pP(t,this.inversePixelTransform,i,e);n.dispatchEvent(s)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(Qn.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Qn.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new ok),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Qn.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Qn.POSTRENDER,this.context,t))}getRenderTransform(t,e,i,n,s,o,a){const l=s/2,c=o/2,h=n/e,u=-h,d=-t[0]+a,g=-t[1];return bo(this.tempTransform,l,c,h,u,-i,d,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}},vW=class extends ak{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=nn(),this.wrappedRenderedExtent_=nn(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,s=e.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),u=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),g=e.pixelRatio,f=e.viewHints,p=!(f[vr.ANIMATING]||f[vr.INTERACTING]),m=this.context,y=Math.round(Me(n)/a*g),_=Math.round(Ar(n)/a*g),x=u.getWrapX()&&l.canWrapX(),v=x?Me(h):null,w=x?Math.ceil((n[2]-h[2])/v)+1:1;let b=x?Math.floor((n[0]-h[0])/v):0;do{let E=this.getRenderTransform(o,a,0,g,y,_,b*v);e.declutter&&(E=E.slice(0)),t.execute(m,[m.canvas.width,m.canvas.height],E,c,p,i===void 0?Vl:i?ym:fW,i?d&&e.declutter[d]:void 0)}while(++b<w)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Or(this.context.canvas.width,this.context.canvas.height,BC))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Cf(this.context),BC.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const n=t.viewState;this.prepareContainer(t,e);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Qn.PRERENDER)||this.getLayer().hasListener(Qn.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,t),n.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=Cs(i.extent);a=wr(l,t.extent),this.clipped_=a&&!eo(l,t.extent),this.clipped_&&this.clipUnrotated(s,t,l)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&s.restore(),this.postRender(s,t),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),n=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],u=i[0]*Fn,d=i[1]*Fn;h.push(this.getRenderTransform(n,s,o,Fn,u,d,0).slice());const g=c.getSource(),f=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!eo(f,l)){let p=l[0];const m=Me(f);let y=0,_;for(;p<f[0];)--y,_=m*y,h.push(this.getRenderTransform(n,s,o,Fn,u,d,_).slice()),p+=m;for(y=0,p=l[2];p>f[2];)++y,_=m*y,h.push(this.getRenderTransform(n,s,o,Fn,u,d,_).slice()),p-=m}this.hitDetectionImageData_=gP(i,h,this.renderedFeatures_,c.getStyleFunction(),l,s,o,r2(s,this.renderedPixelRatio_),null)}e(fP(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,n,s){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),c={},h=function(d,g,f){const p=$t(d),m=c[p];if(m){if(m!==!0&&f<m.distanceSq){if(f===0)return c[p]=!0,s.splice(s.lastIndexOf(m),1),n(d,l,g);m.geometry=g,m.distanceSq=f}}else{if(f===0)return c[p]=!0,n(d,l,g);s.push(c[p]={feature:d,layer:l,geometry:g,distanceSq:f,callback:n})}},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,i,h,u?e.declutter?.[u]?.all().map(d=>d.value):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[vr.ANIMATING],s=t.viewHints[vr.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&n||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,c=t.viewState,h=c.projection,u=c.resolution,d=t.pixelRatio,g=e.getRevision(),f=e.getRenderBuffer();let p=e.getRenderOrder();p===void 0&&(p=qU);const m=c.center.slice(),y=rs(l,f*u),_=y.slice(),x=[y.slice()],v=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!eo(v,t.extent)){const P=Me(v),T=Math.max(Me(y)/2,P);y[0]=v[0]-T,y[2]=v[2]+T,ww(m,h);const D=$M(x[0],h);D[0]<v[0]&&D[2]<v[2]?x.push([D[0]+P,D[1],D[2]+P,D[3]]):D[0]>v[0]&&D[2]>v[2]&&x.push([D[0]-P,D[1],D[2]-P,D[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==g&&this.renderedRenderOrder_==p&&this.renderedFrameDeclutter_===!!t.declutter&&eo(this.wrappedRenderedExtent_,y))return ua(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const w=new hP(tP(u,d),y,u,d);let b;for(let P=0,T=x.length;P<T;++P)i.loadFeatures(x[P],u,h);const E=r2(u,d);let C=!0;const S=((P,T)=>{let D;const A=P.getStyleFunction()||e.getStyleFunction();if(A&&(D=A(P,u)),D){const $=this.renderFeature(P,E,D,w,b,this.getLayer().getDeclutter(),T);C=C&&!$}}),R=l1(y),I=i.getFeaturesInExtent(R);p&&I.sort(p);for(let P=0,T=I.length;P<T;++P)S(I[P],P);this.renderedFeatures_=I,this.ready=C;const F=w.finish(),N=new uP(y,u,d,i.getOverlaps(),F,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=g,this.renderedRenderOrder_=p,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=_,this.wrappedRenderedExtent_=y,this.renderedCenter_=m,this.renderedProjection_=h,this.renderedPixelRatio_=d,this.replayGroup_=N,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,s,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,h=i.length;c<h;++c)l=pm(n,t,i[c],e,this.boundHandleStyleImageChange_,s,o,a)||l;else l=pm(n,t,i,e,this.boundHandleStyleImageChange_,s,o,a);return l}},Xc=0;const Ki=1<<Xc++,Ae=1<<Xc++,gn=1<<Xc++,Ss=1<<Xc++,Fc=1<<Xc++,zd=1<<Xc++,Lp=Math.pow(2,Xc)-1,lk={[Ki]:"boolean",[Ae]:"number",[gn]:"string",[Ss]:"color",[Fc]:"number[]",[zd]:"size"},xW=Object.keys(lk).map(Number).sort(oo);function wW(r){return r in lk}function qd(r){const t=[];for(const e of xW)Bd(r,e)&&t.push(lk[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function Bd(r,t){return(r&t)===t}function Ma(r,t){return r===t}let li=class{constructor(t,e){if(!wW(t))throw new Error(`literal expressions must have a specific type, got ${qd(t)}`);this.type=t,this.value=e}},bW=class{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}};function mP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ii(r,t,e){switch(typeof r){case"boolean":{if(Ma(t,gn))return new li(gn,r?"true":"false");if(!Bd(t,Ki))throw new Error(`got a boolean, but expected ${qd(t)}`);return new li(Ki,r)}case"number":{if(Ma(t,zd))return new li(zd,Ui(r));if(Ma(t,Ki))return new li(Ki,!!r);if(Ma(t,gn))return new li(gn,r.toString());if(!Bd(t,Ae))throw new Error(`got a number, but expected ${qd(t)}`);return new li(Ae,r)}case"string":{if(Ma(t,Ss))return new li(Ss,ik(r));if(Ma(t,Ki))return new li(Ki,!!r);if(!Bd(t,gn))throw new Error(`got a string, but expected ${qd(t)}`);return new li(gn,r)}}if(!Array.isArray(r))throw new Error("expression must be an array or a primitive value");if(r.length===0)throw new Error("empty expression");if(typeof r[0]=="string")return LW(r,t,e);for(const i of r)if(typeof i!="number")throw new Error("expected an array of numbers");if(Ma(t,zd)){if(r.length!==2)throw new Error(`expected an array of two values for a size, got ${r.length}`);return new li(zd,r)}if(Ma(t,Ss)){if(r.length===3)return new li(Ss,[...r,1]);if(r.length===4)return new li(Ss,r);throw new Error(`expected an array of 3 or 4 values for a color, got ${r.length}`)}if(!Bd(t,Fc))throw new Error(`got an array of numbers, but expected ${qd(t)}`);return new li(Fc,r)}const Q={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},kW={[Q.Get]:se(pe(1,1/0),UC),[Q.Var]:se(pe(1,1),EW),[Q.Has]:se(pe(1,1/0),UC),[Q.Id]:se(SW,ph),[Q.Concat]:se(pe(2,1/0),qe(gn)),[Q.GeometryType]:se(TW,ph),[Q.LineMetric]:se(ph),[Q.Resolution]:se(G_,ph),[Q.Zoom]:se(G_,ph),[Q.Time]:se(G_,ph),[Q.Any]:se(pe(2,1/0),qe(Ki)),[Q.All]:se(pe(2,1/0),qe(Ki)),[Q.Not]:se(pe(1,1),qe(Ki)),[Q.Equal]:se(pe(2,2),qe(Lp)),[Q.NotEqual]:se(pe(2,2),qe(Lp)),[Q.GreaterThan]:se(pe(2,2),qe(Ae)),[Q.GreaterThanOrEqualTo]:se(pe(2,2),qe(Ae)),[Q.LessThan]:se(pe(2,2),qe(Ae)),[Q.LessThanOrEqualTo]:se(pe(2,2),qe(Ae)),[Q.Multiply]:se(pe(2,1/0),WC),[Q.Coalesce]:se(pe(2,1/0),WC),[Q.Divide]:se(pe(2,2),qe(Ae)),[Q.Add]:se(pe(2,1/0),qe(Ae)),[Q.Subtract]:se(pe(2,2),qe(Ae)),[Q.Clamp]:se(pe(3,3),qe(Ae)),[Q.Mod]:se(pe(2,2),qe(Ae)),[Q.Pow]:se(pe(2,2),qe(Ae)),[Q.Abs]:se(pe(1,1),qe(Ae)),[Q.Floor]:se(pe(1,1),qe(Ae)),[Q.Ceil]:se(pe(1,1),qe(Ae)),[Q.Round]:se(pe(1,1),qe(Ae)),[Q.Sin]:se(pe(1,1),qe(Ae)),[Q.Cos]:se(pe(1,1),qe(Ae)),[Q.Atan]:se(pe(1,2),qe(Ae)),[Q.Sqrt]:se(pe(1,1),qe(Ae)),[Q.Match]:se(pe(4,1/0),VC,MW),[Q.Between]:se(pe(3,3),qe(Ae)),[Q.Interpolate]:se(pe(6,1/0),VC,RW),[Q.Case]:se(pe(3,1/0),CW,IW),[Q.In]:se(pe(2,2),PW),[Q.Number]:se(pe(1,1/0),qe(Lp)),[Q.String]:se(pe(1,1/0),qe(Lp)),[Q.Array]:se(pe(1,1/0),qe(Ae)),[Q.Color]:se(pe(1,4),qe(Ae)),[Q.Band]:se(pe(1,3),qe(Ae)),[Q.Palette]:se(pe(2,2),AW),[Q.ToString]:se(pe(1,1),qe(Ki|Ae|gn|Ss))};function UC(r,t,e){const i=r.length-1,n=new Array(i);for(let s=0;s<i;++s){const o=r[s+1];switch(typeof o){case"number":{n[s]=new li(Ae,o);break}case"string":{n[s]=new li(gn,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&e.properties.add(String(o))}return n}function EW(r,t,e){const i=r[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return e.variables.add(i),[new li(gn,i)]}function SW(r,t,e){e.featureId=!0}function TW(r,t,e){e.geometryType=!0}function G_(r,t,e){e.mapState=!0}function ph(r,t,e){const i=r[0];if(r.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function pe(r,t){return function(e,i,n){const s=e[0],o=e.length-1;if(r===t){if(o!==r){const a=r===1?"":"s";throw new Error(`expected ${r} argument${a} for ${s}, got ${o}`)}}else if(o<r||o>t){const a=t===1/0?`${r} or more`:`${r} to ${t}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function WC(r,t,e){const i=r.length-1,n=new Array(i);for(let s=0;s<i;++s){const o=Ii(r[s+1],t,e);n[s]=o}return n}function qe(r){return function(t,e,i){const n=t.length-1,s=new Array(n);for(let o=0;o<n;++o){const a=Ii(t[o+1],r,i);s[o]=a}return s}}function CW(r,t,e){const i=r[0],n=r.length-1;if(n%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${n} instead`)}function VC(r,t,e){const i=r[0],n=r.length-1;if(n%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${n} instead`)}function MW(r,t,e){const i=r.length-1,n=gn|Ae|Ki,s=Ii(r[1],n,e),o=Ii(r[r.length-1],t,e),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const c=Ii(r[l+2],s.type,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Ii(r[l+3],o.type,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function RW(r,t,e){const i=r[1];let n;switch(i[0]){case"linear":n=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);n=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new li(Ae,n);let o;try{o=Ii(r[2],Ae,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(r.length-3);for(let l=0;l<a.length;l+=2){try{const c=Ii(r[l+3],Ae,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Ii(r[l+4],t,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function IW(r,t,e){const i=Ii(r[r.length-1],t,e),n=new Array(r.length-1);for(let s=0;s<n.length-1;s+=2){try{const o=Ii(r[s+1],Ki,e);n[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Ii(r[s+2],i.type,e);n[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return n[n.length-1]=i,n}function PW(r,t,e){let i=r[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let n;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],n=gn}else n=Ae;const s=new Array(i.length);for(let o=0;o<s.length;o++)try{const a=Ii(i[o],n,e);s[o]=a}catch(a){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${a.message}`)}return[Ii(r[1],n,e),...s]}function AW(r,t,e){let i;try{i=Ii(r[1],Ae,e)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const n=r[2];if(!Array.isArray(n))throw new Error("the second argument of palette must be an array");const s=new Array(n.length);for(let o=0;o<s.length;o++){let a;try{a=Ii(n[o],Ss,e)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof li))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function se(...r){return function(t,e,i){const n=t[0];let s;for(let o=0;o<r.length;o++){const a=r[o](t,e,i);if(o==r.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new bW(e,n,...s)}}function LW(r,t,e){const i=r[0],n=kW[i];if(!n)throw new Error(`unknown operator: ${i}`);return n(r,t,e)}function yP(r){if(!r)return"";const t=r.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return yP(r.getGeometries()[0]);default:return""}}function _P(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function _a(r,t,e){const i=Ii(r,t,e);return Gs(i)}function Gs(r,t){if(r instanceof li){if(r.type===Ss&&typeof r.value=="string"){const i=ik(r.value);return function(){return i}}return function(){return r.value}}const e=r.operator;switch(e){case Q.Number:case Q.String:case Q.Coalesce:return OW(r);case Q.Get:case Q.Var:case Q.Has:return FW(r);case Q.Id:return i=>i.featureId;case Q.GeometryType:return i=>i.geometryType;case Q.Concat:{const i=r.args.map(n=>Gs(n));return n=>"".concat(...i.map(s=>s(n).toString()))}case Q.Resolution:return i=>i.resolution;case Q.Any:case Q.All:case Q.Between:case Q.In:case Q.Not:return DW(r);case Q.Equal:case Q.NotEqual:case Q.LessThan:case Q.LessThanOrEqualTo:case Q.GreaterThan:case Q.GreaterThanOrEqualTo:return NW(r);case Q.Multiply:case Q.Divide:case Q.Add:case Q.Subtract:case Q.Clamp:case Q.Mod:case Q.Pow:case Q.Abs:case Q.Floor:case Q.Ceil:case Q.Round:case Q.Sin:case Q.Cos:case Q.Atan:case Q.Sqrt:return $W(r);case Q.Case:return GW(r);case Q.Match:return jW(r);case Q.Interpolate:return zW(r);case Q.ToString:return qW(r);default:throw new Error(`Unsupported operator ${e}`)}}function OW(r,t){const e=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Gs(r.args[s]);switch(e){case Q.Coalesce:return s=>{for(let o=0;o<i;++o){const a=n[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case Q.Number:case Q.String:return s=>{for(let o=0;o<i;++o){const a=n[o](s);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function FW(r,t){const e=r.args[0].value;switch(r.operator){case Q.Get:return i=>{const n=r.args;let s=i.properties[e];for(let o=1,a=n.length;o<a;++o){const l=n[o].value;s=s[l]}return s};case Q.Var:return i=>i.variables[e];case Q.Has:return i=>{const n=r.args;if(!(e in i.properties))return!1;let s=i.properties[e];for(let o=1,a=n.length;o<a;++o){const l=n[o].value;if(!s||!Object.hasOwn(s,l))return!1;s=s[l]}return!0};default:throw new Error(`Unsupported accessor operator ${r.operator}`)}}function NW(r,t){const e=r.operator,i=Gs(r.args[0]),n=Gs(r.args[1]);switch(e){case Q.Equal:return s=>i(s)===n(s);case Q.NotEqual:return s=>i(s)!==n(s);case Q.LessThan:return s=>i(s)<n(s);case Q.LessThanOrEqualTo:return s=>i(s)<=n(s);case Q.GreaterThan:return s=>i(s)>n(s);case Q.GreaterThanOrEqualTo:return s=>i(s)>=n(s);default:throw new Error(`Unsupported comparison operator ${e}`)}}function DW(r,t){const e=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Gs(r.args[s]);switch(e){case Q.Any:return s=>{for(let o=0;o<i;++o)if(n[o](s))return!0;return!1};case Q.All:return s=>{for(let o=0;o<i;++o)if(!n[o](s))return!1;return!0};case Q.Between:return s=>{const o=n[0](s),a=n[1](s),l=n[2](s);return o>=a&&o<=l};case Q.In:return s=>{const o=n[0](s);for(let a=1;a<i;++a)if(o===n[a](s))return!0;return!1};case Q.Not:return s=>!n[0](s);default:throw new Error(`Unsupported logical operator ${e}`)}}function $W(r,t){const e=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Gs(r.args[s]);switch(e){case Q.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=n[a](s);return o};case Q.Divide:return s=>n[0](s)/n[1](s);case Q.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=n[a](s);return o};case Q.Subtract:return s=>n[0](s)-n[1](s);case Q.Clamp:return s=>{const o=n[0](s),a=n[1](s);if(o<a)return a;const l=n[2](s);return o>l?l:o};case Q.Mod:return s=>n[0](s)%n[1](s);case Q.Pow:return s=>Math.pow(n[0](s),n[1](s));case Q.Abs:return s=>Math.abs(n[0](s));case Q.Floor:return s=>Math.floor(n[0](s));case Q.Ceil:return s=>Math.ceil(n[0](s));case Q.Round:return s=>Math.round(n[0](s));case Q.Sin:return s=>Math.sin(n[0](s));case Q.Cos:return s=>Math.cos(n[0](s));case Q.Atan:return i===2?s=>Math.atan2(n[0](s),n[1](s)):s=>Math.atan(n[0](s));case Q.Sqrt:return s=>Math.sqrt(n[0](s));default:throw new Error(`Unsupported numeric operator ${e}`)}}function GW(r,t){const e=r.args.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=Gs(r.args[n]);return n=>{for(let s=0;s<e-1;s+=2)if(i[s](n))return i[s+1](n);return i[e-1](n)}}function jW(r,t){const e=r.args.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=Gs(r.args[n]);return n=>{const s=i[0](n);for(let o=1;o<e-1;o+=2)if(s===i[o](n))return i[o+1](n);return i[e-1](n)}}function zW(r,t){const e=r.args.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=Gs(r.args[n]);return n=>{const s=i[0](n),o=i[1](n);let a,l;for(let c=2;c<e;c+=2){const h=i[c](n);let u=i[c+1](n);const d=Array.isArray(u);if(d&&(u=FU(u)),h>=o)return c===2?u:d?BW(s,o,a,l,h,u):Ud(s,o,a,l,h,u);a=h,l=u}return l}}function qW(r,t){const e=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Gs(r.args[s]);switch(e){case Q.ToString:return s=>{const o=n[0](s);return r.args[0].type===Ss?nk(o):o.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function Ud(r,t,e,i,n,s){const o=n-e;if(o===0)return i;const a=t-e,l=r===1?a/o:(Math.pow(r,a)-1)/(Math.pow(r,o)-1);return i+l*(s-i)}function BW(r,t,e,i,n,s){if(n-e===0)return i;const o=LC(i),a=LC(s);let l=a[2]-o[2];l>180?l-=360:l<-180&&(l+=360);const c=[Ud(r,t,e,o[0],n,a[0]),Ud(r,t,e,o[1],n,a[1]),o[2]+Ud(r,t,e,0,n,l),Ud(r,t,e,i[3],n,s[3])];return NU(c)}function UW(r){return!0}function WW(r){const t=mP(),e=VW(r,t),i=_P();return function(n,s){if(i.properties=n.getPropertiesInternal(),i.resolution=s,t.featureId){const o=n.getId();o!==void 0?i.featureId=o:i.featureId=null}return t.geometryType&&(i.geometryType=yP(n.getGeometry())),e(i)}}function ZC(r){const t=mP(),e=r.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=n2(r[o],t);const n=_P(),s=new Array(e);return function(o,a){if(n.properties=o.getPropertiesInternal(),n.resolution=a,t.featureId){const c=o.getId();c!==void 0?n.featureId=c:n.featureId=null}let l=0;for(let c=0;c<e;++c){const h=i[c](n);h&&(s[l]=h,l+=1)}return s.length=l,s}}function VW(r,t){const e=r.length,i=new Array(e);for(let n=0;n<e;++n){const s=r[n],o="filter"in s?_a(s.filter,Ki,t):UW;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=n2(s.style[c],t)}else a=[n2(s.style,t)];i[n]={filter:o,styles:a}}return function(n){const s=[];let o=!1;for(let a=0;a<e;++a){const l=i[a].filter;if(l(n)&&!(r[a].else&&o)){o=!0;for(const c of i[a].styles){const h=c(n);h&&s.push(h)}}}return s}}function n2(r,t){const e=tf(r,"",t),i=ef(r,"",t),n=ZW(r,t),s=HW(r,t),o=vn(r,"z-index",t);if(!e&&!i&&!n&&!s&&!yl(r))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(r));const a=new Vr;return function(l){let c=!0;if(e){const h=e(l);h&&(c=!1),a.setFill(h)}if(i){const h=i(l);h&&(c=!1),a.setStroke(h)}if(n){const h=n(l);h&&(c=!1),a.setText(h)}if(s){const h=s(l);h&&(c=!1),a.setImage(h)}return o&&a.setZIndex(o(l)),c?null:a}}function tf(r,t,e){let i;if(t+"fill-pattern-src"in r)i=QW(r,t+"fill-",e);else{if(r[t+"fill-color"]==="none")return s=>null;i=ck(r,t+"fill-color",e)}if(!i)return null;const n=new ts;return function(s){const o=i(s);return o===rk?null:(n.setColor(o),n)}}function ef(r,t,e){const i=vn(r,t+"stroke-width",e),n=ck(r,t+"stroke-color",e);if(!i&&!n)return null;const s=jo(r,t+"stroke-line-cap",e),o=jo(r,t+"stroke-line-join",e),a=vP(r,t+"stroke-line-dash",e),l=vn(r,t+"stroke-line-dash-offset",e),c=vn(r,t+"stroke-miter-limit",e),h=new so;return function(u){if(n){const d=n(u);if(d===rk)return null;h.setColor(d)}if(i&&h.setWidth(i(u)),s){const d=s(u);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(d)}if(o){const d=o(u);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(d)}return a&&h.setLineDash(a(u)),l&&h.setLineDashOffset(l(u)),c&&h.setMiterLimit(c(u)),h}}function ZW(r,t){const e="text-",i=jo(r,e+"value",t);if(!i)return null;const n=tf(r,e,t),s=tf(r,e+"background-",t),o=ef(r,e,t),a=ef(r,e+"background-",t),l=jo(r,e+"font",t),c=vn(r,e+"max-angle",t),h=vn(r,e+"offset-x",t),u=vn(r,e+"offset-y",t),d=lu(r,e+"overflow",t),g=jo(r,e+"placement",t),f=vn(r,e+"repeat",t),p=U1(r,e+"scale",t),m=lu(r,e+"rotate-with-view",t),y=vn(r,e+"rotation",t),_=jo(r,e+"align",t),x=jo(r,e+"justify",t),v=jo(r,e+"baseline",t),w=lu(r,e+"keep-upright",t),b=vP(r,e+"padding",t),E=W1(r,e+"declutter-mode"),C=new lP({declutterMode:E});return function(S){if(C.setText(i(S)),n&&C.setFill(n(S)),s&&C.setBackgroundFill(s(S)),o&&C.setStroke(o(S)),a&&C.setBackgroundStroke(a(S)),l&&C.setFont(l(S)),c&&C.setMaxAngle(c(S)),h&&C.setOffsetX(h(S)),u&&C.setOffsetY(u(S)),d&&C.setOverflow(d(S)),g){const R=g(S);if(R!=="point"&&R!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(R)}if(f&&C.setRepeat(f(S)),p&&C.setScale(p(S)),m&&C.setRotateWithView(m(S)),y&&C.setRotation(y(S)),_){const R=_(S);if(R!=="left"&&R!=="center"&&R!=="right"&&R!=="end"&&R!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(R)}if(x){const R=x(S);if(R!=="left"&&R!=="right"&&R!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(R)}if(v){const R=v(S);if(R!=="bottom"&&R!=="top"&&R!=="middle"&&R!=="alphabetic"&&R!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(R)}return b&&C.setPadding(b(S)),w&&C.setKeepUpright(w(S)),C}}function HW(r,t){return"icon-src"in r?YW(r,t):"shape-points"in r?XW(r,t):"circle-radius"in r?KW(r,t):null}function YW(r,t){const e="icon-",i=e+"src",n=xP(r[i],i),s=_m(r,e+"anchor",t),o=U1(r,e+"scale",t),a=vn(r,e+"opacity",t),l=_m(r,e+"displacement",t),c=vn(r,e+"rotation",t),h=lu(r,e+"rotate-with-view",t),u=YC(r,e+"anchor-origin"),d=XC(r,e+"anchor-x-units"),g=XC(r,e+"anchor-y-units"),f=rV(r,e+"color"),p=tV(r,e+"cross-origin"),m=eV(r,e+"offset"),y=YC(r,e+"offset-origin"),_=vm(r,e+"width"),x=vm(r,e+"height"),v=JW(r,e+"size"),w=W1(r,e+"declutter-mode"),b=new kl({src:n,anchorOrigin:u,anchorXUnits:d,anchorYUnits:g,color:f,crossOrigin:p,offset:m,offsetOrigin:y,height:x,width:_,size:v,declutterMode:w});return function(E){return a&&b.setOpacity(a(E)),l&&b.setDisplacement(l(E)),c&&b.setRotation(c(E)),h&&b.setRotateWithView(h(E)),o&&b.setScale(o(E)),s&&b.setAnchor(s(E)),b}}function XW(r,t){const e="shape-",i=e+"points",n=e+"radius",s=s2(r[i],i),o=s2(r[n],n),a=tf(r,e,t),l=ef(r,e,t),c=U1(r,e+"scale",t),h=_m(r,e+"displacement",t),u=vn(r,e+"rotation",t),d=lu(r,e+"rotate-with-view",t),g=vm(r,e+"radius2"),f=vm(r,e+"angle"),p=W1(r,e+"declutter-mode"),m=new nP({points:s,radius:o,radius2:g,angle:f,declutterMode:p});return function(y){return a&&m.setFill(a(y)),l&&m.setStroke(l(y)),h&&m.setDisplacement(h(y)),u&&m.setRotation(u(y)),d&&m.setRotateWithView(d(y)),c&&m.setScale(c(y)),m}}function KW(r,t){const e="circle-",i=tf(r,e,t),n=ef(r,e,t),s=vn(r,e+"radius",t),o=U1(r,e+"scale",t),a=_m(r,e+"displacement",t),l=vn(r,e+"rotation",t),c=lu(r,e+"rotate-with-view",t),h=W1(r,e+"declutter-mode"),u=new B1({radius:5,declutterMode:h});return function(d){return s&&u.setRadius(s(d)),i&&u.setFill(i(d)),n&&u.setStroke(n(d)),a&&u.setDisplacement(a(d)),l&&u.setRotation(l(d)),c&&u.setRotateWithView(c(d)),o&&u.setScale(o(d)),u}}function vn(r,t,e){if(!(t in r))return;const i=_a(r[t],Ae,e);return function(n){return s2(i(n),t)}}function jo(r,t,e){if(!(t in r))return null;const i=_a(r[t],gn,e);return function(n){return xP(i(n),t)}}function QW(r,t,e){const i=jo(r,t+"pattern-src",e),n=HC(r,t+"pattern-offset",e),s=HC(r,t+"pattern-size",e),o=ck(r,t+"color",e);return function(a){return{src:i(a),offset:n&&n(a),size:s&&s(a),color:o&&o(a)}}}function lu(r,t,e){if(!(t in r))return null;const i=_a(r[t],Ki,e);return function(n){const s=i(n);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${t}`);return s}}function ck(r,t,e){if(!(t in r))return null;const i=_a(r[t],Ss,e);return function(n){return wP(i(n),t)}}function vP(r,t,e){if(!(t in r))return null;const i=_a(r[t],Fc,e);return function(n){return Zf(i(n),t)}}function _m(r,t,e){if(!(t in r))return null;const i=_a(r[t],Fc,e);return function(n){const s=Zf(i(n),t);if(s.length!==2)throw new Error(`Expected two numbers for ${t}`);return s}}function HC(r,t,e){if(!(t in r))return null;const i=_a(r[t],Fc,e);return function(n){return bP(i(n),t)}}function U1(r,t,e){if(!(t in r))return null;const i=_a(r[t],Fc|Ae,e);return function(n){return iV(i(n),t)}}function vm(r,t){const e=r[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function JW(r,t){const e=r[t];if(e!==void 0){if(typeof e=="number")return Ui(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function tV(r,t){const e=r[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function YC(r,t){const e=r[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function XC(r,t){const e=r[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function eV(r,t){const e=r[t];if(e!==void 0)return Zf(e,t)}function W1(r,t){const e=r[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function rV(r,t){const e=r[t];if(e!==void 0)return wP(e,t)}function Zf(r,t){if(!Array.isArray(r))throw new Error(`Expected an array for ${t}`);const e=r.length;for(let i=0;i<e;++i)if(typeof r[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return r}function xP(r,t){if(typeof r!="string")throw new Error(`Expected a string for ${t}`);return r}function s2(r,t){if(typeof r!="number")throw new Error(`Expected a number for ${t}`);return r}function wP(r,t){if(typeof r=="string")return r;const e=Zf(r,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function bP(r,t){const e=Zf(r,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function iV(r,t){return typeof r=="number"?r:bP(r,t)}const vs={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function KC(r,t,e){return(function(i,n,s,o,a){if(!i)return;if(!n&&!t)return i;const l=t?0:s[0]*n,c=t?0:s[1]*n,h=a?a[0]:0,u=a?a[1]:0;let d=r[0]+l/2+h,g=r[2]-l/2+h,f=r[1]+c/2+u,p=r[3]-c/2+u;d>g&&(d=(g+d)/2,g=d),f>p&&(f=(p+f)/2,p=f);let m=kr(i[0],d,g),y=kr(i[1],f,p);if(o&&e&&n){const _=30*n;m+=-_*Math.log(1+Math.max(0,d-i[0])/_)+_*Math.log(1+Math.max(0,i[0]-g)/_),y+=-_*Math.log(1+Math.max(0,f-i[1])/_)+_*Math.log(1+Math.max(0,i[1]-p)/_)}return[m,y]})}function nV(r){return r}function hk(r,t,e,i){const n=Me(t)/e[0],s=Ar(t)/e[1];return i?Math.min(r,Math.max(n,s)):Math.min(r,Math.min(n,s))}function uk(r,t,e){let i=Math.min(r,t);const n=50;return i*=Math.log(1+n*Math.max(0,r/t-1))/n+1,e&&(i=Math.max(i,e),i/=Math.log(1+n*Math.max(0,e/r-1))/n+1),kr(i,e/2,t*2)}function sV(r,t,e,i){return t=t!==void 0?t:!0,(function(n,s,o,a){if(n!==void 0){const l=r[0],c=r[r.length-1],h=e?hk(l,e,o,i):l;if(a)return t?uk(n,h,c):kr(n,c,h);const u=Math.min(h,n),d=Math.floor(e1(r,u,s));return r[d]>h&&d<r.length-1?r[d+1]:r[d]}})}function oV(r,t,e,i,n,s){return i=i!==void 0?i:!0,e=e!==void 0?e:0,(function(o,a,l,c){if(o!==void 0){const h=n?hk(t,n,l,s):t;if(c)return i?uk(o,h,e):kr(o,e,h);const u=1e-9,d=Math.ceil(Math.log(t/h)/Math.log(r)-u),g=-a*(.5-u)+.5,f=Math.min(h,o),p=Math.floor(Math.log(t/f)/Math.log(r)+g),m=Math.max(d,p),y=t/Math.pow(r,m);return kr(y,e,h)}})}function QC(r,t,e,i,n){return e=e!==void 0?e:!0,(function(s,o,a,l){if(s!==void 0){const c=i?hk(r,i,a,n):r;return!e||!l?kr(s,t,c):uk(s,c,t)}})}function dk(r){if(r!==void 0)return 0}function JC(r){if(r!==void 0)return r}function aV(r){const t=2*Math.PI/r;return(function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e})}function lV(r){const t=ao(5);return(function(e,i){return i||e===void 0?e:Math.abs(e)<=t?0:e})}const kP=42,gk=256,j_=0;class Qs extends zs{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Sw(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&YM(),t.center&&(t.center=fr(t.center,this.projection_)),t.extent&&(t.extent=Cs(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in vs)delete e[a];this.setProperties(e,!0);const i=hV(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=cV(t),s=i.constraint,o=uV(t);this.constraints_={center:n,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),o=s/2*(n[3]-e[3]+e[1]-n[1]),a=s/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let n=arguments[i];n.center&&(n=Object.assign({},n),n.center=fr(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=fr(n.anchor,this.getProjection())),e[i]=n}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let n=0;for(;n<e&&!this.isDef();++n){const h=arguments[n];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(n===e){i&&Op(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;n<e;++n){const h=arguments[n],u={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||lF,callback:i};if(h.center&&(u.sourceCenter=o,u.targetCenter=h.center.slice(),o=u.targetCenter),h.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(h.zoom),a=u.targetResolution):h.resolution&&(u.sourceResolution=a,u.targetResolution=h.resolution,a=u.targetResolution),h.rotation!==void 0){u.sourceRotation=l;const d=cl(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+d,l=u.targetRotation}dV(u)?u.complete=!0:s+=u.duration,c.push(u)}this.animations_.push(c),this.setHint(vr.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[vr.ANIMATING]>0}getInteracting(){return this.hints_[vr.INTERACTING]>0}cancelAnimations(){this.setHint(vr.ANIMATING,-this.hints_[vr.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){const n=this.animations_[e];if(n[0].callback&&Op(n[0].callback,!1),!t)for(let s=0,o=n.length;s<o;++s){const a=n[s];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let s=!0;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(l.complete)continue;const c=t-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const u=l.easing(h);if(l.sourceCenter){const d=l.sourceCenter[0],g=l.sourceCenter[1],f=l.targetCenter[0],p=l.targetCenter[1];this.nextCenter_=l.targetCenter;const m=d+u*(f-d),y=g+u*(p-g);this.targetCenter_=[m,y]}if(l.sourceResolution&&l.targetResolution){const d=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const g=this.getViewportSize_(this.getRotation()),f=this.constraints_.resolution(d,0,g,!0);this.targetCenter_=this.calculateCenterZoom(f,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=u===1?cl(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const g=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(g,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(vr.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=n[0].callback;o&&Op(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();return n!==void 0&&(i=[n[0]-e[0],n[1]-e[1]],xw(i,t-this.getRotation()),qM(i,e)),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),s=this.getResolution();if(n!==void 0&&s!==void 0){const o=e[0]-t*(e[0]-n[0])/s,a=e[1]-t*(e[1]-n[1])/s;i=[o,a]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Tc(t,this.getProjection())}getCenterInternal(){return this.get(vs.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return l1(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();Re(e,"The view center is not defined");const i=this.getResolution();Re(i!==void 0,"The view resolution is not defined");const n=this.getRotation();return Re(n!==void 0,"The view rotation is not defined"),kg(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(vs.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Cs(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=Me(t)/e[0],n=Ar(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return(function(s){return e/Math.pow(t,s*n)})}getRotation(){return this.get(vs.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(i/n)/e;return(function(o){return Math.log(i/o)/e/s})}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();n=z_(n,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],e,i)}return{center:n.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,n;if(this.resolutions_){const s=e1(this.resolutions_,t,1);e=s,i=this.resolutions_[s],s==this.resolutions_.length-1?n=2:n=i/this.resolutions_[s+1]}else i=this.maxResolution_,n=this.zoomFactor_;return e+Math.log(i/t)/Math.log(n)}getResolutionForZoom(t){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const e=kr(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,kr(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(Re(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){Re(!Bc(t),"Cannot fit empty extent provided as `geometry`");const n=Cs(t,this.getProjection());i=RC(n)}else if(t.getType()==="Circle"){const n=Cs(t.getExtent(),this.getProjection());i=RC(n),i.rotate(this.getRotation(),Wi(n))}else i=t;this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),s=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,c=-1/0,h=-1/0;for(let u=0,d=s.length;u<d;u+=o){const g=s[u]*i-s[u+1]*n,f=s[u]*n+s[u+1]*i;a=Math.min(a,g),l=Math.min(l,f),c=Math.max(c,g),h=Math.max(h,f)}return[a,l,c,h]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());const n=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),u=Math.cos(c),d=Wi(a);d[0]+=(n[1]-n[3])/2*l,d[1]+=(n[0]-n[2])/2*l;const g=d[0]*u-d[1]*h,f=d[1]*u+d[0]*h,p=this.getConstrainedCenter([g,f],l),m=e.callback?e.callback:bg;e.duration!==void 0?this.animateInternal({resolution:l,center:p,duration:e.duration,easing:e.easing},m):(this.targetResolution_=l,this.targetCenter_=p,this.applyTargetState_(!1,!0),Op(m,!0))}centerOn(t,e,i){this.centerOnInternal(fr(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(z_(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let s;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),l=z_(t,n,[a[0]/2+o[3],a[1]/2+o[0]],e,i);s=[t[0]-l[0],t[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Tc(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&fr(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=fr(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&fr(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,n,s));this.get(vs.ROTATION)!==n&&this.set(vs.ROTATION,n),this.get(vs.RESOLUTION)!==o&&(this.set(vs.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(vs.CENTER)||!Xi(this.get(vs.CENTER),a))&&this.set(vs.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const n=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,n,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!Xi(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:t,easing:Tl,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(vr.INTERACTING,1)}endInteraction(t,e,i){i=i&&fr(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(vr.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}}function Op(r,t){setTimeout(function(){r(t)},0)}function cV(r){if(r.extent!==void 0){const e=r.smoothExtentConstraint!==void 0?r.smoothExtentConstraint:!0;return KC(r.extent,r.constrainOnlyCenter,e)}const t=Sw(r.projection,"EPSG:3857");if(r.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,KC(e,!1,!1)}return nV}function hV(r){let t,e,i,n=r.minZoom!==void 0?r.minZoom:j_,s=r.maxZoom!==void 0?r.maxZoom:28;const o=r.zoomFactor!==void 0?r.zoomFactor:2,a=r.multiWorld!==void 0?r.multiWorld:!1,l=r.smoothResolutionConstraint!==void 0?r.smoothResolutionConstraint:!0,c=r.showFullExtent!==void 0?r.showFullExtent:!1,h=Sw(r.projection,"EPSG:3857"),u=h.getExtent();let d=r.constrainOnlyCenter,g=r.extent;if(!a&&!g&&h.isGlobal()&&(d=!1,g=u),r.resolutions!==void 0){const f=r.resolutions;e=f[n],i=f[s]!==void 0?f[s]:f[f.length-1],r.constrainResolution?t=sV(f,l,!d&&g,c):t=QC(e,i,l,!d&&g,c)}else{const f=(u?Math.max(Me(u),Ar(u)):360*ea.degrees/h.getMetersPerUnit())/gk/Math.pow(2,j_),p=f/Math.pow(2,28-j_);e=r.maxResolution,e!==void 0?n=0:e=f/Math.pow(o,n),i=r.minResolution,i===void 0&&(r.maxZoom!==void 0?r.maxResolution!==void 0?i=e/Math.pow(o,s):i=f/Math.pow(o,s):i=p),s=n+Math.floor(Math.log(e/i)/Math.log(o)),i=e/Math.pow(o,s-n),r.constrainResolution?t=oV(o,e,i,l,!d&&g,c):t=QC(e,i,l,!d&&g,c)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:n,zoomFactor:o}}function uV(r){if(r.enableRotation===void 0||r.enableRotation){const t=r.constrainRotation;return t===void 0||t===!0?lV():t===!1?JC:typeof t=="number"?aV(t):JC}return dk}function dV(r){return!(r.sourceCenter&&r.targetCenter&&!Xi(r.sourceCenter,r.targetCenter)||r.sourceResolution!==r.targetResolution||r.sourceRotation!==r.targetRotation)}function z_(r,t,e,i,n){const s=Math.cos(-n);let o=Math.sin(-n),a=r[0]*s-r[1]*o,l=r[1]*s+r[0]*o;a+=(t[0]/2-e[0])*i,l+=(e[1]-t[1]/2)*i,o=-o;const c=a*s-l*o,h=l*s+a*o;return[c,h]}const Qe={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class EP extends zs{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[Qe.OPACITY]=t.opacity!==void 0?t.opacity:1,Re(typeof e[Qe.OPACITY]=="number","Layer opacity must be a number"),e[Qe.VISIBLE]=t.visible!==void 0?t.visible:!0,e[Qe.Z_INDEX]=t.zIndex,e[Qe.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[Qe.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[Qe.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[Qe.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=kr(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return te()}getLayerStatesArray(t){return te()}getExtent(){return this.get(Qe.EXTENT)}getMaxResolution(){return this.get(Qe.MAX_RESOLUTION)}getMinResolution(){return this.get(Qe.MIN_RESOLUTION)}getMinZoom(){return this.get(Qe.MIN_ZOOM)}getMaxZoom(){return this.get(Qe.MAX_ZOOM)}getOpacity(){return this.get(Qe.OPACITY)}getSourceState(){return te()}getVisible(){return this.get(Qe.VISIBLE)}getZIndex(){return this.get(Qe.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Qe.EXTENT,t)}setMaxResolution(t){this.set(Qe.MAX_RESOLUTION,t)}setMinResolution(t){this.set(Qe.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(Qe.MAX_ZOOM,t)}setMinZoom(t){this.set(Qe.MIN_ZOOM,t)}setOpacity(t){Re(typeof t=="number","Layer opacity must be a number"),this.set(Qe.OPACITY,t)}setVisible(t){this.set(Qe.VISIBLE,t)}setZIndex(t){this.set(Qe.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Kc extends EP{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(Qe.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(Qe.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(sr(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=Oe(t,Vt.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof Qs?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let n;if(e.layerStatesArray){if(n=e.layerStatesArray.find(o=>o.layer===this),!n)return!1}else n=this.getLayerState();const s=this.getExtent();return fk(n,e.viewState)&&(!s||wr(s,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];const i=t instanceof Qs?t.getViewStateAndExtent():t;let n=e(i);return Array.isArray(n)||(n=[n]),n}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(Qe.MAP,t)}getMapInternal(){return this.get(Qe.MAP)}setMap(t){this.mapPrecomposeKey_&&(sr(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(sr(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Oe(t,Qn.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Oe(this,Vt.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);Re(!e.some(n=>n.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}setSource(t){this.set(Qe.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function fk(r,t){if(!r.visible)return!1;const e=t.resolution;if(e<r.minResolution||e>=r.maxResolution)return!1;const i=t.zoom;return i>r.minZoom&&i<=r.maxZoom}const t5={RENDER_ORDER:"renderOrder"};class V1 extends Kc{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(t5.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter||(t.declutter[i]=new h1(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(t5.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?aP:t;const e=gV(t);this.styleFunction_=t===null?void 0:rW(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}}function gV(r){if(r===void 0)return aP;if(!r)return null;if(typeof r=="function"||r instanceof Vr)return r;if(!Array.isArray(r))return ZC([r]);if(r.length===0)return[];const t=r.length,e=r[0];if(e instanceof Vr){const i=new Array(t);for(let n=0;n<t;++n){const s=r[n];if(!(s instanceof Vr))throw new Error("Expected a list of style instances");i[n]=s}return i}if("style"in e){const i=new Array(t);for(let n=0;n<t;++n){const s=r[n];if(!("style"in s))throw new Error("Expected a list of rules with a style property");i[n]=s}return WW(i)}return ZC(r)}class fs extends V1{constructor(t){super(t)}createRenderer(){return new vW(this)}}function o2(r,t,e){const i=ar().getPluginStore("toast");i&&(typeof t=="function"&&(t=ZI(t)),i.addToast({severity:r,text:t},e))}let Ah=class extends on{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}},No=class extends Ah{constructor(t,e,i,n,s,o){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=n!==void 0?n:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}};const Le={SINGLECLICK:"singleclick",CLICK:Vt.CLICK,DBLCLICK:Vt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},xm={ACTIVE:"active"};let Ju=class extends zs{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(xm.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(xm.ACTIVE,t)}setMap(t){this.map_=t}};function fV(r,t,e){const i=r.getCenterInternal();if(i){const n=[i[0]+t[0],i[1]+t[1]];r.animateInternal({duration:e!==void 0?e:250,easing:cF,center:r.getConstrainedCenter(n)})}}function pk(r,t,e,i){const n=r.getZoom();if(n===void 0)return;const s=r.getConstrainedZoom(n+t),o=r.getResolutionForZoom(s);r.getAnimating()&&r.cancelAnimations(),r.animate({resolution:o,anchor:e,duration:i!==void 0?i:250,easing:Tl})}function a2(r){const t=arguments;return function(e){let i=!0;for(let n=0,s=t.length;n<s&&(i=i&&t[n](e),!!i);++n);return i}}const pV=function(r){const t=r.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},mV=function(r){const t=r.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},yV=function(r){const t=r.map.getTargetElement(),e=t.getRootNode(),i=r.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(i):t.contains(i)},SP=function(r){const t=r.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?yV(r):!0},gc=mo,TP=function(r){const t=r.originalEvent;return"pointerId"in t&&t.button==0&&!(uF&&Tw&&t.ctrlKey)},wm=qu,_V=function(r){return r.type=="pointermove"},CP=function(r){return r.type==Le.SINGLECLICK},mk=function(r){const t=r.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},vV=function(r){const t=r.originalEvent;return!t.altKey&&(Tw?t.metaKey:t.ctrlKey)&&!t.shiftKey},xV=function(r){const t=r.originalEvent;return Tw?t.metaKey:t.ctrlKey},bm=function(r){const t=r.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},MP=function(r){const t=r.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},q_=function(r){const t=r.originalEvent;return"pointerId"in t&&t.pointerType=="mouse"},RP=function(r){const t=r.originalEvent;return"pointerId"in t&&t.isPrimary&&t.button===0};let Rl=class extends Ju{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Le.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Le.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Le.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==Le.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function yk(r){const t=r.length;let e=0,i=0;for(let n=0;n<t;n++)e+=r[n].clientX,i+=r[n].clientY;return{clientX:e/t,clientY:i/t}}const Do={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Li={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};let wV=class extends zs{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=t.insertFirst!==void 0?t.insertFirst:!0,this.stopEvent=t.stopEvent!==void 0?t.stopEvent:!0,this.element=document.createElement("div"),this.element.className=t.className!==void 0?t.className:"ol-overlay-container "+pF,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=t.autoPan===!0?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Li.ELEMENT,this.handleElementChanged),this.addChangeListener(Li.MAP,this.handleMapChanged),this.addChangeListener(Li.OFFSET,this.handleOffsetChanged),this.addChangeListener(Li.POSITION,this.handlePositionChanged),this.addChangeListener(Li.POSITIONING,this.handlePositioningChanged),t.element!==void 0&&this.setElement(t.element),this.setOffset(t.offset!==void 0?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),t.position!==void 0&&this.setPosition(t.position)}getElement(){return this.get(Li.ELEMENT)}getId(){return this.id}getMap(){return this.get(Li.MAP)||null}getOffset(){return this.get(Li.OFFSET)}getPosition(){return this.get(Li.POSITION)}getPositioning(){return this.get(Li.POSITIONING)}handleElementChanged(){tR(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(this.element?.remove(),sr(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=Oe(t,Do.POSTRENDER,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(Li.ELEMENT,t)}setMap(t){this.set(Li.MAP,t)}setOffset(t){this.set(Li.OFFSET,t)}setPosition(t){this.set(Li.POSITION,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Li.POSITION))return;const i=this.getRect(e.getTargetElement(),e.getSize()),n=this.getElement(),s=this.getRect(n,[dF(n),gF(n)]);t=t||{};const o=t.margin===void 0?20:t.margin;if(!eo(i,s)){const a=s[0]-i[0],l=i[2]-s[2],c=s[1]-i[1],h=i[3]-s[3],u=[0,0];if(a<0?u[0]=a-o:l<0&&(u[0]=Math.abs(l)+o),c<0?u[1]=c-o:h<0&&(u[1]=Math.abs(h)+o),u[0]!==0||u[1]!==0){const d=e.getView().getCenterInternal(),g=e.getPixelFromCoordinateInternal(d);if(!g)return;const f=[g[0]+u[0],g[1]+u[1]],p=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(f),duration:p.duration,easing:p.easing})}}}getRect(t,e){const i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,s=i.top+window.pageYOffset;return[n,s,n+e[0],s+e[1]]}setPositioning(t){this.set(Li.POSITIONING,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e){this.setVisible(!1);return}const i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}updateRenderedPosition(t,e){const i=this.element.style,n=this.getOffset(),s=this.getPositioning();this.setVisible(!0);const o=`${t[0]+n[0]}px`,a=`${t[1]+n[1]}px`;let l="0%",c="0%";s=="bottom-right"||s=="center-right"||s=="top-right"?l="-100%":(s=="bottom-center"||s=="center-center"||s=="top-center")&&(l="-50%"),s=="bottom-left"||s=="bottom-center"||s=="bottom-right"?c="-100%":(s=="center-left"||s=="center-center"||s=="center-right")&&(c="-50%");const h=`translate(${l}, ${c}) translate(${o}, ${a})`;this.rendered.transform_!=h&&(this.rendered.transform_=h,i.transform=h)}getOptions(){return this.options}};class kn extends ya{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){wi(this.flatCoordinates,t),this.changed()}clone(){const t=new kn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<qc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Zb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return zI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,t2(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return el(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return tk(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=$1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new kn(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return G1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=D1(this.flatCoordinates,0,t,this.stride),this.changed()}}let IP=class l2 extends Kg{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(sr),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(Oe(t[e],Vt.CHANGE,this.changed,this))}clone(){const t=new l2(B_(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<qc(this.getExtent(),t,e))return n;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)n=s[o].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,s=i.length;n<s;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){Uu(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)yw(t,e[i].getExtent());return t}getGeometries(){return B_(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(n=!0)}return n?new l2(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let n=0,s=i.length;n<s;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=Wi(this.getExtent()));const n=this.geometries_;for(let s=0,o=n.length;s<o;++s)n[s].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(B_(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,s=i.length;n<s;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}};function B_(r){return r.map(t=>t.clone())}let Qc=class c2 extends ya{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const n=t,s=[],o=[];for(let l=0,c=n.length;l<c;++l){const h=n[l];wi(s,h.getFlatCoordinates()),o.push(s.length)}const a=n.length===0?this.getLayout():n[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(t){wi(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new c2(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<qc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Vb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Hb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,SU(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return Qg(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new kn(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=new kn(t.slice(s,l),i);n.push(c),s=l}return n}getLength(){const t=this.ends_;let e=0,i=0;for(let n=0,s=t.length;n<s;++n)i+=tk(this.flatCoordinates,e,t[n],this.stride),e=t[n];return i}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,s=this.stride;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=gm(e,i,l,s,.5);wi(t,c),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=GI(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new c2(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return wU(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Wf(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}},td=class PP extends ya{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){wi(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new PP(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<qc(this.getExtent(),t,e))return n;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=Zo(t,e,s[a],s[a+1]);if(c<n){n=c;for(let h=0;h<o;++h)i[h]=s[a+h];i.length=o}}return n}getCoordinates(){return el(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Pi(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let s=0,o=t.length;s<o;s+=i){const a=new Pi(t.slice(s,s+i),e);n.push(a)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,s=e.length;n<s;n+=i){const o=e[n],a=e[n+1];if(pw(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=D1(this.flatCoordinates,0,t,this.stride),this.changed()}},Jc=class h2 extends ya{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,s=[],o=[];for(let a=0,l=n.length;a<l;++a){const c=n[a],h=s.length,u=c.getEnds();for(let d=0,g=u.length;d<g;++d)u[d]+=h;wi(s,c.getFlatCoordinates()),o.push(u)}e=n.length===0?this.getLayout():n[0].getLayout(),t=s,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;wi(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let n=0,s=e.length;n<s;++n)e[n]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let n=0;n<t;++n)e[n]=this.endss_[n].slice();const i=new h2(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<qc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(pU(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),mU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return xU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return fU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Qx(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Xx(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=VI(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=jI(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new td(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;UI(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Qx(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=_U(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new h2(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(e!==0)for(let s=0,o=i.length;s<o;++s)i[s]-=e;return new gs(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),c=l[l.length-1];if(s!==0)for(let u=0,d=l.length;u<d;++u)l[u]-=s;const h=new gs(e.slice(s,c),t,l);n.push(h),s=c}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return bU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=OI(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const n=i[i.length-1];this.flatCoordinates.length=n.length===0?0:n[n.length-1]}this.changed()}},_k=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=zi,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?ee(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=ee(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return te()}readFeature(t,e){return te()}readFeatures(t,e){return te()}readGeometry(t,e){return te()}readProjection(t){return te()}writeFeature(t,e){return te()}writeFeatures(t,e){return te()}writeGeometry(t,e){return te()}};function th(r,t,e){const i=e?ee(e.featureProjection):null,n=e?ee(e.dataProjection):null;let s=r;if(i&&n&&!Mi(i,n)){t&&(s=r.clone());const o=t?i:n,a=t?n:i;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(yo(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*o)/o;return l};s===r&&(s=r.clone()),s.applyTransform(a)}return s}function vk(r,t){const e=t?ee(t.featureProjection):null,i=t?ee(t.dataProjection):null;return e&&i&&!Mi(e,i)?ru(r,i,e):r}const bV={Point:Pi,LineString:kn,Polygon:gs,MultiPoint:td,MultiLineString:Qc,MultiPolygon:Jc};function kV(r,t,e){return Array.isArray(t[0])?(UI(r,0,t,e)||(r=r.slice(),Qx(r,0,t,e)),r):(Jb(r,0,t,e)||(r=r.slice(),dm(r,0,t,e)),r)}function AP(r,t){const e=r.geometry;if(!e)return[];if(Array.isArray(e))return e.map(s=>AP({...r,geometry:s})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const n=e.layout.length;return th(new Gi(i,i==="Polygon"?kV(e.flatCoordinates,e.ends,n):e.flatCoordinates,e.ends?.flat(),n,r.properties||{},r.id).enableSimplifyTransformed(),!1,t)}function xk(r,t){if(!r)return null;if(Array.isArray(r)){const i=r.map(n=>xk(n,t));return new IP(i)}const e=bV[r.type];return th(new e(r.flatCoordinates,r.layout||"XY",r.ends),!1,t)}let EV=class extends _k{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Fp(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Fp(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return te()}readFeaturesFromObject(t,e){return te()}readGeometry(t,e){return this.readGeometryFromObject(Fp(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return te()}readProjection(t){return this.readProjectionFromObject(Fp(t))}readProjectionFromObject(t){return te()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return te()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return te()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return te()}};function Fp(r){return typeof r=="string"?JSON.parse(r)||null:r!==null?r:null}let u2=class extends EV{constructor(t){t=t||{},super(),this.dataProjection=ee(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=ee(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const n=wk(i.geometry);if(this.featureClass===Gi)return AP({geometry:n,id:i.id,properties:i.properties},e);const s=new zi;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&s.setGeometryName(i.geometry_name),s.setGeometry(xk(n,e)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(t,e){const i=t;let n=null;if(i.type==="FeatureCollection"){const s=t;n=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],e);c&&n.push(c)}}else n=[this.readFeatureFromObject(t,e)];return n.flat()}readGeometryFromObject(t,e){return SV(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=ee(e.properties.name);else if(e.type==="EPSG")i=ee("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(n!==void 0&&(i.id=n),!t.hasProperties())return i;const s=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=d2(o,e),delete s[t.getGeometryName()]),yl(s)||(i.properties=s),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,s=t.length;n<s;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return d2(t,this.adaptOptions(e))}};function wk(r,t){if(!r)return null;let e;switch(r.type){case"Point":{e=CV(r);break}case"LineString":{e=MV(r);break}case"Polygon":{e=AV(r);break}case"MultiPoint":{e=IV(r);break}case"MultiLineString":{e=RV(r);break}case"MultiPolygon":{e=PV(r);break}case"GeometryCollection":{e=TV(r);break}default:throw new Error("Unsupported GeoJSON type: "+r.type)}return e}function SV(r,t){const e=wk(r);return xk(e,t)}function TV(r,t){return r.geometries.map(function(e){return wk(e)})}function CV(r){const t=r.coordinates;return{type:"Point",flatCoordinates:t,layout:Yc(t.length)}}function MV(r){const t=r.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:Yc(t[0]?.length||2)}}function RV(r){const t=r.coordinates,e=t[0]?.[0]?.length||2,i=[],n=Wf(i,0,t,e);return{type:"MultiLineString",flatCoordinates:i,ends:n,layout:Yc(e)}}function IV(r){const t=r.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:Yc(t[0]?.length||2)}}function PV(r){const t=r.coordinates,e=[],i=t[0]?.[0]?.[0].length||2,n=OI(e,0,t,i);return{type:"MultiPolygon",flatCoordinates:e,ends:n,layout:Yc(i)}}function AV(r){const t=r.coordinates,e=[],i=t[0]?.[0]?.length,n=Wf(e,0,t,i);return{type:"Polygon",flatCoordinates:e,ends:n,layout:Yc(i)}}function d2(r,t){r=th(r,!0,t);const e=r.getType();let i;switch(e){case"Point":{i=$V(r);break}case"LineString":{i=OV(r);break}case"Polygon":{i=GV(r,t);break}case"MultiPoint":{i=NV(r);break}case"MultiLineString":{i=FV(r);break}case"MultiPolygon":{i=DV(r,t);break}case"GeometryCollection":{i=LV(r,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function LV(r,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:r.getGeometriesArray().map(function(e){return d2(e,t)})}}function OV(r,t){return{type:"LineString",coordinates:r.getCoordinates()}}function FV(r,t){return{type:"MultiLineString",coordinates:r.getCoordinates()}}function NV(r,t){return{type:"MultiPoint",coordinates:r.getCoordinates()}}function DV(r,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:r.getCoordinates(e)}}function $V(r,t){return{type:"Point",coordinates:r.getCoordinates()}}function GV(r,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:r.getCoordinates(e)}}function jV(r,t){const e=r.canvas;t=t||{};const i=t.pixelRatio||KM,n=t.size;n&&(e.width=n[0]*i,e.height=n[1]*i,e.style.width=n[0]+"px",e.style.height=n[1]+"px");const s=[0,0,e.width,e.height],o=k0(rn(),i,i);return new QI(r,i,s,o,0)}class zV extends j1{constructor(t,e,i,n,s){const o=s!==void 0?St.IDLE:St.LOADED;super(t,e,i,o),this.loader_=s!==void 0?s:null,this.canvas_=n,this.error_=null}getError(){return this.error_}handleLoad_(t){t?(this.error_=t,this.state=St.ERROR):this.state=St.LOADED,this.changed()}load(){this.state==St.IDLE&&(this.state=St.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))}getImage(){return this.canvas_}}class LP extends Mf{constructor(t,e,i,n,s,o){super(t,e,o),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_,Hn?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,n!==null&&(this.image_.crossOrigin=n)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=yt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=yt.ERROR,this.unlistenImage_(),this.image_=qV(),this.changed()}handleImageLoad_(){if(Hn)this.state=yt.LOADED;else{const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=yt.LOADED:this.state=yt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==yt.ERROR&&(this.state=yt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==yt.IDLE&&(this.state=yt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=DU(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function qV(){const r=Or(1,1);return r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1),r.canvas}let BV=class{constructor(r,t,e){this.decay_=r,this.minVelocity_=t,this.delay_=e,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(r,t){this.points_.push(r,t,Date.now())}end(){if(this.points_.length<6)return!1;const r=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<r)return!1;let e=t-3;for(;e>0&&this.points_[e+2]>r;)e-=3;const i=this.points_[t+2]-this.points_[e+2];if(i<1e3/60)return!1;const n=this.points_[t]-this.points_[e],s=this.points_[t+1]-this.points_[e+1];return this.angle_=Math.atan2(s,n),this.initialVelocity_=Math.sqrt(n*n+s*s)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}};const g2={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};let UV=class extends kf{constructor(r,t){super(r),this.map_=r,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const e=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=e,this.pointerdownListenerKey_=Oe(e,g2.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Oe(e,g2.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Vt.TOUCHMOVE,this.boundHandleTouchMove_,JM?{passive:!1}:!1)}emulateClick_(r){let t=new No(Le.CLICK,this.map_,r);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new No(Le.DBLCLICK,this.map_,r),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const e=new No(Le.SINGLECLICK,this.map_,r);this.dispatchEvent(e)},250)}updateActivePointers_(r){const t=r,e=t.pointerId;if(t.type==Le.POINTERUP||t.type==Le.POINTERCANCEL){delete this.trackedTouches_[e];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==Le.POINTERDOWN||t.type==Le.POINTERMOVE)&&(this.trackedTouches_[e]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(r){this.updateActivePointers_(r);const t=new No(Le.POINTERUP,this.map_,r,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(r)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(sr),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(r){return r.button===0}handlePointerDown_(r){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(r);const t=new No(Le.POINTERDOWN,this.map_,r,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(r.type,r),Object.defineProperty(this.down_,"target",{writable:!1,value:r.target}),this.dragListenerKeys_.length===0){const e=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Oe(e,Le.POINTERMOVE,this.handlePointerMove_,this),Oe(e,Le.POINTERUP,this.handlePointerUp_,this),Oe(this.element_,Le.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==e&&this.dragListenerKeys_.push(Oe(this.element_.getRootNode(),Le.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(r){if(this.isMoving_(r)){this.updateActivePointers_(r),this.dragging_=!0;const t=new No(Le.POINTERDRAG,this.map_,r,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(r){this.originalPointerMoveEvent_=r;const t=!!(this.down_&&this.isMoving_(r));this.dispatchEvent(new No(Le.POINTERMOVE,this.map_,r,t))}handleTouchMove_(r){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof r.cancelable!="boolean"||r.cancelable===!0)&&r.preventDefault()}isMoving_(r){return this.dragging_||Math.abs(r.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(r.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(sr(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Vt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(sr(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(sr),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}};const Oi={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},f2=1/0;let WV=class{constructor(r,t){this.priorityFunction_=r,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Bu(this.queuedElements_)}dequeue(){const r=this.elements_,t=this.priorities_,e=r[0];r.length==1?(r.length=0,t.length=0):(r[0]=r.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(e);return delete this.queuedElements_[i],e}enqueue(r){Re(!(this.keyFunction_(r)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(r);return t!=f2?(this.elements_.push(r),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(r)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(r){return r*2+1}getRightChildIndex_(r){return r*2+2}getParentIndex_(r){return r-1>>1}heapify_(){let r;for(r=(this.elements_.length>>1)-1;r>=0;r--)this.siftUp_(r)}isEmpty(){return this.elements_.length===0}isKeyQueued(r){return r in this.queuedElements_}isQueued(r){return this.isKeyQueued(this.keyFunction_(r))}siftUp_(r){const t=this.elements_,e=this.priorities_,i=t.length,n=t[r],s=e[r],o=r;for(;r<i>>1;){const a=this.getLeftChildIndex_(r),l=this.getRightChildIndex_(r),c=l<i&&e[l]<e[a]?l:a;t[r]=t[c],e[r]=e[c],r=c}t[r]=n,e[r]=s,this.siftDown_(o,r)}siftDown_(r,t){const e=this.elements_,i=this.priorities_,n=e[t],s=i[t];for(;t>r;){const o=this.getParentIndex_(t);if(i[o]>s)e[t]=e[o],i[t]=i[o],t=o;else break}e[t]=n,i[t]=s}reprioritize(){const r=this.priorityFunction_,t=this.elements_,e=this.priorities_;let i=0;const n=t.length;let s,o,a;for(o=0;o<n;++o)s=t[o],a=r(s),a==f2?delete this.queuedElements_[this.keyFunction_(s)]:(e[i]=a,t[i++]=s);t.length=i,e.length=i,this.heapify_()}},OP=class extends WV{constructor(r,t){super(e=>r.apply(null,e),e=>e[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(r){const t=super.enqueue(r);return t&&r[0].addEventListener(Vt.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(r){const t=r.target,e=t.getState();if(e===yt.LOADED||e===yt.ERROR||e===yt.EMPTY){e!==yt.ERROR&&t.removeEventListener(Vt.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(r,t){let e=0;for(;this.tilesLoading_<r&&e<t&&this.getCount()>0;){const i=this.dequeue()[0],n=i.getKey();i.getState()===yt.IDLE&&!(n in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++e,i.load())}}};function VV(r,t,e,i,n){if(!r||!(e in r.wantedTiles)||!r.wantedTiles[e][t.getKey()])return f2;const s=r.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(n)+Math.sqrt(o*o+a*a)/n}let bk=class extends zs{constructor(r){super();const t=r.element;t&&!r.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],r.render&&(this.render=r.render),r.target&&this.setTarget(r.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(r){this.map_&&this.element?.remove();for(let t=0,e=this.listenerKeys.length;t<e;++t)sr(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=r,r){const t=this.target_??r.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==bg&&this.listenerKeys.push(Oe(r,Do.POSTRENDER,this.render,this)),r.render()}}render(r){}setTarget(r){this.target_=typeof r=="string"?document.getElementById(r):r}},ZV=class extends bk{constructor(r){r=r||{},super({element:document.createElement("div"),render:r.render,target:r.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=r.collapsed!==void 0?r.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=r.collapsible!==void 0,this.collapsible_=r.collapsible!==void 0?r.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=r.attributions;const t=r.className!==void 0?r.className:"ol-attribution",e=r.tipLabel!==void 0?r.tipLabel:"Attributions",i=r.expandClassName!==void 0?r.expandClassName:t+"-expand",n=r.collapseLabel!==void 0?r.collapseLabel:"âº",s=r.collapseClassName!==void 0?r.collapseClassName:t+"-collapse";typeof n=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n,this.collapseLabel_.className=s):this.collapseLabel_=n;const o=r.label!==void 0?r.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=e,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(Vt.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+c1+" "+Mw+(this.collapsed_&&this.collapsible_?" "+LS:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=l,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(r){const t=this.getMap().getAllLayers(),e=new Set(t.flatMap(i=>i.getAttributions(r)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>e.add(i)):e.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(n=>n.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(e)}async updateElement_(r){if(!r){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(r).map(i=>xu(()=>i))),e=t.length>0;if(this.renderedVisible_!=e&&(this.element.style.display=e?"":"none",this.renderedVisible_=e),!ua(t,this.renderedAttributions_)){tR(this.ulElement_);for(let i=0,n=t.length;i<n;++i){const s=document.createElement("li");s.innerHTML=t[i],this.ulElement_.appendChild(s)}this.renderedAttributions_=t}}handleClick_(r){r.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(LS),this.collapsed_?AS(this.collapseLabel_,this.label_):AS(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(r){this.collapsible_!==r&&(this.collapsible_=r,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(r){this.userCollapsed_=r,!(!this.collapsible_||this.collapsed_===r)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(r){this.updateElement_(r.frameState)}},HV=class extends bk{constructor(r){r=r||{},super({element:document.createElement("div"),render:r.render,target:r.target});const t=r.className!==void 0?r.className:"ol-rotate",e=r.label!==void 0?r.label:"â§",i=r.compassClassName!==void 0?r.compassClassName:"ol-compass";this.label_=null,typeof e=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=e):(this.label_=e,this.label_.classList.add(i));const n=r.tipLabel?r.tipLabel:"Reset rotation",s=document.createElement("button");s.className=t+"-reset",s.setAttribute("type","button"),s.title=n,s.appendChild(this.label_),s.addEventListener(Vt.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+c1+" "+Mw,a=this.element;a.className=o,a.appendChild(s),this.callResetNorth_=r.resetNorth?r.resetNorth:void 0,this.duration_=r.duration!==void 0?r.duration:250,this.autoHide_=r.autoHide!==void 0?r.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(fp)}handleClick_(r){r.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const r=this.getMap().getView();if(!r)return;const t=r.getRotation();t!==void 0&&(this.duration_>0&&t%(2*Math.PI)!==0?r.animate({rotation:0,duration:this.duration_,easing:Tl}):r.setRotation(0))}render(r){const t=r.frameState;if(!t)return;const e=t.viewState.rotation;if(e!=this.rotation_){const i="rotate("+e+"rad)";if(this.autoHide_){const n=this.element.classList.contains(fp);!n&&e===0?this.element.classList.add(fp):n&&e!==0&&this.element.classList.remove(fp)}this.label_.style.transform=i}this.rotation_=e}},YV=class extends bk{constructor(r){r=r||{},super({element:document.createElement("div"),target:r.target});const t=r.className!==void 0?r.className:"ol-zoom",e=r.delta!==void 0?r.delta:1,i=r.zoomInClassName!==void 0?r.zoomInClassName:t+"-in",n=r.zoomOutClassName!==void 0?r.zoomOutClassName:t+"-out",s=r.zoomInLabel!==void 0?r.zoomInLabel:"+",o=r.zoomOutLabel!==void 0?r.zoomOutLabel:"â",a=r.zoomInTipLabel!==void 0?r.zoomInTipLabel:"Zoom in",l=r.zoomOutTipLabel!==void 0?r.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=i,c.setAttribute("type","button"),c.title=a,c.appendChild(typeof s=="string"?document.createTextNode(s):s),c.addEventListener(Vt.CLICK,this.handleClick_.bind(this,e),!1);const h=document.createElement("button");h.className=n,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(Vt.CLICK,this.handleClick_.bind(this,-e),!1);const u=t+" "+c1+" "+Mw,d=this.element;d.className=u,d.appendChild(c),d.appendChild(h),this.duration_=r.duration!==void 0?r.duration:250}handleClick_(r,t){t.preventDefault(),this.zoomByDelta_(r)}zoomByDelta_(r){const t=this.getMap().getView();if(!t)return;const e=t.getZoom();if(e!==void 0){const i=t.getConstrainedZoom(e+r);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:i,duration:this.duration_,easing:Tl})):t.setZoom(i)}}};function XV(r){r=r||{};const t=new xi;return(r.zoom===void 0||r.zoom)&&t.push(new YV(r.zoomOptions)),(r.rotate===void 0||r.rotate)&&t.push(new HV(r.rotateOptions)),(r.attribution===void 0||r.attribution)&&t.push(new ZV(r.attributionOptions)),t}let KV=class extends Ju{constructor(r){super(),r=r||{},this.delta_=r.delta?r.delta:1,this.duration_=r.duration!==void 0?r.duration:250}handleEvent(r){let t=!1;if(r.type==Le.DBLCLICK){const e=r.originalEvent,i=r.map,n=r.coordinate,s=e.shiftKey?-this.delta_:this.delta_,o=i.getView();pk(o,s,n,this.duration_),e.preventDefault(),t=!0}return!t}},p2=class extends Rl{constructor(r){super({stopDown:qu}),r=r||{},this.kinetic_=r.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=r.condition?r.condition:a2(mk,RP);this.condition_=r.onFocusOnly?a2(SP,t):t,this.noKinetic_=!1}handleDragEvent(r){const t=r.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const e=this.targetPointers,i=t.getEventPixel(yk(e));if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const n=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],s=r.map.getView();BM(n,s.getResolution()),xw(n,s.getRotation()),s.adjustCenterInternal(n)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length,r.originalEvent.preventDefault()}handleUpEvent(r){const t=r.map,e=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),s=e.getCenterInternal(),o=t.getPixelFromCoordinateInternal(s),a=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(n),o[1]-i*Math.sin(n)]);e.animateInternal({center:e.getConstrainedCenter(a),duration:500,easing:Tl})}return this.panning_&&(this.panning_=!1,e.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(r){if(this.targetPointers.length>0&&this.condition_(r)){const t=r.map.getView();return this.lastCentroid=null,t.getAnimating()&&t.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},QV=class extends Rl{constructor(r){r=r||{},super({stopDown:qu}),this.condition_=r.condition?r.condition:mV,this.lastAngle_=void 0,this.duration_=r.duration!==void 0?r.duration:250}handleDragEvent(r){if(!q_(r))return;const t=r.map,e=t.getView();if(e.getConstraints().rotation===dk)return;const i=t.getSize(),n=r.pixel,s=Math.atan2(i[1]/2-n[1],n[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=s-this.lastAngle_;e.adjustRotationInternal(-o)}this.lastAngle_=s}handleUpEvent(r){return q_(r)?(r.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(r){return q_(r)&&TP(r)&&this.condition_(r)?(r.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}},JV=class extends bf{constructor(r){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+r,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const r=this.startPixel_,t=this.endPixel_,e="px",i=this.element_.style;i.left=Math.min(r[0],t[0])+e,i.top=Math.min(r[1],t[1])+e,i.width=Math.abs(t[0]-r[0])+e,i.height=Math.abs(t[1]-r[1])+e}setMap(r){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=r,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(r,t){this.startPixel_=r,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const r=this.startPixel_,t=this.endPixel_,e=[r,[r[0],t[1]],t,[t[0],r[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);e[4]=e[0].slice(),this.geometry_?this.geometry_.setCoordinates([e]):this.geometry_=new gs([e])}getGeometry(){return this.geometry_}};const mh={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};let Td=class extends on{constructor(r,t,e){super(r),this.coordinate=t,this.mapBrowserEvent=e}},tZ=class extends Rl{constructor(r){super(),this.on,this.once,this.un,r=r??{},this.box_=new JV(r.className||"ol-dragbox"),this.minArea_=r.minArea??64,r.onBoxEnd&&(this.onBoxEnd=r.onBoxEnd),this.startPixel_=null,this.condition_=r.condition??TP,this.boxEndCondition_=r.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(r,t,e){const i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(r){this.startPixel_&&(this.box_.setPixels(this.startPixel_,r.pixel),this.dispatchEvent(new Td(mh.BOXDRAG,r.coordinate,r)))}handleUpEvent(r){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(r,this.startPixel_,r.pixel);return t&&this.onBoxEnd(r),this.dispatchEvent(new Td(t?mh.BOXEND:mh.BOXCANCEL,r.coordinate,r)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(r){return this.condition_(r)?(this.startPixel_=r.pixel,this.box_.setMap(r.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Td(mh.BOXSTART,r.coordinate,r)),!0):!1}onBoxEnd(r){}setActive(r){r||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Td(mh.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(r)}setMap(r){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Td(mh.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(r)}},eZ=class extends tZ{constructor(r){r=r||{};const t=r.condition?r.condition:bm;super({condition:t,className:r.className||"ol-dragzoom",minArea:r.minArea}),this.duration_=r.duration!==void 0?r.duration:200,this.out_=r.out!==void 0?r.out:!1}onBoxEnd(r){const t=this.getMap().getView();let e=this.getGeometry();if(this.out_){const i=t.rotatedExtentForGeometry(e),n=t.getResolutionForExtentInternal(i),s=t.getResolution()/n;e=e.clone(),e.scale(s*s)}t.fitInternal(e,{duration:this.duration_,easing:Tl})}};const Fl={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};let FP=class extends Ju{constructor(r){super(),r=r||{},this.defaultCondition_=function(t){return mk(t)&&MP(t)},this.condition_=r.condition!==void 0?r.condition:this.defaultCondition_,this.duration_=r.duration!==void 0?r.duration:100,this.pixelDelta_=r.pixelDelta!==void 0?r.pixelDelta:128}handleEvent(r){let t=!1;if(r.type==Vt.KEYDOWN){const e=r.originalEvent,i=e.key;if(this.condition_(r)&&(i==Fl.DOWN||i==Fl.LEFT||i==Fl.RIGHT||i==Fl.UP)){const n=r.map.getView(),s=n.getResolution()*this.pixelDelta_;let o=0,a=0;i==Fl.DOWN?a=-s:i==Fl.LEFT?o=-s:i==Fl.RIGHT?o=s:a=s;const l=[o,a];xw(l,n.getRotation()),fV(n,l,this.duration_),e.preventDefault(),t=!0}}return!t}},NP=class extends Ju{constructor(r){super(),r=r||{},this.condition_=r.condition?r.condition:function(t){return!xV(t)&&MP(t)},this.delta_=r.delta?r.delta:1,this.duration_=r.duration!==void 0?r.duration:100}handleEvent(r){let t=!1;if(r.type==Vt.KEYDOWN||r.type==Vt.KEYPRESS){const e=r.originalEvent,i=e.key;if(this.condition_(r)&&(i==="+"||i==="-")){const n=r.map,s=i==="+"?this.delta_:-this.delta_,o=n.getView();pk(o,s,void 0,this.duration_),e.preventDefault(),t=!0}}return!t}};const rZ=40,iZ=300;let m2=class extends Ju{constructor(r){r=r||{},super(r),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=r.maxDelta!==void 0?r.maxDelta:1,this.duration_=r.duration!==void 0?r.duration:250,this.timeout_=r.timeout!==void 0?r.timeout:80,this.useAnchor_=r.useAnchor!==void 0?r.useAnchor:!0,this.constrainResolution_=r.constrainResolution!==void 0?r.constrainResolution:!1;const t=r.condition?r.condition:gc;this.condition_=r.onFocusOnly?a2(SP,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const r=this.getMap();r&&r.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(r){if(!this.condition_(r)||r.type!==Vt.WHEEL)return!0;const t=r.map,e=r.originalEvent;e.preventDefault(),this.useAnchor_&&(this.lastAnchor_=r.pixel);let i=e.deltaY;switch(e.deltaMode){case WheelEvent.DOM_DELTA_LINE:i*=rZ;break;case WheelEvent.DOM_DELTA_PAGE:i*=iZ;break}if(i===0)return!1;this.lastDelta_=i;const n=Date.now();this.startTime_===void 0&&(this.startTime_=n),(!this.mode_||n-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?"trackpad":"wheel");const s=t.getView();if(this.mode_==="trackpad"&&!(s.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-i/this.deltaPerZoom_,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=n,!1;this.totalDelta_+=i;const o=Math.max(this.timeout_-(n-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,t),o),!1}handleWheelZoom_(r){const t=r.getView();t.getAnimating()&&t.cancelAnimations();let e=-kr(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(e=e?e>0?1:-1:0),pk(t,e,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(r){this.useAnchor_=r,r||(this.lastAnchor_=null)}},nZ=class extends Rl{constructor(r){r=r||{};const t=r;t.stopDown||(t.stopDown=qu),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=r.threshold!==void 0?r.threshold:.3,this.duration_=r.duration!==void 0?r.duration:250}handleDragEvent(r){let t=0;const e=this.targetPointers[0],i=this.targetPointers[1],n=Math.atan2(i.clientY-e.clientY,i.clientX-e.clientX);if(this.lastAngle_!==void 0){const a=n-this.lastAngle_;this.rotationDelta_+=a,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=a}this.lastAngle_=n;const s=r.map,o=s.getView();o.getConstraints().rotation!==dk&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(yk(this.targetPointers))),this.rotating_&&(s.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(r){return this.targetPointers.length<2?(r.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(r){if(this.targetPointers.length>=2){const t=r.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}},sZ=class extends Rl{constructor(r){r=r||{};const t=r;t.stopDown||(t.stopDown=qu),super(t),this.anchor_=null,this.duration_=r.duration!==void 0?r.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(r){let t=1;const e=this.targetPointers[0],i=this.targetPointers[1],n=e.clientX-i.clientX,s=e.clientY-i.clientY,o=Math.sqrt(n*n+s*s);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const a=r.map,l=a.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(yk(this.targetPointers))),a.render(),l.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(r){if(this.targetPointers.length<2){const t=r.map.getView(),e=this.lastScaleDelta_>1?1:-1;return t.endInteraction(this.duration_,e),!1}return!0}handleDownEvent(r){if(this.targetPointers.length>=2){const t=r.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}};function DP(r){r=r||{};const t=new xi,e=new BV(-.005,.05,100);return(r.altShiftDragRotate===void 0||r.altShiftDragRotate)&&t.push(new QV),(r.doubleClickZoom===void 0||r.doubleClickZoom)&&t.push(new KV({delta:r.zoomDelta,duration:r.zoomDuration})),(r.dragPan===void 0||r.dragPan)&&t.push(new p2({onFocusOnly:r.onFocusOnly,kinetic:e})),(r.pinchRotate===void 0||r.pinchRotate)&&t.push(new nZ),(r.pinchZoom===void 0||r.pinchZoom)&&t.push(new sZ({duration:r.zoomDuration})),(r.keyboard===void 0||r.keyboard)&&(t.push(new FP),t.push(new NP({delta:r.zoomDelta,duration:r.zoomDuration}))),(r.mouseWheelZoom===void 0||r.mouseWheelZoom)&&t.push(new m2({onFocusOnly:r.onFocusOnly,duration:r.zoomDuration})),(r.shiftDragZoom===void 0||r.shiftDragZoom)&&t.push(new eZ({duration:r.zoomDuration})),t}const Ra={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};let qa=class extends on{constructor(r,t){super(r),this.layer=t}};const U_={LAYERS:"layers"};let Nc=class $P extends EP{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(U_.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new xi(i.slice(),{unique:!0}):Re(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new xi(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(sr),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(Oe(t,Jr.ADD,this.handleLayersAdd_,this),Oe(t,Jr.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(sr);Bu(this.listenerKeys_);const e=t.getArray();for(let i=0,n=e.length;i<n;i++){const s=e[i];this.registerLayerListeners_(s),this.dispatchEvent(new qa(Ra.ADDLAYER,s))}this.changed()}registerLayerListeners_(t){const e=[Oe(t,vu.PROPERTYCHANGE,this.handleLayerChange_,this),Oe(t,Vt.CHANGE,this.handleLayerChange_,this)];t instanceof $P&&e.push(Oe(t,Ra.ADDLAYER,this.handleLayerGroupAdd_,this),Oe(t,Ra.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[$t(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new qa(Ra.ADDLAYER,t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new qa(Ra.REMOVELAYER,t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new qa(Ra.ADDLAYER,e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=$t(e);this.listenerKeys_[i].forEach(sr),delete this.listenerKeys_[i],this.dispatchEvent(new qa(Ra.REMOVELAYER,e)),this.changed()}getLayers(){return this.get(U_.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let n=0,s=i.length;n<s;++n)this.dispatchEvent(new qa(Ra.REMOVELAYER,i[n]))}this.set(U_.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const n=this.getLayerState();let s=n.zIndex;!t&&n.zIndex===void 0&&(s=0);for(let o=i,a=e.length;o<a;o++){const l=e[o];l.opacity*=n.opacity,l.visible=l.visible&&n.visible,l.maxResolution=Math.min(l.maxResolution,n.maxResolution),l.minResolution=Math.max(l.minResolution,n.minResolution),l.minZoom=Math.max(l.minZoom,n.minZoom),l.maxZoom=Math.min(l.maxZoom,n.maxZoom),n.extent!==void 0&&(l.extent!==void 0?l.extent=As(l.extent,n.extent):l.extent=n.extent),l.zIndex===void 0&&(l.zIndex=s)}return e}getSourceState(){return"ready"}},oZ=class extends bf{constructor(r){super(),this.map_=r}dispatchRenderEvent(r,t){te()}calculateMatrices2D(r){const t=r.viewState,e=r.coordinateToPixelTransform,i=r.pixelToCoordinateTransform;bo(e,r.size[0]/2,r.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),AI(i,e)}forEachFeatureAtCoordinate(r,t,e,i,n,s,o,a){let l;const c=t.viewState;function h(x,v,w,b){return n.call(s,v,x?w:null,b)}const u=c.projection,d=ww(r.slice(),u),g=[[0,0]];if(u.canWrapX()&&i){const x=u.getExtent(),v=Me(x);g.push([-v,0],[v,0])}const f=t.layerStatesArray,p=f.length,m=[],y=[];for(let x=0;x<g.length;x++)for(let v=p-1;v>=0;--v){const w=f[v],b=w.layer;if(b.hasRenderer()&&fk(w,c)&&o.call(a,b)){const E=b.getRenderer(),C=b.getSource();if(E&&C){const S=C.getWrapX()?d:r,R=h.bind(null,w.managed);y[0]=S[0]+g[x][0],y[1]=S[1]+g[x][1],l=E.forEachFeatureAtCoordinate(y,t,e,R,m)}if(l)return l}}if(m.length===0)return;const _=1/m.length;return m.forEach((x,v)=>x.distanceSq+=v*_),m.sort((x,v)=>x.distanceSq-v.distanceSq),m.some(x=>l=x.callback(x.feature,x.layer,x.geometry)),l}hasFeatureAtCoordinate(r,t,e,i,n,s){return this.forEachFeatureAtCoordinate(r,t,e,i,mo,this,n,s)!==void 0}getMap(){return this.map_}renderFrame(r){te()}scheduleExpireIconCache(r){Jn.canExpireCache()&&r.postRenderFunctions.push(aZ)}};function aZ(r,t){Jn.expire()}let lZ=class extends oZ{constructor(r){super(r),this.fontChangeListenerKey_=Oe(Ul,vu.PROPERTYCHANGE,r.redrawText,r),this.element_=Hn?eR():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=c1+" ol-layers";const e=r.getViewport();e&&e.insertBefore(this.element_,e.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(r,t){const e=this.getMap();if(e.hasListener(r)){const i=new pP(r,void 0,t);e.dispatchEvent(i)}}disposeInternal(){sr(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(r){if(!r){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(r),this.dispatchRenderEvent(Qn.PRECOMPOSE,r);const t=r.layerStatesArray.sort((o,a)=>o.zIndex-a.zIndex);t.some(o=>o.layer instanceof V1&&o.layer.getDeclutter())&&(r.declutter={});const e=r.viewState;this.children_.length=0;const i=[];let n=null;for(let o=0,a=t.length;o<a;++o){const l=t[o];r.layerIndex=o;const c=l.layer,h=c.getSourceState();if(!fk(l,e)||h!="ready"&&h!="undefined"){c.unrender();continue}const u=c.render(r,n);u&&(u!==n&&(this.children_.push(u),n=u),i.push(l))}this.declutter(r,i),fF(this.element_,this.children_);const s=this.getMap().getTargetElement();if(Ha(s)){const o=s.getContext("2d");for(const a of this.children_){const l=a.firstElementChild||a,c=a.style.backgroundColor;if(c&&(!Ha(l)||l.width>0)&&(o.fillStyle=c,o.fillRect(0,0,s.width,s.height)),Ha(l)&&l.width>0){const h=a.style.opacity||l.style.opacity;o.globalAlpha=h===""?1:Number(h);const u=l.style.transform;if(u)o.setTransform(...Yx(u));else{const d=parseFloat(l.style.width)/l.width,g=parseFloat(l.style.height)/l.height;o.setTransform(d,0,0,g,0,0)}o.drawImage(l,0,0)}}o.globalAlpha=1,o.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Qn.POSTCOMPOSE,r),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(r)}declutter(r,t){if(r.declutter){for(let e=t.length-1;e>=0;--e){const i=t[e],n=i.layer;n.getDeclutter()&&n.renderDeclutter(r,i)}t.forEach(e=>e.layer.renderDeferred(r))}}};function GP(r){if(r instanceof Kc){r.setMapInternal(null);return}r instanceof Nc&&r.getLayers().forEach(GP)}function jP(r,t){if(r instanceof Kc){r.setMapInternal(t);return}if(r instanceof Nc){const e=r.getLayers().getArray();for(let i=0,n=e.length;i<n;++i)jP(e[i],t)}}let rf=class extends zs{constructor(r){super(),r=r||{},this.on,this.once,this.un;const t=cZ(r);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=r.maxTilesLoading!==void 0?r.maxTilesLoading:16,this.pixelRatio_=r.pixelRatio!==void 0?r.pixelRatio:KM,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=rn(),this.pixelToCoordinateTransform_=rn(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Hn||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=r.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Hn||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Hn?new xi:XV()),this.interactions=t.interactions||(Hn?new xi:DP({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new OP(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Oi.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Oi.VIEW,this.handleViewChanged_),this.addChangeListener(Oi.SIZE,this.handleSizeChanged_),this.addChangeListener(Oi.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const e=this;r.view&&!(r.view instanceof Qs)&&r.view.then(function(i){e.setView(new Qs(i))}),this.controls.addEventListener(Jr.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(Jr.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(Jr.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(Jr.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(Jr.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(Jr.REMOVE,i=>{const n=i.element.getId();n!==void 0&&delete this.overlayIdIndex_[n.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(r){this.getControls().push(r)}addInteraction(r){this.getInteractions().push(r)}addLayer(r){this.getLayerGroup().getLayers().push(r)}handleLayerAdd_(r){jP(r.layer,this)}addOverlay(r){this.getOverlays().push(r)}addOverlayInternal_(r){const t=r.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=r),r.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(r,t,e){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(r);e=e!==void 0?e:{};const n=e.hitTolerance!==void 0?e.hitTolerance:0,s=e.layerFilter!==void 0?e.layerFilter:mo,o=e.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,n,o,t,null,s,null)}getFeaturesAtPixel(r,t){const e=[];return this.forEachFeatureAtPixel(r,function(i){e.push(i)},t),e}getAllLayers(){const r=[];function t(e){e.forEach(function(i){i instanceof Nc?t(i.getLayers()):r.push(i)})}return t(this.getLayers()),r}hasFeatureAtPixel(r,t){if(!this.frameState_||!this.renderer_)return!1;const e=this.getCoordinateFromPixelInternal(r);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:mo,n=t.hitTolerance!==void 0?t.hitTolerance:0,s=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(e,this.frameState_,n,s,i,null)}getEventCoordinate(r){return this.getCoordinateFromPixel(this.getEventPixel(r))}getEventCoordinateInternal(r){return this.getCoordinateFromPixelInternal(this.getEventPixel(r))}getEventPixel(r){const t=this.viewport_.getBoundingClientRect(),e=this.getSize(),i=t.width/e[0],n=t.height/e[1],s="changedTouches"in r?r.changedTouches[0]:r;return[(s.clientX-t.left)/i,(s.clientY-t.top)/n]}getTarget(){return this.get(Oi.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(r){return Tc(this.getCoordinateFromPixelInternal(r),this.getView().getProjection())}getCoordinateFromPixelInternal(r){const t=this.frameState_;return t?Qr(t.pixelToCoordinateTransform,r.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(r){const t=this.overlayIdIndex_[r.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Oi.LAYERGROUP)}setLayers(r){const t=this.getLayerGroup();if(r instanceof xi){t.setLayers(r);return}const e=t.getLayers();e.clear(),e.extend(r)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const r=this.getLayerGroup().getLayerStatesArray();for(let t=0,e=r.length;t<e;++t){const i=r[t];if(!i.visible)continue;const n=i.layer.getRenderer();if(n&&!n.ready)return!0;const s=i.layer.getSource();if(s&&s.loading)return!0}return!1}getPixelFromCoordinate(r){const t=fr(r,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(r){const t=this.frameState_;return t?Qr(t.coordinateToPixelTransform,r.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Oi.SIZE)}getView(){return this.get(Oi.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const r=this.getTargetElement();return r?r.ownerDocument:document}getTilePriority(r,t,e,i){return VV(this.frameState_,r,t,e,i)}handleBrowserEvent(r,t){t=t||r.type;const e=new No(t,this,r);this.handleMapBrowserEvent(e)}handleMapBrowserEvent(r){if(!this.frameState_)return;const t=r.originalEvent,e=t.type;if(e===g2.POINTERDOWN||e===Vt.WHEEL||e===Vt.KEYDOWN){const i=this.getOwnerDocument(),n=this.viewport_.getRootNode?this.viewport_.getRootNode():i,s=t.target,o=n instanceof ShadowRoot?n.host===s?n.host.ownerDocument:n:n===i?i.documentElement:n;if(this.overlayContainerStopEvent_.contains(s)||!o.contains(s))return}if(r.frameState=this.frameState_,this.dispatchEvent(r)!==!1){const i=this.getInteractions().getArray().slice();for(let n=i.length-1;n>=0;n--){const s=i[n];if(!(s.getMap()!==this||!s.getActive()||!this.getTargetElement())&&(!s.handleEvent(r)||r.propagationStopped))break}}}handlePostRender(){const r=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,n=i;if(r){const s=r.viewHints;if(s[vr.ANIMATING]||s[vr.INTERACTING]){const o=Date.now()-r.time>8;i=o?0:8,n=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,n))}r&&this.renderer_&&!r.animate&&(this.renderComplete_?(this.hasListener(Qn.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Qn.RENDERCOMPLETE,r),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ah(Do.LOADEND,this,r)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ah(Do.LOADSTART,this,r))));const e=this.postRenderFunctions_;if(r)for(let i=0,n=e.length;i<n;++i)e[i](this,r);e.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let e=0,i=this.targetChangeHandlerKeys_.length;e<i;++e)sr(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Vt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Vt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Ha(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const e=this.targetElement_.getRootNode();e instanceof ShadowRoot&&this.resizeObserver_.unobserve(e.host),this.setSize(void 0)}const r=this.getTarget(),t=typeof r=="string"?document.getElementById(r):r;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Ha(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new lZ(this)),!Ha(t)){this.mapBrowserEventHandler_=new UV(this,this.moveTolerance_);for(const i in Le)this.mapBrowserEventHandler_.addEventListener(Le[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Vt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Vt.WHEEL,this.boundHandleBrowserEvent_,JM?{passive:!1}:!1);let e;if(this.keyboardEventTarget_)e=this.keyboardEventTarget_;else{const i=t.getRootNode();e=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[Oe(e,Vt.KEYDOWN,this.handleBrowserEvent,this),Oe(e,Vt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(sr(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(sr(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const r=this.getView();r&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Oe(r,vu.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Oe(r,Vt.CHANGE,this.handleViewPropertyChanged_,this),r.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(sr),this.layerGroupPropertyListenerKeys_=null);const r=this.getLayerGroup();r&&(this.handleLayerAdd_(new qa("addlayer",r)),this.layerGroupPropertyListenerKeys_=[Oe(r,vu.PROPERTYCHANGE,this.render,this),Oe(r,Vt.CHANGE,this.render,this),Oe(r,"addlayer",this.handleLayerAdd_,this),Oe(r,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const r=this.frameState_.layerStatesArray;for(let t=0,e=r.length;t<e;++t){const i=r[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(r){return this.getControls().remove(r)}removeInteraction(r){return this.getInteractions().remove(r)}removeLayer(r){return this.getLayerGroup().getLayers().remove(r)}handleLayerRemove_(r){GP(r.layer)}removeOverlay(r){return this.getOverlays().remove(r)}renderFrame_(r){const t=this.getSize(),e=this.getView(),i=this.frameState_;let n=null;if(t!==void 0&&NC(t)&&e&&e.isDef()){const s=e.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=e.getState();if(n={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:kg(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:r,usedTiles:{},viewState:o,viewHints:s,wantedTiles:{},mapId:$t(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const a=isNaN(o.nextRotation)?o.rotation:o.nextRotation;n.nextExtent=kg(o.nextCenter,o.nextResolution,a,t)}}this.frameState_=n,this.renderer_.renderFrame(n),n&&(n.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,n.postRenderFunctions),i&&(!this.previousExtent_||!Bc(this.previousExtent_)&&!ra(n.extent,this.previousExtent_))&&(this.dispatchEvent(new Ah(Do.MOVESTART,this,i)),this.previousExtent_=Uu(this.previousExtent_)),this.previousExtent_&&!n.viewHints[vr.ANIMATING]&&!n.viewHints[vr.INTERACTING]&&!ra(n.extent,this.previousExtent_)&&(this.dispatchEvent(new Ah(Do.MOVEEND,this,n)),OM(n.extent,this.previousExtent_))),this.dispatchEvent(new Ah(Do.POSTRENDER,this,n)),this.renderComplete_=(this.hasListener(Do.LOADSTART)||this.hasListener(Do.LOADEND)||this.hasListener(Qn.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(r){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new qa("removelayer",t)),this.set(Oi.LAYERGROUP,r)}setSize(r){this.set(Oi.SIZE,r)}setTarget(r){this.set(Oi.TARGET,r)}setView(r){if(!r||r instanceof Qs){this.set(Oi.VIEW,r);return}this.set(Oi.VIEW,new Qs);const t=this;r.then(function(e){t.setView(new Qs(e))})}updateSize(){const r=this.getTargetElement();let t;if(r){let i,n;if(Ha(r))i=r.width,n=r.height;else{const s=getComputedStyle(r);i=r.offsetWidth-parseFloat(s.borderLeftWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)-parseFloat(s.borderRightWidth),n=r.offsetHeight-parseFloat(s.borderTopWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom)-parseFloat(s.borderBottomWidth)}!isNaN(i)&&!isNaN(n)&&(t=[Math.max(0,i),Math.max(0,n)],!NC(t)&&(r.offsetWidth||r.offsetHeight||r.getClientRects().length)&&zM("No map visible because the map container's width or height are 0."))}const e=this.getSize();t&&(!e||!ua(t,e))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(r){const t=this.getView();t&&t.setViewportSize(r)}};function cZ(r){let t=null;r.keyboardEventTarget!==void 0&&(t=typeof r.keyboardEventTarget=="string"?document.getElementById(r.keyboardEventTarget):r.keyboardEventTarget);const e={},i=r.layers&&typeof r.layers.getLayers=="function"?r.layers:new Nc({layers:r.layers});e[Oi.LAYERGROUP]=i,e[Oi.TARGET]=r.target,e[Oi.VIEW]=r.view instanceof Qs?r.view:new Qs;let n;r.controls!==void 0&&(Array.isArray(r.controls)?n=new xi(r.controls.slice()):(Re(typeof r.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),n=r.controls));let s;r.interactions!==void 0&&(Array.isArray(r.interactions)?s=new xi(r.interactions.slice()):(Re(typeof r.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=r.interactions));let o;return r.overlays!==void 0?Array.isArray(r.overlays)?o=new xi(r.overlays.slice()):(Re(typeof r.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=r.overlays):o=new xi,{controls:n,interactions:s,keyboardEventTarget:t,overlays:o,values:e}}class kk{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function yh(r,t,e,i,n){return n!==void 0?(n.minX=r,n.maxX=t,n.minY=e,n.maxY=i,n):new kk(r,t,e,i)}const e5=[];let hZ=class extends Mf{constructor(r,t,e,i,n){super(r,t,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=i.bind(void 0,this),this.removeSourceTiles_=n,this.wrappedTileCoord=e}getContext(){return this.context_||(this.context_=Or(1,1,e5)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(r){const t=$t(r);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){this.context_&&(Cf(this.context_),e5.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}};const uZ=`@charset "UTF-8";html{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;scroll-behavior:smooth;-webkit-text-size-adjust:100%;box-sizing:border-box}*,*:before,*:after{box-sizing:inherit}body,[data-kern-theme=dark],.kern-dark,[data-kern-theme=light],.kern-light{background-color:var(--kern-color-layout-background-default)}body:has(.kern-dialog[open]){overflow:hidden}*:not(i){font-family:var(--kern-typography-font-family-default)}area[href]:not([tabindex="-1"]):focus,iframe:not([tabindex="-1"]):focus,[tabindex]:not([tabindex="-1"]):focus,[contentEditable=true]:not([tabindex="-1"]):focus{border-radius:var(--kern-metric-border-radius-default, .25rem);box-shadow:0 0 0 2px var(--kern-color-action-on-default),0 0 0 4px var(--kern-color-action-focus-border-inside),0 0 0 6px var(--kern-color-action-focus-border-outside)}area[href]:not([tabindex="-1"]):focus:focus-visible,iframe:not([tabindex="-1"]):focus:focus-visible,[tabindex]:not([tabindex="-1"]):focus:focus-visible,[contentEditable=true]:not([tabindex="-1"]):focus:focus-visible{outline:0}.kern-sr-only{width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}.kern-sr-only:not(caption){position:absolute!important}.kern-sr-only-mobile{display:inline}@media (max-width: 767px){.kern-sr-only-mobile{width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}.kern-sr-only-mobile:not(caption){position:absolute!important}}.kern-error{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;display:flex;gap:var(--kern-metric-space-small, 8px);align-items:flex-start;align-self:stretch}.kern-error .kern-icon{background-color:var(--kern-color-feedback-danger, #BD0F09);margin:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px)}.kern-number{display:flex;width:28px;min-width:28px;height:28px;padding:2px 0;justify-content:center;align-items:center;border-radius:var(--kern-metric-border-radius-circle, 50%);border:var(--kern-metric-border-width-default, 2px) solid var(--kern-color-layout-text-default, #171A2B);color:var(--kern-color-layout-text-default, #171A2B)}.kern-icon{display:inline-block;width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-default, 24px);min-width:var(--kern-metric-dimension-default, 24px);min-height:var(--kern-metric-dimension-default, 24px)}.kern-icon--small{width:var(--kern-metric-dimension-small, 20px);min-width:var(--kern-metric-dimension-small, 20px);height:var(--kern-metric-dimension-small, 20px);min-height:var(--kern-metric-dimension-small, 20px)}.kern-icon--default{width:var(--kern-metric-dimension-default, 24px);min-width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-default, 24px);min-height:var(--kern-metric-dimension-default, 24px)}.kern-icon--large{width:var(--kern-metric-dimension-large, 32px);min-width:var(--kern-metric-dimension-large, 32px);height:var(--kern-metric-dimension-large, 32px);min-height:var(--kern-metric-dimension-large, 32px)}.kern-icon--x-large{width:var(--kern-metric-dimension-x-large, 48px);min-width:var(--kern-metric-dimension-x-large, 48px);height:var(--kern-metric-dimension-x-large, 48px);min-height:var(--kern-metric-dimension-x-large, 48px)}.kern-icon--add{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M440-440H240q-17 0-28.5-11.5T200-480q0-17 11.5-28.5T240-520h200v-200q0-17 11.5-28.5T480-760q17 0 28.5 11.5T520-720v200h200q17 0 28.5 11.5T760-480q0 17-11.5 28.5T720-440H520v200q0 17-11.5 28.5T480-200q-17 0-28.5-11.5T440-240v-200Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M440-440H240q-17 0-28.5-11.5T200-480q0-17 11.5-28.5T240-520h200v-200q0-17 11.5-28.5T480-760q17 0 28.5 11.5T520-720v200h200q17 0 28.5 11.5T760-480q0 17-11.5 28.5T720-440H520v200q0 17-11.5 28.5T480-200q-17 0-28.5-11.5T440-240v-200Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--add{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--arrow-down{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--arrow-down{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--arrow-up{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-528 324-372q-11 11-28 11t-28-11q-11-11-11-28t11-28l184-184q12-12 28-12t28 12l184 184q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-528Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-528 324-372q-11 11-28 11t-28-11q-11-11-11-28t11-28l184-184q12-12 28-12t28 12l184 184q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-528Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--arrow-up{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--arrow-forward{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M647-440H200q-17 0-28.5-11.5T160-480q0-17 11.5-28.5T200-520h447L451-716q-12-12-11.5-28t12.5-28q12-11 28-11.5t28 11.5l264 264q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L508-188q-11 11-27.5 11T452-188q-12-12-12-28.5t12-28.5l195-195Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M647-440H200q-17 0-28.5-11.5T160-480q0-17 11.5-28.5T200-520h447L451-716q-12-12-11.5-28t12.5-28q12-11 28-11.5t28 11.5l264 264q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L508-188q-11 11-27.5 11T452-188q-12-12-12-28.5t12-28.5l195-195Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--arrow-forward{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--arrow-back{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m313-440 196 196q12 12 11.5 28T508-188q-12 11-28 11.5T452-188L188-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l264-264q11-11 27.5-11t28.5 11q12 12 12 28.5T508-715L313-520h447q17 0 28.5 11.5T800-480q0 17-11.5 28.5T760-440H313Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m313-440 196 196q12 12 11.5 28T508-188q-12 11-28 11.5T452-188L188-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l264-264q11-11 27.5-11t28.5 11q12 12 12 28.5T508-715L313-520h447q17 0 28.5 11.5T800-480q0 17-11.5 28.5T760-440H313Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--arrow-back{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--autorenew{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M240-478q0 16 2 31.5t7 30.5q5 17-1 32.5T227-361q-16 8-31.5 1.5T175-383q-8-23-11.5-47t-3.5-48q0-134 93-228t227-94h7l-36-36q-11-11-11-28t11-28q11-11 28-11t28 11l104 104q12 12 12 28t-12 28L507-628q-11 11-28 11t-28-11q-11-11-11-28t11-28l36-36h-7q-100 0-170 70.5T240-478Zm480-4q0-16-2-31.5t-7-30.5q-5-17 1-32.5t21-22.5q16-8 31.5-1.5T785-577q8 23 11.5 47t3.5 48q0 134-93 228t-227 94h-7l36 36q11 11 11 28t-11 28q-11 11-28 11t-28-11L349-172q-12-12-12-28t12-28l104-104q11-11 28-11t28 11q11 11 11 28t-11 28l-36 36h7q100 0 170-70.5T720-482Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M240-478q0 16 2 31.5t7 30.5q5 17-1 32.5T227-361q-16 8-31.5 1.5T175-383q-8-23-11.5-47t-3.5-48q0-134 93-228t227-94h7l-36-36q-11-11-11-28t11-28q11-11 28-11t28 11l104 104q12 12 12 28t-12 28L507-628q-11 11-28 11t-28-11q-11-11-11-28t11-28l36-36h-7q-100 0-170 70.5T240-478Zm480-4q0-16-2-31.5t-7-30.5q-5-17 1-32.5t21-22.5q16-8 31.5-1.5T785-577q8 23 11.5 47t3.5 48q0 134-93 228t-227 94h-7l36 36q11 11 11 28t-11 28q-11 11-28 11t-28-11L349-172q-12-12-12-28t12-28l104-104q11-11 28-11t28 11q11 11 11 28t-11 28l-36 36h7q100 0 170-70.5T720-482Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--autorenew{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--calendar-today{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-40q0-17 11.5-28.5T280-880q17 0 28.5 11.5T320-840v40h320v-40q0-17 11.5-28.5T680-880q17 0 28.5 11.5T720-840v40h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-40q0-17 11.5-28.5T280-880q17 0 28.5 11.5T320-840v40h320v-40q0-17 11.5-28.5T680-880q17 0 28.5 11.5T720-840v40h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--calendar-today{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--check{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m382-354 339-339q12-12 28-12t28 12q12 12 12 28.5T777-636L410-268q-12 12-28 12t-28-12L182-440q-12-12-11.5-28.5T183-497q12-12 28.5-12t28.5 12l142 143Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m382-354 339-339q12-12 28-12t28 12q12 12 12 28.5T777-636L410-268q-12 12-28 12t-28-12L182-440q-12-12-11.5-28.5T183-497q12-12 28.5-12t28.5 12l142 143Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--check{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--checklist{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m221-313 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-228q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm0-320 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-548q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm339 353q-17 0-28.5-11.5T520-320q0-17 11.5-28.5T560-360h280q17 0 28.5 11.5T880-320q0 17-11.5 28.5T840-280H560Zm0-320q-17 0-28.5-11.5T520-640q0-17 11.5-28.5T560-680h280q17 0 28.5 11.5T880-640q0 17-11.5 28.5T840-600H560Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m221-313 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-228q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm0-320 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-548q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm339 353q-17 0-28.5-11.5T520-320q0-17 11.5-28.5T560-360h280q17 0 28.5 11.5T880-320q0 17-11.5 28.5T840-280H560Zm0-320q-17 0-28.5-11.5T520-640q0-17 11.5-28.5T560-680h280q17 0 28.5 11.5T880-640q0 17-11.5 28.5T840-600H560Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--checklist{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--chevron-left{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m432-480 156 156q11 11 11 28t-11 28q-11 11-28 11t-28-11L348-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 28-11t28 11q11 11 11 28t-11 28L432-480Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m432-480 156 156q11 11 11 28t-11 28q-11 11-28 11t-28-11L348-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 28-11t28 11q11 11 11 28t-11 28L432-480Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--chevron-left{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--chevron-right{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M504-480 348-636q-11-11-11-28t11-28q11-11 28-11t28 11l184 184q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L404-268q-11 11-28 11t-28-11q-11-11-11-28t11-28l156-156Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M504-480 348-636q-11-11-11-28t11-28q11-11 28-11t28 11l184 184q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L404-268q-11 11-28 11t-28-11q-11-11-11-28t11-28l156-156Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--chevron-right{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--close{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-424 284-228q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536-480l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-424Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-424 284-228q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536-480l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-424Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--close{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--content-copy{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M360-240q-33 0-56.5-23.5T280-320v-480q0-33 23.5-56.5T360-880h360q33 0 56.5 23.5T800-800v480q0 33-23.5 56.5T720-240H360ZM200-80q-33 0-56.5-23.5T120-160v-520q0-17 11.5-28.5T160-720q17 0 28.5 11.5T200-680v520h400q17 0 28.5 11.5T640-120q0 17-11.5 28.5T600-80H200Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M360-240q-33 0-56.5-23.5T280-320v-480q0-33 23.5-56.5T360-880h360q33 0 56.5 23.5T800-800v480q0 33-23.5 56.5T720-240H360ZM200-80q-33 0-56.5-23.5T120-160v-520q0-17 11.5-28.5T160-720q17 0 28.5 11.5T200-680v520h400q17 0 28.5 11.5T640-120q0 17-11.5 28.5T600-80H200Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--content-copy{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--danger{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-79q-16 0-30.5-6T423-102L102-423q-11-12-17-26.5T79-480q0-16 6-31t17-26l321-321q12-12 26.5-17.5T480-881q16 0 31 5.5t26 17.5l321 321q12 11 17.5 26t5.5 31q0 16-5.5 30.5T858-423L537-102q-11 11-26 17t-31 6Zm0-361q17 0 28.5-11.5T520-480v-160q0-17-11.5-28.5T480-680q-17 0-28.5 11.5T440-640v160q0 17 11.5 28.5T480-440Zm0 120q17 0 28.5-11.5T520-360q0-17-11.5-28.5T480-400q-17 0-28.5 11.5T440-360q0 17 11.5 28.5T480-320Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-79q-16 0-30.5-6T423-102L102-423q-11-12-17-26.5T79-480q0-16 6-31t17-26l321-321q12-12 26.5-17.5T480-881q16 0 31 5.5t26 17.5l321 321q12 11 17.5 26t5.5 31q0 16-5.5 30.5T858-423L537-102q-11 11-26 17t-31 6Zm0-361q17 0 28.5-11.5T520-480v-160q0-17-11.5-28.5T480-680q-17 0-28.5 11.5T440-640v160q0 17 11.5 28.5T480-440Zm0 120q17 0 28.5-11.5T520-360q0-17-11.5-28.5T480-400q-17 0-28.5 11.5T440-360q0 17 11.5 28.5T480-320Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--danger{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--delete{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm120-160q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm120-160q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--delete{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--download{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-337q-8 0-15-2.5t-13-8.5L308-492q-12-12-11.5-28t11.5-28q12-12 28.5-12.5T365-549l75 75v-286q0-17 11.5-28.5T480-800q17 0 28.5 11.5T520-760v286l75-75q12-12 28.5-11.5T652-548q11 12 11.5 28T652-492L508-348q-6 6-13 8.5t-15 2.5ZM240-160q-33 0-56.5-23.5T160-240v-80q0-17 11.5-28.5T200-360q17 0 28.5 11.5T240-320v80h480v-80q0-17 11.5-28.5T760-360q17 0 28.5 11.5T800-320v80q0 33-23.5 56.5T720-160H240Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-337q-8 0-15-2.5t-13-8.5L308-492q-12-12-11.5-28t11.5-28q12-12 28.5-12.5T365-549l75 75v-286q0-17 11.5-28.5T480-800q17 0 28.5 11.5T520-760v286l75-75q12-12 28.5-11.5T652-548q11 12 11.5 28T652-492L508-348q-6 6-13 8.5t-15 2.5ZM240-160q-33 0-56.5-23.5T160-240v-80q0-17 11.5-28.5T200-360q17 0 28.5 11.5T240-320v80h480v-80q0-17 11.5-28.5T760-360q17 0 28.5 11.5T800-320v80q0 33-23.5 56.5T720-160H240Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--download{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--draft{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h287q16 0 30.5 6t25.5 17l194 194q11 11 17 25.5t6 30.5v447q0 33-23.5 56.5T720-80H240Zm280-560q0 17 11.5 28.5T560-600h160L520-800v160Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h287q16 0 30.5 6t25.5 17l194 194q11 11 17 25.5t6 30.5v447q0 33-23.5 56.5T720-80H240Zm280-560q0 17 11.5 28.5T560-600h160L520-800v160Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--draft{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--drive-folder-upload{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h207q16 0 30.5 6t25.5 17l57 57h320q33 0 56.5 23.5T880-640v400q0 33-23.5 56.5T800-160H160Zm320-120q17 0 28.5-11.5T520-320v-128l36 36q11 11 28 11t28-11q11-11 11-28t-11-28L508-572q-12-12-28-12t-28 12L348-468q-11 11-11 28t11 28q11 11 28 11t28-11l36-36v128q0 17 11.5 28.5T480-280Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h207q16 0 30.5 6t25.5 17l57 57h320q33 0 56.5 23.5T880-640v400q0 33-23.5 56.5T800-160H160Zm320-120q17 0 28.5-11.5T520-320v-128l36 36q11 11 28 11t28-11q11-11 11-28t-11-28L508-572q-12-12-28-12t-28 12L348-468q-11 11-11 28t11 28q11 11 28 11t28-11l36-36v128q0 17 11.5 28.5T480-280Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--drive-folder-upload{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--easy-language{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M120-274v-286q0-32 23.5-54t55.5-20q79 12 150.5 46.5T480-498q59-55 130.5-89.5T761-634q32-2 55.5 20t23.5 54v286q0 32-21 54.5T766-195q-64 10-124 33t-112 61q-11 9-23.5 13.5T480-83q-14 0-26.5-4.5T430-101q-52-38-112-61t-124-33q-32-2-53-24.5T120-274Zm360-326q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M120-274v-286q0-32 23.5-54t55.5-20q79 12 150.5 46.5T480-498q59-55 130.5-89.5T761-634q32-2 55.5 20t23.5 54v286q0 32-21 54.5T766-195q-64 10-124 33t-112 61q-11 9-23.5 13.5T480-83q-14 0-26.5-4.5T430-101q-52-38-112-61t-124-33q-32-2-53-24.5T120-274Zm360-326q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--easy-language{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--edit{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M160-120q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm544-528 56-56-56-56-56 56 56 56Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M160-120q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm544-528 56-56-56-56-56 56 56 56Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--edit{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--home{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M160-200v-360q0-19 8.5-36t23.5-28l240-180q21-16 48-16t48 16l240 180q15 11 23.5 28t8.5 36v360q0 33-23.5 56.5T720-120H600q-17 0-28.5-11.5T560-160v-200q0-17-11.5-28.5T520-400h-80q-17 0-28.5 11.5T400-360v200q0 17-11.5 28.5T360-120H240q-33 0-56.5-23.5T160-200Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M160-200v-360q0-19 8.5-36t23.5-28l240-180q21-16 48-16t48 16l240 180q15 11 23.5 28t8.5 36v360q0 33-23.5 56.5T720-120H600q-17 0-28.5-11.5T560-160v-200q0-17-11.5-28.5T520-400h-80q-17 0-28.5 11.5T400-360v200q0 17-11.5 28.5T360-120H240q-33 0-56.5-23.5T160-200Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--home{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--help{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M478-240q21 0 35.5-14.5T528-290q0-21-14.5-35.5T478-340q-21 0-35.5 14.5T428-290q0 21 14.5 35.5T478-240Zm2 160q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Zm4-172q25 0 43.5 16t18.5 40q0 22-13.5 39T502-525q-23 20-40.5 44T444-427q0 14 10.5 23.5T479-394q15 0 25.5-10t13.5-25q4-21 18-37.5t30-31.5q23-22 39.5-48t16.5-58q0-51-41.5-83.5T484-720q-38 0-72.5 16T359-655q-7 12-4.5 25.5T368-609q14 8 29 5t25-17q11-15 27.5-23t34.5-8Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M478-240q21 0 35.5-14.5T528-290q0-21-14.5-35.5T478-340q-21 0-35.5 14.5T428-290q0 21 14.5 35.5T478-240Zm2 160q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Zm4-172q25 0 43.5 16t18.5 40q0 22-13.5 39T502-525q-23 20-40.5 44T444-427q0 14 10.5 23.5T479-394q15 0 25.5-10t13.5-25q4-21 18-37.5t30-31.5q23-22 39.5-48t16.5-58q0-51-41.5-83.5T484-720q-38 0-72.5 16T359-655q-7 12-4.5 25.5T368-609q14 8 29 5t25-17q11-15 27.5-23t34.5-8Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--help{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--info{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-280q17 0 28.5-11.5T520-320v-160q0-17-11.5-28.5T480-520q-17 0-28.5 11.5T440-480v160q0 17 11.5 28.5T480-280Zm0-320q17 0 28.5-11.5T520-640q0-17-11.5-28.5T480-680q-17 0-28.5 11.5T440-640q0 17 11.5 28.5T480-600Zm0 520q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-280q17 0 28.5-11.5T520-320v-160q0-17-11.5-28.5T480-520q-17 0-28.5 11.5T440-480v160q0 17 11.5 28.5T480-280Zm0-320q17 0 28.5-11.5T520-640q0-17-11.5-28.5T480-680q-17 0-28.5 11.5T440-640q0 17 11.5 28.5T480-600Zm0 520q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--info{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--keyboard-double-arrow-left{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--keyboard-double-arrow-left{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--keyboard-double-arrow-right{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M383-480 228-636q-11-11-11.5-27.5T228-692q11-11 28-11t28 11l184 184q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L284-268q-11 11-27.5 11.5T228-268q-11-11-11-28t11-28l155-156Zm264 0L492-636q-11-11-11.5-27.5T492-692q11-11 28-11t28 11l184 184q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L548-268q-11 11-27.5 11.5T492-268q-11-11-11-28t11-28l155-156Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M383-480 228-636q-11-11-11.5-27.5T228-692q11-11 28-11t28 11l184 184q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L284-268q-11 11-27.5 11.5T228-268q-11-11-11-28t11-28l155-156Zm264 0L492-636q-11-11-11.5-27.5T492-692q11-11 28-11t28 11l184 184q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L548-268q-11 11-27.5 11.5T492-268q-11-11-11-28t11-28l155-156Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--keyboard-double-arrow-right{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--logout{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h240q17 0 28.5 11.5T480-800q0 17-11.5 28.5T440-760H200v560h240q17 0 28.5 11.5T480-160q0 17-11.5 28.5T440-120H200Zm487-320H400q-17 0-28.5-11.5T360-480q0-17 11.5-28.5T400-520h287l-75-75q-11-11-11-27t11-28q11-12 28-12.5t29 11.5l143 143q12 12 12 28t-12 28L669-309q-12 12-28.5 11.5T612-310q-11-12-10.5-28.5T613-366l74-74Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h240q17 0 28.5 11.5T480-800q0 17-11.5 28.5T440-760H200v560h240q17 0 28.5 11.5T480-160q0 17-11.5 28.5T440-120H200Zm487-320H400q-17 0-28.5-11.5T360-480q0-17 11.5-28.5T400-520h287l-75-75q-11-11-11-27t11-28q11-12 28-12.5t29 11.5l143 143q12 12 12 28t-12 28L669-309q-12 12-28.5 11.5T612-310q-11-12-10.5-28.5T613-366l74-74Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--logout{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--mail{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm320-287q5 0 10.5-1.5T501-453l283-177q8-5 12-12.5t4-16.5q0-20-17-30t-35 1L480-520 212-688q-18-11-35-.5T160-659q0 10 4 17.5t12 11.5l283 177q5 3 10.5 4.5T480-447Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm320-287q5 0 10.5-1.5T501-453l283-177q8-5 12-12.5t4-16.5q0-20-17-30t-35 1L480-520 212-688q-18-11-35-.5T160-659q0 10 4 17.5t12 11.5l283 177q5 3 10.5 4.5T480-447Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--mail{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--more-vert{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-160q-33 0-56.5-23.5T400-240q0-33 23.5-56.5T480-320q33 0 56.5 23.5T560-240q0 33-23.5 56.5T480-160Zm0-240q-33 0-56.5-23.5T400-480q0-33 23.5-56.5T480-560q33 0 56.5 23.5T560-480q0 33-23.5 56.5T480-400Zm0-240q-33 0-56.5-23.5T400-720q0-33 23.5-56.5T480-800q33 0 56.5 23.5T560-720q0 33-23.5 56.5T480-640Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-160q-33 0-56.5-23.5T400-240q0-33 23.5-56.5T480-320q33 0 56.5 23.5T560-240q0 33-23.5 56.5T480-160Zm0-240q-33 0-56.5-23.5T400-480q0-33 23.5-56.5T480-560q33 0 56.5 23.5T560-480q0 33-23.5 56.5T480-400Zm0-240q-33 0-56.5-23.5T400-720q0-33 23.5-56.5T480-800q33 0 56.5 23.5T560-720q0 33-23.5 56.5T480-640Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--more-vert{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--open-in-new{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h240q17 0 28.5 11.5T480-800q0 17-11.5 28.5T440-760H200v560h560v-240q0-17 11.5-28.5T800-480q17 0 28.5 11.5T840-440v240q0 33-23.5 56.5T760-120H200Zm560-584L416-360q-11 11-28 11t-28-11q-11-11-11-28t11-28l344-344H600q-17 0-28.5-11.5T560-800q0-17 11.5-28.5T600-840h200q17 0 28.5 11.5T840-800v200q0 17-11.5 28.5T800-560q-17 0-28.5-11.5T760-600v-104Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h240q17 0 28.5 11.5T480-800q0 17-11.5 28.5T440-760H200v560h560v-240q0-17 11.5-28.5T800-480q17 0 28.5 11.5T840-440v240q0 33-23.5 56.5T760-120H200Zm560-584L416-360q-11 11-28 11t-28-11q-11-11-11-28t11-28l344-344H600q-17 0-28.5-11.5T560-800q0-17 11.5-28.5T600-840h200q17 0 28.5 11.5T840-800v200q0 17-11.5 28.5T800-560q-17 0-28.5-11.5T760-600v-104Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--open-in-new{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--question-mark{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M584-637q0-43-28.5-69T480-732q-29 0-52.5 12.5T387-683q-16 23-43.5 26.5T296-671q-14-13-15.5-32t9.5-36q32-48 81.5-74.5T480-840q97 0 157.5 55T698-641q0 45-19 81t-70 85q-37 35-50 54.5T542-376q-4 24-20.5 40T482-320q-23 0-39.5-15.5T426-374q0-39 17-71.5t57-68.5q51-45 67.5-69.5T584-637ZM480-80q-33 0-56.5-23.5T400-160q0-33 23.5-56.5T480-240q33 0 56.5 23.5T560-160q0 33-23.5 56.5T480-80Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M584-637q0-43-28.5-69T480-732q-29 0-52.5 12.5T387-683q-16 23-43.5 26.5T296-671q-14-13-15.5-32t9.5-36q32-48 81.5-74.5T480-840q97 0 157.5 55T698-641q0 45-19 81t-70 85q-37 35-50 54.5T542-376q-4 24-20.5 40T482-320q-23 0-39.5-15.5T426-374q0-39 17-71.5t57-68.5q51-45 67.5-69.5T584-637ZM480-80q-33 0-56.5-23.5T400-160q0-33 23.5-56.5T480-240q33 0 56.5 23.5T560-160q0 33-23.5 56.5T480-80Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--question-mark{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--search{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M380-320q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l224 224q11 11 11 28t-11 28q-11 11-28 11t-28-11L532-372q-30 24-69 38t-83 14Zm0-80q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M380-320q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l224 224q11 11 11 28t-11 28q-11 11-28 11t-28-11L532-372q-30 24-69 38t-83 14Zm0-80q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--search{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--sign-language{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M200-40q-17 0-28.5-11.5T160-80q0-17 11.5-28.5T200-120h160v-40H120q-17 0-28.5-11.5T80-200q0-17 11.5-28.5T120-240h240v-40H80q-17 0-28.5-11.5T40-320q0-17 11.5-28.5T80-360h280v-40H160q-17 0-28.5-11.5T120-440q0-17 11.5-28.5T160-480h244l-34-60q-12-21-9.5-44.5T380-625l4-3q11-11 25.5-12t26.5 8l236 176q23 17 35.5 42t12.5 54v200q0 50-35 85t-85 35H200Zm593-374q-10 0-18-5.5T763-436q-9-20-23-37t-32-31L524-641 303-807q-14-10-16-26t8-30q10-14 26-16.5t30 7.5l224 169 24-33-160-120q-14-10-16.5-26t7.5-30q10-14 26-16t30 8l196 146 9-69q3-24 19-41t39-21l6-1q15-2 27 6t17 22l84 283q8 27 3 55t-22 51l-48 64q-5 6-10.5 8.5T793-414ZM248-599q10-14 25.5-16t29.5 8q14 10 16.5 25.5T312-552q-10 14-26 16.5t-30-7.5q-14-10-16-26t8-30Zm15-88q-14-10-16-26t8-30q10-14 26-16t30 8l32 25q15 12 15.5 27t-8.5 27q-9 12-24 16t-30-7l-33-24Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M200-40q-17 0-28.5-11.5T160-80q0-17 11.5-28.5T200-120h160v-40H120q-17 0-28.5-11.5T80-200q0-17 11.5-28.5T120-240h240v-40H80q-17 0-28.5-11.5T40-320q0-17 11.5-28.5T80-360h280v-40H160q-17 0-28.5-11.5T120-440q0-17 11.5-28.5T160-480h244l-34-60q-12-21-9.5-44.5T380-625l4-3q11-11 25.5-12t26.5 8l236 176q23 17 35.5 42t12.5 54v200q0 50-35 85t-85 35H200Zm593-374q-10 0-18-5.5T763-436q-9-20-23-37t-32-31L524-641 303-807q-14-10-16-26t8-30q10-14 26-16.5t30 7.5l224 169 24-33-160-120q-14-10-16.5-26t7.5-30q10-14 26-16t30 8l196 146 9-69q3-24 19-41t39-21l6-1q15-2 27 6t17 22l84 283q8 27 3 55t-22 51l-48 64q-5 6-10.5 8.5T793-414ZM248-599q10-14 25.5-16t29.5 8q14 10 16.5 25.5T312-552q-10 14-26 16.5t-30-7.5q-14-10-16-26t8-30Zm15-88q-14-10-16-26t8-30q10-14 26-16t30 8l32 25q15 12 15.5 27t-8.5 27q-9 12-24 16t-30-7l-33-24Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--sign-language{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--success{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m424-408-86-86q-11-11-28-11t-28 11q-11 11-11 28t11 28l114 114q12 12 28 12t28-12l226-226q11-11 11-28t-11-28q-11-11-28-11t-28 11L424-408Zm56 328q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m424-408-86-86q-11-11-28-11t-28 11q-11 11-11 28t11 28l114 114q12 12 28 12t28-12l226-226q11-11 11-28t-11-28q-11-11-28-11t-28 11L424-408Zm56 328q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--success{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--visibility{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-320q75 0 127.5-52.5T660-500q0-75-52.5-127.5T480-680q-75 0-127.5 52.5T300-500q0 75 52.5 127.5T480-320Zm0-72q-45 0-76.5-31.5T372-500q0-45 31.5-76.5T480-608q45 0 76.5 31.5T588-500q0 45-31.5 76.5T480-392Zm0 192q-134 0-244.5-72T61-462q-5-9-7.5-18.5T51-500q0-10 2.5-19.5T61-538q64-118 174.5-190T480-800q134 0 244.5 72T899-538q5 9 7.5 18.5T909-500q0 10-2.5 19.5T899-462q-64 118-174.5 190T480-200Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-320q75 0 127.5-52.5T660-500q0-75-52.5-127.5T480-680q-75 0-127.5 52.5T300-500q0 75 52.5 127.5T480-320Zm0-72q-45 0-76.5-31.5T372-500q0-45 31.5-76.5T480-608q45 0 76.5 31.5T588-500q0 45-31.5 76.5T480-392Zm0 192q-134 0-244.5-72T61-462q-5-9-7.5-18.5T51-500q0-10 2.5-19.5T61-538q64-118 174.5-190T480-800q134 0 244.5 72T899-538q5 9 7.5 18.5T909-500q0 10-2.5 19.5T899-462q-64 118-174.5 190T480-200Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--visibility{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--visibility-off{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M764-84 624-222q-35 11-71 16.5t-73 5.5q-134 0-245-72T61-462q-5-9-7.5-18.5T51-500q0-10 2.5-19.5T61-538q22-39 47-76t58-66l-83-84q-11-11-11-27.5T84-820q11-11 28-11t28 11l680 680q11 11 11.5 27.5T820-84q-11 11-28 11t-28-11ZM480-320q11 0 21-1t20-4L305-541q-3 10-4 20t-1 21q0 75 52.5 127.5T480-320Zm0-480q134 0 245.5 72.5T900-537q5 8 7.5 17.5T910-500q0 10-2 19.5t-7 17.5q-19 37-42.5 70T806-331q-14 14-33 13t-33-15l-80-80q-7-7-9-16.5t1-19.5q4-13 6-25t2-26q0-75-52.5-127.5T480-680q-14 0-26 2t-25 6q-10 3-20 1t-17-9l-33-33q-19-19-12.5-44t31.5-32q25-5 50.5-8t51.5-3Zm79 226q11 13 18.5 28.5T587-513q1 8-6 11t-13-3l-82-82q-6-6-2.5-13t11.5-7q19 2 35 10.5t29 22.5Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M764-84 624-222q-35 11-71 16.5t-73 5.5q-134 0-245-72T61-462q-5-9-7.5-18.5T51-500q0-10 2.5-19.5T61-538q22-39 47-76t58-66l-83-84q-11-11-11-27.5T84-820q11-11 28-11t28 11l680 680q11 11 11.5 27.5T820-84q-11 11-28 11t-28-11ZM480-320q11 0 21-1t20-4L305-541q-3 10-4 20t-1 21q0 75 52.5 127.5T480-320Zm0-480q134 0 245.5 72.5T900-537q5 8 7.5 17.5T910-500q0 10-2 19.5t-7 17.5q-19 37-42.5 70T806-331q-14 14-33 13t-33-15l-80-80q-7-7-9-16.5t1-19.5q4-13 6-25t2-26q0-75-52.5-127.5T480-680q-14 0-26 2t-25 6q-10 3-20 1t-17-9l-33-33q-19-19-12.5-44t31.5-32q25-5 50.5-8t51.5-3Zm79 226q11 13 18.5 28.5T587-513q1 8-6 11t-13-3l-82-82q-6-6-2.5-13t11.5-7q19 2 35 10.5t29 22.5Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--visibility-off{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--warning{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M109-120q-11 0-20-5.5T75-140q-5-9-5.5-19.5T75-180l370-640q6-10 15.5-15t19.5-5q10 0 19.5 5t15.5 15l370 640q6 10 5.5 20.5T885-140q-5 9-14 14.5t-20 5.5H109Zm371-120q17 0 28.5-11.5T520-280q0-17-11.5-28.5T480-320q-17 0-28.5 11.5T440-280q0 17 11.5 28.5T480-240Zm0-120q17 0 28.5-11.5T520-400v-120q0-17-11.5-28.5T480-560q-17 0-28.5 11.5T440-520v120q0 17 11.5 28.5T480-360Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M109-120q-11 0-20-5.5T75-140q-5-9-5.5-19.5T75-180l370-640q6-10 15.5-15t19.5-5q10 0 19.5 5t15.5 15l370 640q6 10 5.5 20.5T885-140q-5 9-14 14.5t-20 5.5H109Zm371-120q17 0 28.5-11.5T520-280q0-17-11.5-28.5T480-320q-17 0-28.5 11.5T440-280q0 17 11.5 28.5T480-240Zm0-120q17 0 28.5-11.5T520-400v-120q0-17-11.5-28.5T480-560q-17 0-28.5 11.5T440-520v120q0 17 11.5 28.5T480-360Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--warning{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--brightness-medium{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M346-160H240q-33 0-56.5-23.5T160-240v-106l-77-78q-11-12-17-26.5T60-480q0-15 6-29.5T83-536l77-78v-106q0-33 23.5-56.5T240-800h106l78-77q12-11 26.5-17t29.5-6q15 0 29.5 6t26.5 17l78 77h106q33 0 56.5 23.5T800-720v106l77 78q11 12 17 26.5t6 29.5q0 15-6 29.5T877-424l-77 78v106q0 33-23.5 56.5T720-160H614l-78 77q-12 11-26.5 17T480-60q-15 0-29.5-6T424-83l-78-77Zm34-80 100 100 100-100h140v-140l100-100-100-100v-140H580L480-820 380-720H240v140L140-480l100 100v140h140Zm100-40q83 0 141.5-58.5T680-480q0-83-58.5-141.5T480-680v400Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M346-160H240q-33 0-56.5-23.5T160-240v-106l-77-78q-11-12-17-26.5T60-480q0-15 6-29.5T83-536l77-78v-106q0-33 23.5-56.5T240-800h106l78-77q12-11 26.5-17t29.5-6q15 0 29.5 6t26.5 17l78 77h106q33 0 56.5 23.5T800-720v106l77 78q11 12 17 26.5t6 29.5q0 15-6 29.5T877-424l-77 78v106q0 33-23.5 56.5T720-160H614l-78 77q-12 11-26.5 17T480-60q-15 0-29.5-6T424-83l-78-77Zm34-80 100 100 100-100h140v-140l100-100-100-100v-140H580L480-820 380-720H240v140L140-480l100 100v140h140Zm100-40q83 0 141.5-58.5T680-480q0-83-58.5-141.5T480-680v400Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--brightness-medium{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--light-mode{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM80-440q-17 0-28.5-11.5T40-480q0-17 11.5-28.5T80-520h80q17 0 28.5 11.5T200-480q0 17-11.5 28.5T160-440H80Zm720 0q-17 0-28.5-11.5T760-480q0-17 11.5-28.5T800-520h80q17 0 28.5 11.5T920-480q0 17-11.5 28.5T880-440h-80ZM480-760q-17 0-28.5-11.5T440-800v-80q0-17 11.5-28.5T480-920q17 0 28.5 11.5T520-880v80q0 17-11.5 28.5T480-760Zm0 720q-17 0-28.5-11.5T440-80v-80q0-17 11.5-28.5T480-200q17 0 28.5 11.5T520-160v80q0 17-11.5 28.5T480-40ZM226-678l-43-42q-12-11-11.5-28t11.5-29q12-12 29-12t28 12l42 43q11 12 11 28t-11 28q-11 12-27.5 11.5T226-678Zm494 495-42-43q-11-12-11-28.5t11-27.5q11-12 27.5-11.5T734-282l43 42q12 11 11.5 28T777-183q-12 12-29 12t-28-12Zm-42-495q-12-11-11.5-27.5T678-734l42-43q11-12 28-11.5t29 11.5q12 12 12 29t-12 28l-43 42q-12 11-28 11t-28-11ZM183-183q-12-12-12-29t12-28l43-42q12-11 28.5-11t27.5 11q12 11 11.5 27.5T282-226l-42 43q-11 12-28 11.5T183-183Zm297-297Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM80-440q-17 0-28.5-11.5T40-480q0-17 11.5-28.5T80-520h80q17 0 28.5 11.5T200-480q0 17-11.5 28.5T160-440H80Zm720 0q-17 0-28.5-11.5T760-480q0-17 11.5-28.5T800-520h80q17 0 28.5 11.5T920-480q0 17-11.5 28.5T880-440h-80ZM480-760q-17 0-28.5-11.5T440-800v-80q0-17 11.5-28.5T480-920q17 0 28.5 11.5T520-880v80q0 17-11.5 28.5T480-760Zm0 720q-17 0-28.5-11.5T440-80v-80q0-17 11.5-28.5T480-200q17 0 28.5 11.5T520-160v80q0 17-11.5 28.5T480-40ZM226-678l-43-42q-12-11-11.5-28t11.5-29q12-12 29-12t28 12l42 43q11 12 11 28t-11 28q-11 12-27.5 11.5T226-678Zm494 495-42-43q-11-12-11-28.5t11-27.5q11-12 27.5-11.5T734-282l43 42q12 11 11.5 28T777-183q-12 12-29 12t-28-12Zm-42-495q-12-11-11.5-27.5T678-734l42-43q11-12 28-11.5t29 11.5q12 12 12 29t-12 28l-43 42q-12 11-28 11t-28-11ZM183-183q-12-12-12-29t12-28l43-42q12-11 28.5-11t27.5 11q12 11 11.5 27.5T282-226l-42 43q-11 12-28 11.5T183-183Zm297-297Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--light-mode{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-icon--dark-mode{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-120q-151 0-255.5-104.5T120-480q0-138 90-239.5T440-838q13-2 23 3.5t16 14.5q6 9 6.5 21t-7.5 23q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q11-7 22.5-6.5T819-479q10 5 15.5 15t3.5 24q-14 138-117.5 229T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Zm-10-270Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-120q-151 0-255.5-104.5T120-480q0-138 90-239.5T440-838q13-2 23 3.5t16 14.5q6 9 6.5 21t-7.5 23q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q11-7 22.5-6.5T819-479q10 5 15.5 15t3.5 24q-14 138-117.5 229T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Zm-10-270Z'/%3E%3C/svg%3E");background-color:var(--kern-color-layout-text-default, #171a2b)}@media (forced-colors: active){.kern-icon--dark-mode{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-accordion{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;border-radius:var(--kern-metric-border-radius-none, 0px);border-top:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-layout-border, #A5AAC3);border-bottom:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-layout-border, #A5AAC3)}.kern-accordion+.kern-accordion{margin-top:calc(var(--kern-metric-border-width-light) * -1)}.kern-accordion[open]>summary:after{-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-528 324-372q-11 11-28 11t-28-11q-11-11-11-28t11-28l184-184q12-12 28-12t28 12l184 184q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-528Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-528 324-372q-11 11-28 11t-28-11q-11-11-11-28t11-28l184-184q12-12 28-12t28 12l184 184q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-528Z'/%3E%3C/svg%3E");background-color:var(--kern-color-action-default, #1A3DA5)}@media (forced-colors: active){.kern-accordion[open]>summary:after{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-accordion__header{display:flex;justify-content:space-between;align-items:center;gap:var(--kern-metric-space-small, 8px);flex:1 0 0;padding:var(--kern-metric-space-default, 16px) var(--kern-metric-space-x-small, 4px);list-style-type:none}.kern-accordion__header::-webkit-details-marker,.kern-accordion__header::marker{display:none}.kern-accordion__header:after{content:"";width:var(--kern-metric-dimension-default, 24px);min-width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-default, 24px);-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z'/%3E%3C/svg%3E");-webkit-mask-size:cover;mask-size:cover;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;background-color:var(--kern-color-action-default, #1A3DA5)}@media (forced-colors: active){.kern-accordion__header:after{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-accordion__header:hover{background:var(--kern-color-action-state-indicator-tint-hover-opacity);cursor:pointer}.kern-accordion__header:not([tabindex="-1"]):focus-visible{position:relative;z-index:1;outline-color:transparent;box-shadow:0 0 0 2px var(--kern-color-action-on-default),0 0 0 4px var(--kern-color-action-focus-border-inside),0 0 0 6px var(--kern-color-action-focus-border-outside)}@media (forced-colors: active){.kern-accordion__header:not([tabindex="-1"]):focus-visible{outline-offset:4px!important;outline-width:3px!important;outline-color:transparent!important}}.kern-accordion__header .kern-title{color:var(--kern-color-action-default, #1A3DA5);flex:1;overflow-wrap:break-word}.kern-accordion__body{padding:var(--kern-metric-space-none, 0px) var(--kern-metric-space-x-small, 4px) var(--kern-metric-space-large, 24px) var(--kern-metric-space-x-small, 4px)}.kern-alert{border-radius:var(--kern-metric-border-radius-default, 4px);border:var(--kern-metric-border-width-default, 2px) solid transparent}.kern-alert--info{border-color:var(--kern-color-feedback-info, #006490);background-color:var(--kern-color-feedback-info-background, #E0F4FC)}.kern-alert--info .kern-icon--info{background-color:var(--kern-color-feedback-info, #006490)}@media (forced-colors: active){.kern-alert--info .kern-icon--info{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-alert--success{border-color:var(--kern-color-feedback-success, #006B51);background-color:var(--kern-color-feedback-success-background, #DEF6ED)}.kern-alert--success .kern-icon--success{background-color:var(--kern-color-feedback-success, #006B51)}@media (forced-colors: active){.kern-alert--success .kern-icon--success{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-alert--warning{border-color:var(--kern-color-feedback-warning, #8A4F00);background-color:var(--kern-color-feedback-warning-background, #FFEFD0)}.kern-alert--warning .kern-icon--warning{background-color:var(--kern-color-feedback-warning, #8A4F00)}@media (forced-colors: active){.kern-alert--warning .kern-icon--warning{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-alert--danger{border-color:var(--kern-color-feedback-danger, #BD0F09);background-color:var(--kern-color-feedback-danger-background, #FEECE8)}.kern-alert--danger .kern-icon--danger{background-color:var(--kern-color-feedback-danger, #BD0F09)}@media (forced-colors: active){.kern-alert--danger .kern-icon--danger{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-alert__header{display:flex;padding:var(--kern-metric-space-default, 16px);align-items:center}.kern-alert__header .kern-icon{width:var(--kern-component-alert-icon-size, 32px);min-width:var(--kern-component-alert-icon-size, 32px);height:var(--kern-component-alert-icon-size, 32px);min-height:var(--kern-component-alert-icon-size, 32px)}.kern-alert .kern-title{padding-left:var(--kern-metric-space-small, 8px);padding-right:var(--kern-metric-space-small, 8px)}.kern-alert__body{padding:var(--kern-metric-space-small, 8px) var(--kern-metric-space-large, 24px) var(--kern-metric-space-default, 16px) var(--kern-metric-space-large, 24px);background:var(--kern-color-layout-background-default, #FFF);display:flex;flex-direction:column;gap:var(--kern-metric-space-small, 8px)}.kern-badge{display:inline-flex;align-items:center;padding:var(--kern-metric-space-2x-small, 2px) var(--kern-metric-space-default, 16px) var(--kern-metric-space-2x-small, 2px) var(--kern-component-badge-space-left, 12px);border-radius:var(--kern-metric-border-radius-default, 4px);min-height:var(--kern-metric-dimension-large, 32px)}.kern-badge .kern-label{padding:var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-x-small, 4px)}.kern-badge .kern-icon{width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-default, 24px)}.kern-badge--info{background:var(--kern-color-feedback-info-background, #E0F4FC);border:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-feedback-info, #006490)}.kern-badge--info .kern-icon{background-color:var(--kern-color-feedback-info, #006490)}@media (forced-colors: active){.kern-badge--info .kern-icon{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-badge--success{background:var(--kern-color-feedback-success-background, #DEF6ED);border:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-feedback-success, #006B51)}.kern-badge--success .kern-icon{background-color:var(--kern-color-feedback-success, #006B51)}@media (forced-colors: active){.kern-badge--success .kern-icon{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-badge--warning{background:var(--kern-color-feedback-warning-background, #FFEFD0);border:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-feedback-warning, #8A4F00)}.kern-badge--warning .kern-icon{background-color:var(--kern-color-feedback-warning, #8A4F00)}@media (forced-colors: active){.kern-badge--warning .kern-icon{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-badge--danger{background:var(--kern-color-feedback-danger-background, #FEECE8);border:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-feedback-danger, #BD0F09)}.kern-badge--danger .kern-icon{background-color:var(--kern-color-feedback-danger, #BD0F09)}@media (forced-colors: active){.kern-badge--danger .kern-icon{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-btn{display:inline-flex;min-height:var(--kern-metric-dimension-x-large, 48px);padding:var(--kern-metric-space-none, 0px) var(--kern-metric-space-default, 16px);justify-content:center;align-items:center;vertical-align:top;gap:var(--kern-metric-space-none, 0px);border:none;border-radius:var(--kern-metric-border-radius-default, 4px);position:relative}.kern-btn:has(.kern-sr-only){width:var(--kern-metric-dimension-x-large, 48px)}@media (max-width: 767px){.kern-btn:has(.kern-sr-only-mobile){width:var(--kern-metric-dimension-x-large, 48px)}}.kern-btn .kern-label{padding:var(--kern-metric-space-small, 8px)}.kern-btn:not(:disabled):hover,.kern-btn:not([aria-disabled=true]):hover{cursor:pointer}.kern-btn:not([disabled]):not([tabindex="-1"]):focus,.kern-btn:not([aria-disabled=true]):not([tabindex="-1"]):focus{border-radius:var(--kern-metric-border-radius-default, .25rem);box-shadow:0 0 0 2px var(--kern-color-action-on-default),0 0 0 4px var(--kern-color-action-focus-border-inside),0 0 0 6px var(--kern-color-action-focus-border-outside)}@media (forced-colors: active){.kern-btn:not([disabled]):not([tabindex="-1"]):focus:focus-visible,.kern-btn:not([aria-disabled=true]):not([tabindex="-1"]):focus:focus-visible{outline-offset:4px!important;outline-width:3px!important;outline-color:transparent!important}}.kern-btn:disabled,.kern-btn[disabled],.kern-btn[aria-disabled=true]{cursor:not-allowed!important}.kern-btn--block{width:100%}.kern-btn--primary{background:var(--kern-color-action-default, #1A3DA5)}@media (forced-colors: active){.kern-btn--primary{border:3px solid transparent}}.kern-btn--primary .kern-label{color:var(--kern-color-action-on-default, #FFF)}.kern-btn--primary>.kern-icon{background-color:var(--kern-color-action-on-default, #FFF)}@media (forced-colors: active){.kern-btn--primary>.kern-icon{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-btn--primary:not(:disabled):hover,.kern-btn--primary:not([aria-disabled=true]):hover{background:var(--kern-color-action-state-indicator-shade-hover)}.kern-btn--primary:active{background:var(--kern-color-action-state-indicator-shade-active)}.kern-btn--primary:disabled,.kern-btn--primary[disabled],.kern-btn--primary[aria-disabled=true]{background:var(--action-default, #1A3DA5);opacity:var(--action-state-opacity-disabled, .4)}.kern-btn--secondary{border:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-action-default, #1A3DA5);background:transparent}.kern-btn--secondary .kern-label{color:var(--kern-color-action-default, #1A3DA5)}.kern-btn--secondary>.kern-icon{background-color:var(--kern-color-action-default, #1A3DA5)}@media (forced-colors: active){.kern-btn--secondary>.kern-icon{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-btn--secondary:not(:disabled):hover,.kern-btn--secondary:not([aria-disabled=true]):hover{background:var(--kern-color-action-state-indicator-tint-hover-opacity)}.kern-btn--secondary:active{background:var(--kern-color-action-state-indicator-tint-active-opacity)}.kern-btn--secondary:disabled,.kern-btn--secondary[disabled],.kern-btn--secondary[aria-disabled=true]{opacity:var(--action-state-opacity-disabled, .4)}@media (forced-colors: active){.kern-btn--secondary{border:1px solid transparent!important}}.kern-btn--tertiary{background:transparent}.kern-btn--tertiary .kern-label{color:var(--kern-color-action-default, #1A3DA5)}.kern-btn--tertiary>.kern-icon{background-color:var(--kern-color-action-default, #1A3DA5)}@media (forced-colors: active){.kern-btn--tertiary>.kern-icon{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-btn--tertiary:not(:disabled):hover,.kern-btn--tertiary:not([aria-disabled=true]):hover{background:var(--kern-color-action-state-indicator-tint-hover-opacity)}.kern-btn--tertiary:active{background:var(--kern-color-action-state-indicator-tint-active-opacity)}.kern-btn--tertiary:disabled,.kern-btn--tertiary[disabled],.kern-btn--tertiary[aria-disabled=true]{opacity:var(--action-state-opacity-disabled, .4)}.kern-btn--tertiary .kern-label{text-decoration:underline}.kern-btn--tertiary:hover .kern-label{text-decoration-thickness:var(--kern-3, 3px)}.kern-btn--tertiary:hover:disabled .kern-label,.kern-btn--tertiary:hover[disabled] .kern-label,.kern-btn--tertiary:hover[aria-disabled=true] .kern-label{text-decoration-thickness:var(--kern-metric-border-width-light, 1px)}.kern-btn--tertiary:has(.kern-icon) .kern-label{text-decoration:none}.kern-card{display:flex;padding:var(--kern-metric-space-none, 0px);flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-none, 0px);flex-shrink:0;border-radius:var(--kern-metric-border-radius-default, 4px);border:var(--kern-metric-border-width-light, 1px) solid var(--layout-border, #A5AAC3);background:var(--kern-color-layout-background-default, #FFF);height:100%}.kern-card--hug,.kern-card--hug .kern-card__container{height:auto}.kern-card__media{display:flex;padding:0px var(--kern-metric-space-none, 0px);justify-content:center;align-items:center;align-self:stretch}.kern-card__media *{width:100%;overflow:hidden;border-top-left-radius:var(--kern-metric-border-radius-default, 4px);border-top-right-radius:var(--kern-metric-border-radius-default, 4px)}.kern-card__container{display:flex;padding:var(--kern-metric-space-large, 24px);flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-default, 16px);align-self:stretch;height:100%}.kern-card__header{display:flex;padding:var(--kern-metric-space-none, 0px);flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-none, 0px);align-self:stretch}.kern-card__body{display:flex;padding:var(--kern-metric-space-none, 0px);flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-small, 8px);align-self:stretch;flex:1 1 auto}.kern-card__footer{display:flex;flex-direction:row;flex-wrap:wrap;padding-top:var(--kern-metric-space-default, 16px);align-items:flex-start;gap:var(--kern-metric-space-default, 16px);align-self:stretch}.kern-card__footer .kern-btn{flex:1 1 0;min-width:fit-content}.kern-card--active,.kern-card--interactive{position:relative}.kern-card--active .kern-link--stretched,.kern-card--interactive .kern-link--stretched{color:var(--kern-color-action-default, #1A3DA5);letter-spacing:var(--kern-metric-space-none, 0px);text-decoration-line:underline;text-decoration-style:solid;text-decoration-skip-ink:auto;text-decoration-thickness:var(--kern-1, 1px);text-underline-offset:var(--kern-2, 2px);text-underline-position:from-font}.kern-card--active .kern-link--stretched:after,.kern-card--interactive .kern-link--stretched:after{position:absolute;top:var(--kern-metric-space-none, 0px);right:var(--kern-metric-space-none, 0px);bottom:var(--kern-metric-space-none, 0px);left:var(--kern-metric-space-none, 0px);z-index:1;pointer-events:auto;content:"";background-color:transparent}.kern-card--active .kern-link--stretched:hover,.kern-card--interactive .kern-link--stretched:hover{text-decoration-thickness:3px}.kern-card--active .kern-link--stretched:hover:after,.kern-card--interactive .kern-link--stretched:hover:after{background:var(--kern-color-action-state-indicator-tint-hover-opacity)}.kern-card--active .kern-link--stretched:active:after,.kern-card--interactive .kern-link--stretched:active:after{background:var(--kern-color-action-state-indicator-tint-active-opacity)}.kern-card--active .kern-link--stretched:focus-visible,.kern-card--interactive .kern-link--stretched:focus-visible{outline-color:transparent}.kern-card--active .kern-link--stretched:focus-visible:after,.kern-card--interactive .kern-link--stretched:focus-visible:after{border-radius:var(--kern-metric-border-radius-default, .25rem);box-shadow:var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) 2px var(--kern-color-action-on-default),var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) 4px var(--kern-color-action-focus-border-inside),var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) 6px var(--kern-color-action-focus-border-outside)}@media (forced-colors: active){.kern-card--active .kern-link--stretched:focus-visible:after,.kern-card--interactive .kern-link--stretched:focus-visible:after{outline-offset:4px!important;outline-width:3px!important;outline-color:transparent!important}}.kern-card--small .kern-card__container{padding:var(--kern-metric-space-default, 16px);gap:var(--kern-metric-space-small, 8px)}.kern-card--small .kern-card__container .kern-card__header .kern-preline{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-preline-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-preline-small-padding-bottom, 1px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-card--small .kern-card__container .kern-card__header .kern-title{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-title-small-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-title-small-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-card--small .kern-card__container .kern-card__header .kern-subline{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-subline-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-subline-small-padding-bottom, 9px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-card--small .kern-card__container .kern-card__body .kern-body{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-small-padding-bottom, 1px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-card--large .kern-card__container{padding:var(--kern-metric-space-x-large, 32px);gap:var(--kern-metric-space-large, 24px)}.kern-card--large .kern-card__container .kern-card__header .kern-preline{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-preline-large-padding-top, 1px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-preline-large-padding-bottom, 7px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-large, 21px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-large, 32px)}.kern-card--large .kern-card__container .kern-card__header .kern-title{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-title-large-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-title-large-padding-bottom, 9px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-adaptive-large, 26px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-adaptive-large, 32px)}.kern-card--large .kern-card__container .kern-card__header .kern-subline{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-subline-large-padding-top, 1px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-subline-large-padding-bottom, 7px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-large, 21px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-static-large, 32px)}.kern-card--large .kern-card__container .kern-card__body .kern-body{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-large-padding-top, 1px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-large-padding-bottom, 7px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-large, 21px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-large, 32px)}.kern-form-check{display:grid;grid-template-columns:var(--kern-metric-dimension-large, 32px) auto;align-items:start;padding-right:var(--kern-metric-space-default, 16px)}.kern-form-check__radio,.kern-form-check__checkbox{width:var(--kern-metric-dimension-large, 32px);height:var(--kern-metric-dimension-large, 32px);border:var(--kern-metric-border-width-default, 2px) solid var(--kern-color-form-input-border, #171a2b);background:var(--kern-color-form-input-background, #f7f7f9);margin:var(--kern-metric-space-none, 0px);-webkit-appearance:none;-moz-appearance:none;appearance:none}.kern-form-check__radio:hover,.kern-form-check__checkbox:hover{border:var(--kern-metric-border-width-bold, 4px) solid var(--kern-color-form-input-border, #171a2b)}.kern-form-check__radio:focus,.kern-form-check__radio:focus-visible,.kern-form-check__checkbox:focus,.kern-form-check__checkbox:focus-visible{box-shadow:0 0 0 var(--kern-metric-border-width-bold, 4px) var(--kern-color-form-input-border, #171a2b);outline-offset:var(--kern-metric-border-width-default, 2px);outline:var(--kern-metric-border-width-default, 2px) solid var(--kern-color-form-input-border, #171a2b);border:var(--kern-metric-border-width-none, 0px);forced-color-adjust:none}@media (forced-colors: active){.kern-form-check__radio:focus,.kern-form-check__radio:focus-visible,.kern-form-check__checkbox:focus,.kern-form-check__checkbox:focus-visible{outline-offset:4px!important;outline-width:3px!important;outline-color:transparent!important}}.kern-form-check__radio:focus:hover,.kern-form-check__radio:focus-visible:hover,.kern-form-check__checkbox:focus:hover,.kern-form-check__checkbox:focus-visible:hover{border:var(--kern-metric-border-width-none, 0px)}.kern-form-check__radio:checked:focus,.kern-form-check__radio:checked:focus-visible,.kern-form-check__checkbox:checked:focus,.kern-form-check__checkbox:checked:focus-visible{box-shadow:0 0 0 var(--kern-metric-border-width-bold, 4px) var(--kern-color-form-input-border, #171a2b);outline-offset:var(--kern-metric-border-width-bold, 4px);outline-color:transparent;border:var(--kern-metric-border-width-none, 0px);forced-color-adjust:none}@media (forced-colors: active){.kern-form-check__radio:checked:focus,.kern-form-check__radio:checked:focus-visible,.kern-form-check__checkbox:checked:focus,.kern-form-check__checkbox:checked:focus-visible{outline-offset:4px!important;outline-width:3px!important;outline-color:transparent!important}}.kern-form-check__radio:checked:focus:hover,.kern-form-check__radio:checked:focus-visible:hover,.kern-form-check__checkbox:checked:focus:hover,.kern-form-check__checkbox:checked:focus-visible:hover{border:var(--kern-metric-border-width-none, 0px)}.kern-form-check__radio--error:focus,.kern-form-check__radio--error:focus-visible,.kern-form-check__checkbox--error:focus,.kern-form-check__checkbox--error:focus-visible{box-shadow:0 0 0 var(--kern-metric-border-width-bold, 4px) var(--kern-color-feedback-danger, #bd0f09);outline:var(--kern-metric-border-width-none, 0px)}@media (forced-colors: active){.kern-form-check__radio--error:focus,.kern-form-check__radio--error:focus-visible,.kern-form-check__checkbox--error:focus,.kern-form-check__checkbox--error:focus-visible{box-shadow:0 0 0 var(--kern-metric-border-width-bold, 4px) var(--kern-color-layout-background-inverted)!important;background-color:var(--kern-color-layout-background-default)!important}}.kern-form-check__radio--error:checked:focus,.kern-form-check__radio--error:checked:focus-visible,.kern-form-check__checkbox--error:checked:focus,.kern-form-check__checkbox--error:checked:focus-visible{box-shadow:0 0 0 var(--kern-metric-border-width-bold, 4px) var(--kern-color-feedback-danger, #bd0f09)!important;outline:var(--kern-metric-border-width-none, 0px)}@media (forced-colors: active){.kern-form-check__radio--error:checked:focus,.kern-form-check__radio--error:checked:focus-visible,.kern-form-check__checkbox--error:checked:focus,.kern-form-check__checkbox--error:checked:focus-visible{box-shadow:0 0 0 var(--kern-metric-border-width-bold, 4px) var(--kern-color-layout-background-inverted)!important;background-color:var(--kern-color-layout-background-default)!important}}.kern-form-check__radio[disabled],.kern-form-check__radio[aria-disabled=true],.kern-form-check__checkbox[disabled],.kern-form-check__checkbox[aria-disabled=true]{outline:0;opacity:var(--kern-color-action-state-opacity-disabled, .4)}.kern-form-check__radio[disabled]:checked,.kern-form-check__radio[aria-disabled=true]:checked,.kern-form-check__checkbox[disabled]:checked,.kern-form-check__checkbox[aria-disabled=true]:checked{outline:var(--kern-metric-border-width-none, 0px)}.kern-form-check__radio[disabled]:hover,.kern-form-check__radio[aria-disabled=true]:hover,.kern-form-check__checkbox[disabled]:hover,.kern-form-check__checkbox[aria-disabled=true]:hover{cursor:default}.kern-form-check__radio[disabled]~.kern-label,.kern-form-check__radio[aria-disabled=true]~.kern-label,.kern-form-check__checkbox[disabled]~.kern-label,.kern-form-check__checkbox[aria-disabled=true]~.kern-label{opacity:var(--kern-color-action-state-opacity-disabled, .4);cursor:default}.kern-form-check .kern-label{font-weight:var(--kern-typography-font-weight-regular, 400);padding-top:var(--kern-metric-space-x-small, 4px);padding-left:var(--kern-metric-space-default, 16px)}.kern-form-check .kern-label:has(.kern-label__optional){display:flex;align-items:center;align-content:center;gap:var(--kern-metric-space-none, 0px) var(--kern-metric-space-small, 8px);align-self:stretch;flex-wrap:wrap}.kern-form-check .kern-label__optional{color:var(--kern-color-layout-text-muted, #404565);font-weight:var(--kern-typography-font-weight-regular, 400)}.kern-form-check .kern-error{grid-column:span 2;padding-top:var(--kern-metric-space-small, 8px)}.kern-form-check .kern-error .kern-icon{width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-default, 24px);min-width:var(--kern-metric-dimension-default, 24px);min-height:var(--kern-metric-dimension-default, 24px)}.kern-form-check--error{border-left:var(--kern-metric-border-width-bold, 4px) solid var(--kern-color-feedback-danger, #bd0f09);padding-left:var(--kern-metric-space-default, 16px)}.kern-form-check--error .kern-form-check__checkbox--error{border-color:var(--kern-color-feedback-danger, #bd0f09)!important;outline-color:var(--kern-color-feedback-danger, #bd0f09)!important;background:var(--kern-color-feedback-danger-background, #feece8)}.kern-form-check--error .kern-form-check__radio:before{background-color:var(--kern-color-feedback-danger, #bd0f09)}.kern-form-check__checkbox{border-radius:var(--kern-metric-border-radius-small, 2px)}.kern-form-check__checkbox:before{content:""}.kern-form-check__checkbox:focus:before,.kern-form-check__checkbox:focus-visible:before{margin:var(--kern-6, 6px)}.kern-form-check__checkbox:checked:before{display:block;position:relative;left:var(--kern-3, 3px);top:var(--kern-8, 8px);transform:rotate(47deg) translate(-50%,-50%);background-color:transparent;border-width:var(--kern-metric-space-none, 0px) var(--kern-metric-border-width-default, 2px) var(--kern-metric-border-width-default, 2px) var(--kern-metric-space-none, 0px);border-color:var(--kern-color-form-input-border, #171A2B);border-style:solid;height:var(--kern-metric-dimension-x-small, 16px);width:var(--kern-metric-dimension-2x-small, 8px);margin:4px}.kern-form-check__checkbox:checked:hover:before{margin:var(--kern-metric-space-2x-small, 2px)}.kern-form-check__checkbox:checked:focus:before,.kern-form-check__checkbox:checked:focus-visible:before{margin:var(--kern-6, 6px)}.kern-form-check__checkbox--error{border-color:var(--kern-color-feedback-danger, #BD0F09)!important;outline-color:var(--kern-color-feedback-danger, #BD0F09)!important;background:var(--kern-color-feedback-danger-background, #FEECE8)}.kern-form-check__checkbox--error:checked:before{border-color:var(--kern-color-feedback-danger, #BD0F09)}@media (forced-colors: active){.kern-form-check__checkbox--error:checked:before{border-color:var(--kern-color-layout-background-inverted)!important}}.kern-form-check__checkbox--error:checked:focus,.kern-form-check__checkbox--error:checked:focus-visible{box-shadow:0 0 0 var(--kern-metric-border-width-bold, 4px) var(--kern-color-feedback-danger, #BD0F09);outline:var(--kern-metric-border-width-none, 0px);border:var(--kern-metric-border-width-none, 0px)}.kern-form-check__checkbox--error:focus,.kern-form-check__checkbox--error:focus-visible{box-shadow:0 0 0 var(--kern-metric-border-width-bold, 4px) var(--kern-color-feedback-danger, #BD0F09);outline:var(--kern-metric-border-width-none, 0px);border:var(--kern-metric-border-width-none, 0px)}.kern-dialog{max-width:var(--kern-small, 768px);border-radius:var(--kern-metric-border-radius-large, 8px);border:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-layout-border, #A5AAC3);background:var(--kern-color-layout-background-default, #FFF);padding:var(--kern-metric-space-none, 0px)}.kern-dialog__header{display:flex;justify-content:space-between;min-height:var(--kern-metric-dimension-3x-large, 64px);padding:var(--kern-metric-space-small, 8px) var(--kern-metric-space-small, 8px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-x-large, 32px);align-items:flex-start;gap:var(--kern-metric-space-default, 16px)}.kern-dialog .kern-title{display:flex;align-items:flex-start;gap:var(--kern-metric-space-none, 0px);flex:1 0 0}.kern-dialog__body{display:flex;padding:var(--kern-metric-space-small, 8px) var(--kern-metric-space-x-large, 32px) var(--kern-metric-space-large, 24px) var(--kern-metric-space-x-large, 32px);flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-default, 16px)}.kern-dialog__footer{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-end;align-items:flex-start;gap:var(--kern-metric-space-default, 16px);padding:var(--kern-metric-space-large, 24px) var(--kern-metric-space-x-large, 32px) var(--kern-metric-space-x-large, 32px) var(--kern-metric-space-x-large, 32px);border-top:1px solid var(--kern-color-layout-border, #A5AAC3)}@media (max-width: 576px){.kern-dialog__footer{flex-direction:column}}.kern-dialog__footer .kern-btn{flex-grow:1;align-self:stretch}.kern-dialog__footer .kern-btn+.kern-btn{margin-left:var(--kern-metric-space-none, 0px)}.kern-dialog::backdrop{background:var(--kern-color-layout-background-overlay)}@media (max-width: 768px){.kern-dialog{overflow-y:auto;min-width:100%;max-width:100%;margin-bottom:var(--kern-metric-space-none, 0px);border-radius:var(--border-radius-large, 8px) var(--kern-metric-border-radius-large, 8px) var(--kern-metric-border-radius-none, 0px) var(--kern-metric-border-radius-none, 0px)}}.kern-description-list{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;display:flex;flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-small, 8px)}.kern-description-list p{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline}.kern-description-list--col .kern-description-list-item{gap:var(--kern-metric-border-width-none, 0px)}.kern-description-list--col .kern-description-list-item__key,.kern-description-list--col .kern-description-list-item__value{width:100%;max-width:100%}.kern-description-list-item{display:flex;padding:var(--kern-metric-space-none, 0px);align-items:flex-start;align-content:flex-start;gap:var(--kern-metric-space-none, 0px);align-self:stretch;flex-wrap:wrap;flex-direction:column;word-break:break-word}@media (min-width: 768px){.kern-description-list-item{flex-direction:row;gap:var(--kern-metric-space-x-large, 32px)}}.kern-description-list-item__key{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);font-weight:var(--kern-typography-font-weight-semi-bold, 600)}@media (min-width: 768px){.kern-description-list-item__key{width:30%;max-width:var(--kern-component-description-list-term-max-width, 352px)}}.kern-description-list-item__value{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-description-list-item__value ul{list-style:none;padding-left:var(--kern-metric-border-width-none, 0px)}@media (min-width: 768px){.kern-description-list-item__value{width:calc(70% - var(--kern-metric-space-x-large, 32px))}}.kern-divider{border:var(--kern-metric-border-radius-none, 0px);margin:var(--kern-metric-space-none, 0px);height:var(--kern-metric-border-width-light, 1px);background-color:var(--kern-color-layout-border, #A5AAC3)}@media (forced-colors: active){.kern-divider{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-dropdown{position:relative}.kern-dropdown[open] .kern-dropdown__header:before{content:"";width:100vw;height:100vh;position:fixed;top:var(--kern-metric-space-none, 0px);left:var(--kern-metric-space-none, 0px);cursor:auto}.kern-dropdown__header{cursor:pointer;list-style-type:none;display:inline-flex;min-height:var(--kern-metric-dimension-x-large, 48px);justify-content:center;align-items:center;vertical-align:top;gap:var(--kern-metric-space-none, 0px);border:none;border-radius:var(--kern-metric-border-radius-default, 4px);color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);padding:var(--kern-metric-space-none, 0px) var(--kern-metric-space-default, 16px);color:var(--kern-color-action-default, #1A3DA5)}.kern-dropdown__header:after{content:"";width:var(--kern-metric-dimension-default, 24px);min-width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-default, 24px);-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z'/%3E%3C/svg%3E");-webkit-mask-size:cover;mask-size:cover;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;background-color:var(--kern-color-action-default, #1A3DA5)}@media (forced-colors: active){.kern-dropdown__header:after{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-dropdown__header:hover{background:var(--kern-color-action-state-indicator-tint-hover-opacity);cursor:pointer}.kern-dropdown__header .kern-label{color:var(--kern-color-action-default, #1A3DA5);padding:var(--kern-metric-space-small, 8px)}.kern-dropdown__body{display:flex;z-index:99;position:absolute;left:0;flex-direction:column;border:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-action-default, #1A3DA5);margin:2px;white-space:nowrap;background:var(--kern-color-layout-background-default);border-radius:var(--kern-metric-border-radius-default)}.kern-dropdown__body .kern-list{padding:0}.kern-dropdown__body .kern-list li{margin-bottom:var(--kern-metric-space-none, 0px);padding:.25rem 1rem .25rem 0;list-style:none;position:relative}.kern-dropdown__body .kern-list li:hover{background:var(--kern-color-action-state-indicator-tint-hover-opacity);cursor:pointer}.kern-dropdown__body .kern-list li .kern-link{text-decoration:none}.kern-dropdown__body .kern-list li:has(input:checked):before{content:"";-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m382-354 339-339q12-12 28-12t28 12q12 12 12 28.5T777-636L410-268q-12 12-28 12t-28-12L182-440q-12-12-11.5-28.5T183-497q12-12 28.5-12t28.5 12l142 143Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='m382-354 339-339q12-12 28-12t28 12q12 12 12 28.5T777-636L410-268q-12 12-28 12t-28-12L182-440q-12-12-11.5-28.5T183-497q12-12 28.5-12t28.5 12l142 143Z'/%3E%3C/svg%3E");background-color:var(--kern-color-action-default, #1A3DA5);position:absolute;top:8px;left:8px;width:24px;height:24px}@media (forced-colors: active){.kern-dropdown__body .kern-list li:has(input:checked):before{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-dropdown__body .kern-list li label{width:100%;display:block;padding-left:2.5rem;color:var(--kern-color-action-default, #1A3DA5)}.kern-dropdown__body .kern-list li label input{all:unset}.kern-fieldset{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;display:flex;flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-none, 0px)}.kern-fieldset--error{border-left:var(--kern-metric-border-width-bold, 4px) solid var(--kern-color-feedback-danger, #BD0F09);padding-left:var(--kern-metric-space-default, 16px)}.kern-fieldset legend{float:left}.kern-fieldset legend.kern-label{margin-bottom:var(--kern-metric-space-small, 8px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px)}.kern-fieldset:has(.kern-hint) legend.kern-label{margin-bottom:var(--kern-metric-space-none, 0px)}.kern-fieldset .kern-label:has(.kern-label__optional){display:flex;align-items:center;align-content:center;gap:var(--kern-metric-space-none, 0px) var(--kern-metric-space-small, 8px);align-self:stretch;flex-wrap:wrap}.kern-fieldset .kern-label__optional{color:var(--kern-color-layout-text-muted, #404565);font-weight:var(--kern-typography-font-weight-regular, 400)}.kern-fieldset .kern-hint{margin-bottom:var(--kern-metric-space-small, 8px)}.kern-fieldset__body{width:100%;display:flex;flex-direction:column;gap:var(--kern-metric-space-default, 16px)}.kern-fieldset__body--horizontal{flex-direction:row;flex-wrap:wrap}.kern-fieldset .kern-error{margin-top:var(--kern-metric-space-small, 8px)}.kern-fieldset .kern-error .kern-icon{width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-default, 24px);min-width:var(--kern-metric-dimension-default, 24px);min-height:var(--kern-metric-dimension-default, 24px)}.kern-form-input{display:flex;padding:var(--kern-metric-space-none, 0px);flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-none, 0px);align-self:stretch}.kern-form-input:has(input[disabled],textarea[disabled],input[aria-disabled=true],textarea[aria-disabled=true]){cursor:not-allowed}.kern-form-input:has(input[disabled],textarea[disabled],input[aria-disabled=true],textarea[aria-disabled=true]) .kern-label{cursor:not-allowed}.kern-form-input .kern-label{margin-bottom:var(--kern-metric-space-small, 8px)}.kern-form-input .kern-label:has(.kern-label__optional){display:flex;align-items:center;align-content:center;gap:var(--kern-metric-space-none, 0px) var(--kern-metric-space-small, 8px);align-self:stretch;flex-wrap:wrap}.kern-form-input .kern-label__optional{color:var(--kern-color-layout-text-muted, #404565);font-weight:var(--kern-typography-font-weight-regular, 400)}.kern-form-input:has(.kern-hint) .kern-label{margin-bottom:var(--kern-metric-space-none, 0px)}.kern-form-input .kern-hint{margin-bottom:var(--kern-metric-space-small, 8px)}.kern-form-input__input{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);padding:var(--kern-metric-space-none, 0px) var(--kern-metric-space-default, 16px);height:var(--kern-metric-dimension-x-large, 48px);align-items:center;align-self:stretch;border-radius:var(--kern-metric-border-radius-small, 2px);border:none;border-bottom:var(--kern-metric-border-width-default, 2px) solid var(--kern-color-form-input-border, #171A2B);background:var(--kern-color-form-input-background, #F7F7F9);-webkit-box-orient:vertical;-webkit-line-clamp:1;line-clamp:1;text-overflow:ellipsis}@media (forced-colors: active){.kern-form-input__input{border:1px solid transparent!important}}.kern-form-input__input:hover{border-width:var(--kern-metric-border-width-bold, 4px);padding-top:calc(var(--kern-metric-border-width-bold, 4px) - var(--kern-metric-border-width-default, 2px))}.kern-form-input__input:focus{border-radius:var(--kern-metric-border-radius-small, 2px);outline:var(--kern-metric-border-width-bold, 4px) solid var(--kern-color-form-input-border, #171A2B);background:var(--kern-color-form-input-background, #F7F7F9);border:none;padding-bottom:calc(var(--kern-metric-border-width-bold, 4px) - var(--kern-metric-border-width-default, 2px))}.kern-form-input__input:focus:hover{padding-top:var(--kern-metric-space-none, 0px)}.kern-form-input__input[readonly],.kern-form-input__input[readonly=readonly]{border-radius:var(--kern-metric-border-radius-none, 0px);border-bottom:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-layout-border, #A5AAC3);background:inherit;cursor:not-allowed}@media (forced-colors: active){.kern-form-input__input[readonly],.kern-form-input__input[readonly=readonly]{border:1px solid transparent!important}}.kern-form-input__input[readonly]:hover,.kern-form-input__input[readonly=readonly]:hover{padding-top:var(--kern-metric-space-none, 0px)}.kern-form-input__input[readonly]:focus,.kern-form-input__input[readonly=readonly]:focus{border-radius:var(--kern-metric-border-radius-small, 2px);padding-top:var(--kern-metric-border-width-light, 1px);border-width:var(--kern-metric-border-width-none, 0)}.kern-form-input__input[disabled],.kern-form-input__input[disabled=disabled],.kern-form-input__input[aria-disabled=true]{opacity:var(--kern-color-action-state-opacity-disabled, .4);cursor:not-allowed}.kern-form-input__input[disabled]:hover,.kern-form-input__input[disabled=disabled]:hover,.kern-form-input__input[aria-disabled=true]:hover{border-width:var(--kern-metric-border-width-default, 2px);padding-top:var(--kern-metric-space-none, 0px)}.kern-form-input__input--error{border-bottom:var(--kern-metric-border-width-default, 2px) solid var(--kern-color-feedback-danger, #BD0F09);background:var(--kern-color-feedback-danger-background, #FEECE8)}@media (forced-colors: active){.kern-form-input__input--error{border:1px solid transparent!important}}.kern-form-input__input--error:focus{outline-color:var(--kern-color-feedback-danger, #BD0F09);background:var(--kern-color-feedback-danger-background, #FEECE8);border:none}.kern-form-input__input--width-2{max-width:var(--kern-metric-dimension-2x-large)}.kern-form-input__input--width-4{max-width:var(--kern-metric-dimension-4x-large)}.kern-form-input input[type=file].kern-form-input__input{order:4;display:flex;padding:var(--kern-metric-space-large, 24px);gap:16px var(--kern-metric-space-default, 16px);align-items:flex-start;align-self:stretch;border-radius:var(--kern-metric-border-radius-small, 2px);outline:var(--kern-metric-border-width-default, 2px) dashed var(--kern-color-form-input-border, #171A2B);border:none;height:inherit}.kern-form-input input[type=file].kern-form-input__input:hover{outline:none;box-shadow:inset var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-border-width-bold, 4px) var(--kern-color-form-input-border, #171A2B);cursor:pointer}@media (forced-colors: active){.kern-form-input input[type=file].kern-form-input__input:hover{outline:var(--kern-metric-border-width-bold, 4px) solid var(--kern-color-layout-background-inverted);outline-offset:-4px}}.kern-form-input input[type=file].kern-form-input__input:focus{outline:var(--kern-metric-border-width-bold, 4px) solid var(--kern-color-form-input-border, #171A2B)}.kern-form-input input[type=file].kern-form-input__input:focus:hover{box-shadow:none}.kern-form-input input[type=file].kern-form-input__input[disabled],.kern-form-input input[type=file].kern-form-input__input[disabled=disabled],.kern-form-input input[type=file].kern-form-input__input[aria-disabled=true]{outline:var(--kern-metric-border-width-default, 2px) dashed var(--kern-color-form-input-border, #171A2B);box-shadow:none;cursor:not-allowed}.kern-form-input input[type=file].kern-form-input__input::file-selector-button{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);margin-right:var(--kern-metric-space-default, 16px);min-height:var(--kern-metric-dimension-x-large, 48px);padding:var(--kern-metric-space-none, 0px) var(--kern-metric-space-default, 16px);border:none;border-radius:var(--kern-metric-border-radius-default, 4px);border:var(--kern-metric-border-width-light, 1px) solid var(--kern-color-action-default, #1A3DA5);color:var(--kern-color-action-default, #1A3DA5);background:#1a3da500}.kern-form-input .kern-error{order:5;margin-top:var(--kern-metric-space-small, 8px)}.kern-form-input .kern-error .kern-icon{width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-default, 24px);min-width:var(--kern-metric-dimension-default, 24px);min-height:var(--kern-metric-dimension-default, 24px)}.kern-form-input--error{border-left:var(--kern-metric-border-width-bold, 4px) solid var(--kern-color-feedback-danger, #BD0F09);padding-left:var(--kern-metric-space-default, 16px)}.kern-form-input--error input[type=file].kern-form-input__input,.kern-form-input--error .kern-form-input__input[type=file]{outline-color:var(--kern-color-feedback-danger, #BD0F09)}.kern-form-input--error input[type=file].kern-form-input__input:hover,.kern-form-input--error .kern-form-input__input[type=file]:hover{background:var(--kern-color-feedback-danger-background, #FEECE8);box-shadow:inset var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-border-width-bold, 4px) var(--kern-color-feedback-danger, #BD0F09)}.kern-form-input--error input[type=file].kern-form-input__input:focus,.kern-form-input--error .kern-form-input__input[type=file]:focus{outline-color:var(--kern-color-feedback-danger, #BD0F09)}textarea{padding:var(--kern-metric-space-small, 8px) var(--kern-metric-space-default, 16px)!important;min-height:var(--kern-metric-dimension-5x-large, 96px)}textarea.kern-form-input__input:hover{padding-top:var(--kern-metric-space-none, 0px)}input[type=checkbox],input[type=color],input[type=file],input[type=radio],input[type=range],input[type=file]::-webkit-file-upload-button,label,option,select{cursor:pointer}.kern-kopfzeile{background:var(--kern-color-layout-background-hued, #F7F7F9);padding:var(--kern-component-kopfzeile-padding, 5px) var(--kern-metric-space-none, 0px)}@media (forced-colors: active){.kern-kopfzeile{border-bottom:1px solid transparent}}.kern-kopfzeile__content{display:flex;padding:var(--kern-1, 1px) var(--kern-metric-space-none, 0px);align-items:center;gap:var(--kern-metric-space-small, 8px)}.kern-kopfzeile__flagge{display:flex;width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-small, 20px);padding:var(--kern-metric-space-2x-small, 2px) var(--kern-metric-space-none, 0px)}.kern-kopfzeile__flagge svg{vertical-align:baseline;outline:var(--kern-1, 1px) solid #FFFFFF}.kern-kopfzeile__label{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-component-kopfzeile-font-family, "Fira Sans");font-style:normal;font-weight:400;font-size:var(--kern-component-kopfzeile-font-size, 16px);line-height:var(--kern-component-kopfzeile-line-height, 20px)}@media only screen and (max-width: 768px){.kern-kopfzeile__flagge{width:var(--kern-18, 18px);height:var(--kern-16, 16px)}.kern-kopfzeile__label{font-size:var(--kern-14, 14px);line-height:var(--kern-16, 16px)}.kern-kopfzeile .kern-container,.kern-kopfzeile .kern-container-fluid{padding-left:var(--kern-metric-space-small, 8px);padding-right:var(--kern-metric-space-small, 8px)}}.kern-loader{display:none;box-sizing:border-box;border-width:10px;border-style:solid;border-color:var(--kern-color-feedback-loader-background) var(--kern-color-feedback-loader-background) var(--kern-color-feedback-loader-background) var(--kern-color-feedback-loader);width:var(--kern-metric-dimension-5x-large, 96px);height:var(--kern-metric-dimension-5x-large, 96px);border-radius:50%;animation:rotation 1.5s linear infinite;position:relative}@media (forced-colors: active){.kern-loader{border-color:var(--kern-color-layout-background-default) var(--kern-color-layout-background-default) var(--kern-color-layout-background-default) var(--kern-color-layout-background-inverted);forced-color-adjust:none;outline-color:transparent;box-shadow:0 0 0 1px var(--kern-color-layout-background-inverted),inset 0 0 0 1px var(--kern-color-layout-background-inverted)}}.kern-loader:before,.kern-loader:after{content:"";height:var(--semantic-size-xs, 10px);background:var(--kern-color-feedback-loader);position:absolute}.kern-loader:before{width:var(--kern-metric-border-radius-small, 2px);border-radius:var(--kern-metric-space-none, 0px) var(--kern-metric-border-radius-small, 2px) var(--kern-metric-border-radius-small, 2px) var(--kern-metric-space-none, 0px);left:var(--kern-7, 7px);top:var(--kern-metric-space-2x-small, 2px);transform:rotate(-45deg)}.kern-loader:after{width:var(--kern-metric-border-radius-small, 2px);border-radius:var(--kern-metric-space-none, 0px) var(--kern-metric-border-radius-small, 2px) var(--kern-metric-border-radius-small, 2px) var(--kern-metric-space-none, 0px);left:var(--kern-7, 7px);bottom:var(--kern-metric-space-2x-small, 2px);transform:rotate(45deg)}.kern-loader--visible{display:block}@keyframes rotation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.kern-progress{display:flex;flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-small, 8px)}.kern-progress progress[value]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;width:100%;height:var(--kern-metric-dimension-2x-small, 8px);border-radius:var(--kern-metric-border-radius-small, 2px);background:var(--kern-color-feedback-loader-background, #DFE1EA);color:var(--kern-color-feedback-loader)}.kern-progress progress[value]::-webkit-progress-bar{background:var(--kern-color-feedback-loader-background, #DFE1EA);border-radius:var(--kern-metric-border-radius-small, 2px)}.kern-progress progress[value]::-webkit-progress-value{background-color:var(--kern-color-feedback-loader);border-radius:var(--kern-metric-border-radius-small, 2px)}.kern-progress progress[value]::-moz-progress-bar{background-color:var(--kern-color-feedback-loader);border-radius:var(--kern-metric-border-radius-small, 2px)}@media (forced-colors: active){.kern-progress progress[value]{background-color:var(--kern-color-layout-background-default);border:1px solid var(--kern-color-layout-background-inverted);color:var(--kern-color-layout-background-inverted);forced-color-adjust:none}.kern-progress progress[value]::-webkit-progress-bar{background-color:var(--kern-color-layout-background-default)}.kern-progress progress[value]::-webkit-progress-value{background-color:var(--kern-color-layout-background-inverted)}.kern-progress progress[value]::-moz-progress-bar{background-color:var(--kern-color-layout-background-inverted)}}.kern-form-check__radio{display:flex;border-radius:100%}.kern-form-check__radio:before{border-radius:100%;content:"";margin:auto}.kern-form-check__radio:checked:before{background-color:var(--kern-color-form-input-border, #171A2B);height:var(--kern-12, 12px);width:var(--kern-12, 12px)}.kern-form-check__radio--error{border-color:var(--kern-color-feedback-danger, #BD0F09)!important;outline-color:var(--kern-color-feedback-danger, #BD0F09)!important;background:var(--kern-color-feedback-danger-background, #FEECE8)}.kern-form-check__radio--error.kern-form-check__radio:checked:before{background-color:var(--kern-color-feedback-danger, #BD0F09)}@media (forced-colors: active){.kern-form-check__radio--error.kern-form-check__radio:checked:before{background-color:var(--kern-color-layout-background-inverted)!important}}.kern-form-input:has(select[disabled]),.kern-form-input:has(select[aria-disabled=true]){cursor:not-allowed}.kern-form-input:has(select[disabled]) .kern-label,.kern-form-input:has(select[aria-disabled=true]) .kern-label{cursor:not-allowed}.kern-form-input__select-wrapper:has(.kern-form-input__select--error){border-color:var(--kern-color-feedback-danger, #bd0f09);background:var(--kern-color-feedback-danger-background, #feece8)}.kern-form-input__select-wrapper:has(.kern-form-input__select--error):after{background-color:var(--kern-color-feedback-danger, #bd0f09)}.kern-form-input__select-wrapper:has(.kern-form-input__select--error):hover{border-color:var(--kern-color-feedback-danger, #bd0f09)}.kern-form-input__select-wrapper{position:relative;display:flex;height:var(--kern-metric-dimension-x-large, 48px);gap:var(--kern-metric-space-none, 0px);align-self:stretch;border-radius:var(--kern-metric-border-radius-small, 2px);border-bottom:var(--kern-metric-border-width-default, 2px) solid var(--kern-color-form-input-border, #171a2b);background:var(--kern-color-form-input-background, #f7f7f9)}@media (forced-colors: active){.kern-form-input__select-wrapper{border:1px solid transparent!important}}.kern-form-input__select-wrapper:has(select[disabled]),.kern-form-input__select-wrapper:has(select[aria-disabled=true]){opacity:var(--kern-color-action-state-opacity-disabled, .4)}.kern-form-input__select-wrapper:hover{border-bottom:var(--kern-metric-border-width-bold, 4px) solid var(--kern-color-form-input-border, #171a2b)}.kern-form-input__select-wrapper:hover .kern-form-input__select{padding:var(--kern-metric-space-small, 8px) var(--kern-40, 40px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-default, 16px)}@media (forced-colors: active){.kern-form-input__select-wrapper:hover .kern-form-input__select{padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-40, 40px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-default, 16px)}}.kern-form-input__select-wrapper:hover:has(.kern-form-input__select:focus){border-bottom:var(--kern-metric-border-width-default, 2px) solid var(--kern-color-form-input-border, #171a2b)}.kern-form-input__select-wrapper:hover:has(.kern-form-input__select:focus) .kern-form-input__select{padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-40, 40px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-default, 16px)}.kern-form-input__select-wrapper:hover:has(select[disabled]),.kern-form-input__select-wrapper:hover:has(select[aria-disabled=true]){border-bottom:var(--kern-metric-border-width-default, 2px) solid var(--kern-color-form-input-border, #171a2b)}.kern-form-input__select-wrapper:hover:has(select[disabled]) .kern-form-input__select,.kern-form-input__select-wrapper:hover:has(select[aria-disabled=true]) .kern-form-input__select{padding:var(--kern-metric-space-small, 6px) var(--kern-metric-space-default, 16px) var(--kern-4, 4px) var(--kern-metric-space-default, 16px)}.kern-form-input__select-wrapper:after{content:" ";display:inline-block;position:absolute;right:var(--kern-metric-dimension-x-small, 16px);top:var(--kern-metric-dimension-default, 24px);transform:translateY(-50%);pointer-events:none;width:var(--kern-metric-dimension-default, 24px);height:var(--kern-metric-dimension-default, 24px);-webkit-mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z'/%3E%3C/svg%3E");mask:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='' viewBox='0 -960 960 960' width='' fill='%23000000'%3E%3Cpath d='M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z'/%3E%3C/svg%3E");background-color:var(--kern-color-action-default)}@media (forced-colors: active){.kern-form-input__select-wrapper:after{background-color:var(--kern-color-layout-background-inverted)!important;forced-color-adjust:none}}.kern-form-input__select{background-color:transparent;box-sizing:border-box;width:100%;border:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;text-overflow:ellipsis;overflow:hidden;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-40, 40px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-default, 16px)}.kern-form-input__select:focus{border-radius:var(--kern-metric-border-radius-small, 2px);outline:var(--kern-metric-border-width-bold, 4px) solid var(--kern-color-form-input-border, #171a2b);background:var(--kern-color-form-input-background, #f7f7f9);border:none}.kern-form-input__select--error:focus{outline-color:var(--kern-color-feedback-danger, #bd0f09);background:var(--kern-color-feedback-danger-background, #feece8)}.kern-form-input__select option{margin:40px;background:var(--kern-color-form-input-background, #f7f7f9)}.kern-form-input__select[disabled],.kern-form-input__select[disabled=disabled],.kern-form-input__select[aria-disabled=true]{opacity:.7;cursor:not-allowed}.kern-summary-group__header{display:flex;flex-direction:column;align-items:flex-start;align-self:stretch;padding:var(--kern-metric-baseline-heading-medium-padding-top, 8px) var(--kern-metric-space-none, 0px) calc(var(--kern-metric-baseline-heading-medium-padding-bottom, 8px) + var(--kern-metric-space-default, 16px)) var(--kern-metric-space-none, 0px);margin-top:var(--kern-metric-space-x-large, 32px)}.kern-summary-group__header:first-of-type{margin-top:var(--kern-metric-space-none, 0px)}.kern-summary__header{display:flex;padding:var(--kern-metric-space-default, 16px) var(--skern-pace-none, 0px);align-items:flex-start;gap:var(--kern-metric-space-small, 8px) var(--kern-metric-space-default, 16px);align-self:stretch}.kern-summary__header .kern-number{margin-top:var(--kern-metric-space-x-small, 4px)}.kern-summary .kern-title{font-weight:var(--kern-typography-font-weight-regular, 400)}.kern-summary__body{display:flex;padding:var(--kern-metric-space-default, 16px);flex-direction:column;gap:var(--kern-metric-space-x-large, 32px);border-radius:var(--kern-metric-border-radius-default, 4px);background:var(--kern-color-layout-background-hued, #f7f7f9)}@media (forced-colors: active){.kern-summary__body{border:1px solid transparent!important}}.kern-table{width:100%;border-spacing:var(--kern-metric-space-none, 0px);border-collapse:collapse}.kern-table--small .kern-title{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-heading-small-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-heading-small-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-table--small .kern-table__header,.kern-table--small .kern-table__cell{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-small-padding-bottom, 1px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);padding:calc(var(--kern-metric-baseline-body-small-padding-top, 7px) + var(--kern-metric-space-small, 8px)) calc(var(--kern-metric-space-none, 0px) + var(--kern-metric-space-x-small, 4px)) calc(var(--kern-metric-baseline-body-small-padding-bottom, 1px) + var(--kern-metric-space-small, 8px)) calc(var(--kern-metric-space-none, 0px) + var(--kern-metric-space-x-small, 4px))}.kern-table--small .kern-table__header{font-weight:var(--kern-typography-font-weight-semi-bold, 600)}.kern-table--striped .kern-table__body .kern-table__row:nth-child(odd) .kern-table__header,.kern-table--striped .kern-table__body .kern-table__row:nth-child(odd) .kern-table__cell{background-color:var(--kern-color-layout-background-hued, #F7F7F9)}.kern-table .kern-title{display:table-caption;text-align:left}.kern-table__header,.kern-table__cell{text-align:left;vertical-align:top;box-shadow:inset 0 -1px 0 0 var(--kern-color-layout-border, #A5AAC3);color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);padding:calc(var(--kern-metric-baseline-body-default-padding-top, 6px) + var(--kern-metric-space-small, 8px)) calc(var(--kern-metric-space-none, 0px) + var(--kern-metric-space-x-small, 4px)) calc(var(--kern-metric-baseline-body-default-padding-bottom, 2px) + var(--kern-metric-space-small, 8px)) calc(var(--kern-metric-space-none, 0px) + var(--kern-metric-space-x-small, 4px))}.kern-table__header--numeric,.kern-table__cell--numeric{text-align:right}@media (forced-colors: active){.kern-table__header,.kern-table__cell{border-bottom:1px solid transparent}}.kern-table__header{font-weight:var(--kern-typography-font-weight-semi-bold, 600)}.kern-table__footer{box-shadow:inset 0 1px 0 0 var(--kern-color-layout-border, #A5AAC3)}.kern-table__footer .kern-table__cell{font-weight:var(--kern-typography-font-weight-semi-bold, 600)}.kern-table-responsive{overflow-x:auto;-webkit-overflow-scrolling:touch}.kern-task-list{display:block}.kern-task-list-group{display:flex;flex-direction:column;gap:var(--kern-metric-space-x-large, 32px)}.kern-task-list__header{display:flex;padding-bottom:var(--kern-metric-space-default, 16px);flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-default, 16px);align-self:stretch;margin-top:var(--kern-metric-space-x-large, 32px)}.kern-task-list__header:first-of-type{margin-top:var(--kern-metric-space-none, 0px)}.kern-task-list__header .kern-heading{display:flex;align-items:flex-start;gap:var(--kern-metric-space-none, 0px);align-self:stretch;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-heading-medium-padding-top, 5px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-heading-medium-padding-bottom, 3px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-adaptive-medium, 21px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-adaptive-medium, 24px)}.kern-task-list__list{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;display:flex;flex-direction:column;gap:var(--kern-metric-space-small, 8px);align-self:stretch;list-style:none}.kern-task-list__item{display:flex;padding:var(--kern-metric-space-small, 8px) var(--kern-metric-space-default, 16px);align-items:flex-start;gap:var(--kern-metric-space-default, 16px);flex:1 0 0;justify-content:space-between;position:relative;border-radius:var(--kern-metric-border-radius-default, 4px);background:var(--kern-color-layout-background-hued, #F7F7F9)}@media (forced-colors: active){.kern-task-list__item{border:1px solid transparent!important}}.kern-task-list__item .kern-number{margin-top:var(--kern-12, 12px)}.kern-task-list__item:has(.kern-link){color:var(--kern-color-action-default, #1A3DA5)}.kern-task-list__item:has(.kern-link) .kern-number{color:var(--kern-color-action-default, #1A3DA5);border-color:var(--kern-color-action-default, #1A3DA5)}.kern-task-list__item .kern-link--stretched:after{position:absolute;top:var(--kern-metric-space-none, 0px);right:var(--kern-metric-space-none, 0px);bottom:var(--kern-metric-space-none, 0px);left:var(--kern-metric-space-none, 0px);z-index:1;pointer-events:auto;content:"";background-color:transparent}.kern-task-list__item .kern-link--stretched:focus-visible{outline-color:transparent}.kern-task-list__item .kern-link--stretched:focus-visible:after{border-radius:var(--kern-metric-border-radius-default, .25rem);box-shadow:var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) 2px var(--kern-color-action-on-default),var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) 4px var(--kern-color-action-focus-border-inside),var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) 6px var(--kern-color-action-focus-border-outside)}.kern-task-list__item:has(.kern-link--stretched:hover){background:var(--kern-color-action-state-indicator-tint-hover-opacity)}.kern-task-list__item:has(.kern-link--stretched:active){background:var(--kern-color-action-state-indicator-tint-active-opacity)}.kern-task-list__title{display:flex;padding:var(--kern-metric-space-small, 8px) var(--kern-metric-space-none, 0px);align-items:flex-start;gap:var(--kern-metric-space-default, 16px);flex-grow:1;flex-wrap:wrap}@media all and (min-width: 768px){.kern-task-list__title{flex-wrap:nowrap}}.kern-task-list__title .kern-link:visited{color:var(--kern-color-action-default, #1A3DA5)}.kern-task-list__title .kern-link,.kern-task-list__title .kern-body{flex-grow:1}.kern-task-list__status{text-align:right;white-space:nowrap}.kern-body{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-body--large{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-large-padding-top, 1px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-large-padding-bottom, 7px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-large, 21px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-large, 32px)}.kern-body--small{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-small-padding-bottom, 1px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-body--bold{font-weight:var(--kern-typography-font-weight-semi-bold, 600)}.kern-body--muted{color:var(--kern-color-layout-text-muted, #404565)}.kern-hint{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);color:var(--kern-color-layout-text-muted, #404565)}.kern-heading-display{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-heading-display-padding-top, 12px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-heading-display-padding-bottom, 12px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-adaptive-2x-large, 48px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-adaptive-2x-large, 56px)}.kern-heading-x-large{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-heading-x-large-padding-top, 9px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-heading-x-large-padding-bottom, 7px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-adaptive-x-large, 32px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-adaptive-x-large, 40px)}.kern-heading-large{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-heading-large-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-heading-large-padding-bottom, 9px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-adaptive-large, 26px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-adaptive-large, 32px)}.kern-heading-medium{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-heading-medium-padding-top, 5px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-heading-medium-padding-bottom, 3px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-adaptive-medium, 21px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-adaptive-medium, 24px)}.kern-heading-small{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-heading-small-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-heading-small-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-label{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-label-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-label-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-static-medium, 24px);width:fit-content}.kern-label--large{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-label-large-padding-top, 1px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-label-large-padding-bottom, 7px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-large, 21px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-static-large, 32px)}.kern-label--small{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-label-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-label-small-padding-bottom, 1px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-link{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);color:var(--kern-color-action-default, #1A3DA5);text-decoration-line:underline;text-decoration-style:solid;text-decoration-skip-ink:auto;text-decoration-thickness:var(--kern-1, 1px);text-underline-offset:var(--kern-metric-space-2x-small, 2px);text-underline-position:from-font;display:inline-flex;align-items:flex-start;gap:var(--kern-metric-space-x-small, 4px)}.kern-link .kern-icon{background-color:var(--kern-color-action-default, #1A3DA5)}.kern-link:has(.kern-icon){text-decoration:none}.kern-link:has(.kern-icon):active,.kern-link:has(.kern-icon):hover{text-decoration-line:underline;text-decoration-style:solid;text-decoration-skip-ink:auto;text-decoration-thickness:var(--kern-3, 3px);text-underline-offset:var(--kern-metric-space-2x-small, 2px);text-underline-position:from-font}.kern-link:hover{text-decoration-thickness:var(--kern-3, 3px)}.kern-link:active{color:var(--kern-color-action-default, #1A3DA5);text-decoration-thickness:var(--kern-3, 3px)}.kern-link:active .kern-icon{background-color:var(--kern-color-action-default, #1A3DA5)}.kern-link:visited{color:var(--kern-color-action-visited, #75009E)}.kern-link:visited .kern-icon{background-color:var(--kern-color-action-visited, #75009E)}.kern-link--small{gap:var(--kern-metric-space-2x-small, 2px);color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-small-padding-bottom, 1px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);color:var(--kern-color-action-default, #1A3DA5)}.kern-link--small .kern-icon{width:var(--kern-metric-dimension-small, 20px);height:var(--kern-metric-dimension-small, 20px);min-width:var(--kern-metric-dimension-small, 20px);min-height:var(--kern-metric-dimension-small, 20px)}.kern-link:not(.kern-link--stretched):focus-visible{position:relative;z-index:1;outline-color:transparent;border-radius:var(--kern-metric-border-radius-small, .125rem);box-shadow:var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) 2px var(--kern-color-action-on-default),var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) 4px var(--kern-color-action-focus-border-inside),var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) var(--kern-metric-space-none, 0px) 6px var(--kern-color-action-focus-border-outside)}@media (forced-colors: active){.kern-link:not(.kern-link--stretched):focus-visible{outline-offset:4px!important;outline-width:3px!important;outline-color:transparent!important}}a.kern-btn{text-decoration:none}.kern-list{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;list-style:none;display:flex;flex-direction:column;gap:var(--kern-metric-space-none, 0);color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);padding-left:var(--kern-metric-space-none, 0)}.kern-list--small{font-size:var(--kern-typography-font-size-static-small, 16px);line-height:var(--kern-typography-line-height-static-medium, 24px);padding:var(--kern-metric-baseline-body-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-small-padding-bottom, 1px) var(--kern-metric-space-none, 0px)}.kern-list--small .kern-link{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-body-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-small-padding-bottom, 1px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);color:var(--kern-color-action-default, #1A3DA5)}.kern-list--small .kern-link .kern-icon{width:var(--kern-metric-dimension-small, 20px);height:var(--kern-metric-dimension-small, 20px);min-width:var(--kern-metric-dimension-small, 20px);min-height:var(--kern-metric-dimension-small, 20px)}.kern-list--large{font-size:var(--kern-typography-font-size-static-large, 21px);line-height:var(--kern-typography-line-height-static-large, 32px);padding:var(--kern-metric-baseline-body-large-padding-top, 1px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-body-large-padding-bottom, 7px) var(--kern-metric-space-none, 0px)}.kern-list--bullet{padding-left:var(--kern-metric-space-x-large, 32px);gap:var(--kern-metric-space-default, 16px);list-style-type:disc}.kern-list--number{padding-left:var(--kern-metric-space-x-large, 32px);gap:var(--kern-metric-space-default, 16px);list-style-type:decimal}.kern-list--horizontal{flex-direction:row;gap:var(--kern-metric-space-none, 0) var(--kern-metric-space-default, 16px);flex-wrap:wrap}.kern-subline{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-subline-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-subline-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-subline--large{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-subline-large-padding-top, 1px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-subline-large-padding-bottom, 7px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-large, 21px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-static-large, 32px)}.kern-subline--small{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-subline-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-subline-small-padding-bottom, 9px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-medium, 500);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-preline{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-preline-default-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-preline-default-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px);width:fit-content}.kern-preline--large{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-preline-large-padding-top, 1px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-preline-large-padding-bottom, 7px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-large, 21px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-large, 32px)}.kern-preline--small{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);color:var(--kern-color-layout-text-muted, #404565);padding:var(--kern-metric-baseline-preline-small-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-preline-small-padding-bottom, 1px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-small, 16px);font-weight:var(--kern-typography-font-weight-regular, 400);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-title{margin:0;padding:0;border:0;font-size:100%;vertical-align:baseline;color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-title-default-padding-top, 5px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-title-default-padding-bottom, 3px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-adaptive-medium, 21px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-adaptive-medium, 24px)}.kern-title--large{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-title-large-padding-top, 7px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-title-large-padding-bottom, 9px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-adaptive-large, 26px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-adaptive-large, 32px)}.kern-title--small{color:var(--kern-color-layout-text-default, #171A2B);font-family:var(--kern-typography-font-family-default, "Fira Sans");font-style:normal;letter-spacing:var(--kern-metric-space-none, 0px);padding:var(--kern-metric-baseline-title-small-padding-top, 6px) var(--kern-metric-space-none, 0px) var(--kern-metric-baseline-title-small-padding-bottom, 2px) var(--kern-metric-space-none, 0px);font-size:var(--kern-typography-font-size-static-medium, 18px);font-weight:var(--kern-typography-font-weight-semi-bold, 600);line-height:var(--kern-typography-line-height-static-medium, 24px)}.kern-container-fluid,.kern-container{width:100%;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem;box-sizing:border-box}[class^=kern-col],[class*=kern-col]{padding:1rem;box-sizing:border-box}.kern-container{max-width:1600px}.kern-row{display:flex;flex-wrap:wrap;margin-left:-1rem;margin-right:-1rem;box-sizing:border-box}.kern-row>*{flex-shrink:0;width:100%;max-width:100%}.kern-col{flex:1 0 0%}.kern-align-items-start{align-items:flex-start!important}.kern-align-items-center{align-items:center!important}.kern-align-items-end{align-items:flex-end!important}.kern-align-self-start{align-self:flex-start!important}.kern-align-self-center{align-self:center!important}.kern-align-self-end{align-self:flex-end!important}.kern-justify-content-start{justify-content:flex-start!important}.kern-justify-content-center{justify-content:center!important}.kern-justify-content-end{justify-content:flex-end!important}.kern-justify-content-around{justify-content:space-around!important}.kern-justify-content-between{justify-content:space-between!important}.kern-justify-content-evenly{justify-content:space-evenly!important}.kern-col-1{flex:0 0 auto;width:8.3333333333%}.kern-col-offset-1{margin-left:8.3333333333%}.kern-col-2{flex:0 0 auto;width:16.6666666667%}.kern-col-offset-2{margin-left:16.6666666667%}.kern-col-3{flex:0 0 auto;width:25%}.kern-col-offset-3{margin-left:25%}.kern-col-4{flex:0 0 auto;width:33.3333333333%}.kern-col-offset-4{margin-left:33.3333333333%}.kern-col-5{flex:0 0 auto;width:41.6666666667%}.kern-col-offset-5{margin-left:41.6666666667%}.kern-col-6{flex:0 0 auto;width:50%}.kern-col-offset-6{margin-left:50%}.kern-col-7{flex:0 0 auto;width:58.3333333333%}.kern-col-offset-7{margin-left:58.3333333333%}.kern-col-8{flex:0 0 auto;width:66.6666666667%}.kern-col-offset-8{margin-left:66.6666666667%}.kern-col-9{flex:0 0 auto;width:75%}.kern-col-offset-9{margin-left:75%}.kern-col-10{flex:0 0 auto;width:83.3333333333%}.kern-col-offset-10{margin-left:83.3333333333%}.kern-col-11{flex:0 0 auto;width:91.6666666667%}.kern-col-offset-11{margin-left:91.6666666667%}.kern-col-12{flex:0 0 auto;width:100%}.kern-col-offset-12{margin-left:100%}@media (min-width: 576px){.kern-container{max-width:96%}.kern-col-sm-offset-0{margin-left:0}.kern-col-sm-1{width:8.3333333333%}.kern-col-sm-offset-1{margin-left:8.3333333333%}.kern-col-sm-2{width:16.6666666667%}.kern-col-sm-offset-2{margin-left:16.6666666667%}.kern-col-sm-3{width:25%}.kern-col-sm-offset-3{margin-left:25%}.kern-col-sm-4{width:33.3333333333%}.kern-col-sm-offset-4{margin-left:33.3333333333%}.kern-col-sm-5{width:41.6666666667%}.kern-col-sm-offset-5{margin-left:41.6666666667%}.kern-col-sm-6{width:50%}.kern-col-sm-offset-6{margin-left:50%}.kern-col-sm-7{width:58.3333333333%}.kern-col-sm-offset-7{margin-left:58.3333333333%}.kern-col-sm-8{width:66.6666666667%}.kern-col-sm-offset-8{margin-left:66.6666666667%}.kern-col-sm-9{width:75%}.kern-col-sm-offset-9{margin-left:75%}.kern-col-sm-10{width:83.3333333333%}.kern-col-sm-offset-10{margin-left:83.3333333333%}.kern-col-sm-11{width:91.6666666667%}.kern-col-sm-offset-11{margin-left:91.6666666667%}.kern-col-sm-12{width:100%}.kern-col-sm-offset-12{margin-left:100%}}@media (min-width: 768px){.kern-container{max-width:96%}.kern-col-md-offset-0{margin-left:0}.kern-col-md-1{width:8.3333333333%}.kern-col-md-offset-1{margin-left:8.3333333333%}.kern-col-md-2{width:16.6666666667%}.kern-col-md-offset-2{margin-left:16.6666666667%}.kern-col-md-3{width:25%}.kern-col-md-offset-3{margin-left:25%}.kern-col-md-4{width:33.3333333333%}.kern-col-md-offset-4{margin-left:33.3333333333%}.kern-col-md-5{width:41.6666666667%}.kern-col-md-offset-5{margin-left:41.6666666667%}.kern-col-md-6{width:50%}.kern-col-md-offset-6{margin-left:50%}.kern-col-md-7{width:58.3333333333%}.kern-col-md-offset-7{margin-left:58.3333333333%}.kern-col-md-8{width:66.6666666667%}.kern-col-md-offset-8{margin-left:66.6666666667%}.kern-col-md-9{width:75%}.kern-col-md-offset-9{margin-left:75%}.kern-col-md-10{width:83.3333333333%}.kern-col-md-offset-10{margin-left:83.3333333333%}.kern-col-md-11{width:91.6666666667%}.kern-col-md-offset-11{margin-left:91.6666666667%}.kern-col-md-12{width:100%}.kern-col-md-offset-12{margin-left:100%}}@media (min-width: 992px){.kern-container{max-width:96%}.kern-col-lg-offset-0{margin-left:0}.kern-col-lg-1{width:8.3333333333%}.kern-col-lg-offset-1{margin-left:8.3333333333%}.kern-col-lg-2{width:16.6666666667%}.kern-col-lg-offset-2{margin-left:16.6666666667%}.kern-col-lg-3{width:25%}.kern-col-lg-offset-3{margin-left:25%}.kern-col-lg-4{width:33.3333333333%}.kern-col-lg-offset-4{margin-left:33.3333333333%}.kern-col-lg-5{width:41.6666666667%}.kern-col-lg-offset-5{margin-left:41.6666666667%}.kern-col-lg-6{width:50%}.kern-col-lg-offset-6{margin-left:50%}.kern-col-lg-7{width:58.3333333333%}.kern-col-lg-offset-7{margin-left:58.3333333333%}.kern-col-lg-8{width:66.6666666667%}.kern-col-lg-offset-8{margin-left:66.6666666667%}.kern-col-lg-9{width:75%}.kern-col-lg-offset-9{margin-left:75%}.kern-col-lg-10{width:83.3333333333%}.kern-col-lg-offset-10{margin-left:83.3333333333%}.kern-col-lg-11{width:91.6666666667%}.kern-col-lg-offset-11{margin-left:91.6666666667%}.kern-col-lg-12{width:100%}.kern-col-lg-offset-12{margin-left:100%}}@media (min-width: 1200px){.kern-container{max-width:96%}.kern-col-xl-offset-0{margin-left:0}.kern-col-xl-1{width:8.3333333333%}.kern-col-xl-offset-1{margin-left:8.3333333333%}.kern-col-xl-2{width:16.6666666667%}.kern-col-xl-offset-2{margin-left:16.6666666667%}.kern-col-xl-3{width:25%}.kern-col-xl-offset-3{margin-left:25%}.kern-col-xl-4{width:33.3333333333%}.kern-col-xl-offset-4{margin-left:33.3333333333%}.kern-col-xl-5{width:41.6666666667%}.kern-col-xl-offset-5{margin-left:41.6666666667%}.kern-col-xl-6{width:50%}.kern-col-xl-offset-6{margin-left:50%}.kern-col-xl-7{width:58.3333333333%}.kern-col-xl-offset-7{margin-left:58.3333333333%}.kern-col-xl-8{width:66.6666666667%}.kern-col-xl-offset-8{margin-left:66.6666666667%}.kern-col-xl-9{width:75%}.kern-col-xl-offset-9{margin-left:75%}.kern-col-xl-10{width:83.3333333333%}.kern-col-xl-offset-10{margin-left:83.3333333333%}.kern-col-xl-11{width:91.6666666667%}.kern-col-xl-offset-11{margin-left:91.6666666667%}.kern-col-xl-12{width:100%}.kern-col-xl-offset-12{margin-left:100%}}@media (min-width: 1600px){.kern-container{max-width:1536px}.kern-col-xxl-offset-0{margin-left:0}.kern-col-xxl-1{width:8.3333333333%}.kern-col-xxl-offset-1{margin-left:8.3333333333%}.kern-col-xxl-2{width:16.6666666667%}.kern-col-xxl-offset-2{margin-left:16.6666666667%}.kern-col-xxl-3{width:25%}.kern-col-xxl-offset-3{margin-left:25%}.kern-col-xxl-4{width:33.3333333333%}.kern-col-xxl-offset-4{margin-left:33.3333333333%}.kern-col-xxl-5{width:41.6666666667%}.kern-col-xxl-offset-5{margin-left:41.6666666667%}.kern-col-xxl-6{width:50%}.kern-col-xxl-offset-6{margin-left:50%}.kern-col-xxl-7{width:58.3333333333%}.kern-col-xxl-offset-7{margin-left:58.3333333333%}.kern-col-xxl-8{width:66.6666666667%}.kern-col-xxl-offset-8{margin-left:66.6666666667%}.kern-col-xxl-9{width:75%}.kern-col-xxl-offset-9{margin-left:75%}.kern-col-xxl-10{width:83.3333333333%}.kern-col-xxl-offset-10{margin-left:83.3333333333%}.kern-col-xxl-11{width:91.6666666667%}.kern-col-xxl-offset-11{margin-left:91.6666666667%}.kern-col-xxl-12{width:100%}.kern-col-xxl-offset-12{margin-left:100%}}:root{--kern-darkblue-025-lightness: 97.29%;--kern-darkblue-025-chroma: .0081;--kern-darkblue-025-hue: 261.5;--kern-darkblue-050-lightness: 95.28%;--kern-darkblue-050-chroma: .0144;--kern-darkblue-050-hue: 267.3;--kern-darkblue-100-lightness: 90.65%;--kern-darkblue-100-chroma: .0284;--kern-darkblue-100-hue: 265.8;--kern-darkblue-150-lightness: 87.02%;--kern-darkblue-150-chroma: .0397;--kern-darkblue-150-hue: 264.3;--kern-darkblue-200-lightness: 82.15%;--kern-darkblue-200-chroma: .0557;--kern-darkblue-200-hue: 265.6;--kern-darkblue-250-lightness: 78.4%;--kern-darkblue-250-chroma: .0671;--kern-darkblue-250-hue: 265.4;--kern-darkblue-300-lightness: 73.65%;--kern-darkblue-300-chroma: .083;--kern-darkblue-300-hue: 265.2;--kern-darkblue-350-lightness: 69.99%;--kern-darkblue-350-chroma: .0926;--kern-darkblue-350-hue: 265;--kern-darkblue-400-lightness: 66.28%;--kern-darkblue-400-chroma: .1035;--kern-darkblue-400-hue: 264.7;--kern-darkblue-450-lightness: 61.27%;--kern-darkblue-450-chroma: .1195;--kern-darkblue-450-hue: 265.5;--kern-darkblue-500-lightness: 57.58%;--kern-darkblue-500-chroma: .1302;--kern-darkblue-500-hue: 265.1;--kern-darkblue-550-lightness: 52.55%;--kern-darkblue-550-chroma: .1462;--kern-darkblue-550-hue: 265.4;--kern-darkblue-600-lightness: 48.97%;--kern-darkblue-600-chroma: .1552;--kern-darkblue-600-hue: 264.9;--kern-darkblue-650-lightness: 45%;--kern-darkblue-650-chroma: .166;--kern-darkblue-650-hue: 265.1;--kern-darkblue-700-lightness: 40.4%;--kern-darkblue-700-chroma: .1713;--kern-darkblue-700-hue: 265.1;--kern-darkblue-750-lightness: 36.29%;--kern-darkblue-750-chroma: .1831;--kern-darkblue-750-hue: 265;--kern-darkblue-800-lightness: 32.18%;--kern-darkblue-800-chroma: .1841;--kern-darkblue-800-hue: 265;--kern-darkblue-850-lightness: 28.85%;--kern-darkblue-850-chroma: .1905;--kern-darkblue-850-hue: 264.9;--kern-darkblue-900-lightness: 24.13%;--kern-darkblue-900-chroma: .1635;--kern-darkblue-900-hue: 266.4;--kern-darkblue-950-lightness: 19.3%;--kern-darkblue-950-chroma: .1283;--kern-darkblue-950-hue: 268.4}:root{--kern-lightblue-025-lightness: 97.93%;--kern-lightblue-025-chroma: .0112;--kern-lightblue-025-hue: 225.1;--kern-lightblue-050-lightness: 95.27%;--kern-lightblue-050-chroma: .0248;--kern-lightblue-050-hue: 223.4;--kern-lightblue-100-lightness: 90.47%;--kern-lightblue-100-chroma: .0495;--kern-lightblue-100-hue: 225.8;--kern-lightblue-150-lightness: 86.16%;--kern-lightblue-150-chroma: .0716;--kern-lightblue-150-hue: 224.5;--kern-lightblue-200-lightness: 82.29%;--kern-lightblue-200-chroma: .0929;--kern-lightblue-200-hue: 223.5;--kern-lightblue-250-lightness: 77.87%;--kern-lightblue-250-chroma: .1157;--kern-lightblue-250-hue: 223.4;--kern-lightblue-300-lightness: 72.6%;--kern-lightblue-300-chroma: .1365;--kern-lightblue-300-hue: 224.1;--kern-lightblue-350-lightness: 69.31%;--kern-lightblue-350-chroma: .1331;--kern-lightblue-350-hue: 226.5;--kern-lightblue-400-lightness: 65.7%;--kern-lightblue-400-chroma: .126;--kern-lightblue-400-hue: 226.3;--kern-lightblue-450-lightness: 60.49%;--kern-lightblue-450-chroma: .1218;--kern-lightblue-450-hue: 230.9;--kern-lightblue-500-lightness: 56.36%;--kern-lightblue-500-chroma: .1102;--kern-lightblue-500-hue: 228.3;--kern-lightblue-550-lightness: 51.87%;--kern-lightblue-550-chroma: .1098;--kern-lightblue-550-hue: 234.8;--kern-lightblue-600-lightness: 47.63%;--kern-lightblue-600-chroma: .1034;--kern-lightblue-600-hue: 236.6;--kern-lightblue-650-lightness: 42.88%;--kern-lightblue-650-chroma: .0984;--kern-lightblue-650-hue: 240.1;--kern-lightblue-700-lightness: 39.45%;--kern-lightblue-700-chroma: .0961;--kern-lightblue-700-hue: 243.4;--kern-lightblue-750-lightness: 34.98%;--kern-lightblue-750-chroma: .0901;--kern-lightblue-750-hue: 246.1;--kern-lightblue-800-lightness: 31%;--kern-lightblue-800-chroma: .0905;--kern-lightblue-800-hue: 251.1;--kern-lightblue-850-lightness: 26.58%;--kern-lightblue-850-chroma: .0837;--kern-lightblue-850-hue: 253.7;--kern-lightblue-900-lightness: 22.62%;--kern-lightblue-900-chroma: .0845;--kern-lightblue-900-hue: 258.2;--kern-lightblue-950-lightness: 18.48%;--kern-lightblue-950-chroma: .0867;--kern-lightblue-950-hue: 262.2}:root{--kern-turquoise-025-lightness: 97.64%;--kern-turquoise-025-chroma: .0123;--kern-turquoise-025-hue: 172.2;--kern-turquoise-050-lightness: 95.45%;--kern-turquoise-050-chroma: .0269;--kern-turquoise-050-hue: 171.7;--kern-turquoise-100-lightness: 90.68%;--kern-turquoise-100-chroma: .0593;--kern-turquoise-100-hue: 170.5;--kern-turquoise-150-lightness: 85.52%;--kern-turquoise-150-chroma: .0888;--kern-turquoise-150-hue: 171;--kern-turquoise-200-lightness: 81.34%;--kern-turquoise-200-chroma: .1071;--kern-turquoise-200-hue: 170.7;--kern-turquoise-250-lightness: 77.21%;--kern-turquoise-250-chroma: .1209;--kern-turquoise-250-hue: 170.3;--kern-turquoise-300-lightness: 72.07%;--kern-turquoise-300-chroma: .1298;--kern-turquoise-300-hue: 170.4;--kern-turquoise-350-lightness: 68.64%;--kern-turquoise-350-chroma: .1341;--kern-turquoise-350-hue: 170;--kern-turquoise-400-lightness: 63.71%;--kern-turquoise-400-chroma: .1258;--kern-turquoise-400-hue: 170.2;--kern-turquoise-450-lightness: 59.21%;--kern-turquoise-450-chroma: .1187;--kern-turquoise-450-hue: 168.9;--kern-turquoise-500-lightness: 54.7%;--kern-turquoise-500-chroma: .1094;--kern-turquoise-500-hue: 169.1;--kern-turquoise-550-lightness: 51.64%;--kern-turquoise-550-chroma: .1031;--kern-turquoise-550-hue: 169.3;--kern-turquoise-600-lightness: 46.91%;--kern-turquoise-600-chroma: .0948;--kern-turquoise-600-hue: 168.1;--kern-turquoise-650-lightness: 42.12%;--kern-turquoise-650-chroma: .0848;--kern-turquoise-650-hue: 168.5;--kern-turquoise-700-lightness: 38.81%;--kern-turquoise-700-chroma: .079;--kern-turquoise-700-hue: 167.5;--kern-turquoise-750-lightness: 33.77%;--kern-turquoise-750-chroma: .0682;--kern-turquoise-750-hue: 168.2;--kern-turquoise-800-lightness: 30.31%;--kern-turquoise-800-chroma: .0608;--kern-turquoise-800-hue: 168.9;--kern-turquoise-850-lightness: 26.7%;--kern-turquoise-850-chroma: .0545;--kern-turquoise-850-hue: 167.3;--kern-turquoise-900-lightness: 21.11%;--kern-turquoise-900-chroma: .0425;--kern-turquoise-900-hue: 168.5;--kern-turquoise-950-lightness: 17.16%;--kern-turquoise-950-chroma: .0342;--kern-turquoise-950-hue: 169.5}:root{--kern-green-025-lightness: 97.95%;--kern-green-025-chroma: .0066;--kern-green-025-hue: 151.9;--kern-green-050-lightness: 95.9%;--kern-green-050-chroma: .0151;--kern-green-050-hue: 148.4;--kern-green-100-lightness: 90.51%;--kern-green-100-chroma: .0375;--kern-green-100-hue: 148.6;--kern-green-150-lightness: 86.51%;--kern-green-150-chroma: .0556;--kern-green-150-hue: 148.3;--kern-green-200-lightness: 81.85%;--kern-green-200-chroma: .074;--kern-green-200-hue: 149;--kern-green-250-lightness: 77.04%;--kern-green-250-chroma: .092;--kern-green-250-hue: 148.1;--kern-green-300-lightness: 72.45%;--kern-green-300-chroma: .1087;--kern-green-300-hue: 148.5;--kern-green-350-lightness: 68.55%;--kern-green-350-chroma: .1228;--kern-green-350-hue: 148.4;--kern-green-400-lightness: 63.71%;--kern-green-400-chroma: .1312;--kern-green-400-hue: 148.6;--kern-green-450-lightness: 59.26%;--kern-green-450-chroma: .1414;--kern-green-450-hue: 148.4;--kern-green-500-lightness: 54.55%;--kern-green-500-chroma: .1469;--kern-green-500-hue: 148.4;--kern-green-550-lightness: 50.64%;--kern-green-550-chroma: .1479;--kern-green-550-hue: 147.7;--kern-green-600-lightness: 45.99%;--kern-green-600-chroma: .1381;--kern-green-600-hue: 146.6;--kern-green-650-lightness: 42.82%;--kern-green-650-chroma: .1318;--kern-green-650-hue: 145.7;--kern-green-700-lightness: 38.01%;--kern-green-700-chroma: .118;--kern-green-700-hue: 145.4;--kern-green-750-lightness: 34.7%;--kern-green-750-chroma: .1103;--kern-green-750-hue: 144.6;--kern-green-800-lightness: 29.62%;--kern-green-800-chroma: .095;--kern-green-800-hue: 144.4;--kern-green-850-lightness: 26.11%;--kern-green-850-chroma: .0844;--kern-green-850-hue: 144.1;--kern-green-900-lightness: 20.63%;--kern-green-900-chroma: .0664;--kern-green-900-hue: 144.2;--kern-green-950-lightness: 16.76%;--kern-green-950-chroma: .0542;--kern-green-950-hue: 144.1}:root{--kern-limette-025-lightness: 97.02%;--kern-limette-025-chroma: .0694;--kern-limette-025-hue: 120.6;--kern-limette-050-lightness: 95.09%;--kern-limette-050-chroma: .1155;--kern-limette-050-hue: 120.8;--kern-limette-100-lightness: 90.24%;--kern-limette-100-chroma: .1656;--kern-limette-100-hue: 120.8;--kern-limette-150-lightness: 86.02%;--kern-limette-150-chroma: .1845;--kern-limette-150-hue: 121.2;--kern-limette-200-lightness: 81.36%;--kern-limette-200-chroma: .1887;--kern-limette-200-hue: 120.7;--kern-limette-250-lightness: 77.69%;--kern-limette-250-chroma: .1864;--kern-limette-250-hue: 121;--kern-limette-300-lightness: 73.21%;--kern-limette-300-chroma: .1755;--kern-limette-300-hue: 120.9;--kern-limette-350-lightness: 68.65%;--kern-limette-350-chroma: .1645;--kern-limette-350-hue: 120.9;--kern-limette-400-lightness: 65.38%;--kern-limette-400-chroma: .1582;--kern-limette-400-hue: 121.8;--kern-limette-450-lightness: 60.7%;--kern-limette-450-chroma: .1467;--kern-limette-450-hue: 121.7;--kern-limette-500-lightness: 55.93%;--kern-limette-500-chroma: .135;--kern-limette-500-hue: 121.6;--kern-limette-550-lightness: 51.06%;--kern-limette-550-chroma: .1231;--kern-limette-550-hue: 121.4;--kern-limette-600-lightness: 47.75%;--kern-limette-600-chroma: .115;--kern-limette-600-hue: 121.3;--kern-limette-650-lightness: 42.55%;--kern-limette-650-chroma: .1032;--kern-limette-650-hue: 122;--kern-limette-700-lightness: 39.09%;--kern-limette-700-chroma: .0946;--kern-limette-700-hue: 121.8;--kern-limette-750-lightness: 35.55%;--kern-limette-750-chroma: .0858;--kern-limette-750-hue: 121.6;--kern-limette-800-lightness: 30%;--kern-limette-800-chroma: .0727;--kern-limette-800-hue: 121.9;--kern-limette-850-lightness: 26.21%;--kern-limette-850-chroma: .0631;--kern-limette-850-hue: 121.3;--kern-limette-900-lightness: 22.14%;--kern-limette-900-chroma: .0541;--kern-limette-900-hue: 122.7;--kern-limette-950-lightness: 18.08%;--kern-limette-950-chroma: .0434;--kern-limette-950-hue: 121.1}:root{--kern-yellow-025-lightness: 97.15%;--kern-yellow-025-chroma: .1207;--kern-yellow-025-hue: 106.7;--kern-yellow-050-lightness: 94.9%;--kern-yellow-050-chroma: .1515;--kern-yellow-050-hue: 104.1;--kern-yellow-100-lightness: 90.5%;--kern-yellow-100-chroma: .1776;--kern-yellow-100-hue: 98.18;--kern-yellow-150-lightness: 86.85%;--kern-yellow-150-chroma: .1781;--kern-yellow-150-hue: 94.26;--kern-yellow-200-lightness: 82.83%;--kern-yellow-200-chroma: .1699;--kern-yellow-200-hue: 94.33;--kern-yellow-250-lightness: 78.01%;--kern-yellow-250-chroma: .1597;--kern-yellow-250-hue: 92.52;--kern-yellow-300-lightness: 73.93%;--kern-yellow-300-chroma: .1513;--kern-yellow-300-hue: 92.61;--kern-yellow-350-lightness: 69.79%;--kern-yellow-350-chroma: .1428;--kern-yellow-350-hue: 92.72;--kern-yellow-400-lightness: 65.58%;--kern-yellow-400-chroma: .1343;--kern-yellow-400-hue: 92.85;--kern-yellow-450-lightness: 61.31%;--kern-yellow-450-chroma: .1255;--kern-yellow-450-hue: 92.99;--kern-yellow-500-lightness: 56.96%;--kern-yellow-500-chroma: .1166;--kern-yellow-500-hue: 93.17;--kern-yellow-550-lightness: 52.05%;--kern-yellow-550-chroma: .1064;--kern-yellow-550-hue: 91.55;--kern-yellow-600-lightness: 47.57%;--kern-yellow-600-chroma: .0973;--kern-yellow-600-hue: 91.85;--kern-yellow-650-lightness: 44.52%;--kern-yellow-650-chroma: .0911;--kern-yellow-650-hue: 92.09;--kern-yellow-700-lightness: 39.84%;--kern-yellow-700-chroma: .0815;--kern-yellow-700-hue: 92.54;--kern-yellow-750-lightness: 34.74%;--kern-yellow-750-chroma: .071;--kern-yellow-750-hue: 91.44;--kern-yellow-800-lightness: 31.21%;--kern-yellow-800-chroma: .0638;--kern-yellow-800-hue: 90.35;--kern-yellow-850-lightness: 25.99%;--kern-yellow-850-chroma: .0531;--kern-yellow-850-hue: 90.14;--kern-yellow-900-lightness: 22.55%;--kern-yellow-900-chroma: .0461;--kern-yellow-900-hue: 91.64;--kern-yellow-950-lightness: 18.61%;--kern-yellow-950-chroma: .038;--kern-yellow-950-hue: 89.88}:root{--kern-orange-025-lightness: 98%;--kern-orange-025-chroma: .0188;--kern-orange-025-hue: 81.5;--kern-orange-050-lightness: 95.85%;--kern-orange-050-chroma: .0433;--kern-orange-050-hue: 84.57;--kern-orange-100-lightness: 91.5%;--kern-orange-100-chroma: .0891;--kern-orange-100-hue: 84.2;--kern-orange-150-lightness: 87.38%;--kern-orange-150-chroma: .1245;--kern-orange-150-hue: 81.4;--kern-orange-200-lightness: 83.3%;--kern-orange-200-chroma: .1517;--kern-orange-200-hue: 77.01;--kern-orange-250-lightness: 79.67%;--kern-orange-250-chroma: .1689;--kern-orange-250-hue: 71.24;--kern-orange-300-lightness: 74.41%;--kern-orange-300-chroma: .1646;--kern-orange-300-hue: 66.86;--kern-orange-350-lightness: 70.85%;--kern-orange-350-chroma: .1565;--kern-orange-350-hue: 67.04;--kern-orange-400-lightness: 66.63%;--kern-orange-400-chroma: .1493;--kern-orange-400-hue: 65.13;--kern-orange-450-lightness: 61.81%;--kern-orange-450-chroma: .1382;--kern-orange-450-hue: 65.47;--kern-orange-500-lightness: 57.6%;--kern-orange-500-chroma: .1306;--kern-orange-500-hue: 63.7;--kern-orange-550-lightness: 52.64%;--kern-orange-550-chroma: .1189;--kern-orange-550-hue: 64.21;--kern-orange-600-lightness: 48.42%;--kern-orange-600-chroma: .1108;--kern-orange-600-hue: 62.67;--kern-orange-650-lightness: 44.59%;--kern-orange-650-chroma: .1015;--kern-orange-650-hue: 63.27;--kern-orange-700-lightness: 40.32%;--kern-orange-700-chroma: .0927;--kern-orange-700-hue: 62.06;--kern-orange-750-lightness: 36.35%;--kern-orange-750-chroma: .0829;--kern-orange-750-hue: 63.06;--kern-orange-800-lightness: 32.01%;--kern-orange-800-chroma: .0733;--kern-orange-800-hue: 62.53;--kern-orange-850-lightness: 27.62%;--kern-orange-850-chroma: .0632;--kern-orange-850-hue: 62.68;--kern-orange-900-lightness: 22.99%;--kern-orange-900-chroma: .0528;--kern-orange-900-hue: 62.35;--kern-orange-950-lightness: 18.36%;--kern-orange-950-chroma: .0413;--kern-orange-950-hue: 64.82}:root{--kern-red-025-lightness: 98.03%;--kern-red-025-chroma: .0083;--kern-red-025-hue: 25.06;--kern-red-050-lightness: 95.36%;--kern-red-050-chroma: .0217;--kern-red-050-hue: 32.68;--kern-red-100-lightness: 91.24%;--kern-red-100-chroma: .0436;--kern-red-100-hue: 28.25;--kern-red-150-lightness: 87.71%;--kern-red-150-chroma: .0621;--kern-red-150-hue: 29.89;--kern-red-200-lightness: 83.28%;--kern-red-200-chroma: .0854;--kern-red-200-hue: 30.18;--kern-red-250-lightness: 79.59%;--kern-red-250-chroma: .1043;--kern-red-250-hue: 29.15;--kern-red-300-lightness: 75.15%;--kern-red-300-chroma: .1265;--kern-red-300-hue: 28.4;--kern-red-350-lightness: 71.18%;--kern-red-350-chroma: .143;--kern-red-350-hue: 28.92;--kern-red-400-lightness: 67.04%;--kern-red-400-chroma: .1611;--kern-red-400-hue: 28.5;--kern-red-450-lightness: 63.35%;--kern-red-450-chroma: .1717;--kern-red-450-hue: 29.1;--kern-red-500-lightness: 58.93%;--kern-red-500-chroma: .1871;--kern-red-500-hue: 29.12;--kern-red-550-lightness: 54.9%;--kern-red-550-chroma: .1972;--kern-red-550-hue: 29.28;--kern-red-600-lightness: 50.78%;--kern-red-600-chroma: .202;--kern-red-600-hue: 29.22;--kern-red-650-lightness: 46%;--kern-red-650-chroma: .1888;--kern-red-650-hue: 29.23;--kern-red-700-lightness: 41.84%;--kern-red-700-chroma: .1717;--kern-red-700-hue: 29.23;--kern-red-750-lightness: 37.56%;--kern-red-750-chroma: .1541;--kern-red-750-hue: 29.23;--kern-red-800-lightness: 32.04%;--kern-red-800-chroma: .1315;--kern-red-800-hue: 29.23;--kern-red-850-lightness: 28.62%;--kern-red-850-chroma: .1174;--kern-red-850-hue: 29.23;--kern-red-900-lightness: 23.88%;--kern-red-900-chroma: .098;--kern-red-900-hue: 29.23;--kern-red-950-lightness: 18.89%;--kern-red-950-chroma: .0775;--kern-red-950-hue: 29.23}:root{--kern-violet-025-lightness: 97.97%;--kern-violet-025-chroma: .0094;--kern-violet-025-hue: 311;--kern-violet-050-lightness: 95.12%;--kern-violet-050-chroma: .0215;--kern-violet-050-hue: 312.8;--kern-violet-100-lightness: 91.07%;--kern-violet-100-chroma: .0444;--kern-violet-100-hue: 314;--kern-violet-150-lightness: 88%;--kern-violet-150-chroma: .0602;--kern-violet-150-hue: 313.2;--kern-violet-200-lightness: 83.03%;--kern-violet-200-chroma: .0861;--kern-violet-200-hue: 313;--kern-violet-250-lightness: 79.26%;--kern-violet-250-chroma: .106;--kern-violet-250-hue: 313.5;--kern-violet-300-lightness: 75.52%;--kern-violet-300-chroma: .123;--kern-violet-300-hue: 313.3;--kern-violet-350-lightness: 71.06%;--kern-violet-350-chroma: .1442;--kern-violet-350-hue: 313.8;--kern-violet-400-lightness: 67.51%;--kern-violet-400-chroma: .1583;--kern-violet-400-hue: 313.6;--kern-violet-450-lightness: 63.1%;--kern-violet-450-chroma: .1778;--kern-violet-450-hue: 313.2;--kern-violet-500-lightness: 59.14%;--kern-violet-500-chroma: .1931;--kern-violet-500-hue: 313.6;--kern-violet-550-lightness: 55.43%;--kern-violet-550-chroma: .2052;--kern-violet-550-hue: 313.9;--kern-violet-600-lightness: 50.94%;--kern-violet-600-chroma: .2144;--kern-violet-600-hue: 313.2;--kern-violet-650-lightness: 47.11%;--kern-violet-650-chroma: .2224;--kern-violet-650-hue: 313.7;--kern-violet-700-lightness: 42.44%;--kern-violet-700-chroma: .2119;--kern-violet-700-hue: 312.4;--kern-violet-750-lightness: 38.09%;--kern-violet-750-chroma: .1911;--kern-violet-750-hue: 311.5;--kern-violet-800-lightness: 32.98%;--kern-violet-800-chroma: .1651;--kern-violet-800-hue: 311.9;--kern-violet-850-lightness: 28.25%;--kern-violet-850-chroma: .1427;--kern-violet-850-hue: 310.2;--kern-violet-900-lightness: 23.95%;--kern-violet-900-chroma: .1205;--kern-violet-900-hue: 311;--kern-violet-950-lightness: 19.14%;--kern-violet-950-chroma: .0967;--kern-violet-950-hue: 310.2}:root{--kern-neutral-025-lightness: 97.46%;--kern-neutral-025-chroma: .0028;--kern-neutral-025-hue: 286.3;--kern-neutral-050-lightness: 95.79%;--kern-neutral-050-chroma: .0053;--kern-neutral-050-hue: 275;--kern-neutral-100-lightness: 91.42%;--kern-neutral-100-chroma: .012;--kern-neutral-100-hue: 276;--kern-neutral-150-lightness: 87.05%;--kern-neutral-150-chroma: .0183;--kern-neutral-150-hue: 275.9;--kern-neutral-200-lightness: 82.73%;--kern-neutral-200-chroma: .0236;--kern-neutral-200-hue: 275.8;--kern-neutral-250-lightness: 78.2%;--kern-neutral-250-chroma: .0305;--kern-neutral-250-hue: 276.7;--kern-neutral-300-lightness: 74.59%;--kern-neutral-300-chroma: .0358;--kern-neutral-300-hue: 276.5;--kern-neutral-350-lightness: 70.15%;--kern-neutral-350-chroma: .042;--kern-neutral-350-hue: 275.3;--kern-neutral-400-lightness: 65.51%;--kern-neutral-400-chroma: .0464;--kern-neutral-400-hue: 278.2;--kern-neutral-450-lightness: 61.18%;--kern-neutral-450-chroma: .0496;--kern-neutral-450-hue: 277;--kern-neutral-500-lightness: 56.84%;--kern-neutral-500-chroma: .0521;--kern-neutral-500-hue: 275.8;--kern-neutral-550-lightness: 52.32%;--kern-neutral-550-chroma: .054;--kern-neutral-550-hue: 276.6;--kern-neutral-600-lightness: 48.66%;--kern-neutral-600-chroma: .0561;--kern-neutral-600-hue: 276.4;--kern-neutral-650-lightness: 44.06%;--kern-neutral-650-chroma: .0569;--kern-neutral-650-hue: 277.1;--kern-neutral-700-lightness: 39.76%;--kern-neutral-700-chroma: .0529;--kern-neutral-700-hue: 277;--kern-neutral-750-lightness: 35.13%;--kern-neutral-750-chroma: .0511;--kern-neutral-750-hue: 277.7;--kern-neutral-800-lightness: 30.72%;--kern-neutral-800-chroma: .0459;--kern-neutral-800-hue: 276.7;--kern-neutral-850-lightness: 27%;--kern-neutral-850-chroma: .0409;--kern-neutral-850-hue: 277.5;--kern-neutral-900-lightness: 22.43%;--kern-neutral-900-chroma: .0333;--kern-neutral-900-hue: 275.7;--kern-neutral-950-lightness: 18.2%;--kern-neutral-950-chroma: .0301;--kern-neutral-950-hue: 277.2}:root{--kern-black-lightness: 0%;--kern-black-chroma: 0;--kern-black-hue: 0;--kern-white-lightness: 100%;--kern-white-chroma: 0;--kern-white-hue: 0}:root{--kern-typography-font-family-fira-sans: "Fira Sans", sans-serif;--kern-typography-font-family-fira-mono: "Fira Mono", monospace;--kern-font-size-12: .75rem;--kern-font-size-16: 1rem;--kern-font-size-18: 1.125rem;--kern-font-size-20: 1.25rem;--kern-font-size-21: 1.3125rem;--kern-font-size-24: 1.5rem;--kern-font-size-26: 1.625rem;--kern-font-size-32: 2rem;--kern-font-size-40: 2.5rem;--kern-font-size-48: 3rem;--kern-font-size-56: 3.5rem;--kern-font-size-72: 4.5rem;--kern-font-size-80: 5rem}:root{--kern-0: 0rem;--kern-1: .0625rem;--kern-2: .125rem;--kern-3: .1875rem;--kern-4: .25rem;--kern-5: .3125rem;--kern-6: .375rem;--kern-7: .4375rem;--kern-8: .5rem;--kern-9: .5625rem;--kern-10: .625rem;--kern-14: .875rem;--kern-12: .75rem;--kern-16: 1rem;--kern-18: 1.125rem;--kern-20: 1.25rem;--kern-24: 1.5rem;--kern-32: 2rem;--kern-40: 2.5rem;--kern-48: 3rem;--kern-56: 3.5rem;--kern-64: 4rem;--kern-80: 5rem;--kern-96: 6rem;--kern-128: 8rem;--kern-160: 10rem;--kern-192: 12rem;--kern-224: 14rem;--kern-240: 15rem;--kern-256: 16rem;--kern-352: 22rem;--kern-360: 22.5rem;--kern-384: 24rem;--kern-480: 30rem;--kern-512: 32rem;--kern-736: 46rem;--kern-768: 48rem;--kern-992: 62rem;--kern-1024: 64rem;--kern-1140: 71.25rem;--kern-1248: 78rem;--kern-1280: 80rem;--kern-1504: 94rem;--kern-1536: 96rem;--kern-1600: 100rem;--kern-1920: 120rem}:root{--kern-metric-border-width-none: var(--kern-0);--kern-metric-border-width-light: var(--kern-1);--kern-metric-border-width-default: var(--kern-2);--kern-metric-border-width-bold: var(--kern-4);--kern-metric-border-width-heavy: var(--kern-8);--kern-metric-border-radius-none: var(--kern-0);--kern-metric-border-radius-small: var(--kern-2);--kern-metric-border-radius-default: var(--kern-4);--kern-metric-border-radius-large: var(--kern-8);--kern-metric-border-radius-circle: 50%;--kern-component-badge-space-left: var(--kern-12);--kern-component-description-list-term-max-width: var(--kern-352);--kern-component-alert-icon-size: var(--kern-32);--kern-component-kopfzeile-font-family: "Fira Sans", "Fira Sans Regular", "Noto Sans", "Noto Sans Regular", "SF Pro Text", "Segoe UI", SegoeUI, Roboto, Arial, Helvetica, sans-serif;--kern-component-kopfzeile-font-size: var(--kern-font-size-14);--kern-component-kopfzeile-line-height: var(--kern-font-size-16);--kern-component-kopfzeile-padding: var(--kern-7);--kern-metric-dimension-2x-small: var(--kern-8);--kern-metric-dimension-x-small: var(--kern-16);--kern-metric-dimension-small: var(--kern-20);--kern-metric-dimension-default: var(--kern-24);--kern-metric-dimension-large: var(--kern-32);--kern-metric-dimension-x-large: var(--kern-48);--kern-metric-dimension-2x-large: var(--kern-56);--kern-metric-dimension-3x-large: var(--kern-64);--kern-metric-dimension-4x-large: var(--kern-80);--kern-metric-dimension-5x-large: var(--kern-96);--kern-metric-dimension-media-small: var(--kern-96);--kern-metric-dimension-media-default: var(--kern-160);--kern-metric-dimension-media-large: var(--kern-240);--kern-metric-screen-size: var(--kern-360);--kern-metric-space-none: var(--kern-0);--kern-metric-space-2x-small: var(--kern-2);--kern-metric-space-x-small: var(--kern-4);--kern-metric-space-small: var(--kern-8);--kern-metric-space-default: var(--kern-16);--kern-metric-space-large: var(--kern-24);--kern-metric-space-x-large: var(--kern-32);--kern-typography-font-family-default: var(--kern-typography-font-family-fira-sans);--kern-typography-line-height-static-medium: var(--kern-font-size-24);--kern-typography-line-height-static-large: var(--kern-font-size-32);--kern-typography-line-height-adaptive-medium: var(--kern-font-size-24);--kern-typography-line-height-adaptive-large: var(--kern-font-size-32);--kern-typography-line-height-adaptive-x-large: var(--kern-font-size-40);--kern-typography-line-height-adaptive-2x-large: var(--kern-font-size-56);--kern-typography-font-size-static-small: var(--kern-font-size-16);--kern-typography-font-size-static-medium: var(--kern-font-size-18);--kern-typography-font-size-static-large: var(--kern-font-size-21);--kern-typography-font-size-adaptive-medium: var(--kern-font-size-21);--kern-typography-font-size-adaptive-large: var(--kern-font-size-26);--kern-typography-font-size-adaptive-x-large: var(--kern-font-size-32);--kern-typography-font-size-adaptive-2x-large: var(--kern-font-size-48);--kern-metric-baseline-body-default-padding-top: var(--kern-6);--kern-metric-baseline-body-default-padding-bottom: var(--kern-2);--kern-metric-baseline-body-large-padding-top: var(--kern-1);--kern-metric-baseline-body-large-padding-bottom: var(--kern-7);--kern-metric-baseline-body-small-padding-top: var(--kern-7);--kern-metric-baseline-body-small-padding-bottom: var(--kern-1);--kern-metric-baseline-heading-display-padding-top: var(--kern-12);--kern-metric-baseline-heading-display-padding-bottom: var(--kern-12);--kern-metric-baseline-heading-x-large-padding-top: var(--kern-9);--kern-metric-baseline-heading-x-large-padding-bottom: var(--kern-7);--kern-metric-baseline-heading-large-padding-top: var(--kern-7);--kern-metric-baseline-heading-large-padding-bottom: var(--kern-9);--kern-metric-baseline-heading-medium-padding-top: var(--kern-5);--kern-metric-baseline-heading-medium-padding-bottom: var(--kern-3);--kern-metric-baseline-heading-small-padding-top: var(--kern-6);--kern-metric-baseline-heading-small-padding-bottom: var(--kern-2);--kern-metric-baseline-title-large-padding-top: var(--kern-7);--kern-metric-baseline-title-large-padding-bottom: var(--kern-9);--kern-metric-baseline-title-default-padding-top: var(--kern-5);--kern-metric-baseline-title-default-padding-bottom: var(--kern-3);--kern-metric-baseline-title-small-padding-top: var(--kern-6);--kern-metric-baseline-title-small-padding-bottom: var(--kern-2);--kern-metric-baseline-preline-large-padding-top: var(--kern-1);--kern-metric-baseline-preline-large-padding-bottom: var(--kern-7);--kern-metric-baseline-preline-default-padding-top: var(--kern-6);--kern-metric-baseline-preline-default-padding-bottom: var(--kern-2);--kern-metric-baseline-preline-small-padding-top: var(--kern-7);--kern-metric-baseline-preline-small-padding-bottom: var(--kern-1);--kern-metric-baseline-subline-large-padding-top: var(--kern-1);--kern-metric-baseline-subline-large-padding-bottom: var(--kern-7);--kern-metric-baseline-subline-default-padding-top: var(--kern-6);--kern-metric-baseline-subline-default-padding-bottom: var(--kern-2);--kern-metric-baseline-subline-small-padding-top: var(--kern-7);--kern-metric-baseline-subline-small-padding-bottom: var(--kern-9);--kern-metric-baseline-label-large-padding-top: var(--kern-1);--kern-metric-baseline-label-large-padding-bottom: var(--kern-7);--kern-metric-baseline-label-default-padding-top: var(--kern-6);--kern-metric-baseline-label-default-padding-bottom: var(--kern-2);--kern-metric-baseline-label-small-padding-top: var(--kern-7);--kern-metric-baseline-label-small-padding-bottom: var(--kern-1);--kern-typography-font-weight-regular: 400;--kern-typography-font-weight-medium: 500;--kern-typography-font-weight-semi-bold: 600}@media (min-width: 768px){:root{--kern-component-kopfzeile-padding: var(--kern-7);--kern-component-alert-icon-size: var(--kern-40);--kern-component-kopfzeile-font-size: var(--kern-font-size-16);--kern-component-kopfzeile-line-height: var(--kern-font-size-20);--kern-component-kopfzeile-padding: var(--kern-5);--kern-metric-dimension-media-small: var(--kern-128);--kern-metric-dimension-media-default: var(--kern-192);--kern-metric-dimension-media-large: var(--kern-360);--kern-metric-screen-size: var(--kern-1920);--kern-typography-line-height-adaptive-medium: var(--kern-font-size-32);--kern-typography-line-height-adaptive-large: var(--kern-font-size-40);--kern-typography-line-height-adaptive-x-large: var(--kern-font-size-56);--kern-typography-line-height-adaptive-2x-large: var(--kern-font-size-80);--kern-typography-font-size-adaptive-medium: var(--kern-font-size-24);--kern-typography-font-size-adaptive-large: var(--kern-font-size-32);--kern-typography-font-size-adaptive-x-large: var(--kern-font-size-48);--kern-typography-font-size-adaptive-2x-large: var(--kern-font-size-72);--kern-metric-baseline-heading-x-large-padding-top: var(--kern-12);--kern-metric-baseline-heading-x-large-padding-bottom: var(--kern-12);--kern-metric-baseline-heading-large-padding-top: var(--kern-9);--kern-metric-baseline-heading-large-padding-bottom: var(--kern-7);--kern-metric-baseline-heading-medium-padding-top: var(--kern-8);--kern-metric-baseline-heading-medium-padding-bottom: var(--kern-8);--kern-metric-baseline-heading-display-padding-top: var(--kern-16);--kern-metric-baseline-heading-display-padding-bottom: var(--kern-16);--kern-metric-baseline-title-large-padding-top: var(--kern-9);--kern-metric-baseline-title-large-padding-bottom: var(--kern-7);--kern-metric-baseline-title-default-padding-top: var(--kern-8);--kern-metric-baseline-title-default-padding-bottom: var(--kern-8)}}@media (prefers-color-scheme: dark){:root{--kern-color-action-default: oklch(var(--kern-darkblue-300-lightness) var(--kern-darkblue-300-chroma) var(--kern-darkblue-300-hue));--kern-color-action-on-default: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue));--kern-color-action-visited: oklch(var(--kern-violet-300-lightness) var(--kern-violet-300-chroma) var(--kern-violet-300-hue));--kern-color-action-focus-background: oklch(var(--kern-neutral-400-lightness) var(--kern-neutral-400-chroma) var(--kern-neutral-400-hue));--kern-color-action-focus-border-inside: oklch(var(--kern-neutral-500-lightness) var(--kern-neutral-500-chroma) var(--kern-neutral-500-hue));--kern-color-action-focus-border-outside: oklch(var(--kern-neutral-800-lightness) var(--kern-neutral-800-chroma) var(--kern-neutral-800-hue));--kern-color-action-state-indicator-default: var(--kern-color-action-default);--kern-color-action-state-indicator-shade: var(--kern-color-layout-text-default);--kern-color-action-state-indicator-tint: var(--kern-color-action-on-default);--kern-color-action-state-opacity-hover: 88%;--kern-color-action-state-opacity-pressed: .32;--kern-color-action-state-opacity-selected: .12;--kern-color-action-state-opacity-disabled: .4;--kern-color-action-state-opacity-active: 84%;--kern-color-action-state-opacity-overlay: .72;--kern-color-feedback-danger: oklch(var(--kern-red-400-lightness) var(--kern-red-400-chroma) var(--kern-red-400-hue));--kern-color-feedback-danger-background: oklch(var(--kern-red-900-lightness) var(--kern-red-900-chroma) var(--kern-red-900-hue));--kern-color-feedback-info: oklch(var(--kern-lightblue-400-lightness) var(--kern-lightblue-400-chroma) var(--kern-lightblue-400-hue));--kern-color-feedback-info-background: oklch(var(--kern-lightblue-900-lightness) var(--kern-lightblue-900-chroma) var(--kern-lightblue-900-hue));--kern-color-feedback-success: oklch(var(--kern-turquoise-400-lightness) var(--kern-turquoise-400-chroma) var(--kern-turquoise-400-hue));--kern-color-feedback-success-background: oklch(var(--kern-turquoise-900-lightness) var(--kern-turquoise-900-chroma) var(--kern-turquoise-900-hue));--kern-color-feedback-warning: oklch(var(--kern-orange-400-lightness) var(--kern-orange-400-chroma) var(--kern-orange-400-hue));--kern-color-feedback-warning-background: oklch(var(--kern-orange-900-lightness) var(--kern-orange-900-chroma) var(--kern-orange-900-hue));--kern-color-feedback-loader: oklch(var(--kern-neutral-050-lightness) var(--kern-neutral-050-chroma) var(--kern-neutral-050-hue));--kern-color-feedback-loader-background: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-form-input-background: oklch(var(--kern-neutral-900-lightness) var(--kern-neutral-900-chroma) var(--kern-neutral-900-hue));--kern-color-form-input-background-inverted: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue));--kern-color-form-input-border: oklch(var(--kern-neutral-050-lightness) var(--kern-neutral-050-chroma) var(--kern-neutral-050-hue));--kern-color-layout-border: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-layout-text-default: oklch(var(--kern-neutral-050-lightness) var(--kern-neutral-050-chroma) var(--kern-neutral-050-hue));--kern-color-layout-text-inverse: oklch(var(--kern-neutral-950-lightness) var(--kern-neutral-950-chroma) var(--kern-neutral-950-hue));--kern-color-layout-text-muted: oklch(var(--kern-neutral-300-lightness) var(--kern-neutral-300-chroma) var(--kern-neutral-300-hue));--kern-color-layout-background-default: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue));--kern-color-layout-background-hued: oklch(var(--kern-neutral-950-lightness) var(--kern-neutral-950-chroma) var(--kern-neutral-950-hue));--kern-color-layout-background-inverted: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue));--kern-color-layout-background-overlay: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue) / var(--kern-color-action-state-opacity-overlay));--kern-color-action-state-indicator-shade-hover: color-mix(in oklch, var(--kern-color-action-default), black calc(100% - var(--kern-color-action-state-opacity-hover)));--kern-color-action-state-indicator-shade-active: color-mix(in oklch, var(--kern-color-action-default), black calc(100% - var(--kern-color-action-state-opacity-active)));--kern-color-action-state-indicator-tint-hover-opacity: color-mix(in oklch, var(--kern-color-action-default), transparent var(--kern-color-action-state-opacity-hover));--kern-color-action-state-indicator-tint-active-opacity: color-mix(in oklch, var(--kern-color-action-default), transparent var(--kern-color-action-state-opacity-active))}}@media (prefers-color-scheme: light){:root{--kern-color-action-default: oklch(var(--kern-darkblue-700-lightness) var(--kern-darkblue-700-chroma) var(--kern-darkblue-700-hue));--kern-color-action-on-default: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue));--kern-color-action-visited: oklch(var(--kern-violet-700-lightness) var(--kern-violet-700-chroma) var(--kern-violet-700-hue));--kern-color-action-focus-background: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-action-focus-border-inside: oklch(var(--kern-neutral-500-lightness) var(--kern-neutral-500-chroma) var(--kern-neutral-500-hue));--kern-color-action-focus-border-outside: oklch(var(--kern-neutral-200-lightness) var(--kern-neutral-200-chroma) var(--kern-neutral-200-hue));--kern-color-action-state-indicator-default: var(--kern-color-action-default);--kern-color-action-state-indicator-shade: var(--kern-color-layout-text-default);--kern-color-action-state-indicator-tint: var(--kern-color-action-on-default);--kern-color-action-state-opacity-hover: 92%;--kern-color-action-state-opacity-pressed: .32;--kern-color-action-state-opacity-selected: .12;--kern-color-action-state-opacity-disabled: .4;--kern-color-action-state-opacity-active: 84%;--kern-color-action-state-opacity-overlay: .72;--kern-color-feedback-danger: oklch(var(--kern-red-600-lightness) var(--kern-red-600-chroma) var(--kern-red-600-hue));--kern-color-feedback-danger-background: oklch(var(--kern-red-050-lightness) var(--kern-red-050-chroma) var(--kern-red-050-hue));--kern-color-feedback-info: oklch(var(--kern-lightblue-600-lightness) var(--kern-lightblue-600-chroma) var(--kern-lightblue-600-hue));--kern-color-feedback-info-background: oklch(var(--kern-lightblue-050-lightness) var(--kern-lightblue-050-chroma) var(--kern-lightblue-050-hue));--kern-color-feedback-success: oklch(var(--kern-turquoise-600-lightness) var(--kern-turquoise-600-chroma) var(--kern-turquoise-600-hue));--kern-color-feedback-success-background: oklch(var(--kern-turquoise-050-lightness) var(--kern-turquoise-050-chroma) var(--kern-turquoise-050-hue));--kern-color-feedback-warning: oklch(var(--kern-orange-600-lightness) var(--kern-orange-600-chroma) var(--kern-orange-600-hue));--kern-color-feedback-warning-background: oklch(var(--kern-orange-050-lightness) var(--kern-orange-050-chroma) var(--kern-orange-050-hue));--kern-color-feedback-loader: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-feedback-loader-background: oklch(var(--kern-neutral-100-lightness) var(--kern-neutral-100-chroma) var(--kern-neutral-100-hue));--kern-color-form-input-background: oklch(var(--kern-neutral-025-lightness) var(--kern-neutral-025-chroma) var(--kern-neutral-025-hue));--kern-color-form-input-background-inverted: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue));--kern-color-form-input-border: oklch(var(--kern-neutral-900-lightness) var(--kern-neutral-900-chroma) var(--kern-neutral-900-hue));--kern-color-layout-border: oklch(var(--kern-neutral-300-lightness) var(--kern-neutral-300-chroma) var(--kern-neutral-300-hue));--kern-color-layout-text-default: oklch(var(--kern-neutral-900-lightness) var(--kern-neutral-900-chroma) var(--kern-neutral-900-hue));--kern-color-layout-text-inverse: oklch(var(--kern-neutral-025-lightness) var(--kern-neutral-025-chroma) var(--kern-neutral-025-hue));--kern-color-layout-text-muted: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-layout-background-default: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue));--kern-color-layout-background-hued: oklch(var(--kern-neutral-025-lightness) var(--kern-neutral-025-chroma) var(--kern-neutral-025-hue));--kern-color-layout-background-inverted: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue));--kern-color-layout-background-overlay: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue) / var(--kern-color-action-state-opacity-overlay));--kern-color-action-state-indicator-shade-hover: color-mix(in oklch, var(--kern-color-action-default), white calc(100% - var(--kern-color-action-state-opacity-hover)));--kern-color-action-state-indicator-shade-active: color-mix(in oklch, var(--kern-color-action-default), white calc(100% - var(--kern-color-action-state-opacity-active)));--kern-color-action-state-indicator-tint-hover-opacity: color-mix(in oklch, var(--kern-color-action-default), transparent var(--kern-color-action-state-opacity-hover));--kern-color-action-state-indicator-tint-active-opacity: color-mix(in oklch, var(--kern-color-action-default), transparent var(--kern-color-action-state-opacity-active))}}[data-kern-theme=light],.kern-light{--kern-color-action-default: oklch(var(--kern-darkblue-700-lightness) var(--kern-darkblue-700-chroma) var(--kern-darkblue-700-hue));--kern-color-action-on-default: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue));--kern-color-action-visited: oklch(var(--kern-violet-700-lightness) var(--kern-violet-700-chroma) var(--kern-violet-700-hue));--kern-color-action-focus-background: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-action-focus-border-inside: oklch(var(--kern-neutral-500-lightness) var(--kern-neutral-500-chroma) var(--kern-neutral-500-hue));--kern-color-action-focus-border-outside: oklch(var(--kern-neutral-200-lightness) var(--kern-neutral-200-chroma) var(--kern-neutral-200-hue));--kern-color-action-state-indicator-default: var(--kern-color-action-default);--kern-color-action-state-indicator-shade: var(--kern-color-layout-text-default);--kern-color-action-state-indicator-tint: var(--kern-color-action-on-default);--kern-color-action-state-opacity-hover: 92%;--kern-color-action-state-opacity-pressed: .32;--kern-color-action-state-opacity-selected: .12;--kern-color-action-state-opacity-disabled: .4;--kern-color-action-state-opacity-active: 84%;--kern-color-action-state-opacity-overlay: .72;--kern-color-feedback-danger: oklch(var(--kern-red-600-lightness) var(--kern-red-600-chroma) var(--kern-red-600-hue));--kern-color-feedback-danger-background: oklch(var(--kern-red-050-lightness) var(--kern-red-050-chroma) var(--kern-red-050-hue));--kern-color-feedback-info: oklch(var(--kern-lightblue-600-lightness) var(--kern-lightblue-600-chroma) var(--kern-lightblue-600-hue));--kern-color-feedback-info-background: oklch(var(--kern-lightblue-050-lightness) var(--kern-lightblue-050-chroma) var(--kern-lightblue-050-hue));--kern-color-feedback-success: oklch(var(--kern-turquoise-600-lightness) var(--kern-turquoise-600-chroma) var(--kern-turquoise-600-hue));--kern-color-feedback-success-background: oklch(var(--kern-turquoise-050-lightness) var(--kern-turquoise-050-chroma) var(--kern-turquoise-050-hue));--kern-color-feedback-warning: oklch(var(--kern-orange-600-lightness) var(--kern-orange-600-chroma) var(--kern-orange-600-hue));--kern-color-feedback-warning-background: oklch(var(--kern-orange-050-lightness) var(--kern-orange-050-chroma) var(--kern-orange-050-hue));--kern-color-feedback-loader: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-feedback-loader-background: oklch(var(--kern-neutral-100-lightness) var(--kern-neutral-100-chroma) var(--kern-neutral-100-hue));--kern-color-form-input-background: oklch(var(--kern-neutral-025-lightness) var(--kern-neutral-025-chroma) var(--kern-neutral-025-hue));--kern-color-form-input-background-inverted: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue));--kern-color-form-input-border: oklch(var(--kern-neutral-900-lightness) var(--kern-neutral-900-chroma) var(--kern-neutral-900-hue));--kern-color-layout-border: oklch(var(--kern-neutral-300-lightness) var(--kern-neutral-300-chroma) var(--kern-neutral-300-hue));--kern-color-layout-text-default: oklch(var(--kern-neutral-900-lightness) var(--kern-neutral-900-chroma) var(--kern-neutral-900-hue));--kern-color-layout-text-inverse: oklch(var(--kern-neutral-025-lightness) var(--kern-neutral-025-chroma) var(--kern-neutral-025-hue));--kern-color-layout-text-muted: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-layout-background-default: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue));--kern-color-layout-background-hued: oklch(var(--kern-neutral-025-lightness) var(--kern-neutral-025-chroma) var(--kern-neutral-025-hue));--kern-color-layout-background-inverted: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue));--kern-color-layout-background-overlay: oklch(var(--kern-white-lightness) var(--kern-white-chroma) var(--kern-white-hue) / var(--kern-color-action-state-opacity-overlay));--kern-color-action-state-indicator-shade-hover: color-mix(in oklch, var(--kern-color-action-default), white calc(100% - var(--kern-color-action-state-opacity-hover)));--kern-color-action-state-indicator-shade-active: color-mix(in oklch, var(--kern-color-action-default), white calc(100% - var(--kern-color-action-state-opacity-active)));--kern-color-action-state-indicator-tint-hover-opacity: color-mix(in oklch, var(--kern-color-action-default), transparent var(--kern-color-action-state-opacity-hover));--kern-color-action-state-indicator-tint-active-opacity: color-mix(in oklch, var(--kern-color-action-default), transparent var(--kern-color-action-state-opacity-active))}[data-kern-theme=dark],.kern-dark{--kern-color-action-default: oklch(var(--kern-darkblue-300-lightness) var(--kern-darkblue-300-chroma) var(--kern-darkblue-300-hue));--kern-color-action-on-default: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue));--kern-color-action-visited: oklch(var(--kern-violet-300-lightness) var(--kern-violet-300-chroma) var(--kern-violet-300-hue));--kern-color-action-focus-background: oklch(var(--kern-neutral-400-lightness) var(--kern-neutral-400-chroma) var(--kern-neutral-400-hue));--kern-color-action-focus-border-inside: oklch(var(--kern-neutral-500-lightness) var(--kern-neutral-500-chroma) var(--kern-neutral-500-hue));--kern-color-action-focus-border-outside: oklch(var(--kern-neutral-800-lightness) var(--kern-neutral-800-chroma) var(--kern-neutral-800-hue));--kern-color-action-state-indicator-default: var(--kern-color-action-default);--kern-color-action-state-indicator-shade: var(--kern-color-layout-text-default);--kern-color-action-state-indicator-tint: var(--kern-color-action-on-default);--kern-color-action-state-opacity-hover: 88%;--kern-color-action-state-opacity-pressed: .32;--kern-color-action-state-opacity-selected: .12;--kern-color-action-state-opacity-disabled: .4;--kern-color-action-state-opacity-active: 84%;--kern-color-action-state-opacity-overlay: .72;--kern-color-feedback-danger: oklch(var(--kern-red-400-lightness) var(--kern-red-400-chroma) var(--kern-red-400-hue));--kern-color-feedback-danger-background: oklch(var(--kern-red-900-lightness) var(--kern-red-900-chroma) var(--kern-red-900-hue));--kern-color-feedback-info: oklch(var(--kern-lightblue-400-lightness) var(--kern-lightblue-400-chroma) var(--kern-lightblue-400-hue));--kern-color-feedback-info-background: oklch(var(--kern-lightblue-900-lightness) var(--kern-lightblue-900-chroma) var(--kern-lightblue-900-hue));--kern-color-feedback-success: oklch(var(--kern-turquoise-400-lightness) var(--kern-turquoise-400-chroma) var(--kern-turquoise-400-hue));--kern-color-feedback-success-background: oklch(var(--kern-turquoise-900-lightness) var(--kern-turquoise-900-chroma) var(--kern-turquoise-900-hue));--kern-color-feedback-warning: oklch(var(--kern-orange-400-lightness) var(--kern-orange-400-chroma) var(--kern-orange-400-hue));--kern-color-feedback-warning-background: oklch(var(--kern-orange-900-lightness) var(--kern-orange-900-chroma) var(--kern-orange-900-hue));--kern-color-feedback-loader: oklch(var(--kern-neutral-050-lightness) var(--kern-neutral-050-chroma) var(--kern-neutral-050-hue));--kern-color-feedback-loader-background: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-form-input-background: oklch(var(--kern-neutral-900-lightness) var(--kern-neutral-900-chroma) var(--kern-neutral-900-hue));--kern-color-form-input-background-inverted: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue));--kern-color-form-input-border: oklch(var(--kern-neutral-050-lightness) var(--kern-neutral-050-chroma) var(--kern-neutral-050-hue));--kern-color-layout-border: oklch(var(--kern-neutral-700-lightness) var(--kern-neutral-700-chroma) var(--kern-neutral-700-hue));--kern-color-layout-text-default: oklch(var(--kern-neutral-050-lightness) var(--kern-neutral-050-chroma) var(--kern-neutral-050-hue));--kern-color-layout-text-inverse: oklch(var(--kern-neutral-950-lightness) var(--kern-neutral-950-chroma) var(--kern-neutral-950-hue));--kern-color-layout-text-muted: oklch(var(--kern-neutral-300-lightness) var(--kern-neutral-300-chroma) var(--kern-neutral-300-hue));--kern-color-layout-background-default: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue));--kern-color-layout-background-hued: oklch(var(--kern-neutral-950-lightness) var(--kern-neutral-950-chroma) var(--kern-neutral-950-hue));--kern-color-layout-background-inverted: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue));--kern-color-layout-background-overlay: oklch(var(--kern-black-lightness) var(--kern-black-chroma) var(--kern-black-hue) / var(--kern-color-action-state-opacity-overlay));--kern-color-action-state-indicator-shade-hover: color-mix(in oklch, var(--kern-color-action-default), black calc(100% - var(--kern-color-action-state-opacity-hover)));--kern-color-action-state-indicator-shade-active: color-mix(in oklch, var(--kern-color-action-default), black calc(100% - var(--kern-color-action-state-opacity-active)));--kern-color-action-state-indicator-tint-hover-opacity: color-mix(in oklch, var(--kern-color-action-default), transparent var(--kern-color-action-state-opacity-hover));--kern-color-action-state-indicator-tint-active-opacity: color-mix(in oklch, var(--kern-color-action-default), transparent var(--kern-color-action-state-opacity-active))}
`,zP=new CSSStyleSheet;zP.replaceSync(`@layer kern-ux-icons {
	
		.kern-icon-fill--layers {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTE1MS0zODZxLTEyLTguOTQtMTEuNS0yMy40N1QxNTIuMDgtNDMzcTguMy02IDE4LjExLTYgOS44MSAwIDE3LjgxIDZsMjkyIDIyNyAyOTItMjI3cTguMzItNiAxOC4xNi02dDE4LjA5IDUuOTdxMTIgOC45NSAxMi4zOCAyMy40OVE4MjEtMzk1IDgwOS0zODZMNTE3LTE1OXEtMTYuNSAxMy0zNi43NSAxM1Q0NDMtMTU5TDE1MS0zODZabTI5MiA3NUwxODEtNTE1cS0yMy0xNy44OC0yMy00Ni45NFQxODEtNjA5bDI2Mi0yMDRxMTYuNS0xMyAzNi43NS0xM1Q1MTctODEzbDI2MiAyMDRxMjMgMTcuODggMjMgNDYuOTRUNzc5LTUxNUw1MTctMzExcS0xNi41IDEzLTM2Ljc1IDEzVDQ0My0zMTFaIi8+PC9zdmc+");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon-fill--near-me {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQxMy00MTMgMTM3LTUyMHEtMTAtNC0xNC41LTEydC00LjUtMTdxMC05IDQuNS0xNnQxNC41LTExbDY0MS0yNDFxOS00IDE3LjUtMS41VDgxMC04MTBxNiA2IDguNSAxNC41VDgxNy03NzhMNTc2LTEzN3EtNCAxMC0xMSAxNC41dC0xNiA0LjVxLTkgMC0xNy00LjVUNTIwLTEzN0w0MTMtNDEzWiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--near-me {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQxMy00MTMgMTM3LTUyMHEtMTAtNC0xNC41LTEydC00LjUtMTdxMC05IDQuNS0xNnQxNC41LTExbDY0MS0yNDFxOS00IDE3LjUtMS41VDgxMC04MTBxNiA2IDguNSAxNC41VDgxNy03NzhMNTc2LTEzN3EtNCAxMC0xMSAxNC41dC0xNiA0LjVxLTkgMC0xNy00LjVUNTIwLTEzN0w0MTMtNDEzWm0xMzIgMTc5IDE5Mi01MDMtNTAyIDE5MiAyMjQgODYgODYgMjI1Wm0tODYtMjI1WiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--near-me-disabled {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTUyMC0xMzcgNDEzLTQxMyAxMzctNTIwcS0xMC00LTE0LjUtMTJ0LTQuNS0xN3EwLTkgNC41LTE2dDE0LjUtMTFsMjAwLTc1LTE5OC0xOThxLTktOS05LTIxLjV0OS0yMS41cTktOSAyMS41LTl0MjEuNSA5bDcxMCA3MTBxOSA5IDkgMjF0LTkgMjFxLTkgOS0yMS41IDl0LTIxLjUtOUw2NTEtMzM3bC03NSAyMDBxLTQgMTAtMTEgMTQuNXQtMTYgNC41cS05IDAtMTctNC41VDUyMC0xMzdabTI5MC02NzNxNiA2IDguNSAxNC41VDgxNy03NzhMNzE1LTUwN3EtNiAxNi0yMi41IDE5LjVUNjY0LTQ5NnEtNy03LTguNS0xNnQxLjUtMTdsODAtMjA4LTIwOCA4MHEtOCAzLTE3IDEuNXQtMTYtOC41cS0xMi0xMi04LjUtMjguNVQ1MDctNzE1bDI3MS0xMDJxOS00IDE3LjUtMS41VDgxMC04MTBaTTU0NS0yMzRsNTgtMTUxLTIxOC0yMTgtMTUwIDU4IDIyNCA4NiA4NiAyMjVabTM1LTM0NlptLTg2IDg2WiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--search {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTM3OC0zMjlxLTEwOC4xNiAwLTE4My4wOC03NVExMjAtNDc5IDEyMC01ODV0NzUtMTgxcTc1LTc1IDE4MS41LTc1dDE4MSA3NVE2MzItNjkxIDYzMi01ODQuODUgNjMyLTU0MiA2MTgtNTAycS0xNCA0MC00MiA3NWwyNDIgMjQwcTkgOC41NiA5IDIxLjc4VDgxOC0xNDNxLTkgOS0yMi4yMiA5LTEzLjIyIDAtMjEuNzgtOUw1MzMtMzg0cS0zMCAyNi02OS45NiA0MC41UTQyMy4wOC0zMjkgMzc4LTMyOVptLTEtNjBxODEuMjUgMCAxMzguMTMtNTcuNVE1NzItNTA0IDU3Mi01ODV0LTU2Ljg3LTEzOC41UTQ1OC4yNS03ODEgMzc3LTc4MXEtODIuMDggMC0xMzkuNTQgNTcuNVExODAtNjY2IDE4MC01ODV0NTcuNDYgMTM4LjVRMjk0LjkyLTM4OSAzNzctMzg5WiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--close {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQ4MC00MzggMjcwLTIyOHEtOSA5LTIxIDl0LTIxLTlxLTktOS05LTIxdDktMjFsMjEwLTIxMC0yMTAtMjEwcS05LTktOS0yMXQ5LTIxcTktOSAyMS05dDIxIDlsMjEwIDIxMCAyMTAtMjEwcTktOSAyMS05dDIxIDlxOSA5IDkgMjF0LTkgMjFMNTIyLTQ4MGwyMTAgMjEwcTkgOSA5IDIxdC05IDIxcS05IDktMjEgOXQtMjEtOUw0ODAtNDM4WiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--search {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTM3OC0zMjlxLTEwOC4xNiAwLTE4My4wOC03NVExMjAtNDc5IDEyMC01ODV0NzUtMTgxcTc1LTc1IDE4MS41LTc1dDE4MSA3NVE2MzItNjkxIDYzMi01ODQuODUgNjMyLTU0MiA2MTgtNTAycS0xNCA0MC00MiA3NWwyNDIgMjQwcTkgOC41NiA5IDIxLjc4VDgxOC0xNDNxLTkgOS0yMi4yMiA5LTEzLjIyIDAtMjEuNzgtOUw1MzMtMzg0cS0zMCAyNi02OS45NiA0MC41UTQyMy4wOC0zMjkgMzc4LTMyOVptLTEtNjBxODEuMjUgMCAxMzguMTMtNTcuNVE1NzItNTA0IDU3Mi01ODV0LTU2Ljg3LTEzOC41UTQ1OC4yNS03ODEgMzc3LTc4MXEtODIuMDggMC0xMzkuNTQgNTcuNVExODAtNjY2IDE4MC01ODV0NTcuNDYgMTM4LjVRMjk0LjkyLTM4OSAzNzctMzg5WiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--fullscreen {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTE4MC0xODBoMTAzcTEyLjc1IDAgMjEuMzggOC42OCA4LjYyIDguNjcgOC42MiAyMS41IDAgMTIuODItOC42MiAyMS4zMi04LjYzIDguNS0yMS4zOCA4LjVIMTUwcS0xMi43NSAwLTIxLjM3LTguNjNRMTIwLTEzNy4yNSAxMjAtMTUwdi0xMzNxMC0xMi43NSA4LjY4LTIxLjM4IDguNjctOC42MiAyMS41LTguNjIgMTIuODIgMCAyMS4zMiA4LjYyIDguNSA4LjYzIDguNSAyMS4zOHYxMDNabTYwMCAwdi0xMDNxMC0xMi43NSA4LjY4LTIxLjM4IDguNjctOC42MiAyMS41LTguNjIgMTIuODIgMCAyMS4zMiA4LjYyIDguNSA4LjYzIDguNSAyMS4zOHYxMzNxMCAxMi43NS04LjYyIDIxLjM3UTgyMi43NS0xMjAgODEwLTEyMEg2NzdxLTEyLjc1IDAtMjEuMzctOC42OC04LjYzLTguNjctOC42My0yMS41IDAtMTIuODIgOC42My0yMS4zMiA4LjYyLTguNSAyMS4zNy04LjVoMTAzWk0xODAtNzgwdjEwM3EwIDEyLjc1LTguNjggMjEuMzctOC42NyA4LjYzLTIxLjUgOC42My0xMi44MiAwLTIxLjMyLTguNjMtOC41LTguNjItOC41LTIxLjM3di0xMzNxMC0xMi43NSA4LjYzLTIxLjM4UTEzNy4yNS04NDAgMTUwLTg0MGgxMzNxMTIuNzUgMCAyMS4zOCA4LjY4IDguNjIgOC42NyA4LjYyIDIxLjUgMCAxMi44Mi04LjYyIDIxLjMyLTguNjMgOC41LTIxLjM4IDguNUgxODBabTYwMCAwSDY3N3EtMTIuNzUgMC0yMS4zNy04LjY4LTguNjMtOC42Ny04LjYzLTIxLjUgMC0xMi44MiA4LjYzLTIxLjMyIDguNjItOC41IDIxLjM3LTguNWgxMzNxMTIuNzUgMCAyMS4zOCA4LjYyUTg0MC04MjIuNzUgODQwLTgxMHYxMzNxMCAxMi43NS04LjY4IDIxLjM3LTguNjcgOC42My0yMS41IDguNjMtMTIuODIgMC0yMS4zMi04LjYzLTguNS04LjYyLTguNS0yMS4zN3YtMTAzWiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon-fill--draw {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTE5MC0xMjBxLTEzIDAtMjEuNS04LjVUMTYwLTE1MHYtNzNxMC0xMiA1LTIzLjV0MTMtMTkuNWw1NTMtNTUzcTExLTExIDIyLjUtMTZ0MjQuNS01cTEyIDAgMjMuNSA1dDIyLjUgMTZsMzUgMzVxMTEgMTAgMTYgMjEuNXQ1IDI0LjVxMCAxMi01IDI0dC0xNiAyM0wzMDYtMTM4cS04IDgtMTkuNSAxM3QtMjMuNSA1aC03M1ptNTYzLTU0OSA2OC02OC00NC00NC02OCA2OCA0NCA0NFpNNTYwLTEyMHE3OCAwIDEzOS0zNi41VDc2MC0yNjBxMC0zNi0yNC02NnQtNzQtNTJxLTExLTUtMjMuNS00VDYxOS0zNzBxLTcgMTEtNC41IDI0dDEzLjUgMThxMzMgMTUgNTIuNSAzMi41VDcwMC0yNjBxMCAzMi00MC41IDU2VDU2MC0xODBxLTEyIDAtMjEgOC41dC05IDIxLjVxMCAxMiA5IDIxdDIxIDlaTTM3MC03MTlxMCAyMC0xOSAzNXQtODUgMzlxLTk0IDM0LTEyMCA2MnQtMjYgNjNxMCAzOCAyNyA2MXQ2MCAzNXExMiA1IDIzLS41dDE1LTE3LjVxNC0xMi0xLTIyLjVUMjI3LTQ4MHEtMjMtOS0zNS0xOXQtMTItMjFxMC0xNiAyMS41LTMwLjVUMjkwLTU5MHE4My0zMSAxMTEuNS01OS41VDQzMC03MTlxMC01Ni00MS04OC41VDI4MC04NDBxLTQyIDAtNzYgMTQuNVQxNTMtNzg5cS04IDktNy41IDIxdDExLjUgMjBxMTAgOCAyMi41IDYuNVQyMDAtNzUxcTE1LTE1IDM0LTIydDQ2LTdxNDYgMCA2OCAxOHQyMiA0M1oiLz48L3N2Zz4=");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--fullscreen-exit {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTI1My0yNTNIMTUwcS0xMi43NSAwLTIxLjM3LTguNjgtOC42My04LjY3LTguNjMtMjEuNSAwLTEyLjgyIDguNjMtMjEuMzIgOC42Mi04LjUgMjEuMzctOC41aDEzM3ExMi43NSAwIDIxLjM4IDguNjJRMzEzLTI5NS43NSAzMTMtMjgzdjEzM3EwIDEyLjc1LTguNjggMjEuMzctOC42NyA4LjYzLTIxLjUgOC42My0xMi44MiAwLTIxLjMyLTguNjMtOC41LTguNjItOC41LTIxLjM3di0xMDNabTQ1NCAwdjEwM3EwIDEyLjc1LTguNjggMjEuMzctOC42NyA4LjYzLTIxLjUgOC42My0xMi44MiAwLTIxLjMyLTguNjMtOC41LTguNjItOC41LTIxLjM3di0xMzNxMC0xMi43NSA4LjYzLTIxLjM4UTY2NC4yNS0zMTMgNjc3LTMxM2gxMzNxMTIuNzUgMCAyMS4zOCA4LjY4IDguNjIgOC42NyA4LjYyIDIxLjUgMCAxMi44Mi04LjYyIDIxLjMyLTguNjMgOC41LTIxLjM4IDguNUg3MDdaTTI1My03MDd2LTEwM3EwLTEyLjc1IDguNjgtMjEuMzggOC42Ny04LjYyIDIxLjUtOC42MiAxMi44MiAwIDIxLjMyIDguNjIgOC41IDguNjMgOC41IDIxLjM4djEzM3EwIDEyLjc1LTguNjIgMjEuMzdRMjk1Ljc1LTY0NyAyODMtNjQ3SDE1MHEtMTIuNzUgMC0yMS4zNy04LjY4LTguNjMtOC42Ny04LjYzLTIxLjUgMC0xMi44MiA4LjYzLTIxLjMyIDguNjItOC41IDIxLjM3LTguNWgxMDNabTQ1NCAwaDEwM3ExMi43NSAwIDIxLjM4IDguNjggOC42MiA4LjY3IDguNjIgMjEuNSAwIDEyLjgyLTguNjIgMjEuMzItOC42MyA4LjUtMjEuMzggOC41SDY3N3EtMTIuNzUgMC0yMS4zNy04LjYzUTY0Ny02NjQuMjUgNjQ3LTY3N3YtMTMzcTAtMTIuNzUgOC42OC0yMS4zOCA4LjY3LTguNjIgMjEuNS04LjYyIDEyLjgyIDAgMjEuMzIgOC42MiA4LjUgOC42MyA4LjUgMjEuMzh2MTAzWiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--fullscreen {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTE4MC0xODBoMTAzcTEyLjc1IDAgMjEuMzggOC42OCA4LjYyIDguNjcgOC42MiAyMS41IDAgMTIuODItOC42MiAyMS4zMi04LjYzIDguNS0yMS4zOCA4LjVIMTUwcS0xMi43NSAwLTIxLjM3LTguNjNRMTIwLTEzNy4yNSAxMjAtMTUwdi0xMzNxMC0xMi43NSA4LjY4LTIxLjM4IDguNjctOC42MiAyMS41LTguNjIgMTIuODIgMCAyMS4zMiA4LjYyIDguNSA4LjYzIDguNSAyMS4zOHYxMDNabTYwMCAwdi0xMDNxMC0xMi43NSA4LjY4LTIxLjM4IDguNjctOC42MiAyMS41LTguNjIgMTIuODIgMCAyMS4zMiA4LjYyIDguNSA4LjYzIDguNSAyMS4zOHYxMzNxMCAxMi43NS04LjYyIDIxLjM3UTgyMi43NS0xMjAgODEwLTEyMEg2NzdxLTEyLjc1IDAtMjEuMzctOC42OC04LjYzLTguNjctOC42My0yMS41IDAtMTIuODIgOC42My0yMS4zMiA4LjYyLTguNSAyMS4zNy04LjVoMTAzWk0xODAtNzgwdjEwM3EwIDEyLjc1LTguNjggMjEuMzctOC42NyA4LjYzLTIxLjUgOC42My0xMi44MiAwLTIxLjMyLTguNjMtOC41LTguNjItOC41LTIxLjM3di0xMzNxMC0xMi43NSA4LjYzLTIxLjM4UTEzNy4yNS04NDAgMTUwLTg0MGgxMzNxMTIuNzUgMCAyMS4zOCA4LjY4IDguNjIgOC42NyA4LjYyIDIxLjUgMCAxMi44Mi04LjYyIDIxLjMyLTguNjMgOC41LTIxLjM4IDguNUgxODBabTYwMCAwSDY3N3EtMTIuNzUgMC0yMS4zNy04LjY4LTguNjMtOC42Ny04LjYzLTIxLjUgMC0xMi44MiA4LjYzLTIxLjMyIDguNjItOC41IDIxLjM3LTguNWgxMzNxMTIuNzUgMCAyMS4zOCA4LjYyUTg0MC04MjIuNzUgODQwLTgxMHYxMzNxMCAxMi43NS04LjY4IDIxLjM3LTguNjcgOC42My0yMS41IDguNjMtMTIuODIgMC0yMS4zMi04LjYzLTguNS04LjYyLTguNS0yMS4zN3YtMTAzWiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--close {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQ4MC00MzggMjcwLTIyOHEtOSA5LTIxIDl0LTIxLTlxLTktOS05LTIxdDktMjFsMjEwLTIxMC0yMTAtMjEwcS05LTktOS0yMXQ5LTIxcTktOSAyMS05dDIxIDlsMjEwIDIxMCAyMTAtMjEwcTktOSAyMS05dDIxIDlxOSA5IDkgMjF0LTkgMjFMNTIyLTQ4MGwyMTAgMjEwcTkgOSA5IDIxdC05IDIxcS05IDktMjEgOXQtMjEtOUw0ODAtNDM4WiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--close {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQ4MC00MzggMjcwLTIyOHEtOSA5LTIxIDl0LTIxLTlxLTktOS05LTIxdDktMjFsMjEwLTIxMC0yMTAtMjEwcS05LTktOS0yMXQ5LTIxcTktOSAyMS05dDIxIDlsMjEwIDIxMCAyMTAtMjEwcTktOSAyMS05dDIxIDlxOSA5IDkgMjF0LTkgMjFMNTIyLTQ4MGwyMTAgMjEwcTkgOSA5IDIxdC05IDIxcS05IDktMjEgOXQtMjEtOUw0ODAtNDM4WiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon-fill--settings {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQyMS04MHEtMTQgMC0yNS05dC0xMy0yM2wtMTUtOTRxLTE5LTctNDAtMTl0LTM3LTI1bC04NiA0MHEtMTQgNi0yOCAxLjVUMTU1LTIyNkw5Ny0zMzBxLTgtMTMtNC41LTI3dDE1LjUtMjNsODAtNTlxLTItOS0yLjUtMjAuNVQxODUtNDgwcTAtOSAuNS0yMC41VDE4OC01MjFsLTgwLTU5cS0xMi05LTE1LjUtMjN0NC41LTI3bDU4LTEwNHE4LTEzIDIyLTE3LjV0MjggMS41bDg2IDQwcTE2LTEzIDM3LTI1dDQwLTE4bDE1LTk1cTItMTQgMTMtMjN0MjUtOWgxMThxMTQgMCAyNSA5dDEzIDIzbDE1IDk0cTE5IDcgNDAuNSAxOC41VDY2OS03MTBsODYtNDBxMTQtNiAyNy41LTEuNVQ4MDQtNzM0bDU5IDEwNHE4IDEzIDQuNSAyNy41VDg1Mi01ODBsLTgwIDU3cTIgMTAgMi41IDIxLjV0LjUgMjEuNXEwIDEwLS41IDIxdC0yLjUgMjFsODAgNThxMTIgOCAxNS41IDIyLjVUODYzLTMzMGwtNTggMTA0cS04IDEzLTIyIDE3LjV0LTI4LTEuNWwtODYtNDBxLTE2IDEzLTM2LjUgMjUuNVQ1OTItMjA2bC0xNSA5NHEtMiAxNC0xMyAyM3QtMjUgOUg0MjFabTU5LTI3MHE1NCAwIDkyLTM4dDM4LTkycTAtNTQtMzgtOTJ0LTkyLTM4cS01NCAwLTkyIDM4dC0zOCA5MnEwIDU0IDM4IDkydDkyIDM4WiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--drag-handle {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTE5MC0zOTBxLTEyLjc1IDAtMjEuMzctOC42OC04LjYzLTguNjctOC42My0yMS41IDAtMTIuODIgOC42My0yMS4zMiA4LjYyLTguNSAyMS4zNy04LjVoNTgwcTEyLjc1IDAgMjEuMzggOC42OCA4LjYyIDguNjcgOC42MiAyMS41IDAgMTIuODItOC42MiAyMS4zMi04LjYzIDguNS0yMS4zOCA4LjVIMTkwWm0wLTEyMHEtMTIuNzUgMC0yMS4zNy04LjY4LTguNjMtOC42Ny04LjYzLTIxLjUgMC0xMi44MiA4LjYzLTIxLjMyIDguNjItOC41IDIxLjM3LTguNWg1ODBxMTIuNzUgMCAyMS4zOCA4LjY4IDguNjIgOC42NyA4LjYyIDIxLjUgMCAxMi44Mi04LjYyIDIxLjMyLTguNjMgOC41LTIxLjM4IDguNUgxOTBaIi8+PC9zdmc+");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--close {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQ4MC00MzggMjcwLTIyOHEtOSA5LTIxIDl0LTIxLTlxLTktOS05LTIxdDktMjFsMjEwLTIxMC0yMTAtMjEwcS05LTktOS0yMXQ5LTIxcTktOSAyMS05dDIxIDlsMjEwIDIxMCAyMTAtMjEwcTktOSAyMS05dDIxIDlxOSA5IDkgMjF0LTkgMjFMNTIyLTQ4MGwyMTAgMjEwcTkgOSA5IDIxdC05IDIxcS05IDktMjEgOXQtMjEtOUw0ODAtNDM4WiIvPjwvc3ZnPg==");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--keyboard-arrow-up {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQ4MC01NTQgMzA0LTM3OHEtOSA5LTIxIDguNXQtMjEtOS41cS05LTktOS0yMS41dDktMjEuNWwxOTctMTk3cTktOSAyMS05dDIxIDlsMTk4IDE5OHE5IDkgOSAyMXQtOSAyMXEtOSA5LTIxLjUgOXQtMjEuNS05TDQ4MC01NTRaIi8+PC9zdmc+");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--keyboard-arrow-down {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQ4MC0zNTZxLTYgMC0xMS0ydC0xMC03TDI2MS01NjNxLTktOS04LjUtMjEuNVQyNjItNjA2cTktOSAyMS41LTl0MjEuNSA5bDE3NSAxNzYgMTc2LTE3NnE5LTkgMjEtOC41dDIxIDkuNXE5IDkgOSAyMS41dC05IDIxLjVMNTAxLTM2NXEtNSA1LTEwIDd0LTExIDJaIi8+PC9zdmc+");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--arrow-back {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0ibTI3NC00NTAgMjI3IDIyN3E5IDkgOSAyMXQtOSAyMXEtOSA5LTIxIDl0LTIxLTlMMTgxLTQ1OXEtNS01LTctMTB0LTItMTFxMC02IDItMTF0Ny0xMGwyNzgtMjc4cTktOSAyMS05dDIxIDlxOSA5IDkgMjF0LTkgMjFMMjc0LTUxMGg0OTZxMTMgMCAyMS41IDguNVQ4MDAtNDgwcTAgMTMtOC41IDIxLjVUNzcwLTQ1MEgyNzRaIi8+PC9zdmc+");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	

		.kern-icon--info {
			mask: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIiIGhlaWdodD0iIiB2aWV3Qm94PSIwIC05NjAgOTYwIDk2MCI+PHBhdGggZD0iTTQ4My4xOC0yODBxMTIuODIgMCAyMS4zMi04LjYzIDguNS04LjYyIDguNS0yMS4zN3YtMTgwcTAtMTIuNzUtOC42OC0yMS4zOC04LjY3LTguNjItMjEuNS04LjYyLTEyLjgyIDAtMjEuMzIgOC42Mi04LjUgOC42My04LjUgMjEuMzh2MTgwcTAgMTIuNzUgOC42OCAyMS4zNyA4LjY3IDguNjMgMjEuNSA4LjYzWm0tMy4yLTMxNHExNC4wMiAwIDIzLjUyLTkuMlQ1MTMtNjI2cTAtMTQuNDUtOS40OC0yNC4yMi05LjQ4LTkuNzgtMjMuNS05Ljc4dC0yMy41MiA5Ljc4UTQ0Ny02NDAuNDUgNDQ3LTYyNnEwIDEzLjYgOS40OCAyMi44IDkuNDggOS4yIDIzLjUgOS4yWm0uMjkgNTE0cS04Mi43NCAwLTE1NS41LTMxLjVRMjUyLTE0MyAxOTcuNS0xOTcuNXQtODYtMTI3LjM0UTgwLTM5Ny42OCA4MC00ODAuNXQzMS41LTE1NS42NlExNDMtNzA5IDE5Ny41LTc2M3QxMjcuMzQtODUuNVEzOTcuNjgtODgwIDQ4MC41LTg4MHQxNTUuNjYgMzEuNVE3MDktODE3IDc2My03NjN0ODUuNSAxMjdRODgwLTU2MyA4ODAtNDgwLjI3cTAgODIuNzQtMzEuNSAxNTUuNVE4MTctMjUyIDc2My0xOTcuNjhxLTU0IDU0LjMxLTEyNyA4NlE1NjMtODAgNDgwLjI3LTgwWm0uMjMtNjBRNjIyLTE0MCA3MjEtMjM5LjV0OTktMjQxUTgyMC02MjIgNzIxLjE5LTcyMVQ0ODAtODIwcS0xNDEgMC0yNDAuNSA5OC44MVQxNDAtNDgwcTAgMTQxIDk5LjUgMjQwLjV0MjQxIDk5LjVabS0uNS0zNDBaIi8+PC9zdmc+");
			background-color: var(--kern-color-layout-text-default, #171a2b);
		}
	
}`);function qP(r,t=[]){return Object.entries(r).flatMap(([e,i])=>{const n=[...t,e.replace(/[A-Z]/g,s=>"-"+s.toLowerCase())];return typeof i=="string"?[[`kern-${n.join("-")}`,i]]:qP(i,n)})}function dZ(r){const t=new CSSStyleSheet,e=qP(r);return t.replaceSync(`
		@layer kern-ux-theme {
			:host {
				${e.map(([i,n])=>`--${i}: ${n} !important;`).join(`
`)}
			}
		}
	`),t}function gZ(r,t={}){r.adoptedStyleSheets.push(zP);const e=new CSSStyleSheet;e.replaceSync(`
		@layer kern-ux {
			${uZ.replaceAll(":root",":host")}
		}
	`),r.adoptedStyleSheets.push(e),typeof t.typography?.font?.family?.default<"u"&&Promise.resolve({});const i=dZ(t);r.adoptedStyleSheets.push(i)}const fZ=r=>({...r,layers:r.layers.map(t=>typeof t.minZoom<"u"?{...t,minZoom:t.minZoom-1}:t)}),pZ={class:"kern-label kern-sr-only"},r5=.1,mZ=je({__name:"MoveHandle.ce",setup(r){let t=0,e=0,i=null,n=!1;const s=ar(),o=PM(),{deviceIsHorizontal:a}=yr(s),{actionButton:l,closeLabel:c,closeIcon:h,component:u,top:d}=yr(o),g=_u("handleElement"),f=me(!1),p=me(Number.MAX_SAFE_INTEGER),m=Ct(()=>n?{move:"touchmove",end:"touchend"}:{move:"mousemove",end:"mouseup"});zc(()=>{const{clientHeight:N}=s.shadowRoot.host;d.value===null&&(d.value=N*.55);const P=g.value;P.style.position="fixed",P.style.width="100%",P.style["z-index"]=1,P.style.left="0",P.style.top=`${_(d.value,N,p.value)}px`,i=new ResizeObserver(F),i.observe(P),P.focus(),F()}),t1(()=>{i!==null&&(i.disconnect(),i=null),d.value=null}),Zr(a,N=>{N||F()}),Zr(f,N=>{const{move:P,end:T}=m.value;if(N){g.value.classList.add("polar-move-handle-is-moving"),document.addEventListener(P,w),document.addEventListener(T,b,{once:!0});return}g.value.classList.remove("polar-move-handle-is-moving"),document.removeEventListener(P,w),document.removeEventListener(T,b)}),Zr(p,(N,P)=>{N<P&&(S(),R(0))});function y(N){o.closeFunction(N),o.$reset()}function _(N,P,T){let D=N;return P-D<P*r5&&(D=P-P*r5),P-D>P*T&&(D=P-P*T),d.value=D,D}function x(N){(N==="ArrowUp"||N==="ArrowDown")&&(S(),R(N==="ArrowUp"?-5:5))}function v(N){n=!1,I(N)}function w(N){const P=N instanceof MouseEvent?N.clientX:N.touches[0].clientX,T=N instanceof MouseEvent?N.clientY:N.touches[0].clientY,D=T-t;(P<0||P>window.innerWidth||T<0||T>window.innerHeight)&&(f.value=!1),R(D)}function b(){f.value=!1}function E(N){n=!0,I(N)}function C(N){t=N instanceof MouseEvent?N.clientY:N.touches[0].clientY}function S(){e=g.value.offsetTop}function R(N){g.value.style.top=`${_(Math.round(e+N),s.shadowRoot.host.clientHeight,p.value)}px`}function I(N){C(N),S(),f.value=!0}function F(){p.value=g.value.clientHeight/s.shadowRoot.host.clientHeight}return(N,P)=>(ht(),Gt("div",{id:"polar-move-handle",ref_key:"handleElement",ref:g,tabindex:"0",onKeydown:P[1]||(P[1]=Ys(T=>x(T.key),["stop"])),onMousedown:Ys(v,["stop"]),onTouchstart:Ys(E,["stop"])},[P[2]||(P[2]=Yt("span",{class:"kern-icon kern-icon--drag-handle","aria-hidden":"true"},null,-1)),Yt("div",{class:mr(["polar-move-handle-actions",{"polar-move-handle-has-action-button":nt(l)!==null}])},[nt(l)?(ht(),Ee(yn(nt(l)),{key:0})):xr("",!0),Yt("button",{class:"kern-btn kern-btn--tertiary",onClick:P[0]||(P[0]=T=>y(!0))},[Yt("span",{class:mr(`kern-icon ${nt(h)}`),"aria-hidden":"true"},null,2),Yt("span",pZ,nr(nt(c)),1)])],2),(ht(),Ee(yn(nt(u))))],544))}}),yZ="#polar-move-handle{&[data-v-e0291d1d]{position:static;height:auto;width:auto;display:flex;flex-direction:column;align-items:center;background:var(--kern-color-layout-background-default);cursor:ns-resize;box-shadow:#0000004d 0 19px 38px,#00000038 0 15px 12px}&[data-v-e0291d1d]:focus{outline:solid var(--kern-color-action-default)}}.polar-move-handle-actions[data-v-e0291d1d]{display:flex;justify-content:flex-end;width:100%;padding:0 var(--kern-metric-space-small)}.polar-move-handle-has-action-button[data-v-e0291d1d]{justify-content:space-between}.polar-move-handle-is-moving[data-v-e0291d1d]{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none!important;user-select:none}[data-v-e0291d1d] .kern-card{box-shadow:none!important;width:100%;border:none}",_Z=gr(mZ,[["styles",[yZ]],["__scopeId","data-v-e0291d1d"]]),fn={ADD:"add",REMOVE:"remove"},i5={LENGTH:"length"};class Np extends Eo{constructor(t,e,i){super(t),this.element=e,this.index=i}}class es extends So{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t??[],this.unique_)for(let i=1,n=this.array_.length;i<n;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(i5.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Np(fn.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Np(fn.REMOVE,e,t)),e}setAt(t,e){const i=this.getLength();if(t>=i){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Np(fn.REMOVE,n,t)),this.dispatchEvent(new Np(fn.ADD,e,t))}updateLength_(){this.set(i5.LENGTH,this.array_.length)}assertUnique_(t,e){const i=this.array_;for(let n=0,s=i.length;n<s;++n)if(i[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}}class ed extends So{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new ed(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(or(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=Se(t,Bt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?vZ(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function vZ(r){if(typeof r=="function")return r;let t;return Array.isArray(r)?t=r:(_e(typeof r.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[r]),function(){return t}}function Ek(r,t){const e=(""+r).split("."),i=(""+t).split(".");for(let n=0;n<Math.max(e.length,i.length);n++){const s=parseInt(e[n]||"0",10),o=parseInt(i[n]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}let Nu=class y2 extends Wc{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){en(this.flatCoordinates,t),this.changed()}clone(){const t=new y2(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Uc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Bw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ww(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return LR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,px(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Xa(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return U0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Jw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=v1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new y2(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return x1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_1(this.flatCoordinates,0,t,this.stride),this.changed()}},xZ=!1;function BP(r,t,e,i,n,s,o){const a=new XMLHttpRequest;a.open("GET",typeof r=="function"?r(e,i,n):r,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=xZ,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=t.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?s(t.readFeatures(h,{extent:e,featureProjection:n}),t.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function n5(r,t){return function(e,i,n,s,o){BP(r,t,e,i,n,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function wZ(r,t){return[[-1/0,-1/0,1/0,1/0]]}function cg(r,t){return[r]}class km extends qw{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(or),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(Se(t[e],Bt.CHANGE,this.changed,this))}clone(){const t=new km(W_(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Uc(this.getExtent(),t,e))return n;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)n=s[o].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,s=i.length;n<s;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){Hu(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)dR(t,e[i].getExtent());return t}getGeometries(){return W_(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(n=!0)}return n?new km(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let n=0,s=i.length;n<s;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=Ns(this.getExtent()));const n=this.geometries_;for(let s=0,o=n.length;s<o;++s)n[s].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(W_(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,s=i.length;n<s;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function W_(r){return r.map(t=>t.clone())}class Dc extends Wc{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const n=t,s=[],o=[];for(let l=0,c=n.length;l<c;++l){const h=n[l];en(s,h.getFlatCoordinates()),o.push(s.length)}const a=n.length===0?this.getLayout():n[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(t){en(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Dc(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Uc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Uw(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Vw(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,zN(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return Og(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new Nu(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=new Nu(t.slice(s,l),i);n.push(c),s=l}return n}getLength(){const t=this.ends_;let e=0,i=0;for(let n=0,s=t.length;n<s;++n)i+=Jw(this.flatCoordinates,e,t[n],this.stride),e=t[n];return i}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,s=this.stride;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=U0(e,i,l,s,.5);en(t,c),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=IR(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new Dc(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return $N(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Of(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class rd extends Wc{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){en(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new rd(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Uc(this.getExtent(),t,e))return n;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=hc(t,e,s[a],s[a+1]);if(c<n){n=c;for(let h=0;h<o;++h)i[h]=s[a+h];i.length=o}}return n}getCoordinates(){return Xa(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new xl(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let s=0,o=t.length;s<o;s+=i){const a=new xl(t.slice(s,s+i),e);n.push(a)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,s=e.length;n<s;n+=i){const o=e[n],a=e[n+1];if(Rw(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_1(this.flatCoordinates,0,t,this.stride),this.changed()}}class $c extends Wc{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,s=[],o=[];for(let a=0,l=n.length;a<l;++a){const c=n[a],h=s.length,u=c.getEnds();for(let d=0,g=u.length;d<g;++d)u[d]+=h;en(s,c.getFlatCoordinates()),o.push(u)}e=n.length===0?this.getLayout():n[0].getLayout(),t=s,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;en(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let n=0,s=e.length;n<s;++n)e[n]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let n=0;n<t;++n)e[n]=this.endss_[n].slice();const i=new $c(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<Uc(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(PN(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),AN(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return DN(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return IN(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),gx(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,hx(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=QR(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=AR(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new rd(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;NR(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=gx(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=FN(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new $c(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(e!==0)for(let s=0,o=i.length;s<o;++s)i[s]-=e;return new ia(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),c=l[l.length-1];if(s!==0)for(let u=0,d=l.length;u<d;++u)l[u]-=s;const h=new ia(e.slice(s,c),t,l);n.push(h),s=c}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return GN(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=RR(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const n=i[i.length-1];this.flatCoordinates.length=n.length===0?0:n[n.length-1]}this.changed()}}class s5{constructor(t){this.rbush_=new h1(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Rt(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,s=e.length;n<s;n++){const o=t[n],a=e[n],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[n]=l,this.items_[Rt(a)]=l}this.rbush_.load(i)}remove(t){const e=Rt(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[Rt(e)],n=[i.minX,i.minY,i.maxX,i.maxY];vl(n,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(i){return i.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,s=t.length;n<s;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return _l(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return Fs(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class Sk extends So{constructor(t){super(),this.projection=Wt(t.projection),this.attributions_=o5(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,n){e.viewResolver=i,e.viewRejector=n})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=o5(t),this.changed()}setState(t){this.state_=t,this.changed()}}function o5(r){return r?typeof r=="function"?r:(Array.isArray(r)||(r=[r]),t=>r):null}let Ia=class extends Eo{constructor(t,e,i){super(t),this.feature=e,this.features=i}};class UP extends Sk{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Ig,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(_e(this.format_,"`format` must be set when `url` is set"),this.loader_=n5(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:wZ;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new s5:null,this.loadedExtentsRtree_=new s5,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,n;Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),!e&&i===void 0&&(i=new es(n)),n!==void 0&&this.addFeaturesInternal(n),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=Rt(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Ia(Ni.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof Pn||(this.featureChangeKeys_[t]=[Se(e,Bt.CHANGE,this.handleFeatureChange_,this),Se(e,Su.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const n=String(e.getId());if(!(n in this.idIndex_))this.idIndex_[n]=e;else if(e instanceof Pn){const s=this.idIndex_[n];s instanceof Pn?Array.isArray(s)?s.push(e):this.idIndex_[n]=[s,e]:i=!1}else i=!1}return i&&(_e(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=Rt(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=Rt(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();e.push(h),n.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(Ni.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Ia(Ni.ADDFEATURE,i[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(Ni.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(Ni.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(fn.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(fn.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(or);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Ia(Ni.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(n){const s=n.getGeometry();if(s instanceof Pn||s.intersectsCoordinate(t))return e(n)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const n=i.getGeometry();if(n instanceof Pn||n.intersectsExtent(t)){const s=e(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),_l(this.nullGeometryFeatures_)||en(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=mR(t,e);return[].concat(...i.map(n=>this.featuresRtree_.getInExtent(n)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||Rg,this.featuresRtree_.forEachInExtent(l,function(c){if(e(c)){const h=c.getGeometry(),u=a;if(a=h instanceof Pn?0:h.closestPointXY(i,n,o,a),a<u){s=c;const d=Math.sqrt(a);l[0]=i-d,l[1]=n-d,l[2]=i+d,l[3]=n+d}}}),s}getExtent(t){return this.featuresRtree_?.getExtent(t)??null}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=Rt(e),n=e.getGeometry();if(!n)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const s=e.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Ia(Ni.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:Rt(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&_l(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,s=this.strategy_(t,e,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];n.forEachInExtent(l,function(c){return ro(c.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Ia(Ni.FEATURESLOADSTART)),this.loader_.call(this,l,e,i,c=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ia(Ni.FEATURESLOADEND,void 0,c))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ia(Ni.FEATURESLOADERROR))}),n.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_,i=e.forEachInExtent(t,function(n){if(vl(n.extent,t))return n});i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,n=t.length;i<n;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){t&&this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=Rt(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.featureChangeKeys_[e]?.forEach(or),delete this.featureChangeKeys_[e];const i=t.getId();if(i!==void 0){const n=i.toString(),s=this.idIndex_[n];s===t?delete this.idIndex_[n]:Array.isArray(s)&&(s.splice(s.indexOf(t),1),s.length===1&&(this.idIndex_[n]=s[0]))}return delete this.uidIndex_[e],this.hasListener(Ni.REMOVEFEATURE)&&this.dispatchEvent(new Ia(Ni.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){_e(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(n5(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}}class bZ extends lb{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipExtent_=null,this.extendX_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=sn(),this.wrappedRenderedExtent_=sn(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,s=e.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),u=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),g=e.pixelRatio,f=e.viewHints,p=!(f[ur.ANIMATING]||f[ur.INTERACTING]),m=this.context,y=Math.round(Te(n)/a*g),_=Math.round(ti(n)/a*g),x=u.getWrapX()&&l.canWrapX(),v=x?Te(h):null,w=x?Math.ceil((n[2]-h[2])/v)+(this.extendX_?2:1):1;let b=x?Math.floor((n[0]-h[0])/v)-(this.extendX_?1:0):0;do{let E=this.getRenderTransform(o,a,0,g,y,_,b*v);e.declutter&&(E=E.slice(0)),t.execute(m,[m.canvas.width,m.canvas.height],E,c,p,i===void 0?Wl:i?Y0:zD,i?d&&e.declutter[d]:void 0)}while(++b<w)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Hr(this.context.canvas.width,this.context.canvas.height,pT))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Ff(this.context),pT.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.clipExtent_&&this.clipUnrotated(this.context,t,this.clipExtent_),this.replayGroup_.renderDeferred(),this.clipExtent_&&(this.context.restore(),this.clipExtent_=null),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const n=t.viewState;this.prepareContainer(t,e);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(yi.PRERENDER)||this.getLayer().hasListener(yi.POSTRENDER)))return this.container;this.setDrawContext_(),this.preRender(s,t),n.projection,this.clipExtent_=null;let l=!1;if(a&&i.extent&&this.clipping){const c=Ms(i.extent);a=zr(c,t.extent),a&&!ro(c,t.extent)&&(t.declutter?this.clipExtent_=c:(this.clipUnrotated(s,t,c),l=!0))}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),l&&s.restore(),this.postRender(s,t),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),n=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],u=i[0]*On,d=i[1]*On;h.push(this.getRenderTransform(n,s,o,On,u,d,0).slice());const g=c.getSource(),f=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!ro(f,l)){let p=l[0];const m=Te(f);let y=0,_;for(;p<f[0];)--y,_=m*y,h.push(this.getRenderTransform(n,s,o,On,u,d,_).slice()),p+=m;for(y=0,p=l[2];p>f[2];)++y,_=m*y,h.push(this.getRenderTransform(n,s,o,On,u,d,_).slice()),p-=m}this.hitDetectionImageData_=g4(i,h,this.renderedFeatures_,c.getStyleFunction(),l,s,o,vx(s,this.renderedPixelRatio_),null)}e(f4(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,n,s){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),c={},h=function(d,g,f){const p=Rt(d),m=c[p];if(m){if(m!==!0&&f<m.distanceSq){if(f===0)return c[p]=!0,s.splice(s.lastIndexOf(m),1),n(d,l,g);m.geometry=g,m.distanceSq=f}}else{if(f===0)return c[p]=!0,n(d,l,g);s.push(c[p]={feature:d,layer:l,geometry:g,distanceSq:f,callback:n})}},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,i,h,u?e.declutter?.[u]?.all().map(d=>d.value):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[ur.ANIMATING],s=t.viewHints[ur.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&n||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,c=t.viewState,h=c.projection,u=c.resolution,d=t.pixelRatio,g=e.getRevision(),f=e.getRenderBuffer();let p=e.getRenderOrder();p===void 0&&(p=_D);const m=c.center.slice(),y=ns(l,f*u),_=y.slice(),x=[y.slice()],v=h.getExtent(),w=i.getWrapX()&&h.canWrapX();if(this.extendX_=!1,w){const T=i.getExtent();T&&!fa(T)&&(this.extendX_=T[0]<v[0]||T[2]>v[2])}if(w&&(!ro(v,t.extent)||this.extendX_)){const T=Te(v),D=Math.max(Te(y)/2,T);let A=v[0],$=v[2];this.extendX_&&(A-=T,$+=T),y[0]=A-D,y[2]=$+D,Ow(m,h);const z=pR(x[0],h);z[0]<v[0]&&z[2]<v[2]?x.push([z[0]+T,z[1],z[2]+T,z[3]]):z[0]>v[0]&&z[2]>v[2]&&x.push([z[0]-T,z[1],z[2]-T,z[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedPixelRatio_===d&&this.renderedRevision_==g&&this.renderedRenderOrder_==p&&this.renderedFrameDeclutter_===!!t.declutter&&ro(this.wrappedRenderedExtent_,y))return ga(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const b=new l4(XR(u,d),y,u,d);let E;for(let T=0,D=x.length;T<D;++T)i.loadFeatures(x[T],u,h);const C=vx(u,d);let S=!0;const R=((T,D)=>{let A;const $=T.getStyleFunction()||e.getStyleFunction();if($&&(A=$(T,u)),A){const z=this.renderFeature(T,C,A,b,E,this.getLayer().getDeclutter(),D);S=S&&!z}}),I=jw(y),F=i.getFeaturesInExtent(I);p&&F.sort(p);for(let T=0,D=F.length;T<D;++T)R(F[T],T);this.renderedFeatures_=F,this.ready=S;const N=b.finish(),P=new u4(y,u,d,i.getOverlaps(),N,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=g,this.renderedRenderOrder_=p,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=_,this.wrappedRenderedExtent_=y,this.renderedCenter_=m,this.renderedProjection_=h,this.renderedPixelRatio_=d,this.replayGroup_=P,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,s,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,h=i.length;c<h;++c)l=Z0(n,t,i[c],e,this.boundHandleStyleImageChange_,s,o,a)||l;else l=Z0(n,t,i,e,this.boundHandleStyleImageChange_,s,o,a);return l}}class Tk extends C1{constructor(t){super(t)}createRenderer(){return new bZ(this)}}class kZ{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const s=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class Lh extends Eo{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}}class Na extends Lh{constructor(t,e,i,n,s,o){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=n!==void 0?n:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Dr={SINGLECLICK:"singleclick",CLICK:Bt.CLICK,DBLCLICK:Bt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},_2={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class EZ extends Zu{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=Se(i,_2.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Se(i,_2.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Bt.TOUCHMOVE,this.boundHandleTouchMove_,jR?{passive:!1}:!1)}emulateClick_(t){let e=new Na(Dr.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Na(Dr.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Na(Dr.SINGLECLICK,this.map_,t);this.dispatchEvent(i)},250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==Dr.POINTERUP||e.type==Dr.POINTERCANCEL){delete this.trackedTouches_[i];for(const n in this.trackedTouches_)if(this.trackedTouches_[n].target!==e.target){delete this.trackedTouches_[n];break}}else(e.type==Dr.POINTERDOWN||e.type==Dr.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new Na(Dr.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(or),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new Na(Dr.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Se(i,Dr.POINTERMOVE,this.handlePointerMove_,this),Se(i,Dr.POINTERUP,this.handlePointerUp_,this),Se(this.element_,Dr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(Se(this.element_.getRootNode(),Dr.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new Na(Dr.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new Na(Dr.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(or(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Bt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(or(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(or),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Da={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Fi={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},v2=1/0;class SZ{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Vu(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){_e(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=v2?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,s=e[t],o=i[t],a=t;for(;t<n>>1;){const l=this.getLeftChildIndex_(t),c=this.getRightChildIndex_(t),h=c<n&&i[c]<i[l]?c:l;e[t]=e[h],i[t]=i[h],t=h}e[t]=s,i[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,s=i[e],o=n[e];for(;e>t;){const a=this.getParentIndex_(e);if(n[a]>o)i[e]=i[a],n[e]=n[a],e=a;else break}i[e]=s,n[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const s=e.length;let o,a,l;for(a=0;a<s;++a)o=e[a],l=t(o),l==v2?delete this.queuedElements_[this.keyFunction_(o)]:(i[n]=l,e[n++]=o);e.length=n,i.length=n,this.heapify_()}}class TZ extends SZ{constructor(t,e){super(i=>t.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(Bt.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===_t.LOADED||i===_t.ERROR||i===_t.EMPTY){i!==_t.ERROR&&e.removeEventListener(Bt.CHANGE,this.boundHandleTileChange_);const n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;){const n=this.dequeue()[0],s=n.getKey();n.getState()===_t.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,n.load())}}}function CZ(r,t,e,i,n){if(!r||!(e in r.wantedTiles)||!r.wantedTiles[e][t.getKey()])return v2;const s=r.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(n)+Math.sqrt(o*o+a*a)/n}class Ck extends So{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&this.element?.remove();for(let e=0,i=this.listenerKeys.length;e<i;++e)or(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=t,t){const e=this.target_??t.getOverlayContainerStopEvent();this.element&&e.appendChild(this.element),this.render!==Ig&&this.listenerKeys.push(Se(t,Da.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class MZ extends Ck{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=t.className!==void 0?t.className:"ol-attribution",i=t.tipLabel!==void 0?t.tipLabel:"Attributions",n=t.expandClassName!==void 0?t.expandClassName:e+"-expand",s=t.collapseLabel!==void 0?t.collapseLabel:"âº",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=n):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Bt.CLICK,this.handleClick_.bind(this),!1);const c=e+" "+b1+" "+sb+(this.collapsed_&&this.collapsible_?" "+iT:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),i=new Set(e.flatMap(n=>n.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(n=>i.add(n)):i.add(this.attributions_)),!this.overrideCollapsible_){const n=!e.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(n)}return Array.from(i)}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(n=>hR(()=>n))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!ga(e,this.renderedAttributions_)){WN(this.ulElement_);for(let n=0,s=e.length;n<s;++n){const o=document.createElement("li");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(iT),this.collapsed_?eT(this.collapseLabel_,this.label_):eT(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class RZ extends Ck{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",i=t.label!==void 0?t.label:"â§",n=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const s=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Bt.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+b1+" "+sb,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(vp)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();e!==void 0&&(this.duration_>0&&e%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Xu}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const n="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(vp);!s&&i===0?this.element.classList.add(vp):s&&i!==0&&this.element.classList.remove(vp)}this.label_.style.transform=n}this.rotation_=i}}class IZ extends Ck{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",i=t.delta!==void 0?t.delta:1,n=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",s=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"â",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",c=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=n,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(Bt.CLICK,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=s,u.setAttribute("type","button"),u.title=c,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(Bt.CLICK,this.handleClick_.bind(this,-i),!1);const d=e+" "+b1+" "+sb,g=this.element;g.className=d,g.appendChild(h),g.appendChild(u),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(i!==void 0){const n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:Xu})):e.setZoom(n)}}}function PZ(r){r=r||{};const t=new es;return(r.zoom===void 0||r.zoom)&&t.push(new IZ(r.zoomOptions)),(r.rotate===void 0||r.rotate)&&t.push(new RZ(r.rotateOptions)),(r.attribution===void 0||r.attribution)&&t.push(new MZ(r.attributionOptions)),t}const a5={ACTIVE:"active"};class Hf extends So{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(a5.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(a5.ACTIVE,t)}setMap(t){this.map_=t}}function AZ(r,t,e){const i=r.getCenterInternal();if(i){const n=[i[0]+t[0],i[1]+t[1]];r.animateInternal({duration:e!==void 0?e:250,easing:I7,center:r.getConstrainedCenter(n)})}}function Mk(r,t,e,i){const n=r.getZoom();if(n===void 0)return;const s=r.getConstrainedZoom(n+t),o=r.getResolutionForZoom(s);r.getAnimating()&&r.cancelAnimations(),r.animate({resolution:o,anchor:e,duration:i!==void 0?i:250,easing:Xu})}class LZ extends Hf{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==Dr.DBLCLICK){const i=t.originalEvent,n=t.map,s=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=n.getView();Mk(a,o,s,this.duration_),i.preventDefault(),e=!0}return!e}}function x2(r){const t=arguments;return function(e){let i=!0;for(let n=0,s=t.length;n<s&&(i=i&&t[n](e),!!i);++n);return i}}const OZ=function(r){const t=r.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},FZ=function(r){const t=r.map.getTargetElement(),e=t.getRootNode(),i=r.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(i):t.contains(i)},WP=function(r){const t=r.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?FZ(r):!0},NZ=Rg,VP=function(r){const t=r.originalEvent;return"pointerId"in t&&t.button==0&&!(UN&&DR&&t.ctrlKey)},ZP=function(r){const t=r.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},DZ=function(r){const t=r.originalEvent;return DR?t.metaKey:t.ctrlKey},$Z=function(r){const t=r.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},HP=function(r){const t=r.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},V_=function(r){const t=r.originalEvent;return"pointerId"in t&&t.pointerType=="mouse"},GZ=function(r){const t=r.originalEvent;return"pointerId"in t&&t.isPrimary&&t.button===0};class Yf extends Hf{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Dr.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Dr.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Dr.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==Dr.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function Rk(r){const t=r.length;let e=0,i=0;for(let n=0;n<t;n++)e+=r[n].clientX,i+=r[n].clientY;return{clientX:e/t,clientY:i/t}}class YP extends Yf{constructor(t){super({stopDown:d1}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:x2(ZP,GZ);this.condition_=t.onFocusOnly?x2(WP,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,n=e.getEventPixel(Rk(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const s=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],o=t.map.getView();vR(s,o.getResolution()),Lw(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const n=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),l=e.getCoordinateFromPixelInternal([a[0]-n*Math.cos(s),a[1]-n*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Xu})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class jZ extends Yf{constructor(t){t=t||{},super({stopDown:d1}),this.condition_=t.condition?t.condition:OZ,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!V_(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===pb)return;const n=e.getSize(),s=t.pixel,o=Math.atan2(n[1]/2-s[1],s[0]-n[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return V_(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return V_(t)&&VP(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class zZ extends Rf{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new ia([i])}getGeometry(){return this.geometry_}}const _h={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Cd extends Eo{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}class qZ extends Yf{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new zZ(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??VP,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],s=i[1]-e[1];return n*n+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Cd(_h.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Cd(e?_h.BOXEND:_h.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Cd(_h.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Cd(_h.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Cd(_h.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}}class BZ extends qZ{constructor(t){t=t||{};const e=t.condition?t.condition:$Z;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const n=e.rotatedExtentForGeometry(i),s=e.getResolutionForExtentInternal(n),o=e.getResolution()/s;i=i.clone(),i.scale(o*o)}e.fitInternal(i,{duration:this.duration_,easing:Xu})}}const Nl={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class UZ extends Hf{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return ZP(e)&&HP(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==Bt.KEYDOWN){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==Nl.DOWN||n==Nl.LEFT||n==Nl.RIGHT||n==Nl.UP)){const s=t.map.getView(),o=s.getResolution()*this.pixelDelta_;let a=0,l=0;n==Nl.DOWN?l=-o:n==Nl.LEFT?a=-o:n==Nl.RIGHT?a=o:l=o;const c=[a,l];Lw(c,s.getRotation()),AZ(s,c,this.duration_),i.preventDefault(),e=!0}}return!e}}class WZ extends Hf{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!DZ(e)&&HP(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==Bt.KEYDOWN||t.type==Bt.KEYPRESS){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==="+"||n==="-")){const s=t.map,o=n==="+"?this.delta_:-this.delta_,a=s.getView();Mk(a,o,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}}const VZ=40,ZZ=300;class HZ extends Hf{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:NZ;this.condition_=t.onFocusOnly?x2(WP,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==Bt.WHEEL)return!0;const e=t.map,i=t.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let n=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:n*=VZ;break;case WheelEvent.DOM_DELTA_PAGE:n*=ZZ;break}if(n===0)return!1;this.lastDelta_=n;const s=Date.now();this.startTime_===void 0&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?"trackpad":"wheel");const o=e.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=s,!1;this.totalDelta_+=n;const a=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),a),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-dr(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Mk(e,i,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class YZ extends Yf{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=d1),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],s=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=s;const o=t.map,a=o.getView();a.getConstraints().rotation!==pb&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Rk(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class XZ extends Yf{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=d1),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],s=i.clientX-n.clientX,o=i.clientY-n.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const l=t.map,c=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Rk(this.targetPointers))),l.render(),c.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function XP(r){r=r||{};const t=new es,e=new kZ(-.005,.05,100);return(r.altShiftDragRotate===void 0||r.altShiftDragRotate)&&t.push(new jZ),(r.doubleClickZoom===void 0||r.doubleClickZoom)&&t.push(new LZ({delta:r.zoomDelta,duration:r.zoomDuration})),(r.dragPan===void 0||r.dragPan)&&t.push(new YP({onFocusOnly:r.onFocusOnly,kinetic:e})),(r.pinchRotate===void 0||r.pinchRotate)&&t.push(new YZ),(r.pinchZoom===void 0||r.pinchZoom)&&t.push(new XZ({duration:r.zoomDuration})),(r.keyboard===void 0||r.keyboard)&&(t.push(new UZ),t.push(new WZ({delta:r.zoomDelta,duration:r.zoomDuration}))),(r.mouseWheelZoom===void 0||r.mouseWheelZoom)&&t.push(new HZ({onFocusOnly:r.onFocusOnly,duration:r.zoomDuration})),(r.shiftDragZoom===void 0||r.shiftDragZoom)&&t.push(new BZ({duration:r.zoomDuration})),t}const Pa={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};let Ba=class extends Eo{constructor(t,e){super(t),this.layer=e}};const Z_={LAYERS:"layers"};class eh extends E4{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Z_.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new es(i.slice(),{unique:!0}):_e(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new es(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(or),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(Se(t,fn.ADD,this.handleLayersAdd_,this),Se(t,fn.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(or);Vu(this.listenerKeys_);const e=t.getArray();for(let i=0,n=e.length;i<n;i++){const s=e[i];this.registerLayerListeners_(s),this.dispatchEvent(new Ba(Pa.ADDLAYER,s))}this.changed()}registerLayerListeners_(t){const e=[Se(t,Su.PROPERTYCHANGE,this.handleLayerChange_,this),Se(t,Bt.CHANGE,this.handleLayerChange_,this)];t instanceof eh&&e.push(Se(t,Pa.ADDLAYER,this.handleLayerGroupAdd_,this),Se(t,Pa.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[Rt(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Ba(Pa.ADDLAYER,t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Ba(Pa.REMOVELAYER,t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Ba(Pa.ADDLAYER,e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=Rt(e);this.listenerKeys_[i].forEach(or),delete this.listenerKeys_[i],this.dispatchEvent(new Ba(Pa.REMOVELAYER,e)),this.changed()}getLayers(){return this.get(Z_.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let n=0,s=i.length;n<s;++n)this.dispatchEvent(new Ba(Pa.REMOVELAYER,i[n]))}this.set(Z_.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const n=this.getLayerState();let s=n.zIndex;!t&&n.zIndex===void 0&&(s=0);for(let o=i,a=e.length;o<a;o++){const l=e[o];l.opacity*=n.opacity,l.visible=l.visible&&n.visible,l.maxResolution=Math.min(l.maxResolution,n.maxResolution),l.minResolution=Math.max(l.minResolution,n.minResolution),l.minZoom=Math.max(l.minZoom,n.minZoom),l.maxZoom=Math.min(l.maxZoom,n.maxZoom),n.extent!==void 0&&(l.extent!==void 0?l.extent=bn(l.extent,n.extent):l.extent=n.extent),l.zIndex===void 0&&(l.zIndex=s)}return e}getSourceState(){return"ready"}}class KZ extends Rf{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){Qt()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;us(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Pc(n,i)}forEachFeatureAtCoordinate(t,e,i,n,s,o,a,l){let c;const h=e.viewState;function u(v,w,b,E){return s.call(o,w,v?b:null,E)}const d=h.projection,g=Ow(t.slice(),d),f=[[0,0]];if(d.canWrapX()&&n){const v=d.getExtent(),w=Te(v);f.push([-w,0],[w,0])}const p=e.layerStatesArray,m=p.length,y=[],_=[];for(let v=0;v<f.length;v++)for(let w=m-1;w>=0;--w){const b=p[w],E=b.layer;if(E.hasRenderer()&&yb(b,h)&&a.call(l,E)){const C=E.getRenderer(),S=E.getSource();if(C&&S){const R=S.getWrapX()?g:t,I=u.bind(null,b.managed);_[0]=R[0]+f[v][0],_[1]=R[1]+f[v][1],c=C.forEachFeatureAtCoordinate(_,e,i,I,y)}if(c)return c}}if(y.length===0)return;const x=1/y.length;return y.forEach((v,w)=>v.distanceSq+=w*x),y.sort((v,w)=>v.distanceSq-w.distanceSq),y.some(v=>c=v.callback(v.feature,v.layer,v.geometry)),c}hasFeatureAtCoordinate(t,e,i,n,s,o){return this.forEachFeatureAtCoordinate(t,e,i,n,Rg,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(t){Qt()}scheduleExpireIconCache(t){Xn.canExpireCache()&&t.postRenderFunctions.push(QZ)}}function QZ(r,t){Xn.expire()}class JZ extends KZ{constructor(t){super(t),this.fontChangeListenerKey_=Se(Th,Su.PROPERTYCHANGE,t.redrawText,t),this.element_=Yn?zR():document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=b1+" ol-layers";const i=t.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new tg(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){or(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(yi.PRECOMPOSE,t);const e=t.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);e.some(a=>a.layer instanceof C1&&a.layer.getDeclutter())&&(t.declutter={});const i=t.viewState;this.children_.length=0;const n=[];let s=null;for(let a=0,l=e.length;a<l;++a){const c=e[a];t.layerIndex=a;const h=c.layer,u=h.getSourceState();if(!yb(c,i)||u!="ready"&&u!="undefined"){h.unrender();continue}const d=h.render(t,s);d&&(d!==s&&(this.children_.push(d),s=d),n.push(c))}this.declutter(t,n),VN(this.element_,this.children_);const o=this.getMap().getTargetElement();if(Ka(o)){const a=o.getContext("2d");for(const l of this.children_){const c=l.firstElementChild||l,h=l.style.backgroundColor;if(h&&(!Ka(c)||c.width>0)&&(a.fillStyle=h,a.fillRect(0,0,o.width,o.height)),Ka(c)&&c.width>0){a.save();const u=l.style.opacity||c.style.opacity;a.globalAlpha=u===""?1:Number(u);const d=c.style.transform;if(d)a.transform(...cx(d));else{const g=parseFloat(c.style.width)/c.width,f=parseFloat(c.style.height)/c.height;a.transform(g,0,0,f,0,0)}a.drawImage(c,0,0),a.restore()}}}this.dispatchRenderEvent(yi.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let i=e.length-1;i>=0;--i){const n=e[i],s=n.layer;s.getDeclutter()&&s.renderDeclutter(t,n)}e.forEach(i=>i.layer.renderDeferred(t))}}}function KP(r){if(r instanceof Hc){r.setMapInternal(null);return}r instanceof eh&&r.getLayers().forEach(KP)}function QP(r,t){if(r instanceof Hc){r.setMapInternal(t);return}if(r instanceof eh){const e=r.getLayers().getArray();for(let i=0,n=e.length;i<n;++i)QP(e[i],t)}}let Ik=class extends So{constructor(r){super(),r=r||{},this.on,this.once,this.un;const t=tH(r);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=r.maxTilesLoading!==void 0?r.maxTilesLoading:16,this.pixelRatio_=r.pixelRatio!==void 0?r.pixelRatio:$R,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Er(),this.pixelToCoordinateTransform_=Er(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Yn||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=r.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Yn||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Yn?new es:PZ()),this.interactions=t.interactions||(Yn?new es:XP({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new TZ(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Fi.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Fi.VIEW,this.handleViewChanged_),this.addChangeListener(Fi.SIZE,this.handleSizeChanged_),this.addChangeListener(Fi.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const e=this;r.view&&!(r.view instanceof Ks)&&r.view.then(function(i){e.setView(new Ks(i))}),this.controls.addEventListener(fn.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(fn.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(fn.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(fn.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(fn.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(fn.REMOVE,i=>{const n=i.element.getId();n!==void 0&&delete this.overlayIdIndex_[n.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(r){this.getControls().push(r)}addInteraction(r){this.getInteractions().push(r)}addLayer(r){this.getLayerGroup().getLayers().push(r)}handleLayerAdd_(r){QP(r.layer,this)}addOverlay(r){this.getOverlays().push(r)}addOverlayInternal_(r){const t=r.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=r),r.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(r,t,e){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(r);e=e!==void 0?e:{};const n=e.hitTolerance!==void 0?e.hitTolerance:0,s=e.layerFilter!==void 0?e.layerFilter:Rg,o=e.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,n,o,t,null,s,null)}getFeaturesAtPixel(r,t){const e=[];return this.forEachFeatureAtPixel(r,function(i){e.push(i)},t),e}getAllLayers(){const r=[];function t(e){e.forEach(function(i){i instanceof eh?t(i.getLayers()):r.push(i)})}return t(this.getLayers()),r}hasFeatureAtPixel(r,t){if(!this.frameState_||!this.renderer_)return!1;const e=this.getCoordinateFromPixelInternal(r);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:Rg,n=t.hitTolerance!==void 0?t.hitTolerance:0,s=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(e,this.frameState_,n,s,i,null)}getEventCoordinate(r){return this.getCoordinateFromPixel(this.getEventPixel(r))}getEventCoordinateInternal(r){return this.getCoordinateFromPixelInternal(this.getEventPixel(r))}getEventPixel(r){const t=this.viewport_.getBoundingClientRect(),e=this.getSize(),i=t.width/e[0],n=t.height/e[1],s="changedTouches"in r?r.changedTouches[0]:r;return[(s.clientX-t.left)/i,(s.clientY-t.top)/n]}getTarget(){return this.get(Fi.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(r){return ax(this.getCoordinateFromPixelInternal(r),this.getView().getProjection())}getCoordinateFromPixelInternal(r){const t=this.frameState_;return t?Ir(t.pixelToCoordinateTransform,r.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(r){const t=this.overlayIdIndex_[r.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Fi.LAYERGROUP)}setLayers(r){const t=this.getLayerGroup();if(r instanceof es){t.setLayers(r);return}const e=t.getLayers();e.clear(),e.extend(r)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const r=this.getLayerGroup().getLayerStatesArray();for(let t=0,e=r.length;t<e;++t){const i=r[t];if(!i.visible)continue;const n=i.layer.getRenderer();if(n&&!n.ready)return!0;const s=i.layer.getSource();if(s&&s.loading)return!0}return!1}getPixelFromCoordinate(r){const t=Oo(r,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(r){const t=this.frameState_;return t?Ir(t.coordinateToPixelTransform,r.slice(0,2)):null}getPixelRatio(){return this.pixelRatio_}setPixelRatio(r){this.pixelRatio_!==r&&(this.pixelRatio_=r,this.render())}getRenderer(){return this.renderer_}getSize(){return this.get(Fi.SIZE)}getView(){return this.get(Fi.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const r=this.getTargetElement();return r?r.ownerDocument:document}getTilePriority(r,t,e,i){return CZ(this.frameState_,r,t,e,i)}handleBrowserEvent(r,t){t=t||r.type;const e=new Na(t,this,r);this.handleMapBrowserEvent(e)}handleMapBrowserEvent(r){if(!this.frameState_)return;const t=r.originalEvent,e=t.type;if(e===_2.POINTERDOWN||e===Bt.WHEEL||e===Bt.KEYDOWN){const i=this.getOwnerDocument(),n=this.viewport_.getRootNode?this.viewport_.getRootNode():i,s=t.target,o=n instanceof ShadowRoot?n.host===s?n.host.ownerDocument:n:n===i?i.documentElement:n;if(this.overlayContainerStopEvent_.contains(s)||!o.contains(s))return}if(r.frameState=this.frameState_,this.dispatchEvent(r)!==!1){const i=this.getInteractions().getArray().slice();for(let n=i.length-1;n>=0;n--){const s=i[n];if(!(s.getMap()!==this||!s.getActive()||!this.getTargetElement())&&(!s.handleEvent(r)||r.propagationStopped))break}}}handlePostRender(){const r=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,n=i;if(r){const s=r.viewHints;if(s[ur.ANIMATING]||s[ur.INTERACTING]){const o=Date.now()-r.time>8;i=o?0:8,n=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,n))}r&&this.renderer_&&!r.animate&&(this.renderComplete_?(this.hasListener(yi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(yi.RENDERCOMPLETE,r),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Lh(Da.LOADEND,this,r)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Lh(Da.LOADSTART,this,r))));const e=this.postRenderFunctions_;if(r)for(let i=0,n=e.length;i<n;++i)e[i](this,r);e.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let e=0,i=this.targetChangeHandlerKeys_.length;e<i;++e)or(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Bt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Bt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Ka(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const e=this.targetElement_.getRootNode();e instanceof ShadowRoot&&this.resizeObserver_.unobserve(e.host),this.setSize(void 0)}const r=this.getTarget(),t=typeof r=="string"?document.getElementById(r):r;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Ka(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new JZ(this)),!Ka(t)){this.mapBrowserEventHandler_=new EZ(this,this.moveTolerance_);for(const i in Dr)this.mapBrowserEventHandler_.addEventListener(Dr[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Bt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Bt.WHEEL,this.boundHandleBrowserEvent_,jR?{passive:!1}:!1);let e;if(this.keyboardEventTarget_)e=this.keyboardEventTarget_;else{const i=t.getRootNode();e=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[Se(e,Bt.KEYDOWN,this.handleBrowserEvent,this),Se(e,Bt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(or(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(or(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const r=this.getView();r&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Se(r,Su.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Se(r,Bt.CHANGE,this.handleViewPropertyChanged_,this),r.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(or),this.layerGroupPropertyListenerKeys_=null);const r=this.getLayerGroup();r&&(this.handleLayerAdd_(new Ba("addlayer",r)),this.layerGroupPropertyListenerKeys_=[Se(r,Su.PROPERTYCHANGE,this.render,this),Se(r,Bt.CHANGE,this.render,this),Se(r,"addlayer",this.handleLayerAdd_,this),Se(r,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const r=this.frameState_.layerStatesArray;for(let t=0,e=r.length;t<e;++t){const i=r[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(r){return this.getControls().remove(r)}removeInteraction(r){return this.getInteractions().remove(r)}removeLayer(r){return this.getLayerGroup().getLayers().remove(r)}handleLayerRemove_(r){KP(r.layer)}removeOverlay(r){return this.getOverlays().remove(r)}renderFrame_(r){const t=this.getSize(),e=this.getView(),i=this.frameState_;let n=null;if(t!==void 0&&lT(t)&&e&&e.isDef()){const s=e.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=e.getState();if(n={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Ag(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:r,usedTiles:{},viewState:o,viewHints:s,wantedTiles:{},mapId:Rt(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const a=isNaN(o.nextRotation)?o.rotation:o.nextRotation;n.nextExtent=Ag(o.nextCenter,o.nextResolution,a,t)}}this.frameState_=n,this.renderer_.renderFrame(n),n&&(n.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,n.postRenderFunctions),i&&(!this.previousExtent_||!fa(this.previousExtent_)&&!vl(n.extent,this.previousExtent_))&&(this.dispatchEvent(new Lh(Da.MOVESTART,this,i)),this.previousExtent_=Hu(this.previousExtent_)),this.previousExtent_&&!n.viewHints[ur.ANIMATING]&&!n.viewHints[ur.INTERACTING]&&!vl(n.extent,this.previousExtent_)&&(this.dispatchEvent(new Lh(Da.MOVEEND,this,n)),uR(n.extent,this.previousExtent_))),this.dispatchEvent(new Lh(Da.POSTRENDER,this,n)),this.renderComplete_=(this.hasListener(Da.LOADSTART)||this.hasListener(Da.LOADEND)||this.hasListener(yi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(r){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Ba("removelayer",t)),this.set(Fi.LAYERGROUP,r)}setSize(r){this.set(Fi.SIZE,r)}setTarget(r){this.set(Fi.TARGET,r)}setView(r){if(!r||r instanceof Ks){this.set(Fi.VIEW,r);return}this.set(Fi.VIEW,new Ks);const t=this;r.then(function(e){t.setView(new Ks(e))})}updateSize(){const r=this.getTargetElement();let t;if(r){let i,n;if(Ka(r)){const s=r.getContext("2d").getTransform();i=r.width/s.a,n=r.height/s.d}else{const s=getComputedStyle(r);i=r.offsetWidth-parseFloat(s.borderLeftWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)-parseFloat(s.borderRightWidth),n=r.offsetHeight-parseFloat(s.borderTopWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom)-parseFloat(s.borderBottomWidth)}!isNaN(i)&&!isNaN(n)&&(t=[Math.max(0,i),Math.max(0,n)],!lT(t)&&(r.offsetWidth||r.offsetHeight||r.getClientRects().length)&&yR("No map visible because the map container's width or height are 0."))}const e=this.getSize();t&&(!e||!ga(t,e))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(r){const t=this.getView();t&&t.setViewportSize(r)}};function tH(r){let t=null;r.keyboardEventTarget!==void 0&&(t=typeof r.keyboardEventTarget=="string"?document.getElementById(r.keyboardEventTarget):r.keyboardEventTarget);const e={},i=r.layers&&typeof r.layers.getLayers=="function"?r.layers:new eh({layers:r.layers});e[Fi.LAYERGROUP]=i,e[Fi.TARGET]=r.target,e[Fi.VIEW]=r.view instanceof Ks?r.view:new Ks;let n;r.controls!==void 0&&(Array.isArray(r.controls)?n=new es(r.controls.slice()):(_e(typeof r.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),n=r.controls));let s;r.interactions!==void 0&&(Array.isArray(r.interactions)?s=new es(r.interactions.slice()):(_e(typeof r.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=r.interactions));let o;return r.overlays!==void 0?Array.isArray(r.overlays)?o=new es(r.overlays.slice()):(_e(typeof r.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=r.overlays):o=new es,{controls:n,interactions:s,keyboardEventTarget:t,overlays:o,values:e}}const l5=[];class eH extends Gf{constructor(t,e,i,n,s){super(t,e,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=n.bind(void 0,this),this.removeSourceTiles_=s,this.wrappedTileCoord=i}getContext(){return this.context_||(this.context_=Hr(1,1,l5)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(t){const e=Rt(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedPixelRatio:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]}load(){this.getSourceTiles()}release(){this.context_&&(Ff(this.context_),l5.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}}let rH=class extends Gf{constructor(r,t,e,i,n,s){super(r,t,s),this.extent=null,this.format_=i,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=n,this.url_=e,this.key=e}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==_t.IDLE&&(this.setState(_t.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(r,t){this.setFeatures(r)}onError(){this.setState(_t.ERROR)}setFeatures(r){this.features_=r,this.setState(_t.LOADED)}setLoader(r){this.loader_=r}};function iH({backgroundImage:r,target:t}={}){const e=document.getElementById(t||Vi.target);if(e){const i=`url(${typeof r=="string"?r:Vi.backgroundImage})`;e.style.backgroundImage=i}}function nH(r){return Array.isArray(r.layers)?r.layers:typeof r.layerConf>"u"||r.layerConf===Vi.layerConf?Vi.layers:[]}let sH=class extends Hc{constructor(r){r=r||{};const t=Object.assign({},r),e=r.cacheSize;delete r.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=e,this.setPreload(r.preload!==void 0?r.preload:0),this.setUseInterimTilesOnError(r.useInterimTilesOnError!==void 0?r.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Ja.PRELOAD)}setPreload(r){this.set(Ja.PRELOAD,r)}getUseInterimTilesOnError(){return this.get(Ja.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(r){this.set(Ja.USE_INTERIM_TILES_ON_ERROR,r)}getData(r){return super.getData(r)}},Pk=class extends sH{constructor(r){super(r)}createRenderer(){return new P4(this,{cacheSize:this.getCacheSize()})}},oH=class extends lb{constructor(r){super(r),this.image=null,this.renderedSourceRevision_=0}getImage(){return this.image?this.image.getImage():null}prepareFrame(r){const t=r.layerStatesArray[r.layerIndex],e=r.pixelRatio,i=r.viewState,n=i.resolution,s=this.getLayer().getSource(),o=r.viewHints;let a=r.extent;if(t.extent!==void 0&&(a=bn(a,Ms(t.extent,i.projection))),!o[ur.ANIMATING]&&!o[ur.INTERACTING]&&!fa(a))if(s){!this.getLayer().rendered&&this.renderedSourceRevision_!==s.getRevision()&&(this.image=null),this.renderedSourceRevision_=s.getRevision();const l=i.projection,c=s.getImage(a,n,e,l);c&&(this.loadImage(c)?this.image=c:c.getState()===Nt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(r){const t=this.frameState;if(!t)return null;const e=this.getLayer(),i=Ir(t.pixelToCoordinateTransform,r.slice()),n=e.getExtent();if(n&&!Mc(n,i))return null;const s=this.image.getExtent(),o=this.image.getImage(),a=Te(s),l=Math.floor(o.width*((i[0]-s[0])/a));if(l<0||l>=o.width)return null;const c=ti(s),h=Math.floor(o.height*((s[3]-i[1])/c));return h<0||h>=o.height?null:this.getImageData(o,l,h)}renderFrame(r,t){const e=this.image,i=e.getExtent(),n=e.getResolution(),[s,o]=Array.isArray(n)?n:[n,n],a=e.getPixelRatio(),l=r.layerStatesArray[r.layerIndex],c=r.pixelRatio,h=r.viewState,u=h.center,d=h.resolution,g=c*s/(d*a),f=c*o/(d*a);this.prepareContainer(r,t);const p=this.context.canvas.width,m=this.context.canvas.height,y=this.getRenderContext(r);let _=!1,x=!0;if(l.extent){const C=Ms(l.extent,h.projection);x=zr(C,r.extent),_=x&&!ro(C,r.extent),_&&this.clipUnrotated(y,r,C)}const v=e.getImage(),w=us(this.tempTransform,p/2,m/2,g,f,0,a*(i[0]-u[0])/s,a*(u[1]-i[3])/o);this.renderedResolution=o*c/a;const b=v.width*w[0],E=v.height*w[3];if(this.getLayer().getSource().getInterpolate()||(y.imageSmoothingEnabled=!1),this.preRender(y,r),x&&b>=.5&&E>=.5){const C=w[4],S=w[5],R=l.opacity;R!==1&&(y.save(),y.globalAlpha=R),y.drawImage(v,0,0,+v.width,+v.height,C,S,b,E),R!==1&&y.restore()}return this.postRender(this.context,r),_&&y.restore(),y.imageSmoothingEnabled=!0,this.container}},aH=class extends Hc{constructor(r){r=r||{},super(r)}},JP=class extends aH{constructor(r){super(r)}createRenderer(){return new oH(this)}getData(r){return super.getData(r)}};function nf(r,t){const e=[];Object.keys(t).forEach(function(n){t[n]!==null&&t[n]!==void 0&&e.push(n+"="+encodeURIComponent(t[n]))});const i=e.join("&");return r=r.replace(/[?&]$/,""),r+=r.includes("?")?"&":"?",r+i}const lH=/\{z\}/g,cH=/\{x\}/g,hH=/\{y\}/g,uH=/\{-y\}/g;function dH(r,t,e,i,n){return r.replace(lH,t.toString()).replace(cH,e.toString()).replace(hH,i.toString()).replace(uH,function(){if(n===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(n-i).toString()})}function tA(r){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(r);if(e){const i=e[1].charCodeAt(0),n=e[2].charCodeAt(0);let s;for(s=i;s<=n;++s)t.push(r.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(r),e){const i=parseInt(e[2],10);for(let n=parseInt(e[1],10);n<=i;n++)t.push(r.replace(e[0],n.toString()));return t}return t.push(r),t}const vh=[0,0,0],Aa=5;let id=class{constructor(r){this.minZoom=r.minZoom!==void 0?r.minZoom:0,this.resolutions_=r.resolutions,_e(AF(this.resolutions_,(i,n)=>n-i),"`resolutions` must be sorted in descending order");let t;if(!r.origins){for(let i=0,n=this.resolutions_.length-1;i<n;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=r.origin!==void 0?r.origin:null,this.origins_=null,r.origins!==void 0&&(this.origins_=r.origins,_e(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const e=r.extent;e!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=_o(e)),_e(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,r.tileSizes!==void 0&&(this.tileSizes_=r.tileSizes,_e(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=r.tileSize!==void 0?r.tileSize:this.tileSizes_?null:mb,_e(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=e!==void 0?e:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],r.sizes!==void 0?this.fullTileRanges_=r.sizes.map((i,n)=>{const s=new M1(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(e){const o=this.getTileRangeForExtentAndZ(e,n);s.minX=Math.max(o.minX,s.minX),s.maxX=Math.min(o.maxX,s.maxX),s.minY=Math.max(o.minY,s.minY),s.maxY=Math.min(o.maxY,s.maxY)}return s}):e&&this.calculateTileRanges_(e)}forEachTileCoord(r,t,e){const i=this.getTileRangeForExtentAndZ(r,t);for(let n=i.minX,s=i.maxX;n<=s;++n)for(let o=i.minY,a=i.maxY;o<=a;++o)e([t,n,o])}forEachTileCoordParentTileRange(r,t,e,i){let n,s,o,a=null,l=r[0]-1;for(this.zoomFactor_===2?(s=r[1],o=r[2]):a=this.getTileCoordExtent(r,i);l>=this.minZoom;){if(s!==void 0&&o!==void 0?(s=Math.floor(s/2),o=Math.floor(o/2),n=ch(s,s,o,o,e)):n=this.getTileRangeForExtentAndZ(a,l,e),t(l,n))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(r){return this.origin_?this.origin_:this.origins_[r]}getOrigins(){return this.origins_}getResolution(r){return this.resolutions_[r]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(r,t,e){if(r[0]<this.maxZoom){if(this.zoomFactor_===2){const n=r[1]*2,s=r[2]*2;return ch(n,n+1,s,s+1,t)}const i=this.getTileCoordExtent(r,e||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,r[0]+1,t)}return null}getTileRangeForTileCoordAndZ(r,t,e){if(t>this.maxZoom||t<this.minZoom)return null;const i=r[0],n=r[1],s=r[2];if(t===i)return ch(n,s,n,s,e);if(this.zoomFactor_){const a=Math.pow(this.zoomFactor_,t-i),l=Math.floor(n*a),c=Math.floor(s*a);if(t<i)return ch(l,l,c,c,e);const h=Math.floor(a*(n+1))-1,u=Math.floor(a*(s+1))-1;return ch(l,h,c,u,e)}const o=this.getTileCoordExtent(r,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,e)}getTileRangeForExtentAndZ(r,t,e){this.getTileCoordForXYAndZ_(r[0],r[3],t,!1,vh);const i=vh[1],n=vh[2];this.getTileCoordForXYAndZ_(r[2],r[1],t,!0,vh);const s=vh[1],o=vh[2];return ch(i,s,n,o,e)}getTileCoordCenter(r){const t=this.getOrigin(r[0]),e=this.getResolution(r[0]),i=_i(this.getTileSize(r[0]),this.tmpSize_);return[t[0]+(r[1]+.5)*i[0]*e,t[1]-(r[2]+.5)*i[1]*e]}getTileCoordExtent(r,t){const e=this.getOrigin(r[0]),i=this.getResolution(r[0]),n=_i(this.getTileSize(r[0]),this.tmpSize_),s=e[0]+r[1]*n[0]*i,o=e[1]-(r[2]+1)*n[1]*i,a=s+n[0]*i,l=o+n[1]*i;return Fs(s,o,a,l,t)}getTileCoordForCoordAndResolution(r,t,e){return this.getTileCoordForXYAndResolution_(r[0],r[1],t,!1,e)}getTileCoordForXYAndResolution_(r,t,e,i,n){const s=this.getZForResolution(e),o=e/this.getResolution(s),a=this.getOrigin(s),l=_i(this.getTileSize(s),this.tmpSize_);let c=o*(r-a[0])/e/l[0],h=o*(a[1]-t)/e/l[1];return i?(c=Ya(c,Aa)-1,h=Ya(h,Aa)-1):(c=qh(c,Aa),h=qh(h,Aa)),Pu(s,c,h,n)}getTileCoordForXYAndZ_(r,t,e,i,n){const s=this.getOrigin(e),o=this.getResolution(e),a=_i(this.getTileSize(e),this.tmpSize_);let l=(r-s[0])/o/a[0],c=(s[1]-t)/o/a[1];return i?(l=Ya(l,Aa)-1,c=Ya(c,Aa)-1):(l=qh(l,Aa),c=qh(c,Aa)),Pu(e,l,c,n)}getTileCoordForCoordAndZ(r,t,e){return this.getTileCoordForXYAndZ_(r[0],r[1],t,!1,e)}getTileCoordResolution(r){return this.resolutions_[r[0]]}getTileSize(r){return this.tileSize_?this.tileSize_:this.tileSizes_[r]}getFullTileRange(r){return this.fullTileRanges_?this.fullTileRanges_[r]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,r):null}getZForResolution(r,t){const e=u1(this.resolutions_,r,t||0);return dr(e,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(r,t){return OR(t,0,t.length,2,this.getTileCoordExtent(r))}calculateTileRanges_(r){const t=this.resolutions_.length,e=new Array(t);for(let i=this.minZoom;i<t;++i)e[i]=this.getTileRangeForExtentAndZ(r,i);this.fullTileRanges_=e}};class eA extends id{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}}function gH(r,t,e){const i=[],n=[],s=[],o=[],a=[];e=e!==void 0?e:[];const l="SupportedCRS",c="TileMatrix",h="Identifier",u="ScaleDenominator",d="TopLeftCorner",g="TileWidth",f="TileHeight",p=r[l],m=Wt(p),y=m.getMetersPerUnit(),_=m.getAxisOrientation().startsWith("ne");return r[c].sort(function(x,v){return v[u]-x[u]}),r[c].forEach(function(x){let v;if(e.length>0?v=e.find(function(w){return x[h]==w[c]?!0:x[h].includes(":")?!1:r[h]+":"+x[h]===w[c]}):v=!0,v){n.push(x[h]);const w=x[u]*28e-5/y,b=x[g],E=x[f];_?s.push([x[d][1],x[d][0]]):s.push(x[d]),i.push(w),o.push(b==E?b:[b,E]),a.push([x.MatrixWidth,x.MatrixHeight])}}),new eA({extent:t,origins:s,resolutions:i,matrixIds:n,tileSizes:o,sizes:a})}function Ak(r){let t=r.getDefaultTileGrid();return t||(t=yH(r),r.setDefaultTileGrid(t)),t}function fH(r,t,e){const i=t[0],n=r.getTileCoordCenter(t),s=Z1(e);if(!Mc(s,n)){const o=Te(s),a=Math.ceil((s[0]-n[0])/o);return n[0]+=o*a,r.getTileCoordForCoordAndZ(n,i)}return t}function pH(r,t,e,i){i=i!==void 0?i:"top-left";const n=rA(r,t,e);return new id({extent:r,origin:DF(r,i),resolutions:n,tileSize:e})}function mH(r){const t=r||{},e=t.extent||Wt("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:rA(e,t.maxZoom,t.tileSize,t.maxResolution)};return new id(i)}function rA(r,t,e,i){t=t!==void 0?t:k4,e=_i(e!==void 0?e:mb);const n=ti(r),s=Te(r);i=i>0?i:Math.max(s/e[0],n/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function yH(r,t,e,i){const n=Z1(r);return pH(n,t,e,i)}function Z1(r){r=Wt(r);let t=r.getExtent();if(!t){const e=180*Fw.degrees/r.getMetersPerUnit();t=Fs(-e,-e,e,e)}return t}function _H(r,t){return(function(e,i,n){if(!e)return;let s;const o=e[0];if(t){const a=t.getFullTileRange(o);a&&(s=a.getHeight()-1)}return dH(r,o,e[1],e[2],s)})}function vH(r,t){const e=r.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=_H(r[n],t);return w2(i)}function w2(r){return r.length===1?r[0]:(function(t,e,i){if(!t)return;const n=I4(t),s=uc(n,r.length);return r[s](t,e,i)})}let xH=class extends Sk{constructor(r){super({attributions:r.attributions,attributionsCollapsible:r.attributionsCollapsible,projection:r.projection,state:r.state,wrapX:r.wrapX,interpolate:r.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=r.tilePixelRatio!==void 0?r.tilePixelRatio:1,this.tileGrid=r.tileGrid!==void 0?r.tileGrid:null;const t=[256,256];this.tileGrid&&_i(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=r.key||Rt(this),this.tileOptions={transition:r.transition,interpolate:r.interpolate},this.zDirection=r.zDirection?r.zDirection:0}getGutterForProjection(r){return 0}getKey(){return this.key_}setKey(r){this.key_!==r&&(this.key_=r,this.changed())}getResolutions(r){const t=r?this.getTileGridForProjection(r):this.tileGrid;return t?t.getResolutions():null}getTile(r,t,e,i,n,s){return Qt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(r){return this.tileGrid?this.tileGrid:Ak(r)}getTilePixelRatio(r){return this.tilePixelRatio_}getTilePixelSize(r,t,e){const i=this.getTileGridForProjection(e),n=this.getTilePixelRatio(t),s=_i(i.getTileSize(r),this.tmpSize);return n==1?s:MD(s,n,this.tmpSize)}getTileCoordForTileUrlFunction(r,t){const e=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(e):this.tileGrid||this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(r=fH(i,r,e)),Z7(r,i)?r:null}clear(){}refresh(){this.clear(),super.refresh()}},wH=class extends Eo{constructor(r,t){super(r),this.tile=t}};const H_={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};let iA=class nA extends xH{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===nA.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=Rt(e),n=e.getState();let s;n==_t.LOADING?(this.tileLoadingKeys_[i]=!0,s=H_.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=n==_t.ERROR?H_.TILELOADERROR:n==_t.LOADED?H_.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new wH(s,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=tA(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(vH(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}},sA=class extends iA{constructor(r){super({attributions:r.attributions,cacheSize:r.cacheSize,projection:r.projection,state:r.state,tileGrid:r.tileGrid,tileLoadFunction:r.tileLoadFunction?r.tileLoadFunction:bH,tilePixelRatio:r.tilePixelRatio,tileUrlFunction:r.tileUrlFunction,url:r.url,urls:r.urls,wrapX:r.wrapX,transition:r.transition,interpolate:r.interpolate!==void 0?r.interpolate:!0,key:r.key,attributionsCollapsible:r.attributionsCollapsible,zDirection:r.zDirection}),this.crossOrigin=r.crossOrigin!==void 0?r.crossOrigin:null,this.referrerPolicy=r.referrerPolicy,this.tileClass=r.tileClass!==void 0?r.tileClass:_b,this.tileGridForProjection={},this.reprojectionErrorThreshold_=r.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(r){return this.getProjection()&&r&&!ci(this.getProjection(),r)?0:this.getGutter()}getGutter(){return 0}getKey(){let r=super.getKey();return this.getInterpolate()||(r+=":disable-interpolation"),r}getTileGridForProjection(r){const t=this.getProjection();if(this.tileGrid&&(!t||ci(t,r)))return this.tileGrid;const e=Rt(r);return e in this.tileGridForProjection||(this.tileGridForProjection[e]=Ak(r)),this.tileGridForProjection[e]}createTile_(r,t,e,i,n,s){const o=[r,t,e],a=this.getTileCoordForTileUrlFunction(o,n),l=a?this.tileUrlFunction(a,i,n):void 0,c=new this.tileClass(o,l!==void 0?_t.IDLE:_t.EMPTY,l!==void 0?l:"",{crossOrigin:this.crossOrigin,referrerPolicy:this.referrerPolicy},this.tileLoadFunction,this.tileOptions);return c.key=s,c.addEventListener(Bt.CHANGE,this.handleTileChange.bind(this)),c}getTile(r,t,e,i,n,s){const o=this.getProjection();if(!o||!n||ci(o,n))return this.getTileInternal(r,t,e,i,o||n);const a=[r,t,e],l=this.getKey(),c=this.getTileGridForProjection(o),h=this.getTileGridForProjection(n),u=this.getTileCoordForTileUrlFunction(a,n),d=new M4(o,c,n,h,a,u,this.getTilePixelRatio(i),this.getGutter(),(g,f,p,m)=>this.getTileInternal(g,f,p,m,o,s),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=l,d}getTileInternal(r,t,e,i,n,s){const o=this.getKey(),a=m0(this,o,r,t,e);if(s&&s.containsKey(a))return s.get(a);const l=this.createTile_(r,t,e,i,n,o);return s?.set(a,l),l}setRenderReprojectionEdges(r){this.renderReprojectionEdges_!=r&&(this.renderReprojectionEdges_=r,this.changed())}setTileGridForProjection(r,t){const e=Wt(r);if(e){const i=Rt(e);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}};function bH(r,t){if(Yn){const e=r.getCrossOrigin();let i="same-origin",n="same-origin";e==="anonymous"||e===""?(i="cors",n="omit"):e==="use-credentials"&&(i="cors",n="include");const s={mode:i,credentials:n,referrerPolicy:r.getReferrerPolicy()};fetch(t,s).then(o=>{if(!o.ok)throw new Error(`HTTP ${o.status}`);return o.blob()}).then(o=>createImageBitmap(o)).then(o=>{const a=r.getImage();a.width=o.width,a.height=o.height,a.getContext("2d").drawImage(o,0,0),o.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{r.getImage().dispatchEvent(new Event("error"))});return}r.getImage().src=t}function b2(r){return Array.isArray(r)?Math.min(...r):r}let kH=class extends nb{constructor(r,t,e,i,n,s,o){let a=r.getExtent();a&&r.canWrapX()&&(a=a.slice(),a[0]=-1/0,a[2]=1/0);let l=t.getExtent();l&&t.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);const c=l?bn(e,l):e,h=Ns(c),u=zg(r,t,h,i),d=C4,g=new T4(r,t,c,a,u*d,i),f=g.calculateSourceExtent(),p=fa(f)?null:s(f,u,n),m=p?Nt.IDLE:Nt.EMPTY,y=p?p.getPixelRatio():1;super(e,i,y,m),this.targetProj_=t,this.maxSourceExtent_=a,this.triangulation_=g,this.targetResolution_=i,this.targetExtent_=e,this.sourceImage_=p,this.sourcePixelRatio_=y,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Nt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const r=this.sourceImage_.getState();if(r==Nt.LOADED){const t=Te(this.targetExtent_)/this.targetResolution_,e=ti(this.targetExtent_)/this.targetResolution_;this.canvas_=S4(t,e,this.sourcePixelRatio_,b2(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=r,this.changed()}load(){if(this.state==Nt.IDLE){this.state=Nt.LOADING,this.changed();const r=this.sourceImage_.getState();r==Nt.LOADED||r==Nt.ERROR?this.reproject_():(this.sourceListenerKey_=Se(this.sourceImage_,Bt.CHANGE,t=>{const e=this.sourceImage_.getState();(e==Nt.LOADED||e==Nt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){or(this.sourceListenerKey_),this.sourceListenerKey_=null}};const il=4,Y_={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};let EH=class extends Eo{constructor(r,t){super(r),this.image=t}},oA=class extends Sk{constructor(r){super({attributions:r.attributions,projection:r.projection,state:r.state,interpolate:r.interpolate!==void 0?r.interpolate:!0}),this.on,this.once,this.un,this.loader=r.loader||null,this.resolutions_=r.resolutions!==void 0?r.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=r.loader?r.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(r){this.resolutions_=r}findNearestResolution(r){const t=this.getResolutions();if(t){const e=u1(t,r,0);r=t[e]}return r}getImage(r,t,e,i){const n=this.getProjection();if(!n||!i||ci(n,i))return n&&(i=n),this.getImageInternal(r,t,e,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&ci(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&vl(this.reprojectedImage_.getExtent(),r))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new kH(n,i,r,t,e,(s,o,a)=>this.getImageInternal(s,o,a,n),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(r,t,e,i){if(this.loader){const n=lA(r,t,e,1),s=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&ro(this.wantedExtent_,n)||ro(this.image.getExtent(),n))&&(this.wantedResolution_&&b2(this.wantedResolution_)===s||b2(this.image.getResolution())===s)))return this.image;this.wantedProjection_=i,this.wantedExtent_=n,this.wantedResolution_=s,this.image=new nb(n,s,e,this.loader),this.image.addEventListener(Bt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(r){const t=r.target;let e;switch(t.getState()){case Nt.LOADING:this.loading=!0,e=Y_.IMAGELOADSTART;break;case Nt.LOADED:this.loading=!1,e=Y_.IMAGELOADEND;break;case Nt.ERROR:this.loading=!1,e=Y_.IMAGELOADERROR;break;default:return}this.hasListener(e)&&this.dispatchEvent(new EH(e,t))}};function aA(r,t){r.getImage().src=t}function lA(r,t,e,i){const n=t/e,s=Ns(r),o=Ya(Te(r)/n,il),a=Ya(ti(r)/n,il),l=Ya((i-1)*o/2,il),c=o+2*l,h=Ya((i-1)*a/2,il),u=a+2*h;return Ag(s,n,0,[c,u])}const Em="1.3.0",c5=[101,101];function cA(r,t,e,i,n){n.WIDTH=e[0],n.HEIGHT=e[1];const s=i.getAxisOrientation(),o=Ek(n.VERSION,"1.3")>=0;n[o?"CRS":"SRS"]=i.getCode();const a=o&&s.startsWith("ne")?[t[1],t[0],t[3],t[2]]:t;return n.BBOX=a.join(","),nf(r,n)}function hA(r,t,e,i,n,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=t/e,l=[jS(Te(r)/a,il),jS(ti(r)/a,il)];if(e!=1)switch(o){case"geoserver":const c=90*e+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+c:s.FORMAT_OPTIONS="dpi:"+c;break;case"mapserver":s.MAP_RESOLUTION=90*e;break;case"carmentaserver":case"qgis":s.DPI=90*e;break;default:throw new Error("Unknown `serverType` configured")}return cA(n,r,l,i,s)}function Sm(r,t){return Object.assign({REQUEST:t,SERVICE:"WMS",VERSION:Em,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},r)}function SH(r){const t=r.hidpi===void 0?!0:r.hidpi,e=Wt(r.projection||"EPSG:3857"),i=r.ratio||1.5,n=r.load||w1,s=r.crossOrigin??null,o=r.referrerPolicy;return(a,l,c)=>{a=lA(a,l,c,i),c!=1&&(!t||r.serverType===void 0)&&(c=1);const h=hA(a,l,c,e,r.url,Sm(r.params,"GetMap"),r.serverType),u=new Image;return u.crossOrigin=s,o!==void 0&&(u.referrerPolicy=o),n(u,h).then(d=>({image:d,extent:a,pixelRatio:c}))}}function TH(r,t,e){if(r.url===void 0)return;const i=Wt(r.projection||"EPSG:3857"),n=Ag(t,e,0,c5),s={QUERY_LAYERS:r.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(s,Sm(r.params,"GetFeatureInfo"),r.params);const o=qh((t[0]-n[0])/e,il),a=qh((n[3]-t[1])/e,il),l=Ek(s.VERSION,"1.3")>=0;return s[l?"I":"X"]=o,s[l?"J":"Y"]=a,cA(r.url,n,c5,i,s)}function CH(r,t){if(r.url===void 0)return;const e={SERVICE:"WMS",VERSION:Em,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t!==void 0){const i=Wt(r.projection||"EPSG:3857").getMetersPerUnit()||1,n=28e-5;e.SCALE=t*i/n}if(Object.assign(e,r.params),r.params!==void 0&&e.LAYER===void 0){const i=e.LAYERS;if(!(!Array.isArray(i)||i.length!==1))return;e.LAYER=i}return nf(r.url,e)}let uA=class extends sA{constructor(r){r=r||{};const t=Object.assign({},r.params);super({attributions:r.attributions,attributionsCollapsible:r.attributionsCollapsible,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,interpolate:r.interpolate,projection:r.projection,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileClass:r.tileClass,tileGrid:r.tileGrid,tileLoadFunction:r.tileLoadFunction,url:r.url,urls:r.urls,wrapX:r.wrapX!==void 0?r.wrapX:!0,transition:r.transition,zDirection:r.zDirection}),this.gutter_=r.gutter!==void 0?r.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=r.serverType,this.hidpi_=r.hidpi!==void 0?r.hidpi:!0,this.tmpExtent_=sn(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(r,t,e,i){const n=Wt(e),s=this.getProjection()||n;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(s));const a=Mu(r,n,s),l=zg(s,n,r,t),c=o.getZForResolution(l,this.zDirection),h=o.getResolution(c),u=o.getTileCoordForCoordAndZ(a,c);if(o.getResolutions().length<=u[0])return;let d=o.getTileCoordExtent(u,this.tmpExtent_);const g=this.gutter_;g!==0&&(d=ns(d,h*g,d));const f={QUERY_LAYERS:this.params_.LAYERS};Object.assign(f,Sm(this.params_,"GetFeatureInfo"),i);const p=Math.floor((a[0]-d[0])/h),m=Math.floor((d[3]-a[1])/h);return f[this.v13_?"I":"X"]=p,f[this.v13_?"J":"Y"]=m,this.getRequestUrl_(u,d,1,s||n,f)}getLegendUrl(r,t){if(this.urls[0]===void 0)return;const e={SERVICE:"WMS",VERSION:Em,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;e.LAYER=i}if(r!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,n=28e-5;e.SCALE=r*i/n}return Object.assign(e,t),nf(this.urls[0],e)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(r,t,e,i,n){const s=this.urls;if(!s)return;let o;if(s.length==1)o=s[0];else{const a=uc(I4(r),s.length);o=s[a]}return hA(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(r[0]),e,i,o,n,this.serverType_)}getTilePixelRatio(r){return!this.hidpi_||this.serverType_===void 0?1:r}getKeyForParams_(){let r=0;const t=[];for(const e in this.params_)t[r++]=e+"-"+this.params_[e];return t.join("/")}setParams_(r){this.params_=r,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(r){this.setParams_(Object.assign({},r))}updateParams(r){this.setParams_(Object.assign(this.params_,r))}updateV13_(){const r=this.params_.VERSION||Em;this.v13_=Ek(r,"1.3")>=0}tileUrlFunction(r,t,e){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(e)),i.getResolutions().length<=r[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const n=i.getResolution(r[0]);let s=i.getTileCoordExtent(r,this.tmpExtent_);const o=this.gutter_;o!==0&&(s=ns(s,n*o,s));const a=Object.assign({},Sm(this.params_,"GetMap"));return this.getRequestUrl_(r,s,t,e,a)}},dA=class extends oA{constructor(r){r=r||{},super({attributions:r.attributions,interpolate:r.interpolate,projection:r.projection,resolutions:r.resolutions}),this.crossOrigin_=r.crossOrigin!==void 0?r.crossOrigin:null,this.referrerPolicy_=r.referrerPolicy,this.url_=r.url,this.imageLoadFunction_=r.imageLoadFunction!==void 0?r.imageLoadFunction:aA,this.params_=Object.assign({},r.params),this.serverType_=r.serverType,this.hidpi_=r.hidpi!==void 0?r.hidpi:!0,this.renderedRevision_=0,this.ratio_=r.ratio!==void 0?r.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(r,t,e,i){const n=Wt(e),s=this.getProjection();s&&s!==n&&(t=zg(s,n,r,t),r=Mu(r,n,s));const o={url:this.url_,params:{...this.params_,...i},projection:s||n};return TH(o,r,t)}getLegendUrl(r,t){return CH({url:this.url_,params:{...this.params_,...t}},r)}getParams(){return this.params_}getImageInternal(r,t,e,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=SH({crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_,params:this.params_,projection:i,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(n,s)=>(this.image.setImage(n),this.imageLoadFunction_(this.image,s),w1(n))})),super.getImageInternal(r,t,e,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(r){this.imageLoadFunction_=r,this.changed()}setUrl(r){r!=this.url_&&(this.url_=r,this.loader=null,this.changed())}setParams(r){this.params_=Object.assign({},r),this.loader=null,this.changed()}updateParams(r){Object.assign(this.params_,r),this.changed()}changed(){this.image=null,super.changed()}};const MH="EPSG:3857";function Lk(){return Math.floor(Math.random()*9999999)}function gA(r,t){const e={...r},i={},n=["STYLES","TIME","CRS"];return Object.keys(t).forEach(s=>{i[s.toUpperCase()]=t[s]}),n.forEach(s=>{t[s]&&(e[s]=t[s])}),e}function fA(r){let t={};return t=Object.assign({CACHEID:Lk(),FORMAT:r.format||"image/png",LAYERS:r.layers,VERSION:r.version,TRANSPARENT:r.transparent,SINGLETILE:r.singleTile,CQL_FILTER:r.cqlFilter},r.singleTile?{}:{WIDTH:r.tilesize,HEIGHT:r.tilesize}),t=gA(t,r),t}function k2({isSecured:r}){return async(t,e)=>{try{const i=await fetch(e,{credentials:r?"include":"omit"}),n=await i.blob();t.getImage().src=URL.createObjectURL(n)}catch(i){console.error(i.message),t.getImage().src=e}}}function pA(r,t,e={}){const i=fA(r),n=r.crs?Wt(r.crs):void 0;let s=null,o={};return r.TIME&&r.TIME.toString()==="[object Promise]"&&(i.TIME=new Date().toISOString()),r.singleTile?(o={url:r.url,params:i,serverType:r.serverType,projection:n,attributions:r.olAttribution,crossOrigin:r.crossOrigin},(r.isSecured||e.useFetchForWMS)&&(o=Object.assign(o,{imageLoadFunction:k2(r)})),new dA(o)):(t&&t.resolutions&&(s=new id({resolutions:t.resolutions,origin:t.origin?t.origin:void 0,tileSize:parseInt(r.tilesize,10)})),o={url:r.url,params:i,gutter:r.gutter||0,tileGrid:s,projection:n,attributions:r.olAttribution,crossOrigin:r.crossOrigin},(r.isSecured||e.useFetchForWMS)&&(o=Object.assign(o,{tileLoadFunction:k2(r)})),new uA(o))}function RH(r={},{layerParams:t={},options:e={}}={}){const i=pA(r,e,t),n=r.singleTile?JP:Pk;return i.set("olcs_projection",Wt(MH)),new n(Object.assign({source:i,minResolution:typeof r.minResolution=="string"?parseFloat(r.minResolution):r.minResolution,maxResolution:typeof r.maxResolution=="string"?parseFloat(r.maxResolution):r.maxResolution,id:r.id,extent:r.extent},t))}function IH(r){const t=r.getSource().getParams().SESSIONID;let e=t;for(;t===e;)e=Lk();return r.getSource().updateParams({SESSIONID:e}),e}function PH(r,t,e){const i=Ml.getLayerWhere({Id:r.get("id")}),n=t.getView().getResolution(),s=t.getView().getProjection(),o=Object.assign({INFO_FORMAT:i&&i.infoFormat||"text/xml"},i&&typeof i.featureCount<"u"?{FEATURE_COUNT:i.featureCount}:{});return r.getSource().getFeatureInfoUrl(e,n,s,o)}const AH=Object.freeze(Object.defineProperty({__proto__:null,addOptionalParams:gA,createLayer:RH,createLayerSource:pA,defaultLoadFunction:k2,generateSessionId:Lk,getGfiURL:PH,makeParams:fA,updateSource:IH},Symbol.toStringTag,{value:"Module"}));class H1 extends sA{constructor(t){const e=t.requestEncoding!==void 0?t.requestEncoding:"KVP",i=t.tileGrid;let n=t.urls;n===void 0&&t.url!==void 0&&(n=tA(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,referrerPolicy:t.referrerPolicy,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:n,wrapX:t.wrapX!==void 0?t.wrapX:!1,transition:t.transition,zDirection:t.zDirection}),this.version_=t.version!==void 0?t.version:"1.0.0",this.format_=t.format!==void 0?t.format:"image/jpeg",this.dimensions_=t.dimensions!==void 0?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=w2(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join(`
`);this.setTileUrlFunction(w2(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};e=="KVP"&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t=e=="KVP"?nf(t,i):t.replace(/\{(\w+?)\}/g,function(o,a){return a.toLowerCase()in i?i[a.toLowerCase()]:o});const n=this.tileGrid,s=this.dimensions_;return(function(o,a,l){if(!o)return;const c={TileMatrix:n.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(c,s);let h=t;return e=="KVP"?h=nf(h,c):h=h.replace(/\{(\w+?)\}/g,function(u,d){return encodeURIComponent(c[d])}),h})}}function LH(r,t){const e=r.Contents.Layer?.find(function(I){return I.Identifier==t.layer});if(!e)return null;const i=r.Contents.TileMatrixSet;let n;e.TileMatrixSetLink.length>1?"projection"in t?n=e.TileMatrixSetLink.findIndex(function(I){const F=i.find(function(T){return T.Identifier==I.TileMatrixSet}).SupportedCRS,N=Wt(F),P=Wt(t.projection);return N&&P?ci(N,P):F==t.projection}):n=e.TileMatrixSetLink.findIndex(function(I){return I.TileMatrixSet==t.matrixSet}):n=0,n<0&&(n=0);const s=e.TileMatrixSetLink[n].TileMatrixSet,o=e.TileMatrixSetLink[n].TileMatrixSetLimits;let a=e.Format[0];"format"in t&&(a=t.format),n=e.Style.findIndex(function(I){return"style"in t?I.Title==t.style:I.isDefault}),n<0&&(n=0);const l=e.Style[n].Identifier,c={};"Dimension"in e&&e.Dimension.forEach(function(I,F,N){const P=I.Identifier;let T=I.Default;T===void 0&&(T=I.Value[0]),c[P]=T});const h=r.Contents.TileMatrixSet.find(function(I){return I.Identifier==s});let u;const d=h.SupportedCRS;if(d&&(u=Wt(d)),"projection"in t){const I=Wt(t.projection);I&&(!u||ci(I,u))&&(u=I)}let g=!1;const f=u.getAxisOrientation().startsWith("ne");let p=h.TileMatrix[0],m={MinTileCol:0,MinTileRow:0,MaxTileCol:p.MatrixWidth-1,MaxTileRow:p.MatrixHeight-1};if(o){m=o[o.length-1];const I=h.TileMatrix.find(F=>F.Identifier===m.TileMatrix||h.Identifier+":"+F.Identifier===m.TileMatrix);I&&(p=I)}const y=e.BoundingBox?.find(I=>Wt(I.crs)&&ci(Wt(I.crs),u)),_=p.ScaleDenominator*28e-5/u.getMetersPerUnit(),x=f?[p.TopLeftCorner[1],p.TopLeftCorner[0]]:p.TopLeftCorner,v=p.TileWidth*_,w=p.TileHeight*_;let b=y?.extent??h.BoundingBox;b&&f&&(b=[b[1],b[0],b[3],b[2]]);let E=[x[0]+v*m.MinTileCol,x[1]-w*(1+m.MaxTileRow),x[0]+v*(1+m.MaxTileCol),x[1]-w*m.MinTileRow];if(b!==void 0&&!ro(b,E)){const I=e.WGS84BoundingBox,F=Wt("EPSG:4326").getExtent();if(E=b,I)g=I[0]===F[0]&&I[2]===F[2];else{const N=dc(b,h.SupportedCRS,"EPSG:4326");g=N[0]-1e-10<=F[0]&&N[2]+1e-10>=F[2]}}const C=gH(h,E,o),S=[];let R=t.requestEncoding;if(R=R!==void 0?R:"","OperationsMetadata"in r&&"GetTile"in r.OperationsMetadata){const I=r.OperationsMetadata.GetTile.DCP.HTTP.Get;for(let F=0,N=I.length;F<N;++F)if(I[F].Constraint){const P=I[F].Constraint.find(function(T){return T.name=="GetEncoding"}).AllowedValues.Value;if(R===""&&(R=P[0]),R==="KVP")P.includes("KVP")&&S.push(I[F].href);else break}else I[F].href&&(R="KVP",S.push(I[F].href))}return S.length===0&&(R="REST",e.ResourceURL.forEach(function(I){I.resourceType==="tile"&&(a=I.format,S.push(I.template))})),{urls:S,layer:t.layer,matrixSet:s,format:a,projection:u,requestEncoding:R,tileGrid:C,style:l,dimensions:c,wrapX:g,crossOrigin:t.crossOrigin}}const E2="http://www.w3.org/2001/XMLSchema-instance";function de(r,t){return Ok().createElementNS(r,t)}function Gc(r,t){return mA(r,t,[]).join("")}function mA(r,t,e){if(r.nodeType==Node.CDATA_SECTION_NODE||r.nodeType==Node.TEXT_NODE)e.push(r.nodeValue);else{let i;for(i=r.firstChild;i;i=i.nextSibling)mA(i,t,e)}return e}function rc(r){return"documentElement"in r}function OH(r,t,e){return r.getAttributeNS(t,e)||""}function ic(r){return new DOMParser().parseFromString(r,"application/xml")}function yA(r,t){return(function(e,i){const n=r.call(this,e,i);if(n!==void 0){const s=i[i.length-1];en(s,n)}})}function ie(r,t){return(function(e,i){const n=r.call(t??this,e,i);n!==void 0&&i[i.length-1].push(n)})}function Xt(r,t){return(function(e,i){const n=r.call(t??this,e,i);n!==void 0&&(i[i.length-1]=n)})}function pn(r,t,e){return(function(i,n){const s=r.call(this,i,n);if(s!==void 0){const o=n[n.length-1],a=i.localName;let l;a in o?l=o[a]:(l=[],o[a]=l),l.push(s)}})}function Tt(r,t,e){return(function(i,n){const s=r.call(this,i,n);if(s!==void 0){const o=n[n.length-1],a=t!==void 0?t:i.localName;o[a]=s}})}function J(r,t){return(function(e,i,n){r.call(t??this,e,i,n),n[n.length-1].node.appendChild(e)})}function Gn(r,t){return(function(e,i,n){const s=i[i.length-1].node;let o=r;o===void 0&&(o=n);const a=t!==void 0?t:s.namespaceURI;return de(a,o)})}const _A=Gn();function Ke(r,t,e){e=e!==void 0?e:{};let i,n;for(i=0,n=r.length;i<n;++i)e[r[i]]=t;return e}function fc(r,t,e,i){let n;for(n=t.firstElementChild;n;n=n.nextElementSibling){const s=r[n.namespaceURI];if(s!==void 0){const o=s[n.localName];o!==void 0&&o.call(i,n,e)}}}function qt(r,t,e,i,n){return i.push(r),fc(t,e,i,n),i.pop()}function FH(r,t,e,i,n,s){const o=(n!==void 0?n:e).length;let a,l;for(let c=0;c<o;++c)a=e[c],a!==void 0&&(l=t.call(s,a,i,n!==void 0?n[c]:void 0),l!==void 0&&r[l.namespaceURI][l.localName].call(s,l,a,i))}function Gr(r,t,e,i,n,s,o){return n.push(r),FH(t,e,i,n,s,o),n.pop()}let X_;function NH(){return X_===void 0&&typeof XMLSerializer<"u"&&(X_=new XMLSerializer),X_}let K_;function Ok(){return K_===void 0&&typeof document<"u"&&(K_=document.implementation.createDocument("","",null)),K_}class vA{read(t){if(!t)return null;if(typeof t=="string"){const e=ic(t);return this.readFromDocument(e)}return rc(t)?this.readFromDocument(t):this.readFromNode(t)}readFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null}readFromNode(t){Qt()}}const DH="http://www.w3.org/1999/xlink";function Fk(r){return r.getAttributeNS(DH,"href")}function $H(r){const t=Gc(r,!1);return GH(t)}function GH(r){const t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(r);if(t)return parseFloat(t[1])}function mn(r){const t=Gc(r,!1);return Yh(t)}function Yh(r){const t=/^\s*(\d+)\s*$/.exec(r);if(t)return parseInt(t[1],10)}function Fe(r){return Gc(r,!1).trim()}function jH(r,t){r.appendChild(Ok().createCDATASection(t))}const zH=/^\s/,qH=/\s$/,BH=/(\n|\t|\r|<|&| {2})/;function ni(r,t){typeof t=="string"&&(zH.test(t)||qH.test(t)||BH.test(t))?t.split("]]>").forEach((e,i,n)=>{i<n.length-1&&(e+="]]"),i>0&&(e=">"+e),jH(r,e)}):r.appendChild(Ok().createTextNode(t))}const Tn=[null,"http://www.opengis.net/ows/1.1"],UH=Ke(Tn,{ServiceIdentification:Tt(pY),ServiceProvider:Tt(yY),OperationsMetadata:Tt(gY)});class WH extends vA{constructor(){super()}readFromNode(t){return qt({},UH,t,[])||null}}const VH=Ke(Tn,{DeliveryPoint:Tt(Fe),City:Tt(Fe),AdministrativeArea:Tt(Fe),PostalCode:Tt(Fe),Country:Tt(Fe),ElectronicMailAddress:Tt(Fe)}),ZH=Ke(Tn,{Value:pn(_Y)}),HH=Ke(Tn,{AllowedValues:Tt(oY)}),YH=Ke(Tn,{Phone:Tt(fY),Address:Tt(sY)}),XH=Ke(Tn,{HTTP:Tt(uY)}),KH=Ke(Tn,{Get:pn(hY),Post:void 0}),QH=Ke(Tn,{DCP:Tt(cY)}),JH=Ke(Tn,{Operation:dY}),tY=Ke(Tn,{Voice:Tt(Fe),Facsimile:Tt(Fe)}),eY=Ke(Tn,{Constraint:pn(aY)}),rY=Ke(Tn,{IndividualName:Tt(Fe),PositionName:Tt(Fe),ContactInfo:Tt(lY)}),iY=Ke(Tn,{Abstract:Tt(Fe),AccessConstraints:Tt(Fe),Fees:Tt(Fe),Title:Tt(Fe),ServiceTypeVersion:Tt(Fe),ServiceType:Tt(Fe)}),nY=Ke(Tn,{ProviderName:Tt(Fe),ProviderSite:Tt(Fk),ServiceContact:Tt(mY)});function sY(r,t){return qt({},VH,r,t)}function oY(r,t){return qt({},ZH,r,t)}function aY(r,t){const e=r.getAttribute("name");if(e)return qt({name:e},HH,r,t)}function lY(r,t){return qt({},YH,r,t)}function cY(r,t){return qt({},XH,r,t)}function hY(r,t){const e=Fk(r);if(e)return qt({href:e},eY,r,t)}function uY(r,t){return qt({},KH,r,t)}function dY(r,t){const e=r.getAttribute("name"),i=qt({},QH,r,t);if(!i)return;const n=t[t.length-1];n[e]=i}function gY(r,t){return qt({},JH,r,t)}function fY(r,t){return qt({},tY,r,t)}function pY(r,t){return qt({},iY,r,t)}function mY(r,t){return qt({},rY,r,t)}function yY(r,t){return qt({},nY,r,t)}function _Y(r,t){return Fe(r)}const To=[null,"http://www.opengis.net/wmts/1.0"],nd=[null,"http://www.opengis.net/ows/1.1"],vY=Ke(To,{Contents:Tt(IY)});class xY extends vA{constructor(){super(),this.owsParser_=new WH}readFromNode(t){let e=t.getAttribute("version");e&&(e=e.trim());let i=this.owsParser_.readFromNode(t);return i?(i.version=e,i=qt(i,vY,t,[]),i||null):null}}const wY=Ke(To,{Layer:pn(PY),TileMatrixSet:pn(AY)}),bY=Ke(To,{Style:pn(LY),Format:pn(Fe),TileMatrixSetLink:pn(OY),Dimension:pn(FY),ResourceURL:pn(NY)},Ke(nd,{Title:Tt(Fe),Abstract:Tt(Fe),WGS84BoundingBox:Tt(wA),BoundingBox:pn(DY),Identifier:Tt(Fe)})),kY=Ke(To,{LegendURL:pn($Y)},Ke(nd,{Title:Tt(Fe),Identifier:Tt(Fe)})),EY=Ke(To,{TileMatrixSet:Tt(Fe),TileMatrixSetLimits:Tt(jY)}),SY=Ke(To,{TileMatrixLimits:ie(zY)}),TY=Ke(To,{TileMatrix:Tt(Fe),MinTileRow:Tt(mn),MaxTileRow:Tt(mn),MinTileCol:Tt(mn),MaxTileCol:Tt(mn)}),CY=Ke(To,{Default:Tt(Fe),Value:pn(Fe)},Ke(nd,{Identifier:Tt(Fe)})),xA=Ke(nd,{LowerCorner:ie(S2),UpperCorner:ie(S2)}),MY=Ke(To,{WellKnownScaleSet:Tt(Fe),TileMatrix:pn(GY)},Ke(nd,{SupportedCRS:Tt(Fe),Identifier:Tt(Fe),BoundingBox:Tt(wA)})),RY=Ke(To,{TopLeftCorner:Tt(S2),ScaleDenominator:Tt($H),TileWidth:Tt(mn),TileHeight:Tt(mn),MatrixWidth:Tt(mn),MatrixHeight:Tt(mn)},Ke(nd,{Identifier:Tt(Fe)}));function IY(r,t){return qt({},wY,r,t)}function PY(r,t){return qt({},bY,r,t)}function AY(r,t){return qt({},MY,r,t)}function LY(r,t){const e=qt({},kY,r,t);if(!e)return;const i=r.getAttribute("isDefault")==="true";return e.isDefault=i,e}function OY(r,t){return qt({},EY,r,t)}function FY(r,t){return qt({},CY,r,t)}function NY(r,t){const e=r.getAttribute("format"),i=r.getAttribute("template"),n=r.getAttribute("resourceType"),s={};return e&&(s.format=e),i&&(s.template=i),n&&(s.resourceType=n),s}function wA(r,t){const e=qt([],xA,r,t);if(e.length==2)return Pg(e)}function DY(r,t){const e=r.getAttribute("crs"),i=qt([],xA,r,t);if(i.length==2)return{extent:Pg(i),crs:e}}function $Y(r,t){const e={};return e.format=r.getAttribute("format"),e.href=Fk(r),e}function S2(r,t){const e=Fe(r).split(/\s+/);if(!e||e.length!=2)return;const i=+e[0],n=+e[1];if(!(isNaN(i)||isNaN(n)))return[i,n]}function GY(r,t){return qt({},RY,r,t)}function jY(r,t){return qt([],SY,r,t)}function zY(r,t){return qt({},TY,r,t)}function Tm(r,t){console.error("content: Layer "+t+": "+r)}function bA(r,t,e,i){for(let n=0;n<e;++n)r[n]=i/Math.pow(2,n),t[n]=n}function kA(r){return fetch(r).then(t=>{if(t&&t.status===200)return t.text();throw console.error(t),new Error(`Failing WMTS request to ${r}. Status: ${t?.status}`)}).then(t=>new xY().read(t))}function EA(r,t){const e=Wt(r.coordinateSystem),i=e.getExtent(),n=r.style,s=r.format,o=r.wrapX?r.wrapX:!1,a=r.urls,l=i?Te(i)/parseInt(r.tileSize,10):null,c=parseInt(r.resLength,10),h=new Array(c),u=new Array(c),d=new H1({projection:e,attributions:r.olAttribution,tileGrid:new eA({origin:r.origin,resolutions:h,matrixIds:u,tileSize:r.tileSize}),tilePixelRatio:$R,urls:a,matrixSet:r.tileMatrixSet,matrixSizes:r.matrixSizes,layer:r.layers,format:s,style:n,version:r.version,transparent:r.transparent.toString(),wrapX:o,requestEncoding:r.requestEncoding,scales:r.scales});l?bA(h,u,c,l):Tm(r.name,`${e.getCode()} has been given as projection to wmts.js for layer with id ${r.id}, but only "EPSG:4326" and "EPSG:3857" are supported. Please use the "capabilitiesUrl" and "optionsFromCapabilities" configuration parameters on this layer.`),d.matrixSizes=r.matrixSizes,d.scales=r.scales,t.setSource(d),t.getSource().refresh()}function SA(r,t){const e=r.layers,i=r.capabilitiesUrl,n=r.tileMatrixSet,s=r.format,o={layer:e,format:s};n&&n.length>0?o.matrixSet=n:o.projection="EPSG:3857",kA(i).then(a=>{const l=LH(a,o),c=a.Contents.TileMatrixSet.filter(d=>d.Identifier===l.matrixSet)[0],h=[],u=[];if(c.TileMatrix.forEach(({MatrixHeight:d,MatrixWidth:g,ScaleDenominator:f})=>{h.push([g,d]),u.push(f)}),l!==null){const d=new H1(l);d.matrixSizes=h,d.scales=u,t.set("options",l),t.setSource(d),t.getSource().refresh()}else{const d="Cannot get options from WMTS-Capabilities";throw Tm(d,r.name||r.id),new Error(d)}}).catch(a=>{a!=="Fetch error"&&Tm(a,r.name||r.id)})}function qY(r,t={}){const e=new Pk(Object.assign({id:r.id,source:new H1({}),name:r.name,minResolution:typeof r.minResolution=="string"?parseFloat(r.minResolution):r.minResolution,maxResolution:typeof r.maxResolution=="string"?parseFloat(r.maxResolution):r.maxResolution,supported:["2D","3D"],showSettings:!0,extent:null,typ:r.typ,legendURL:r.legendURL,infoFormat:r.infoFormat},t));return!r.optionsFromCapabilities||!r.capabilitiesUrl?EA(r,e):SA(r,e),e}const BY={createLayer:qY,createLayerSourceByCapabilities:SA,createLayerSourceByDefinitions:EA,getWMTSCapabilities:kA,generateArrays:bA,showErrorMessage:Tm};class Nk{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=ed,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?Wt(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=Wt(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return Qt()}readFeature(t,e){return Qt()}readFeatures(t,e){return Qt()}readGeometry(t,e){return Qt()}readProjection(t){return Qt()}writeFeature(t,e){return Qt()}writeFeatures(t,e){return Qt()}writeGeometry(t,e){return Qt()}}function rh(r,t,e){const i=e?Wt(e.featureProjection):null,n=e?Wt(e.dataProjection):null;let s=r;if(i&&n&&!ci(i,n)){t&&(s=r.clone());const o=t?i:n,a=t?n:i;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(Ic(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*o)/o;return l};s===r&&(s=r.clone()),s.applyTransform(a)}return s}function Dk(r,t){const e=t?Wt(t.featureProjection):null,i=t?Wt(t.dataProjection):null;return e&&i&&!ci(e,i)?dc(r,i,e):r}const UY={Point:xl,LineString:Nu,Polygon:ia,MultiPoint:rd,MultiLineString:Dc,MultiPolygon:$c};function WY(r,t,e){return Array.isArray(t[0])?(NR(r,0,t,e)||(r=r.slice(),gx(r,0,t,e)),r):(Kw(r,0,t,e)||(r=r.slice(),B0(r,0,t,e)),r)}function TA(r,t){const e=r.geometry;if(!e)return[];if(Array.isArray(e))return e.map(s=>TA({...r,geometry:s})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const n=e.layout.length;return rh(new Pn(i,i==="Polygon"?WY(e.flatCoordinates,e.ends,n):e.flatCoordinates,e.ends?.flat(),n,r.properties||{},r.id).enableSimplifyTransformed(),!1,t)}function $k(r,t){if(!r)return null;if(Array.isArray(r)){const i=r.map(n=>$k(n,t));return new km(i)}const e=UY[r.type];return rh(new e(r.flatCoordinates,r.layout||"XY",r.ends),!1,t)}class VY extends Nk{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Dp(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Dp(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return Qt()}readFeaturesFromObject(t,e){return Qt()}readGeometry(t,e){return this.readGeometryFromObject(Dp(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return Qt()}readProjection(t){return this.readProjectionFromObject(Dp(t))}readProjectionFromObject(t){return Qt()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return Qt()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return Qt()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return Qt()}}function Dp(r){return typeof r=="string"?JSON.parse(r)||null:r!==null?r:null}class CA extends VY{constructor(t){t=t||{},super(),this.dataProjection=Wt(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Wt(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const n=Gk(i.geometry);if(this.featureClass===Pn)return TA({geometry:n,id:i.id,properties:i.properties},e);const s=new ed;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&s.setGeometryName(i.geometry_name),s.setGeometry($k(n,e)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(t,e){const i=t;let n=null;if(i.type==="FeatureCollection"){const s=t;n=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],e);c&&n.push(c)}}else n=[this.readFeatureFromObject(t,e)];return n.flat()}readGeometryFromObject(t,e){return ZY(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=Wt(e.properties.name);else if(e.type==="EPSG")i=Wt("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(n!==void 0&&(i.id=n),!t.hasProperties())return i;const s=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=T2(o,e),delete s[t.getGeometryName()]),_l(s)||(i.properties=s),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,s=t.length;n<s;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return T2(t,this.adaptOptions(e))}}function Gk(r,t){if(!r)return null;let e;switch(r.type){case"Point":{e=YY(r);break}case"LineString":{e=XY(r);break}case"Polygon":{e=tX(r);break}case"MultiPoint":{e=QY(r);break}case"MultiLineString":{e=KY(r);break}case"MultiPolygon":{e=JY(r);break}case"GeometryCollection":{e=HY(r);break}default:throw new Error("Unsupported GeoJSON type: "+r.type)}return e}function ZY(r,t){const e=Gk(r);return $k(e,t)}function HY(r,t){return r.geometries.map(function(e){return Gk(e)})}function YY(r){const t=r.coordinates;return{type:"Point",flatCoordinates:t,layout:Vc(t.length)}}function XY(r){const t=r.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:Vc(t[0]?.length||2)}}function KY(r){const t=r.coordinates,e=t[0]?.[0]?.length||2,i=[],n=Of(i,0,t,e);return{type:"MultiLineString",flatCoordinates:i,ends:n,layout:Vc(e)}}function QY(r){const t=r.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:Vc(t[0]?.length||2)}}function JY(r){const t=r.coordinates,e=[],i=t[0]?.[0]?.[0].length||2,n=RR(e,0,t,i);return{type:"MultiPolygon",flatCoordinates:e,ends:n,layout:Vc(i)}}function tX(r){const t=r.coordinates,e=[],i=t[0]?.[0]?.length,n=Of(e,0,t,i);return{type:"Polygon",flatCoordinates:e,ends:n,layout:Vc(i)}}function T2(r,t){r=rh(r,!0,t);const e=r.getType();let i;switch(e){case"Point":{i=oX(r);break}case"LineString":{i=rX(r);break}case"Polygon":{i=aX(r,t);break}case"MultiPoint":{i=nX(r);break}case"MultiLineString":{i=iX(r);break}case"MultiPolygon":{i=sX(r,t);break}case"GeometryCollection":{i=eX(r,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function eX(r,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:r.getGeometriesArray().map(function(e){return T2(e,t)})}}function rX(r,t){return{type:"LineString",coordinates:r.getCoordinates()}}function iX(r,t){return{type:"MultiLineString",coordinates:r.getCoordinates()}}function nX(r,t){return{type:"MultiPoint",coordinates:r.getCoordinates()}}function sX(r,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:r.getCoordinates(e)}}function oX(r,t){return{type:"Point",coordinates:r.getCoordinates()}}function aX(r,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:r.getCoordinates(e)}}let lX=class extends UP{constructor(r){r=r||{},super({attributions:r.attributions,wrapX:r.wrapX}),this.resolution=void 0,this.distance=r.distance!==void 0?r.distance:20,this.minDistance=r.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=r.geometryFunction||function(t){const e=t.getGeometry();return _e(!e||e.getType()==="Point","The default `geometryFunction` can only handle `Point` or null geometries"),e},this.createCustomCluster_=r.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(r.source||null)}clear(r){this.features.length=0,super.clear(r)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(r,t,e){this.source?.loadFeatures(r,t,e),t!==this.resolution&&(this.resolution=t,this.refresh())}setDistance(r){this.updateDistance(r,this.minDistance)}setMinDistance(r){this.updateDistance(this.distance,r)}getMinDistance(){return this.minDistance}setSource(r){this.source&&this.source.removeEventListener(Bt.CHANGE,this.boundRefresh_),this.source=r,r&&r.addEventListener(Bt.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(r,t){const e=r===0?0:Math.min(t,r)/r,i=r!==this.distance||this.interpolationRatio!==e;this.distance=r,this.minDistance=t,this.interpolationRatio=e,i&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const r=sn(),t=this.distance*this.resolution,e=this.source.getFeatures(),i={};for(let n=0,s=e.length;n<s;n++){const o=e[n];if(!(Rt(o)in i)){const a=this.geometryFunction(o);if(a){const l=a.getCoordinates();Iw(l,r),ns(r,t,r);const c=this.source.getFeaturesInExtent(r).filter(function(h){const u=Rt(h);return u in i?!1:(i[u]=!0,!0)});this.features.push(this.createCluster(c,r))}}}}createCluster(r,t){const e=[0,0];for(let o=r.length-1;o>=0;--o){const a=this.geometryFunction(r[o]);a?_R(e,a.getCoordinates()):r.splice(o,1)}vR(e,1/r.length);const i=Ns(t),n=this.interpolationRatio,s=new xl([e[0]*(1-n)+i[0]*n,e[1]*(1-n)+i[1]*n]);return this.createCustomCluster_?this.createCustomCluster_(s,r):new ed({geometry:s,features:r})}};function jk(r,t,e){let i,n,s;return typeof r=="string"?n=r:typeof r=="function"?i=r:typeof r=="object"&&(s=e.readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:25832"})),new UP({loader:i,features:s,url:n,strategy:t,format:e})}function zk(r,t,e){return new lX({source:r,distance:t,geometryFunction:e})}function C2({url:r,features:t,clusterDistance:e,renderer:i,styleId:n,excludeTypesFromParsing:s,isPointLayer:o},a){const l=new CA;let c=null;return c=jk(r||t,a.loadingStrategy,l),typeof e=="number"&&(c=zk(c,e,a.clusterGeometryFunction)),(typeof e=="number"?c.getSource():c).once("featuresloadend",h=>{typeof a.afterLoading=="function"&&a.afterLoading(h?.features)}),i==="webgl"&&(t?.length>0&&Au(c.getFeatures(),n,s,o),c.once("featuresloadend",h=>{Au(h?.features,n,s,o)})),c}function cX(r={},{layerParams:t={},options:e={}}={}){let i,n;return t.renderer==="webgl"?(n=C2({...r,renderer:t.renderer,styleId:t.styleId,excludeTypesFromParsing:t.excludeTypesFromParsing,isPointLayer:t.isPointLayer},e),i=L1({...r,...t,source:n}),i):(n=C2(r,e),i=new Tk(Object.assign({id:r.id,source:n},t)),e.style?i.setStyle(e.style):r.style?i.setStyle(r.style):i.setStyle(J7),i)}function hX(r){r.getSource().refresh(),r.get("renderer")==="webgl"&&r.getSource().once("featuresloadend",t=>{Au(t?.features,r.get("styleId"),r.get("excludeTypesFromParsing"),r.get("isPointLayer"))})}function Y1(r,t){r.forEach(e=>e.setStyle(t))}function MA(r){Y1(r.getSource().getFeatures(),()=>null)}function uX(r){Y1(r.getSource().getFeatures(),void 0)}function dX(r,t){const e=r.getSource().getFeatures().filter(i=>t.indexOf(i.getId())>=0);MA(r),Y1(e,void 0)}function gX(r,t){const e=r.url;fetch(e,t).then(i=>i.text()).then(i=>{const n=t.getFormat().readFeatures(i);t.addFeatures(n),t.dispatchEvent({type:"featuresloadend",features:t.getFeatures()})}).catch(i=>{console.error(i)})}const fX=Object.freeze(Object.defineProperty({__proto__:null,createLayer:cX,createLayerSource:C2,hideAllFeatures:MA,loadFeaturesManually:gX,setCustomStyles:Y7,setFeatureStyle:Y1,showAllFeatures:uX,showFeaturesById:dX,updateSource:hX},Symbol.toStringTag,{value:"Module"}));class RA extends Nk{constructor(){super(),this.xmlSerializer_=NH()}getType(){return"xml"}readFeature(t,e){if(!t)return null;if(typeof t=="string"){const i=ic(t);return this.readFeatureFromDocument(i,e)}return rc(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e)}readFeatureFromDocument(t,e){const i=this.readFeaturesFromDocument(t,e);return i.length>0?i[0]:null}readFeatureFromNode(t,e){return null}readFeatures(t,e){if(!t)return[];if(typeof t=="string"){const i=ic(t);return this.readFeaturesFromDocument(i,e)}return rc(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e)}readFeaturesFromDocument(t,e){const i=[];for(let n=t.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&en(i,this.readFeaturesFromNode(n,e));return i}readFeaturesFromNode(t,e){return Qt()}readGeometry(t,e){if(!t)return null;if(typeof t=="string"){const i=ic(t);return this.readGeometryFromDocument(i,e)}return rc(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e)}readGeometryFromDocument(t,e){return null}readGeometryFromNode(t,e){return null}readProjection(t){if(!t)return null;if(typeof t=="string"){const e=ic(t);return this.readProjectionFromDocument(e)}return rc(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}readProjectionFromDocument(t){return this.dataProjection}readProjectionFromNode(t){return this.dataProjection}writeFeature(t,e){const i=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(i)}writeFeatureNode(t,e){return null}writeFeatures(t,e){const i=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(i)}writeFeaturesNode(t,e){return null}writeGeometry(t,e){const i=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(i)}writeGeometryNode(t,e){return null}}const Qo="http://www.opengis.net/gml",pX=/^\s*$/;let At=class extends RA{constructor(t){super(),t=t||{},this.featureType=t.featureType,this.featureNS=t.featureNS,this.srsName=t.srsName,this.schemaLocation="",this.FEATURE_COLLECTION_PARSERS={},this.FEATURE_COLLECTION_PARSERS[this.namespace]={featureMember:ie(this.readFeaturesInternal),featureMembers:Xt(this.readFeaturesInternal)},this.supportedMediaTypes=["application/gml+xml"]}readFeaturesInternal(t,e){const i=t.localName;let n=null;if(i=="FeatureCollection")n=qt([],this.FEATURE_COLLECTION_PARSERS,t,e,this);else if(i=="featureMembers"||i=="featureMember"||i=="member"){const s=e[0];let o=s.featureType,a=s.featureNS;const l="p",c="p0";if(!o&&t.childNodes){o=[],a={};for(let d=0,g=t.childNodes.length;d<g;++d){const f=t.childNodes[d];if(f.nodeType===1){const p=f.nodeName.split(":").pop();if(!o.includes(p)){let m="",y=0;const _=f.namespaceURI;for(const x in a){if(a[x]===_){m=x;break}++y}m||(m=l+y,a[m]=_),o.push(m+":"+p)}}}i!="featureMember"&&(s.featureType=o,s.featureNS=a)}if(typeof a=="string"){const d=a;a={},a[c]=d}const h={},u=Array.isArray(o)?o:[o];for(const d in a){const g={};for(let f=0,p=u.length;f<p;++f)(u[f].includes(":")?u[f].split(":")[0]:c)===d&&(g[u[f].split(":").pop()]=i=="featureMembers"?ie(this.readFeatureElement,this):Xt(this.readFeatureElement,this));h[a[d]]=g}i=="featureMember"||i=="member"?n=qt(void 0,h,t,e):n=qt([],h,t,e)}return n===null&&(n=[]),n}readGeometryOrExtent(t,e){const i=e[0];return i.srsName=t.firstElementChild.getAttribute("srsName"),i.srsDimension=t.firstElementChild.getAttribute("srsDimension"),qt(null,this.GEOMETRY_PARSERS,t,e,this)}readExtentElement(t,e){const i=e[0],n=this.readGeometryOrExtent(t,e);return n?Dk(n,i):void 0}readGeometryElement(t,e){const i=e[0],n=this.readGeometryOrExtent(t,e);return n?rh(n,!1,i):void 0}readFeatureElementInternal(t,e,i){let n;const s={};for(let l=t.firstElementChild;l;l=l.nextElementSibling){let c;const h=l.localName;l.childNodes.length===0||l.childNodes.length===1&&(l.firstChild.nodeType===3||l.firstChild.nodeType===4)?(c=Gc(l,!1),pX.test(c)&&(c=void 0)):(i&&(c=h==="boundedBy"?this.readExtentElement(l,e):this.readGeometryElement(l,e)),c?h!=="boundedBy"&&(n=h):c=this.readFeatureElementInternal(l,e,!1));const u=l.attributes.length;if(u>0&&!(c instanceof qw)){c={_content_:c};for(let d=0;d<u;d++){const g=l.attributes[d].name;c[g]=l.attributes[d].value}}s[h]?(s[h]instanceof Array||(s[h]=[s[h]]),s[h].push(c)):s[h]=c}if(!i)return s;const o=new ed(s);n&&o.setGeometryName(n);const a=t.getAttribute("fid")||OH(t,this.namespace,"id");return a&&o.setId(a),o}readFeatureElement(t,e){return this.readFeatureElementInternal(t,e,!0)}readPoint(t,e){const i=this.readFlatCoordinatesFromNode(t,e);if(i)return new xl(i,"XYZ")}readMultiPoint(t,e){const i=qt([],this.MULTIPOINT_PARSERS,t,e,this);if(i)return new rd(i)}readMultiLineString(t,e){const i=qt([],this.MULTILINESTRING_PARSERS,t,e,this);if(i)return new Dc(i)}readMultiPolygon(t,e){const i=qt([],this.MULTIPOLYGON_PARSERS,t,e,this);if(i)return new $c(i)}pointMemberParser(t,e){fc(this.POINTMEMBER_PARSERS,t,e,this)}lineStringMemberParser(t,e){fc(this.LINESTRINGMEMBER_PARSERS,t,e,this)}polygonMemberParser(t,e){fc(this.POLYGONMEMBER_PARSERS,t,e,this)}readLineString(t,e){const i=this.readFlatCoordinatesFromNode(t,e);if(i)return new Nu(i,"XYZ")}readFlatLinearRing(t,e){const i=qt(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this);if(i)return i}readLinearRing(t,e){const i=this.readFlatCoordinatesFromNode(t,e);if(i)return new ux(i,"XYZ")}readPolygon(t,e){const i=qt([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this);if(i&&i[0]){const n=i[0],s=[n.length];let o,a;for(o=1,a=i.length;o<a;++o)en(n,i[o]),s.push(n.length);return new ia(n,"XYZ",s)}}readFlatCoordinatesFromNode(t,e){return qt(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)}readGeometryFromNode(t,e){return this.readGeometryElement(t,[this.getReadOptions(t,e||{})])||null}readFeaturesFromNode(t,e){const i={featureType:this.featureType,featureNS:this.featureNS};return i&&Object.assign(i,this.getReadOptions(t,e)),this.readFeaturesInternal(t,[i])||[]}readProjectionFromNode(t){return Wt(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))}};At.prototype.namespace=Qo;At.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}};At.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}};At.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}};At.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:ie(At.prototype.pointMemberParser),pointMembers:ie(At.prototype.pointMemberParser)}};At.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:ie(At.prototype.lineStringMemberParser),lineStringMembers:ie(At.prototype.lineStringMemberParser)}};At.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:ie(At.prototype.polygonMemberParser),polygonMembers:ie(At.prototype.polygonMemberParser)}};At.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:ie(At.prototype.readFlatCoordinatesFromNode)}};At.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:ie(At.prototype.readLineString)}};At.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:ie(At.prototype.readPolygon)}};At.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:Xt(At.prototype.readFlatLinearRing)}};const mX=Qo+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",yX={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};let be=class extends At{constructor(t){t=t||{},super(t),this.FEATURE_COLLECTION_PARSERS[Qo].featureMember=ie(this.readFeaturesInternal),this.schemaLocation=t.schemaLocation?t.schemaLocation:mX}readFlatCoordinates(t,e){const i=Gc(t,!1).replace(/^\s*|\s*$/g,""),n=e[0].srsName;let s="enu";if(n){const l=Wt(n);l&&(s=l.getAxisOrientation())}const o=i.trim().split(/\s+/),a=[];for(let l=0,c=o.length;l<c;l++){const h=o[l].split(/,+/),u=parseFloat(h[0]),d=parseFloat(h[1]),g=h.length===3?parseFloat(h[2]):0;s.startsWith("en")?a.push(u,d,g):a.push(d,u,g)}return a}readBox(t,e){const i=qt([null],this.BOX_PARSERS_,t,e,this);return Fs(i[1][0],i[1][1],i[1][3],i[1][4])}innerBoundaryIsParser(t,e){const i=qt(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)}outerBoundaryIsParser(t,e){const i=qt(void 0,this.RING_PARSERS,t,e,this);if(i){const n=e[e.length-1];n[0]=i}}GEOMETRY_NODE_FACTORY_(t,e,i){const n=e[e.length-1],s=n.multiSurface,o=n.surface,a=n.multiCurve;return Array.isArray(t)?i="Envelope":(i=t.getType(),i==="MultiPolygon"&&s===!0?i="MultiSurface":i==="Polygon"&&o===!0?i="Surface":i==="MultiLineString"&&a===!0&&(i="MultiCurve")),de("http://www.opengis.net/gml",i)}writeFeatureElement(t,e,i){const n=e.getId();n&&t.setAttribute("fid",n);const s=i[i.length-1],o=s.featureNS,a=e.getGeometryName();s.serializers||(s.serializers={},s.serializers[o]={});const l=[],c=[];if(e.hasProperties()){const u=e.getProperties();for(const d in u){const g=u[d];g!=null&&(l.push(d),c.push(g),d==a||typeof g.getSimplifiedGeometry=="function"?d in s.serializers[o]||(s.serializers[o][d]=J(this.writeGeometryElement,this)):d in s.serializers[o]||(s.serializers[o][d]=J(ni)))}}const h=Object.assign({},s);h.node=t,Gr(h,s.serializers,Gn(void 0,o),c,i,l)}writeCurveOrLineString(t,e,i){const n=i[i.length-1].srsName;if(t.nodeName!=="LineStringSegment"&&n&&t.setAttribute("srsName",n),t.nodeName==="LineString"||t.nodeName==="LineStringSegment"){const s=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(s),this.writeCoordinates_(s,e,i)}else if(t.nodeName==="Curve"){const s=de(t.namespaceURI,"segments");t.appendChild(s),this.writeCurveSegments_(s,e,i)}}writeLineStringOrCurveMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))}writeMultiCurveOrLineString(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=n.curve;o&&t.setAttribute("srsName",o);const l=e.getLineStrings();Gr({node:t,hasZ:s,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeGeometryElement(t,e,i){const n=i[i.length-1],s=Object.assign({},n);s.node=t;let o;Array.isArray(e)?o=Dk(e,n):o=rh(e,!0,n),Gr(s,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],i,void 0,this)}createCoordinatesNode_(t){const e=de(t,"coordinates");return e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," "),e}writeCoordinates_(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=e.getCoordinates(),l=a.length,c=new Array(l);for(let h=0;h<l;++h){const u=a[h];c[h]=this.getCoords_(u,o,s)}ni(t,c.join(" "))}writeCurveSegments_(t,e,i){const n=de(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)}writeSurfaceOrPolygon(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName;if(t.nodeName!=="PolygonPatch"&&o&&t.setAttribute("srsName",o),t.nodeName==="Polygon"||t.nodeName==="PolygonPatch"){const a=e.getLinearRings();Gr({node:t,hasZ:s,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,i,void 0,this)}else if(t.nodeName==="Surface"){const a=de(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,i)}}RING_NODE_FACTORY_(t,e,i){const n=e[e.length-1],s=n.node,o=n.exteriorWritten;return o===void 0&&(n.exteriorWritten=!0),de(s.namespaceURI,o!==void 0?"innerBoundaryIs":"outerBoundaryIs")}writeSurfacePatches_(t,e,i){const n=de(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)}writeRing(t,e,i){const n=de(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)}getCoords_(t,e,i){let n=(e?Wt(e).getAxisOrientation():"enu").startsWith("en")?t[0]+","+t[1]:t[1]+","+t[0];if(i){const s=t[2]||0;n+=","+s}return n}writePoint(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName;o&&t.setAttribute("srsName",o);const a=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(a);const l=e.getCoordinates(),c=this.getCoords_(l,o,s);ni(a,c)}writeMultiPoint(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName;o&&t.setAttribute("srsName",o);const a=e.getPoints();Gr({node:t,hasZ:s,srsName:o},this.POINTMEMBER_SERIALIZERS,Gn("pointMember"),a,i,void 0,this)}writePointMember(t,e,i){const n=de(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)}writeLinearRing(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(s),this.writeCoordinates_(s,e,i)}writeMultiSurfaceOrPolygon(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=n.surface;o&&t.setAttribute("srsName",o);const l=e.getPolygons();Gr({node:t,hasZ:s,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeSurfaceOrPolygonMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))}writeEnvelope(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=["lowerCorner","upperCorner"],o=[e[0]+" "+e[1],e[2]+" "+e[3]];Gr({node:t},this.ENVELOPE_SERIALIZERS,_A,o,i,s,this)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(t,e,i){const n=e[e.length-1].node;return de("http://www.opengis.net/gml",yX[n.nodeName])}};be.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:Xt(be.prototype.readFlatCoordinates)}};be.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:be.prototype.innerBoundaryIsParser,outerBoundaryIs:be.prototype.outerBoundaryIsParser}};be.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:ie(be.prototype.readFlatCoordinates)}};be.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:Xt(At.prototype.readPoint),MultiPoint:Xt(At.prototype.readMultiPoint),LineString:Xt(At.prototype.readLineString),MultiLineString:Xt(At.prototype.readMultiLineString),LinearRing:Xt(At.prototype.readLinearRing),Polygon:Xt(At.prototype.readPolygon),MultiPolygon:Xt(At.prototype.readMultiPolygon),Box:Xt(be.prototype.readBox)}};be.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:J(be.prototype.writeCurveOrLineString),MultiCurve:J(be.prototype.writeMultiCurveOrLineString),Point:J(be.prototype.writePoint),MultiPoint:J(be.prototype.writeMultiPoint),LineString:J(be.prototype.writeCurveOrLineString),MultiLineString:J(be.prototype.writeMultiCurveOrLineString),LinearRing:J(be.prototype.writeLinearRing),Polygon:J(be.prototype.writeSurfaceOrPolygon),MultiPolygon:J(be.prototype.writeMultiSurfaceOrPolygon),Surface:J(be.prototype.writeSurfaceOrPolygon),MultiSurface:J(be.prototype.writeMultiSurfaceOrPolygon),Envelope:J(be.prototype.writeEnvelope)}};be.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:J(be.prototype.writeLineStringOrCurveMember),curveMember:J(be.prototype.writeLineStringOrCurveMember)}};be.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:J(be.prototype.writeRing),innerBoundaryIs:J(be.prototype.writeRing)}};be.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:J(be.prototype.writePointMember)}};be.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:J(be.prototype.writeSurfaceOrPolygonMember),polygonMember:J(be.prototype.writeSurfaceOrPolygonMember)}};be.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:J(ni),upperCorner:J(ni)}};const _X=Qo+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",vX={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};let lt=class extends At{constructor(t){t=t||{},super(t),this.surface_=t.surface!==void 0?t.surface:!1,this.curve_=t.curve!==void 0?t.curve:!1,this.multiCurve_=t.multiCurve!==void 0?t.multiCurve:!0,this.multiSurface_=t.multiSurface!==void 0?t.multiSurface:!0,this.schemaLocation=t.schemaLocation?t.schemaLocation:_X,this.hasZ=t.hasZ!==void 0?t.hasZ:!1}readMultiCurve(t,e){const i=qt([],this.MULTICURVE_PARSERS,t,e,this);if(i)return new Dc(i)}readFlatCurveRing(t,e){const i=qt([],this.MULTICURVE_PARSERS,t,e,this),n=[];for(let s=0,o=i.length;s<o;++s)en(n,i[s].getFlatCoordinates());return n}readMultiSurface(t,e){const i=qt([],this.MULTISURFACE_PARSERS,t,e,this);if(i)return new $c(i)}curveMemberParser(t,e){fc(this.CURVEMEMBER_PARSERS,t,e,this)}surfaceMemberParser(t,e){fc(this.SURFACEMEMBER_PARSERS,t,e,this)}readPatch(t,e){return qt([null],this.PATCHES_PARSERS,t,e,this)}readSegment(t,e){return qt([],this.SEGMENTS_PARSERS,t,e,this)}readPolygonPatch(t,e){return qt([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this)}readLineStringSegment(t,e){return qt([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)}interiorParser(t,e){const i=qt(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)}exteriorParser(t,e){const i=qt(void 0,this.RING_PARSERS,t,e,this);if(i){const n=e[e.length-1];n[0]=i}}readSurface(t,e){const i=qt([null],this.SURFACE_PARSERS,t,e,this);if(i&&i[0]){const n=i[0],s=[n.length];let o,a;for(o=1,a=i.length;o<a;++o)en(n,i[o]),s.push(n.length);return new ia(n,"XYZ",s)}}readCurve(t,e){const i=qt([null],this.CURVE_PARSERS,t,e,this);if(i)return new Nu(i,"XYZ")}readEnvelope(t,e){const i=qt([null],this.ENVELOPE_PARSERS,t,e,this);return Fs(i[1][0],i[1][1],i[2][0],i[2][1])}readFlatPos(t,e){let i=Gc(t,!1);const n=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,s=[];let o;for(;o=n.exec(i);)s.push(parseFloat(o[1])),i=i.substr(o[0].length);if(i!=="")return;const a=e[0].srsName;if((a?Wt(a).getAxisOrientation():"enu")==="neu")for(let c=0,h=s.length;c<h;c+=3){const u=s[c],d=s[c+1];s[c]=d,s[c+1]=u}const l=s.length;if(l==2&&s.push(0),l!==0)return s}readFlatPosList(t,e){const i=Gc(t,!1).replace(/^\s*|\s*$/g,""),n=e[0],s=n.srsName,o=n.srsDimension,a=s?Wt(s).getAxisOrientation():"enu",l=i.split(/\s+/);let c=2;t.getAttribute("srsDimension")?c=Yh(t.getAttribute("srsDimension")):t.getAttribute("dimension")?c=Yh(t.getAttribute("dimension")):t.parentNode.getAttribute("srsDimension")?c=Yh(t.parentNode.getAttribute("srsDimension")):o&&(c=Yh(o));const h=a.startsWith("en");let u,d,g;const f=[];for(let p=0,m=l.length;p<m;p+=c)u=parseFloat(l[p]),d=parseFloat(l[p+1]),g=c===3?parseFloat(l[p+2]):0,h?f.push(u,d,g):f.push(d,u,g);return f}writePos_(t,e,i){const n=i[i.length-1],s=n.hasZ,o=s?"3":"2";t.setAttribute("srsDimension",o);const a=n.srsName,l=a?Wt(a).getAxisOrientation():"enu",c=e.getCoordinates();let h=l.startsWith("en")?c[0]+" "+c[1]:c[1]+" "+c[0];if(s){const u=c[2]||0;h+=" "+u}ni(t,h)}getCoords_(t,e,i){let n=(e?Wt(e).getAxisOrientation():"enu").startsWith("en")?t[0]+" "+t[1]:t[1]+" "+t[0];if(i){const s=t[2]||0;n+=" "+s}return n}writePosList_(t,e,i){const n=i[i.length-1],s=n.hasZ,o=s?"3":"2";t.setAttribute("srsDimension",o);const a=n.srsName,l=e.getCoordinates(),c=l.length,h=new Array(c);let u;for(let d=0;d<c;++d)u=l[d],h[d]=this.getCoords_(u,a,s);ni(t,h.join(" "))}writePoint(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=de(t.namespaceURI,"pos");t.appendChild(s),this.writePos_(s,e,i)}writeEnvelope(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=["lowerCorner","upperCorner"],o=[e[0]+" "+e[1],e[2]+" "+e[3]];Gr({node:t},this.ENVELOPE_SERIALIZERS,_A,o,i,s,this)}writeLinearRing(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=de(t.namespaceURI,"posList");t.appendChild(s),this.writePosList_(s,e,i)}RING_NODE_FACTORY_(t,e,i){const n=e[e.length-1],s=n.node,o=n.exteriorWritten;return o===void 0&&(n.exteriorWritten=!0),de(s.namespaceURI,o!==void 0?"interior":"exterior")}writeSurfaceOrPolygon(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName;if(t.nodeName!=="PolygonPatch"&&o&&t.setAttribute("srsName",o),t.nodeName==="Polygon"||t.nodeName==="PolygonPatch"){const a=e.getLinearRings();Gr({node:t,hasZ:s,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,i,void 0,this)}else if(t.nodeName==="Surface"){const a=de(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,i)}}writeCurveOrLineString(t,e,i){const n=i[i.length-1].srsName;if(t.nodeName!=="LineStringSegment"&&n&&t.setAttribute("srsName",n),t.nodeName==="LineString"||t.nodeName==="LineStringSegment"){const s=de(t.namespaceURI,"posList");t.appendChild(s),this.writePosList_(s,e,i)}else if(t.nodeName==="Curve"){const s=de(t.namespaceURI,"segments");t.appendChild(s),this.writeCurveSegments_(s,e,i)}}writeMultiSurfaceOrPolygon(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=n.surface;o&&t.setAttribute("srsName",o);const l=e.getPolygons();Gr({node:t,hasZ:s,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeMultiPoint(t,e,i){const n=i[i.length-1],s=n.srsName,o=n.hasZ;s&&t.setAttribute("srsName",s);const a=e.getPoints();Gr({node:t,hasZ:o,srsName:s},this.POINTMEMBER_SERIALIZERS,Gn("pointMember"),a,i,void 0,this)}writeMultiCurveOrLineString(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=n.curve;o&&t.setAttribute("srsName",o);const l=e.getLineStrings();Gr({node:t,hasZ:s,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeRing(t,e,i){const n=de(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)}writeSurfaceOrPolygonMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))}writePointMember(t,e,i){const n=de(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)}writeLineStringOrCurveMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))}writeSurfacePatches_(t,e,i){const n=de(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)}writeCurveSegments_(t,e,i){const n=de(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)}writeGeometryElement(t,e,i){const n=i[i.length-1],s=Object.assign({},n);s.node=t;let o;Array.isArray(e)?o=Dk(e,n):o=rh(e,!0,n),Gr(s,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],i,void 0,this)}writeFeatureElement(t,e,i){const n=e.getId();n&&t.setAttribute("fid",n);const s=i[i.length-1],o=s.featureNS,a=e.getGeometryName();s.serializers||(s.serializers={},s.serializers[o]={});const l=[],c=[];if(e.hasProperties()){const u=e.getProperties();for(const d in u){const g=u[d];g!=null&&(l.push(d),c.push(g),d==a||typeof g.getSimplifiedGeometry=="function"?d in s.serializers[o]||(s.serializers[o][d]=J(this.writeGeometryElement,this)):d in s.serializers[o]||(s.serializers[o][d]=J(ni)))}}const h=Object.assign({},s);h.node=t,Gr(h,s.serializers,Gn(void 0,o),c,i,l)}writeFeatureMembers_(t,e,i){const n=i[i.length-1],s=n.featureType,o=n.featureNS,a={};a[o]={},a[o][s]=J(this.writeFeatureElement,this);const l=Object.assign({},n);l.node=t,Gr(l,a,Gn(s,o),e,i)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(t,e,i){const n=e[e.length-1].node;return de(this.namespace,vX[n.nodeName])}GEOMETRY_NODE_FACTORY_(t,e,i){const n=e[e.length-1],s=n.multiSurface,o=n.surface,a=n.curve,l=n.multiCurve;return Array.isArray(t)?i="Envelope":(i=t.getType(),i==="MultiPolygon"&&s===!0?i="MultiSurface":i==="Polygon"&&o===!0?i="Surface":i==="LineString"&&a===!0?i="Curve":i==="MultiLineString"&&l===!0&&(i="MultiCurve")),de(this.namespace,i)}writeGeometryNode(t,e){e=this.adaptOptions(e);const i=de(this.namespace,"geom"),n={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return e&&Object.assign(n,e),this.writeGeometryElement(i,t,[n]),i}writeFeaturesNode(t,e){e=this.adaptOptions(e);const i=de(this.namespace,"featureMembers");i.setAttributeNS(E2,"xsi:schemaLocation",this.schemaLocation);const n={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return e&&Object.assign(n,e),this.writeFeatureMembers_(i,t,[n]),i}};lt.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:Xt(lt.prototype.readFlatPos),posList:Xt(lt.prototype.readFlatPosList),coordinates:Xt(be.prototype.readFlatCoordinates)}};lt.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:lt.prototype.interiorParser,exterior:lt.prototype.exteriorParser}};lt.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:Xt(At.prototype.readPoint),MultiPoint:Xt(At.prototype.readMultiPoint),LineString:Xt(At.prototype.readLineString),MultiLineString:Xt(At.prototype.readMultiLineString),LinearRing:Xt(At.prototype.readLinearRing),Polygon:Xt(At.prototype.readPolygon),MultiPolygon:Xt(At.prototype.readMultiPolygon),Surface:Xt(lt.prototype.readSurface),MultiSurface:Xt(lt.prototype.readMultiSurface),Curve:Xt(lt.prototype.readCurve),MultiCurve:Xt(lt.prototype.readMultiCurve),Envelope:Xt(lt.prototype.readEnvelope)}};lt.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:ie(lt.prototype.curveMemberParser),curveMembers:ie(lt.prototype.curveMemberParser)}};lt.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:ie(lt.prototype.surfaceMemberParser),surfaceMembers:ie(lt.prototype.surfaceMemberParser)}};lt.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:ie(At.prototype.readLineString),Curve:ie(lt.prototype.readCurve)}};lt.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:ie(At.prototype.readPolygon),Surface:ie(lt.prototype.readSurface)}};lt.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:Xt(lt.prototype.readPatch)}};lt.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:Xt(lt.prototype.readSegment)}};lt.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:ie(lt.prototype.readFlatPosList),upperCorner:ie(lt.prototype.readFlatPosList)}};lt.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:Xt(lt.prototype.readPolygonPatch)}};lt.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:yA(lt.prototype.readLineStringSegment)}};At.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:Xt(At.prototype.readFlatLinearRing),Ring:Xt(lt.prototype.readFlatCurveRing)}};lt.prototype.writeFeatures;lt.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:J(lt.prototype.writeRing),interior:J(lt.prototype.writeRing)}};lt.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:J(ni),upperCorner:J(ni)}};lt.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:J(lt.prototype.writeSurfaceOrPolygonMember),polygonMember:J(lt.prototype.writeSurfaceOrPolygonMember)}};lt.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:J(lt.prototype.writePointMember)}};lt.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:J(lt.prototype.writeLineStringOrCurveMember),curveMember:J(lt.prototype.writeLineStringOrCurveMember)}};lt.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:J(lt.prototype.writeCurveOrLineString),MultiCurve:J(lt.prototype.writeMultiCurveOrLineString),Point:J(lt.prototype.writePoint),MultiPoint:J(lt.prototype.writeMultiPoint),LineString:J(lt.prototype.writeCurveOrLineString),MultiLineString:J(lt.prototype.writeMultiCurveOrLineString),LinearRing:J(lt.prototype.writeLinearRing),Polygon:J(lt.prototype.writeSurfaceOrPolygon),MultiPolygon:J(lt.prototype.writeMultiSurfaceOrPolygon),Surface:J(lt.prototype.writeSurfaceOrPolygon),MultiSurface:J(lt.prototype.writeMultiSurfaceOrPolygon),Envelope:J(lt.prototype.writeEnvelope)}};const M2=65536*65536,h5=1/M2,xX=12,u5=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),Q_=0,$p=1,Md=2,Gp=5;class IA{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,e,i=this.length){for(;this.pos<i;){const n=this.readVarint(),s=n>>3,o=this.pos;this.type=n&7,t(s,e,this),this.pos===o&&this.skip(n)}return e}readMessage(t,e){return this.readFields(t,e,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*M2;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*M2;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const e=this.buf;let i,n;return n=e[this.pos++],i=n&127,n<128||(n=e[this.pos++],i|=(n&127)<<7,n<128)||(n=e[this.pos++],i|=(n&127)<<14,n<128)||(n=e[this.pos++],i|=(n&127)<<21,n<128)?i:(n=e[this.pos],i|=(n&15)<<28,wX(i,t,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2===1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=xX&&u5?u5.decode(this.buf.subarray(e,t)):FX(this.buf,e,t)}readBytes(){const t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e}readPackedVarint(t=[],e){const i=this.readPackedEnd();for(;this.pos<i;)t.push(this.readVarint(e));return t}readPackedSVarint(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===Md?this.readVarint()+this.pos:this.pos+1}skip(t){const e=t&7;if(e===Q_)for(;this.buf[this.pos++]>127;);else if(e===Md)this.pos=this.readVarint()+this.pos;else if(e===Gp)this.pos+=4;else if(e===$p)this.pos+=8;else throw new Error(`Unimplemented type: ${e}`)}writeTag(t,e){this.writeVarint(t<<3|e)}realloc(t){let e=this.length||16;for(;e<this.pos+t;)e*=2;if(e!==this.length){const i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.dataView=new DataView(i.buffer),this.length=e}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*h5),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*h5),!0),this.pos+=8}writeVarint(t){if(t=+t||0,t>268435455||t<0){kX(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))}writeSVarint(t){this.writeVarint(t<0?-t*2-1:t*2)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(t.length*4),this.pos++;const e=this.pos;this.pos=NX(this.buf,t,this.pos);const i=this.pos-e;i>=128&&d5(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const e=t.length;this.writeVarint(e),this.realloc(e);for(let i=0;i<e;i++)this.buf[this.pos++]=t[i]}writeRawMessage(t,e){this.pos++;const i=this.pos;t(e,this);const n=this.pos-i;n>=128&&d5(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n}writeMessage(t,e,i){this.writeTag(t,Md),this.writeRawMessage(e,i)}writePackedVarint(t,e){e.length&&this.writeMessage(t,TX,e)}writePackedSVarint(t,e){e.length&&this.writeMessage(t,CX,e)}writePackedBoolean(t,e){e.length&&this.writeMessage(t,IX,e)}writePackedFloat(t,e){e.length&&this.writeMessage(t,MX,e)}writePackedDouble(t,e){e.length&&this.writeMessage(t,RX,e)}writePackedFixed32(t,e){e.length&&this.writeMessage(t,PX,e)}writePackedSFixed32(t,e){e.length&&this.writeMessage(t,AX,e)}writePackedFixed64(t,e){e.length&&this.writeMessage(t,LX,e)}writePackedSFixed64(t,e){e.length&&this.writeMessage(t,OX,e)}writeBytesField(t,e){this.writeTag(t,Md),this.writeBytes(e)}writeFixed32Field(t,e){this.writeTag(t,Gp),this.writeFixed32(e)}writeSFixed32Field(t,e){this.writeTag(t,Gp),this.writeSFixed32(e)}writeFixed64Field(t,e){this.writeTag(t,$p),this.writeFixed64(e)}writeSFixed64Field(t,e){this.writeTag(t,$p),this.writeSFixed64(e)}writeVarintField(t,e){this.writeTag(t,Q_),this.writeVarint(e)}writeSVarintField(t,e){this.writeTag(t,Q_),this.writeSVarint(e)}writeStringField(t,e){this.writeTag(t,Md),this.writeString(e)}writeFloatField(t,e){this.writeTag(t,Gp),this.writeFloat(e)}writeDoubleField(t,e){this.writeTag(t,$p),this.writeDouble(e)}writeBooleanField(t,e){this.writeVarintField(t,+e)}}function wX(r,t,e){const i=e.buf;let n,s;if(s=i[e.pos++],n=(s&112)>>4,s<128||(s=i[e.pos++],n|=(s&127)<<3,s<128)||(s=i[e.pos++],n|=(s&127)<<10,s<128)||(s=i[e.pos++],n|=(s&127)<<17,s<128)||(s=i[e.pos++],n|=(s&127)<<24,s<128)||(s=i[e.pos++],n|=(s&1)<<31,s<128))return bX(r,n,t);throw new Error("Expected varint not more than 10 bytes")}function bX(r,t,e){return e?t*4294967296+(r>>>0):(t>>>0)*4294967296+(r>>>0)}function kX(r,t){let e,i;if(r>=0?(e=r%4294967296|0,i=r/4294967296|0):(e=~(-r%4294967296),i=~(-r/4294967296),e^4294967295?e=e+1|0:(e=0,i=i+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),EX(e,i,t),SX(i,t)}function EX(r,t,e){e.buf[e.pos++]=r&127|128,r>>>=7,e.buf[e.pos++]=r&127|128,r>>>=7,e.buf[e.pos++]=r&127|128,r>>>=7,e.buf[e.pos++]=r&127|128,r>>>=7,e.buf[e.pos]=r&127}function SX(r,t){const e=(r&7)<<4;t.buf[t.pos++]|=e|((r>>>=3)?128:0),r&&(t.buf[t.pos++]=r&127|((r>>>=7)?128:0),r&&(t.buf[t.pos++]=r&127|((r>>>=7)?128:0),r&&(t.buf[t.pos++]=r&127|((r>>>=7)?128:0),r&&(t.buf[t.pos++]=r&127|((r>>>=7)?128:0),r&&(t.buf[t.pos++]=r&127)))))}function d5(r,t,e){const i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));e.realloc(i);for(let n=e.pos-1;n>=r;n--)e.buf[n+i]=e.buf[n]}function TX(r,t){for(let e=0;e<r.length;e++)t.writeVarint(r[e])}function CX(r,t){for(let e=0;e<r.length;e++)t.writeSVarint(r[e])}function MX(r,t){for(let e=0;e<r.length;e++)t.writeFloat(r[e])}function RX(r,t){for(let e=0;e<r.length;e++)t.writeDouble(r[e])}function IX(r,t){for(let e=0;e<r.length;e++)t.writeBoolean(r[e])}function PX(r,t){for(let e=0;e<r.length;e++)t.writeFixed32(r[e])}function AX(r,t){for(let e=0;e<r.length;e++)t.writeSFixed32(r[e])}function LX(r,t){for(let e=0;e<r.length;e++)t.writeFixed64(r[e])}function OX(r,t){for(let e=0;e<r.length;e++)t.writeSFixed64(r[e])}function FX(r,t,e){let i="",n=t;for(;n<e;){const s=r[n];let o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a>e)break;let l,c,h;a===1?s<128&&(o=s):a===2?(l=r[n+1],(l&192)===128&&(o=(s&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=r[n+1],c=r[n+2],(l&192)===128&&(c&192)===128&&(o=(s&15)<<12|(l&63)<<6|c&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=r[n+1],c=r[n+2],h=r[n+3],(l&192)===128&&(c&192)===128&&(h&192)===128&&(o=(s&15)<<18|(l&63)<<12|(c&63)<<6|h&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),n+=a}return i}function NX(r,t,e){for(let i=0,n,s;i<t.length;i++){if(n=t.charCodeAt(i),n>55295&&n<57344)if(s)if(n<56320){r[e++]=239,r[e++]=191,r[e++]=189,s=n;continue}else n=s-55296<<10|n-56320|65536,s=null;else{n>56319||i+1===t.length?(r[e++]=239,r[e++]=191,r[e++]=189):s=n;continue}else s&&(r[e++]=239,r[e++]=191,r[e++]=189,s=null);n<128?r[e++]=n:(n<2048?r[e++]=n>>6|192:(n<65536?r[e++]=n>>12|224:(r[e++]=n>>18|240,r[e++]=n>>12&63|128),r[e++]=n>>6&63|128),r[e++]=n&63|128)}return e}let DX=class extends Nk{constructor(r){super(),r=r||{},this.dataProjection=new Af({code:"",units:"tile-pixels"}),this.featureClass=r.featureClass?r.featureClass:Pn,this.geometryName_=r.geometryName,this.layerName_=r.layerName?r.layerName:"layer",this.layers_=r.layers?r.layers:null,this.idProperty_=r.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(r,t,e,i){r.pos=t.geometry;const n=r.readVarint()+r.pos;let s=1,o=0,a=0,l=0,c=0,h=0;for(;r.pos<n;){if(!o){const u=r.readVarint();s=u&7,o=u>>3}if(o--,s===1||s===2)a+=r.readSVarint(),l+=r.readSVarint(),s===1&&c>h&&(i.push(c),h=c),e.push(a,l),c+=2;else if(s===7)c>h&&(e.push(e[h],e[h+1]),c+=2);else throw new Error("Invalid command found in the PBF")}c>h&&(i.push(c),h=c)}createFeature_(r,t,e){const i=t.type;if(i===0)return null;let n;const s=t.properties;let o;this.idProperty_?(o=s[this.idProperty_],delete s[this.idProperty_]):o=t.id,s[this.layerName_]=t.layer.name;const a=[],l=[];this.readRawGeometry_(r,t,a,l);const c=qX(i,l.length);if(this.featureClass===Pn)n=new this.featureClass(c,a,l,2,s,o),n.transform(e.dataProjection);else{let h;if(c=="Polygon"){const g=Qw(a,l);h=g.length>1?new $c(a,"XY",g):new ia(a,"XY",l)}else h=c==="Point"?new xl(a,"XY"):c==="LineString"?new Nu(a,"XY"):c==="MultiPoint"?new rd(a,"XY"):c==="MultiLineString"?new Dc(a,"XY",l):null;const u=this.featureClass;n=new u,this.geometryName_&&n.setGeometryName(this.geometryName_);const d=rh(h,!1,e);n.setGeometry(d),o!==void 0&&n.setId(o),n.setProperties(s,!0)}return n}getType(){return"arraybuffer"}readFeatures(r,t){const e=this.layers_;t=this.adaptOptions(t);const i=Wt(t.dataProjection);i.setWorldExtent(t.extent),t.dataProjection=i;const n=new IA(r),s=n.readFields($X,{}),o=[];for(const a in s){if(e&&!e.includes(a))continue;const l=s[a],c=l?[0,0,l.extent,l.extent]:null;i.setExtent(c);for(let h=0,u=l.length;h<u;++h){const d=zX(n,l,h),g=this.createFeature_(n,d,t);g!==null&&o.push(g)}}return o}readProjection(r){return this.dataProjection}setLayers(r){this.layers_=r}};function $X(r,t,e){if(r===3){const i={keys:[],values:[],features:[]},n=e.readVarint()+e.pos;e.readFields(GX,i,n),i.length=i.features.length,i.length&&(t[i.name]=i)}}function GX(r,t,e){if(r===15)t.version=e.readVarint();else if(r===1)t.name=e.readString();else if(r===5)t.extent=e.readVarint();else if(r===2)t.features.push(e.pos);else if(r===3)t.keys.push(e.readString());else if(r===4){let i=null;const n=e.readVarint()+e.pos;for(;e.pos<n;)r=e.readVarint()>>3,i=r===1?e.readString():r===2?e.readFloat():r===3?e.readDouble():r===4?e.readVarint64():r===5?e.readVarint():r===6?e.readSVarint():r===7?e.readBoolean():null;t.values.push(i)}}function jX(r,t,e){if(r==1)t.id=e.readVarint();else if(r==2){const i=e.readVarint()+e.pos;for(;e.pos<i;){const n=t.layer.keys[e.readVarint()],s=t.layer.values[e.readVarint()];t.properties[n]=s}}else r==3?t.type=e.readVarint():r==4&&(t.geometry=e.pos)}function zX(r,t,e){r.pos=t.features[e];const i=r.readVarint()+r.pos,n={layer:t,type:0,properties:{}};return r.readFields(jX,n,i),n}function qX(r,t){let e;return r===1?e=t===1?"Point":"MultiPoint":r===2?e=t===1?"LineString":"MultiLineString":r===3&&(e="Polygon"),e}let Ne=class extends lt{constructor(t){t=t||{},super(t),this.schemaLocation=t.schemaLocation?t.schemaLocation:this.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd"}writeGeometryElement(t,e,i){const n=i[i.length-1];i[i.length-1]=Object.assign({multiCurve:!0,multiSurface:!0},n),super.writeGeometryElement(t,e,i)}};Ne.prototype.namespace="http://www.opengis.net/gml/3.2";Ne.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:Xt(lt.prototype.readFlatPos),posList:Xt(lt.prototype.readFlatPosList),coordinates:Xt(be.prototype.readFlatCoordinates)}};Ne.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:lt.prototype.interiorParser,exterior:lt.prototype.exteriorParser}};Ne.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:Xt(At.prototype.readPoint),MultiPoint:Xt(At.prototype.readMultiPoint),LineString:Xt(At.prototype.readLineString),MultiLineString:Xt(At.prototype.readMultiLineString),LinearRing:Xt(At.prototype.readLinearRing),Polygon:Xt(At.prototype.readPolygon),MultiPolygon:Xt(At.prototype.readMultiPolygon),Surface:Xt(Ne.prototype.readSurface),MultiSurface:Xt(lt.prototype.readMultiSurface),Curve:Xt(Ne.prototype.readCurve),MultiCurve:Xt(lt.prototype.readMultiCurve),Envelope:Xt(Ne.prototype.readEnvelope)}};Ne.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:ie(lt.prototype.curveMemberParser),curveMembers:ie(lt.prototype.curveMemberParser)}};Ne.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:ie(lt.prototype.surfaceMemberParser),surfaceMembers:ie(lt.prototype.surfaceMemberParser)}};Ne.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:ie(At.prototype.readLineString),Curve:ie(lt.prototype.readCurve)}};Ne.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:ie(At.prototype.readPolygon),Surface:ie(lt.prototype.readSurface)}};Ne.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:Xt(lt.prototype.readPatch)}};Ne.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:Xt(lt.prototype.readSegment)}};Ne.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:ie(lt.prototype.readFlatPosList),upperCorner:ie(lt.prototype.readFlatPosList)}};Ne.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:Xt(lt.prototype.readPolygonPatch)}};Ne.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:yA(lt.prototype.readLineStringSegment)}};Ne.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:ie(At.prototype.pointMemberParser),pointMembers:ie(At.prototype.pointMemberParser)}};Ne.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:ie(At.prototype.lineStringMemberParser),lineStringMembers:ie(At.prototype.lineStringMemberParser)}};Ne.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:ie(At.prototype.polygonMemberParser),polygonMembers:ie(At.prototype.polygonMemberParser)}};Ne.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:ie(At.prototype.readFlatCoordinatesFromNode)}};Ne.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:ie(At.prototype.readLineString)}};Ne.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:ie(At.prototype.readPolygon)}};Ne.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:Xt(At.prototype.readFlatLinearRing),Ring:Xt(Ne.prototype.readFlatCurveRing)}};Ne.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:J(lt.prototype.writeRing),interior:J(lt.prototype.writeRing)}};Ne.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:J(ni),upperCorner:J(ni)}};Ne.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:J(lt.prototype.writeSurfaceOrPolygonMember),polygonMember:J(lt.prototype.writeSurfaceOrPolygonMember)}};Ne.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:J(lt.prototype.writePointMember)}};Ne.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:J(lt.prototype.writeLineStringOrCurveMember),curveMember:J(lt.prototype.writeLineStringOrCurveMember)}};Ne.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:J(lt.prototype.writeCurveOrLineString),MultiCurve:J(lt.prototype.writeMultiCurveOrLineString),Point:J(Ne.prototype.writePoint),MultiPoint:J(lt.prototype.writeMultiPoint),LineString:J(lt.prototype.writeCurveOrLineString),MultiLineString:J(lt.prototype.writeMultiCurveOrLineString),LinearRing:J(lt.prototype.writeLinearRing),Polygon:J(lt.prototype.writeSurfaceOrPolygon),MultiPolygon:J(lt.prototype.writeMultiSurfaceOrPolygon),Surface:J(lt.prototype.writeSurfaceOrPolygon),MultiSurface:J(lt.prototype.writeMultiSurfaceOrPolygon),Envelope:J(lt.prototype.writeEnvelope)}};class PA{constructor(t){this.tagName_=t}getTagName(){return this.tagName_}}class BX extends PA{constructor(t,e){super(t),this.conditions=e,_e(this.conditions.length>=2,"At least 2 conditions are required")}}class UX extends BX{constructor(t){super("And",Array.prototype.slice.call(arguments))}}class WX extends PA{constructor(t,e,i){if(super("BBOX"),this.geometryName=t,this.extent=e,e.length!==4)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");this.srsName=i}}function VX(r){const t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(UX,t))}function ZX(r,t,e){return new WX(r,t,e)}const g5={"http://www.opengis.net/gml":{boundedBy:Tt(At.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:ie(At.prototype.readFeaturesInternal)}},HX={"http://www.opengis.net/wfs":{totalInserted:Tt(mn),totalUpdated:Tt(mn),totalDeleted:Tt(mn)},"http://www.opengis.net/wfs/2.0":{totalInserted:Tt(mn),totalUpdated:Tt(mn),totalDeleted:Tt(mn)}},YX={"http://www.opengis.net/wfs":{TransactionSummary:Tt(p5,"transactionSummary"),InsertResults:Tt(y5,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:Tt(p5,"transactionSummary"),InsertResults:Tt(y5,"insertIds")}},XX={"http://www.opengis.net/wfs":{PropertyName:J(ni)},"http://www.opengis.net/wfs/2.0":{PropertyName:J(ni)}},AA={"http://www.opengis.net/wfs":{Insert:J(_5),Update:J(x5),Delete:J(v5),Property:J(w5),Native:J(b5)},"http://www.opengis.net/wfs/2.0":{Insert:J(_5),Update:J(x5),Delete:J(v5),Property:J(w5),Native:J(b5)}},LA="feature",qk="http://www.w3.org/2000/xmlns/",Bk={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},R2={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},Uk={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},f5={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},Wk={"2.0.0":Ne,"1.1.0":lt,"1.0.0":be},KX="1.1.0";class OA extends RA{constructor(t){super(),t=t||{},this.version_=t.version?t.version:KX,this.featureType_=t.featureType,this.featureNS_=t.featureNS,this.gmlFormat_=t.gmlFormat?t.gmlFormat:new Wk[this.version_],this.schemaLocation_=t.schemaLocation?t.schemaLocation:f5[this.version_]}getFeatureType(){return this.featureType_}setFeatureType(t){this.featureType_=t}readFeaturesFromNode(t,e){const i={node:t};Object.assign(i,{featureType:this.featureType_,featureNS:this.featureNS_}),Object.assign(i,this.getReadOptions(t,e||{}));const n=[i];let s;this.version_==="2.0.0"?s=g5:s=this.gmlFormat_.FEATURE_COLLECTION_PARSERS;let o=qt([],s,t,n,this.gmlFormat_);return o||(o=[]),o}readTransactionResponse(t){if(t){if(typeof t=="string"){const e=ic(t);return this.readTransactionResponseFromDocument(e)}return rc(t)?this.readTransactionResponseFromDocument(t):this.readTransactionResponseFromNode(t)}}readFeatureCollectionMetadata(t){if(t){if(typeof t=="string"){const e=ic(t);return this.readFeatureCollectionMetadataFromDocument(e)}return rc(t)?this.readFeatureCollectionMetadataFromDocument(t):this.readFeatureCollectionMetadataFromNode(t)}}readFeatureCollectionMetadataFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(e)}readFeatureCollectionMetadataFromNode(t){const e={},i=Yh(t.getAttribute("numberOfFeatures"));return e.numberOfFeatures=i,qt(e,g5,t,[],this.gmlFormat_)}readTransactionResponseFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(e)}readTransactionResponseFromNode(t){return qt({},YX,t,[])}writeGetFeature(t){const e=de(R2[this.version_],"GetFeature");e.setAttribute("service","WFS"),e.setAttribute("version",this.version_),t.handle&&e.setAttribute("handle",t.handle),t.outputFormat&&e.setAttribute("outputFormat",t.outputFormat),t.maxFeatures!==void 0&&e.setAttribute("maxFeatures",String(t.maxFeatures)),t.resultType&&e.setAttribute("resultType",t.resultType),t.startIndex!==void 0&&e.setAttribute("startIndex",String(t.startIndex)),t.count!==void 0&&e.setAttribute("count",String(t.count)),t.viewParams!==void 0&&e.setAttribute("viewParams",t.viewParams),e.setAttributeNS(E2,"xsi:schemaLocation",this.schemaLocation_);const i={node:e};if(Object.assign(i,{version:this.version_,srsName:t.srsName,featureNS:t.featureNS?t.featureNS:this.featureNS_,featurePrefix:t.featurePrefix,propertyNames:t.propertyNames?t.propertyNames:[]}),_e(Array.isArray(t.featureTypes),"`options.featureTypes` must be an Array"),typeof t.featureTypes[0]=="string"){let n=t.filter;t.bbox&&(_e(t.geometryName,"`options.geometryName` must also be provided when `options.bbox` is set"),n=this.combineBboxAndFilter(t.geometryName,t.bbox,t.srsName,n)),Object.assign(i,{geometryName:t.geometryName,filter:n}),A5(e,t.featureTypes,[i])}else t.featureTypes.forEach(n=>{const s=this.combineBboxAndFilter(n.geometryName,n.bbox,t.srsName,t.filter);Object.assign(i,{geometryName:n.geometryName,filter:s}),A5(e,[n.name],[i])});return e}combineBboxAndFilter(t,e,i,n){const s=ZX(t,e,i);return n?VX(n,s):s}writeTransaction(t,e,i,n){const s=[],o=n.version?n.version:this.version_,a=de(R2[o],"Transaction");a.setAttribute("service","WFS"),a.setAttribute("version",o);let l;n&&(l=n.gmlOptions?n.gmlOptions:{},n.handle&&a.setAttribute("handle",n.handle)),a.setAttributeNS(E2,"xsi:schemaLocation",f5[o]);const c=QX(a,l,o,n);return t&&jp("Insert",t,s,c),e&&jp("Update",e,s,c),i&&jp("Delete",i,s,c),n.nativeElements&&jp("Native",n.nativeElements,s,c),a}readProjectionFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(e);return null}readProjectionFromNode(t){if(t.firstElementChild&&t.firstElementChild.firstElementChild){t=t.firstElementChild.firstElementChild;for(let e=t.firstElementChild;e;e=e.nextElementSibling)if(!(e.childNodes.length===0||e.childNodes.length===1&&e.firstChild.nodeType===3)){const i=[{}];return this.gmlFormat_.readGeometryElement(e,i),Wt(i.pop().srsName)}}return null}}function QX(r,t,e,i){const n=i.featurePrefix?i.featurePrefix:LA;let s;return e==="1.0.0"?s=2:e==="1.1.0"?s=3:e==="2.0.0"&&(s=3.2),Object.assign({node:r},{version:e,featureNS:i.featureNS,featureType:i.featureType,featurePrefix:n,gmlVersion:s,hasZ:i.hasZ,srsName:i.srsName},t)}function jp(r,t,e,i){Gr(i,AA,Gn(r),t,e)}function p5(r,t){return qt({},HX,r,t)}const JX={"http://www.opengis.net/ogc":{FeatureId:ie(function(r,t){return r.getAttribute("fid")})},"http://www.opengis.net/ogc/1.1":{FeatureId:ie(function(r,t){return r.getAttribute("fid")})}};function m5(r,t){fc(JX,r,t)}const tK={"http://www.opengis.net/wfs":{Feature:m5},"http://www.opengis.net/wfs/2.0":{Feature:m5}};function y5(r,t){return qt([],tK,r,t)}function _5(r,t,e){const i=e[e.length-1],n=i.featureType,s=i.featureNS,o=i.gmlVersion,a=de(s,n);r.appendChild(a),o===2?be.prototype.writeFeatureElement(a,t,e):o===3?lt.prototype.writeFeatureElement(a,t,e):Ne.prototype.writeFeatureElement(a,t,e)}function FA(r,t,e){const i=e[e.length-1].version,n=Bk[i],s=de(n,"Filter"),o=de(n,"FeatureId");s.appendChild(o),o.setAttribute("fid",t),r.appendChild(s)}function Vk(r,t){r=r||LA;const e=r+":";return t.startsWith(e)?t:e+t}function v5(r,t,e){const i=e[e.length-1];_e(t.getId()!==void 0,"Features must have an id set");const n=i.featureType,s=i.featurePrefix,o=i.featureNS,a=Vk(s,n);r.setAttribute("typeName",a),r.setAttributeNS(qk,"xmlns:"+s,o);const l=t.getId();l!==void 0&&FA(r,l,e)}function x5(r,t,e){const i=e[e.length-1];_e(t.getId()!==void 0,"Features must have an id set");const n=i.version,s=i.featureType,o=i.featurePrefix,a=i.featureNS,l=Vk(o,s),c=t.getGeometryName();r.setAttribute("typeName",l),r.setAttributeNS(qk,"xmlns:"+o,a);const h=t.getId();if(h!==void 0){const u=t.getKeys(),d=[];for(let g=0,f=u.length;g<f;g++){const p=t.get(u[g]);if(p!==void 0){let m=u[g];p&&typeof p.getSimplifiedGeometry=="function"&&(m=c),d.push({name:m,value:p})}}Gr({version:n,gmlVersion:i.gmlVersion,node:r,hasZ:i.hasZ,srsName:i.srsName},AA,Gn("Property"),d,e),FA(r,h,e)}}function w5(r,t,e){const i=e[e.length-1],n=i.version,s=R2[n],o=de(s,n==="2.0.0"?"ValueReference":"Name"),a=i.gmlVersion;if(r.appendChild(o),ni(o,t.name),t.value!==void 0&&t.value!==null){const l=de(s,"Value");r.appendChild(l),t.value&&typeof t.value.getSimplifiedGeometry=="function"?a===2?be.prototype.writeGeometryElement(l,t.value,e):a===3?lt.prototype.writeGeometryElement(l,t.value,e):Ne.prototype.writeGeometryElement(l,t.value,e):ni(l,t.value)}}function b5(r,t,e){t.vendorId&&r.setAttribute("vendorId",t.vendorId),t.safeToIgnore!==void 0&&r.setAttribute("safeToIgnore",String(t.safeToIgnore)),t.value!==void 0&&ni(r,t.value)}const X1={"http://www.opengis.net/wfs":{Query:J(k5)},"http://www.opengis.net/wfs/2.0":{Query:J(k5)},"http://www.opengis.net/ogc":{During:J(T5),And:J(zp),Or:J(zp),Not:J(C5),BBOX:J(E5),Contains:J($a),Intersects:J($a),Within:J($a),DWithin:J(S5),PropertyIsEqualTo:J(Wn),PropertyIsNotEqualTo:J(Wn),PropertyIsLessThan:J(Wn),PropertyIsLessThanOrEqualTo:J(Wn),PropertyIsGreaterThan:J(Wn),PropertyIsGreaterThanOrEqualTo:J(Wn),PropertyIsNull:J(M5),PropertyIsBetween:J(R5),PropertyIsLike:J(I5)},"http://www.opengis.net/fes/2.0":{During:J(T5),And:J(zp),Or:J(zp),Not:J(C5),BBOX:J(E5),Contains:J($a),Disjoint:J($a),Intersects:J($a),ResourceId:J(rK),Within:J($a),DWithin:J(S5),PropertyIsEqualTo:J(Wn),PropertyIsNotEqualTo:J(Wn),PropertyIsLessThan:J(Wn),PropertyIsLessThanOrEqualTo:J(Wn),PropertyIsGreaterThan:J(Wn),PropertyIsGreaterThanOrEqualTo:J(Wn),PropertyIsNull:J(M5),PropertyIsBetween:J(R5),PropertyIsLike:J(I5)}};function k5(r,t,e){const i=e[e.length-1],n=i.version,s=i.featurePrefix,o=i.featureNS,a=i.propertyNames,l=i.srsName;let c;s?c=Vk(s,t):c=t;let h;n==="2.0.0"?h="typeNames":h="typeName",r.setAttribute(h,c),l&&r.setAttribute("srsName",l),o&&r.setAttributeNS(qk,"xmlns:"+s,o);const u=Object.assign({},i);u.node=r,Gr(u,XX,Gn("PropertyName"),a,e);const d=i.filter;if(d){const g=de(K1(n),"Filter");r.appendChild(g),eK(g,d,e)}}function eK(r,t,e){const i=e[e.length-1],n={node:r};Object.assign(n,{context:i}),Gr(n,X1,Gn(t.getTagName()),[t],e)}function E5(r,t,e){const i=e[e.length-1],n=i.context.version;i.srsName=t.srsName;const s=Wk[n];sd(n,r,t.geometryName),s.prototype.writeGeometryElement(r,t.extent,e)}function rK(r,t,e){r.setAttribute("rid",t.rid)}function $a(r,t,e){const i=e[e.length-1],n=i.context.version;i.srsName=t.srsName;const s=Wk[n];sd(n,r,t.geometryName),s.prototype.writeGeometryElement(r,t.geometry,e)}function S5(r,t,e){const i=e[e.length-1].context.version;$a(r,t,e);const n=de(K1(i),"Distance");ni(n,t.distance.toString()),i==="2.0.0"?n.setAttribute("uom",t.unit):n.setAttribute("units",t.unit),r.appendChild(n)}function T5(r,t,e){const i=e[e.length-1].context.version;Cm(Uk[i],"ValueReference",r,t.propertyName);const n=de(Qo,"TimePeriod");r.appendChild(n);const s=de(Qo,"begin");n.appendChild(s),P5(s,t.begin);const o=de(Qo,"end");n.appendChild(o),P5(o,t.end)}function zp(r,t,e){const i=e[e.length-1].context,n={node:r};Object.assign(n,{context:i});const s=t.conditions;for(let o=0,a=s.length;o<a;++o){const l=s[o];Gr(n,X1,Gn(l.getTagName()),[l],e)}}function C5(r,t,e){const i=e[e.length-1].context,n={node:r};Object.assign(n,{context:i});const s=t.condition;Gr(n,X1,Gn(s.getTagName()),[s],e)}function Wn(r,t,e){const i=e[e.length-1].context.version;t.matchCase!==void 0&&r.setAttribute("matchCase",t.matchCase.toString()),sd(i,r,t.propertyName),Mm(i,r,""+t.expression)}function M5(r,t,e){const i=e[e.length-1].context.version;sd(i,r,t.propertyName)}function R5(r,t,e){const i=e[e.length-1].context.version,n=K1(i);sd(i,r,t.propertyName);const s=de(n,"LowerBoundary");r.appendChild(s),Mm(i,s,""+t.lowerBoundary);const o=de(n,"UpperBoundary");r.appendChild(o),Mm(i,o,""+t.upperBoundary)}function I5(r,t,e){const i=e[e.length-1].context.version;r.setAttribute("wildCard",t.wildCard),r.setAttribute("singleChar",t.singleChar),r.setAttribute("escapeChar",t.escapeChar),t.matchCase!==void 0&&r.setAttribute("matchCase",t.matchCase.toString()),sd(i,r,t.propertyName),Mm(i,r,""+t.pattern)}function Cm(r,t,e,i){const n=de(r,t);ni(n,i),e.appendChild(n)}function Mm(r,t,e){Cm(K1(r),"Literal",t,e)}function sd(r,t,e){r==="2.0.0"?Cm(Uk[r],"ValueReference",t,e):Cm(Bk[r],"PropertyName",t,e)}function P5(r,t){const e=de(Qo,"TimeInstant");r.appendChild(e);const i=de(Qo,"timePosition");e.appendChild(i),ni(i,t)}function A5(r,t,e){const i=e[e.length-1],n=Object.assign({},i);n.node=r,Gr(n,X1,Gn("Query"),t,e)}function K1(r){let t;return r==="2.0.0"?t=Uk[r]:t=Bk[r],t}function iK(r,t){const e=["1.0.0","1.1.0","2.0.0"];let i=t.version||r.version;return e.includes(i)||(i=e[1],console.warn(`The "${r.typ}" layer with the id: "${r.id}" is configured in version: ${i}. OpenLayers accepts "${r.typ}" only in the versions: ${e}, It tries to load the layer with the id: "${r.id}" in version ${e[1]}!`)),i}function cu(r,t={},e){throw t.onLoadingError&&t.onLoadingError(r),e(r),Error(r)}function Q1(r,t,e,i,n,s={}){let o=t;try{s.featuresFilter&&(o=s.featuresFilter(t)),r.addFeatures(o),s.afterLoading&&s.afterLoading(o),i(o)}catch(a){console.error(a),e(a,s,n)}}function NA(r,t,e,i){return r.ok?r:t(`Request to wfs-filter failed. Response status is ${r.status}`,e,i)}function nK(r){return{method:"POST",headers:{"Content-Type":"text/xml"},body:r}}function DA(r,t,e,{onErrorFn:i,success:n,failure:s},o){const a=o?.loadingParams?.xhrParameters??{},l={...t,...a};fetch(r,l).then(c=>NA(c,i,o,s)).then(c=>c.text()).then(c=>e.getFormat().readFeatures(c)).then(c=>Q1(e,c,i,n,s,o)).catch(c=>{console.error(c)})}function sK(r,t,e,{onErrorFn:i,success:n,failure:s},o){fetch(r).then(a=>NA(a,i,o,s)).then(a=>a.text()).then(a=>DA(t,nK(a),e,{onErrorFn:i,success:n,failure:s},o)).catch(a=>{console.error(a)})}function $A(r,t,e,i){const n=new URL(r.url);return n.searchParams.set("service","WFS"),n.searchParams.set("version",t),n.searchParams.set("request","GetFeature"),n.searchParams.set("srsName",e.getCode()),t==="1.0.0"||t==="1.1.0"?n.searchParams.set("typeName",r.featureType):t==="2.0.0"&&n.searchParams.set("typeNames",r.featureType),`${n.toString()}${i}`}function I2(r,t={}){t.loadingStrategy||(t.loadingStrategy=cg);const e=iK(r,t),i=new OA({featureNS:r.featureNS,version:e});let n=null;function s(o,a,l,c,h){if(t.doNotLoadInitially)Q1(n,[],cu,c,h,t);else if(t.wfsFilter)sK(t.wfsFilter,r.url,n,{onErrorFn:cu,success:c,failure:h},t);else{const u=t.loadingStrategy===cg?`&bbox=${o.join(",")},${l.getCode()}`:"";let d=$A(r,e,l,u);if(t.loadingParams)for(const g in t.loadingParams){if(g==="xhrParameters")continue;const f=Array.isArray(t.loadingParams[g])?t.loadingParams[g].join(","):t.loadingParams[g];f!==void 0&&g==="bbox"?d+=`&${g}=${f},${l.getCode()}`:f!==void 0&&(d+=`&${g}=${f}`)}DA(d,{},n,{onErrorFn:cu,success:c,failure:h},t)}}return i.featureType=r.featureType,n=jk(s,t.loadingStrategy,i),t.beforeLoading&&n.once("featuresloadstart",()=>t.beforeLoading()),r.clusterDistance?zk(n,r.clusterDistance,t.clusterGeometryFunction):(r.renderer==="webgl"&&(t.loadingStrategy===cg?n.on("featuresloadend",o=>{Au(o?.features,r.styleId,r.excludeTypesFromParsing,r.isPointLayer)}):n.once("featuresloadend",o=>{Au(o?.features,r.styleId,r.excludeTypesFromParsing,r.isPointLayer)})),n)}function oK(r={},{layerParams:t={},options:e={}}={}){let i,n;return t.renderer==="webgl"?(n=I2({...r,renderer:t.renderer,styleId:t.styleId,excludeTypesFromParsing:t.excludeTypesFromParsing,isPointLayer:t.isPointLayer},e),i=L1({...r,...t,source:n}),i):(n=I2(r,e),i=new Tk(Object.assign({source:n,id:r.id},t)),e.style?i.setStyle(e.style):r.style&&i.setStyle(r.style),i)}function aK(r,t){if(r==="2.0.0"){const e=new DOMParser,i=e.parseFromString(t,"application/xml");return i.querySelectorAll("Filter").forEach(n=>{const s=i.createElementNS("http://www.opengis.net/fes/2.0","fes:Filter");for(;n.firstChild;){const o=n.firstChild;if(o.nodeType===1&&o.localName==="FeatureId"){const a=o.getAttribute("fid"),l=i.createElementNS("http://www.opengis.net/fes/2.0","fes:ResourceId");l.setAttribute("rid",a),s.appendChild(l),n.removeChild(o)}else s.appendChild(o)}n.parentNode.replaceChild(s,n)}),new XMLSerializer().serializeToString(i)}return t}function GA(r,t,e,i="1.1.0"){const n={insert:0,selectedUpdate:1,delete:2},s=[[],[],[]];if(e!=="insert"&&e!=="delete"&&e!=="selectedUpdate")throw new Error('transactionMethod has to be "insert", "selectedUpdate" or "delete".');return s[n[e]].push(r),aK(i,new XMLSerializer().serializeToString(new OA({version:i}).writeTransaction(...s,t)))}function lK(r){const t={code:null,message:"genericFailedTransaction"},e=r.getElementsByTagName(`${r.getElementsByTagName("Exception").length===0?"ows:":""}Exception`)[0],i=e.getElementsByTagName(`${r.getElementsByTagName("ExceptionText").length===0?"ows:":""}ExceptionText`)[0];return i!==void 0?(t.message=i.textContent,console.error("WfsTransaction: An error occurred when sending the transaction to the service.",i.textContent)):(t.message="WfsTransaction: An unkown error occurred when sending the transaction to the service.",console.error(t.message)),(e?.attributes.getNamedItem("code")||e?.attributes.getNamedItem("exceptionCode"))&&(t.code=e.attributes.getNamedItem(`${e?.attributes.getNamedItem("code")?"c":"exceptionC"}ode`).textContent),t}async function cK(r,t,e,i,n){let s,o,a=null,l=null,c=null;const h=new URL(e),{featureNS:u,featurePrefix:d,featureType:g,version:f}=i;try{if(o=await fetch(h,{method:"POST",headers:{"Content-Type":"text/xml"},credentials:i.isSecured?"include":"omit",body:GA(t,{featureNS:u,featurePrefix:d,featureType:g,version:f,srsName:r},n,f),responseType:"text"}),c=await o.text(),a=new DOMParser().parseFromString(c,"text/xml"),l=a.getElementsByTagName("wfs:TransactionSummary"),l.length===0&&(l=a.getElementsByTagName("TransactionSummary")),l.length===0)throw s=lK(a),new Error(s.code?s.code+": "+s.message:s.message)}catch(p){throw console.error(p),p}return t}function jA(r,t){const e=new DOMParser().parseFromString(r,"application/xml");let i="",n=null;if(e.getElementsByTagName("xsd:element").length>0?i="xsd:":e.getElementsByTagName("xs:element").length>0&&(i="xs"),n=Object.values(e.getElementsByTagName(i+"element")).find(s=>s.getAttribute("name")===t),n){let s;n.hasChildNodes()?s=Object.values(n.getElementsByTagName(i+"sequence")):s=Object.values(e.getElementsByTagName(i+"sequence"));const o=[];return s.forEach(a=>{o.push(...Object.values(a.getElementsByTagName(i+"element")))}),o.map(a=>Object.values(a.attributes).reduce((l,c)=>{if(c.localName==="minOccurs")l.required=c.value==="1";else if(c.localName==="type")if(c.value.trim().startsWith("gml"))l.type="geometry";else{let h=c.value;switch(i.length>0&&(h=h.replace(i,"")),h){case"long":l.type="integer";break;default:l.type=h}}else c.localName==="name"&&(l.label=l.key=c.value);return l},{label:"",key:"",value:null,type:"string",required:!0}))}return[]}function zA(r,t,e){const i=new URL(decodeURI(r));return i.searchParams.set("SERVICE","WFS"),i.searchParams.set("REQUEST","DescribeFeatureType"),i.searchParams.set("TYPENAME",e),!i.searchParams.has("VERSION")&&!i.searchParams.has("version")&&i.searchParams.set("VERSION",t),i}async function hK(r,t,e,i){const n=zA(r,t,e);let s=null;try{return s=await fetch(n,{responseType:"text/xml",credentials:i?"include":"omit"}),jA(await s.text(),e)}catch(o){throw console.error(o),o}}function uK(r,t){const e=$A(r,r.version,{getCode:()=>r.crs},"");fetch(e,t).then(i=>i.text()).then(i=>{t.addFeatures(t.getFormat().readFeatures(i))}).catch(i=>{console.error(i)})}const dK={createLayerSource:I2,createLayer:oK,createReceivePossiblePropertiesUrl:zA,sendTransaction:cK,receivePossibleProperties:hK,parseDescribeFeatureTypeResponse:jA,writeTransactionBody:GA,loadFeaturesManually:uK};let gK=class extends iA{constructor(r){const t=r.projection||"EPSG:3857",e=r.extent||Z1(t),i=r.tileGrid||mH({extent:e,maxResolution:r.maxResolution,maxZoom:r.maxZoom!==void 0?r.maxZoom:22,minZoom:r.minZoom,tileSize:r.tileSize||512});super({attributions:r.attributions,attributionsCollapsible:r.attributionsCollapsible,cacheSize:r.cacheSize,interpolate:!0,projection:t,state:r.state,tileGrid:i,tileLoadFunction:r.tileLoadFunction?r.tileLoadFunction:fK,tileUrlFunction:r.tileUrlFunction,url:r.url,urls:r.urls,wrapX:r.wrapX===void 0?!0:r.wrapX,transition:r.transition,zDirection:r.zDirection===void 0?1:r.zDirection}),this.format_=r.format?r.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=r.overlaps==null?!0:r.overlaps,this.tileClass=r.tileClass?r.tileClass:rH,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(r,t,e){if(e.getState()===_t.IDLE){e.setState(_t.LOADING);const i=e.wrappedTileCoord,n=this.getTileGridForProjection(t);let s=n.getTileCoordExtent(i);const o=i[0],a=n.getResolution(o);ns(s,-a,s);const l=this.projection;t&&this.projection&&!ci(t,l)&&(s=dc(s,t,l));const c=this.tileGrid,h=c.getExtent();h&&bn(s,h,s);let u=a;t&&l&&!ci(t,l)&&(u=a/l.getMetersPerUnit()/t.getMetersPerUnit());const d=c.getZForResolution(u,this.zDirection);c.forEachTileCoord(s,d,g=>{const f=this.tileUrlFunction(g,r,t);this.sourceTiles_[f]||(this.sourceTiles_[f]=new this.tileClass(g,f?_t.IDLE:_t.EMPTY,f,this.format_,this.tileLoadFunction));const p=this.sourceTiles_[f];e.sourceTiles.push(p),this.tileKeysBySourceTileUrl_[f]||(this.tileKeysBySourceTileUrl_[f]=[]),this.tileKeysBySourceTileUrl_[f].push(e.getKey());const m=p.getState();if(m<_t.LOADED){const y=_=>{this.handleTileChange(_);const x=p.getState();if(x===_t.LOADED||x===_t.ERROR){const v=p.getKey();v in e.errorTileKeys?p.getState()===_t.LOADED&&delete e.errorTileKeys[v]:e.loadingSourceTiles--,x===_t.ERROR?e.errorTileKeys[v]=!0:p.removeEventListener(Bt.CHANGE,y),e.loadingSourceTiles===0&&e.setState(_l(e.errorTileKeys)?_t.LOADED:_t.ERROR)}};p.addEventListener(Bt.CHANGE,y),e.loadingSourceTiles++}m===_t.IDLE&&(p.extent=c.getTileCoordExtent(g),p.projection=this.projection,p.resolution=c.getResolution(g[0]),p.load())}),e.loadingSourceTiles||e.setState(e.sourceTiles.some(g=>g.getState()===_t.ERROR)?_t.ERROR:_t.LOADED)}return e.sourceTiles}removeSourceTiles(r){const t=r.getKey(),e=r.sourceTiles;for(let i=0,n=e.length;i<n;++i){const s=e[i].getTileUrl();if(!this.tileKeysBySourceTileUrl_[s])return;const o=this.tileKeysBySourceTileUrl_[s].indexOf(t);o!==-1&&(this.tileKeysBySourceTileUrl_[s].splice(o,1),this.tileKeysBySourceTileUrl_[s].length===0&&(delete this.tileKeysBySourceTileUrl_[s],delete this.sourceTiles_[s]))}}getTile(r,t,e,i,n){const s=[r,t,e];let o=this.getTileCoordForTileUrlFunction(s,n);const a=this.getTileGrid().getExtent(),l=this.projection,c=this.getTileGridForProjection(n);if(o&&a){const d=c.getTileCoordExtent(o);ns(d,-c.getResolution(r),d),zr(a,!n||!l||ci(n,l)?d:dc(d,n,l))||(o=null)}let h=!0;if(o!==null){const d=this.tileGrid,g=c.getResolution(r);let f=g;n&&l&&!ci(n,l)&&(f=g/l.getMetersPerUnit()/n.getMetersPerUnit());const p=d.getZForResolution(f,1),m=c.getTileCoordExtent(o);ns(m,-g,m),d.forEachTileCoord(!n||!l||ci(n,l)?m:dc(m,n,l),p,y=>{h=h&&!this.tileUrlFunction(y,i,l)})}const u=new eH(s,h?_t.EMPTY:_t.IDLE,o,this.getSourceTiles.bind(this,i,n),this.removeSourceTiles.bind(this));return u.key=this.getKey(),u}getTileGridForProjection(r){const t=r.getCode();let e=this.tileGrids_[t];if(!e){const i=this.projection;if(i!==null&&!ci(i,r))return Ak(r);const n=this.tileGrid,s=n.getResolutions().slice(),o=s.map(function(c,h){return n.getOrigin(h)}),a=s.map(function(c,h){return n.getTileSize(h)}),l=k4+1;for(let c=s.length;c<l;++c)s.push(s[c-1]/2),o.push(o[c-1]),a.push(a[c-1]);e=new id({extent:n.getExtent(),origins:o,resolutions:s,tileSizes:a}),this.tileGrids_[t]=e}return e}getTilePixelRatio(r){return r}getTilePixelSize(r,t,e){const i=this.getTileGridForProjection(e),n=_i(i.getTileSize(r),this.tmpSize);return[Math.round(n[0]*t),Math.round(n[1]*t)]}setOverlaps(r){this.overlaps_=r,this.changed()}};function fK(r,t){r.setLoader(function(e,i,n){BP(t,r.getFormat(),e,i,n,r.onLoad.bind(r),r.onError.bind(r))})}var pK=8,mK={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},yK={"*":{type:"source"}},_K=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],vK={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},xK={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},wK={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},bK={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},kK={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},EK={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},SK={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},TK=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],CK={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},MK={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},RK={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},IK={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},PK={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},AK={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},LK={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},OK={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},FK={type:"array",value:"*"},NK={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},DK={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},$K={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},GK={type:"array",value:"*",minimum:1},jK={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},zK={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},qK={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},BK={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},UK=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],WK={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},VK={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},ZK={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},HK={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},YK={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},XK={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},KK={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},QK={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},JK={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},tQ={"*":{type:"string"}},eQ={$version:pK,$root:mK,sources:yK,source:_K,source_vector:vK,source_raster:xK,source_raster_dem:wK,source_geojson:bK,source_video:kK,source_image:EK,layer:SK,layout:TK,layout_background:CK,layout_fill:MK,layout_circle:RK,layout_heatmap:IK,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:PK,layout_symbol:AK,layout_raster:LK,layout_hillshade:OK,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:FK,filter_operator:NK,geometry_type:DK,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:$K,expression:GK,light:jK,sky:zK,terrain:qK,projection:BK,paint:UK,paint_fill:WK,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:VK,paint_circle:ZK,paint_heatmap:HK,paint_symbol:YK,paint_raster:XK,paint_hillshade:KK,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:QK,transition:JK,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:tQ};const rQ=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function iQ(r,t){const e={};for(const i in r)i!=="ref"&&(e[i]=r[i]);return rQ.forEach(i=>{i in t&&(e[i]=t[i])}),e}function qA(r){r=r.slice();const t=Object.create(null);for(let e=0;e<r.length;e++)t[r[e].id]=r[e];for(let e=0;e<r.length;e++)"ref"in r[e]&&(r[e]=iQ(r[e],t[r[e].ref]));return r}let Js=class extends Error{constructor(t,e){super(e),this.message=e,this.key=t}};class Zk{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[i,n]of e)this.bindings[i]=n}concat(t){return new Zk(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return this.bindings[t]?!0:this.parent?this.parent.has(t):!1}}const J1={kind:"null"},gt={kind:"number"},we={kind:"string"},ue={kind:"boolean"},uo={kind:"color"},ty={kind:"projectionDefinition"},pc={kind:"object"},ce={kind:"value"},nQ={kind:"error"},ey={kind:"collator"},ry={kind:"formatted"},iy={kind:"padding"},sf={kind:"colorArray"},ny={kind:"numberArray"},Xf={kind:"resolvedImage"},sy={kind:"variableAnchorOffsetCollection"};function Nn(r,t){return{kind:"array",itemType:r,N:t}}function Sr(r){if(r.kind==="array"){const t=Sr(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}else return r.kind}const sQ=[J1,gt,we,ue,uo,ty,ry,pc,Nn(ce),iy,ny,sf,Xf,sy];function of(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!of(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const e of sQ)if(!of(e,t))return null}}return`Expected ${Sr(r)} but found ${Sr(t)} instead.`}function Hk(r,t){return t.some(e=>e.kind===r.kind)}function mc(r,t){return t.some(e=>e==="null"?r===null:e==="array"?Array.isArray(r):e==="object"?r&&!Array.isArray(r)&&typeof r=="object":e===typeof r)}function La(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const BA=.96422,UA=1,WA=.82521,VA=4/29,hu=6/29,ZA=3*hu*hu,oQ=hu*hu*hu,aQ=Math.PI/180,lQ=180/Math.PI;function HA(r){return r=r%360,r<0&&(r+=360),r}function YA([r,t,e,i]){r=J_(r),t=J_(t),e=J_(e);let n,s;const o=tv((.2225045*r+.7168786*t+.0606169*e)/UA);r===t&&t===e?n=s=o:(n=tv((.4360747*r+.3850649*t+.1430804*e)/BA),s=tv((.0139322*r+.0971045*t+.7141733*e)/WA));const a=116*o-16;return[a<0?0:a,500*(n-o),200*(o-s),i]}function J_(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function tv(r){return r>oQ?Math.pow(r,1/3):r/ZA+VA}function XA([r,t,e,i]){let n=(r+16)/116,s=isNaN(t)?n:n+t/500,o=isNaN(e)?n:n-e/200;return n=UA*rv(n),s=BA*rv(s),o=WA*rv(o),[ev(3.1338561*s-1.6168667*n-.4906146*o),ev(-.9787684*s+1.9161415*n+.033454*o),ev(.0719453*s-.2289914*n+1.4052427*o),i]}function ev(r){return r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055,r<0?0:r>1?1:r}function rv(r){return r>hu?r*r*r:ZA*(r-VA)}function cQ(r){const[t,e,i,n]=YA(r),s=Math.sqrt(e*e+i*i);return[Math.round(s*1e4)?HA(Math.atan2(i,e)*lQ):NaN,s,t,n]}function hQ([r,t,e,i]){return r=isNaN(r)?0:r*aQ,XA([e,Math.cos(r)*t,Math.sin(r)*t,i])}function uQ([r,t,e,i]){r=HA(r),t/=100,e/=100;function n(s){const o=(s+r/30)%12,a=t*Math.min(e,1-e);return e-a*Math.max(-1,Math.min(o-3,9-o,1))}return[n(0),n(8),n(4),i]}const dQ=Object.hasOwn||function(r,t){return Object.prototype.hasOwnProperty.call(r,t)};function KA(r,t){return dQ(r,t)?r[t]:void 0}function gQ(r){if(r=r.toLowerCase().trim(),r==="transparent")return[0,0,0,0];const t=KA(fQ,r);if(t){const[n,s,o]=t;return[n/255,s/255,o/255,1]}if(r.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(r)){const n=r.length<6?1:2;let s=1;return[qp(r.slice(s,s+=n)),qp(r.slice(s,s+=n)),qp(r.slice(s,s+=n)),qp(r.slice(s,s+n)||"ff")]}if(r.startsWith("rgb")){const n=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,s=r.match(n);if(s){const[o,a,l,c,h,u,d,g,f,p,m,y]=s,_=[c||" ",d||" ",p].join("");if(_==="  "||_==="  /"||_===",,"||_===",,,"){const x=[l,u,f].join(""),v=x==="%%%"?100:x===""?255:0;if(v){const w=[Oh(+a/v,0,1),Oh(+h/v,0,1),Oh(+g/v,0,1),m?L5(+m,y):1];if(O5(w))return w}}return}}const e=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,i=r.match(e);if(i){const[n,s,o,a,l,c,h,u,d]=i,g=[o||" ",l||" ",h].join("");if(g==="  "||g==="  /"||g===",,"||g===",,,"){const f=[+s,Oh(+a,0,100),Oh(+c,0,100),u?L5(+u,d):1];if(O5(f))return uQ(f)}}}function qp(r){return parseInt(r.padEnd(2,r),16)/255}function L5(r,t){return Oh(t?r/100:r,0,1)}function Oh(r,t,e){return Math.min(Math.max(t,r),e)}function O5(r){return!r.some(Number.isNaN)}const fQ={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function yc(r,t,e){return r+e*(t-r)}function af(r,t,e){return r.map((i,n)=>yc(i,t[n],e))}let Tr=class Fh{constructor(t,e,i,n=1,s=!0){this.r=t,this.g=e,this.b=i,this.a=n,s||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[t,e,i,n]))}static parse(t){if(t instanceof Fh)return t;if(typeof t!="string")return;const e=gQ(t);if(e)return new Fh(...e,!1)}get rgb(){const{r:t,g:e,b:i,a:n}=this,s=n||1/0;return this.overwriteGetter("rgb",[t/s,e/s,i/s,n])}get hcl(){return this.overwriteGetter("hcl",cQ(this.rgb))}get lab(){return this.overwriteGetter("lab",YA(this.rgb))}overwriteGetter(t,e){return Object.defineProperty(this,t,{value:e}),e}toString(){const[t,e,i,n]=this.rgb;return`rgba(${[t,e,i].map(s=>Math.round(s*255)).join(",")},${n})`}static interpolate(t,e,i,n="rgb"){switch(n){case"rgb":{const[s,o,a,l]=af(t.rgb,e.rgb,i);return new Fh(s,o,a,l,!1)}case"hcl":{const[s,o,a,l]=t.hcl,[c,h,u,d]=e.hcl;let g,f;if(!isNaN(s)&&!isNaN(c)){let x=c-s;c>s&&x>180?x-=360:c<s&&s-c>180&&(x+=360),g=s+i*x}else isNaN(s)?isNaN(c)?g=NaN:(g=c,(a===1||a===0)&&(f=h)):(g=s,(u===1||u===0)&&(f=o));const[p,m,y,_]=hQ([g,f??yc(o,h,i),yc(a,u,i),yc(l,d,i)]);return new Fh(p,m,y,_,!1)}case"lab":{const[s,o,a,l]=XA(af(t.lab,e.lab,i));return new Fh(s,o,a,l,!1)}}}};Tr.black=new Tr(0,0,0,1);Tr.white=new Tr(1,1,1,1);Tr.transparent=new Tr(0,0,0,0);Tr.red=new Tr(1,0,0,1);class Yk{constructor(t,e,i){t?this.sensitivity=e?"variant":"case":this.sensitivity=e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const pQ=["bottom","center","top"];class P2{constructor(t,e,i,n,s,o){this.text=t,this.image=e,this.scale=i,this.fontStack=n,this.textColor=s,this.verticalAlign=o}}let Kf=class E0{constructor(t){this.sections=t}static fromString(t){return new E0([new P2(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof E0?t:E0.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}};class Rs{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Rs)return t;if(typeof t=="number")return new Rs([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const e of t)if(typeof e!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]];break}return new Rs(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,e,i){return new Rs(af(t.values,e.values,i))}}class Is{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Is)return t;if(typeof t=="number")return new Is([t]);if(Array.isArray(t)){for(const e of t)if(typeof e!="number")return;return new Is(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,e,i){return new Is(af(t.values,e.values,i))}}let fl=class Wd{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Wd)return t;if(typeof t=="string"){const i=Tr.parse(t);return i?new Wd([i]):void 0}if(!Array.isArray(t))return;const e=[];for(const i of t){if(typeof i!="string")return;const n=Tr.parse(i);if(!n)return;e.push(n)}return new Wd(e)}toString(){return JSON.stringify(this.values)}static interpolate(t,e,i,n="rgb"){const s=[];if(t.values.length!=e.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${e.values.length}), cannot interpolate.`);for(let o=0;o<t.values.length;o++)s.push(Tr.interpolate(t.values[o],e.values[o],i,n));return new Wd(s)}},Pr=class extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}};const mQ=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);let od=class S0{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof S0)return t;if(!(!Array.isArray(t)||t.length<1||t.length%2!==0)){for(let e=0;e<t.length;e+=2){const i=t[e],n=t[e+1];if(typeof i!="string"||!mQ.has(i)||!Array.isArray(n)||n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")return}return new S0(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,e,i){const n=t.values,s=e.values;if(n.length!==s.length)throw new Pr(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${e.toString()}`);const o=[];for(let a=0;a<n.length;a+=2){if(n[a]!==s[a])throw new Pr(`Cannot interpolate values containing mismatched anchors. from[${a}]: ${n[a]}, to[${a}]: ${s[a]}`);o.push(n[a]);const[l,c]=n[a+1],[h,u]=s[a+1];o.push([yc(l,h,i),yc(c,u,i)])}return new S0(o)}};class Il{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Il({name:t,available:!1}):null}}let Qf=class Nh{constructor(t,e,i){this.from=t,this.to=e,this.transition=i}static interpolate(t,e,i){return new Nh(t,e,i)}static parse(t){if(t instanceof Nh)return t;if(Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number")return new Nh(t[0],t[1],t[2]);if(typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number")return new Nh(t.from,t.to,t.transition);if(typeof t=="string")return new Nh(t,t,1)}};function QA(r,t,e,i){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255?typeof i>"u"||typeof i=="number"&&i>=0&&i<=1?null:`Invalid rgba value [${[r,t,e,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof i=="number"?[r,t,e,i]:[r,t,e]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function lf(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Qf||r instanceof Tr||r instanceof Yk||r instanceof Kf||r instanceof Rs||r instanceof Is||r instanceof fl||r instanceof od||r instanceof Il)return!0;if(Array.isArray(r)){for(const t of r)if(!lf(t))return!1;return!0}else if(typeof r=="object"){for(const t in r)if(!lf(r[t]))return!1;return!0}else return!1}function ei(r){if(r===null)return J1;if(typeof r=="string")return we;if(typeof r=="boolean")return ue;if(typeof r=="number")return gt;if(r instanceof Tr)return uo;if(r instanceof Qf)return ty;if(r instanceof Yk)return ey;if(r instanceof Kf)return ry;if(r instanceof Rs)return iy;if(r instanceof Is)return ny;if(r instanceof fl)return sf;if(r instanceof od)return sy;if(r instanceof Il)return Xf;if(Array.isArray(r)){const t=r.length;let e;for(const i of r){const n=ei(i);if(!e)e=n;else{if(e===n)continue;e=ce;break}}return Nn(e||ce,t)}else return pc}function hg(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Tr||r instanceof Qf||r instanceof Kf||r instanceof Rs||r instanceof Is||r instanceof fl||r instanceof od||r instanceof Il?r.toString():JSON.stringify(r)}class Du{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(t.length!==2)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!lf(t[1]))return e.error("invalid value");const i=t[1];let n=ei(i);const s=e.expectedType;return n.kind==="array"&&n.N===0&&s&&s.kind==="array"&&(typeof s.N!="number"||s.N===0)&&(n=s),new Du(n,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Bp={string:we,number:gt,boolean:ue,object:pc};class Ts{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let i=1,n;const s=t[0];if(s==="array"){let a;if(t.length>2){const c=t[1];if(typeof c!="string"||!(c in Bp)||c==="object")return e.error('The item type argument of "array" must be one of string, number, boolean',1);a=Bp[c],i++}else a=ce;let l;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);l=t[2],i++}n=Nn(a,l)}else{if(!Bp[s])throw new Error(`Types doesn't contain name = ${s}`);n=Bp[s]}const o=[];for(;i<t.length;i++){const a=e.parse(t[i],i,ce);if(!a)return null;o.push(a)}return new Ts(n,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const i=this.args[e].evaluate(t);if(of(this.type,ei(i))){if(e===this.args.length-1)throw new Pr(`Expected value to be of type ${Sr(this.type)}, but found ${Sr(ei(i))} instead.`)}else return i}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const F5={"to-boolean":ue,"to-color":uo,"to-number":gt,"to-string":we};class nl{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[0];if(!F5[i])throw new Error(`Can't parse ${i} as it is not part of the known types`);if((i==="to-boolean"||i==="to-string")&&t.length!==2)return e.error("Expected one argument.");const n=F5[i],s=[];for(let o=1;o<t.length;o++){const a=e.parse(t[o],o,ce);if(!a)return null;s.push(a)}return new nl(n,s)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let e,i;for(const n of this.args){if(e=n.evaluate(t),i=null,e instanceof Tr)return e;if(typeof e=="string"){const s=t.parseColor(e);if(s)return s}else if(Array.isArray(e)&&(e.length<3||e.length>4?i=`Invalid rgba value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:i=QA(e[0],e[1],e[2],e[3]),!i))return new Tr(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Pr(i||`Could not parse color from value '${typeof e=="string"?e:JSON.stringify(e)}'`)}case"padding":{let e;for(const i of this.args){e=i.evaluate(t);const n=Rs.parse(e);if(n)return n}throw new Pr(`Could not parse padding from value '${typeof e=="string"?e:JSON.stringify(e)}'`)}case"numberArray":{let e;for(const i of this.args){e=i.evaluate(t);const n=Is.parse(e);if(n)return n}throw new Pr(`Could not parse numberArray from value '${typeof e=="string"?e:JSON.stringify(e)}'`)}case"colorArray":{let e;for(const i of this.args){e=i.evaluate(t);const n=fl.parse(e);if(n)return n}throw new Pr(`Could not parse colorArray from value '${typeof e=="string"?e:JSON.stringify(e)}'`)}case"variableAnchorOffsetCollection":{let e;for(const i of this.args){e=i.evaluate(t);const n=od.parse(e);if(n)return n}throw new Pr(`Could not parse variableAnchorOffsetCollection from value '${typeof e=="string"?e:JSON.stringify(e)}'`)}case"number":{let e=null;for(const i of this.args){if(e=i.evaluate(t),e===null)return 0;const n=Number(e);if(!isNaN(n))return n}throw new Pr(`Could not convert ${JSON.stringify(e)} to number.`)}case"formatted":return Kf.fromString(hg(this.args[0].evaluate(t)));case"resolvedImage":return Il.fromString(hg(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return hg(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const yQ=["Unknown","Point","LineString","Polygon"];class JA{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?yQ[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache.get(t);return e||(e=Tr.parse(t),this._parseColorCache.set(t,e)),e}}class oy{constructor(t,e,i=[],n,s=new Zk,o=[]){this.registry=t,this.path=i,this.key=i.map(a=>`[${a}]`).join(""),this.scope=s,this.errors=o,this.expectedType=n,this._isConstant=e}parse(t,e,i,n,s={}){return e?this.concat(e,i,n)._parse(t,s):this._parse(t,s)}_parse(t,e){(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number")&&(t=["literal",t]);function i(n,s,o){return o==="assert"?new Ts(s,[n]):o==="coerce"?new nl(s,[n]):n}if(Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=t[0];if(typeof n!="string")return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const s=this.registry[n];if(s){let o=s.parse(t,this);if(!o)return null;if(this.expectedType){const a=this.expectedType,l=o.type;if((a.kind==="string"||a.kind==="number"||a.kind==="boolean"||a.kind==="object"||a.kind==="array")&&l.kind==="value")o=i(o,a,e.typeAnnotation||"assert");else if(a.kind==="projectionDefinition"&&["string","array"].includes(l.kind)||["color","formatted","resolvedImage"].includes(a.kind)&&["value","string"].includes(l.kind)||["padding","numberArray"].includes(a.kind)&&["value","number","array"].includes(l.kind)||a.kind==="colorArray"&&["value","string","array"].includes(l.kind)||a.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(l.kind))o=i(o,a,e.typeAnnotation||"coerce");else if(this.checkSubtype(a,l))return null}if(!(o instanceof Du)&&o.type.kind!=="resolvedImage"&&this._isConstant(o)){const a=new JA;try{o=new Du(o.type,o.evaluate(a))}catch(l){return this.error(l.message),null}}return o}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof t>"u"?this.error("'undefined' value invalid. Use null instead."):typeof t=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof t} instead.`)}concat(t,e,i){const n=typeof t=="number"?this.path.concat(t):this.path,s=i?this.scope.concat(i):this.scope;return new oy(this.registry,this._isConstant,n,e||null,s,this.errors)}error(t,...e){const i=`${this.key}${e.map(n=>`[${n}]`).join("")}`;this.errors.push(new Js(i,t))}checkSubtype(t,e){const i=of(t,e);return i&&this.error(i),i}}class ay{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const i=[];for(let s=1;s<t.length-1;s+=2){const o=t[s];if(typeof o!="string")return e.error(`Expected string, but found ${typeof o} instead.`,s);if(/[^a-zA-Z0-9_]/.test(o))return e.error("Variable names must contain only alphanumeric characters or '_'.",s);const a=e.parse(t[s+1],s+1);if(!a)return null;i.push([o,a])}const n=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return n?new ay(i,n):null}outputDefined(){return this.result.outputDefined()}}class ly{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(t.length!==2||typeof t[1]!="string")return e.error("'var' expression requires exactly one string literal argument.");const i=t[1];return e.scope.has(i)?new ly(i,e.scope.get(i)):e.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Xk{constructor(t,e,i){this.type=t,this.index=e,this.input=i}static parse(t,e){if(t.length!==3)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,gt),n=e.parse(t[2],2,Nn(e.expectedType||ce));if(!i||!n)return null;const s=n.type;return new Xk(s.itemType,i,n)}evaluate(t){const e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new Pr(`Array index out of bounds: ${e} < 0.`);if(e>=i.length)throw new Pr(`Array index out of bounds: ${e} > ${i.length-1}.`);if(e!==Math.floor(e))throw new Pr(`Array index must be an integer, but found ${e} instead.`);return i[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Kk{constructor(t,e){this.type=ue,this.needle=t,this.haystack=e}static parse(t,e){if(t.length!==3)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,ce),n=e.parse(t[2],2,ce);return!i||!n?null:Hk(i.type,[ue,we,gt,J1,ce])?new Kk(i,n):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Sr(i.type)} instead`)}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!mc(e,["boolean","string","number","null"]))throw new Pr(`Expected first argument to be of type boolean, string, number or null, but found ${Sr(ei(e))} instead.`);if(!mc(i,["string","array"]))throw new Pr(`Expected second argument to be of type array or string, but found ${Sr(ei(i))} instead.`);return i.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Rm{constructor(t,e,i){this.type=gt,this.needle=t,this.haystack=e,this.fromIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,ce),n=e.parse(t[2],2,ce);if(!i||!n)return null;if(!Hk(i.type,[ue,we,gt,J1,ce]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Sr(i.type)} instead`);if(t.length===4){const s=e.parse(t[3],3,gt);return s?new Rm(i,n,s):null}else return new Rm(i,n)}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!mc(e,["boolean","string","number","null"]))throw new Pr(`Expected first argument to be of type boolean, string, number or null, but found ${Sr(ei(e))} instead.`);let n;if(this.fromIndex&&(n=this.fromIndex.evaluate(t)),mc(i,["string"])){const s=i.indexOf(e,n);return s===-1?-1:[...i.slice(0,s)].length}else{if(mc(i,["array"]))return i.indexOf(e,n);throw new Pr(`Expected second argument to be of type array or string, but found ${Sr(ei(i))} instead.`)}}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Qk{constructor(t,e,i,n,s,o){this.inputType=t,this.type=e,this.input=i,this.cases=n,this.outputs=s,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!==1)return e.error("Expected an even number of arguments.");let i,n;e.expectedType&&e.expectedType.kind!=="value"&&(n=e.expectedType);const s={},o=[];for(let c=2;c<t.length-1;c+=2){let h=t[c];const u=t[c+1];Array.isArray(h)||(h=[h]);const d=e.concat(c);if(h.length===0)return d.error("Expected at least one branch label.");for(const f of h){if(typeof f!="number"&&typeof f!="string")return d.error("Branch labels must be numbers or strings.");if(typeof f=="number"&&Math.abs(f)>Number.MAX_SAFE_INTEGER)return d.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof f=="number"&&Math.floor(f)!==f)return d.error("Numeric branch labels must be integer values.");if(!i)i=ei(f);else if(d.checkSubtype(i,ei(f)))return null;if(typeof s[String(f)]<"u")return d.error("Branch labels must be unique.");s[String(f)]=o.length}const g=e.parse(u,c,n);if(!g)return null;n=n||g.type,o.push(g)}const a=e.parse(t[1],1,ce);if(!a)return null;const l=e.parse(t[t.length-1],t.length-1,n);return!l||a.type.kind!=="value"&&e.concat(1).checkSubtype(i,a.type)?null:new Qk(i,n,a,s,o,l)}evaluate(t){const e=this.input.evaluate(t);return(ei(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Jk{constructor(t,e,i){this.type=t,this.branches=e,this.otherwise=i}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!==0)return e.error("Expected an odd number of arguments.");let i;e.expectedType&&e.expectedType.kind!=="value"&&(i=e.expectedType);const n=[];for(let o=1;o<t.length-1;o+=2){const a=e.parse(t[o],o,ue);if(!a)return null;const l=e.parse(t[o+1],o+1,i);if(!l)return null;n.push([a,l]),i=i||l.type}const s=e.parse(t[t.length-1],t.length-1,i);if(!s)return null;if(!i)throw new Error("Can't infer output type");return new Jk(i,n,s)}evaluate(t){for(const[e,i]of this.branches)if(e.evaluate(t))return i.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,i]of this.branches)t(e),t(i);t(this.otherwise)}outputDefined(){return this.branches.every(([t,e])=>e.outputDefined())&&this.otherwise.outputDefined()}}class Im{constructor(t,e,i,n){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,ce),n=e.parse(t[2],2,gt);if(!i||!n)return null;if(!Hk(i.type,[Nn(ce),we,ce]))return e.error(`Expected first argument to be of type array or string, but found ${Sr(i.type)} instead`);if(t.length===4){const s=e.parse(t[3],3,gt);return s?new Im(i.type,i,n,s):null}else return new Im(i.type,i,n)}evaluate(t){const e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);let n;if(this.endIndex&&(n=this.endIndex.evaluate(t)),mc(e,["string"]))return[...e].slice(i,n).join("");if(mc(e,["array"]))return e.slice(i,n);throw new Pr(`Expected first argument to be of type array or string, but found ${Sr(ei(e))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function tL(r,t){const e=r.length-1;let i=0,n=e,s=0,o,a;for(;i<=n;)if(s=Math.floor((i+n)/2),o=r[s],a=r[s+1],o<=t){if(s===e||t<a)return s;i=s+1}else if(o>t)n=s-1;else throw new Pr("Input is not a number.");return 0}class cy{constructor(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[n,s]of i)this.labels.push(n),this.outputs.push(s)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!==0)return e.error("Expected an even number of arguments.");const i=e.parse(t[1],1,gt);if(!i)return null;const n=[];let s=null;e.expectedType&&e.expectedType.kind!=="value"&&(s=e.expectedType);for(let o=1;o<t.length;o+=2){const a=o===1?-1/0:t[o],l=t[o+1],c=o,h=o+1;if(typeof a!="number")return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',c);if(n.length&&n[n.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',c);const u=e.parse(l,h,s);if(!u)return null;s=s||u.type,n.push([a,u])}return new cy(s,i,n)}evaluate(t){const e=this.labels,i=this.outputs;if(e.length===1)return i[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return i[0].evaluate(t);const s=e.length;if(n>=e[s-1])return i[s-1].evaluate(t);const o=tL(e,n);return i[o].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function _Q(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var iv,N5;function vQ(){if(N5)return iv;N5=1,iv=r;function r(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=n}return r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,n=0;n<8;n++){var s=this.sampleCurveX(i)-t;if(Math.abs(s)<e)return i;var o=this.sampleCurveDerivativeX(i);if(Math.abs(o)<1e-6)break;i=i-s/o}var a=0,l=1;for(i=t,n=0;n<20&&(s=this.sampleCurveX(i),!(Math.abs(s-t)<e));n++)t>s?a=i:l=i,i=(l-a)*.5+a;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},iv}var xQ=vQ(),wQ=_Q(xQ);let _c=class A2{constructor(t,e,i,n,s){this.type=t,this.operator=e,this.interpolation=i,this.input=n,this.labels=[],this.outputs=[];for(const[o,a]of s)this.labels.push(o),this.outputs.push(a)}static interpolationFactor(t,e,i,n){let s=0;if(t.name==="exponential")s=nv(e,t.base,i,n);else if(t.name==="linear")s=nv(e,1,i,n);else if(t.name==="cubic-bezier"){const o=t.controlPoints;s=new wQ(o[0],o[1],o[2],o[3]).solve(nv(e,1,i,n))}return s}static parse(t,e){let[i,n,s,...o]=t;if(!Array.isArray(n)||n.length===0)return e.error("Expected an interpolation type expression.",1);if(n[0]==="linear")n={name:"linear"};else if(n[0]==="exponential"){const c=n[1];if(typeof c!="number")return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:c}}else if(n[0]==="cubic-bezier"){const c=n.slice(1);if(c.length!==4||c.some(h=>typeof h!="number"||h<0||h>1))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:c}}else return e.error(`Unknown interpolation type ${String(n[0])}`,1,0);if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!==0)return e.error("Expected an even number of arguments.");if(s=e.parse(s,2,gt),!s)return null;const a=[];let l=null;(i==="interpolate-hcl"||i==="interpolate-lab")&&e.expectedType!=sf?l=uo:e.expectedType&&e.expectedType.kind!=="value"&&(l=e.expectedType);for(let c=0;c<o.length;c+=2){const h=o[c],u=o[c+1],d=c+3,g=c+4;if(typeof h!="number")return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(a.length&&a[a.length-1][0]>=h)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);const f=e.parse(u,g,l);if(!f)return null;l=l||f.type,a.push([h,f])}return!La(l,gt)&&!La(l,ty)&&!La(l,uo)&&!La(l,iy)&&!La(l,ny)&&!La(l,sf)&&!La(l,sy)&&!La(l,Nn(gt))?e.error(`Type ${Sr(l)} is not interpolatable.`):new A2(l,i,n,s,a)}evaluate(t){const e=this.labels,i=this.outputs;if(e.length===1)return i[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return i[0].evaluate(t);const s=e.length;if(n>=e[s-1])return i[s-1].evaluate(t);const o=tL(e,n),a=e[o],l=e[o+1],c=A2.interpolationFactor(this.interpolation,n,a,l),h=i[o].evaluate(t),u=i[o+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return yc(h,u,c);case"color":return Tr.interpolate(h,u,c);case"padding":return Rs.interpolate(h,u,c);case"colorArray":return fl.interpolate(h,u,c);case"numberArray":return Is.interpolate(h,u,c);case"variableAnchorOffsetCollection":return od.interpolate(h,u,c);case"array":return af(h,u,c);case"projectionDefinition":return Qf.interpolate(h,u,c)}case"interpolate-hcl":switch(this.type.kind){case"color":return Tr.interpolate(h,u,c,"hcl");case"colorArray":return fl.interpolate(h,u,c,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Tr.interpolate(h,u,c,"lab");case"colorArray":return fl.interpolate(h,u,c,"lab")}}}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}};function nv(r,t,e,i){const n=i-e,s=r-e;return n===0?0:t===1?s/n:(Math.pow(t,s)-1)/(Math.pow(t,n)-1)}class cf{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let i=null;const n=e.expectedType;n&&n.kind!=="value"&&(i=n);const s=[];for(const o of t.slice(1)){const a=e.parse(o,1+s.length,i,void 0,{typeAnnotation:"omit"});if(!a)return null;i=i||a.type,s.push(a)}if(!i)throw new Error("No output type");return n&&s.some(o=>of(n,o.type))?new cf(ce,s):new cf(i,s)}evaluate(t){let e=null,i=0,n;for(const s of this.args)if(i++,e=s.evaluate(t),e&&e instanceof Il&&!e.available&&(n||(n=e.name),e=null,i===this.args.length&&(e=n)),e!==null)break;return e}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function D5(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function bQ(r,t,e){return t===e}function kQ(r,t,e){return t!==e}function EQ(r,t,e){return t<e}function SQ(r,t,e){return t>e}function TQ(r,t,e){return t<=e}function CQ(r,t,e){return t>=e}function eL(r,t,e,i){return i.compare(t,e)===0}function MQ(r,t,e,i){return!eL(r,t,e,i)}function RQ(r,t,e,i){return i.compare(t,e)<0}function IQ(r,t,e,i){return i.compare(t,e)>0}function PQ(r,t,e,i){return i.compare(t,e)<=0}function AQ(r,t,e,i){return i.compare(t,e)>=0}function ad(r,t,e){const i=r!=="=="&&r!=="!=";return class rL{constructor(s,o,a){this.type=ue,this.lhs=s,this.rhs=o,this.collator=a,this.hasUntypedArgument=s.type.kind==="value"||o.type.kind==="value"}static parse(s,o){if(s.length!==3&&s.length!==4)return o.error("Expected two or three arguments.");const a=s[0];let l=o.parse(s[1],1,ce);if(!l)return null;if(!D5(a,l.type))return o.concat(1).error(`"${a}" comparisons are not supported for type '${Sr(l.type)}'.`);let c=o.parse(s[2],2,ce);if(!c)return null;if(!D5(a,c.type))return o.concat(2).error(`"${a}" comparisons are not supported for type '${Sr(c.type)}'.`);if(l.type.kind!==c.type.kind&&l.type.kind!=="value"&&c.type.kind!=="value")return o.error(`Cannot compare types '${Sr(l.type)}' and '${Sr(c.type)}'.`);i&&(l.type.kind==="value"&&c.type.kind!=="value"?l=new Ts(c.type,[l]):l.type.kind!=="value"&&c.type.kind==="value"&&(c=new Ts(l.type,[c])));let h=null;if(s.length===4){if(l.type.kind!=="string"&&c.type.kind!=="string"&&l.type.kind!=="value"&&c.type.kind!=="value")return o.error("Cannot use collator to compare non-string types.");if(h=o.parse(s[3],3,ey),!h)return null}return new rL(l,c,h)}evaluate(s){const o=this.lhs.evaluate(s),a=this.rhs.evaluate(s);if(i&&this.hasUntypedArgument){const l=ei(o),c=ei(a);if(l.kind!==c.kind||!(l.kind==="string"||l.kind==="number"))throw new Pr(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${l.kind}, ${c.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const l=ei(o),c=ei(a);if(l.kind!=="string"||c.kind!=="string")return t(s,o,a)}return this.collator?e(s,o,a,this.collator.evaluate(s)):t(s,o,a)}eachChild(s){s(this.lhs),s(this.rhs),this.collator&&s(this.collator)}outputDefined(){return!0}}}const LQ=ad("==",bQ,eL),OQ=ad("!=",kQ,MQ),FQ=ad("<",EQ,RQ),NQ=ad(">",SQ,IQ),DQ=ad("<=",TQ,PQ),$Q=ad(">=",CQ,AQ);class hy{constructor(t,e,i){this.type=ey,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(t.length!==2)return e.error("Expected one argument.");const i=t[1];if(typeof i!="object"||Array.isArray(i))return e.error("Collator options argument must be an object.");const n=e.parse(i["case-sensitive"]===void 0?!1:i["case-sensitive"],1,ue);if(!n)return null;const s=e.parse(i["diacritic-sensitive"]===void 0?!1:i["diacritic-sensitive"],1,ue);if(!s)return null;let o=null;return i.locale&&(o=e.parse(i.locale,1,we),!o)?null:new hy(n,s,o)}evaluate(t){return new Yk(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class tE{constructor(t,e,i,n,s){this.type=we,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=n,this.maxFractionDigits=s}static parse(t,e){if(t.length!==3)return e.error("Expected two arguments.");const i=e.parse(t[1],1,gt);if(!i)return null;const n=t[2];if(typeof n!="object"||Array.isArray(n))return e.error("NumberFormat options argument must be an object.");let s=null;if(n.locale&&(s=e.parse(n.locale,1,we),!s))return null;let o=null;if(n.currency&&(o=e.parse(n.currency,1,we),!o))return null;let a=null;if(n["min-fraction-digits"]&&(a=e.parse(n["min-fraction-digits"],1,gt),!a))return null;let l=null;return n["max-fraction-digits"]&&(l=e.parse(n["max-fraction-digits"],1,gt),!l)?null:new tE(i,s,o,a,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class eE{constructor(t){this.type=ry,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[1];if(!Array.isArray(i)&&typeof i=="object")return e.error("First argument must be an image or text section.");const n=[];let s=!1;for(let o=1;o<=t.length-1;++o){const a=t[o];if(s&&typeof a=="object"&&!Array.isArray(a)){s=!1;let l=null;if(a["font-scale"]&&(l=e.parse(a["font-scale"],1,gt),!l))return null;let c=null;if(a["text-font"]&&(c=e.parse(a["text-font"],1,Nn(we)),!c))return null;let h=null;if(a["text-color"]&&(h=e.parse(a["text-color"],1,uo),!h))return null;let u=null;if(a["vertical-align"]){if(typeof a["vertical-align"]=="string"&&!pQ.includes(a["vertical-align"]))return e.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${a["vertical-align"]}' instead.`);if(u=e.parse(a["vertical-align"],1,we),!u)return null}const d=n[n.length-1];d.scale=l,d.font=c,d.textColor=h,d.verticalAlign=u}else{const l=e.parse(t[o],1,ce);if(!l)return null;const c=l.type.kind;if(c!=="string"&&c!=="value"&&c!=="null"&&c!=="resolvedImage")return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");s=!0,n.push({content:l,scale:null,font:null,textColor:null,verticalAlign:null})}}return new eE(n)}evaluate(t){const e=i=>{const n=i.content.evaluate(t);return ei(n)===Xf?new P2("",n,null,null,null,i.verticalAlign?i.verticalAlign.evaluate(t):null):new P2(hg(n),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null,i.verticalAlign?i.verticalAlign.evaluate(t):null)};return new Kf(this.sections.map(e))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor),e.verticalAlign&&t(e.verticalAlign)}outputDefined(){return!1}}class rE{constructor(t){this.type=Xf,this.input=t}static parse(t,e){if(t.length!==2)return e.error("Expected two arguments.");const i=e.parse(t[1],1,we);return i?new rE(i):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),i=Il.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i}eachChild(t){t(this.input)}outputDefined(){return!1}}class iE{constructor(t){this.type=gt,this.input=t}static parse(t,e){if(t.length!==2)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const i=e.parse(t[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?e.error(`Expected argument of type string or array, but found ${Sr(i.type)} instead.`):new iE(i):null}evaluate(t){const e=this.input.evaluate(t);if(typeof e=="string")return[...e].length;if(Array.isArray(e))return e.length;throw new Pr(`Expected value to be of type string or array, but found ${Sr(ei(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const go=8192;function GQ(r,t){const e=jQ(r[0]),i=qQ(r[1]),n=Math.pow(2,t.z);return[Math.round(e*n*go),Math.round(i*n*go)]}function nE(r,t){const e=Math.pow(2,t.z),i=(r[0]/go+t.x)/e,n=(r[1]/go+t.y)/e;return[zQ(i),BQ(n)]}function jQ(r){return(180+r)/360}function zQ(r){return r*360-180}function qQ(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function BQ(r){return 360/Math.PI*Math.atan(Math.exp((180-r*360)*Math.PI/180))-90}function Jf(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function hf(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function UQ(r,t,e){return t[1]>r[1]!=e[1]>r[1]&&r[0]<(e[0]-t[0])*(r[1]-t[1])/(e[1]-t[1])+t[0]}function WQ(r,t,e){const i=r[0]-t[0],n=r[1]-t[1],s=r[0]-e[0],o=r[1]-e[1];return i*o-s*n===0&&i*s<=0&&n*o<=0}function uy(r,t,e,i){const n=[t[0]-r[0],t[1]-r[1]],s=[i[0]-e[0],i[1]-e[1]];return YQ(s,n)===0?!1:!!($5(r,t,e,i)&&$5(e,i,r,t))}function VQ(r,t,e){for(const i of e)for(let n=0;n<i.length-1;++n)if(uy(r,t,i[n],i[n+1]))return!0;return!1}function ld(r,t,e=!1){let i=!1;for(const n of t)for(let s=0;s<n.length-1;s++){if(WQ(r,n[s],n[s+1]))return e;UQ(r,n[s],n[s+1])&&(i=!i)}return i}function ZQ(r,t){for(const e of t)if(ld(r,e))return!0;return!1}function iL(r,t){for(const e of r)if(!ld(e,t))return!1;for(let e=0;e<r.length-1;++e)if(VQ(r[e],r[e+1],t))return!1;return!0}function HQ(r,t){for(const e of t)if(iL(r,e))return!0;return!1}function YQ(r,t){return r[0]*t[1]-r[1]*t[0]}function $5(r,t,e,i){const n=r[0]-e[0],s=r[1]-e[1],o=t[0]-e[0],a=t[1]-e[1],l=i[0]-e[0],c=i[1]-e[1],h=n*c-l*s,u=o*c-l*a;return h>0&&u<0||h<0&&u>0}function sE(r,t,e){const i=[];for(let n=0;n<r.length;n++){const s=[];for(let o=0;o<r[n].length;o++){const a=GQ(r[n][o],e);Jf(t,a),s.push(a)}i.push(s)}return i}function nL(r,t,e){const i=[];for(let n=0;n<r.length;n++){const s=sE(r[n],t,e);i.push(s)}return i}function sL(r,t,e,i){if(r[0]<e[0]||r[0]>e[2]){const n=i*.5;let s=r[0]-e[0]>n?-i:e[0]-r[0]>n?i:0;s===0&&(s=r[0]-e[2]>n?-i:e[2]-r[0]>n?i:0),r[0]+=s}Jf(t,r)}function XQ(r){r[0]=r[1]=1/0,r[2]=r[3]=-1/0}function G5(r,t,e,i){const n=Math.pow(2,i.z)*go,s=[i.x*go,i.y*go],o=[];for(const a of r)for(const l of a){const c=[l.x+s[0],l.y+s[1]];sL(c,t,e,n),o.push(c)}return o}function j5(r,t,e,i){const n=Math.pow(2,i.z)*go,s=[i.x*go,i.y*go],o=[];for(const a of r){const l=[];for(const c of a){const h=[c.x+s[0],c.y+s[1]];Jf(t,h),l.push(h)}o.push(l)}if(t[2]-t[0]<=n/2){XQ(t);for(const a of o)for(const l of a)sL(l,t,e,n)}return o}function KQ(r,t){const e=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=r.canonicalID();if(t.type==="Polygon"){const s=sE(t.coordinates,i,n),o=G5(r.geometry(),e,i,n);if(!hf(e,i))return!1;for(const a of o)if(!ld(a,s))return!1}if(t.type==="MultiPolygon"){const s=nL(t.coordinates,i,n),o=G5(r.geometry(),e,i,n);if(!hf(e,i))return!1;for(const a of o)if(!ZQ(a,s))return!1}return!0}function QQ(r,t){const e=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=r.canonicalID();if(t.type==="Polygon"){const s=sE(t.coordinates,i,n),o=j5(r.geometry(),e,i,n);if(!hf(e,i))return!1;for(const a of o)if(!iL(a,s))return!1}if(t.type==="MultiPolygon"){const s=nL(t.coordinates,i,n),o=j5(r.geometry(),e,i,n);if(!hf(e,i))return!1;for(const a of o)if(!HQ(a,s))return!1}return!0}class vc{constructor(t,e){this.type=ue,this.geojson=t,this.geometries=e}static parse(t,e){if(t.length!==2)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(lf(t[1])){const i=t[1];if(i.type==="FeatureCollection"){const n=[];for(const s of i.features){const{type:o,coordinates:a}=s.geometry;o==="Polygon"&&n.push(a),o==="MultiPolygon"&&n.push(...a)}if(n.length){const s={type:"MultiPolygon",coordinates:n};return new vc(i,s)}}else if(i.type==="Feature"){const n=i.geometry.type;if(n==="Polygon"||n==="MultiPolygon")return new vc(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new vc(i,i)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return KQ(t,this.geometries);if(t.geometryType()==="LineString")return QQ(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class oL{constructor(t=[],e=(i,n)=>i<n?-1:i>n?1:0){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,n=e[t];for(;t>0;){const s=t-1>>1,o=e[s];if(i(n,o)>=0)break;e[t]=o,t=s}e[t]=n}_down(t){const{data:e,compare:i}=this,n=this.length>>1,s=e[t];for(;t<n;){let o=(t<<1)+1;const a=o+1;if(a<this.length&&i(e[a],e[o])<0&&(o=a),i(e[o],s)>=0)break;e[t]=e[o],t=o}e[t]=s}}function JQ(r,t){if(r.length<=1)return[r];const e=[];let i,n;for(const s of r){const o=tJ(s);o!==0&&(s.area=Math.abs(o),n===void 0&&(n=o<0),n===o<0?(i&&e.push(i),i=[s]):i.push(s))}return i&&e.push(i),e}function tJ(r){let t=0;for(let e=0,i=r.length,n=i-1,s,o;e<i;n=e++)s=r[e],o=r[n],t+=(o.x-s.x)*(s.y+o.y);return t}const eJ=6378.137,z5=1/298.257223563,q5=z5*(2-z5),B5=Math.PI/180;class oE{constructor(t){const e=B5*eJ*1e3,i=Math.cos(t*B5),n=1/(1-q5*(1-i*i)),s=Math.sqrt(n);this.kx=e*s*i,this.ky=e*s*n*(1-q5)}distance(t,e){const i=this.wrap(t[0]-e[0])*this.kx,n=(t[1]-e[1])*this.ky;return Math.sqrt(i*i+n*n)}pointOnLine(t,e){let i=1/0,n,s,o,a;for(let l=0;l<t.length-1;l++){let c=t[l][0],h=t[l][1],u=this.wrap(t[l+1][0]-c)*this.kx,d=(t[l+1][1]-h)*this.ky,g=0;(u!==0||d!==0)&&(g=(this.wrap(e[0]-c)*this.kx*u+(e[1]-h)*this.ky*d)/(u*u+d*d),g>1?(c=t[l+1][0],h=t[l+1][1]):g>0&&(c+=u/this.kx*g,h+=d/this.ky*g)),u=this.wrap(e[0]-c)*this.kx,d=(e[1]-h)*this.ky;const f=u*u+d*d;f<i&&(i=f,n=c,s=h,o=l,a=g)}return{point:[n,s],index:o,t:Math.max(0,Math.min(1,a))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}const L2=100,O2=50;function aL(r,t){return t[0]-r[0]}function Pm(r){return r[1]-r[0]+1}function na(r,t){return r[1]>=r[0]&&r[1]<t}function F2(r,t){if(r[0]>r[1])return[null,null];const e=Pm(r);if(t){if(e===2)return[r,null];const n=Math.floor(e/2);return[[r[0],r[0]+n],[r[0]+n,r[1]]]}if(e===1)return[r,null];const i=Math.floor(e/2)-1;return[[r[0],r[0]+i],[r[0]+i+1,r[1]]]}function N2(r,t){if(!na(t,r.length))return[1/0,1/0,-1/0,-1/0];const e=[1/0,1/0,-1/0,-1/0];for(let i=t[0];i<=t[1];++i)Jf(e,r[i]);return e}function D2(r){const t=[1/0,1/0,-1/0,-1/0];for(const e of r)for(const i of e)Jf(t,i);return t}function U5(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function aE(r,t,e){if(!U5(r)||!U5(t))return NaN;let i=0,n=0;return r[2]<t[0]&&(i=t[0]-r[2]),r[0]>t[2]&&(i=r[0]-t[2]),r[1]>t[3]&&(n=r[1]-t[3]),r[3]<t[1]&&(n=t[1]-r[3]),e.distance([0,0],[i,n])}function nc(r,t,e){const i=e.pointOnLine(t,r);return e.distance(r,i.point)}function lE(r,t,e,i,n){const s=Math.min(nc(r,[e,i],n),nc(t,[e,i],n)),o=Math.min(nc(e,[r,t],n),nc(i,[r,t],n));return Math.min(s,o)}function rJ(r,t,e,i,n){if(!(na(t,r.length)&&na(i,e.length)))return 1/0;let s=1/0;for(let o=t[0];o<t[1];++o){const a=r[o],l=r[o+1];for(let c=i[0];c<i[1];++c){const h=e[c],u=e[c+1];if(uy(a,l,h,u))return 0;s=Math.min(s,lE(a,l,h,u,n))}}return s}function iJ(r,t,e,i,n){if(!(na(t,r.length)&&na(i,e.length)))return NaN;let s=1/0;for(let o=t[0];o<=t[1];++o)for(let a=i[0];a<=i[1];++a)if(s=Math.min(s,n.distance(r[o],e[a])),s===0)return s;return s}function nJ(r,t,e){if(ld(r,t,!0))return 0;let i=1/0;for(const n of t){const s=n[0],o=n[n.length-1];if(s!==o&&(i=Math.min(i,nc(r,[o,s],e)),i===0))return i;const a=e.pointOnLine(n,r);if(i=Math.min(i,e.distance(r,a.point)),i===0)return i}return i}function sJ(r,t,e,i){if(!na(t,r.length))return NaN;for(let s=t[0];s<=t[1];++s)if(ld(r[s],e,!0))return 0;let n=1/0;for(let s=t[0];s<t[1];++s){const o=r[s],a=r[s+1];for(const l of e)for(let c=0,h=l.length,u=h-1;c<h;u=c++){const d=l[u],g=l[c];if(uy(o,a,d,g))return 0;n=Math.min(n,lE(o,a,d,g,i))}}return n}function W5(r,t){for(const e of r)for(const i of e)if(ld(i,t,!0))return!0;return!1}function oJ(r,t,e,i=1/0){const n=D2(r),s=D2(t);if(i!==1/0&&aE(n,s,e)>=i)return i;if(hf(n,s)){if(W5(r,t))return 0}else if(W5(t,r))return 0;let o=1/0;for(const a of r)for(let l=0,c=a.length,h=c-1;l<c;h=l++){const u=a[h],d=a[l];for(const g of t)for(let f=0,p=g.length,m=p-1;f<p;m=f++){const y=g[m],_=g[f];if(uy(u,d,y,_))return 0;o=Math.min(o,lE(u,d,y,_,e))}}return o}function V5(r,t,e,i,n,s){if(!s)return;const o=aE(N2(i,s),n,e);o<t&&r.push([o,s,[0,0]])}function Up(r,t,e,i,n,s,o){if(!s||!o)return;const a=aE(N2(i,s),N2(n,o),e);a<t&&r.push([a,s,o])}function Am(r,t,e,i,n=1/0){let s=Math.min(i.distance(r[0],e[0][0]),n);if(s===0)return s;const o=new oL([[0,[0,r.length-1],[0,0]]],aL),a=D2(e);for(;o.length>0;){const l=o.pop();if(l[0]>=s)continue;const c=l[1],h=t?O2:L2;if(Pm(c)<=h){if(!na(c,r.length))return NaN;if(t){const u=sJ(r,c,e,i);if(isNaN(u)||u===0)return u;s=Math.min(s,u)}else for(let u=c[0];u<=c[1];++u){const d=nJ(r[u],e,i);if(s=Math.min(s,d),s===0)return 0}}else{const u=F2(c,t);V5(o,s,i,r,a,u[0]),V5(o,s,i,r,a,u[1])}}return s}function Lm(r,t,e,i,n,s=1/0){let o=Math.min(s,n.distance(r[0],e[0]));if(o===0)return o;const a=new oL([[0,[0,r.length-1],[0,e.length-1]]],aL);for(;a.length>0;){const l=a.pop();if(l[0]>=o)continue;const c=l[1],h=l[2],u=t?O2:L2,d=i?O2:L2;if(Pm(c)<=u&&Pm(h)<=d){if(!na(c,r.length)&&na(h,e.length))return NaN;let g;if(t&&i)g=rJ(r,c,e,h,n),o=Math.min(o,g);else if(t&&!i){const f=r.slice(c[0],c[1]+1);for(let p=h[0];p<=h[1];++p)if(g=nc(e[p],f,n),o=Math.min(o,g),o===0)return o}else if(!t&&i){const f=e.slice(h[0],h[1]+1);for(let p=c[0];p<=c[1];++p)if(g=nc(r[p],f,n),o=Math.min(o,g),o===0)return o}else g=iJ(r,c,e,h,n),o=Math.min(o,g)}else{const g=F2(c,t),f=F2(h,i);Up(a,o,n,r,e,g[0],f[0]),Up(a,o,n,r,e,g[0],f[1]),Up(a,o,n,r,e,g[1],f[0]),Up(a,o,n,r,e,g[1],f[1])}}return o}function aJ(r,t){const e=r.geometry(),i=e.flat().map(o=>nE([o.x,o.y],r.canonical));if(e.length===0)return NaN;const n=new oE(i[0][1]);let s=1/0;for(const o of t){switch(o.type){case"Point":s=Math.min(s,Lm(i,!1,[o.coordinates],!1,n,s));break;case"LineString":s=Math.min(s,Lm(i,!1,o.coordinates,!0,n,s));break;case"Polygon":s=Math.min(s,Am(i,!1,o.coordinates,n,s));break}if(s===0)return s}return s}function lJ(r,t){const e=r.geometry(),i=e.flat().map(o=>nE([o.x,o.y],r.canonical));if(e.length===0)return NaN;const n=new oE(i[0][1]);let s=1/0;for(const o of t){switch(o.type){case"Point":s=Math.min(s,Lm(i,!0,[o.coordinates],!1,n,s));break;case"LineString":s=Math.min(s,Lm(i,!0,o.coordinates,!0,n,s));break;case"Polygon":s=Math.min(s,Am(i,!0,o.coordinates,n,s));break}if(s===0)return s}return s}function cJ(r,t){const e=r.geometry();if(e.length===0||e[0].length===0)return NaN;const i=JQ(e).map(o=>o.map(a=>a.map(l=>nE([l.x,l.y],r.canonical)))),n=new oE(i[0][0][0][1]);let s=1/0;for(const o of t)for(const a of i){switch(o.type){case"Point":s=Math.min(s,Am([o.coordinates],!1,a,n,s));break;case"LineString":s=Math.min(s,Am(o.coordinates,!0,a,n,s));break;case"Polygon":s=Math.min(s,oJ(a,o.coordinates,n,s));break}if(s===0)return s}return s}function sv(r){return r.type==="MultiPolygon"?r.coordinates.map(t=>({type:"Polygon",coordinates:t})):r.type==="MultiLineString"?r.coordinates.map(t=>({type:"LineString",coordinates:t})):r.type==="MultiPoint"?r.coordinates.map(t=>({type:"Point",coordinates:t})):[r]}class xc{constructor(t,e){this.type=gt,this.geojson=t,this.geometries=e}static parse(t,e){if(t.length!==2)return e.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(lf(t[1])){const i=t[1];if(i.type==="FeatureCollection")return new xc(i,i.features.map(n=>sv(n.geometry)).flat());if(i.type==="Feature")return new xc(i,sv(i.geometry));if("type"in i&&"coordinates"in i)return new xc(i,sv(i))}return e.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return aJ(t,this.geometries);if(t.geometryType()==="LineString")return lJ(t,this.geometries);if(t.geometryType()==="Polygon")return cJ(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class tp{constructor(t){this.type=ce,this.key=t}static parse(t,e){if(t.length!==2)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const i=t[1];return i==null?e.error("Global state property must be defined."):typeof i!="string"?e.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new tp(i)}evaluate(t){var e;const i=(e=t.globals)===null||e===void 0?void 0:e.globalState;return!i||Object.keys(i).length===0?null:KA(i,this.key)}eachChild(){}outputDefined(){return!1}}const cE={"==":LQ,"!=":OQ,">":NQ,"<":FQ,">=":$Q,"<=":DQ,array:Ts,at:Xk,boolean:Ts,case:Jk,coalesce:cf,collator:hy,format:eE,image:rE,in:Kk,"index-of":Rm,interpolate:_c,"interpolate-hcl":_c,"interpolate-lab":_c,length:iE,let:ay,literal:Du,match:Qk,number:Ts,"number-format":tE,object:Ts,slice:Im,step:cy,string:Ts,"to-boolean":nl,"to-color":nl,"to-number":nl,"to-string":nl,var:ly,within:vc,distance:xc,"global-state":tp};let cd=class Vd{constructor(t,e,i,n){this.name=t,this.type=e,this._evaluate=i,this.args=n}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,e){const i=t[0],n=Vd.definitions[i];if(!n)return e.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const s=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,a=o.filter(([c])=>!Array.isArray(c)||c.length===t.length-1);let l=null;for(const[c,h]of a){l=new oy(e.registry,Om,e.path,null,e.scope);const u=[];let d=!1;for(let g=1;g<t.length;g++){const f=t[g],p=Array.isArray(c)?c[g-1]:c.type,m=l.parse(f,1+u.length,p);if(!m){d=!0;break}u.push(m)}if(!d){if(Array.isArray(c)&&c.length!==u.length){l.error(`Expected ${c.length} arguments, but found ${u.length} instead.`);continue}for(let g=0;g<u.length;g++){const f=Array.isArray(c)?c[g]:c.type,p=u[g];l.concat(g+1).checkSubtype(f,p.type)}if(l.errors.length===0)return new Vd(i,s,h,u)}}if(a.length===1)e.errors.push(...l.errors);else{const c=(a.length?a:o).map(([u])=>uJ(u)).join(" | "),h=[];for(let u=1;u<t.length;u++){const d=e.parse(t[u],1+h.length);if(!d)return null;h.push(Sr(d.type))}e.error(`Expected arguments of type ${c}, but found (${h.join(", ")}) instead.`)}return null}static register(t,e){Vd.definitions=e;for(const i in e)t[i]=Vd}};function Z5(r,[t,e,i,n]){t=t.evaluate(r),e=e.evaluate(r),i=i.evaluate(r);const s=n?n.evaluate(r):1,o=QA(t,e,i,s);if(o)throw new Pr(o);return new Tr(t/255,e/255,i/255,s,!1)}function H5(r,t){return r in t}function ov(r,t){const e=t[r];return typeof e>"u"?null:e}function hJ(r,t,e,i){for(;e<=i;){const n=e+i>>1;if(t[n]===r)return!0;t[n]>r?i=n-1:e=n+1}return!1}function Dl(r){return{type:r}}cd.register(cE,{error:[nQ,[we],(r,[t])=>{throw new Pr(t.evaluate(r))}],typeof:[we,[ce],(r,[t])=>Sr(ei(t.evaluate(r)))],"to-rgba":[Nn(gt,4),[uo],(r,[t])=>{const[e,i,n,s]=t.evaluate(r).rgb;return[e*255,i*255,n*255,s]}],rgb:[uo,[gt,gt,gt],Z5],rgba:[uo,[gt,gt,gt,gt],Z5],has:{type:ue,overloads:[[[we],(r,[t])=>H5(t.evaluate(r),r.properties())],[[we,pc],(r,[t,e])=>H5(t.evaluate(r),e.evaluate(r))]]},get:{type:ce,overloads:[[[we],(r,[t])=>ov(t.evaluate(r),r.properties())],[[we,pc],(r,[t,e])=>ov(t.evaluate(r),e.evaluate(r))]]},"feature-state":[ce,[we],(r,[t])=>ov(t.evaluate(r),r.featureState||{})],properties:[pc,[],r=>r.properties()],"geometry-type":[we,[],r=>r.geometryType()],id:[ce,[],r=>r.id()],zoom:[gt,[],r=>r.globals.zoom],"heatmap-density":[gt,[],r=>r.globals.heatmapDensity||0],elevation:[gt,[],r=>r.globals.elevation||0],"line-progress":[gt,[],r=>r.globals.lineProgress||0],accumulated:[ce,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[gt,Dl(gt),(r,t)=>{let e=0;for(const i of t)e+=i.evaluate(r);return e}],"*":[gt,Dl(gt),(r,t)=>{let e=1;for(const i of t)e*=i.evaluate(r);return e}],"-":{type:gt,overloads:[[[gt,gt],(r,[t,e])=>t.evaluate(r)-e.evaluate(r)],[[gt],(r,[t])=>-t.evaluate(r)]]},"/":[gt,[gt,gt],(r,[t,e])=>t.evaluate(r)/e.evaluate(r)],"%":[gt,[gt,gt],(r,[t,e])=>t.evaluate(r)%e.evaluate(r)],ln2:[gt,[],()=>Math.LN2],pi:[gt,[],()=>Math.PI],e:[gt,[],()=>Math.E],"^":[gt,[gt,gt],(r,[t,e])=>Math.pow(t.evaluate(r),e.evaluate(r))],sqrt:[gt,[gt],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[gt,[gt],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[gt,[gt],(r,[t])=>Math.log(t.evaluate(r))],log2:[gt,[gt],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[gt,[gt],(r,[t])=>Math.sin(t.evaluate(r))],cos:[gt,[gt],(r,[t])=>Math.cos(t.evaluate(r))],tan:[gt,[gt],(r,[t])=>Math.tan(t.evaluate(r))],asin:[gt,[gt],(r,[t])=>Math.asin(t.evaluate(r))],acos:[gt,[gt],(r,[t])=>Math.acos(t.evaluate(r))],atan:[gt,[gt],(r,[t])=>Math.atan(t.evaluate(r))],min:[gt,Dl(gt),(r,t)=>Math.min(...t.map(e=>e.evaluate(r)))],max:[gt,Dl(gt),(r,t)=>Math.max(...t.map(e=>e.evaluate(r)))],abs:[gt,[gt],(r,[t])=>Math.abs(t.evaluate(r))],round:[gt,[gt],(r,[t])=>{const e=t.evaluate(r);return e<0?-Math.round(-e):Math.round(e)}],floor:[gt,[gt],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[gt,[gt],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[ue,[we,ce],(r,[t,e])=>r.properties()[t.value]===e.value],"filter-id-==":[ue,[ce],(r,[t])=>r.id()===t.value],"filter-type-==":[ue,[we],(r,[t])=>r.geometryType()===t.value],"filter-<":[ue,[we,ce],(r,[t,e])=>{const i=r.properties()[t.value],n=e.value;return typeof i==typeof n&&i<n}],"filter-id-<":[ue,[ce],(r,[t])=>{const e=r.id(),i=t.value;return typeof e==typeof i&&e<i}],"filter->":[ue,[we,ce],(r,[t,e])=>{const i=r.properties()[t.value],n=e.value;return typeof i==typeof n&&i>n}],"filter-id->":[ue,[ce],(r,[t])=>{const e=r.id(),i=t.value;return typeof e==typeof i&&e>i}],"filter-<=":[ue,[we,ce],(r,[t,e])=>{const i=r.properties()[t.value],n=e.value;return typeof i==typeof n&&i<=n}],"filter-id-<=":[ue,[ce],(r,[t])=>{const e=r.id(),i=t.value;return typeof e==typeof i&&e<=i}],"filter->=":[ue,[we,ce],(r,[t,e])=>{const i=r.properties()[t.value],n=e.value;return typeof i==typeof n&&i>=n}],"filter-id->=":[ue,[ce],(r,[t])=>{const e=r.id(),i=t.value;return typeof e==typeof i&&e>=i}],"filter-has":[ue,[ce],(r,[t])=>t.value in r.properties()],"filter-has-id":[ue,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[ue,[Nn(we)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[ue,[Nn(ce)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[ue,[we,Nn(ce)],(r,[t,e])=>e.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[ue,[we,Nn(ce)],(r,[t,e])=>hJ(r.properties()[t.value],e.value,0,e.value.length-1)],all:{type:ue,overloads:[[[ue,ue],(r,[t,e])=>t.evaluate(r)&&e.evaluate(r)],[Dl(ue),(r,t)=>{for(const e of t)if(!e.evaluate(r))return!1;return!0}]]},any:{type:ue,overloads:[[[ue,ue],(r,[t,e])=>t.evaluate(r)||e.evaluate(r)],[Dl(ue),(r,t)=>{for(const e of t)if(e.evaluate(r))return!0;return!1}]]},"!":[ue,[ue],(r,[t])=>!t.evaluate(r)],"is-supported-script":[ue,[we],(r,[t])=>{const e=r.globals&&r.globals.isSupportedScript;return e?e(t.evaluate(r)):!0}],upcase:[we,[we],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[we,[we],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[we,Dl(ce),(r,t)=>t.map(e=>hg(e.evaluate(r))).join("")],"resolved-locale":[we,[ey],(r,[t])=>t.evaluate(r).resolvedLocale()]});function uJ(r){return Array.isArray(r)?`(${r.map(Sr).join(", ")})`:`(${Sr(r.type)}...)`}function Om(r){if(r instanceof ly)return Om(r.boundExpression);if(r instanceof cd&&r.name==="error"||r instanceof hy||r instanceof vc||r instanceof xc||r instanceof tp)return!1;const t=r instanceof nl||r instanceof Ts;let e=!0;return r.eachChild(i=>{t?e=e&&Om(i):e=e&&i instanceof Du}),e?hE(r)&&dE(r,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function hE(r){if(r instanceof cd&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof vc||r instanceof xc)return!1;let t=!0;return r.eachChild(e=>{t&&!hE(e)&&(t=!1)}),t}function uE(r){if(r instanceof cd&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(e=>{t&&!uE(e)&&(t=!1)}),t}function dE(r,t){if(r instanceof cd&&t.indexOf(r.name)>=0)return!1;let e=!0;return r.eachChild(i=>{e&&!dE(i,t)&&(e=!1)}),e}function $2(r){return{result:"success",value:r}}function Dh(r){return{result:"error",value:r}}function dJ(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function gJ(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function fJ(r){return!!r.expression&&r.expression.interpolated}function lL(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&ei(r)===pc}class pJ{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new JA,this._defaultValue=e?vJ(e):null,this._enumValues=e&&e.type==="enum"?e.values:null}evaluateWithoutErrorHandling(t,e,i,n,s,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=n,this._evaluator.availableImages=s||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(t,e,i,n,s,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=n,this._evaluator.availableImages=s||null,this._evaluator.formattedSection=o||null;try{const a=this.expression.evaluate(this._evaluator);if(a==null||typeof a=="number"&&a!==a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new Pr(`Expected value to be one of ${Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", ")}, but found ${JSON.stringify(a)} instead.`);return a}catch(a){return this._warningHistory[a.message]||(this._warningHistory[a.message]=!0,typeof console<"u"&&console.warn(a.message)),this._defaultValue}}}function mJ(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in cE}function cL(r,t){const e=new oy(cE,Om,[],t?_J(t):void 0),i=e.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return i?$2(new pJ(i,t)):Dh(e.errors)}class Y5{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent=t!=="constant"&&!uE(e.expression),this.globalStateRefs=dy(e.expression)}evaluateWithoutErrorHandling(t,e,i,n,s,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,n,s,o)}evaluate(t,e,i,n,s,o){return this._styleExpression.evaluate(t,e,i,n,s,o)}}class X5{constructor(t,e,i,n){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent=t!=="camera"&&!uE(e.expression),this.globalStateRefs=dy(e.expression),this.interpolationType=n}evaluateWithoutErrorHandling(t,e,i,n,s,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,n,s,o)}evaluate(t,e,i,n,s,o){return this._styleExpression.evaluate(t,e,i,n,s,o)}interpolationFactor(t,e,i){return this.interpolationType?_c.interpolationFactor(this.interpolationType,t,e,i):0}}function yJ(r,t){const e=cL(r,t);if(e.result==="error")return e;const i=e.value.expression,n=hE(i);if(!n&&!dJ(t))return Dh([new Js("","data expressions not supported")]);const s=dE(i,["zoom"]);if(!s&&!gJ(t))return Dh([new Js("","zoom expressions not supported")]);const o=T0(i);if(!o&&!s)return Dh([new Js("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof Js)return Dh([o]);if(o instanceof _c&&!fJ(t))return Dh([new Js("",'"interpolate" expressions cannot be used with this property')]);if(!o)return $2(n?new Y5("constant",e.value):new Y5("source",e.value));const a=o instanceof _c?o.interpolation:void 0;return $2(n?new X5("camera",e.value,o.labels,a):new X5("composite",e.value,o.labels,a))}function T0(r){let t=null;if(r instanceof ay)t=T0(r.result);else if(r instanceof cf){for(const e of r.args)if(t=T0(e),t)break}else(r instanceof cy||r instanceof _c)&&r.input instanceof cd&&r.input.name==="zoom"&&(t=r);return t instanceof Js||r.eachChild(e=>{const i=T0(e);i instanceof Js?t=i:!t&&i?t=new Js("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&i&&t!==i&&(t=new Js("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function dy(r,t=new Set){return r instanceof tp&&t.add(r.key),r.eachChild(e=>{dy(e,t)}),t}function _J(r){const t={color:uo,string:we,number:gt,enum:we,boolean:ue,formatted:ry,padding:iy,numberArray:ny,colorArray:sf,projectionDefinition:ty,resolvedImage:Xf,variableAnchorOffsetCollection:sy};return r.type==="array"?Nn(t[r.value]||ce,r.length):t[r.type]}function vJ(r){if(r.type==="color"&&lL(r.default))return new Tr(0,0,0,0);switch(r.type){case"color":return Tr.parse(r.default)||null;case"padding":return Rs.parse(r.default)||null;case"numberArray":return Is.parse(r.default)||null;case"colorArray":return fl.parse(r.default)||null;case"variableAnchorOffsetCollection":return od.parse(r.default)||null;case"projectionDefinition":return Qf.parse(r.default)||null;default:return r.default===void 0?null:r.default}}function hL(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!hL(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const xJ={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function wJ(r){if(r==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};hL(r)||(r=Fm(r));const t=cL(r,xJ);if(t.result==="error")throw new Error(t.value.map(e=>`${e.key}: ${e.message}`).join(", "));{const e=uL(r);return{filter:(i,n,s)=>t.value.evaluate(i,n,{},s),needGeometry:e,getGlobalStateRefs:()=>dy(t.value.expression)}}}function bJ(r,t){return r<t?-1:r>t?1:0}function uL(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(uL(r[t]))return!0;return!1}function Fm(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?av(r[1],r[2],"=="):t==="!="?Wp(av(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?av(r[1],r[2],t):t==="any"?kJ(r.slice(1)):t==="all"?["all"].concat(r.slice(1).map(Fm)):t==="none"?["all"].concat(r.slice(1).map(Fm).map(Wp)):t==="in"?K5(r[1],r.slice(2)):t==="!in"?Wp(K5(r[1],r.slice(2))):t==="has"?Q5(r[1]):t==="!has"?Wp(Q5(r[1])):!0}function av(r,t,e){switch(r){case"$type":return[`filter-type-${e}`,t];case"$id":return[`filter-id-${e}`,t];default:return[`filter-${e}`,r,t]}}function kJ(r){return["any"].concat(r.map(Fm))}function K5(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!=typeof t[0])?["filter-in-large",r,["literal",t.sort(bJ)]]:["filter-in-small",r,["literal",t]]}}function Q5(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Wp(r){return["!",r]}function uf(r){return typeof r=="object"?["literal",r]:r}function EJ(r,t){let e=r.stops;if(!e)return SJ(r,t);const i=e&&typeof e[0][0]=="object",n=i||r.property!==void 0,s=i||!n;return e=e.map(o=>!n&&t.tokens&&typeof o[1]=="string"?[o[0],RJ(o[1])]:[o[0],uf(o[1])]),i?TJ(r,t,e):s?MJ(r,t,e):G2(r,t,e)}function SJ(r,t){const e=["get",r.property];if(r.default===void 0)return t.type==="string"?["string",e]:e;if(t.type==="enum")return["match",e,Object.keys(t.values),e,r.default];{const i=[t.type==="color"?"to-color":t.type,e,uf(r.default)];return t.type==="array"&&i.splice(1,0,t.value,t.length||null),i}}function gE(r){switch(r.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function TJ(r,t,e){const i={},n={},s=[];for(let o=0;o<e.length;o++){const a=e[o],l=a[0].zoom;i[l]===void 0&&(i[l]={zoom:l,type:r.type,property:r.property,default:r.default},n[l]=[],s.push(l)),n[l].push([a[0].value,a[1]])}if(pE({},t)==="exponential"){const o=[gE(r),["linear"],["zoom"]];for(const a of s){const l=G2(i[a],t,n[a]);uu(o,a,l,!1)}return o}else{const o=["step",["zoom"]];for(const a of s){const l=G2(i[a],t,n[a]);uu(o,a,l,!0)}return fE(o),o}}function CJ(r,t){if(r!==void 0)return r;if(t!==void 0)return t}function J5(r,t){const e=uf(CJ(r.default,t.default));return e===void 0&&t.type==="resolvedImage"?"":e}function G2(r,t,e){const i=pE(r,t),n=["get",r.property];if(i==="categorical"&&typeof e[0][0]=="boolean"){const s=["case"];for(const o of e)s.push(["==",n,o[0]],o[1]);return s.push(J5(r,t)),s}else if(i==="categorical"){const s=["match",n];for(const o of e)uu(s,o[0],o[1],!1);return s.push(J5(r,t)),s}else if(i==="interval"){const s=["step",["number",n]];for(const o of e)uu(s,o[0],o[1],!0);return fE(s),r.default===void 0?s:["case",["==",["typeof",n],"number"],s,uf(r.default)]}else if(i==="exponential"){const s=r.base!==void 0?r.base:1,o=[gE(r),s===1?["linear"]:["exponential",s],["number",n]];for(const a of e)uu(o,a[0],a[1],!1);return r.default===void 0?o:["case",["==",["typeof",n],"number"],o,uf(r.default)]}else throw new Error(`Unknown property function type ${i}`)}function MJ(r,t,e,i=["zoom"]){const n=pE(r,t);let s,o=!1;if(n==="interval")s=["step",i],o=!0;else if(n==="exponential"){const a=r.base!==void 0?r.base:1;s=[gE(r),a===1?["linear"]:["exponential",a],i]}else throw new Error(`Unknown zoom function type "${n}"`);for(const a of e)uu(s,a[0],a[1],o);return fE(s),s}function fE(r){r[0]==="step"&&r.length===3&&(r.push(0),r.push(r[3]))}function uu(r,t,e,i){r.length>3&&t===r[r.length-2]||(i&&r.length===2||r.push(t),r.push(e))}function pE(r,t){return r.type?r.type:t.expression.interpolated?"exponential":"interval"}function RJ(r){const t=["concat"],e=/{([^{}]+)}/g;let i=0;for(let n=e.exec(r);n!==null;n=e.exec(r)){const s=r.slice(i,e.lastIndex-n[0].length);i=e.lastIndex,s.length>0&&t.push(s),t.push(["get",n[1]])}if(t.length===1)return r;if(i<r.length)t.push(r.slice(i));else if(t.length===2)return["to-string",t[1]];return t}const IJ=eQ,PJ={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},AJ={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},LJ=function(r,t){const e=yJ(r,t);if(e.result==="error")throw new Error(e.value.map(i=>`${i.key}: ${i.message}`).join(", "));return e.value},j2={},Nm={zoom:0};let Vp,lv;function Ft(r,t,e,i,n,s,o){const a=r.id;s||(s={},console.warn("No functionCache provided to getValue()")),s[a]||(s[a]={});const l=s[a];if(!l[e]){let c=(r[t]||j2)[e];const h=IJ[`${t}_${r.type}`][e];c===void 0&&(c=h.default);let u=mJ(c);if(!u&&lL(c)&&(c=EJ(c,h),u=!0),u){const d=LJ(c,h);l[e]=d.evaluate.bind(d)}else h.type=="color"&&(c=Tr.parse(c)),l[e]=function(){return c}}return Nm.zoom=i,l[e](Nm,n,o)}function t3(r,t,e,i,n){return Ft(r,"layout",`${i}-allow-overlap`,t,e,n)?Ft(r,"layout",`${i}-ignore-placement`,t,e,n)?"none":"obstacle":"declutter"}function OJ(r,t,e,i,n){return n||console.warn("No filterCache provided to evaluateFilter()"),r in n||(n[r]=wJ(t).filter),Nm.zoom=i,n[r](Nm,e)}function Ga(r,t){if(r){if(r.a===0||t===0)return;const e=r.a;return t=t===void 0?1:t,e===0?"transparent":"rgba("+Math.round(r.r*255/e)+","+Math.round(r.g*255/e)+","+Math.round(r.b*255/e)+","+e*t+")"}return r}const FJ=/\{[^{}}]*\}/g;function cv(r,t){return r.replace(FJ,function(e){return t[e.slice(1,-1)]||""})}const NJ={};function dL(r,t,e,i=ho,n=void 0,s=void 0,o=void 0,a=void 0){if(typeof t=="string"&&(t=JSON.parse(t)),t.version!=8)throw new Error("glStyle version 8 required.");NJ[jG(t,r)]=Array.from(arguments);let l,c,h;s&&xu(()=>s).then(async E=>{let C;if(typeof Image<"u"){const S=new Image;if(typeof E=="string")S.crossOrigin="anonymous",S.src=E;else{let R;E instanceof Request?R=await fetch(E):E instanceof Response&&(R=E);const I=await R.blob();C=URL.createObjectURL(I),S.src=C}S.addEventListener("load",function R(){S.removeEventListener("load",R),l=S,c=[S.width,S.height],r.changed(),C&&URL.revokeObjectURL(C)}),S.addEventListener("error",function R(){URL.revokeObjectURL(C),S.removeEventListener("error",R)})}else if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){const S=self;S.postMessage({action:"loadImage",src:E}),S.addEventListener("message",function(R){R.data.action==="imageLoaded"&&R.data.src===E&&(l=R.data.image,c=[l.width,l.height])})}});const u=qA(t.layers),d={},g=[],f={},p={},m=J4(t),y=zG(t);let _;for(let E=0,C=u.length;E<C;++E){const S=u[E],R=S.id;if(typeof e=="string"&&S.source==e||Array.isArray(e)&&e.indexOf(R)!==-1){const I=S["source-layer"];if(_){if(S.source!==_)throw new Error(`Layer "${R}" does not use source "${_}`)}else{_=S.source;const N=t.sources[_];if(!N)throw new Error(`Source "${_}" is not defined`);const P=N.type;if(P!=="vector"&&P!=="geojson")throw new Error(`Source "${_}" is not of type "vector" or "geojson", but "${P}"`)}let F=d[I];F||(F=[],d[I]=F),F.push({layer:S,index:E}),g.push(R)}}const x=new so,v=new ts,w=[],b=function(E,C,S){const R=E.getProperties(),I=d[R.layer];if(!I)return;let F=i.indexOf(C);F==-1&&(F=Pb(C,i));const N=PJ[E.getGeometry().getType()],P={id:E.getId(),properties:R,type:N},T=r.get("mapbox-featurestate")[E.getId()];let D=-1;for(let A=0,$=I.length;A<$;++A){const z=I[A],j=z.layer,et=j.id;if(S!==void 0&&S!==et)continue;const q=j.layout||j2,vt=j.paint||j2;if(q.visibility==="none"||"minzoom"in j&&F<j.minzoom||"maxzoom"in j&&F>=j.maxzoom)continue;const jt=j.filter;if(!jt||OJ(et,jt,P,F,y)){let V,It,Et,Mt,Ot,Y;const We=z.index;if(N==3&&(j.type=="fill"||j.type=="fill-extrusion"))if(It=Ft(j,"paint",j.type+"-opacity",F,P,m,T),j.type+"-pattern"in vt){const dt=Ft(j,"paint",j.type+"-pattern",F,P,m,T);if(dt){const pt=typeof dt=="string"?cv(dt,R):dt.toString();if(l&&n&&n[pt]){++D,Y=w[D],(!Y||!Y.getFill()||Y.getStroke()||Y.getText())&&(Y=new Vr({fill:new ts}),w[D]=Y),Et=Y.getFill(),Y.setZIndex(We);const kt=pt+"."+It;let Dt=p[kt];if(!Dt){const wt=n[pt],zt=O1(wt.width,wt.height),Jt=zt.getContext("2d");Jt.globalAlpha=It,Jt.drawImage(l,wt.x,wt.y,wt.width,wt.height,0,0,wt.width,wt.height),Dt=Jt.createPattern(zt,"repeat"),p[kt]=Dt}Et.setColor(Dt)}}}else V=Ga(Ft(j,"paint",j.type+"-color",F,P,m,T),It),j.type+"-outline-color"in vt&&(Ot=Ga(Ft(j,"paint",j.type+"-outline-color",F,P,m,T),It)),Ot||(Ot=V),(V||Ot)&&(++D,Y=w[D],(!Y||V&&!Y.getFill()||!V&&Y.getFill()||Ot&&!Y.getStroke()||!Ot&&Y.getStroke()||Y.getText())&&(Y=new Vr({fill:V?new ts:void 0,stroke:Ot?new so:void 0}),w[D]=Y),V&&(Et=Y.getFill(),Et.setColor(V)),Ot&&(Mt=Y.getStroke(),Mt.setColor(Ot),Mt.setWidth(.5)),Y.setZIndex(We));if(N!=1&&j.type=="line"){"line-pattern"in vt?V=void 0:V=Ga(Ft(j,"paint","line-color",F,P,m,T),Ft(j,"paint","line-opacity",F,P,m,T));const dt=Ft(j,"paint","line-width",F,P,m,T);V&&dt>0&&(++D,Y=w[D],(!Y||!Y.getStroke()||Y.getFill()||Y.getText())&&(Y=new Vr({stroke:new so}),w[D]=Y),Mt=Y.getStroke(),Mt.setLineCap(Ft(j,"layout","line-cap",F,P,m,T)),Mt.setLineJoin(Ft(j,"layout","line-join",F,P,m,T)),Mt.setMiterLimit(Ft(j,"layout","line-miter-limit",F,P,m,T)),Mt.setColor(V),Mt.setWidth(dt),Mt.setLineDash(vt["line-dasharray"]?Ft(j,"paint","line-dasharray",F,P,m,T).map(function(pt){return pt*dt}):null),Y.setZIndex(We))}let L=!1,O=null,U=0,X,W,K;if((N==1||N==2)&&"icon-image"in q){const dt=Ft(j,"layout","icon-image",F,P,m,T);if(dt){X=typeof dt=="string"?cv(dt,R):dt.toString();let pt;const kt=a?a(r,X):void 0;if(l&&n&&n[X]||kt){const Dt=Ft(j,"layout","icon-rotation-alignment",F,P,m,T);if(N==2){const wt=E.getGeometry();if(wt.getFlatMidpoint||wt.getFlatMidpoints){const zt=wt.getExtent();if(Math.sqrt(Math.max(Math.pow((zt[2]-zt[0])/C,2),Math.pow((zt[3]-zt[1])/C,2)))>150){const Jt=wt.getType()==="MultiLineString"?wt.getFlatMidpoints():wt.getFlatMidpoint();if(lv||(Vp=[NaN,NaN],lv=new Gi("Point",Vp,[],2,{},void 0)),pt=lv,Vp[0]=Jt[0],Vp[1]=Jt[1],Ft(j,"layout","symbol-placement",F,P,m,T)==="line"&&Dt==="map"){const ve=wt.getStride(),Ce=wt.getFlatCoordinates();for(let Ve=0,qr=Ce.length-ve;Ve<qr;Ve+=ve){const Pe=Ce[Ve],le=Ce[Ve+1],Cr=Ce[Ve+ve],er=Ce[Ve+ve+1],Br=Math.min(Pe,Cr),lr=Math.max(Pe,Cr),Yr=Jt[0],Cn=Jt[1],an=(er-le)*(Yr-Pe)-(Cr-Pe)*(Cn-le);if(Math.abs(an)<.001&&Yr<=lr&&Yr>=Br){U=Math.atan2(le-er,Cr-Pe);break}}}}}}if(N!==2||pt){const wt=Ft(j,"layout","icon-size",F,P,m,T),zt=vt["icon-color"]!==void 0?Ft(j,"paint","icon-color",F,P,m,T):null;if(!zt||zt.a!==0){const Jt=Ft(j,"paint","icon-halo-color",F,P,m,T),ve=Ft(j,"paint","icon-halo-width",F,P,m,T);let Ce=`${X}.${wt}.${ve}.${Jt}`;if(zt!==null&&(Ce+=`.${zt}`),W=f[Ce],!W){const Ve=t3(j,F,P,"icon",m);let qr;"icon-offset"in q&&(qr=Ft(j,"layout","icon-offset",F,P,m,T).slice(0),qr[0]*=wt,qr[1]*=-wt);let Pe=zt?[zt.r*255,zt.g*255,zt.b*255,zt.a]:void 0;if(kt){const le={color:Pe,rotateWithView:Dt==="map",displacement:qr,declutterMode:Ve,scale:wt};typeof kt=="string"?le.src=kt:(le.img=kt,le.imgSize=[kt.width,kt.height]),W=new kl(le)}else{const le=n[X];let Cr,er,Br;ve?le.sdf?(Cr=rC(iC(l,le,zt||[0,0,0,1]),{x:0,y:0,width:le.width,height:le.height,pixelRatio:le.pixelRatio},ve,Jt),Pe=void 0):Cr=rC(l,le,ve,Jt):(le.sdf?(h||(h=iC(l,{x:0,y:0,width:c[0],height:c[1]},{r:1,g:1,b:1})),Cr=h):Cr=l,er=[le.width,le.height],Br=[le.x,le.y]),W=new kl({color:Pe,img:Cr,imgSize:c,size:er,offset:Br,rotateWithView:Dt==="map",scale:wt/le.pixelRatio,displacement:qr,declutterMode:Ve})}f[Ce]=W}}W&&(++D,Y=w[D],(!Y||!Y.getImage()||Y.getFill()||Y.getStroke())&&(Y=new Vr,w[D]=Y),Y.setGeometry(pt),W.setRotation(U+b_(Ft(j,"layout","icon-rotate",F,P,m,T))),W.setOpacity(Ft(j,"paint","icon-opacity",F,P,m,T)),W.setAnchor(AJ[Ft(j,"layout","icon-anchor",F,P,m,T)]),Y.setImage(W),O=Y.getText(),Y.setText(void 0),Y.setZIndex(We),L=!0,K=!1)}else K=!0}}}if(N==1&&j.type==="circle"){++D,Y=w[D],(!Y||!Y.getImage()||Y.getFill()||Y.getStroke())&&(Y=new Vr,w[D]=Y);const dt="circle-radius"in vt?Ft(j,"paint","circle-radius",F,P,m,T):5,pt=Ga(Ft(j,"paint","circle-stroke-color",F,P,m,T),Ft(j,"paint","circle-stroke-opacity",F,P,m,T)),kt=Ft(j,"paint","circle-translate",F,P,m,T),Dt=Ga(Ft(j,"paint","circle-color",F,P,m,T),Ft(j,"paint","circle-opacity",F,P,m,T)),wt=Ft(j,"paint","circle-stroke-width",F,P,m,T),zt=dt+"."+pt+"."+Dt+"."+wt+"."+kt[0]+"."+kt[1];W=f[zt],W||(W=new B1({radius:dt,displacement:[kt[0],-kt[1]],stroke:pt&&wt>0?new so({width:wt,color:pt}):void 0,fill:Dt?new ts({color:Dt}):void 0,declutterMode:"none"}),f[zt]=W),Y.setImage(W),O=Y.getText(),Y.setText(void 0),Y.setGeometry(void 0),Y.setZIndex(We),L=!0}let it,ot,rt,H,ut,mt;if("text-field"in q){H=Math.round(Ft(j,"layout","text-size",F,P,m,T));const dt=Ft(j,"layout","text-font",F,P,m,T);rt=Ft(j,"layout","text-line-height",F,P,m,T),ot=Gx(o?o(dt,t.metadata?t.metadata["ol:webfonts"]:void 0):dt,H,rt),ot.includes("sans-serif")||(ot+=",sans-serif"),ut=Ft(j,"layout","text-letter-spacing",F,P,m,T),mt=Ft(j,"layout","text-max-width",F,P,m,T);const pt=Ft(j,"layout","text-field",F,P,m,T);typeof pt=="object"&&pt.sections?pt.sections.length===1?it=pt.toString():it=pt.sections.reduce((kt,Dt,wt)=>{const zt=Dt.fontStack?Dt.fontStack.split(","):dt,Jt=Gx(o?o(zt):zt,H*(Dt.scale||1),rt);let ve=Dt.text;if(ve===`
`)return kt.push(`
`,""),kt;if(N==2)return kt.push(jx(ve,ut),Jt),kt;ve=zx(ve,Jt,mt,ut).split(`
`);for(let Ce=0,Ve=ve.length;Ce<Ve;++Ce)Ce>0&&kt.push(`
`,""),kt.push(ve[Ce],Jt);return kt},[]):it=cv(pt,R).trim(),It=Ft(j,"paint","text-opacity",F,P,m,T)}if(it&&It&&!K){L||(++D,Y=w[D],(!Y||!Y.getText()||Y.getFill()||Y.getStroke())&&(Y=new Vr,w[D]=Y),Y.setImage(void 0),Y.setGeometry(void 0));const dt=t3(j,F,P,"text",m);Y.getText()||Y.setText(O),O=Y.getText(),(!O||"getDeclutterMode"in O&&O.getDeclutterMode()!==dt)&&(O=new lP({padding:[2,2,2,2],declutterMode:dt}),Y.setText(O));const pt=Ft(j,"layout","text-transform",F,P,m,T);pt=="uppercase"?it=Array.isArray(it)?it.map((lr,Yr)=>Yr%2?lr:lr.toUpperCase()):it.toUpperCase():pt=="lowercase"&&(it=Array.isArray(it)?it.map((lr,Yr)=>Yr%2?lr:lr.toLowerCase()):it.toLowerCase());const kt=Array.isArray(it)?it:N==2?jx(it,ut):zx(it,ot,mt,ut);if(O.setText(kt),O.setFont(ot),O.setRotation(b_(Ft(j,"layout","text-rotate",F,P,m,T))),typeof O.setKeepUpright=="function"){const lr=Ft(j,"layout","text-keep-upright",F,P,m,T);O.setKeepUpright(lr)}const Dt=Ft(j,"layout","text-anchor",F,P,m,T),wt=L||N==1?"point":Ft(j,"layout","symbol-placement",F,P,m,T);let zt;if(wt==="line-center"?(O.setPlacement("line"),zt="center"):O.setPlacement(wt),wt==="line"&&typeof O.setRepeat=="function"){const lr=Ft(j,"layout","symbol-spacing",F,P,m,T);O.setRepeat(lr*2)}O.setOverflow(wt==="point");let Jt=Ft(j,"paint","text-halo-width",F,P,m,T);const ve=Ft(j,"layout","text-offset",F,P,m,T),Ce=Ft(j,"paint","text-translate",F,P,m,T);let Ve=0,qr=0;if(wt=="point"){zt="center",Dt.indexOf("left")!==-1?(zt="left",qr=Jt):Dt.indexOf("right")!==-1&&(zt="right",qr=-Jt);const lr=Ft(j,"layout","text-rotation-alignment",F,P,m,T);O.setRotateWithView(lr=="map")}else O.setMaxAngle(b_(Ft(j,"layout","text-max-angle",F,P,m,T))*it.length/kt.length),O.setRotateWithView(!1);O.setTextAlign(zt);let Pe="middle";Dt.indexOf("bottom")==0?(Pe="bottom",Ve=-Jt-.5*(rt-1)*H):Dt.indexOf("top")==0&&(Pe="top",Ve=Jt+.5*(rt-1)*H),O.setTextBaseline(Pe);const le=Ft(j,"layout","text-justify",F,P,m,T);O.setJustify(le==="auto"?void 0:le),O.setOffsetX(ve[0]*H+qr+Ce[0]),O.setOffsetY(ve[1]*H+Ve+Ce[1]),v.setColor(Ga(Ft(j,"paint","text-color",F,P,m,T),It)),O.setFill(v);const Cr=Ga(Ft(j,"paint","text-halo-color",F,P,m,T),It);if(Cr&&Jt>0){x.setColor(Cr),Jt*=2;const lr=.5*H;x.setWidth(Jt<=lr?Jt:lr),O.setStroke(x)}else O.setStroke(void 0);const er=Ft(j,"layout","text-padding",F,P,m,T),Br=O.getPadding();er!==Br[0]&&(Br[0]=er,Br[1]=er,Br[2]=er,Br[3]=er),Y.setZIndex(We)}}}if(D>-1)return w.length=D+1,w};return r.setStyle(b),r.set("mapbox-source",_),r.set("mapbox-layers",g),r.set("mapbox-featurestate",r.get("mapbox-featurestate")||{}),b}class gL extends _k{constructor(t){super(),t=t||{},this.dataProjection=new s1({code:"",units:"tile-pixels"}),this.featureClass=t.featureClass?t.featureClass:Gi,this.geometryName_=t.geometryName,this.layerName_=t.layerName?t.layerName:"layer",this.layers_=t.layers?t.layers:null,this.idProperty_=t.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(t,e,i,n){t.pos=e.geometry;const s=t.readVarint()+t.pos;let o=1,a=0,l=0,c=0,h=0,u=0;for(;t.pos<s;){if(!a){const d=t.readVarint();o=d&7,a=d>>3}if(a--,o===1||o===2)l+=t.readSVarint(),c+=t.readSVarint(),o===1&&h>u&&(n.push(h),u=h),i.push(l,c),h+=2;else if(o===7)h>u&&(i.push(i[u],i[u+1]),h+=2);else throw new Error("Invalid command found in the PBF")}h>u&&(n.push(h),u=h)}createFeature_(t,e,i){const n=e.type;if(n===0)return null;let s;const o=e.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=e.id,o[this.layerName_]=e.layer.name;const l=[],c=[];this.readRawGeometry_(t,e,l,c);const h=zJ(n,c.length);if(this.featureClass===Gi)s=new this.featureClass(h,l,c,2,o,a),s.transform(i.dataProjection);else{let u;if(h=="Polygon"){const f=WI(l,c);u=f.length>1?new Jc(l,"XY",f):new gs(l,"XY",c)}else u=h==="Point"?new Pi(l,"XY"):h==="LineString"?new kn(l,"XY"):h==="MultiPoint"?new td(l,"XY"):h==="MultiLineString"?new Qc(l,"XY",c):null;const d=this.featureClass;s=new d,this.geometryName_&&s.setGeometryName(this.geometryName_);const g=th(u,!1,i);s.setGeometry(g),a!==void 0&&s.setId(a),s.setProperties(o,!0)}return s}getType(){return"arraybuffer"}readFeatures(t,e){const i=this.layers_;e=this.adaptOptions(e);const n=ee(e.dataProjection);n.setWorldExtent(e.extent),e.dataProjection=n;const s=new IA(t),o=s.readFields(DJ,{}),a=[];for(const l in o){if(i&&!i.includes(l))continue;const c=o[l],h=c?[0,0,c.extent,c.extent]:null;n.setExtent(h);for(let u=0,d=c.length;u<d;++u){const g=jJ(s,c,u),f=this.createFeature_(s,g,e);f!==null&&a.push(f)}}return a}readProjection(t){return this.dataProjection}setLayers(t){this.layers_=t}}function DJ(r,t,e){if(r===3){const i={keys:[],values:[],features:[]},n=e.readVarint()+e.pos;e.readFields($J,i,n),i.length=i.features.length,i.length&&(t[i.name]=i)}}function $J(r,t,e){if(r===15)t.version=e.readVarint();else if(r===1)t.name=e.readString();else if(r===5)t.extent=e.readVarint();else if(r===2)t.features.push(e.pos);else if(r===3)t.keys.push(e.readString());else if(r===4){let i=null;const n=e.readVarint()+e.pos;for(;e.pos<n;)r=e.readVarint()>>3,i=r===1?e.readString():r===2?e.readFloat():r===3?e.readDouble():r===4?e.readVarint64():r===5?e.readVarint():r===6?e.readSVarint():r===7?e.readBoolean():null;t.values.push(i)}}function GJ(r,t,e){if(r==1)t.id=e.readVarint();else if(r==2){const i=e.readVarint()+e.pos;for(;e.pos<i;){const n=t.layer.keys[e.readVarint()],s=t.layer.values[e.readVarint()];t.properties[n]=s}}else r==3?t.type=e.readVarint():r==4&&(t.geometry=e.pos)}function jJ(r,t,e){r.pos=t.features[e];const i=r.readVarint()+r.pos,n={layer:t,type:0,properties:{}};return r.readFields(GJ,n,i),n}function zJ(r,t){let e;return r===1?e=t===1?"Point":"MultiPoint":r===2?e=t===1?"LineString":"MultiLineString":r===3&&(e="Polygon"),e}class qJ extends ak{constructor(t){super(t),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],i=t.pixelRatio,n=t.viewState,s=n.resolution,o=this.getLayer().getSource(),a=t.viewHints;let l=t.extent;if(e.extent!==void 0&&(l=As(l,Cs(e.extent,n.projection))),!a[vr.ANIMATING]&&!a[vr.INTERACTING]&&!Bc(l))if(o){const c=n.projection,h=o.getImage(l,s,i,c);h&&(this.loadImage(h)?this.image=h:h.getState()===St.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=Qr(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!Sc(s,n))return null;const o=this.image.getExtent(),a=this.image.getImage(),l=Me(o),c=Math.floor(a.width*((n[0]-o[0])/l));if(c<0||c>=a.width)return null;const h=Ar(o),u=Math.floor(a.height*((o[3]-n[1])/h));return u<0||u>=a.height?null:this.getImageData(a,c,u)}renderFrame(t,e){const i=this.image,n=i.getExtent(),s=i.getResolution(),[o,a]=Array.isArray(s)?s:[s,s],l=i.getPixelRatio(),c=t.layerStatesArray[t.layerIndex],h=t.pixelRatio,u=t.viewState,d=u.center,g=u.resolution,f=h*o/(g*l),p=h*a/(g*l);this.prepareContainer(t,e);const m=this.context.canvas.width,y=this.context.canvas.height,_=this.getRenderContext(t);let x=!1,v=!0;if(c.extent){const S=Cs(c.extent,u.projection);v=wr(S,t.extent),x=v&&!eo(S,t.extent),x&&this.clipUnrotated(_,t,S)}const w=i.getImage(),b=bo(this.tempTransform,m/2,y/2,f,p,0,l*(n[0]-d[0])/o,l*(d[1]-n[3])/a);this.renderedResolution=a*h/l;const E=w.width*b[0],C=w.height*b[3];if(this.getLayer().getSource().getInterpolate()||(_.imageSmoothingEnabled=!1),this.preRender(_,t),v&&E>=.5&&C>=.5){const S=b[4],R=b[5],I=c.opacity;I!==1&&(_.save(),_.globalAlpha=I),_.drawImage(w,0,0,+w.width,+w.height,S,R,E,C),I!==1&&_.restore()}return this.postRender(this.context,t),x&&_.restore(),_.imageSmoothingEnabled=!0,this.container}}class BJ extends Kc{constructor(t){t=t||{},super(t)}}class mE extends BJ{constructor(t){super(t)}createRenderer(){return new qJ(this)}getData(t){return super.getData(t)}}function z2(r){return r instanceof Image||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageBitmap?r:null}const UJ=new Error("disposed"),WJ=[256,256];class e3 extends Mf{constructor(t){const e=yt.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=z2(this.data_);return t?[t.width,t.height]:WJ}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==yt.IDLE&&this.state!==yt.ERROR)return;this.state=yt.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=yt.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=yt.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(UJ),this.controller_=null),super.disposeInternal()}}let hv;const du=[];function r3(r,t,e,i,n){r.beginPath(),r.moveTo(0,0),r.lineTo(t,e),r.lineTo(i,n),r.closePath(),r.save(),r.clip(),r.fillRect(0,0,Math.max(t,i)+1,Math.max(e,n)),r.restore()}function uv(r,t){return Math.abs(r[t*4]-210)>2||Math.abs(r[t*4+3]-.75*255)>2}function VJ(){if(hv===void 0){const r=Or(6,6,du);r.globalCompositeOperation="lighter",r.fillStyle="rgba(210, 0, 0, 0.75)",r3(r,4,5,4,0),r3(r,4,5,0,5);const t=r.getImageData(0,0,3,3).data;hv=uv(t,0)||uv(t,4)||uv(t,8),Cf(r),du.push(r.canvas)}return hv}function df(r,t,e,i){const n=qs(e,t,r);let s=Yv(t,i,e);const o=t.getMetersPerUnit();o!==void 0&&(s*=o);const a=r.getMetersPerUnit();a!==void 0&&(s/=a);const l=r.getExtent();if(!l||Sc(l,n)){const c=Yv(r,s,n)/s;isFinite(c)&&c>0&&(s/=c)}return s}function ZJ(r,t,e,i){const n=Wi(e);let s=df(r,t,n,i);return(!isFinite(s)||s<=0)&&_w(e,function(o){return s=df(r,t,o,i),isFinite(s)&&s>0}),s}function fL(r,t,e,i,n,s,o,a,l,c,h,u,d,g){const f=Or(Math.round(e*r),Math.round(e*t),du);if(u||(f.imageSmoothingEnabled=!1),l.length===0)return f.canvas;f.scale(e,e);function p(w){return Math.round(w*e)/e}f.globalCompositeOperation="lighter";const m=nn();l.forEach(function(w,b,E){yw(m,w.extent)});let y;const _=e/i,x=(u?1:1+Math.pow(2,-24))/_;if(!d||l.length!==1||c!==0){if(y=Or(Math.round(Me(m)*_),Math.round(Ar(m)*_),du),u||(y.imageSmoothingEnabled=!1),n&&g){const w=(n[0]-m[0])*_,b=-(n[3]-m[3])*_,E=Me(n)*_,C=Ar(n)*_;y.rect(w,b,E,C),y.clip()}l.forEach(function(w,b,E){if(w.image.width>0&&w.image.height>0){if(w.clipExtent){y.save();const F=(w.clipExtent[0]-m[0])*_,N=-(w.clipExtent[3]-m[3])*_,P=Me(w.clipExtent)*_,T=Ar(w.clipExtent)*_;y.rect(u?F:Math.round(F),u?N:Math.round(N),u?P:Math.round(F+P)-Math.round(F),u?T:Math.round(N+T)-Math.round(N)),y.clip()}const C=(w.extent[0]-m[0])*_,S=-(w.extent[3]-m[3])*_,R=Me(w.extent)*_,I=Ar(w.extent)*_;y.drawImage(w.image,c,c,w.image.width-2*c,w.image.height-2*c,u?C:Math.round(C),u?S:Math.round(S),u?R:Math.round(C+R)-Math.round(C),u?I:Math.round(S+I)-Math.round(S)),w.clipExtent&&y.restore()}})}const v=da(o);return a.getTriangles().forEach(function(w,b,E){const C=w.source,S=w.target;let R=C[0][0],I=C[0][1],F=C[1][0],N=C[1][1],P=C[2][0],T=C[2][1];const D=p((S[0][0]-v[0])/s),A=p(-(S[0][1]-v[1])/s),$=p((S[1][0]-v[0])/s),z=p(-(S[1][1]-v[1])/s),j=p((S[2][0]-v[0])/s),et=p(-(S[2][1]-v[1])/s),q=R,vt=I;R=0,I=0,F-=q,N-=vt,P-=q,T-=vt;const jt=[[F,N,0,0,$-D],[P,T,0,0,j-D],[0,0,F,N,z-A],[0,0,P,T,et-A]],V=CO(jt);if(!V)return;if(f.save(),f.beginPath(),VJ()||!u){f.moveTo($,z);const Et=4,Mt=D-$,Ot=A-z;for(let Y=0;Y<Et;Y++)f.lineTo($+p((Y+1)*Mt/Et),z+p(Y*Ot/(Et-1))),Y!=Et-1&&f.lineTo($+p((Y+1)*Mt/Et),z+p((Y+1)*Ot/(Et-1)));f.lineTo(j,et)}else f.moveTo($,z),f.lineTo(D,A),f.lineTo(j,et);f.clip(),f.transform(V[0],V[2],V[1],V[3],D,A),f.translate(m[0]-q,m[3]-vt);let It;if(y)It=y.canvas,f.scale(x,-x);else{const Et=l[0],Mt=Et.extent;It=Et.image,f.scale(Me(Mt)/It.width,-Ar(Mt)/It.height)}f.drawImage(It,0,0),f.restore()}),y&&(Cf(y),du.push(y.canvas)),h&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach(function(w,b,E){const C=w.target,S=(C[0][0]-v[0])/s,R=-(C[0][1]-v[1])/s,I=(C[1][0]-v[0])/s,F=-(C[1][1]-v[1])/s,N=(C[2][0]-v[0])/s,P=-(C[2][1]-v[1])/s;f.beginPath(),f.moveTo(I,F),f.lineTo(S,R),f.lineTo(N,P),f.closePath(),f.stroke()}),f.restore()),f.canvas}const HJ=10,i3=.25;class pL{constructor(t,e,i,n,s,o,a){this.sourceProj_=t,this.targetProj_=e;let l={};const c=a?iF(x=>Qr(a,qs(x,this.targetProj_,this.sourceProj_))):yo(this.targetProj_,this.sourceProj_);this.transformInv_=function(x){const v=x[0]+"/"+x[1];return l[v]||(l[v]=c(x)),l[v]},this.maxSourceExtent_=n,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Me(n)>=Me(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Me(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Me(this.targetProj_.getExtent()):null;const h=da(i),u=n1(i),d=i1(i),g=r1(i),f=this.transformInv_(h),p=this.transformInv_(u),m=this.transformInv_(d),y=this.transformInv_(g),_=HJ+(o?Math.max(0,Math.ceil(Math.log2(Uv(i)/(o*o*256*256)))):0);if(this.addQuad_(h,u,d,g,f,p,m,y,_),this.wrapsXInSource_){let x=1/0;this.triangles_.forEach(function(v,w,b){x=Math.min(x,v.source[0][0],v.source[1][0],v.source[2][0])}),this.triangles_.forEach(v=>{if(Math.max(v.source[0][0],v.source[1][0],v.source[2][0])-x>this.sourceWorldWidth_/2){const w=[[v.source[0][0],v.source[0][1]],[v.source[1][0],v.source[1][1]],[v.source[2][0],v.source[2][1]]];w[0][0]-x>this.sourceWorldWidth_/2&&(w[0][0]-=this.sourceWorldWidth_),w[1][0]-x>this.sourceWorldWidth_/2&&(w[1][0]-=this.sourceWorldWidth_),w[2][0]-x>this.sourceWorldWidth_/2&&(w[2][0]-=this.sourceWorldWidth_);const b=Math.min(w[0][0],w[1][0],w[2][0]);Math.max(w[0][0],w[1][0],w[2][0])-b<this.sourceWorldWidth_/2&&(v.source=w)}})}l={}}addTriangle_(t,e,i,n,s,o){this.triangles_.push({source:[n,s,o],target:[t,e,i]})}addQuad_(t,e,i,n,s,o,a,l,c){const h=Ei([s,o,a,l]),u=this.sourceWorldWidth_?Me(h)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&u>.5&&u<1;let f=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const m=Ei([t,e,i,n]);f=Me(m)/this.targetWorldWidth_>i3||f}!g&&this.sourceProj_.isGlobal()&&u&&(f=u>i3||f)}if(!f&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!wr(h,this.maxSourceExtent_))return;let p=0;if(!f&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)f=!0;else if(p=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),p!=1&&p!=2&&p!=4&&p!=8)return}if(c>0){if(!f){const m=[(t[0]+i[0])/2,(t[1]+i[1])/2],y=this.transformInv_(m);let _;g?_=(cl(s[0],d)+cl(a[0],d))/2-cl(y[0],d):_=(s[0]+a[0])/2-y[0];const x=(s[1]+a[1])/2-y[1];f=_*_+x*x>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const m=[(e[0]+i[0])/2,(e[1]+i[1])/2],y=this.transformInv_(m),_=[(n[0]+t[0])/2,(n[1]+t[1])/2],x=this.transformInv_(_);this.addQuad_(t,e,m,_,s,o,y,x,c-1),this.addQuad_(_,m,i,n,x,y,a,l,c-1)}else{const m=[(t[0]+e[0])/2,(t[1]+e[1])/2],y=this.transformInv_(m),_=[(i[0]+n[0])/2,(i[1]+n[1])/2],x=this.transformInv_(_);this.addQuad_(t,m,_,n,s,y,x,l,c-1),this.addQuad_(m,e,i,_,y,o,a,x,c-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(p&11)==0&&this.addTriangle_(t,i,n,s,a,l),(p&14)==0&&this.addTriangle_(t,i,e,s,a,o),p&&((p&13)==0&&this.addTriangle_(e,n,t,o,l,s),(p&7)==0&&this.addTriangle_(e,n,i,o,l,a))}calculateSourceExtent(){const t=nn();return this.triangles_.forEach(function(e,i,n){const s=e.source;Yd(t,s[0]),Yd(t,s[1]),Yd(t,s[2])}),t}getTriangles(){return this.triangles_}}const mL=.5;class yL extends Mf{constructor(t,e,i,n,s,o,a,l,c,h,u,d){super(s,yt.IDLE,d),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const g=n.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const m=f?As(g,f):g;if(Uv(m)===0){this.state=yt.EMPTY;return}const y=t.getExtent();y&&(p?p=As(p,y):p=y);const _=n.getResolution(this.wrappedTileCoord_[0]),x=ZJ(t,i,m,_);if(!isFinite(x)||x<=0){this.state=yt.EMPTY;return}const v=h!==void 0?h:mL;if(this.triangulation_=new pL(t,i,m,p,x*v,_),this.triangulation_.getTriangles().length===0){this.state=yt.EMPTY;return}this.sourceZ_=e.getZForResolution(x);let w=this.triangulation_.calculateSourceExtent();if(p&&(t.canWrapX()?(w[1]=kr(w[1],p[1],p[3]),w[3]=kr(w[3],p[1],p[3])):w=As(w,p)),!Uv(w))this.state=yt.EMPTY;else{let b=0,E=0;t.canWrapX()&&(b=Me(y),E=Math.floor((w[0]-y[0])/b)),GM(w.slice(),t,!0).forEach(C=>{const S=e.getTileRangeForExtentAndZ(C,this.sourceZ_);for(let R=S.minX;R<=S.maxX;R++)for(let I=S.minY;I<=S.maxY;I++){const F=c(this.sourceZ_,R,I,a);if(F){const N=E*b;this.sourceTiles_.push({tile:F,offset:N})}}++E}),this.sourceTiles_.length===0&&(this.state=yt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{const i=e.tile;if(i&&i.getState()==yt.LOADED){const n=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);n[0]+=e.offset,n[2]+=e.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=e.offset,s[2]+=e.offset),t.push({extent:n,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=yt.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=fL(n,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=yt.LOADED}this.changed()}load(){if(this.state==yt.IDLE){this.state=yt.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(i==yt.IDLE||i==yt.LOADING){t++;const n=Oe(e,Vt.CHANGE,s=>{const o=e.getState();(o==yt.LOADED||o==yt.ERROR||o==yt.EMPTY)&&(sr(n),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},i,n){e.getState()==yt.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(sr),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Cf(this.canvas_.getContext("2d")),du.push(this.canvas_),this.canvas_=null),super.release()}}class Dm{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof bf&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return Re(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return Re(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.key_;return t}getValues(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){Re(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}}function $m(r,t,e,i){return i!==void 0?(i[0]=r,i[1]=t,i[2]=e,i):[r,t,e]}function YJ(r,t,e){return r+"/"+t+"/"+e}function C0(r,t,e,i,n){return`${$t(r)},${t},${YJ(e,i,n)}`}function _L(r){return XJ(r[0],r[1],r[2])}function XJ(r,t,e){return(t<<r)+e}function KJ(r,t){const e=r[0],i=r[1],n=r[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const s=t.getFullTileRange(e);return s?s.containsXY(i,n):!0}function dv(r,t,e){if(!(e in r))return r[e]=new Set([t]),!0;const i=r[e],n=i.has(t);return n||i.add(t),!n}function QJ(r,t,e){const i=r[e];return i?i.delete(t):!1}function n3(r,t){const e=r.layerStatesArray[r.layerIndex];e.extent&&(t=As(t,Cs(e.extent,r.viewState.projection)));const i=e.layer.getRenderSource();if(!i.getWrapX()){const n=i.getTileGridForProjection(r.viewState.projection).getExtent();n&&(t=As(t,n))}return t}class vL extends ak{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=nn(),this.tempTileRange_=new kk(0,0,0,0),this.tempTileCoord_=$m(0,0,0);const i=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new Dm(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new Dm(512)),this.sourceTileCache_}getOrCreateTile(t,e,i,n){const s=this.tileCache_,o=this.getLayer().getSource(),a=C0(o,o.getKey(),t,e,i);let l;if(s.containsKey(a))l=s.get(a);else{const c=n.viewState.projection,h=o.getProjection();if(l=o.getTile(t,e,i,n.pixelRatio,c,!h||Mi(h,c)?void 0:this.getSourceTileCache()),!l)return null;s.set(a,l)}return l}getTile(t,e,i,n){return this.getOrCreateTile(t,e,i,n)||null}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=Qr(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!Sc(s,n))return null;const o=e.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(e.pixelRatio);for(let h=l.getZForResolution(o.resolution);h>=l.getMinZoom();--h){const u=l.getTileCoordForCoordAndZ(n,h),d=this.getTile(h,u[1],u[2],e);if(!d||d.getState()!==yt.LOADED)continue;const g=l.getOrigin(h),f=Ui(l.getTileSize(h)),p=l.getResolution(h);let m;if(d instanceof LP||d instanceof yL)m=d.getImage();else if(d instanceof e3){if(m=z2(d.getData()),!m)continue}else continue;const y=Math.floor(c*((n[0]-g[0])/p-u[1]*f[0])),_=Math.floor(c*((g[1]-n[1])/p-u[2]*f[1])),x=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(m,y+x,_+x)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const i=e.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===e.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(t,e,i,n,s){const o=t.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=$t(l);h in t.wantedTiles||(t.wantedTiles[h]={});const u=t.wantedTiles[h],d=a.getMapInternal(),g=Math.max(i-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),f=o.rotation,p=f?NM(o.center,o.resolution,f,t.size):void 0;for(let m=i;m>=g;--m){const y=c.getTileRangeForExtentAndZ(e,m,this.tempTileRange_),_=c.getResolution(m);for(let x=y.minX;x<=y.maxX;++x)for(let v=y.minY;v<=y.maxY;++v){if(f&&!c.tileCoordIntersectsViewport([m,x,v],p))continue;const w=this.getTile(m,x,v,t);if(!w||!dv(n,w,m))continue;const b=w.getKey();if(u[b]=!0,w.getState()===yt.IDLE&&!t.tileQueue.isKeyQueued(b)){const E=$m(m,x,v,this.tempTileCoord_);t.tileQueue.enqueue([w,h,c.getTileCoordCenter(E),_])}}}}findStaleTile_(t,e){const i=this.tileCache_,n=t[0],s=t[1],o=t[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=C0(this.getLayer().getSource(),a[l],n,s,o);if(i.containsKey(c)){const h=i.peek(c);if(h.getState()===yt.LOADED)return h.endTransition($t(this)),dv(e,h,n),!0}}return!1}findAltTiles_(t,e,i,n){const s=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let u=s.minY;u<=s.maxY;++u){const d=C0(l,c,i,h,u);let g=!1;if(a.containsKey(d)){const f=a.peek(d);f.getState()===yt.LOADED&&(dv(n,f,i),g=!0)}g||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const i=t.layerStatesArray[t.layerIndex],n=t.viewState,s=n.projection,o=n.resolution,a=n.center,l=t.pixelRatio,c=this.getLayer(),h=c.getSource(),u=h.getTileGridForProjection(s),d=u.getZForResolution(o,h.zDirection),g=u.getResolution(d),f=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==f&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=f):this.renderedSourceKey_=f;let p=t.extent;const m=h.getTilePixelRatio(l);this.prepareContainer(t,e);const y=this.context.canvas.width,_=this.context.canvas.height,x=i.extent&&Cs(i.extent);x&&(p=As(p,Cs(i.extent)));const v=g*y/2/m,w=g*_/2/m,b=[a[0]-v,a[1]-w,a[0]+v,a[1]+w],E={};this.renderedTiles.length=0;const C=c.getPreload();if(t.nextExtent&&this.enqueueTilesForNextExtent()){const $=u.getZForResolution(n.nextResolution,h.zDirection),z=n3(t,t.nextExtent);this.enqueueTiles(t,z,$,E,C)}const S=n3(t,p);if(this.enqueueTiles(t,S,d,E,0),C>0&&setTimeout(()=>{this.enqueueTiles(t,S,d-1,E,C-1)},0),!(d in E))return this.container;const R=$t(this),I=t.time;for(const $ of E[d]){const z=$.getState();if(z===yt.EMPTY)continue;const j=$.tileCoord;if(z===yt.LOADED&&$.getAlpha(R,I)===1){$.endTransition(R);continue}if(z!==yt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(j,E)){QJ(E,$,d),t.animate=!0;continue}if(this.findAltTiles_(u,j,d+1,E))continue;const et=u.getMinZoom();for(let q=d-1;q>=et&&!this.findAltTiles_(u,j,q,E);--q);}const F=g/o*l/m,N=this.getRenderContext(t);bo(this.tempTransform,y/2,_/2,F,F,0,-y/2,-_/2),i.extent&&this.clipUnrotated(N,t,x),h.getInterpolate()||(N.imageSmoothingEnabled=!1),this.preRender(N,t);const P=Object.keys(E).map(Number);P.sort(oo);let T;const D=[],A=[];for(let $=P.length-1;$>=0;--$){const z=P[$],j=h.getTilePixelSize(z,l,s),et=u.getResolution(z)/g,q=j[0]*et*F,vt=j[1]*et*F,jt=u.getTileCoordForCoordAndZ(da(b),z),V=u.getTileCoordExtent(jt),It=Qr(this.tempTransform,[m*(V[0]-b[0])/g,m*(b[3]-V[3])/g]),Et=m*h.getGutterForProjection(s);for(const Mt of E[z]){if(Mt.getState()!==yt.LOADED)continue;const Ot=Mt.tileCoord,Y=jt[1]-Ot[1],We=Math.round(It[0]-(Y-1)*q),L=jt[2]-Ot[2],O=Math.round(It[1]-(L-1)*vt),U=Math.round(It[0]-Y*q),X=Math.round(It[1]-L*vt),W=We-U,K=O-X,it=P.length===1;let ot=!1;T=[U,X,U+W,X,U+W,X+K,U,X+K];for(let rt=0,H=D.length;rt<H;++rt)if(!it&&z<A[rt]){const ut=D[rt];wr([U,X,U+W,X+K],[ut[0],ut[3],ut[4],ut[7]])&&(ot||(N.save(),ot=!0),N.beginPath(),N.moveTo(T[0],T[1]),N.lineTo(T[2],T[3]),N.lineTo(T[4],T[5]),N.lineTo(T[6],T[7]),N.moveTo(ut[6],ut[7]),N.lineTo(ut[4],ut[5]),N.lineTo(ut[2],ut[3]),N.lineTo(ut[0],ut[1]),N.clip())}D.push(T),A.push(z),this.drawTile(Mt,t,U,X,W,K,Et,it),ot&&N.restore(),this.renderedTiles.unshift(Mt),this.updateUsedTiles(t.usedTiles,h,Mt)}}if(this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!ra(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=l,this.postRender(this.context,t),i.extent&&N.restore(),N.imageSmoothingEnabled=!0,this.renderComplete){const $=(z,j)=>{const et=$t(h),q=j.wantedTiles[et],vt=q?Object.keys(q).length:0;this.updateCacheSize(vt),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};t.postRenderFunctions.push($)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,i,n,s,o,a,l){let c;if(t instanceof e3){if(c=z2(t.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(t);if(!c)return;const h=this.getRenderContext(e),u=$t(this),d=e.layerStatesArray[e.layerIndex],g=d.opacity*(l?t.getAlpha(u,e.time):1),f=g!==h.globalAlpha;f&&(h.save(),h.globalAlpha=g),h.drawImage(c,a,a,c.width-2*a,c.height-2*a,i,n,s,o),f&&h.restore(),g!==d.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){const n=$t(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}}const sl={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class JJ extends Kc{constructor(t){t=t||{};const e=Object.assign({},t),i=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(sl.PRELOAD)}setPreload(t){this.set(sl.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(sl.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(sl.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}class gy extends JJ{constructor(t){super(t)}createRenderer(){return new vL(this,{cacheSize:this.getCacheSize()})}}const ttt={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},s3={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class ett extends vL{constructor(t,e){super(t,e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=rn(),this.tileClipContexts_=null}enqueueTilesForNextExtent(){return this.getLayer().getRenderMode()!=="vector"}drawTile(t,e,i,n,s,o,a,l){this.updateExecutorGroup_(t,e.pixelRatio,e.viewState.projection),this.tileImageNeedsRender_(t)&&this.renderTileImage_(t,e),super.drawTile(t,e,i,n,s,o,a,l)}getTile(t,e,i,n){const s=this.getOrCreateTile(t,e,i,n);if(!s)return null;const o=n.viewState,a=o.resolution,l=n.viewHints,c=this.getLayer().getSource(),h=c.getTileGridForProjection(o.projection),u=!(l[vr.ANIMATING]||l[vr.INTERACTING]),d=h.getZForResolution(a,c.zDirection)===t;return u&&d?s.wantedResolution=a:s.wantedResolution||(s.wantedResolution=h.getResolution(t)),s}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,i){const n=this.getLayer(),s=n.getRevision(),o=n.getRenderOrder()||null,a=t.wantedResolution,l=t.getReplayState(n);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==s&&l.renderedRenderOrder==o)return;const c=n.getSource(),h=!!n.getDeclutter(),u=c.getTileGrid(),d=c.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),g=c.getSourceTiles(e,i,t),f=$t(n);delete t.hitDetectionImageData[f],t.executorGroups[f]=[],l.dirty=!1;for(let p=0,m=g.length;p<m;++p){const y=g[p];if(y.getState()!=yt.LOADED)continue;const _=c.getProjection(),x=y.tileCoord;let v=u.getTileCoordExtent(x);i&&_&&!Mi(i,_)&&(v=ru(v,_,i,32));const w=As(d,v),b=rs(w,n.getRenderBuffer()*a,this.tempExtent),E=ra(v,w)?null:b,C=new hP(0,w,a,e),S=r2(a,e),R=function(T,D){let A;const $=T.getStyleFunction()||n.getStyleFunction();if($&&(A=$(T,a)),A){const z=this.renderFeature(T,S,A,C,h,D);l.dirty=l.dirty||z}},I=y.getFeatures();o&&o!==l.renderedRenderOrder&&I.sort(o);for(let T=0,D=I.length;T<D;++T){let A=I[T];i&&y.projection&&!Mi(i,y.projection)&&(A=A.clone(),A.getGeometry().applyTransform(yo(y.projection,i))),(!E||wr(E,A.getGeometry().getExtent()))&&R.call(this,A,T)}const F=C.finish(),N=n.getRenderMode()!=="vector"&&h&&g.length===1?null:w,P=new uP(N,a,e,c.getOverlaps(),F,n.getRenderBuffer(),!0);t.executorGroups[f].push(P)}l.renderedRevision=s,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(t,e,i,n,s){const o=e.viewState.resolution,a=e.viewState.rotation;i=i??0;const l=this.getLayer(),c=l.getSource().getTileGridForProjection(e.viewState.projection),h=Ei([t]);rs(h,o*i,h);const u={},d=function(_,x,v){let w=_.getId();w===void 0&&(w=$t(_));const b=u[w];if(b){if(b!==!0&&v<b.distanceSq){if(v===0)return u[w]=!0,s.splice(s.lastIndexOf(b),1),n(_,l,x);b.geometry=x,b.distanceSq=v}}else{if(v===0)return u[w]=!0,n(_,l,x);s.push(u[w]={feature:_,layer:l,geometry:x,distanceSq:v,callback:n})}},g=this.renderedTiles,f=$t(l),p=l.getDeclutter(),m=p?e.declutter?.[p]?.all().map(_=>_.value):null;let y;t:for(let _=0,x=g.length;_<x;++_){const v=g[_],w=c.getTileCoordExtent(v.wrappedTileCoord);if(!wr(w,h))continue;const b=v.executorGroups[f];for(let E=0,C=b.length;E<C;++E)if(y=b[E].forEachFeatureAtCoordinate(t,o,a,i,d,m),y)break t}return y}getFeatures(t){return this.renderedTiles.length===0?Promise.resolve([]):new Promise((e,i)=>{const n=this.getLayer(),s=n.getSource(),o=this.renderedProjection,a=o.getExtent(),l=this.renderedResolution,c=s.getTileGridForProjection(o),h=Qr(this.renderedPixelToCoordinateTransform_,t.slice()),u=c.getTileCoordForCoordAndResolution(h,l).toString(),d=this.renderedTiles.find(x=>x.tileCoord.toString()===u&&x.getState()===yt.LOADED);if(!d||d.loadingSourceTiles>0){e([]);return}s.getWrapX()&&o.canWrapX()&&!eo(a,c.getTileCoordExtent(d.tileCoord))&&ww(h,o);const g=$t(n),f=c.getTileCoordExtent(d.wrappedTileCoord),p=da(f),m=[(h[0]-p[0])/l,(p[1]-h[1])/l],y=d.getSourceTiles().reduce((x,v)=>x.concat(v.getFeatures()),[]);let _=d.hitDetectionImageData[g];if(!_){const x=Ui(c.getTileSize(c.getZForResolution(l,s.zDirection))),v=this.renderedRotation_,w=[this.getRenderTransform(c.getTileCoordCenter(d.wrappedTileCoord),l,0,Fn,x[0]*Fn,x[1]*Fn,0)];_=gP(x,w,y,n.getStyleFunction(),c.getTileCoordExtent(d.wrappedTileCoord),d.getReplayState(n).renderedResolution,v),d.hitDetectionImageData[g]=_}e(fP(m,y,_))})}getFeaturesInExtent(t){const e=[],i=this.getTileCache();if(i.getCount()===0)return e;const n=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),s=n.getZForResolution(this.renderedResolution),o={};return i.forEach(a=>{if(a.tileCoord[0]!==s||a.getState()!==yt.LOADED)return;const l=a.getSourceTiles();for(let c=0,h=l.length;c<h;++c){const u=l[c],d=u.getKey();if(d in o)continue;o[d]=!0;const g=u.tileCoord;if(wr(t,n.getTileCoordExtent(g))){const f=u.getFeatures();if(f)for(let p=0,m=f.length;p<m;++p){const y=f[p],_=y.getGeometry();wr(t,_.getExtent())&&e.push(y)}}}}),e}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.renderedLayerRevision_!==void 0&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t,e){const i=this.context,n=i.globalAlpha;i.globalAlpha=e.opacity;const s=t.viewHints,o=!(s[vr.ANIMATING]||s[vr.INTERACTING]),a=[this.context.canvas.width,this.context.canvas.height],l=this.getLayer().getDeclutter(),c=l?t.declutter?.[l]:void 0,h=$t(this.getLayer()),u=this.renderedTiles;for(let d=0,g=u.length;d<g;++d){const f=u[d],p=f.executorGroups[h];if(p)for(let m=p.length-1;m>=0;--m)p[m].execute(this.context,a,this.getTileRenderTransform(f,t),t.viewState.rotation,o,ym,c)}i.globalAlpha=n}renderDeferredInternal(t){const e=this.renderedTiles,i=$t(this.getLayer()),n=e.reduce((a,l,c)=>(l.executorGroups[i].forEach(h=>a.push({executorGroup:h,index:c})),a),[]),s=n.map(({executorGroup:a})=>a.getDeferredZIndexContexts()),o={};for(let a=0,l=n.length;a<l;++a){const c=n[a].executorGroup.getDeferredZIndexContexts();for(const h in c)o[h]=!0}Object.keys(o).map(Number).sort(oo).forEach(a=>{s.forEach((l,c)=>{l[a]&&(l[a].forEach(h=>{const{executorGroup:u,index:d}=n[c],g=u.getRenderedContext(),f=g.globalAlpha;g.globalAlpha=this.renderedOpacity_;const p=this.tileClipContexts_[d];p&&p.draw(g),h.draw(g),p&&g.restore(),g.globalAlpha=f,h.clear()}),l[a].length=0)})})}getTileRenderTransform(t,e){const i=e.pixelRatio,n=e.viewState,s=n.center,o=n.resolution,a=n.rotation,l=e.size,c=Math.round(l[0]*i),h=Math.round(l[1]*i),u=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),d=t.tileCoord,g=u.getTileCoordExtent(t.wrappedTileCoord),f=u.getTileCoordExtent(d,this.tempExtent)[0]-g[0];return qb(k0(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(s,o,a,i,c,h,f))}postRender(t,e){const i=e.viewHints,n=!(i[vr.ANIMATING]||i[vr.INTERACTING]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation,this.renderedOpacity_=e.layerStatesArray[e.layerIndex].opacity;const s=this.getLayer(),o=s.getRenderMode(),a=t.globalAlpha;t.globalAlpha=this.renderedOpacity_;const l=s.getDeclutter(),c=l?s3[o].filter(v=>!ym.includes(v)):s3[o],h=e.viewState,u=h.rotation,d=s.getSource(),g=d.getTileGridForProjection(h.projection).getZForResolution(h.resolution,d.zDirection),f=this.renderedTiles,p=[],m=[],y=[],_=$t(s);let x=!0;for(let v=f.length-1;v>=0;--v){const w=f[v];x=x&&!w.getReplayState(s).dirty;const b=w.executorGroups[_].filter(N=>N.hasExecutors(c));if(b.length===0)continue;const E=this.getTileRenderTransform(w,e),C=w.tileCoord[0];let S=!1;const R=b[0].getClipCoords(E);let I=t,F;if(R){F=new ok,I=F.getContext();for(let N=0,P=p.length;N<P;++N)if(g!==C&&C<m[N]){const T=p[N];wr([R[0],R[3],R[4],R[7]],[T[0],T[3],T[4],T[7]])&&(S||(I.save(),S=!0),I.beginPath(),I.moveTo(R[0],R[1]),I.lineTo(R[2],R[3]),I.lineTo(R[4],R[5]),I.lineTo(R[6],R[7]),I.moveTo(T[6],T[7]),I.lineTo(T[4],T[5]),I.lineTo(T[2],T[3]),I.lineTo(T[0],T[1]),I.clip())}p.push(R),m.push(C)}for(let N=0,P=b.length;N<P;++N)b[N].execute(t,[t.canvas.width,t.canvas.height],E,u,n,c,e.declutter?.[l]);S&&(I===t?I.restore():y[v]=F)}t.globalAlpha=a,this.ready=x,this.tileClipContexts_=y,e.declutter||this.renderDeferredInternal(e),super.postRender(t,e)}renderFeature(t,e,i,n,s,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,c=i.length;l<c;++l)a=pm(n,t,i[l],e,this.boundHandleStyleImageChange_,void 0,s,o)||a;else a=pm(n,t,i,e,this.boundHandleStyleImageChange_,void 0,s,o);return a}tileImageNeedsRender_(t){const e=this.getLayer();if(e.getRenderMode()==="vector")return!1;const i=t.getReplayState(e),n=e.getRevision(),s=t.wantedResolution;return i.renderedTileResolution!==s||i.renderedTileRevision!==n}renderTileImage_(t,e){const i=this.getLayer(),n=t.getReplayState(i),s=i.getRevision(),o=t.executorGroups[$t(i)];n.renderedTileRevision=s;const a=t.wrappedTileCoord,l=a[0],c=i.getSource();let h=e.pixelRatio;const u=e.viewState.projection,d=c.getTileGridForProjection(u),g=d.getResolution(t.tileCoord[0]),f=e.pixelRatio/t.wantedResolution*g,p=d.getResolution(l),m=t.getContext();h=Math.round(Math.max(h,f/h));const y=c.getTilePixelSize(l,h,u);m.canvas.width=y[0],m.canvas.height=y[1];const _=h/f;if(_!==1){const b=TC(this.tmpTransform_);k0(b,_,_),m.setTransform.apply(m,b)}const x=d.getTileCoordExtent(a,this.tempExtent),v=f/p,w=TC(this.tmpTransform_);k0(w,v,-v),nU(w,-x[0],-x[3]);for(let b=0,E=o.length;b<E;++b)o[b].execute(m,[m.canvas.width*_,m.canvas.height*_],w,0,!0,ttt[i.getRenderMode()],null);n.renderedTileResolution=t.wantedResolution}}class pl extends V1{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload;const i=t.cacheSize===void 0?0:t.cacheSize;delete t.cacheSize,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i;const n=t.renderMode||"hybrid";Re(n=="hybrid"||n=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=n,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new ett(this,{cacheSize:this.cacheSize_})}getFeatures(t){return super.getFeatures(t)}getFeaturesInExtent(t){return this.getRenderer().getFeaturesInExtent(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(sl.PRELOAD)}getUseInterimTilesOnError(){return this.get(sl.USE_INTERIM_TILES_ON_ERROR)}setPreload(t){this.set(sl.PRELOAD,t)}setUseInterimTilesOnError(t){this.set(sl.USE_INTERIM_TILES_ON_ERROR,t)}}function q2(r){return Array.isArray(r)?Math.min(...r):r}class rtt extends j1{constructor(t,e,i,n,s,o,a){let l=t.getExtent();l&&t.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=e.getExtent();c&&e.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const h=c?As(i,c):i,u=Wi(h),d=df(t,e,u,n),g=mL,f=new pL(t,e,h,l,d*g,n),p=f.calculateSourceExtent(),m=Bc(p)?null:o(p,d,s),y=m?St.IDLE:St.EMPTY,_=m?m.getPixelRatio():1;super(i,n,_,y),this.targetProj_=e,this.maxSourceExtent_=l,this.triangulation_=f,this.targetResolution_=n,this.targetExtent_=i,this.sourceImage_=m,this.sourcePixelRatio_=_,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==St.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const t=this.sourceImage_.getState();if(t==St.LOADED){const e=Me(this.targetExtent_)/this.targetResolution_,i=Ar(this.targetExtent_)/this.targetResolution_;this.canvas_=fL(e,i,this.sourcePixelRatio_,q2(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==St.IDLE){this.state=St.LOADING,this.changed();const t=this.sourceImage_.getState();t==St.LOADED||t==St.ERROR?this.reproject_():(this.sourceListenerKey_=Oe(this.sourceImage_,Vt.CHANGE,e=>{const i=this.sourceImage_.getState();(i==St.LOADED||i==St.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){sr(this.sourceListenerKey_),this.sourceListenerKey_=null}}const ol=4,gv={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class itt extends on{constructor(t,e){super(t),this.image=e}}class fy extends Qu{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:t.interpolate!==void 0?t.interpolate:!0}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=t.resolutions!==void 0?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=t.loader?t.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){const e=this.getResolutions();if(e){const i=e1(e,t,0);t=e[i]}return t}getImage(t,e,i,n){const s=this.getProjection();if(!s||!n||Mi(s,n))return s&&(n=s),this.getImageInternal(t,e,i,n);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Mi(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&ra(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new rtt(s,n,t,e,i,(o,a,l)=>this.getImageInternal(o,a,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,i,n){if(this.loader){const s=wL(t,e,i,1),o=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===n&&(this.wantedExtent_&&eo(this.wantedExtent_,s)||eo(this.image.getExtent(),s))&&(this.wantedResolution_&&q2(this.wantedResolution_)===o||q2(this.image.getResolution())===o)))return this.image;this.wantedProjection_=n,this.wantedExtent_=s,this.wantedResolution_=o,this.image=new j1(s,o,i,this.loader),this.image.addEventListener(Vt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){const e=t.target;let i;switch(e.getState()){case St.LOADING:this.loading=!0,i=gv.IMAGELOADSTART;break;case St.LOADED:this.loading=!1,i=gv.IMAGELOADEND;break;case St.ERROR:this.loading=!1,i=gv.IMAGELOADERROR;break;default:return}this.hasListener(i)&&this.dispatchEvent(new itt(i,e))}}function xL(r,t){r.getImage().src=t}function wL(r,t,e,i){const n=t/e,s=Wi(r),o=Za(Me(r)/n,ol),a=Za(Ar(r)/n,ol),l=Za((i-1)*o/2,ol),c=o+2*l,h=Za((i-1)*a/2,ol),u=a+2*h;return kg(s,n,0,[c,u])}const xh=[0,0,0],Oa=5;class py{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,Re(vO(this.resolutions_,(n,s)=>s-n),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let n=0,s=this.resolutions_.length-1;n<s;++n)if(!e)e=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,Re(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=da(i)),Re(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,Re(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:gk,Re(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((n,s)=>{const o=new kk(Math.min(0,n[0]),Math.max(n[0]-1,-1),Math.min(0,n[1]),Math.max(n[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let s=n.minX,o=n.maxX;s<=o;++s)for(let a=n.minY,l=n.maxY;a<=l;++a)i([e,s,a])}forEachTileCoordParentTileRange(t,e,i,n){let s,o,a,l=null,c=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):l=this.getTileCoordExtent(t,n);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=yh(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,c,i),e(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const s=t[1]*2,o=t[2]*2;return yh(s,s+1,o,o+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],s=t[1],o=t[2];if(e===n)return yh(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-n),c=Math.floor(s*l),h=Math.floor(o*l);if(e<n)return yh(c,c,h,h,i);const u=Math.floor(l*(s+1))-1,d=Math.floor(l*(o+1))-1;return yh(c,u,h,d,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,xh);const n=xh[1],s=xh[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,xh);const o=xh[1],a=xh[2];return yh(n,o,s,a,i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Ui(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),s=Ui(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*s[0]*n,a=i[1]-(t[2]+1)*s[1]*n,l=o+s[0]*n,c=a+s[1]*n;return hs(o,a,l,c,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),c=Ui(this.getTileSize(o),this.tmpSize_);let h=a*(t-l[0])/i/c[0],u=a*(l[1]-e)/i/c[1];return n?(h=Za(h,Oa)-1,u=Za(u,Oa)-1):(h=Gh(h,Oa),u=Gh(u,Oa)),$m(o,h,u,s)}getTileCoordForXYAndZ_(t,e,i,n,s){const o=this.getOrigin(i),a=this.getResolution(i),l=Ui(this.getTileSize(i),this.tmpSize_);let c=(t-o[0])/a/l[0],h=(o[1]-e)/a/l[1];return n?(c=Za(c,Oa)-1,h=Za(h,Oa)-1):(c=Gh(c,Oa),h=Gh(h,Oa)),$m(i,c,h,s)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const i=e1(this.resolutions_,t,e||0);return kr(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return qI(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}}function my(r){let t=r.getDefaultTileGrid();return t||(t=ott(r),r.setDefaultTileGrid(t)),t}function ntt(r,t,e){const i=t[0],n=r.getTileCoordCenter(t),s=yy(e);if(!Sc(s,n)){const o=Me(s),a=Math.ceil((s[0]-n[0])/o);return n[0]+=o*a,r.getTileCoordForCoordAndZ(n,i)}return t}function stt(r,t,e,i){i=i!==void 0?i:"top-left";const n=bL(r,t,e);return new py({extent:r,origin:kO(r,i),resolutions:n,tileSize:e})}function yE(r){const t=r||{},e=t.extent||ee("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:bL(e,t.maxZoom,t.tileSize,t.maxResolution)};return new py(i)}function bL(r,t,e,i){t=t!==void 0?t:kP,e=Ui(e!==void 0?e:gk);const n=Ar(r),s=Me(r);i=i>0?i:Math.max(s/e[0],n/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function ott(r,t,e,i){const n=yy(r);return stt(n,t,e,i)}function yy(r){r=ee(r);let t=r.getExtent();if(!t){const e=180*ea.degrees/r.getMetersPerUnit();t=hs(-e,-e,e,e)}return t}class kL extends Qu{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&Ui(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||$t(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,s,o){return te()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:my(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),s=this.getTilePixelRatio(e),o=Ui(n.getTileSize(t),this.tmpSize);return s==1?o:eW(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){const i=e!==void 0?e:this.getProjection(),n=e!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=ntt(n,t,i)),KJ(t,n)?t:null}clear(){}refresh(){this.clear(),super.refresh()}}class att extends on{constructor(t,e){super(t),this.tile=e}}function EL(r){return function(t){const e=t.buffers,i=t.meta,n=t.imageOps,s=t.width,o=t.height,a=e.length,l=e[0].byteLength;if(n){const d=new Array(a);for(let g=0;g<a;++g)d[g]=new ImageData(new Uint8ClampedArray(e[g]),s,o);return r(d,i).data.buffer}const c=new Uint8ClampedArray(l),h=new Array(a),u=new Array(a);for(let d=0;d<a;++d)h[d]=new Uint8ClampedArray(e[d]),u[d]=[0,0,0,0];for(let d=0;d<l;d+=4){for(let f=0;f<a;++f){const p=h[f];u[f][0]=p[d],u[f][1]=p[d+1],u[f][2]=p[d+2],u[f][3]=p[d+3]}const g=r(u,i);c[d]=g[0],c[d+1]=g[1],c[d+2]=g[2],c[d+3]=g[3]}return c.buffer}}function ltt(r,t){const e=Object.keys(r.lib||{}).map(function(n){return"const "+n+" = "+r.lib[n].toString()+";"}).concat(["const __minion__ = ("+EL.toString()+")(",r.operation.toString(),");",'self.addEventListener("message", function(event) {',"  const buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),i=new Worker(typeof Blob>"u"?"data:text/javascript;base64,"+Buffer.from(e.join(`
`),"binary").toString("base64"):URL.createObjectURL(new Blob(e,{type:"text/javascript"})));return i.addEventListener("message",t),i}function ctt(r,t){const e=EL(r.operation);let i=!1;return{postMessage:function(n){setTimeout(function(){i||t({data:{buffer:e(n),meta:n.meta}})},0)},terminate:function(){i=!0}}}class htt extends bf{constructor(t){super(),this.imageOps_=!!t.imageOps;let e;t.threads===0?e=0:this.imageOps_?e=1:e=t.threads||1;const i=new Array(e);if(e)for(let n=0;n<e;++n)i[n]=ltt(t,this.onWorkerMessage_.bind(this,n));else i[0]=ctt(t,this.onWorkerMessage_.bind(this,0));this.workers_=i,this.queue_=[],this.maxQueueLength_=t.queue||1/0,this.running_=0,this.dataLookup_={},this.job_=null}process(t,e,i){this.enqueue_({inputs:t,meta:e,callback:i}),this.dispatch_()}enqueue_(t){for(this.queue_.push(t);this.queue_.length>this.maxQueueLength_;)this.queue_.shift().callback(null,null)}dispatch_(){if(this.running_||this.queue_.length===0)return;const t=this.queue_.shift();this.job_=t;const e=t.inputs[0].width,i=t.inputs[0].height,n=t.inputs.map(function(l){return l.data.buffer}),s=this.workers_.length;if(this.running_=s,s===1){this.workers_[0].postMessage({buffers:n,meta:t.meta,imageOps:this.imageOps_,width:e,height:i},n);return}const o=t.inputs[0].data.length,a=4*Math.ceil(o/4/s);for(let l=0;l<s;++l){const c=l*a,h=[];for(let u=0,d=n.length;u<d;++u)h.push(n[u].slice(c,c+a));this.workers_[l].postMessage({buffers:h,meta:t.meta,imageOps:this.imageOps_,width:e,height:i},h)}}onWorkerMessage_(t,e){this.disposed||(this.dataLookup_[t]=e.data,--this.running_,this.running_===0&&this.resolveJob_())}resolveJob_(){const t=this.job_,e=this.workers_.length;let i,n;if(e===1)i=new Uint8ClampedArray(this.dataLookup_[0].buffer),n=this.dataLookup_[0].meta;else{const s=t.inputs[0].data.length;i=new Uint8ClampedArray(s),n=new Array(e);const o=4*Math.ceil(s/4/e);for(let a=0;a<e;++a){const l=this.dataLookup_[a].buffer,c=a*o;i.set(new Uint8ClampedArray(l),c),n[a]=this.dataLookup_[a].meta}}this.job_=null,this.dataLookup_={},t.callback(null,new ImageData(i,t.inputs[0].width,t.inputs[0].height),n),this.dispatch_()}disposeInternal(){for(let t=0;t<this.workers_.length;++t)this.workers_[t].terminate();this.workers_.length=0}}const o3={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"};class a3 extends on{constructor(t,e,i){super(t),this.extent=e.extent,this.resolution=e.viewState.resolution/e.pixelRatio,this.data=i}}class SL extends fy{constructor(t){super({projection:null}),this.on,this.once,this.un,this.processor_=null,this.operationType_=t.operationType!==void 0?t.operationType:"pixel",this.threads_=t.threads!==void 0?t.threads:1,this.layers_=gtt(t.sources);const e=this.changed.bind(this);for(let i=0,n=this.layers_.length;i<n;++i)this.layers_[i].addEventListener(Vt.CHANGE,e);this.useResolutions_=t.resolutions!==null,this.tileQueue_=new OP(function(){return 1},this.processSources_.bind(this)),this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:rn(),declutter:null,extent:null,index:0,layerIndex:0,layerStatesArray:dtt(this.layers_),pixelRatio:1,pixelToCoordinateTransform:rn(),postRenderFunctions:[],size:[0,0],tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:$t(this),renderTargets:{}},this.setAttributions(function(i){const n=[];for(let s=0,o=t.sources.length;s<o;++s){const a=t.sources[s],l=a instanceof Qu?a:a.getSource();if(!l)continue;const c=l.getAttributions()?.(i);typeof c=="string"?n.push(c):c!==void 0&&n.push(...c)}return n}),t.operation!==void 0&&this.setOperation(t.operation,t.lib)}setOperation(t,e){this.processor_&&this.processor_.dispose(),this.processor_=new htt({operation:t,imageOps:this.operationType_==="image",queue:1,lib:e,threads:this.threads_}),this.changed()}updateFrameState_(t,e,i){const n=Object.assign({},this.frameState_);n.viewState=Object.assign({},n.viewState);const s=Wi(t);n.size[0]=Math.ceil(Me(t)/e),n.size[1]=Math.ceil(Ar(t)/e),n.extent=[s[0]-n.size[0]*e/2,s[1]-n.size[1]*e/2,s[0]+n.size[0]*e/2,s[1]+n.size[1]*e/2],n.time=Date.now();const o=n.viewState;return o.center=s,o.projection=i,o.resolution=e,n}allSourcesReady_(){let t=!0,e;for(let i=0,n=this.layers_.length;i<n;++i)if(e=this.layers_[i].getSource(),!e||e.getState()!=="ready"){t=!1;break}return t}getImage(t,e,i,n){if(!this.allSourcesReady_())return null;this.tileQueue_.loadMoreTiles(16,16),e=this.findNearestResolution(e);const s=this.updateFrameState_(t,e,n);if(this.requestedFrameState_=s,this.renderedImageCanvas_){const o=this.renderedImageCanvas_.getResolution(),a=this.renderedImageCanvas_.getExtent();(e!==o||!ra(s.extent,a))&&(this.renderedImageCanvas_=null)}return(!this.renderedImageCanvas_||this.getRevision()!==this.renderedRevision_)&&this.processSources_(),s.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_}processSources_(){const t=this.requestedFrameState_,e=this.layers_.length,i=new Array(e);for(let s=0;s<e;++s){t.layerIndex=s,t.renderTargets={};const o=utt(this.layers_[s],t);if(o)i[s]=o;else return}const n={};this.dispatchEvent(new a3(o3.BEFOREOPERATIONS,t,n)),this.processor_.process(i,n,this.onWorkerComplete_.bind(this,t))}onWorkerComplete_(t,e,i,n){if(e||!i)return;const s=t.extent,o=t.viewState.resolution;if(o!==this.requestedFrameState_.viewState.resolution||!ra(s,this.requestedFrameState_.extent))return;let a;if(this.renderedImageCanvas_)a=this.renderedImageCanvas_.getImage().getContext("2d");else{const l=Math.round(Me(s)/o),c=Math.round(Ar(s)/o);a=Or(l,c),this.renderedImageCanvas_=new zV(s,o,1,a.canvas)}a.putImageData(i,0,0),t.animate?requestAnimationFrame(this.changed.bind(this)):this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new a3(o3.AFTEROPERATIONS,t,n))}getResolutions(t){if(!this.useResolutions_)return null;let e=super.getResolutions();if(!e)for(let i=0,n=this.layers_.length;i<n&&(e=this.layers_[i].getSource().getResolutions(t),!e);++i);return e}disposeInternal(){this.processor_&&this.processor_.dispose(),super.disposeInternal()}}SL.prototype.dispose;let $l=null;function utt(r,t){const e=r.getRenderer();if(!e)throw new Error("Unsupported layer type: "+r);if(!e.prepareFrame(t))return null;const i=t.size[0],n=t.size[1];if(i===0||n===0)return null;const s=e.renderFrame(t,null);let o;if(s instanceof HTMLCanvasElement)o=s;else{if(s&&(o=s.firstElementChild),!(o instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+o);if(o.width===i&&o.height===n)return o.getContext("2d").getImageData(0,0,i,n)}if(!$l)$l=Or(i,n,void 0,{willReadFrequently:!0});else{const a=$l.canvas;a.width!==i||a.height!==n?$l=Or(i,n,void 0,{willReadFrequently:!0}):$l.clearRect(0,0,i,n)}return $l.drawImage(o,0,0,i,n),$l.getImageData(0,0,i,n)}function dtt(r){return r.map(function(t){return t.getLayerState()})}function gtt(r){const t=r.length,e=new Array(t);for(let i=0;i<t;++i)e[i]=ftt(r[i]);return e}function ftt(r){let t;return r instanceof Qu?r instanceof kL?t=new gy({source:r}):r instanceof fy&&(t=new mE({source:r})):t=r,t}function ptt(r,t,e,i){const n=document.createElement("script"),s="olc_"+$t(t);function o(){delete window[s],n.parentNode.removeChild(n)}n.async=!0,n.src=r+(r.includes("?")?"&":"?")+"callback="+s;const a=setTimeout(function(){o(),e&&e()},1e4);window[s]=function(l){clearTimeout(a),o(),t(l)},document.head.appendChild(n)}function _E(r,t){const e=[];Object.keys(t).forEach(function(n){t[n]!==null&&t[n]!==void 0&&e.push(n+"="+encodeURIComponent(t[n]))});const i=e.join("&");return r=r.replace(/[?&]$/,""),r+=r.includes("?")?"&":"?",r+i}const mtt=/\{z\}/g,ytt=/\{x\}/g,_tt=/\{y\}/g,vtt=/\{-y\}/g;function xtt(r,t,e,i,n){return r.replace(mtt,t.toString()).replace(ytt,e.toString()).replace(_tt,i.toString()).replace(vtt,function(){if(n===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(n-i).toString()})}function wtt(r){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(r);if(e){const i=e[1].charCodeAt(0),n=e[2].charCodeAt(0);let s;for(s=i;s<=n;++s)t.push(r.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(r),e){const i=parseInt(e[2],10);for(let n=parseInt(e[1],10);n<=i;n++)t.push(r.replace(e[0],n.toString()));return t}return t.push(r),t}function btt(r,t){return(function(e,i,n){if(!e)return;let s;const o=e[0];if(t){const a=t.getFullTileRange(o);a&&(s=a.getHeight()-1)}return xtt(r,o,e[1],e[2],s)})}function vE(r,t){const e=r.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=btt(r[n],t);return ktt(i)}function ktt(r){return r.length===1?r[0]:(function(t,e,i){if(!t)return;const n=_L(t),s=cl(n,r.length);return r[s](t,e,i)})}const fv={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class _y extends kL{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===_y.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=$t(e),n=e.getState();let s;n==yt.LOADING?(this.tileLoadingKeys_[i]=!0,s=fv.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=n==yt.ERROR?fv.TILELOADERROR:n==yt.LOADED?fv.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new att(s,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=wtt(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(vE(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}}class xE extends _y{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Ett,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:LP,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!Mi(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Mi(e,t)))return this.tileGrid;const i=$t(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=my(t)),this.tileGridForProjection[i]}createTile_(t,e,i,n,s,o){const a=[t,e,i],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,n,s):void 0,h=new this.tileClass(a,c!==void 0?yt.IDLE:yt.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=o,h.addEventListener(Vt.CHANGE,this.handleTileChange.bind(this)),h}getTile(t,e,i,n,s,o){const a=this.getProjection();if(!a||!s||Mi(a,s))return this.getTileInternal(t,e,i,n,a||s);const l=[t,e,i],c=this.getKey(),h=this.getTileGridForProjection(a),u=this.getTileGridForProjection(s),d=this.getTileCoordForTileUrlFunction(l,s),g=new yL(a,h,s,u,l,d,this.getTilePixelRatio(n),this.getGutter(),(f,p,m,y)=>this.getTileInternal(f,p,m,y,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=c,g}getTileInternal(t,e,i,n,s,o){const a=this.getKey(),l=C0(this,a,t,e,i);if(o&&o.containsKey(l))return o.get(l);const c=this.createTile_(t,e,i,n,s,a);return o?.set(l,c),c}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){const i=ee(t);if(i){const n=$t(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}}}function Ett(r,t){if(Hn){const e=r.getCrossOrigin();let i="same-origin",n="same-origin";e==="anonymous"||e===""?(i="cors",n="omit"):e==="use-credentials"&&(i="cors",n="include"),fetch(t,{mode:i,credentials:n}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=r.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{r.getImage().dispatchEvent(new Event("error"))});return}r.getImage().src=t}class TL extends xE{constructor(t){if(super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:ee("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.tileJSON_=null,this.tileSize_=t.tileSize,t.url)if(t.jsonp)ptt(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else if(t.tileJSON)this.handleTileJSONResponse(t.tileJSON);else throw new Error("Either `url` or `tileJSON` options must be provided")}onXHRLoad_(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let i;try{i=JSON.parse(e.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(i)}else this.handleTileJSONError()}onXHRError_(t){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(t){const e=ee("EPSG:4326"),i=this.getProjection();let n;if(t.bounds!==void 0){const c=Tf(e,i);n=DM(t.bounds,c)}const s=yy(i),o=t.minzoom||0,a=t.maxzoom||22,l=yE({extent:s,maxZoom:a,minZoom:o,tileSize:this.tileSize_});if(this.tileGrid=l,this.tileUrlFunction=vE(t.tiles,l),t.attribution&&!this.getAttributions()){const c=n!==void 0?n:s;this.setAttributions(function(h){return wr(c,h.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState("ready")}handleTileJSONError(){this.setState("error")}}class wE extends _y{constructor(t){const e=t.projection||"EPSG:3857",i=t.extent||yy(e),n=t.tileGrid||yE({extent:i,maxResolution:t.maxResolution,maxZoom:t.maxZoom!==void 0?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,interpolate:!0,projection:e,state:t.state,tileGrid:n,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:CL,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX===void 0?!0:t.wrapX,transition:t.transition,zDirection:t.zDirection===void 0?1:t.zDirection}),this.format_=t.format?t.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=t.overlaps==null?!0:t.overlaps,this.tileClass=t.tileClass?t.tileClass:aR,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(t,e,i){if(i.getState()===yt.IDLE){i.setState(yt.LOADING);const n=i.wrappedTileCoord,s=this.getTileGridForProjection(e);let o=s.getTileCoordExtent(n);const a=n[0],l=s.getResolution(a);rs(o,-l,o);const c=this.projection;e&&this.projection&&!Mi(e,c)&&(o=ru(o,e,c));const h=this.tileGrid,u=h.getExtent();u&&As(o,u,o);let d=l;e&&c&&!Mi(e,c)&&(d=l/c.getMetersPerUnit()/e.getMetersPerUnit());const g=h.getZForResolution(d,this.zDirection);h.forEachTileCoord(o,g,f=>{const p=this.tileUrlFunction(f,t,e);this.sourceTiles_[p]||(this.sourceTiles_[p]=new this.tileClass(f,p?yt.IDLE:yt.EMPTY,p,this.format_,this.tileLoadFunction));const m=this.sourceTiles_[p];i.sourceTiles.push(m),this.tileKeysBySourceTileUrl_[p]||(this.tileKeysBySourceTileUrl_[p]=[]),this.tileKeysBySourceTileUrl_[p].push(i.getKey());const y=m.getState();if(y<yt.LOADED){const _=x=>{this.handleTileChange(x);const v=m.getState();if(v===yt.LOADED||v===yt.ERROR){const w=m.getKey();w in i.errorTileKeys?m.getState()===yt.LOADED&&delete i.errorTileKeys[w]:i.loadingSourceTiles--,v===yt.ERROR?i.errorTileKeys[w]=!0:m.removeEventListener(Vt.CHANGE,_),i.loadingSourceTiles===0&&i.setState(yl(i.errorTileKeys)?yt.LOADED:yt.ERROR)}};m.addEventListener(Vt.CHANGE,_),i.loadingSourceTiles++}y===yt.IDLE&&(m.extent=h.getTileCoordExtent(f),m.projection=this.projection,m.resolution=h.getResolution(f[0]),m.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(f=>f.getState()===yt.ERROR)?yt.ERROR:yt.LOADED)}return i.sourceTiles}removeSourceTiles(t){const e=t.getKey(),i=t.sourceTiles;for(let n=0,s=i.length;n<s;++n){const o=i[n].getTileUrl();if(!this.tileKeysBySourceTileUrl_[o])return;const a=this.tileKeysBySourceTileUrl_[o].indexOf(e);a!==-1&&(this.tileKeysBySourceTileUrl_[o].splice(a,1),this.tileKeysBySourceTileUrl_[o].length===0&&(delete this.tileKeysBySourceTileUrl_[o],delete this.sourceTiles_[o]))}}getTile(t,e,i,n,s){const o=[t,e,i];let a=this.getTileCoordForTileUrlFunction(o,s);const l=this.getTileGrid().getExtent(),c=this.projection,h=this.getTileGridForProjection(s);if(a&&l){const g=h.getTileCoordExtent(a);rs(g,-h.getResolution(t),g),wr(l,!s||!c||Mi(s,c)?g:ru(g,s,c))||(a=null)}let u=!0;if(a!==null){const g=this.tileGrid,f=h.getResolution(t);let p=f;s&&c&&!Mi(s,c)&&(p=f/c.getMetersPerUnit()/s.getMetersPerUnit());const m=g.getZForResolution(p,1),y=h.getTileCoordExtent(a);rs(y,-f,y),g.forEachTileCoord(!s||!c||Mi(s,c)?y:ru(y,s,c),m,_=>{u=u&&!this.tileUrlFunction(_,n,c)})}const d=new hZ(o,u?yt.EMPTY:yt.IDLE,a,this.getSourceTiles.bind(this,n,s),this.removeSourceTiles.bind(this));return d.key=this.getKey(),d}getTileGridForProjection(t){const e=t.getCode();let i=this.tileGrids_[e];if(!i){const n=this.projection;if(n!==null&&!Mi(n,t))return my(t);const s=this.tileGrid,o=s.getResolutions().slice(),a=o.map(function(h,u){return s.getOrigin(u)}),l=o.map(function(h,u){return s.getTileSize(u)}),c=kP+1;for(let h=o.length;h<c;++h)o.push(o[h-1]/2),a.push(a[h-1]),l.push(l[h-1]);i=new py({extent:s.getExtent(),origins:a,resolutions:o,tileSizes:l}),this.tileGrids_[e]=i}return i}getTilePixelRatio(t){return t}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),s=Ui(n.getTileSize(t),this.tmpSize);return[Math.round(s[0]*e),Math.round(s[1]*e)]}setOverlaps(t){this.overlaps_=t,this.changed()}}function CL(r,t){r.setLoader(function(e,i,n){rP(t,r.getFormat(),e,i,n,r.onLoad.bind(r),r.onError.bind(r))})}function Stt(r,t){const e=r[0],i=e.width,n=e.height,s=e.data,o=new Uint8ClampedArray(s.length),a=t.resolution*2,l=i-1,c=n-1,h=[0,0,0,0],u=2*Math.PI,d=Math.PI/2,g=Math.PI*t.sunEl/180,f=Math.PI*t.sunAz/180,p=Math.cos(g),m=Math.sin(g),y=t.highlightColor,_=t.shadowColor,x=t.accentColor,v=t.encoding;let w,b,E,C,S,R,I,F,N,P,T,D,A,$,z,j,et,q,vt,jt,V,It;function Et(Mt,Ot="mapbox"){if(Ot==="mapbox")return(Mt[0]*256*256+Mt[1]*256+Mt[2])*.1-1e4;if(Ot==="terrarium")return Mt[0]*256+Mt[1]+Mt[2]/256-32768}for(b=0;b<=c;++b)for(S=b===0?0:b-1,R=b===c?c:b+1,w=0;w<=l;++w)E=w===0?0:w-1,C=w===l?l:w+1,I=(b*i+E)*4,h[0]=s[I],h[1]=s[I+1],h[2]=s[I+2],h[3]=s[I+3],F=t.vert*Et(h,v),I=(b*i+C)*4,h[0]=s[I],h[1]=s[I+1],h[2]=s[I+2],h[3]=s[I+3],N=t.vert*Et(h,v),P=(N-F)/a,I=(S*i+w)*4,h[0]=s[I],h[1]=s[I+1],h[2]=s[I+2],h[3]=s[I+3],F=t.vert*Et(h,v),I=(R*i+w)*4,h[0]=s[I],h[1]=s[I+1],h[2]=s[I+2],h[3]=s[I+3],N=t.vert*Et(h,v),T=(N-F)/a,A=Math.atan2(T,-P),A<0?A=d-A:A>d?A=u-A+d:A=d-A,D=Math.atan(Math.sqrt(P*P+T*T)),It=m*Math.cos(D)+p*Math.sin(D)*Math.cos(f-A),$=Math.cos(D),z=255*It,vt=Math.min(Math.max(2*t.sunEl,0),1),jt=1.875-t.opacity*1.75,V=t.opacity!==.5?d*((Math.pow(jt,D)-1)/(Math.pow(jt,d)-1)):D,et={r:(1-$)*x.r*vt*255,g:(1-$)*x.g*vt*255,b:(1-$)*x.b*vt*255,a:(1-$)*x.a*vt*255},j=Math.abs(((A+f)/Math.PI+.5)%2-1),q={r:(y.r*(1-j)+_.r*j)*z,g:(y.g*(1-j)+_.g*j)*z,b:(y.b*(1-j)+_.b*j)*z,a:(y.a*(1-j)+_.a*j)*z},I=(b*i+w)*4,o[I]=et.r*(1-j)+q.r,o[I+1]=et.g*(1-j)+q.g,o[I+2]=et.b*(1-j)+q.b,o[I+3]=s[I+3]*t.opacity*vt*Math.sin(V);return new ImageData(o,i,n)}function Ttt(r,t=512){return r.getExtent()?yE({extent:r.getExtent(),tileSize:t,maxZoom:22}).getResolutions():ho}function ML(r,t){return t.accessToken||(t=Object.assign({},t),new URL(r).searchParams.forEach((e,i)=>{t.accessToken=e,t.accessTokenParam=i})),t}function Ctt(r,t,e="",i={},n=void 0){let s,o,a,l,c=!0;return typeof e!="string"&&!Array.isArray(e)?(a=e,l=a.source||a.layers,i=a):l=e,typeof i=="string"?(s=i,a={}):(s=i.styleUrl,a=i),a.updateSource===!1&&(c=!1),n||(n=a.resolutions),!s&&typeof t=="string"&&!t.trim().startsWith("{")&&(s=t),s&&(s=s.startsWith("data:")?location.href:em(s,a.accessToken),a=ML(s,a)),new Promise(function(h,u){tI(t,a).then(function(d){if(d.version!=8)return u(new Error("glStyle version 8 required."));if(!(r instanceof fs||r instanceof pl))return u(new Error("Can only apply to VectorLayer or VectorTileLayer"));const g=r instanceof pl?"vector":"geojson";if(l?Array.isArray(l)?o=d.layers.find(function(v){return v.id===l[0]}).source:o=l:(o=Object.keys(d.sources).find(function(v){return d.sources[v].type===g}),l=o),!o)return u(new Error(`No ${g} source found in the glStyle.`));function f(){if(!c)return Promise.resolve();if(r instanceof pl)return PL(d.sources[o],s,a).then(function(E){const C=r.getSource();C?E!==C&&(C.setTileUrlFunction(E.getTileUrlFunction()),typeof C.setUrls=="function"&&typeof E.getUrls=="function"&&C.setUrls(E.getUrls()),C.format_||(C.format_=E.format_),C.getAttributions()||C.setAttributions(E.getAttributions()),C.getTileLoadFunction()===CL&&C.setTileLoadFunction(E.getTileLoadFunction()),Mi(C.getProjection(),E.getProjection())&&(C.tileGrid=E.getTileGrid())):r.setSource(E);const S=r.getSource().getTileGrid();!isFinite(r.getMaxResolution())&&!isFinite(r.getMinZoom())&&S.getMinZoom()>0&&r.setMaxResolution(Dd(Math.max(0,S.getMinZoom()-1e-12),S.getResolutions()))});const v=d.sources[o];let w=r.getSource();(!w||w.get("mapbox-source")!==v)&&(w=OL(v,s,a));const b=r.getSource();return b?w!==b&&(b.getAttributions()||b.setAttributions(w.getAttributions()),b.format_||(b.format_=w.getFormat()),b.url_=w.getUrl()):r.setSource(w),Promise.resolve()}let p,m,y,_;function x(){if(!_&&(!d.sprite||m)){if(a.projection&&!n){const v=ee(a.projection).getUnits();v!=="m"&&(n=ho.map(w=>w/ea[v]))}_=dL(r,d,l,n,m,y,(v,w=a.webfonts)=>ZG(v,w),a.getImage),r.getStyle()?f().then(h).catch(u):u(new Error(`Nothing to show for source [${o}]`))}else _?(r.setStyle(_),f().then(h).catch(u)):u(new Error("Something went wrong trying to apply style."))}if(d.sprite){const v=new URL(DG(d.sprite,a.accessToken,s||location.href));p=window.devicePixelRatio>=1.5?.5:1;const w=p==.5?"@2x":"";let b=v.origin+v.pathname+w+".json"+v.search;new Promise(function(E,C){Lu("Sprite",b,a).then(E).catch(function(S){b=v.origin+v.pathname+".json"+v.search,Lu("Sprite",b,a).then(E).catch(C)})}).then(function(E){if(E===void 0&&u(new Error("No sprites found.")),m=E,y=v.origin+v.pathname+w+".png"+v.search,a.transformRequest){const C=a.transformRequest(y,"SpriteImage")||y;(C instanceof Request||C instanceof Promise)&&(y=C)}x()}).catch(function(E){u(new Error(`Sprites cannot be loaded: ${b}: ${E.message}`))})}else x()}).catch(u)})}const Va={};function RL(r,t){let e;return r.some(function(i){if(i.id==t)return e=i.source,!0}),e}function Mtt(r,t){const e=r.bounds;if(e){const i=Xv([e[0],e[1]],t),n=Xv([e[2],e[3]],t);return[i[0],i[1],n[0],n[1]]}return ee(t).getExtent()}function IL(r,t,e){const i=new TL({tileJSON:t,tileSize:r.tileSize||t.tileSize||512}),n=i.getTileJSON(),s=i.getTileGrid(),o=ee(e.projection||"EPSG:3857"),a=Mtt(n,o),l=o.getExtent(),c=n.minzoom||0,h=n.maxzoom||22,u={attributions:i.getAttributions(),projection:o,tileGrid:new py({origin:l?da(l):s.getOrigin(0),extent:a||s.getExtent(),minZoom:c,resolutions:Ttt(o,t.tileSize).slice(0,h+1),tileSize:s.getTileSize(0)})};return Array.isArray(n.tiles)?u.urls=n.tiles:u.url=n.tiles,u}function Rtt(r,t,e,i){const n={id:r.id,type:r.type},s=r.layout||{},o=r.paint||{};n.paint=o;const a=Pb(t,e.resolutions||ho);let l;const c=Ft(n,"paint","background-color",a,Va,i);return o["background-opacity"]!==void 0&&(l=Ft(n,"paint","background-opacity",a,Va,i)),s.visibility=="none"?void 0:Ga(c,l)}function Itt(r,t,e){const i=document.createElement("div");return i.className="ol-mapbox-style-background",i.style.position="absolute",i.style.width="100%",i.style.height="100%",new Kc({source:new Qu({}),render(n){const s=Rtt(r,n.viewState.resolution,t,e);return i.style.backgroundColor=s,i}})}function PL(r,t,e){return new Promise(function(i,n){eI(r,t,e).then(function({tileJson:s,tileLoadFunction:o}){const a=IL(r,s,e);a.tileLoadFunction=o,a.format=new gL,i(new wE(a))}).catch(n)})}function Ptt(r,t,e){const i=new pl({declutter:!0,visible:!1});return PL(r,t,e).then(function(n){n.set("mapbox-source",r),i.setSource(n)}).catch(function(n){i.setSource(void 0)}),i}function AL(r){return`{bbox-${(r?r.getCode():"EPSG:3857").toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}function Att(r,t,e){return new Promise(function(i,n){eI(r,t,e).then(function({tileJson:s,tileLoadFunction:o}){const a=new TL({interpolate:e.interpolate===void 0?!0:e.interpolate,transition:0,crossOrigin:"anonymous",tileJSON:s});a.tileGrid=IL(r,s,e).tileGrid,e.projection&&(a.projection=ee(e.projection));const l=a.getTileUrlFunction();o&&a.setTileLoadFunction(o),a.setTileUrlFunction(function(c,h,u){const d=AL(u);let g=l(c,h,u);if(g.indexOf(d)!=-1){const f=a.getTileGrid().getTileCoordExtent(c);g=g.replace(d,f.toString())}return g}),a.set("mapbox-source",r),i(a)}).catch(function(s){n(s)})})}function LL(r,t,e){const i=new gy;return Att(r,t,e).then(function(n){i.setSource(n)}).catch(function(){i.setSource(void 0)}),i}function Ltt(r,t,e){const i=LL(r,t,e);return new mE({source:new SL({operationType:"image",operation:Stt,sources:[i]})})}function OL(r,t,e){const i=e.projection?new u2({dataProjection:e.projection}):new u2,n=r.data,s={};if(typeof n=="string"){const[a]=_0(n,e.accessToken,e.accessTokenParam||"access_token",t||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(a)){const c=(u,d,g)=>{const f=AL(g);return a.replace(f,`${u.join(",")}`)},h=new ls({attributions:r.attribution,format:i,loader:(u,d,g,f,p)=>{const m=typeof c=="function"?c(u,d,g):c;Lu("GeoJSON",m,e).then(y=>{const _=h.getFormat().readFeatures(y,{featureProjection:g});h.addFeatures(_),f(_)}).catch(y=>{h.removeLoadedExtent(u),p()})},strategy:tW});return h.set("mapbox-source",r),h}const l=new ls({attributions:r.attribution,format:i,url:a,loader:(c,h,u,d,g)=>{Lu("GeoJSON",a,e).then(f=>{const p=l.getFormat().readFeatures(f,{featureProjection:u});l.addFeatures(p),d(p)}).catch(f=>{l.removeLoadedExtent(c),g()})}});return l}s.features=i.readFeatures(n,{featureProjection:"EPSG:3857"});const o=new ls(Object.assign({attributions:r.attribution,format:i},s));return o.set("mapbox-source",r),o}function Ott(r,t,e){return new fs({declutter:!0,source:OL(r,t,e),visible:!1})}function Ftt(r,t,e){let i=null;return function(n){r.paint&&"raster-opacity"in r.paint&&n.frameState.viewState.zoom!==i&&(i=n.frameState.viewState.zoom,delete e[r.id],Ntt(r,t,i,e))}}function Ntt(r,t,e,i){const n=Ft(r,"paint","raster-opacity",e,Va,i);t.setOpacity(n)}function Dtt(r,t){function e(){const i=t.get("mapbox-style");if(!i)return;const n=qA(i.layers),s=r.get("mapbox-layers"),o=n.filter(function(a){return s.includes(a.id)}).some(function(a){return!a.layout||!a.layout.visibility||a.layout.visibility==="visible"});r.get("visible")!==o&&r.setVisible(o)}r.on("change",e),e()}function $tt(r,t,e,i){const n=J4(r),s=r.layers,o=e.type,a=e.source||RL(s,e.ref),l=r.sources[a];let c;if(o=="background")c=Itt(e,i,n);else if(l.type=="vector")c=Ptt(l,t,i);else if(l.type=="raster")c=LL(l,t,i),c.setVisible(e.layout?e.layout.visibility!=="none":!0),c.on("prerender",Ftt(e,c,n));else if(l.type=="geojson")c=Ott(l,t,i);else if(l.type=="raster-dem"&&e.type=="hillshade"){const u=Ltt(l,t,i);c=u,u.getSource().on("beforeoperations",function(d){const g=d.data;g.resolution=Yv(i.projection||"EPSG:3857",d.resolution,Wi(d.extent),"m");const f=Pb(d.resolution,i.resolutions||ho);g.encoding=l.encoding,g.vert=5*Ft(e,"paint","hillshade-exaggeration",f,Va,n),g.sunAz=Ft(e,"paint","hillshade-illumination-direction",f,Va,n),g.sunEl=35,g.opacity=.3,g.highlightColor=Ft(e,"paint","hillshade-highlight-color",f,Va,n),g.shadowColor=Ft(e,"paint","hillshade-shadow-color",f,Va,n),g.accentColor=Ft(e,"paint","hillshade-accent-color",f,Va,n)}),c.setVisible(e.layout?e.layout.visibility!=="none":!0)}const h=a;return c&&c.set("mapbox-source",h),c}function l3(r,t,e,i){const n=[];let s=null;if(t instanceof rf){if(s=t.getView(),!s.isDef()&&!s.getRotation()&&!s.getResolutions()){const u=i.projection?ee(i.projection):s.getProjection();s=new Qs(Object.assign(s.getProperties(),{maxResolution:ho[0]/ea[u.getUnits()],projection:i.projection||s.getProjection()})),t.setView(s)}"center"in r&&!s.getCenter()&&s.setCenter(Xv(r.center,s.getProjection())),"zoom"in r&&s.getZoom()===void 0&&s.setResolution(ho[0]/ea[s.getProjection().getUnits()]/Math.pow(2,r.zoom)),(!s.getCenter()||s.getZoom()===void 0)&&s.fit(s.getProjection().getExtent(),{nearest:!0,size:t.getSize()})}t.set("mapbox-style",r),t.set("mapbox-metadata",{styleUrl:e,options:i});const o=r.layers;let a=[],l,c,h;for(let u=0,d=o.length;u<d;++u){const g=o[u],f=g.type;if(f=="heatmap"){console.debug(`layers[${u}].type "${f}" not supported`);continue}else h=g.source||RL(o,g.ref),(!h||h!=c)&&(a.length&&(n.push(c3(l,a,r,e,t,i)),a=[]),l=$tt(r,e,g,i),l instanceof fs||l instanceof pl||(a=[]),c=l.get("mapbox-source")),a.push(g.id)}return n.push(c3(l,a,r,e,t,i)),Promise.all(n)}function Gtt(r,t,e={}){let i,n;if(typeof r=="string"||r instanceof HTMLElement?n=new rf({target:r}):n=r,typeof t=="string"){const s=t.startsWith("data:")?location.href:em(t,e.accessToken);e=ML(s,e),i=new Promise(function(o,a){tI(t,e).then(function(l){l3(l,n,s,e).then(function(){o(n)}).catch(a)}).catch(function(l){a(new Error(`Could not load ${t}: ${l.message}`))})})}else i=new Promise(function(s,o){l3(t,n,!e.styleUrl||e.styleUrl.startsWith("data:")?location.href:em(e.styleUrl,e.accessToken),e).then(function(){s(n)}).catch(o)});return i}function c3(r,t,e,i,n,s={}){let o=24,a=0;const l=e.layers;for(let c=0,h=l.length;c<h;++c){const u=l[c];t.indexOf(u.id)!==-1&&(o=Math.min("minzoom"in u?u.minzoom:0,o),a=Math.max("maxzoom"in u?u.maxzoom:24,a))}return new Promise(function(c,h){const u=function(){const g=r.getSource();if(!g||g.getState()==="error"){h(new Error("Error accessing data for source "+r.get("mapbox-source")));return}if("getTileGrid"in g){const f=g.getTileGrid();if(f){const p=f.getMinZoom();(o>0||p>0)&&r.setMaxResolution(Math.min(Dd(Math.max(0,o-1e-12),ho),Dd(Math.max(0,p-1e-12),f.getResolutions()))),a<24&&r.setMinResolution(Dd(a,ho))}}else o>0&&r.setMaxResolution(Dd(Math.max(0,o-1e-12),ho));g instanceof ls||g instanceof wE?Ctt(r,e,t,Object.assign({styleUrl:i},s)).then(function(){Dtt(r,n),c()}).catch(h):c()};r.set("mapbox-layers",t);const d=n.getLayers();d.getArray().indexOf(r)===-1&&d.push(r),r.getSource()?u():r.once("change:source",u)})}const jtt="EPSG:3857";function FL(r={}){const t=r.epsg?r.epsg:Vi.epsg,e=r.extent?r.extent:Z1(t),i=r.tileSize?r.tileSize:512,n=r.resolutions?r.resolutions:Vi.options.map(o=>o.resolution),s={extent:e,resolutions:n,minZoom:r.minZoom,tileSize:new Array(2).fill(i)};return r.origins?s.origins=r.origins:s.origin=r.origin?r.origin:[s.extent[0],s.extent[3]],new id(s)}function ztt(r={}){const t=[r.extent,r.tileSize,r.resolutions,r.origin,r.origins,r.minZoom],e=r.epsg?r.epsg.toUpperCase():r.epsg;return!t.every(i=>typeof i>"u")||e!==jtt}function B2(r,t={}){t.epsg=t.epsg?t.epsg:Vi.epsg;const e={projection:t.epsg,format:new DX,url:r,tileSize:t.tileSize,zDirection:t.zDirection,minZoom:t.minZoom,maxZoom:t.maxZoom};return ztt(t)&&(e.tileGrid=FL(t)),new gK(e)}function qtt(r={},{layerParams:t={},options:e={}}={}){if([r.id,r.name,r.url].some(s=>typeof s>"u")){console.error(`Cancelled creation of layer "${r.id}"(${r.name}) because of missing required parameters`);return}let i,n;return t.renderer==="webgl"?(n=B2(r.url,{...r,renderer:t.renderer,styleId:t.styleId,excludeTypesFromParsing:t.excludeTypesFromParsing}),i=L1({extent:n.getTileGrid().getExtent(),...r,...t,source:n}),i):(n=B2(r.url,r),i=new Z4(Object.assign({id:r.id,name:r.name,attribution:r.olAttribution,extent:n.getTileGrid().getExtent(),minZoom:r.minZoom,maxZoom:r.maxZoom,source:n,declutter:!0},t)),e.style&&r.renderer!=="webgl"&&i.setStyle(e.style),i)}function Btt(r,t,{options:e={}}={},i){Object.keys(t.sources).forEach(n=>{const s=n;if(t.sources[n].type!=="vector"&&t.sources[n].type!=="geojson"){const o=r.get("map");Gtt(o,i)}else dL(r,t,e.sourceId?e.sourceId:s,e.resolutions,e.spriteData,e.spriteImageUrl,e.getFonts)})}const Utt=Object.freeze(Object.defineProperty({__proto__:null,createLayer:qtt,createLayerSource:B2,createTileGrid:FL,setStyle:Btt},Symbol.toStringTag,{value:"Module"}));function Wtt(r,t,e,i){return r.ok?r:t(`Request to wfs-filter failed. Response status is ${r.statusText}`,e,i)}function Vtt(r){if(typeof r!="object"||r===null||!Array.isArray(r.links))return!1;for(let t=0;t<r.links.length;t++)if(typeof r.links[t]=="object"&&r.links[t]!==null&&typeof r.links[t].href=="string"&&r.links[t].rel==="next"&&r.links[t].type==="application/geo+json")return r.links[t].href;return!1}function NL(r,t,{onErrorFn:e,success:i,failure:n},s,o=[]){fetch(r,{headers:{Accept:"application/geo+json"},method:"GET"}).then(a=>Wtt(a,e,s,n)).then(a=>a.json()).then(a=>{const l=Vtt(a);if(a.features.forEach(c=>o.push(c)),typeof l=="string"){NL(l,t,{onErrorFn:cu,success:i,failure:n},s,o);return}a.features=o,a.numberReturned=a.numberMatched,Q1(t,t.getFormat().readFeatures(a),e,i,n,s)}).catch(a=>{e(a,s,n)})}function bE(r,t){const e=t?.bbox||r.bbox,i=r.url;let n=typeof e=="string"&&e.length?e:null,s=null;return s=new URL(i),typeof r.collection=="string"&&(s.pathname.endsWith("/")?s.pathname+="collections/"+r.collection+"/items":s.pathname+="/collections/"+r.collection+"/items"),typeof r.limit=="number"&&s.searchParams.set("limit",r.limit),Array.isArray(e)&&e.length===4&&(n=e.join(",")),n&&(s.searchParams.set("bbox",e),typeof r.bboxCrs=="string"&&r.bboxCrs!==""&&s.searchParams.set("bbox-crs",r.bboxCrs)),typeof r.crs=="string"&&s.searchParams.set("crs",r.crs),typeof r.datetime=="string"&&r.datetime!==""&&s.searchParams.set("datetime",r.datetime),typeof r.params=="object"&&Object.keys(r.params).length&&Object.entries(r.params).forEach(([o,a])=>{s.searchParams.set(o,a)}),s}function Ztt(r,t){const e=new CA;let i=null;function n(s,o,a,l,c){if(t.doNotLoadInitially){Q1(i,[],cu,l,c,t);return}const h=t.loadingStrategy===cg?s:t.loadingParams.bbox,u=bE(r,{...t.loadingParams,bbox:h});NL(u,i,{onErrorFn:cu,success:l,failure:c},t)}return i=jk(n,t.loadingStrategy,e),t.beforeLoading&&i.once("featuresloadstart",()=>t.beforeLoading()),r.clusterDistance?zk(i,r.clusterDistance,t.clusterGeometryFunction):i}function U2(r,t={}){t.loadingStrategy||(t.loadingStrategy=cg);const e=Ztt(r,t);return r.renderer==="webgl"&&e.once("featuresloadend",i=>{Au(i?.features,r.styleId,r.excludeTypesFromParsing,r.isPointLayer)}),e}function Htt(r={},{layerParams:t={},options:e={}}={}){let i,n;return t.renderer==="webgl"?(n=U2({...r,renderer:t.renderer,styleId:t.styleId,excludeTypesFromParsing:t.excludeTypesFromParsing,isPointLayer:t.isPointLayer},e),i=L1({...r,...t,source:n}),i):(n=U2(r,e),i=new Tk(Object.assign({source:n,id:r.id},t)),e.style?i.setStyle(e.style):r.style&&i.setStyle(r.style),i)}function Ytt(r,t){const e=bE(r,r.version);fetch(e,t).then(i=>i.text()).then(i=>{t.addFeatures(t.getFormat().readFeatures(i))}).catch(i=>{console.error(i)})}const Xtt={createLayer:Htt,createLayerSource:U2,createUrl:bE,loadFeaturesManually:Ytt};function Ktt(r={},t=Vi){const e={startZoomLevel:void 0,startResolution:void 0};return Object.prototype.hasOwnProperty.call(r,"startZoomLevel")&&!Object.prototype.hasOwnProperty.call(r,"startResolution")?e.startZoomLevel=t.startZoomLevel:e.startResolution=t.startResolution,e}function Qtt(r){const t=Object.assign({},Vi,r),e=Ktt(r,t);return new Ks({projection:t.epsg,center:t.startCenter,extent:t.extent,zoom:e.startZoomLevel,options:t.options,resolution:e.startResolution,resolutions:t.options.map(i=>i.resolution),constrainResolution:!0,constrainOnlyCenter:!0,backgroundImage:t.backgroundImage})}function DL(r){const t=Object.keys(r.defs),e=t.length;let i,n;for(i=0;i<e;++i){const s=t[i];if(!d0(s)){const o=r.defs(s);let a=o.units;!a&&o.projName==="longlat"&&(a="degrees"),Lg(new Af({code:s,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:a}))}}for(i=0;i<e;++i){const s=t[i],o=d0(s);for(n=0;n<e;++n){const a=t[n],l=d0(a);if(!g0(s,a))if(r.defs[s]===r.defs[a])sx([o,l]);else{const c=r(s,a);yN(o,l,XS(o,l,c.forward),XS(l,o,c.inverse))}}}}function Jtt(r){const t=r.split(":")[1];as.defs("http://www.opengis.net/gml/srs/epsg.xml#"+t,as.defs(r)),DL(as)}function kE(r){return as.defs(r)}function tet(r=Vi.namedProjections){as.defs(r),DL(as),r.forEach(t=>{Lg(Wt(t[0])),Jtt(t[0]),kE(t[0]).masterportal=!0})}function eet(){return Object.keys(as.defs).map(r=>Object.assign(as.defs(r),{name:r})).filter(function(r,t,e){return t===e.indexOf(r)&&r.masterportal===!0})}function EE(r){return r.getView().getProjection().getCode()}function h3(r){return typeof r=="string"?kE(r):r}function SE(r,t,e){const i=h3(r),n=h3(t);if(i&&n&&e)return as(i,n,e);console.error(`Cancelled coordinate transformation with invalid parameters: ${r}; ${t}; ${e}`)}function ret(r,t,e){return SE(t,EE(r),e)}function iet(r,t,e){return SE(EE(r),t,e)}const net={transformFromMapProjection:iet,transformToMapProjection:ret,transform:SE,getMapProjection:EE,getProjections:eet,registerProjections:tet,getProjection:kE};let set=0;const oet={wms:AH,wmts:BY,wfs:dK,geojson:fX,vectortile:Utt,oaf:Xtt},u3=Ik.prototype.addLayer;function $L(r){return r.getLayers?r.getLayers().getArray().map(t=>$L(t)).flat(1):[r]}function d3(r,t){$L(r).forEach(e=>{const i=e.getSource?.();i?(i.on?.("tileloaderror",t),i.on?.("imageloaderror",t),i.on?.("featuresloaderror",t),i.on?.("error",t)):console.error("Could not register error callback on layer:",e)})}function aet(r,t){const e=t?.visibility??t?.layerParams?.visibility??!0,i=t?.transparency??t?.layerParams?.transparency??0,n={...t?.layerParams||{},visibility:e,transparency:i},s=typeof t?.errorCallback=="function"?t?.errorCallback:console.error;let o,a;if(typeof r=="string"){const l=Ml.getLayerWhere({id:r});return l?(a=oet[l.typ.toLowerCase()],a?(o=a.createLayer(l,{layerParams:n},{map:this}),o.setVisible(typeof e=="boolean"?e:!0),o.setOpacity(typeof i=="number"?(100-i)/100:1),d3(o,s),u3.call(this,o),o):(console.error("Layer with id '"+r+"' has unknown type '"+l.typ+"'. No layer added to map."),null)):(console.error("Layer with id '"+r+"' not found. No layer added to map."),null)}return d3(r,s),u3.call(this,r)}Ik.prototype.addLayer=aet;function cet(r=Vi,{mapParams:t,callback:e,errorCallback:i}={}){net.registerProjections(r.namedProjections),iH(r),RI(r.gazetteerUrl);const n=Object.assign({},{dragPan:!1,altShiftDragRotate:!1,pinchRotate:!1},r.mapInteractions?.interactionModes),s=new Ik(Object.assign({target:r.target||Vi.target,interactions:XP(n).extend([new YP({condition:function(o){return o.originalEvent.shiftKey?!1:!o.originalEvent.pointerType||o.originalEvent.pointerType==="mouse"||r.mapInteractions?.interactionModes?.twoFingerPan&&this.getPointerCount()===2||!r.mapInteractions?.interactionModes?.twoFingerPan}})]),controls:[],view:Qtt(r),keyboardEventTarget:r.mapInteractions?.keyboardEventTarget?document:!1},t));return s.set("mapMode","2D"),s.set("id",`map2D_${set++}`),Ml.initializeLayerList(r.layerConf,(o,a)=>(nH(r).forEach(l=>{s.addLayer(l.id,{layerParams:l,errorCallback:i})}),typeof e=="function"?e(o,a):null)),s}let Zp,GL;function W2(){if(Zp===void 0){const r=document.createElement("canvas");r.setAttribute("style","image-rendering: -moz-crisp-edges; image-rendering: crisp-edges; image-rendering: pixelated;");const t=r.style.imageRendering;Zp=!!t,Zp&&(GL=t)}return Zp}function het(){return W2(),GL||""}function M0(r){return r.get("olcs_projection")||r.getProjection()}let uet=0;function pr(r){return r.olcs_uid||(r.olcs_uid=++uet)}function pv(r){const t=r;return t.readyPromise||(t.ready!==void 0?t.ready?Promise.resolve(r):new Promise((i,n)=>{const s=setInterval(()=>{t.ready&&(clearInterval(s),i(r))},20)}):Promise.reject("Not a readyable object"))}function det(r){const t=r.load||z1,e=r.imageExtent,i=r.crossOrigin??null;return()=>{const n=new Image;return n.crossOrigin=i,t(n,r.url).then(s=>{const o=Me(e)/s.width,a=Ar(e)/s.height;return{image:s,extent:e,resolution:o!==a?[o,a]:a,pixelRatio:1}})}}let get=class extends fy{constructor(r){const t=r.crossOrigin!==void 0?r.crossOrigin:null,e=r.imageLoadFunction!==void 0?r.imageLoadFunction:xL;super({attributions:r.attributions,interpolate:r.interpolate,projection:ee(r.projection)}),this.url_=r.url,this.imageExtent_=r.imageExtent,this.image=null,this.image=new j1(this.imageExtent_,void 0,1,det({url:r.url,imageExtent:r.imageExtent,crossOrigin:t,load:(i,n)=>(this.image.setImage(i),e(this.image,n),z1(i))})),this.image.addEventListener(Vt.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(r,t,e,i){return wr(r,this.image.getExtent())?this.image:null}getUrl(){return this.url_}};const Gm="1.3.0",g3=[101,101];function jL(r,t,e,i,n){n.WIDTH=e[0],n.HEIGHT=e[1];const s=i.getAxisOrientation(),o=N1(n.VERSION,"1.3")>=0;n[o?"CRS":"SRS"]=i.getCode();const a=o&&s.startsWith("ne")?[t[1],t[0],t[3],t[2]]:t;return n.BBOX=a.join(","),_E(r,n)}function zL(r,t,e,i,n,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=t/e,l=[bS(Me(r)/a,ol),bS(Ar(r)/a,ol)];if(e!=1)switch(o){case"geoserver":const c=90*e+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+c:s.FORMAT_OPTIONS="dpi:"+c;break;case"mapserver":s.MAP_RESOLUTION=90*e;break;case"carmentaserver":case"qgis":s.DPI=90*e;break;default:throw new Error("Unknown `serverType` configured")}return jL(n,r,l,i,s)}function jm(r,t){return Object.assign({REQUEST:t,SERVICE:"WMS",VERSION:Gm,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},r)}function fet(r){const t=r.hidpi===void 0?!0:r.hidpi,e=ee(r.projection||"EPSG:3857"),i=r.ratio||1.5,n=r.load||z1,s=r.crossOrigin??null;return(o,a,l)=>{o=wL(o,a,l,i),l!=1&&(!t||r.serverType===void 0)&&(l=1);const c=zL(o,a,l,e,r.url,jm(r.params,"GetMap"),r.serverType),h=new Image;return h.crossOrigin=s,n(h,c).then(u=>({image:u,extent:o,pixelRatio:l}))}}function pet(r,t,e){if(r.url===void 0)return;const i=ee(r.projection||"EPSG:3857"),n=kg(t,e,0,g3),s={QUERY_LAYERS:r.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(s,jm(r.params,"GetFeatureInfo"),r.params);const o=Gh((t[0]-n[0])/e,ol),a=Gh((n[3]-t[1])/e,ol),l=N1(s.VERSION,"1.3")>=0;return s[l?"I":"X"]=o,s[l?"J":"Y"]=a,jL(r.url,n,g3,i,s)}function met(r,t){if(r.url===void 0)return;const e={SERVICE:"WMS",VERSION:Gm,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t!==void 0){const i=ee(r.projection||"EPSG:3857").getMetersPerUnit()||1,n=28e-5;e.SCALE=t*i/n}if(Object.assign(e,r.params),r.params!==void 0&&e.LAYER===void 0){const i=e.LAYERS;if(!(!Array.isArray(i)||i.length!==1))return;e.LAYER=i}return _E(r.url,e)}class yet extends fy{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:t.interpolate,projection:t.projection,resolutions:t.resolutions}),this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null,this.url_=t.url,this.imageLoadFunction_=t.imageLoadFunction!==void 0?t.imageLoadFunction:xL,this.params_=Object.assign({},t.params),this.serverType_=t.serverType,this.hidpi_=t.hidpi!==void 0?t.hidpi:!0,this.renderedRevision_=0,this.ratio_=t.ratio!==void 0?t.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(t,e,i,n){const s=ee(i),o=this.getProjection();o&&o!==s&&(e=df(o,s,t,e),t=qs(t,s,o));const a={url:this.url_,params:{...this.params_,...n},projection:o||s};return pet(a,t,e)}getLegendUrl(t,e){return met({url:this.url_,params:{...this.params_,...e}},t)}getParams(){return this.params_}getImageInternal(t,e,i,n){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==n)&&(this.loaderProjection_=n,this.loader=fet({crossOrigin:this.crossOrigin_,params:this.params_,projection:n,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,o)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,o),z1(s))})),super.getImageInternal(t,e,i,n))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(t){this.imageLoadFunction_=t,this.changed()}setUrl(t){t!=this.url_&&(this.url_=t,this.loader=null,this.changed())}setParams(t){this.params_=Object.assign({},t),this.changed()}updateParams(t){Object.assign(this.params_,t),this.changed()}changed(){this.image=null,super.changed()}}class _et extends xE{constructor(t){t=t||{};const e=Object.assign({},t.params);super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=t.hidpi!==void 0?t.hidpi:!0,this.tmpExtent_=nn(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,i,n){const s=ee(i),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=qs(t,s,o),c=df(o,s,t,e),h=a.getZForResolution(c,this.zDirection),u=a.getResolution(h),d=a.getTileCoordForCoordAndZ(l,h);if(a.getResolutions().length<=d[0])return;let g=a.getTileCoordExtent(d,this.tmpExtent_);const f=this.gutter_;f!==0&&(g=rs(g,u*f,g));const p={QUERY_LAYERS:this.params_.LAYERS};Object.assign(p,jm(this.params_,"GetFeatureInfo"),n);const m=Math.floor((l[0]-g[0])/u),y=Math.floor((g[3]-l[1])/u);return p[this.v13_?"I":"X"]=m,p[this.v13_?"J":"Y"]=y,this.getRequestUrl_(d,g,1,o||s,p)}getLegendUrl(t,e){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:Gm,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===void 0||e.LAYER===void 0){const n=this.params_.LAYERS;if(!(!Array.isArray(n)||n.length===1))return;i.LAYER=n}if(t!==void 0){const n=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=t*n/s}return Object.assign(i,e),_E(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,i,n,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=cl(_L(t),o.length);a=o[l]}return zL(e,(this.tileGrid||this.getTileGridForProjection(n)).getResolution(t[0]),i,n,a,s,this.serverType_)}getTilePixelRatio(t){return!this.hidpi_||this.serverType_===void 0?1:t}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}setParams_(t){this.params_=t,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(t){this.setParams_(Object.assign({},t))}updateParams(t){this.setParams_(Object.assign(this.params_,t))}updateV13_(){const t=this.params_.VERSION||Gm;this.v13_=N1(t,"1.3")>=0}tileUrlFunction(t,e,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=t[0])return;e!=1&&(!this.hidpi_||this.serverType_===void 0)&&(e=1);const s=n.getResolution(t[0]);let o=n.getTileCoordExtent(t,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=rs(o,s*a,o));const l=Object.assign({},jm(this.params_,"GetMap"));return this.getRequestUrl_(t,o,e,i,l)}}class TE extends ls{constructor(t){t=t||{},super({attributions:t.attributions,wrapX:t.wrapX}),this.resolution=void 0,this.distance=t.distance!==void 0?t.distance:20,this.minDistance=t.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=t.geometryFunction||function(e){const i=e.getGeometry();return Re(!i||i.getType()==="Point","The default `geometryFunction` can only handle `Point` or null geometries"),i},this.createCustomCluster_=t.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(t.source||null)}clear(t){this.features.length=0,super.clear(t)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(t,e,i){this.source?.loadFeatures(t,e,i),e!==this.resolution&&(this.resolution=e,this.refresh())}setDistance(t){this.updateDistance(t,this.minDistance)}setMinDistance(t){this.updateDistance(this.distance,t)}getMinDistance(){return this.minDistance}setSource(t){this.source&&this.source.removeEventListener(Vt.CHANGE,this.boundRefresh_),this.source=t,t&&t.addEventListener(Vt.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(t,e){const i=t===0?0:Math.min(e,t)/t,n=t!==this.distance||this.interpolationRatio!==i;this.distance=t,this.minDistance=e,this.interpolationRatio=i,n&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const t=nn(),e=this.distance*this.resolution,i=this.source.getFeatures(),n={};for(let s=0,o=i.length;s<o;s++){const a=i[s];if(!($t(a)in n)){const l=this.geometryFunction(a);if(l){const c=l.getCoordinates();tu(c,t),rs(t,e,t);const h=this.source.getFeaturesInExtent(t).filter(function(u){const d=$t(u);return d in n?!1:(n[d]=!0,!0)});this.features.push(this.createCluster(h,t))}}}}createCluster(t,e){const i=[0,0];for(let a=t.length-1;a>=0;--a){const l=this.geometryFunction(t[a]);l?qM(i,l.getCoordinates()):t.splice(a,1)}BM(i,1/t.length);const n=Wi(e),s=this.interpolationRatio,o=new Pi([i[0]*(1-s)+n[0]*s,i[1]*(1-s)+n[1]*s]);return this.createCustomCluster_?this.createCustomCluster_(o,t):new zi({geometry:o,features:t})}}function qL(){const r=document.createElement("canvas");return r.width=1,r.height=1,r}class vet{source_;projection_;fallbackProj_;map_;shouldRequestNextLevel;emptyCanvas_=qL();emptyCanvasPromise_=Promise.resolve(this.emptyCanvas_);tilingScheme_;ready_;rectangle_;get ready(){return this.ready_}get rectangle(){return this.rectangle_}get tilingScheme(){return this.tilingScheme_}errorEvent=new Cesium.Event;credit;proxy;get _ready(){return this.ready_}get tileWidth(){const t=this.source_.getTileGrid();if(t){const e=t.getTileSize(0);return Array.isArray(e)?e[0]:e}return 256}get tileHeight(){const t=this.source_.getTileGrid();if(t){const e=t.getTileSize(0);return Array.isArray(e)?e[1]:e}return 256}get maximumLevel(){const t=this.source_.getTileGrid();return t?t.getMaxZoom():18}get minimumLevel(){return 0}get tileDiscardPolicy(){}get hasAlphaChannel(){return!0}pickFeatures(t,e,i,n,s){}constructor(t,e,i){this.source_=e,this.projection_=null,this.ready_=!1,this.fallbackProj_=i||null,this.tilingScheme_=new Cesium.WebMercatorTilingScheme,this.rectangle_=null,this.map_=t,this.shouldRequestNextLevel=!1;const n=this.source_.get("olcs_proxy");n&&(typeof n=="function"?this.proxy={getURL:n}:typeof n=="string"&&(this.proxy=new Cesium.DefaultProxy(n))),this.source_.on("change",s=>{this.handleSourceChanged_()}),this.handleSourceChanged_()}handleSourceChanged_(){if(!this.ready_&&this.source_.getState()=="ready"){this.projection_=M0(this.source_)||this.fallbackProj_;const t={numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1};if(this.source_.getTileGrid()!==null&&this.source_.getTileGrid().forEachTileCoord(this.projection_.getExtent(),0,([e,i,n])=>{t.numberOfLevelZeroTilesX=i+1,t.numberOfLevelZeroTilesY=n+1}),this.projection_.getCode()==="EPSG:4326")this.shouldRequestNextLevel=t.numberOfLevelZeroTilesX===1&&t.numberOfLevelZeroTilesY===1,this.tilingScheme_=new Cesium.GeographicTilingScheme(t);else if(this.projection_.getCode()==="EPSG:3857")this.shouldRequestNextLevel=!1,this.tilingScheme_=new Cesium.WebMercatorTilingScheme(t);else return;this.rectangle_=this.tilingScheme_.rectangle,this.ready_=!0}}getTileCredits(t,e,i){const n=this.source_.getAttributions();if(!n)return[];const s=this.map_.getView().calculateExtent(this.map_.getSize()),o=this.map_.getView().getCenter(),a=this.shouldRequestNextLevel?i+1:i;return UL(n,a,o,s)}requestImage(t,e,i,n){const s=this.source_.getTileUrlFunction();if(s&&this.projection_){const o=this.shouldRequestNextLevel?i+1:i;let a=s.call(this.source_,[o,t,e],1,this.projection_);return this.proxy&&(a=this.proxy.getURL(a)),a?Cesium.ImageryProvider.loadImage(this,a):this.emptyCanvasPromise_}else return this.emptyCanvasPromise_}}const xet=new gL({featureClass:Gi}),wet=[new Vr({stroke:new so({color:"blue",width:2})})];class bet{urls;emptyCanvas_=qL();emptyCanvasPromise_=Promise.resolve(this.emptyCanvas_);tilingScheme_=new Cesium.WebMercatorTilingScheme;ready_=!0;rectangle_;tileRectangle_;tileWidth=256;tileHeight=256;maximumLevel=20;minimumLevel_=0;get minimumLevel(){return this.minimumLevel_}featureCache;tileCache;tileFunction_;styleFunction_;projection_=ee("EPSG:3857");get ready(){return this.ready_}get rectangle(){return this.rectangle_}get tilingScheme(){return this.tilingScheme_}errorEvent=new Cesium.Event;credit;getTileCredits(t,e,i){return[]}proxy;get _ready(){return this.ready_}get tileDiscardPolicy(){}get hasAlphaChannel(){return!0}pickFeatures(t,e,i,n,s){}constructor(t){this.urls=t.urls,this.rectangle_=t.rectangle||this.tilingScheme.rectangle,this.credit=t.credit,this.styleFunction_=t.styleFunction||(()=>wet),this.tileRectangle_=new Cesium.Rectangle;const e=t.cacheSize!==void 0?t.cacheSize:50;this.tileCache=new Dm(e),this.featureCache=t.featureCache||new Dm(e),this.minimumLevel_=t.minimumLevel||0;const i=my(this.projection_);this.tileFunction_=vE(this.urls,i)}getTileFeatures(t,e,i){const n=this.getCacheKey_(t,e,i);let s;if(this.featureCache.containsKey(n)&&(s=this.featureCache.get(n)),!s){const o=this.getUrl_(t,e,i);if(s=fetch(o).then(a=>a.ok?a:Promise.reject(a)).then(a=>a.arrayBuffer()).then(a=>this.readFeaturesFromBuffer(a)),this.featureCache.set(n,s),this.featureCache.getCount()>2*this.featureCache.highWaterMark)for(;this.featureCache.canExpireCache();)this.featureCache.pop()}return s}readFeaturesFromBuffer(t){const e=xet.readFeatures(t),i=this.tileWidth/4096;return e.forEach(n=>{const s=n.getFlatCoordinates();for(let o=0;o<s.length;++o)s[o]*=i}),e}getUrl_(t,e,i){return this.tileFunction_([t,e,i],1,this.projection_)}getCacheKey_(t,e,i){return`${t}_${e}_${i}`}requestImage(t,e,i,n){if(i<this.minimumLevel_)return this.emptyCanvasPromise_;try{const s=this.getCacheKey_(i,t,e);let o;if(this.tileCache.containsKey(s)&&(o=this.tileCache.get(s)),!o&&(o=this.getTileFeatures(i,t,e).then(a=>{this.tilingScheme.tileXYToNativeRectangle(t,e,i,this.tileRectangle_);const l=(this.tileRectangle_.east-this.tileRectangle_.west)/this.tileWidth;return this.rasterizeFeatures(a,this.styleFunction_,l)}),this.tileCache.set(s,o),this.tileCache.getCount()>2*this.tileCache.highWaterMark))for(;this.tileCache.canExpireCache();)this.tileCache.pop();return o}catch(s){console.trace(s),this.errorEvent.raiseEvent("could not render pbf to tile",s)}}rasterizeFeatures(t,e,i){const n=document.createElement("canvas"),s=jV(n.getContext("2d"),{size:[this.tileWidth,this.tileHeight]});return t.forEach(o=>{const a=e(o,i);a&&(Array.isArray(a)?a.forEach(l=>{s.setStyle(l),s.drawGeometry(o)}):(s.setStyle(a),s.drawGeometry(o)))}),n}}function ket(r,t){const e=r.camera.getPickRay(t);return r.globe.pick(e,r)||r.camera.pickEllipsoid(t)}function Eet(r){const t=r.canvas,e=new Cesium.Cartesian2(t.clientWidth/2,t.clientHeight/2);return ket(r,e)}function CE(r,t){if(r&&t){const e=ru(r,t,"EPSG:4326");return Cesium.Rectangle.fromDegrees(e[0],e[1],e[2],e[3])}else return null}function Tet(r,t,e,i){const n=t.get("olcs_skip");if(n)return null;let s=null;if(t instanceof yet&&t.getUrl()){const o={olcs_proxy:t.get("olcs_proxy"),olcs_extent:t.get("olcs_extent"),olcs_projection:t.get("olcs_projection"),"olcs.imagesource":t},a=t.getImageLoadFunction(),l=t.get("olcs_tileLoadFunction")||function(c,h){a(c,h)};t=new _et({url:t.getUrl(),attributions:t.getAttributions(),projection:t.getProjection(),tileLoadFunction:l,params:t.getParams()}),t.setProperties(o)}if(t instanceof xE){let o=M0(t);if(o||(o=e),p3(o))s=new vet(r,t,e);else return null}else if(t instanceof get){let o=M0(t);if(o||(o=e),p3(o)){const a=Cesium.Rectangle.fromDegrees(t.getImageExtent()[0],t.getImageExtent()[1],t.getImageExtent()[2],t.getImageExtent()[3],new Cesium.Rectangle);s=new Cesium.SingleTileImageryProvider({url:t.getUrl(),rectangle:a})}else return null}else if(t instanceof wE&&i instanceof pl){let o=M0(t);if(o||(o=e),n===!1){const a=o.getCode().split(":")[1],l=t.urls.map(p=>p.replace(a,"3857")),c=i.getExtent(),h=CE(c,o),u=t.get("olcs_minimumLevel"),d=t.getAttributions(),g=i.getStyleFunction();let f;if(c&&d){const p=Wi(c);f=UL(d,0,p,c)[0]}return s=new bet({credit:f,rectangle:h,minimumLevel:u,styleFunction:g,urls:l}),s}return null}else return null;return s}function BL(r,t,e){if(!(t instanceof gy)&&!(t instanceof mE)&&!(t instanceof pl))return null;const i=t.getSource();if(!i)return null;let n=i.get("olcs_provider");if(n||(n=Tet(r,i,e,t)),!n)return null;const s={},o=t.get("olcs_extent")||t.getExtent();return o&&(s.rectangle=CE(o,e)),new Cesium.ImageryLayer(n,s)}function zm(r,t){let e=1,i=!0;[r.layer].concat(r.parents).forEach(n=>{const s=n.getOpacity();s!==void 0&&(e*=s);const o=n.getVisible();o!==void 0&&(i=i&&o)}),t.alpha=e,t.show=i}function Xh(r){const t=r;return t.length>2?Cesium.Cartesian3.fromDegrees(t[0],t[1],t[2]):Cesium.Cartesian3.fromDegrees(t[0],t[1])}function mv(r){console.assert(r!==null);const t=Xh,e=[];for(let i=0;i<r.length;++i)e.push(t(r[i]));return e}function Hp(r,t){console.assert(t);const e=ee("EPSG:4326"),i=ee(t);if(i.getCode()!==e.getCode()){const n=r.getProperties();r=r.clone(),r.transform(i,e),r.setProperties(n)}return r}function f3(r){if(r=r||"black",Array.isArray(r))return new Cesium.Color(Cesium.Color.byteToFloat(r[0]),Cesium.Color.byteToFloat(r[1]),Cesium.Color.byteToFloat(r[2]),r[3]);if(typeof r=="string")return Cesium.Color.fromCssColorString(r);if(r instanceof CanvasPattern||r instanceof CanvasGradient){const t=document.createElement("canvas"),e=t.getContext("2d");return t.width=t.height=256,e.fillStyle=r,e.fillRect(0,0,t.width,t.height),new Cesium.ImageMaterialProperty({image:t})}console.assert(!1,"impossible")}function p3(r){const t=r.getCode()==="EPSG:3857",e=r.getCode()==="EPSG:4326";return t||e}function UL(r,t,e,i){if(!r)return[];let n=r({viewState:{zoom:t,center:e,projection:void 0,resolution:void 0,rotation:void 0},extent:i});return Array.isArray(n)||(n=[n]),n.map(s=>new Cesium.Credit(s,!0))}function Cet(r,t,e,i){const n=e.canvas,s=e.camera.frustum.fovy;console.assert(!isNaN(s));const o=i.getMetersPerUnit(),a=r*n.clientHeight,l=Math.cos(Math.abs(t));return a*o*l/2/Math.tan(s/2)}function Met(r,t,e,i){const n=e.canvas,s=e.camera.frustum.fovy;console.assert(!isNaN(s));const o=i.getMetersPerUnit(),a=2*r*Math.tan(s/2),l=Math.cos(Math.abs(t));return a/o/l/n.clientHeight}class Ret{ol3d;scene_;canvas_;_boundNotifyRepaintRequired;repaintEventNames_=["mousemove","mousedown","mouseup","touchstart","touchend","touchmove","pointerdown","pointerup","pointermove","wheel"];constructor(t){this.ol3d=t,this.scene_=t.getCesiumScene(),this.canvas_=this.scene_.canvas,this._boundNotifyRepaintRequired=this.notifyRepaintRequired.bind(this),this.enable()}enable(){this.scene_.requestRenderMode=!0,this.scene_.maximumRenderTimeChange=1e3;for(const t of this.repaintEventNames_)this.canvas_.addEventListener(t,this._boundNotifyRepaintRequired,!1);window.addEventListener("resize",this._boundNotifyRepaintRequired,!1),this.ol3d.getOlMap().getLayerGroup().on("change",this._boundNotifyRepaintRequired)}disable(){for(const t of this.repaintEventNames_)this.canvas_.removeEventListener(t,this._boundNotifyRepaintRequired,!1);window.removeEventListener("resize",this._boundNotifyRepaintRequired,!1),this.ol3d.getOlMap().getLayerGroup().un("change",this._boundNotifyRepaintRequired),this.scene_.requestRenderMode=!1}restartRenderLoop(){this.notifyRepaintRequired()}notifyRepaintRequired(){this.scene_.isDestroyed()||this.scene_.requestRender()}}function Yp(r){return r*180/Math.PI}function Rd(r){return r*Math.PI/180}function Xp(r,t,e){const i=e||r.length;if(t)for(let n=0;n<i;++n)t[n]=r[n];return r}class Iet{scene_;cam_;map_;view_;viewListenKey_=null;toLonLat_=Xp;fromLonLat_=Xp;tilt_=0;distance_=0;lastCameraViewMatrix_=null;viewUpdateInProgress_=!1;constructor(t,e){this.scene_=t,this.cam_=t.camera,this.map_=e,this.map_.on("change:view",i=>{this.setView_(this.map_.getView())}),this.setView_(this.map_.getView())}destroy(){ks(this.viewListenKey_),this.viewListenKey_=null}setView_(t){if(ks(this.viewListenKey_),this.viewListenKey_=null,this.view_=t,t){const e=yo(t.getProjection(),"EPSG:4326"),i=yo("EPSG:4326",t.getProjection());console.assert(e&&i),this.toLonLat_=e,this.fromLonLat_=i,this.viewListenKey_=t.on("propertychange",n=>this.handleViewChangedEvent_()),this.readFromView()}else this.toLonLat_=Xp,this.fromLonLat_=Xp}handleViewChangedEvent_(){this.viewUpdateInProgress_||this.readFromView()}setHeading(t){this.view_&&this.view_.setRotation(t)}getHeading(){return this.view_?this.view_.getRotation()||0:void 0}setTilt(t){this.tilt_=t,this.updateCamera_()}getTilt(){return this.tilt_}setDistance(t){this.distance_=t,this.updateCamera_(),this.updateView()}getDistance(){return this.distance_}setCenter(t){this.view_&&this.view_.setCenter(t)}getCenter(){if(this.view_)return this.view_.getCenter()}setPosition(t){if(!this.toLonLat_)return;const e=this.toLonLat_(t);console.assert(e);const i=new Cesium.Cartographic(Rd(e[0]),Rd(e[1]),this.getAltitude());this.cam_.setView({destination:Cesium.Ellipsoid.WGS84.cartographicToCartesian(i)}),this.updateView()}getPosition(){if(!this.fromLonLat_)return;const t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position),e=this.fromLonLat_([Yp(t.longitude),Yp(t.latitude)]);return console.assert(e),e}setAltitude(t){const e=Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position);e.height=t,this.cam_.position=Cesium.Ellipsoid.WGS84.cartographicToCartesian(e),this.updateView()}getAltitude(){return Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position).height}updateCamera_(){if(!this.view_||!this.toLonLat_)return;const t=this.view_.getCenter();if(!t)return;const e=this.toLonLat_(t);console.assert(e);const i=new Cesium.Cartographic(Rd(e[0]),Rd(e[1]));if(this.scene_.globe){const o=this.scene_.globe.getHeight(i);i.height=o||0}const n=Cesium.Ellipsoid.WGS84.cartographicToCartesian(i),s={pitch:this.tilt_-Cesium.Math.PI_OVER_TWO,heading:-this.view_.getRotation(),roll:void 0};this.cam_.setView({destination:n,orientation:s}),this.cam_.moveBackward(this.distance_),this.checkCameraChange(!0)}readFromView(){if(!this.view_||!this.toLonLat_)return;const t=this.view_.getCenter();if(t==null)return;const e=this.toLonLat_(t);console.assert(e);const i=this.view_.getResolution();this.distance_=this.calcDistanceForResolution(i||0,Rd(e[1])),this.updateCamera_()}updateView(){if(!this.view_||!this.fromLonLat_)return;this.viewUpdateInProgress_=!0;const t=Cesium.Ellipsoid.WGS84,e=this.scene_,i=Eet(e);let n=i;if(!n){const o=e.globe,a=this.cam_.positionCartographic.clone(),l=o.getHeight(a);a.height=l||0,n=Cesium.Ellipsoid.WGS84.cartographicToCartesian(a)}this.distance_=Cesium.Cartesian3.distance(n,this.cam_.position);const s=t.cartesianToCartographic(n);if(this.view_.setCenter(this.fromLonLat_([Yp(s.longitude),Yp(s.latitude)])),this.view_.setResolution(this.calcResolutionForDistance(this.distance_,s?s.latitude:0)),i){const o=this.cam_.position,a=new Cesium.Cartesian3;t.geocentricSurfaceNormal(i,a);const l=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(o,i,l),Cesium.Cartesian3.normalize(l,l);const c=this.cam_.up,h=this.cam_.right,u=new Cesium.Cartesian3(-i.y,i.x,0),d=Cesium.Cartesian3.angleBetween(h,u),g=Cesium.Cartesian3.cross(i,c,new Cesium.Cartesian3).z;this.view_.setRotation(g<0?d:-d);const f=Math.acos(Cesium.Cartesian3.dot(a,l));this.tilt_=isNaN(f)?0:f}else this.view_.setRotation(this.cam_.heading),this.tilt_=-this.cam_.pitch+Math.PI/2;setTimeout(()=>this.viewUpdateInProgress_=!1,1e3)}checkCameraChange(t){const e=this.lastCameraViewMatrix_,i=this.cam_.viewMatrix;(!e||!Cesium.Matrix4.equalsEpsilon(e,i,1e-7))&&(this.lastCameraViewMatrix_=i.clone(),t!==!0&&this.updateView())}calcDistanceForResolution(t,e){return Cet(t,e,this.scene_,this.view_.getProjection())}calcResolutionForDistance(t,e){return Met(t,e,this.scene_,this.view_.getProjection())}}class ME{map;view;scene;olLayers;mapLayerGroup;layerMap={};olLayerListenKeys={};olGroupListenKeys_={};constructor(t,e){this.map=t,this.view=t.getView(),this.scene=e,this.olLayers=t.getLayerGroup().getLayers(),this.mapLayerGroup=t.getLayerGroup()}synchronize(){this.destroyAll(),this.addLayers_(this.mapLayerGroup)}orderLayers(){}addLayers_(t){const e=[{layer:t,parents:[]}];for(;e.length>0;){const i=e.splice(0,1)[0],n=i.layer,s=pr(n).toString();this.olLayerListenKeys[s]=[],console.assert(!this.layerMap[s]);let o=null;if(n instanceof Nc)this.listenForGroupChanges_(n),n!==this.mapLayerGroup&&(o=this.createSingleLayerCounterparts(i)),o||n.getLayers().forEach(a=>{if(a){const l={layer:a,parents:n===this.mapLayerGroup?[]:[i.layer].concat(i.parents)};e.push(l)}});else if(o=this.createSingleLayerCounterparts(i),!o){const a=s,l=i,c=()=>{const h=this.createSingleLayerCounterparts(l);h&&(l.layer.un("change",c),this.addCesiumObjects_(h,a,l.layer),this.orderLayers())};this.olLayerListenKeys[s].push(l.layer.on("change",c))}o&&this.addCesiumObjects_(o,s,n)}this.orderLayers()}addCesiumObjects_(t,e,i){this.layerMap[e]=t,this.olLayerListenKeys[e].push(i.on("change:zIndex",()=>this.orderLayers())),t.forEach(n=>{this.addCesiumObject(n)})}removeAndDestroySingleLayer_(t){const e=pr(t).toString(),i=this.layerMap[e];return i&&(i.forEach(n=>{this.removeSingleCesiumObject(n,!1),this.destroyCesiumObject(n)}),this.olLayerListenKeys[e].forEach(ks),delete this.olLayerListenKeys[e]),delete this.layerMap[e],!!i}unlistenSingleGroup_(t){if(t===this.mapLayerGroup)return;const e=pr(t).toString();this.olGroupListenKeys_[e].forEach(i=>{ks(i)}),delete this.olGroupListenKeys_[e],delete this.layerMap[e]}removeLayer_(t){if(t){const e=[t];for(;e.length>0;){const i=e.splice(0,1)[0],n=this.removeAndDestroySingleLayer_(i);i instanceof Nc&&(this.unlistenSingleGroup_(i),n||i.getLayers().forEach(s=>{e.push(s)}))}}}listenForGroupChanges_(t){const e=pr(t).toString();console.assert(this.olGroupListenKeys_[e]===void 0);const i=[];this.olGroupListenKeys_[e]=i;let n=[];const s=(function(){const o=t.getLayers();o&&(n=[o.on("add",a=>{this.addLayers_(a.element)}),o.on("remove",a=>{this.removeLayer_(a.element)})],i.push(...n))}).bind(this);s(),i.push(t.on("change:layers",o=>{n.forEach(a=>{const l=i.indexOf(a);l>=0&&i.splice(l,1),ks(a)}),s()}))}destroyAll(){this.removeAllCesiumObjects(!0);let t;for(t in this.olGroupListenKeys_)this.olGroupListenKeys_[t].forEach(ks);for(t in this.olLayerListenKeys)this.olLayerListenKeys[t].forEach(ks);this.olGroupListenKeys_={},this.olLayerListenKeys={},this.layerMap={}}}class Pet extends ME{cesiumLayers_;ourLayers_;constructor(t,e){super(t,e),this.cesiumLayers_=e.imageryLayers,this.ourLayers_=new Cesium.ImageryLayerCollection}addCesiumObject(t){this.cesiumLayers_.add(t),this.ourLayers_.add(t)}destroyCesiumObject(t){t.destroy()}removeSingleCesiumObject(t,e){this.cesiumLayers_.remove(t,e),this.ourLayers_.remove(t,!1)}removeAllCesiumObjects(t){for(let e=0;e<this.ourLayers_.length;++e)this.cesiumLayers_.remove(this.ourLayers_.get(e),t);this.ourLayers_.removeAll(!1)}convertLayerToCesiumImageries(t,e){const i=BL(this.map,t,e);return i?[i]:null}createSingleLayerCounterparts(t){const e=t.layer,i=pr(e).toString(),n=this.view.getProjection();console.assert(n);const s=this.convertLayerToCesiumImageries(e,n);if(s){const o=[];if([t.layer].concat(t.parents).forEach(a=>{o.push(a.on(["change:opacity","change:visible"],()=>{console.assert(s);for(let l=0;l<s.length;++l)zm(t,s[l])}))}),e instanceof V1){let a=e.getStyleFunction();o.push(e.on("change",()=>{const l=e.getStyleFunction();if(a!==l){a=l;for(let c=0;c<s.length;++c){const h=s[c];h._imageryCache&&(h._imageryCache={});const u=h.imageryProvider;u&&(u.tileCache?.clear(),u.styleFunction_=l)}this.scene.requestRender()}}))}for(let a=0;a<s.length;++a)zm(t,s[a]);o.push(e.on("change:extent",a=>{for(let l=0;l<s.length;++l)this.cesiumLayers_.remove(s[l],!0),this.ourLayers_.remove(s[l],!1);delete this.layerMap[pr(e)],this.synchronize()})),o.push(e.on("change",a=>{for(let l=0;l<s.length;++l){const c=this.cesiumLayers_.indexOf(s[l]);c>=0&&(this.cesiumLayers_.remove(s[l],!1),this.cesiumLayers_.add(s[l],c))}})),this.olLayerListenKeys[i].push(...o)}return Array.isArray(s)?s:null}orderLayers(){const t=[],e={},i=[this.mapLayerGroup];for(;i.length>0;){const n=i.splice(0,1)[0];if(t.push(n),e[pr(n)]=n.getZIndex()||0,n instanceof Nc){const s=n.getLayers();s&&i.unshift(...s.getArray())}}t.sort((n,s)=>e[pr(n)]-e[pr(s)]),t.forEach(n=>{const s=pr(n).toString(),o=this.layerMap[s];o&&o.forEach(a=>{this.raiseToTop(a)})})}raiseToTop(t){this.cesiumLayers_.raiseToTop(t)}}class Aet{olListenKeys=[];context;rootCollection_;constructor(t,e){const i=new Cesium.BillboardCollection({scene:e}),n=new Cesium.PrimitiveCollection;this.rootCollection_=new Cesium.PrimitiveCollection,this.context={projection:t,billboards:i,featureToCesiumMap:{},primitives:n},this.rootCollection_.add(i),this.rootCollection_.add(n)}destroy(){this.olListenKeys.forEach(ks),this.olListenKeys.length=0}getRootPrimitive(){return this.rootCollection_}}class Let{scene;boundOnRemoveOrClearFeatureListener_=this.onRemoveOrClearFeature_.bind(this);defaultBillboardEyeOffset_=new Cesium.Cartesian3(0,0,10);constructor(t){this.scene=t,this.scene=t}onRemoveOrClearFeature_(t){const e=t.target;console.assert(e instanceof ls);const i=e.olcs_cancellers;if(i){const n=t.feature;if(n){const s=pr(n),o=i[s];o&&(o(),delete i[s])}else{for(const s in i)i.hasOwnProperty(s)&&i[s]();e.olcs_cancellers={}}}}setReferenceForPicking(t,e,i){i.olLayer=t,i.olFeature=e}createColoredPrimitive(t,e,i,n,s,o){const a=function(d,g){const f=new Cesium.GeometryInstance({geometry:d});return g&&!(g instanceof Cesium.ImageMaterialProperty)&&(f.attributes={color:Cesium.ColorGeometryInstanceAttribute.fromColor(g)}),f},l={flat:!0,renderState:{depthTest:{enabled:!0}}};o!==void 0&&(l.renderState.lineWidth=o);const c=a(n,s),h=this.getHeightReference(t,e,i);let u;if(h===Cesium.HeightReference.CLAMP_TO_GROUND){if(!("createShadowVolume"in c.geometry.constructor))return null;u=new Cesium.GroundPrimitive({geometryInstances:c})}else u=new Cesium.Primitive({geometryInstances:c});if(s instanceof Cesium.ImageMaterialProperty){const d=s.image.getValue().toDataURL();u.appearance=new Cesium.MaterialAppearance({flat:!0,renderState:{depthTest:{enabled:!0}},material:new Cesium.Material({fabric:{type:"Image",uniforms:{image:d}}})})}else u.appearance=new Cesium.MaterialAppearance({...l,material:new Cesium.Material({translucent:s.alpha!==1,fabric:{type:"Color",uniforms:{color:s}}})}),u instanceof Cesium.Primitive&&(e.get("olcs_shadows")||t.get("olcs_shadows"))&&(u.shadows=1);return this.setReferenceForPicking(t,e,u),u}extractColorFromOlStyle(t,e){const i=t.getFill()?.getColor(),n=t.getStroke()?t.getStroke().getColor():null;let s="black";n&&e?s=n:i&&(s=i);const o=f3(s);return"red"in o?o:Cesium.Color.BLACK}extractLineWidthFromOlStyle(t){const e=t.getStroke()?t.getStroke().getWidth():void 0;return e!==void 0?e:1}wrapFillAndOutlineGeometries(t,e,i,n,s,o){const a=this.extractColorFromOlStyle(o,!1),l=this.extractColorFromOlStyle(o,!0),c=new Cesium.PrimitiveCollection;if(o.getFill()){const h=this.createColoredPrimitive(t,e,i,n,a);console.assert(!!h),c.add(h)}if(o.getStroke()&&s){const h=this.extractLineWidthFromOlStyle(o),u=this.createColoredPrimitive(t,e,i,s,l,h);u&&c.add(u)}return c}addTextStyle(t,e,i,n,s){let o;if(s instanceof Cesium.PrimitiveCollection?o=s:(o=new Cesium.PrimitiveCollection,o.add(s)),!n.getText())return o;const a=n.getText(),l=this.olGeometry4326TextPartToCesium(t,e,i,a);return l&&o.add(l),o}csAddBillboard(t,e,i,n,s,o){e.eyeOffset||(e.eyeOffset=this.defaultBillboardEyeOffset_);const a=t.add(e);return this.setReferenceForPicking(i,n,a),a}olCircleGeometryToCesium(t,e,i,n,s){i=Hp(i,n),console.assert(i.getType()=="Circle");const o=i.getCenter(),a=o.length==3?o[2]:0,l=o.slice();l[0]+=i.getRadius();const c=Xh(o),h=Xh(l),u=Cesium.Cartesian3.distance(c,h),d=new Cesium.CircleGeometry({center:c,radius:u,height:a});let g,f;if(this.getHeightReference(t,e,i)===Cesium.HeightReference.CLAMP_TO_GROUND){const m=this.extractLineWidthFromOlStyle(s);if(m){const y=EU(i.getCenter(),u),_=mv(y.getLinearRing(0).getCoordinates()),x=g=new Cesium.GroundPolylinePrimitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.GroundPolylineGeometry({positions:_,width:m})}),appearance:new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(e,s,!0)}),classificationType:Cesium.ClassificationType.TERRAIN});pv(g).then(()=>{this.setReferenceForPicking(t,e,x._primitive)})}}else f=new Cesium.CircleOutlineGeometry({center:c,radius:u,extrudedHeight:a,height:a});const p=this.wrapFillAndOutlineGeometries(t,e,i,d,f,s);return g&&p.add(g),this.addTextStyle(t,e,i,s,p)}olLineStringGeometryToCesium(t,e,i,n,s){i=Hp(i,n),console.assert(i.getType()=="LineString");const o=mv(i.getCoordinates()),a=this.extractLineWidthFromOlStyle(s);let l;const c=this.getHeightReference(t,e,i),h=new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(e,s,!0)});if(c===Cesium.HeightReference.CLAMP_TO_GROUND){const u=new Cesium.GroundPolylineGeometry({positions:o,width:a}),d=l=new Cesium.GroundPolylinePrimitive({appearance:h,geometryInstances:new Cesium.GeometryInstance({geometry:u})});pv(l).then(()=>{this.setReferenceForPicking(t,e,d._primitive)})}else{const u=new Cesium.PolylineGeometry({positions:o,width:a,vertexFormat:h.vertexFormat});l=new Cesium.Primitive({appearance:h,geometryInstances:new Cesium.GeometryInstance({geometry:u})})}return this.setReferenceForPicking(t,e,l),this.addTextStyle(t,e,i,s,l)}olPolygonGeometryToCesium(t,e,i,n,s){i=Hp(i,n),console.assert(i.getType()=="Polygon");const o=this.getHeightReference(t,e,i);let a,l,c;if(i.getCoordinates()[0].length==5&&e.get("olcs_polygon_kind")==="rectangle"){const u=i.getCoordinates()[0],d=Ei(u),g=Cesium.Rectangle.fromDegrees(d[0],d[1],d[2],d[3]);let f=0;if(u[0].length==3)for(let m=0;m<u.length;m++)f=Math.max(f,u[m][2]);const p=e.get("olcs_extruded_height");a=new Cesium.RectangleGeometry({ellipsoid:Cesium.Ellipsoid.WGS84,rectangle:g,height:f,extrudedHeight:p}),l=new Cesium.RectangleOutlineGeometry({ellipsoid:Cesium.Ellipsoid.WGS84,rectangle:g,height:f,extrudedHeight:p})}else{const u=i.getLinearRings(),d={positions:[],holes:[]},g=d;console.assert(u.length>0);for(let p=0;p<u.length;++p){const m=u[p].getCoordinates(),y=mv(m);console.assert(y&&y.length>0),p===0?d.positions=y:d.holes.push({positions:y,holes:[]})}const f=e.get("olcs_extruded_height");if(a=new Cesium.PolygonGeometry({polygonHierarchy:g,perPositionHeight:!0,extrudedHeight:f}),o===Cesium.HeightReference.CLAMP_TO_GROUND){const p=this.extractLineWidthFromOlStyle(s);if(p>0){const m=[d.positions];if(d.holes)for(let x=0;x<d.holes.length;++x)m.push(d.holes[x].positions);const y=new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(e,s,!0)}),_=[];for(const x of m){const v=new Cesium.GroundPolylineGeometry({positions:x,width:p});_.push(new Cesium.GeometryInstance({geometry:v}))}c=new Cesium.GroundPolylinePrimitive({appearance:y,geometryInstances:_}),pv(c).then(()=>{this.setReferenceForPicking(t,e,c._primitive)})}}else l=new Cesium.PolygonOutlineGeometry({polygonHierarchy:d,perPositionHeight:!0,extrudedHeight:f})}const h=this.wrapFillAndOutlineGeometries(t,e,i,a,l,s);return c&&h.add(c),this.addTextStyle(t,e,i,s,h)}getHeightReference(t,e,i){let n=i.get("altitudeMode");n===void 0&&(n=e.get("altitudeMode")),n===void 0&&(n=t.get("altitudeMode"));let s=Cesium.HeightReference.NONE;return n==="clampToGround"?s=Cesium.HeightReference.CLAMP_TO_GROUND:n==="relativeToGround"&&(s=Cesium.HeightReference.RELATIVE_TO_GROUND),s}createBillboardFromImage(t,e,i,n,s,o,a,l){o instanceof kl&&o.load();const c=o.getImage(1),h=function(d){return d.src!=""&&d.naturalHeight!=0&&d.naturalWidth!=0&&d.complete},u=(function(){if(!c||!(c instanceof HTMLCanvasElement||c instanceof Image||c instanceof HTMLImageElement))return;const d=i.getCoordinates(),g=Xh(d);let f;const p=o.getOpacity();p!==void 0&&(f=new Cesium.Color(1,1,1,p));const m=o.getScale(),y=this.getHeightReference(t,e,i),_={image:c,color:f,scale:Array.isArray(m)?(m[0]+m[1])/2:m,heightReference:y,position:g};if(Object.assign(_,e.get("cesiumOptions")),o instanceof kl){const v=o.getAnchor();if(v){const w=Array.isArray(m)?m[0]:m,b=Array.isArray(m)?m[1]:m;_.pixelOffset=new Cesium.Cartesian2((c.width/2-v[0])*w,(c.height/2-v[1])*b)}}const x=this.csAddBillboard(a,_,t,e,i,s);l&&l(x)}).bind(this);if(c instanceof Image&&!h(c)){let d=!1;const g=t.getSource(),f=function(){d=!0};g.on(["removefeature","clear"],this.boundOnRemoveOrClearFeatureListener_);let p=g.olcs_cancellers;p||(p=g.olcs_cancellers={});const m=pr(e);p[m]&&p[m](),p[m]=f;const y=function(){c.removeEventListener("load",y),!a.isDestroyed()&&!d&&u()};c.addEventListener("load",y)}else u()}olPointGeometryToCesium(t,e,i,n,s,o,a){console.assert(i.getType()=="Point"),i=Hp(i,n);let l=null;const c=s.getImage();if(c){const h=i.get("olcs_model")||e.get("olcs_model");if(h){l=new Cesium.PrimitiveCollection;const u=h(),d=Object.assign({},{scene:this.scene},u.cesiumOptions);if("fromGltf"in Cesium.Model){const g=Cesium.Model.fromGltf(d);l.add(g)}else Cesium.Model.fromGltfAsync(d).then(g=>{l.add(g)});u.debugModelMatrix&&l.add(new Cesium.DebugModelMatrixPrimitive({modelMatrix:u.debugModelMatrix}))}else this.createBillboardFromImage(t,e,i,n,s,c,o,a)}return s.getText()?this.addTextStyle(t,e,i,s,l||new Cesium.Primitive):l}olMultiGeometryToCesium(t,e,i,n,s,o,a){switch(i.getType()){case"MultiPoint":{const l=i.getPoints();if(s.getText()){const c=new Cesium.PrimitiveCollection;return l.forEach(h=>{console.assert(h);const u=this.olPointGeometryToCesium(t,e,h,n,s,o,a);u&&c.add(u)}),c}else return l.forEach(c=>{console.assert(c),this.olPointGeometryToCesium(t,e,c,n,s,o,a)}),null}case"MultiLineString":{const l=i.getLineStrings(),c=new Cesium.PrimitiveCollection;return l.forEach(h=>{const u=this.olLineStringGeometryToCesium(t,e,h,n,s);c.add(u)}),c}case"MultiPolygon":{const l=i.getPolygons(),c=new Cesium.PrimitiveCollection;return l.forEach(h=>{const u=this.olPolygonGeometryToCesium(t,e,h,n,s);c.add(u)}),c}default:console.assert(!1,`Unhandled multi geometry type${i.getType()}`)}}olGeometry4326TextPartToCesium(t,e,i,n){const s=n.getText();if(!s)return null;const o=new Cesium.LabelCollection({scene:this.scene}),a=Wi(i.getExtent());if(i instanceof ya){const f=i.getFirstCoordinate();a[2]=f.length==3?f[2]:0}const l={position:Xh(a)};l.text=Array.isArray(s)?s.join(" "):s,l.heightReference=this.getHeightReference(t,e,i);const c=n.getOffsetX(),h=n.getOffsetY();if(c!=0||h!=0){const f=new Cesium.Cartesian2(c,h);l.pixelOffset=f}l.font=n.getFont()||"10px sans-serif";let u;n.getFill()&&(l.fillColor=this.extractColorFromOlStyle(n,!1),u=Cesium.LabelStyle.FILL),n.getStroke()&&(l.outlineWidth=this.extractLineWidthFromOlStyle(n),l.outlineColor=this.extractColorFromOlStyle(n,!0),u=Cesium.LabelStyle.OUTLINE),n.getFill()&&n.getStroke()&&(u=Cesium.LabelStyle.FILL_AND_OUTLINE),l.style=u;let d;switch(n.getTextAlign()){case"left":d=Cesium.HorizontalOrigin.LEFT;break;case"right":d=Cesium.HorizontalOrigin.RIGHT;break;case"center":default:d=Cesium.HorizontalOrigin.CENTER}if(l.horizontalOrigin=d,n.getTextBaseline()){let f;switch(n.getTextBaseline()){case"top":f=Cesium.VerticalOrigin.TOP;break;case"middle":f=Cesium.VerticalOrigin.CENTER;break;case"bottom":f=Cesium.VerticalOrigin.BOTTOM;break;case"alphabetic":f=Cesium.VerticalOrigin.TOP;break;case"hanging":f=Cesium.VerticalOrigin.BOTTOM;break;default:console.assert(!1,`unhandled baseline ${n.getTextBaseline()}`)}l.verticalOrigin=f}const g=o.add(l);return this.setReferenceForPicking(t,e,g),o}olStyleToCesium(t,e,i){const n=e.getFill(),s=e.getStroke();if(i&&!s||!i&&!n)return null;const o=i?s.getColor():n.getColor(),a=f3(o),l=s.getLineDash();return i&&l?Cesium.Material.fromType("PolylineDash",{dashPattern:Oet(l),color:a}):Cesium.Material.fromType("Color",{color:a})}computePlainStyle(t,e,i,n){const s=e.getStyleFunction();let o=null;return s&&(o=s(e,n)),!o&&i&&(o=i(e,n)),o?Array.isArray(o)?o:[o]:null}getGeometryFromFeature(t,e,i){if(i)return i;const n=t.get("olcs_3d_geometry");if(n&&n instanceof Kg)return n;if(e){const s=e.getGeometryFunction()(t);if(s instanceof Kg)return s}return t.getGeometry()}olFeatureToCesium(t,e,i,n,s){const o=this.getGeometryFromFeature(e,i,s);if(!o)return null;const a=n.projection,l=function(c){const h=n.featureToCesiumMap[pr(e)];h instanceof Array?h.push(c):n.featureToCesiumMap[pr(e)]=[c]};switch(o.getType()){case"GeometryCollection":const c=new Cesium.PrimitiveCollection;return o.getGeometriesArray().forEach(d=>{if(d){const g=this.olFeatureToCesium(t,e,i,n,d);g&&c.add(g)}}),c;case"Point":const h=n.billboards;return this.olPointGeometryToCesium(t,e,o,a,i,h,l)||null;case"Circle":return this.olCircleGeometryToCesium(t,e,o,a,i);case"LineString":return this.olLineStringGeometryToCesium(t,e,o,a,i);case"Polygon":return this.olPolygonGeometryToCesium(t,e,o,a,i);case"MultiPoint":return this.olMultiGeometryToCesium(t,e,o,a,i,n.billboards,l)||null;case"MultiLineString":return this.olMultiGeometryToCesium(t,e,o,a,i,n.billboards,l)||null;case"MultiPolygon":return this.olMultiGeometryToCesium(t,e,o,a,i,n.billboards,l)||null;case"LinearRing":throw new Error("LinearRing should only be part of polygon.");default:throw new Error(`Ol geom type not handled : ${o.getType()}`)}}olVectorLayerToCesium(t,e,i){const n=e.getProjection(),s=e.getResolution();if(s===void 0||!n)throw console.assert(!1,"View not ready"),new Error("View not ready");let o=t.getSource();o instanceof TE&&(o=o.getSource()),console.assert(o instanceof ls);const a=o.getFeatures(),l=new Aet(n,this.scene),c=l.context;for(let h=0;h<a.length;++h){const u=a[h];if(!u)continue;const d=t.getStyleFunction(),g=this.computePlainStyle(t,u,d,s);if(!g||!g.length)continue;let f=null;for(let p=0;p<g.length;p++){const m=this.olFeatureToCesium(t,u,g[p],c);if(m){if(!f)f=m;else if(m){let y=0,_;for(;_=m.get(y);)f.add(_),y++}}}f&&(i[pr(u)]=f,l.getRootPrimitive().add(f))}return l}convert(t,e,i,n){const s=e.getProjection(),o=e.getResolution();if(o==null||!s)return null;const a=t.getStyleFunction(),l=this.computePlainStyle(t,i,a,o);if(!l||!l.length)return null;n.projection=s;let c=null;for(let h=0;h<l.length;h++){const u=this.olFeatureToCesium(t,i,l[h],n);if(!c)c=u;else if(u){let d=0,g;for(;g=u.get(d);)c.add(g),d++}}return c}}function Oet(r){r.length<2&&(r=[1,1]);const t=r.length%2===0?r:[...r,...r],e=t.reduce((n,s)=>n+s,0)/16;let i=t.map((n,s)=>{const o=s%2===0?"1":"0";let a=Math.round(n/e);return s===0&&a===0&&(a=1),o.repeat(a)}).join("");return i.length<16?i=i.padEnd(16,"0"):i.length>16&&(i=i.substring(0,16)),i[15]==="1"&&(i=i.substring(0,15)+"0"),console.assert(i.length===16),parseInt(i,2)}class WL extends ME{converter;csAllPrimitives_;constructor(t,e,i){super(t,e),this.converter=i||new Let(e),this.csAllPrimitives_=new Cesium.PrimitiveCollection,e.primitives.add(this.csAllPrimitives_),this.csAllPrimitives_.destroyPrimitives=!1}addCesiumObject(t){console.assert(t);const e=t.getRootPrimitive();e.counterpart=t,this.csAllPrimitives_.add(t.getRootPrimitive())}destroyCesiumObject(t){t.getRootPrimitive().destroy()}removeSingleCesiumObject(t,e){t.destroy(),this.csAllPrimitives_.destroyPrimitives=e,this.csAllPrimitives_.remove(t.getRootPrimitive()),this.csAllPrimitives_.destroyPrimitives=!1}removeAllCesiumObjects(t){if(this.csAllPrimitives_.destroyPrimitives=t,t)for(let e=0;e<this.csAllPrimitives_.length;++e)this.csAllPrimitives_.get(e).counterpart.destroy();this.csAllPrimitives_.removeAll(),this.csAllPrimitives_.destroyPrimitives=!1}updateLayerVisibility(t,e){let i=!0;[t.layer].concat(t.parents).forEach(n=>{const s=n.getVisible();s!==void 0?i=i&&s:i=!1}),e.show=i}createSingleLayerCounterparts(t){const e=t.layer;if(!(e instanceof fs)||e instanceof pl)return null;console.assert(e instanceof Kc);let i=e.getSource();if(i instanceof TE&&(i=i.getSource()),!i)return null;console.assert(i instanceof ls),console.assert(this.view);const n=this.view,s={},o=this.converter.olVectorLayerToCesium(e,n,s),a=o.getRootPrimitive(),l=o.olListenKeys;[t.layer].concat(t.parents).forEach(u=>{l.push(u.on("change:visible",()=>{this.updateLayerVisibility(t,a)}))}),this.updateLayerVisibility(t,a);const c=u=>{const d=o.context,g=this.converter.convert(e,n,u,d);g&&(s[pr(u)]=g,a.add(g))},h=u=>{const d=pr(u),g=o.context,f=g.featureToCesiumMap[d];f&&(delete g.featureToCesiumMap[d],f.forEach(m=>{m instanceof Cesium.Billboard&&g.billboards.remove(m)}));const p=s[d];delete s[d],p&&a.remove(p)};return l.push(i.on("addfeature",u=>{console.assert(u.feature),c(u.feature)})),l.push(i.on("removefeature",u=>{console.assert(u.feature),h(u.feature)})),l.push(i.on("changefeature",u=>{const d=u.feature;console.assert(d),h(d),c(d)})),o?[o]:null}}function Fet(r){return r&&r.parentNode?r.parentNode.removeChild(r):null}function Net(r){for(;r.lastChild;)r.removeChild(r.lastChild)}function VL(r,t){const e=r.cloneNode();r.nodeName==="CANVAS"&&e.getContext("2d").drawImage(r,0,0),t&&t.appendChild(e),r.nodeType!==Node.TEXT_NODE&&e.addEventListener("click",n=>{r.dispatchEvent(new MouseEvent("click",n)),n.stopPropagation()});const i=r.childNodes;for(let n=0;n<i.length;n++)i[n]&&VL(i[n],e);return e}class Det extends wV{scenePostRenderListenerRemover_=null;scene_;synchronizer_;parent_;positionWGS84_;observer_;attributeObserver_=[];listenerKeys_;constructor(t){const e=t.parent;super(e.getOptions()),this.scene_=t.scene,this.synchronizer_=t.synchronizer,this.parent_=e,this.positionWGS84_=void 0,this.observer_=new MutationObserver(this.handleElementChanged.bind(this)),this.attributeObserver_=[],this.listenerKeys_=[];const i=n=>this.setPropertyFromEvent_(n);this.listenerKeys_.push(this.parent_.on("change:element",i)),this.listenerKeys_.push(this.parent_.on("change:offset",i)),this.listenerKeys_.push(this.parent_.on("change:position",i)),this.listenerKeys_.push(this.parent_.on("change:positioning",i)),this.setProperties(this.parent_.getProperties()),this.handleMapChanged(),this.handleElementChanged(),this.handlePositionChanged()}observeTarget_(t){if(this.observer_){this.observer_.disconnect(),this.observer_.observe(t,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),this.attributeObserver_.forEach(e=>{e.disconnect()}),this.attributeObserver_.length=0;for(let e=0;e<t.childNodes.length;e++){const i=t.childNodes[e];if(i.nodeType===1){const n=new MutationObserver(this.handleElementChanged.bind(this));n.observe(i,{attributes:!0,subtree:!0}),this.attributeObserver_.push(n)}}}}setPropertyFromEvent_(t){t.target&&t.key&&this.set(t.key,t.target.get(t.key))}getScene(){return this.scene_}handleMapChanged(){this.scenePostRenderListenerRemover_&&(this.scenePostRenderListenerRemover_(),Fet(this.element)),this.scenePostRenderListenerRemover_=null;const t=this.getScene();if(t){this.scenePostRenderListenerRemover_=t.postRender.addEventListener(this.updatePixelPosition.bind(this)),this.updatePixelPosition();const e=this.stopEvent?this.synchronizer_.getOverlayContainerStopEvent():this.synchronizer_.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}}handlePositionChanged(){if(!this.parent_)return;const t=this.getPosition();if(t){const e=this.parent_.getMap().getView().getProjection();this.positionWGS84_=qs(t,e,"EPSG:4326")}else this.positionWGS84_=void 0;this.updatePixelPosition()}handleElementChanged(){Net(this.element);const t=this.getElement();if(t&&t.parentNode&&t.parentNode.childNodes)for(const e of Array.from(t.parentNode.childNodes)){const i=VL(e,null);this.element.appendChild(i)}t.parentNode&&this.observeTarget_(t.parentNode)}updatePixelPosition(){const t=this.positionWGS84_;if(!this.scene_||!t){this.setVisible(!1);return}let e=0;if(t.length===2){const c=this.scene_.globe.getHeight(Cesium.Cartographic.fromDegrees(t[0],t[1]));c&&this.scene_.globe.tilesLoaded&&(t[2]=c),c&&(e=c)}else e=t[2];const i=Cesium.Cartesian3.fromDegrees(t[0],t[1],e),n=this.scene_.camera,s=new Cesium.BoundingSphere(new Cesium.Cartesian3,6356752);if(!new Cesium.Occluder(s,n.position).isPointVisible(i)){this.setVisible(!1);return}if(n.frustum.computeCullingVolume(n.position,n.direction,n.up).computeVisibility(new Cesium.BoundingSphere(i))!==1){this.setVisible(!1);return}this.setVisible(!0);const o=this.scene_.cartesianToCanvasCoordinates(i),a=[o.x,o.y],l=[this.scene_.canvas.width,this.scene_.canvas.height];this.updateRenderedPosition(a,l)}destroy(){this.scenePostRenderListenerRemover_&&this.scenePostRenderListenerRemover_(),this.observer_&&this.observer_.disconnect(),ks(this.listenerKeys_),this.listenerKeys_.splice(0),"removeNode"in this.element?this.element.removeNode(!0):this.element.remove(),this.element=null}}class ZL{map;scene;overlayCollection_;overlayContainerStopEvent_;overlayContainer_;overlayMap_=new Map;overlayEvents=["click","dblclick","mousedown","touchstart","pointerdown","mousewheel","wheel"];listenerKeys_=[];constructor(t,e){this.map=t,this.scene=e,this.map=t,this.overlayCollection_=this.map.getOverlays(),this.scene=e,this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.overlayEvents.forEach(i=>{this.overlayContainerStopEvent_.addEventListener(i,n=>n.stopPropagation())}),this.scene.canvas.parentElement.appendChild(this.overlayContainerStopEvent_),this.overlayContainer_=document.createElement("div"),this.overlayContainer_.className="ol-overlaycontainer",this.scene.canvas.parentElement.appendChild(this.overlayContainer_)}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOverlayContainer(){return this.overlayContainer_}synchronize(){this.destroyAll(),this.overlayCollection_.forEach(t=>{this.addOverlay(t)}),this.listenerKeys_.push(this.overlayCollection_.on("add",t=>this.addOverlay(t.element))),this.listenerKeys_.push(this.overlayCollection_.on("remove",t=>this.removeOverlay(t.element)))}addOverlay(t){if(!t)return;const e=new Det({scene:this.scene,synchronizer:this,parent:t});this.overlayMap_.set(pr(t),e)}removeOverlay(t){const e=pr(t),i=this.overlayMap_.get(e);i&&(i.destroy(),this.overlayMap_.delete(e))}destroyAll(){this.overlayMap_.forEach(t=>{t.destroy()}),this.overlayMap_.clear(),ks(this.listenerKeys_),this.listenerKeys_.length=0}}const yv={DONE:0,PENDING:1,FAILED:2};class RE{autoRenderLoop_=null;map_;time_;to4326Transform_;resolutionScale_=1;canvasClientWidth_=0;canvasClientHeight_=0;resolutionScaleChanged_=!0;container_;isOverMap_;canvas_;enabled_=!1;pausedInteractions_=[];hiddenRootGroup_=null;scene_;camera_;globe_;dataSourceCollection_;dataSourceDisplay_;lastFrameTime_=0;renderId_;targetFrameRate_=Number.POSITIVE_INFINITY;blockCesiumRendering_=!1;warmingUp_=!1;trackedFeature_=null;trackedEntity_=null;entityView_=null;needTrackedEntityUpdate_=!1;boundingSphereScratch_=new Cesium.BoundingSphere;synchronizers_;refresh2DAfterCameraMoveEndOnly=!1;moveEndRemoveCallback_;constructor(t){this.map_=t.map,this.time_=t.time||function(){return Cesium.JulianDate.now()},this.to4326Transform_=yo(this.map_.getView().getProjection(),"EPSG:4326");const e="position:absolute;top:0;left:0;width:100%;height:100%;touch-action:none;";this.container_=document.createElement("DIV");const i=document.createAttribute("style");i.value=`${e}visibility:hidden;`,this.container_.setAttributeNode(i);let n=t.target||this.map_.getViewport();if(typeof n=="string"&&(n=document.getElementById(n)),n.appendChild(this.container_),this.isOverMap_=!t.target,this.isOverMap_&&t.stopOpenLayersEventsPropagation){const c=["click","dblclick","mousedown","touchstart","pointerdown","mousewheel","wheel"];for(let h=0,u=c.length;h<u;++h)this.container_.addEventListener(c[h],d=>d.stopPropagation())}this.canvas_=document.createElement("canvas");const s=document.createAttribute("style");s.value=e,this.canvas_.setAttributeNode(s),W2()&&(this.canvas_.style.imageRendering=het()),this.canvas_.oncontextmenu=function(){return!1},this.canvas_.onselectstart=function(){return!1},this.container_.appendChild(this.canvas_);const o=t.sceneOptions!==void 0?{...t.sceneOptions,canvas:this.canvas_,scene3DOnly:!0}:{canvas:this.canvas_,scene3DOnly:!0};this.scene_=new Cesium.Scene(o);const a=this.scene_.screenSpaceCameraController;Array.isArray(a.tiltEventTypes)?(a.tiltEventTypes.push({eventType:Cesium.CameraEventType.LEFT_DRAG,modifier:Cesium.KeyboardEventModifier.SHIFT}),a.tiltEventTypes.push({eventType:Cesium.CameraEventType.LEFT_DRAG,modifier:Cesium.KeyboardEventModifier.ALT})):console.log("sscc is not an array"),a.enableLook=!1,this.scene_.camera.constrainedAxis=Cesium.Cartesian3.UNIT_Z,this.camera_=new Iet(this.scene_,this.map_),this.globe_=new Cesium.Globe(Cesium.Ellipsoid.WGS84),this.globe_.baseColor=Cesium.Color.WHITE,this.scene_.globe=this.globe_,this.scene_.skyAtmosphere=new Cesium.SkyAtmosphere;const l=new Cesium.SingleTileImageryProvider({tileHeight:1,tileWidth:1,url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",rectangle:Cesium.Rectangle.fromDegrees(0,0,1,1)});this.globe_.imageryLayers.addImageryProvider(l,0),this.dataSourceCollection_=new Cesium.DataSourceCollection,this.dataSourceDisplay_=new Cesium.DataSourceDisplay({scene:this.scene_,dataSourceCollection:this.dataSourceCollection_}),this.synchronizers_=t.createSynchronizers?t.createSynchronizers(this.map_,this.scene_,this.dataSourceCollection_):[new Pet(this.map_,this.scene_),new WL(this.map_,this.scene_),new ZL(this.map_,this.scene_)],this.handleResize_();for(let c=this.synchronizers_.length-1;c>=0;--c)this.synchronizers_[c].synchronize();new Cesium.EventHelper().add(this.scene_.postRender,RE.prototype.updateTrackedEntity_,this),this.moveEndRemoveCallback_=this.scene_.camera.moveEnd.addEventListener(()=>{this.refresh2DAfterCameraMoveEndOnly&&this.camera_.checkCameraChange()})}destroy(){cancelAnimationFrame(this.renderId_),this.renderId_=void 0,this.synchronizers_.forEach(t=>t.destroyAll()),this.camera_.destroy(),this.scene_.destroy(),this.scene_._postRender=null,this.moveEndRemoveCallback_(),this.container_.remove()}render_(){this.renderId_!==void 0&&(cancelAnimationFrame(this.renderId_),this.renderId_=void 0),(this.enabled_||this.warmingUp_)&&!this.blockCesiumRendering_&&(this.renderId_=requestAnimationFrame(this.onAnimationFrame_.bind(this)))}onAnimationFrame_(t){this.renderId_=void 0;const e=1e3/this.targetFrameRate_;if(t-this.lastFrameTime_<e){this.render_();return}this.lastFrameTime_=t;const i=this.time_();if(this.scene_.initializeFrame(),this.handleResize_(),this.dataSourceDisplay_.update(i),this.entityView_){const n=this.trackedEntity_;this.dataSourceDisplay_.getBoundingSphere(n,!1,this.boundingSphereScratch_)===yv.DONE&&(this.boundingSphereScratch_.radius=1,this.entityView_.update(i,this.boundingSphereScratch_))}this.scene_.render(i),this.refresh2DAfterCameraMoveEndOnly||this.camera_.checkCameraChange(),this.render_()}updateTrackedEntity_(){if(!this.needTrackedEntityUpdate_)return;const t=this.trackedEntity_,e=this.scene_,i=this.dataSourceDisplay_.getBoundingSphere(t,!1,this.boundingSphereScratch_);if(i===yv.PENDING)return;e.screenSpaceCameraController.enableTilt=!1;const n=i!==yv.FAILED?this.boundingSphereScratch_:void 0;n&&(n.radius=1),this.entityView_=new Cesium.EntityView(t,e,e.mapProjection.ellipsoid),this.entityView_.update(this.time_(),n),this.needTrackedEntityUpdate_=!1}handleResize_(){let t=this.canvas_.clientWidth,e=this.canvas_.clientHeight;if(t===0||e===0||t===this.canvasClientWidth_&&e===this.canvasClientHeight_&&!this.resolutionScaleChanged_)return;let i=this.resolutionScale_;W2()||(i*=window.devicePixelRatio||1),this.resolutionScaleChanged_=!1,this.canvasClientWidth_=t,this.canvasClientHeight_=e,t*=i,e*=i,this.canvas_.width=t,this.canvas_.height=e,this.scene_.camera.frustum.aspectRatio=t/e}getCamera(){return this.camera_}getOlMap(){return this.map_}getOlView(){const t=this.map_.getView();return console.assert(t),t}getCesiumScene(){return this.scene_}getDataSources(){return this.dataSourceCollection_}getDataSourceDisplay(){return this.dataSourceDisplay_}getEnabled(){return this.enabled_}setEnabled(t){if(this.enabled_===t)return;this.enabled_=t,this.container_.style.visibility=this.enabled_?"visible":"hidden";let e;if(this.enabled_){if(this.throwOnUnitializedMap_(),this.isOverMap_){e=this.map_.getInteractions(),e.forEach((n,s,o)=>{this.pausedInteractions_.push(n)}),e.clear(),this.map_.addInteraction=n=>this.pausedInteractions_.push(n),this.map_.removeInteraction=n=>{let s=!1;return this.pausedInteractions_=this.pausedInteractions_.filter(o=>{const a=o!==n;return s||(s=a),a}),s?n:void 0};const i=this.map_.getLayerGroup();i.getVisible()&&(this.hiddenRootGroup_=i,this.hiddenRootGroup_.setVisible(!1)),this.map_.getOverlayContainer().classList.add("olcs-hideoverlay")}this.camera_.readFromView(),this.render_()}else this.isOverMap_&&(e=this.map_.getInteractions(),this.pausedInteractions_.forEach(i=>{e.push(i)}),this.pausedInteractions_.length=0,this.map_.addInteraction=i=>this.map_.getInteractions().push(i),this.map_.removeInteraction=i=>this.map_.getInteractions().remove(i),this.map_.getOverlayContainer().classList.remove("olcs-hideoverlay"),this.hiddenRootGroup_&&(this.hiddenRootGroup_.setVisible(!0),this.hiddenRootGroup_=null)),this.camera_.updateView()}warmUp(t,e){if(this.enabled_)return;this.throwOnUnitializedMap_(),this.camera_.readFromView();const i=this.globe_.ellipsoid,n=this.scene_.camera,s=i.cartesianToCartographic(n.position);s.height<t&&(s.height=t,n.position=i.cartographicToCartesian(s)),this.warmingUp_=!0,this.render_(),setTimeout(()=>{this.warmingUp_=!1},e)}setBlockCesiumRendering(t){this.blockCesiumRendering_!==t&&(this.blockCesiumRendering_=t,this.render_())}enableAutoRenderLoop(){this.autoRenderLoop_||(this.autoRenderLoop_=new Ret(this))}getAutoRenderLoop(){return this.autoRenderLoop_}setResolutionScale(t){t=Math.max(0,t),t!==this.resolutionScale_&&(this.resolutionScale_=Math.max(0,t),this.resolutionScaleChanged_=!0,this.autoRenderLoop_&&this.autoRenderLoop_.restartRenderLoop())}setTargetFrameRate(t){this.targetFrameRate_!==t&&(this.targetFrameRate_=t,this.render_())}setRefresh2DAfterCameraMoveEndOnly(t){this.refresh2DAfterCameraMoveEndOnly=t}throwOnUnitializedMap_(){const t=this.map_.getView(),e=t.getCenter();if(!t.isDef()||isNaN(e[0])||isNaN(e[1]))throw new Error(`The OpenLayers map is not properly initialized: ${e} / ${t.getResolution()}`)}get trackedFeature(){return this.trackedFeature_}set trackedFeature(t){if(this.trackedFeature_!==t){const e=this.scene_;if(!t||!t.getGeometry()){this.needTrackedEntityUpdate_=!1,e.screenSpaceCameraController.enableTilt=!0,this.trackedEntity_&&this.dataSourceDisplay_.defaultDataSource.entities.remove(this.trackedEntity_),this.trackedEntity_=null,this.trackedFeature_=null,this.entityView_=null,e.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);return}this.trackedFeature_=t,this.needTrackedEntityUpdate_=!0;const i=this.to4326Transform_,n=function(){const o=t.getGeometry();console.assert(o instanceof Pi);const a=o instanceof Pi?o.getCoordinates():[],l=i(a,void 0,a.length);return Xh(l)},s={position:new Cesium.CallbackProperty((o,a)=>n(),!1),point:{pixelSize:1,color:Cesium.Color.TRANSPARENT}};this.trackedEntity_=this.dataSourceDisplay_.defaultDataSource.entities.add(s)}}}class $et extends ZL{constructor(t,e){super(t,e)}addOverlays(){this.overlays_.forEach(t=>{t.getId()!==void 0&&this.addOverlay(t)})}}function Get(r){const t=r.load||w1,e=r.imageExtent,i=r.crossOrigin??null;return()=>{const n=new Image;return n.crossOrigin=i,r.referrerPolicy!==void 0&&(n.referrerPolicy=r.referrerPolicy),t(n,r.url).then(s=>{const o=Te(e)/s.width,a=ti(e)/s.height;return{image:s,extent:e,resolution:o!==a?[o,a]:a,pixelRatio:1}})}}class jet extends oA{constructor(t){const e=t.crossOrigin!==void 0?t.crossOrigin:null,i=t.imageLoadFunction!==void 0?t.imageLoadFunction:aA;super({attributions:t.attributions,interpolate:t.interpolate,projection:Wt(t.projection)}),this.url_=t.url,this.imageExtent_=t.imageExtent,this.image=null,this.image=new nb(this.imageExtent_,void 0,1,Get({url:t.url,imageExtent:t.imageExtent,crossOrigin:e,referrerPolicy:t.referrerPolicy,load:(n,s)=>(this.image.setImage(n),i(this.image,s),w1(n))})),this.image.addEventListener(Bt.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(t,e,i,n){return zr(t,this.image.getExtent())?this.image:null}getUrl(){return this.url_}}class zet extends ME{constructor(t,e){super(t,e),this.cesiumLayers=e.imageryLayers,this.ourLayers=new Cesium.ImageryLayerCollection}addCesiumObject(t){this.cesiumLayers.add(t),this.ourLayers.add(t)}destroyCesiumObject(t){t.destroy()}removeSingleCesiumObject(t,e){this.cesiumLayers.remove(t,e),this.ourLayers.remove(t,!1)}removeAllCesiumObjects(t){for(let e=0;e<this.ourLayers.length;++e)this.cesiumLayers.remove(this.ourLayers.get(e),t);this.ourLayers.removeAll(!1)}convertLayerToCesiumImageries(t,e){const i={show:!1};let n={},s={},o=null;if(!(t instanceof Pk)&&!(t instanceof JP))return null;if(n=t.getSource(),n instanceof uA)o=this.createProviderForTileWMS(n,e,t);else{if(n instanceof dA)return s=this.createImageryLayerForImageWMS(t,e),s?[s]:null;if(n instanceof jet)o=this.createProviderForStaticImageSource(n);else if(n instanceof H1){if(typeof n.getUrls!="function"||!Array.isArray(n.getUrls()))return null;o=new Cesium.WebMapTileServiceImageryProvider({url:n.getUrls()[0],format:n.getFormat(),layer:n.getLayer(),style:n.getStyle(),tileMatrixSetID:n.getMatrixSet(),tileMatrixLabels:n.getTileGrid().getMatrixIds(),credit:n.getAttributions()})}else return console.warn("Sources other than TileImage are currently not supported."),null}return s=new Cesium.ImageryLayer(o,i),s?[s]:null}createProviderForTileWMS(t,e,i){const n=t.getParams(),s={url:t.getUrls()[0],parameters:n,layers:n.LAYERS,show:!1,tilingScheme:new Cesium.WebMercatorTilingScheme},o=t.getTileGrid();if(typeof n.CQL_FILTER>"u"&&delete n.CQL_FILTER,o){const a=i.getExtent();if(a&&e){s.rectangle=CE(a,e);const l=this.getMinMaxLevelFromTileGrid(o,a,e);s.tileWidth=o.getTileSize(0)[0],s.tileHeight=o.getTileSize(0)[1],s.minimumLevel=l[0],s.maximumLevel=l[1]}}return new Cesium.WebMapServiceImageryProvider(s)}createImageryLayerForImageWMS(t,e){return BL(this.map,t,e)}createProviderForStaticImageSource(t){const e=t.getImageExtent(),i={url:t.getUrl(),show:!1},n=as(t.getProjection().getCode(),"EPSG:4326",lc(e)),s=as(t.getProjection().getCode(),"EPSG:4326",cc(e));return i.rectangle=Cesium.Rectangle.fromDegrees(n[0],n[1],s[0],s[1]),new Cesium.SingleTileImageryProvider(i)}getExtentPoints(t,e){const i=dc(t,e,"EPSG:4326");return[lc(i),Tu(i),cc(i),_o(i)].map(n=>Cesium.Cartographic.fromDegrees(n[0],n[1]))}getMinMaxLevelFromTileGrid(t,e,i){const n=[lc(e),Tu(e),cc(e),_o(e)],s=t.getResolutions().slice(-1).pop(),o=n.map(g=>t.getTileCoordForCoordAndResolution(g,s)),a=Math.abs(o[0][1]-o[1][1]),l=Math.abs(o[0][2]-o[3][2]),c=this.getExtentPoints(e,i),h=new Cesium.GeographicTilingScheme({});let u=0,d=20;for(;u<d;){const g=c.map(p=>h.positionToTileXY(p,u)),f=[];if(f.push(Math.abs(g[0].x-g[1].x)),f.push(Math.abs(g[0].y-g[3].y)),f[0]>1||f[1]>1){u--;break}u++}for(;d>u;){const g=c.map(p=>h.positionToTileXY(p,d)),f=[];if(f.push(Math.abs(g[0].x-g[1].x)),f.push(Math.abs(g[0].y-g[3].y)),f[0]<a||f[1]<l){d++;break}d--}return[u,d]}createSingleLayerCounterparts(t){const e=t.layer,i=pr(e).toString(),n=this.view.getProjection(),s=this.convertLayerToCesiumImageries(e,n);if(s){const o=[];[t.layer].concat(t.parents).forEach(a=>{o.push(a.on(["change:opacity","change:visible"],()=>{console.assert(s);for(let l=0;l<s.length;++l)zm(t,s[l])}))});for(let a=0;a<s.length;++a)zm(t,s[a]);o.push(e.on("change:extent",function(){for(let a=0;a<s.length;++a)this.cesiumLayers.remove(s[a],!0),this.ourLayers.remove(s[a],!1);delete this.layerMap[pr(e)],this.synchronize()},this)),o.push(e.on("change",(function(){for(let a=0;a<s.length;++a){const l=this.cesiumLayers.indexOf(s[a]);l>=0&&(this.cesiumLayers.remove(s[a],!1),this.cesiumLayers.add(s[a],l))}}).bind(this))),this.olLayerListenKeys[i].push(...o)}return Array.isArray(s)?s:null}orderLayers(){const t=[],e={},i=[this.mapLayerGroup];for(;i.length>0;){const n=i.splice(0,1)[0];if(t.push(n),e[pr(n)]=n.getZIndex(),n instanceof eh){const s=n.getLayers();s&&i.unshift(...s.getArray())}}PF(t,(n,s)=>e[pr(n)]-e[pr(s)]),t.forEach(function(n){const s=pr(n).toString(),o=this.layerMap[s];o&&o.forEach(this.raiseToTop,this)},this)}raiseToTop(t){this.cesiumLayers.raiseToTop(t)}}let qet=0;function gf(r,t){if(!r||!t||typeof t!="object"){console.warn("setCesiumSceneParams: Invalid scene or params.");return}Object.entries(t).forEach(([e,i])=>{["0","1","2","heading","tilt","altitude","pitch"].includes(e)||(typeof i=="object"&&r[e]?gf(r[e],i):r[e]=i)})}function HL(r,t,e){if(!r||!t){console.warn("setCameraParameter: Missing parameters or map3D instance.");return}let i=t.getCesiumScene()?.camera;const n=parseFloat(r.heading??r.camera?.heading??0),s=parseFloat(r.pitch??r.camera?.pitch??0),o=parseFloat(r.roll??0),a=parseFloat(r.tilt??r.camera?.tilt??0),l=parseFloat(r.altitude??r.camera?.altitude??0);if(r.cameraPosition||r.camera?.cameraPosition){const c=r.cameraPosition??r.camera.cameraPosition,h=e.Cartesian3.fromDegrees(c[0],c[1],c[2]),u={heading:e.Math.toRadians(n),pitch:e.Math.toRadians(s),roll:e.Math.toRadians(o)};r.cameraPosition?i.setView({destination:h,orientation:u}):i.flyTo({destination:h,orientation:u});return}i=t.getCamera(),a&&i.setTilt(a),n&&i.setHeading(n),l&&i.setAltitude(l)}function YL(r){const t=new RE({map:r.map2D,time:r?.shadowTime,stopOpenLayersEventsPropagation:!0,createSynchronizers:(e,i)=>[new zet(e,i),new WL(e,i),new $et(e,i)]});return t.id=`map3D_${qet++}`,t.mapMode="3D",gf(t.getCesiumScene(),Vi.sceneOptions),r?.cesiumParameter&&(gf(t.getCesiumScene(),r.cesiumParameter),HL(r.cesiumParameter,t,Cesium)),t}function Bet(r){const t=this.scene,e=t.camera.getPickRay(r.position),i=t.globe.pick(e,t),n=this.map3D.getOlView().getProjection();let s,o,a,l,c,h,u,d,g,f;if(i){if(document.querySelector(".nav li")?.classList.contains("open")&&document.querySelector(".nav li").classList.remove("open"),a=t.globe.ellipsoid.cartesianToCartographic(i),o=[Cesium.Math.toDegrees(a.longitude),Cesium.Math.toDegrees(a.latitude)],s=t.globe.getHeight(a),s&&(o=o.concat([s])),l=Cesium.Cartesian3.distance(i,t.camera.position),c=this.map3D.getCamera().calcResolutionForDistance(l,a.latitude),h=Mu(o,Wt("EPSG:4326"),n),u=null,t.pickPositionSupported){const p=t.pick(r.position);d=t.pickPosition(r.position),!d&&p?.primitive instanceof window.Cesium.Billboard&&(d=p.primitive?.position),d&&(g=t.globe.ellipsoid.cartesianToCartographic(d),u=Mu([Cesium.Math.toDegrees(g.longitude),Cesium.Math.toDegrees(g.latitude)],Wt("EPSG:4326"),n),u.push(g.height))}f={map3D:this,position:r.position,pickedPosition:u,coordinate:h,latitude:o[0],longitude:o[1],resolution:c,originalEvent:r}}return this.callback(f)}function Uet(r){let t;Cesium&&(t=new Cesium.ScreenSpaceEventHandler(r.scene.canvas),t.setInputAction(Bet.bind(r),Cesium.ScreenSpaceEventType.LEFT_CLICK))}function Wet(r,t,e){const i=r.camera;let n=Object.prototype.hasOwnProperty.call(e,"cameraParameter")?e.cameraParameter:{};return n=t?.altitude?Object.assign(n||{},{altitude:t?.altitude}):n,n=t?.heading?Object.assign(n||{},{heading:t?.heading}):n,n=t?.tilt?Object.assign(n||{},{tilt:t?.tilt}):n,Object.keys(n).length>0&&gf(r,{camera:n}),i}const Vet=Object.freeze(Object.defineProperty({__proto__:null,createMap:YL,handle3DEvents:Uet,prepareCamera:Wet,setCameraParameter:HL,setCesiumSceneParams:gf},Symbol.toStringTag,{value:"Module"})),Zet={createMap:function(r,t="2D",e={}){return{"2D":cet,"3D":YL}[t](r,e)},olcsMap:Vet},Het={map:Zet};var m3={exports:{}},y3;function Yet(){return y3||(y3=1,(function(r){(function(t,e,i,n){var s=["","webkit","Moz","MS","ms","o"],o=e.createElement("div"),a="function",l=Math.round,c=Math.abs,h=Date.now;function u(k,M,G){return setTimeout(x(k,G),M)}function d(k,M,G){return Array.isArray(k)?(g(k,G[M],G),!0):!1}function g(k,M,G){var Z;if(k)if(k.forEach)k.forEach(M,G);else if(k.length!==n)for(Z=0;Z<k.length;)M.call(G,k[Z],Z,k),Z++;else for(Z in k)k.hasOwnProperty(Z)&&M.call(G,k[Z],Z,k)}function f(k,M,G){var Z="DEPRECATED METHOD: "+M+`
`+G+` AT 
`;return function(){var at=new Error("get-stack-trace"),Zt=at&&at.stack?at.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ie=t.console&&(t.console.warn||t.console.log);return Ie&&Ie.call(t.console,Z,Zt),k.apply(this,arguments)}}var p;typeof Object.assign!="function"?p=function(k){if(k===n||k===null)throw new TypeError("Cannot convert undefined or null to object");for(var M=Object(k),G=1;G<arguments.length;G++){var Z=arguments[G];if(Z!==n&&Z!==null)for(var at in Z)Z.hasOwnProperty(at)&&(M[at]=Z[at])}return M}:p=Object.assign;var m=f(function(k,M,G){for(var Z=Object.keys(M),at=0;at<Z.length;)(!G||G&&k[Z[at]]===n)&&(k[Z[at]]=M[Z[at]]),at++;return k},"extend","Use `assign`."),y=f(function(k,M){return m(k,M,!0)},"merge","Use `assign`.");function _(k,M,G){var Z=M.prototype,at;at=k.prototype=Object.create(Z),at.constructor=k,at._super=Z,G&&p(at,G)}function x(k,M){return function(){return k.apply(M,arguments)}}function v(k,M){return typeof k==a?k.apply(M&&M[0]||n,M):k}function w(k,M){return k===n?M:k}function b(k,M,G){g(R(M),function(Z){k.addEventListener(Z,G,!1)})}function E(k,M,G){g(R(M),function(Z){k.removeEventListener(Z,G,!1)})}function C(k,M){for(;k;){if(k==M)return!0;k=k.parentNode}return!1}function S(k,M){return k.indexOf(M)>-1}function R(k){return k.trim().split(/\s+/g)}function I(k,M,G){if(k.indexOf&&!G)return k.indexOf(M);for(var Z=0;Z<k.length;){if(G&&k[Z][G]==M||!G&&k[Z]===M)return Z;Z++}return-1}function F(k){return Array.prototype.slice.call(k,0)}function N(k,M,G){for(var Z=[],at=[],Zt=0;Zt<k.length;){var Ie=k[Zt][M];I(at,Ie)<0&&Z.push(k[Zt]),at[Zt]=Ie,Zt++}return Z=Z.sort(function(Mr,ys){return Mr[M]>ys[M]}),Z}function P(k,M){for(var G,Z,at=M[0].toUpperCase()+M.slice(1),Zt=0;Zt<s.length;){if(G=s[Zt],Z=G?G+at:M,Z in k)return Z;Zt++}return n}var T=1;function D(){return T++}function A(k){var M=k.ownerDocument||k;return M.defaultView||M.parentWindow||t}var $=/mobile|tablet|ip(ad|hone|od)|android/i,z="ontouchstart"in t,j=P(t,"PointerEvent")!==n,et=z&&$.test(navigator.userAgent),q="touch",vt="pen",jt="mouse",V="kinect",It=25,Et=1,Mt=2,Ot=4,Y=8,We=1,L=2,O=4,U=8,X=16,W=L|O,K=U|X,it=W|K,ot=["x","y"],rt=["clientX","clientY"];function H(k,M){var G=this;this.manager=k,this.callback=M,this.element=k.element,this.target=k.options.inputTarget,this.domHandler=function(Z){v(k.options.enable,[k])&&G.handler(Z)},this.init()}H.prototype={handler:function(){},init:function(){this.evEl&&b(this.element,this.evEl,this.domHandler),this.evTarget&&b(this.target,this.evTarget,this.domHandler),this.evWin&&b(A(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(A(this.element),this.evWin,this.domHandler)}};function ut(k){var M,G=k.options.inputClass;return G?M=G:j?M=an:et?M=xe:z?M=oi:M=er,new M(k,mt)}function mt(k,M,G){var Z=G.pointers.length,at=G.changedPointers.length,Zt=M&Et&&Z-at===0,Ie=M&(Ot|Y)&&Z-at===0;G.isFirst=!!Zt,G.isFinal=!!Ie,Zt&&(k.session={}),G.eventType=M,dt(k,G),k.emit("hammer.input",G),k.recognize(G),k.session.prevInput=G}function dt(k,M){var G=k.session,Z=M.pointers,at=Z.length;G.firstInput||(G.firstInput=Dt(M)),at>1&&!G.firstMultiple?G.firstMultiple=Dt(M):at===1&&(G.firstMultiple=!1);var Zt=G.firstInput,Ie=G.firstMultiple,Mr=Ie?Ie.center:Zt.center,ys=M.center=wt(Z);M.timeStamp=h(),M.deltaTime=M.timeStamp-Zt.timeStamp,M.angle=Ce(Mr,ys),M.distance=ve(Mr,ys),pt(G,M),M.offsetDirection=Jt(M.deltaX,M.deltaY);var Mn=zt(M.deltaTime,M.deltaX,M.deltaY);M.overallVelocityX=Mn.x,M.overallVelocityY=Mn.y,M.overallVelocity=c(Mn.x)>c(Mn.y)?Mn.x:Mn.y,M.scale=Ie?qr(Ie.pointers,Z):1,M.rotation=Ie?Ve(Ie.pointers,Z):0,M.maxPointers=G.prevInput?M.pointers.length>G.prevInput.maxPointers?M.pointers.length:G.prevInput.maxPointers:M.pointers.length,kt(G,M);var Us=k.element;C(M.srcEvent.target,Us)&&(Us=M.srcEvent.target),M.target=Us}function pt(k,M){var G=M.center,Z=k.offsetDelta||{},at=k.prevDelta||{},Zt=k.prevInput||{};(M.eventType===Et||Zt.eventType===Ot)&&(at=k.prevDelta={x:Zt.deltaX||0,y:Zt.deltaY||0},Z=k.offsetDelta={x:G.x,y:G.y}),M.deltaX=at.x+(G.x-Z.x),M.deltaY=at.y+(G.y-Z.y)}function kt(k,M){var G=k.lastInterval||M,Z=M.timeStamp-G.timeStamp,at,Zt,Ie,Mr;if(M.eventType!=Y&&(Z>It||G.velocity===n)){var ys=M.deltaX-G.deltaX,Mn=M.deltaY-G.deltaY,Us=zt(Z,ys,Mn);Zt=Us.x,Ie=Us.y,at=c(Us.x)>c(Us.y)?Us.x:Us.y,Mr=Jt(ys,Mn),k.lastInterval=M}else at=G.velocity,Zt=G.velocityX,Ie=G.velocityY,Mr=G.direction;M.velocity=at,M.velocityX=Zt,M.velocityY=Ie,M.direction=Mr}function Dt(k){for(var M=[],G=0;G<k.pointers.length;)M[G]={clientX:l(k.pointers[G].clientX),clientY:l(k.pointers[G].clientY)},G++;return{timeStamp:h(),pointers:M,center:wt(M),deltaX:k.deltaX,deltaY:k.deltaY}}function wt(k){var M=k.length;if(M===1)return{x:l(k[0].clientX),y:l(k[0].clientY)};for(var G=0,Z=0,at=0;at<M;)G+=k[at].clientX,Z+=k[at].clientY,at++;return{x:l(G/M),y:l(Z/M)}}function zt(k,M,G){return{x:M/k||0,y:G/k||0}}function Jt(k,M){return k===M?We:c(k)>=c(M)?k<0?L:O:M<0?U:X}function ve(k,M,G){G||(G=ot);var Z=M[G[0]]-k[G[0]],at=M[G[1]]-k[G[1]];return Math.sqrt(Z*Z+at*at)}function Ce(k,M,G){G||(G=ot);var Z=M[G[0]]-k[G[0]],at=M[G[1]]-k[G[1]];return Math.atan2(at,Z)*180/Math.PI}function Ve(k,M){return Ce(M[1],M[0],rt)+Ce(k[1],k[0],rt)}function qr(k,M){return ve(M[0],M[1],rt)/ve(k[0],k[1],rt)}var Pe={mousedown:Et,mousemove:Mt,mouseup:Ot},le="mousedown",Cr="mousemove mouseup";function er(){this.evEl=le,this.evWin=Cr,this.pressed=!1,H.apply(this,arguments)}_(er,H,{handler:function(k){var M=Pe[k.type];M&Et&&k.button===0&&(this.pressed=!0),M&Mt&&k.which!==1&&(M=Ot),this.pressed&&(M&Ot&&(this.pressed=!1),this.callback(this.manager,M,{pointers:[k],changedPointers:[k],pointerType:jt,srcEvent:k}))}});var Br={pointerdown:Et,pointermove:Mt,pointerup:Ot,pointercancel:Y,pointerout:Y},lr={2:q,3:vt,4:jt,5:V},Yr="pointerdown",Cn="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Yr="MSPointerDown",Cn="MSPointerMove MSPointerUp MSPointerCancel");function an(){this.evEl=Yr,this.evWin=Cn,H.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}_(an,H,{handler:function(k){var M=this.store,G=!1,Z=k.type.toLowerCase().replace("ms",""),at=Br[Z],Zt=lr[k.pointerType]||k.pointerType,Ie=Zt==q,Mr=I(M,k.pointerId,"pointerId");at&Et&&(k.button===0||Ie)?Mr<0&&(M.push(k),Mr=M.length-1):at&(Ot|Y)&&(G=!0),!(Mr<0)&&(M[Mr]=k,this.callback(this.manager,at,{pointers:M,changedPointers:[k],pointerType:Zt,srcEvent:k}),G&&M.splice(Mr,1))}});var Xr={touchstart:Et,touchmove:Mt,touchend:Ot,touchcancel:Y},qn="touchstart",ki="touchstart touchmove touchend touchcancel";function cr(){this.evTarget=qn,this.evWin=ki,this.started=!1,H.apply(this,arguments)}_(cr,H,{handler:function(k){var M=Xr[k.type];if(M===Et&&(this.started=!0),!!this.started){var G=Fr.call(this,k,M);M&(Ot|Y)&&G[0].length-G[1].length===0&&(this.started=!1),this.callback(this.manager,M,{pointers:G[0],changedPointers:G[1],pointerType:q,srcEvent:k})}}});function Fr(k,M){var G=F(k.touches),Z=F(k.changedTouches);return M&(Ot|Y)&&(G=N(G.concat(Z),"identifier")),[G,Z]}var _r={touchstart:Et,touchmove:Mt,touchend:Ot,touchcancel:Y},Nr="touchstart touchmove touchend touchcancel";function xe(){this.evTarget=Nr,this.targetIds={},H.apply(this,arguments)}_(xe,H,{handler:function(k){var M=_r[k.type],G=rr.call(this,k,M);G&&this.callback(this.manager,M,{pointers:G[0],changedPointers:G[1],pointerType:q,srcEvent:k})}});function rr(k,M){var G=F(k.touches),Z=this.targetIds;if(M&(Et|Mt)&&G.length===1)return Z[G[0].identifier]=!0,[G,G];var at,Zt,Ie=F(k.changedTouches),Mr=[],ys=this.target;if(Zt=G.filter(function(Mn){return C(Mn.target,ys)}),M===Et)for(at=0;at<Zt.length;)Z[Zt[at].identifier]=!0,at++;for(at=0;at<Ie.length;)Z[Ie[at].identifier]&&Mr.push(Ie[at]),M&(Ot|Y)&&delete Z[Ie[at].identifier],at++;if(Mr.length)return[N(Zt.concat(Mr),"identifier"),Mr]}var Ur=2500,ir=25;function oi(){H.apply(this,arguments);var k=x(this.handler,this);this.touch=new xe(this.manager,k),this.mouse=new er(this.manager,k),this.primaryTouch=null,this.lastTouches=[]}_(oi,H,{handler:function(k,M,G){var Z=G.pointerType==q,at=G.pointerType==jt;if(!(at&&G.sourceCapabilities&&G.sourceCapabilities.firesTouchEvents)){if(Z)ps.call(this,M,G);else if(at&&H6.call(this,G))return;this.callback(k,M,G)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ps(k,M){k&Et?(this.primaryTouch=M.changedPointers[0].identifier,ap.call(this,M)):k&(Ot|Y)&&ap.call(this,M)}function ap(k){var M=k.changedPointers[0];if(M.identifier===this.primaryTouch){var G={x:M.clientX,y:M.clientY};this.lastTouches.push(G);var Z=this.lastTouches,at=function(){var Zt=Z.indexOf(G);Zt>-1&&Z.splice(Zt,1)};setTimeout(at,Ur)}}function H6(k){for(var M=k.srcEvent.clientX,G=k.srcEvent.clientY,Z=0;Z<this.lastTouches.length;Z++){var at=this.lastTouches[Z],Zt=Math.abs(M-at.x),Ie=Math.abs(G-at.y);if(Zt<=ir&&Ie<=ir)return!0}return!1}var dS=P(o.style,"touchAction"),gS=dS!==n,fS="compute",pS="auto",$y="manipulation",Pl="none",fd="pan-x",pd="pan-y",lp=X6();function Gy(k,M){this.manager=k,this.set(M)}Gy.prototype={set:function(k){k==fS&&(k=this.compute()),gS&&this.manager.element.style&&lp[k]&&(this.manager.element.style[dS]=k),this.actions=k.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var k=[];return g(this.manager.recognizers,function(M){v(M.options.enable,[M])&&(k=k.concat(M.getTouchAction()))}),Y6(k.join(" "))},preventDefaults:function(k){var M=k.srcEvent,G=k.offsetDirection;if(this.manager.session.prevented){M.preventDefault();return}var Z=this.actions,at=S(Z,Pl)&&!lp[Pl],Zt=S(Z,pd)&&!lp[pd],Ie=S(Z,fd)&&!lp[fd];if(at){var Mr=k.pointers.length===1,ys=k.distance<2,Mn=k.deltaTime<250;if(Mr&&ys&&Mn)return}if(!(Ie&&Zt)&&(at||Zt&&G&W||Ie&&G&K))return this.preventSrc(M)},preventSrc:function(k){this.manager.session.prevented=!0,k.preventDefault()}};function Y6(k){if(S(k,Pl))return Pl;var M=S(k,fd),G=S(k,pd);return M&&G?Pl:M||G?M?fd:pd:S(k,$y)?$y:pS}function X6(){if(!gS)return!1;var k={},M=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(G){k[G]=M?t.CSS.supports("touch-action",G):!0}),k}var cp=1,Bn=2,ih=4,xa=8,Co=xa,md=16,Bs=32;function Mo(k){this.options=p({},this.defaults,k||{}),this.id=D(),this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=cp,this.simultaneous={},this.requireFail=[]}Mo.prototype={defaults:{},set:function(k){return p(this.options,k),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(k){if(d(k,"recognizeWith",this))return this;var M=this.simultaneous;return k=hp(k,this),M[k.id]||(M[k.id]=k,k.recognizeWith(this)),this},dropRecognizeWith:function(k){return d(k,"dropRecognizeWith",this)?this:(k=hp(k,this),delete this.simultaneous[k.id],this)},requireFailure:function(k){if(d(k,"requireFailure",this))return this;var M=this.requireFail;return k=hp(k,this),I(M,k)===-1&&(M.push(k),k.requireFailure(this)),this},dropRequireFailure:function(k){if(d(k,"dropRequireFailure",this))return this;k=hp(k,this);var M=I(this.requireFail,k);return M>-1&&this.requireFail.splice(M,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(k){return!!this.simultaneous[k.id]},emit:function(k){var M=this,G=this.state;function Z(at){M.manager.emit(at,k)}G<xa&&Z(M.options.event+mS(G)),Z(M.options.event),k.additionalEvent&&Z(k.additionalEvent),G>=xa&&Z(M.options.event+mS(G))},tryEmit:function(k){if(this.canEmit())return this.emit(k);this.state=Bs},canEmit:function(){for(var k=0;k<this.requireFail.length;){if(!(this.requireFail[k].state&(Bs|cp)))return!1;k++}return!0},recognize:function(k){var M=p({},k);if(!v(this.options.enable,[this,M])){this.reset(),this.state=Bs;return}this.state&(Co|md|Bs)&&(this.state=cp),this.state=this.process(M),this.state&(Bn|ih|xa|md)&&this.tryEmit(M)},process:function(k){},getTouchAction:function(){},reset:function(){}};function mS(k){return k&md?"cancel":k&xa?"end":k&ih?"move":k&Bn?"start":""}function yS(k){return k==X?"down":k==U?"up":k==L?"left":k==O?"right":""}function hp(k,M){var G=M.manager;return G?G.get(k):k}function ms(){Mo.apply(this,arguments)}_(ms,Mo,{defaults:{pointers:1},attrTest:function(k){var M=this.options.pointers;return M===0||k.pointers.length===M},process:function(k){var M=this.state,G=k.eventType,Z=M&(Bn|ih),at=this.attrTest(k);return Z&&(G&Y||!at)?M|md:Z||at?G&Ot?M|xa:M&Bn?M|ih:Bn:Bs}});function up(){ms.apply(this,arguments),this.pX=null,this.pY=null}_(up,ms,{defaults:{event:"pan",threshold:10,pointers:1,direction:it},getTouchAction:function(){var k=this.options.direction,M=[];return k&W&&M.push(pd),k&K&&M.push(fd),M},directionTest:function(k){var M=this.options,G=!0,Z=k.distance,at=k.direction,Zt=k.deltaX,Ie=k.deltaY;return at&M.direction||(M.direction&W?(at=Zt===0?We:Zt<0?L:O,G=Zt!=this.pX,Z=Math.abs(k.deltaX)):(at=Ie===0?We:Ie<0?U:X,G=Ie!=this.pY,Z=Math.abs(k.deltaY))),k.direction=at,G&&Z>M.threshold&&at&M.direction},attrTest:function(k){return ms.prototype.attrTest.call(this,k)&&(this.state&Bn||!(this.state&Bn)&&this.directionTest(k))},emit:function(k){this.pX=k.deltaX,this.pY=k.deltaY;var M=yS(k.direction);M&&(k.additionalEvent=this.options.event+M),this._super.emit.call(this,k)}});function jy(){ms.apply(this,arguments)}_(jy,ms,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Pl]},attrTest:function(k){return this._super.attrTest.call(this,k)&&(Math.abs(k.scale-1)>this.options.threshold||this.state&Bn)},emit:function(k){if(k.scale!==1){var M=k.scale<1?"in":"out";k.additionalEvent=this.options.event+M}this._super.emit.call(this,k)}});function zy(){Mo.apply(this,arguments),this._timer=null,this._input=null}_(zy,Mo,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[pS]},process:function(k){var M=this.options,G=k.pointers.length===M.pointers,Z=k.distance<M.threshold,at=k.deltaTime>M.time;if(this._input=k,!Z||!G||k.eventType&(Ot|Y)&&!at)this.reset();else if(k.eventType&Et)this.reset(),this._timer=u(function(){this.state=Co,this.tryEmit()},M.time,this);else if(k.eventType&Ot)return Co;return Bs},reset:function(){clearTimeout(this._timer)},emit:function(k){this.state===Co&&(k&&k.eventType&Ot?this.manager.emit(this.options.event+"up",k):(this._input.timeStamp=h(),this.manager.emit(this.options.event,this._input)))}});function qy(){ms.apply(this,arguments)}_(qy,ms,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Pl]},attrTest:function(k){return this._super.attrTest.call(this,k)&&(Math.abs(k.rotation)>this.options.threshold||this.state&Bn)}});function By(){ms.apply(this,arguments)}_(By,ms,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:W|K,pointers:1},getTouchAction:function(){return up.prototype.getTouchAction.call(this)},attrTest:function(k){var M=this.options.direction,G;return M&(W|K)?G=k.overallVelocity:M&W?G=k.overallVelocityX:M&K&&(G=k.overallVelocityY),this._super.attrTest.call(this,k)&&M&k.offsetDirection&&k.distance>this.options.threshold&&k.maxPointers==this.options.pointers&&c(G)>this.options.velocity&&k.eventType&Ot},emit:function(k){var M=yS(k.offsetDirection);M&&this.manager.emit(this.options.event+M,k),this.manager.emit(this.options.event,k)}});function dp(){Mo.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}_(dp,Mo,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[$y]},process:function(k){var M=this.options,G=k.pointers.length===M.pointers,Z=k.distance<M.threshold,at=k.deltaTime<M.time;if(this.reset(),k.eventType&Et&&this.count===0)return this.failTimeout();if(Z&&at&&G){if(k.eventType!=Ot)return this.failTimeout();var Zt=this.pTime?k.timeStamp-this.pTime<M.interval:!0,Ie=!this.pCenter||ve(this.pCenter,k.center)<M.posThreshold;this.pTime=k.timeStamp,this.pCenter=k.center,!Ie||!Zt?this.count=1:this.count+=1,this._input=k;var Mr=this.count%M.taps;if(Mr===0)return this.hasRequireFailures()?(this._timer=u(function(){this.state=Co,this.tryEmit()},M.interval,this),Bn):Co}return Bs},failTimeout:function(){return this._timer=u(function(){this.state=Bs},this.options.interval,this),Bs},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Co&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function wa(k,M){return M=M||{},M.recognizers=w(M.recognizers,wa.defaults.preset),new Uy(k,M)}wa.VERSION="2.0.7",wa.defaults={domEvents:!1,touchAction:fS,enable:!0,inputTarget:null,inputClass:null,preset:[[qy,{enable:!1}],[jy,{enable:!1},["rotate"]],[By,{direction:W}],[up,{direction:W},["swipe"]],[dp],[dp,{event:"doubletap",taps:2},["tap"]],[zy]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var K6=1,_S=2;function Uy(k,M){this.options=p({},wa.defaults,M||{}),this.options.inputTarget=this.options.inputTarget||k,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=k,this.input=ut(this),this.touchAction=new Gy(this,this.options.touchAction),vS(this,!0),g(this.options.recognizers,function(G){var Z=this.add(new G[0](G[1]));G[2]&&Z.recognizeWith(G[2]),G[3]&&Z.requireFailure(G[3])},this)}Uy.prototype={set:function(k){return p(this.options,k),k.touchAction&&this.touchAction.update(),k.inputTarget&&(this.input.destroy(),this.input.target=k.inputTarget,this.input.init()),this},stop:function(k){this.session.stopped=k?_S:K6},recognize:function(k){var M=this.session;if(!M.stopped){this.touchAction.preventDefaults(k);var G,Z=this.recognizers,at=M.curRecognizer;(!at||at&&at.state&Co)&&(at=M.curRecognizer=null);for(var Zt=0;Zt<Z.length;)G=Z[Zt],M.stopped!==_S&&(!at||G==at||G.canRecognizeWith(at))?G.recognize(k):G.reset(),!at&&G.state&(Bn|ih|xa)&&(at=M.curRecognizer=G),Zt++}},get:function(k){if(k instanceof Mo)return k;for(var M=this.recognizers,G=0;G<M.length;G++)if(M[G].options.event==k)return M[G];return null},add:function(k){if(d(k,"add",this))return this;var M=this.get(k.options.event);return M&&this.remove(M),this.recognizers.push(k),k.manager=this,this.touchAction.update(),k},remove:function(k){if(d(k,"remove",this))return this;if(k=this.get(k),k){var M=this.recognizers,G=I(M,k);G!==-1&&(M.splice(G,1),this.touchAction.update())}return this},on:function(k,M){if(k!==n&&M!==n){var G=this.handlers;return g(R(k),function(Z){G[Z]=G[Z]||[],G[Z].push(M)}),this}},off:function(k,M){if(k!==n){var G=this.handlers;return g(R(k),function(Z){M?G[Z]&&G[Z].splice(I(G[Z],M),1):delete G[Z]}),this}},emit:function(k,M){this.options.domEvents&&Q6(k,M);var G=this.handlers[k]&&this.handlers[k].slice();if(!(!G||!G.length)){M.type=k,M.preventDefault=function(){M.srcEvent.preventDefault()};for(var Z=0;Z<G.length;)G[Z](M),Z++}},destroy:function(){this.element&&vS(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function vS(k,M){var G=k.element;if(G.style){var Z;g(k.options.cssProps,function(at,Zt){Z=P(G.style,Zt),M?(k.oldCssProps[Z]=G.style[Z],G.style[Z]=at):G.style[Z]=k.oldCssProps[Z]||""}),M||(k.oldCssProps={})}}function Q6(k,M){var G=e.createEvent("Event");G.initEvent(k,!0,!0),G.gesture=M,M.target.dispatchEvent(G)}p(wa,{INPUT_START:Et,INPUT_MOVE:Mt,INPUT_END:Ot,INPUT_CANCEL:Y,STATE_POSSIBLE:cp,STATE_BEGAN:Bn,STATE_CHANGED:ih,STATE_ENDED:xa,STATE_RECOGNIZED:Co,STATE_CANCELLED:md,STATE_FAILED:Bs,DIRECTION_NONE:We,DIRECTION_LEFT:L,DIRECTION_RIGHT:O,DIRECTION_UP:U,DIRECTION_DOWN:X,DIRECTION_HORIZONTAL:W,DIRECTION_VERTICAL:K,DIRECTION_ALL:it,Manager:Uy,Input:H,TouchAction:Gy,TouchInput:xe,MouseInput:er,PointerEventInput:an,TouchMouseInput:oi,SingleTouchInput:cr,Recognizer:Mo,AttrRecognizer:ms,Tap:dp,Pan:up,Swipe:By,Pinch:jy,Rotate:qy,Press:zy,on:b,off:E,each:g,merge:y,extend:m,assign:p,inherit:_,bindFn:x,prefixed:P});var J6=typeof t<"u"?t:typeof self<"u"?self:{};J6.Hammer=wa,r.exports?r.exports=wa:t[i]=wa})(window,document,"Hammer")})(m3)),m3.exports}var Xet=Yet();const Ket=AM(Xet);function _v(r){const t=me(r()),e=()=>{t.value=r()};return zc(()=>{ws.on("languageChanged",e)}),sO(()=>{ws.off("languageChanged",e)}),t}function Qet({url:r,typ:t,capabilitiesUrl:e,...i}){const n=[];if(e)n.push(e);else if(t==="OAF")n.push(r);else if(t==="Entities3D")i.entities.forEach(s=>s.url?n.push(s.url):null);else if(t==="TileSet3D"||t==="Terrain3D")n.push(r);else if(t==="GeoJSON"){if(!r&&i.features)return Promise.resolve(200);r&&n.push(r)}else if(t==="VectorTile")n.push(r.replaceAll(/\{[xyz]\}/ig,"0"));else if(t==="WMTS"){const s=(r?[r]:i.urls).map(o=>o.replace(/\{Style\}/ig,i.style).replace(/\{TileMatrixSet\}/ig,i.tileMatrixSet).replaceAll(/\{(TileMatrix|TileRow|TileCol)\}/ig,"0"));n.push(...s)}else r&&n.push(`${r}?service=${t}&request=GetCapabilities`);return n.length?Promise.allSettled(n.map(s=>new Promise(o=>fetch(s,{method:"HEAD"}).then(({status:a})=>o(a)).catch(()=>o(900))))).then(s=>Math.max(...s.map(({value:o})=>o))):Promise.resolve(null)}function Jet(r,t){r.layers.map(({id:e})=>({id:e,service:t.find(({id:i})=>i===e)})).filter(e=>e.service?!0:(console.warn(`@polar/polar(core/utils/checkServiceAvailability:26:6)
`,`Service with id "${e.id}" not found in service register.`),!1)).map(({service:e})=>({ping:Qet(e),serviceId:e.id,serviceName:e.name})).forEach(({ping:e,serviceId:i,serviceName:n})=>{e.then(s=>{s!==200&&(o2("warning",()=>Ci(o=>o.error.serviceUnavailable,{ns:"core",serviceId:i,serviceName:n})),console.error(`@polar/polar(core/utils/checkServiceAvailability:54:7)
`,`Ping to "${i}" returned "${s}".`))}).catch(s=>{console.error(`@polar/polar(core/utils/checkServiceAvailability:58:6)
`,s)})})}function trt(r,t){return r?[new p2,new m2]:[new p2({condition:function(){return t?this.getPointerCount()>1:!0}}),new m2({condition:vV})]}function _3(r){const t=r.originalEvent.composedPath()[0],{tagName:e}=t;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.isContentEditable}const ert=()=>[new FP({condition:_3}),new NP({condition:_3})];function rrt(r,t,e){if(t.get("features"))return t;const i=r.getLayers().getArray().find(s=>s.get("id")===t.get(e));if(!(i instanceof fs))throw new Error(`@polar/lib-get-cluster: The layer with the id ${e} either does not exist or is not a VectorLayer.`);const n=i.getSource().getFeatures().find(s=>s.get("features").includes(t));if(!(n instanceof zi))throw new Error("@polar/lib-get-cluster: No cluster could be found for the given feature.");return n.set("features",[...n.get("features").filter(s=>s!==t),t]),n.set(e,t.get(e),!0),n}const irt=new Vr,nrt=r=>r.getStyle()!==irt;class hd{constructor(t,e,i){this.feature=t,this.style=e,this.isClustered=i,this.attributes={},this.legendInfos=[],this.styleMultiGeomOnlyWithRule=!1,this.nullStyle=!1}setFeature(t){this.feature=t}setStyle(t){this.style=t}getStyle(){return this.style}overwriteStyling(t){t?(this.nullStyle=!1,Object.keys(t).forEach(e=>{const i=t[e];this.attributes[e]=i})):this.nullStyle=!0}setIsClustered(t){this.isClustered=t}getLegendInfos(){return this.legendInfos}createLegendId(t,e){const i=e?.conditions?e.conditions:null;return encodeURIComponent(t+JSON.stringify(i))}createLegendLabel(t,e){if(e?.attributes?.legendValue)return e.attributes.legendValue.toString();if(t?.conditions){let i="";return t.conditions?.properties&&(i=Object.values(t.conditions.properties).join(", ")),t.conditions?.sequence&&Array.isArray(t.conditions.sequence)&&t.conditions.sequence.every(n=>typeof n=="number")&&t.conditions.sequence.length===2&&t.conditions.sequence[1]>=t.conditions.sequence[0]&&(i=i+" ("+t.conditions.sequence.join("-")+")"),i}return null}addLegendInfo(t,e,i){const{legendInfos:n}=e,s=this.createLegendId(t,i);n.some(o=>o.id===s)||this.legendInfos.push({id:s,geometryType:t,styleObject:e.attributes.type==="NOMINAL"?{attributes:e.attributes,style:e.style}:e.attributes,label:this.createLegendLabel(i,e)})}prepareField(t,e){const i=e.startsWith("@");let n=e;return i?(n=Y4(t,n),typeof n>"u"&&(n="undefined")):n=Object.prototype.hasOwnProperty.call(t,e)?t[e]:"undefined",n}}const v3={draw:[{type:"line",parameters:[[1,-.5],[-.5,1]]},{type:"line",parameters:[[1.5,0],[0,1.5]]}]},x3={draw:[{type:"line",parameters:[[0,-.25],[.75,.5],[0,1.25]]}]},srt={diagonal:v3,"zig-line":x3,"diagonal-right":{...v3,rotate:90},"zig-line-horizontal":{...x3,rotate:90},rectangle:{draw:[{type:"rect",parameters:[[.125,.125,.25,.25],[.625,.625,.25,.25]]}]},triangle:{draw:[{type:"line",parameters:[[.25,0],[.5,.5],[0,.5],[.25,0]]},{type:"line",parameters:[[.75,.5],[1,1],[.5,1],[.75,.5]]}]},diamond:{draw:[{type:"line",parameters:[[.25,0],[.5,.25],[.25,.5],[0,.25],[.25,0]]},{type:"line",parameters:[[.75,.5],[1,.75],[.75,1],[.5,.75],[.75,.5]]}]},circle:{draw:[{type:"arc",parameters:[.25,.25,({size:r,lineWidth:t})=>(r-2*t)/4]},{type:"arc",parameters:[.75,.75,({size:r,lineWidth:t})=>(r-2*t)/4]}]}};function vv(r){return t=>t*r}function ort(r,t,{type:e,parameters:i}){const n=vv(t);if(r.beginPath(),e==="rect")i.forEach(s=>r.rect(...s.map(n)));else if(e==="line"){const[s,...o]=i;r.moveTo(...s.map(n)),o.forEach(a=>r.lineTo(...a.map(n)))}else if(e==="arc"){const[s,o,a,l,c,h]=i,u=typeof a=="function"?a({size:t,lineWidth:r.lineWidth}):a;r.arc(vv(t)(s),vv(t)(o),u,l||0,c||2*Math.PI,h||!1)}else{console.error(`polygonStyleHatches: Unknown segment type "${e}". Skipping segment.`);return}r.stroke()}function art(r,t,e=90){const i=.5*t;r.translate(i,i),r.rotate(e*Math.PI/180),r.translate(-i,-i)}function lrt(r,t,e){const i=typeof e=="string"?srt[e]:e;if(i){const{draw:n,rotate:s}=i;s&&art(r,t,s),n&&n.forEach(o=>ort(r,t,o))}else console.error(`polygonStyleHatches: Unknown polygon style "${e}". Skipping hatching.`)}class V2 extends hd{constructor(){super(),this.attributes={...An.polygon}}initialize(t,e,i){this.setFeature(t),this.setIsClustered(i),this.overwriteStyling(e),this.setStyle(this.createStyle())}createStyle(){if(this.nullStyle)return null;const t=this.attributes.polygonFillColor,e=this.attributes.polygonFillHatch;return new ii({stroke:new vo({lineCap:this.attributes.polygonStrokeCap,lineJoin:this.attributes.polygonStrokeJoin,lineDash:this.attributes.polygonStrokeDash,lineDashOffset:this.attributes.polygonStrokeDashOffset,miterLimit:this.attributes.polygonStrokeMiterLimit,color:this.attributes.polygonStrokeColor,width:this.attributes.polygonStrokeWidth}),fill:new Ds({color:e?this.getPolygonFillHatch(e).getContext("2d").fillStyle:t})})}getPolygonFillHatch({pattern:t="diagonal",size:e=30,lineWidth:i=10,backgroundColor:n=[0,0,0,1],patternColor:s=[255,255,255,1]}){const o=document.createElement("canvas"),a=o.getContext("2d");return o.width=e,o.height=e,a.fillStyle=`rgba(${n.join(",")})`,a.fillRect(0,0,o.width,o.height),a.lineWidth=i,a.strokeStyle=`rgba(${s.join(",")})`,lrt(a,e,t),a.fillStyle=a.createPattern(o,"repeat"),o}getPolygonFillHatchLegendDataUrl(t){const e=this.getPolygonFillHatch(t.polygonFillHatch),i=Bi(t.polygonStrokeColor,"hex"),n=parseInt(t.polygonStrokeWidth,10),s=t.polygonStrokeColor[3].toString()||0,o=document.createElement("canvas"),a=o.getContext("2d"),l=n/2,c=n*2;return o.width=e.width+c,o.height=e.height+c,a.drawImage(e,n,n),a.lineCap="round",a.lineJoin="round",a.strokeStyle=i,a.lineWidth=n,a.globalAlpha=s,a.strokeRect(l,l,o.width-n,o.height-n),o.toDataURL()}}const crt=new V2,XL="data:image/svg+xml,",KL=r=>typeof r=="string"?"":`<defs>
    <pattern id="img" patternUnits="userSpaceOnUse" x="0" y="0" width="${r.size||30}" height="${r.size||30}">
      <image href="${crt.getPolygonFillHatch(r).toDataURL()}" width="${r.size||30}" height="${r.size||30}"/>
    </pattern>
  </defs>`,hrt=({fill:r,size:t,stroke:e,strokeWidth:i})=>`${XL}${encodeURIComponent(`
<svg width="${t[0]}" height="${t[1]}" viewBox="0 0 30 43" xmlns="http://www.w3.org/2000/svg">
  <title>DB6C494E-88E8-49F1-89CE-97CBEC3A5240</title>
  ${KL(r)}
  <path
    d="M14.584 1C7.101 1 1 7.101 1 14.584c0 8.103 7.865 20.448 11.63 25.93a2.36 2.36 0 0 0 3.908 0c3.766-5.482 11.63-17.922 11.63-25.93C28.168 7.054 22.068 1 14.584 1z"
    stroke="${e}"
    stroke-width="${i}"
    fill="${typeof r=="string"?r:"url(#img)"}"
    fill-rule="nonzero"
  />
</svg>
`)}`,urt=({fill:r,clusterSize:t,stroke:e,strokeWidth:i})=>`${XL}${encodeURIComponent(`
<svg width="${t[0]}" height="${t[1]}" viewBox="0 0 30 43" xmlns="http://www.w3.org/2000/svg">
  <title>0A6F4952-4A5A-4E86-88E4-4B3D2EA1E3DF</title>
  ${KL(r)}
  <g stroke="${e}" stroke-width="${i}" fill="${typeof r=="string"?r:"url(#img)"}" fill-rule="nonzero">
    <path d="M22.584 1C15.101 1 9 7.101 9 14.584c0 8.103 7.865 20.448 11.63 25.93a2.36 2.36 0 0 0 3.908 0c3.766-5.482 11.63-17.922 11.63-25.93C36.168 7.054 30.068 1 22.584 1z"/>
    <path d="M18.584 1C11.101 1 5 7.101 5 14.584c0 8.103 7.865 20.448 11.63 25.93a2.36 2.36 0 0 0 3.908 0c3.766-5.482 11.63-17.922 11.63-25.93C32.168 7.054 26.068 1 18.584 1z"/>
    <path d="M14.584 1C7.101 1 1 7.101 1 14.584c0 8.103 7.865 20.448 11.63 25.93a2.36 2.36 0 0 0 3.908 0c3.766-5.482 11.63-17.922 11.63-25.93C28.168 7.054 22.068 1 14.584 1z"/>
  </g>
</svg>
`)}`,drt=[.5,1],grt=r=>{const t=new Map,e=new Map;return(i,n)=>{const s=n?e:t;if(s.has(i))return s.get(i);const o=r(i,n);return s.set(i,o),s.size>1e3&&console.warn(`@polar/polar(core/utils/markers:86:4)
`,"1000+ styles have been created. This is possibly a memory leak. Please mind that the methods exported by this module are memoized. You *may* be calling the methods with constantly newly generated objects, or maybe there's just a lot of styles."),o}},frt=(r,t=!1)=>new Vr({image:new kl({src:(t?urt:hrt)(r),anchor:drt})}),qm=grt(frt),vy=[26,36],xy=[40,36],wy="#FFFFFF",by="2",prt={clusterSize:xy,fill:"#005CA9",size:vy,stroke:wy,strokeWidth:by},mrt={clusterSize:xy,fill:"#7B1045",size:vy,stroke:wy,strokeWidth:by},yrt={clusterSize:xy,fill:"#679100",size:vy,stroke:wy,strokeWidth:by},_rt={clusterSize:xy,fill:"#333333",size:vy,stroke:wy,strokeWidth:by};let IE=[],Z2=0;function ff(r){return IE.find(t=>t.id===r)}function PE(r){return IE.some(({id:t})=>t===r.get("id"))}function vrt(r,t){return r.getLayers().getArray().find(e=>e.get("id")===t)}function xrt(r,t){const e=t.get("features"),i=nn();e.forEach(n=>yw(i,n.getGeometry()?.getExtent()||[])),r.getView().fit(i,{duration:400,padding:[80,30,80,30]})}function H2(r,t,e=!1){const i=wf();if(i.selected?.setStyle(void 0),i.selected=null,t===null)return;const n=t.get("_polarLayerId"),s=typeof vrt(r,n)?.getSource().getDistance=="function"?rrt(r,t,"_polarLayerId"):t;s.setStyle(qm(ff(t.get("_polarLayerId")).selectionStyle,s.get("features")?.length>1)),i.selected=ac(s),e&&zu().centerOnFeature(i.selected)}function AE(r,t){if(t.get("_polarLayerId"))return;const e=r.getLayers().getArray().find(i=>{if(i instanceof fs){let n=i;for(;n instanceof fs||n instanceof TE;)if(n=n.getSource(),n.hasFeature(t))return!0;return n.hasFeature(t)}return!1})?.get("id");e&&t.set("_polarLayerId",e,!0)}function wrt(r){const t=wf(),e=t.configuration;e&&(IE=e.layers.map(i=>Lr({defaultStyle:prt,hoverStyle:mrt,selectionStyle:yrt,unselectableStyle:_rt,isSelectable:()=>!0},i)),Z2=r.getView().getZoom(),r.getLayers().getArray().filter(PE).forEach(i=>{const n=i.getSource();n!==null&&(n.geometryFunction=o=>nrt(o)?o.getGeometry():null);const s=ff(i.get("id"));i.setStyle(o=>qm(s.isSelectable(o)?s.defaultStyle:s.unselectableStyle,o.get("features")?.length>1))}),Zr(()=>t.hovered,i=>{if(i!==null&&i!==to(t.selected)&&(t.hovered?.setStyle(void 0),t.hovered=null),i!==null&&i!==to(t.selected)){t.hovered=ac(i);const n=t.hovered.get("features")?.length>1,s=qm(ff(i.get("_polarLayerId")).hoverStyle,n);t.hovered.setStyle(s)}}),r.on("moveend",brt),r.on("pointermove",krt),r.on("click",Ert),r.on("singleclick",Srt))}let QL=null;function brt({map:r}){const t=wf(),e=r.getView().getZoom();if(e!==Z2&&(Z2=e,t.selected)){const i=t.selected.get("features")?.[0]||t.selected;AE(r,i),H2(r,i)}}function krt({map:r,pixel:t}){const e=wf(),i=r.getFeaturesAtPixel(t,{layerFilter:PE})[0];if(i===to(e.selected)||i instanceof Gi||(to(e.hovered)!==null&&to(e.hovered)!==to(e.selected)&&(e.hovered?.setStyle(void 0),e.hovered=null),!i))return;AE(r,i);const n=ff(i.get("_polarLayerId"));if(!n.isSelectable(i))return;const s=i.get("features")?.length>1;i.setStyle(qm(n.hoverStyle,s)),e.hovered=ac(i)}function Ert(r){const t=wf(),e=r.map;t.selected!==null&&H2(e,null);const i=e.getFeaturesAtPixel(r.pixel,{layerFilter:PE})[0];if(!i||i instanceof Gi||(AE(e,i),!ff(i.get("_polarLayerId")).isSelectable(i)))return;const n=i.get("features")?.length>1;QL=r,r.stopPropagation();const s=e.getView().getZoom()!==e.getView().getMaxZoom();if(t.clusterClickZoom&&n&&s){xrt(e,i);return}if(t.hovered?.setStyle(void 0),t.hovered=null,H2(e,i,!0),t.callOnMapSelect){const o=zu(),{action:a,payload:l,pluginName:c}=t.callOnMapSelect;if(!c){o[a](l);return}const h=fw().getPluginStore(c);if(!h){console.error(`@polar/polar(core/utils/map/setupMarkers:335:4)
`,`Plugin ${c} does not exist or is not configured or has no store module. Action ${a} could not be called.`);return}h[a](l)}}function Srt(r){r.originalEvent===QL?.originalEvent&&r.stopPropagation()}function JL(r,t){if(typeof r=="object"){const{value:e,isDegree:i}=r;if(Wg(e)&&t!==void 0){const n=parseInt(Vg(t,e),10);return i?n*Math.PI/180:n}return i?parseInt(e,10)*Math.PI/180:parseInt(e,10)}return 0}function Y2(r,t,e){const i=e&&t.get("features")?.length>1,n=i?r.clusterImageName:r.imageName,s=i?r.clusterImageOffsetY:r.imageOffsetX,o=i?r.clusterImageOffsetX:r.imageOffsetY,a=i?r.clusterImageScale:r.imageScale,l=r.imagePath;let c={},h=n;return!n.startsWith("https:")&&!n.startsWith("<svg")&&(h=l+n),c={crossOrigin:"anonymous",src:h.startsWith("<svg")?"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(h):h,scale:a,anchor:[parseFloat(s),parseFloat(o)]},i||(c.anchorXUnits=r.imageOffsetXUnit,c.anchorYUnits=r.imageOffsetYUnit,c.rotation=t?JL(r.rotation,t.getProperties()):0),new ii({image:new Df(c)})}function t8(r){return new ii({image:new Df({crossOrigin:"anonymous",src:"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(r)})})}function Trt(r,t,e){const i=e&&t.get("features")?.length>1,n=parseFloat(i?r.clusterCircleRadius:r.circleRadius,10),s=Bi(i?r.clusterCircleFillColor:r.circleFillColor,"rgb"),o=Bi(i?r.clusterCircleStrokeColor:r.circleStrokeColor,"rgb"),a=parseFloat(i?r.clusterCircleStrokeWidth:r.circleStrokeWidth,10);return new ii({image:new k1({radius:n,fill:new Ds({color:s}),stroke:new vo({color:o,width:a})}),zIndex:-1})}function Crt(r){const t=parseFloat(r.rsRadius,10),e=parseFloat(r.rsRadius2,10),i=parseFloat(r.rsPoints,10),n=parseFloat(r.rsAngle,10),s=JL(r.rotation),o=r.rsScale,a=Bi(r.rsFillColor,"rgb"),l=Bi(r.rsStrokeColor,"rgb"),c=parseFloat(r.rsStrokeWidth,10);return new ii({image:new ob({radius:t,radius2:e,points:i,scale:o,rotation:s,angle:n,fill:new Ds({color:a}),stroke:new vo({color:l,width:c})})})}function Mrt(r,t,e,i){let n=i*2;return r*t+e>=n&&(n=n+r*t+e),n}function Rrt(r,t,e,i){let n;return e>=0?n=r/2-t-e*i:e<0?n=r/2+t-e*i:n=0,n}function Irt(r,t,e,i,n,s,o,a){let l="<svg width='"+r+"' height='"+r+"' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>";return l=l+"<line x1='"+r/2+"' y1='"+r/2+"' x2='"+r/2+"' y2='"+t+"' stroke='"+s+"' stroke-width='"+o+"' />",l=l+"<circle cx='"+r/2+"' cy='"+r/2+"' r='"+a+"' stroke='"+i+"' stroke-width='"+n+"' fill='"+e+"' />",l=l+"</svg>",l}function Prt(r,t){const e=parseFloat(t.circleBarScalingFactor),i=parseFloat(t.circleBarRadius,10),n=parseFloat(t.circleBarLineStroke,10),s=Bi(t.circleBarCircleFillColor,"hex"),o=Bi(t.circleBarCircleStrokeColor,"hex"),a=t.circleBarCircleStrokeWidth,l=Bi(t.circleBarLineStrokeColor,"hex"),c=r.getProperties(),h=pf.prototype.prepareField(c,t.scalingAttribute),u=h==="undefined"?void 0:h,d=u!==void 0&&u.indexOf(" ")!==-1?u.split(" ")[0]:u,g=Mrt(d,e,n,i),f=Rrt(g,i,d,e);return pf.prototype.setSize(g),Irt(g,f,s,o,a,l,n,i)}function Art(r,t){const e=t.scalingShape.toUpperCase(),i=e==="CIRCLE_BAR"?Prt(r,t):"";return t8(i)}function Lrt(r,t,e,i,n){const s=r/2;let o="<svg width='"+r+"' height='"+r+"' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>";return o=o+"<circle cx='"+s+"' cy='"+s+"' r='"+t+"' stroke='"+e+"' stroke-width='"+i+"' fill='"+e+"' fill-opacity='"+n+"'/>",o}function Ort(r,t){const e=r===void 0||Object.keys(r).length===0?{empty:0}:r;let i=t;return i===void 0||(i=i.split(" | "),i.forEach(function(n){Object.prototype.hasOwnProperty.call(e,n)?e[n]=e[n]+1:e.empty=e.empty+1})),e}function Frt(r){const t={};let e;if(r!==void 0)for(e in r)t[e]=0;return t.empty=0,t}function Nrt(r,t,e,i,n){const s=Math.PI/180,o=i/2,a=r===0&&t===360,l=a?t/2:t,c=a?0:n,h=(r+c/2)*s,u=(l-c/2)*s,d=o+Math.cos(h)*e,g=o-Math.sin(h)*e,f=o+Math.cos(u)*e,p=o-Math.sin(u)*e;return a?["M",d,g,"A",e,e,0,0,0,f,p,"A",e,e,0,0,0,d,g].join(" "):["M",d,g,"A",e,e,0,0,0,f,p].join(" ")}function Drt(r,t,e,i){return r+"<path fill='none' stroke-width='"+t+"' stroke='"+e+"' d='"+i+"'/>"}function $rt(r,t){const e=parseFloat(t.circleSegmentsRadius,10),i=parseFloat(t.circleSegmentsStrokeWidth,10),n=t.circleSegmentsBackgroundColor,s=Array.isArray(n)&&n[n.length-1],o=Bi(t.circleSegmentsBackgroundColor,"hex"),a=Bi(t.scalingValueDefaultColor,"hex"),l=t.scalingValues,c=Frt(l),h=r.get(t.scalingAttribute),u=Ort(c,h),d=Object.values(u).reduce(function(C,S){return C+S},0),g=d>=0?360/d:360,f=parseFloat(t.circleSegmentsGap,10);let p=10,m=0,y=g,_,x,v,w,b,E;(e+i)*2>=p&&(p=p+(e+i)*2),pf.prototype.setSize(p),_=Lrt(p,e,o,i,s);for(b in u)for(E=u[b],l!==void 0&&b!=="empty"?v=Bi(l[b],"hex"):v=a,w=0;w<E;w++)x=Nrt(m,y,e,p,f),_=Drt(_,i,v,x),m=m+g,y=y+g;return _=_+"</svg>",_}function Grt(r,t,e){const i=Array.isArray(t.get("features"))?t.get("features")[0]:t,n=r.scalingShape.toUpperCase(),s=r.imageName;let o,a,l;return n==="CIRCLESEGMENTS"&&(o=$rt(i,r),a=t8(o),a.type="CIRCLESEGMENTS",a.scalingAttribute=i.get(r.scalingAttribute)),s!==e&&(l=Y2(r,t),l.type="imageStyle",a=[a,l]),a}class pf extends hd{constructor(){super(),this.attributes={...An.point}}initialize(t,e,i,n){n!==void 0?this.setImagePath(n):console.warn("wfsImgPath at Config.js is not defined"),this.setFeature(t),this.setIsClustered(i),this.overwriteStyling(e),this.setStyle(this.createStyle())}createStyle(){if(this.nullStyle)return null;const t=this.isClustered;let e=this.attributes.type.toLowerCase();return t&&this.feature.get("features")?.length>1&&(e=this.attributes.clusterType.toLowerCase()),e==="icon"?Y2(this.attributes,this.feature,t):e==="circle"?Trt(this.attributes,this.feature,t):e==="nominal"?t?Y2(this.attributes,this.feature,t):Grt(this.attributes,this.feature,An.point.imageName):e==="interval"?Art(this.feature,this.attributes):e==="regularshape"?Crt(this.attributes):new ii}setCircleSegmentsBackgroundColor(t){this.attributes.circleSegmentsBackgroundColor=t}setSize(t){this.size=t}getSize(){return this.size}setImagePath(t){this.attributes.imagePath=t}}class jrt extends hd{constructor(){super(),this.attributes={...An.text}}initialize(t,e,i){this.setFeature(t),this.setIsClustered(i),this.overwriteStyling(e),this.setStyle(this.createStyle())}createStyle(){if(this.nullStyle)return null;const t=this.isClustered,e=this.feature,i=this.attributes.labelField;return t&&e.get("features")?.length>1&&this.attributes.clusterTextType!=="none"?this.createClusteredTextStyle():i?this.createLabeledTextStyle():new p0}getRotationValue(t,e){if(typeof t=="object"){const{value:i,isDegree:n}=t;if(Wg(i)&&e!==void 0){const s=parseInt(Vg(e,i),10);return n?s*Math.PI/180:s}return n?parseInt(i,10)*Math.PI/180:parseInt(i,10)}return 0}createClusteredTextStyle(){const t=this.feature;let e;return this.attributes.clusterTextType==="counter"?e=t.get("features").length.toString():this.attributes.clusterTextType==="text"&&typeof this.attributes.clusterText=="string"?e=this.attributes.clusterText:e="undefined",new p0({text:e,textAlign:this.attributes.clusterTextAlign,offsetX:this.attributes.clusterTextOffsetX,offsetY:this.attributes.clusterTextOffsetY,font:this.attributes.clusterTextFont,scale:this.attributes.clusterTextScale,fill:new Ds({color:this.attributes.clusterTextFillColor}),stroke:new vo({color:this.attributes.clusterTextStrokeColor,width:this.attributes.clusterTextStrokeWidth}),rotation:this.getRotationValue(this.attributes.rotation,t.getProperties())})}createLabeledTextStyle(){const t=this.feature,e=t.getProperties(),i=this.attributes.textSuffix;let n=J0(e,this.attributes.labelField,!1)??"";return i!==""&&(n=n+" "+i),new p0({text:n.toString(),textAlign:this.attributes.textAlign,offsetX:this.attributes.textOffsetX,offsetY:this.attributes.textOffsetY,font:this.attributes.textFont,scale:this.attributes.textScale,fill:new Ds({color:this.attributes.textFillColor}),stroke:new vo({color:this.attributes.textStrokeColor,width:this.attributes.textStrokeWidth}),rotation:this.getRotationValue(this.attributes.rotation,e)})}}class w3 extends hd{constructor(){super(),this.attributes={...An.line}}initialize(t,e,i){this.setFeature(t),this.setIsClustered(i),this.overwriteStyling(e),this.setStyle(this.createStyle())}createStyle(){return this.nullStyle?null:new ii({stroke:new vo({lineCap:this.attributes.lineStrokeCap,lineJoin:this.attributes.lineStrokeJoin,lineDash:this.attributes.lineStrokeDash,lineDashOffset:this.attributes.lineStrokeDashOffset,miterLimit:this.attributes.lineStrokeMiterLimit,color:this.attributes.lineStrokeColor,width:this.attributes.lineStrokeWidth})})}}class b3 extends hd{constructor(){super(),this.attributes={...An.circle}}initialize(t,e,i){this.setFeature(t),this.setIsClustered(i),this.overwriteStyling(e),this.setStyle(this.createStyle())}createStyle(){if(this.nullStyle)return null;const t=new Ds({color:this.attributes.circleFillColor}),e=new vo({color:this.attributes.circleStrokeColor,width:this.attributes.circleStrokeWidth});return new ii({image:new k1({fill:t,stroke:e,radius:0}),fill:t,stroke:e})}}class zrt extends hd{constructor(){super(),this.attributes={...An.point},this.conditions=[]}initialize(t){this.overwriteStyling(t.style),this.setConditions(t.conditions),this.setStyle(this.createStyle())}createStyle(){return this.createCondition(this.attributes.conditions,this.style)}createCondition(t,e){const i=e?.color||this.attributes.color,n=[];let s;return t&&Object.keys(t).length>0?(Object.keys(t).forEach(o=>{const a=t[o];n.push([o,a])}),s=[this.createCesiumConditionForRule(n),i]):s=["true",i],s}createCesiumConditionForRule(t){let e=[],i="";return t.forEach(n=>{const s="${"+n[0]+"}";let o=n[1],a,l;Array.isArray(o)?(a=o[0],l=o[1],i="("+s+" > "+a+" && "+s+" <= "+l+")"):(typeof o=="string"&&(o="'"+o+"'"),i="("+s+" === "+o+")"),e.push(i)}),e="("+e.join(" && ")+")",e}setConditions(t){this.attributes.conditions=t}}const ug=[];let X2=0;function dg(r){return r==="MultiPoint"||r==="MultiLineString"||r==="MultiPolygon"||r==="GeometryCollection"||r==="cesium"}function gu(r,t,e,i,n){const s=e?.style,o=s?s.legendValue:null;let a,l=null;if(t&&(t.legendValue=o||null),r==="Point")a=new pf(t,s,i),i&&(l=new pf(t,s,!1));else if(r==="LineString")a=new w3(t,s,i),i&&(l=new w3(t,s,!1));else if(r==="Polygon")a=new V2(t,s,i),i&&(l=new V2(t,s,!1));else{if(r==="cesium")return a=new zrt(e),a.initialize(e),a.addLegendInfo("cesium",a,e),a.legendValue=o,a;if(r==="Circle")a=new b3(t,s,i),i&&(l=new b3(t,s,!1));else return r==="LinearRing"?(console.warn("Geometry type not implemented: "+r+" default style ist used for feature "+t),new ii):(console.warn("Geometry type not implemented: "+r+" default style ist used for feature "+t),new ii)}return l!==null&&(l.initialize(t,s,!1,n),l.legendValue=o),a.initialize(t,s,i,n),a.addLegendInfo(r,l===null?a:l,e),a.legendValue=o,a}function K2(r,t,e,i,n){const s=[];let o=[];if(typeof t=="object")r==="MultiPoint"?o=t.getGeometry().getPoints():r==="MultiLineString"?o=t.getGeometry().getLineStrings():r==="MultiPolygon"?o=t.getGeometry().getPolygons():r==="GeometryCollection"&&(o=t.getGeometry().getGeometries()),o.forEach((a,l)=>{const c=a.getType(),h=e?MG(e,l):void 0,u=gu(c,t,h,i,n);dg(c)?console.warn("Multi encapsulated multiGeometries are not supported."):(!u.styleMultiGeomOnlyWithRule||h)&&(u.getStyle()?.setGeometry(a),s.push(u))});else if(r==="cesium")e.forEach(a=>{const l=gu(r,t,a,i,n);s.push(l)});else{const a=gu(r,t,e,i,n);a.getStyle()?.setGeometry(r),s.push(a)}return s}function e8(r,t,e,i){const n=r?r.getGeometry().getType():"cesium";return!dg(n)&&Object.prototype.hasOwnProperty.call(t,0)&&Object.prototype.hasOwnProperty.call(t[0],"style")?gu(n,r,t[0],e,i):dg(n)&&t.length>0&&t.every(s=>s?.style)?K2(n,r,t,e,i):(console.warn("No valid styling rule found. Falling back to defaults"),dg(n)?K2(n,r,void 0,e,i):gu(n,r,void 0,e,i))}function Q2(r,t,e){const i=new jrt(r,t,e);return i.initialize(r,t,e),i.getStyle()}function k3(r,t){let e=ug.find(i=>i.id===r);if(e||(e={id:r,legendInformation:[]},ug.push(e)),r==="default"&&e.legendInformation!==t)e.legendInformation=t,X2=t.length;else if(!e.legendInformation.find(i=>i.label===t[0].label)){e.legendInformation.push(t[0]);const i=new CustomEvent("legendCaptured"),n=this||globalThis;i.id=e.id,n instanceof EventTarget&&typeof n.dispatchEvent=="function"&&n.dispatchEvent(i)}}function qrt(r,t,e,i){const n=X4(r,t),s=Array.isArray(n)&&n.length>0?n[0].style:null,o=s?.labelField,a=e8(t,n,e,i),l=Array.isArray(a)?a[0].legendInfos:a.legendInfos;let c=null;if(Array.isArray(a)?(c=[],a.forEach(h=>{h.getStyle()!==null&&c.push(h.getStyle())})):c=a.getStyle(),Array.isArray(a)&&a.length>1)for(const h in a)k3(r.styleId,a[h].legendInfos);else k3(r.styleId,l);return c!==null&&(e||o)&&(Array.isArray(c)?c[0].setText(Q2(t,s,e)):c.setText(Q2(t,s,e))),(t?.getGeometry().getType()==="Point"||t?.getGeometry().getType()==="MultiPoint")&&t.setStyle(c),c}async function Brt(r){return new Promise(function(t){const e=ug.find(i=>i.id===r);e&&(r.id!=="default"||e.legendInformation.length===X2)&&t(e),(this||globalThis)&&(this||globalThis).addEventListener("legendCaptured",i=>{i.id===r&&i.id!=="default"?t(ug.find(n=>n.id===i.id)):e&&e.legendInformation.length===X2&&t(ug.find(n=>n.id===i.id))},!1)})}const Urt={isMultiGeometry:dg,getSimpleGeometryStyle:gu,getMultiGeometryStyle:K2,getGeometryStyle:e8,getLabelStyle:Q2,createStyle:qrt,returnLegendByStyleId:Brt},Wrt=()=>{};async function Vrt(r,t,e){if(t.featureStyles&&Array.isArray(e)){await Dx.initializeStyleList({},{styleConf:t.featureStyles},t.layers.map(n=>{const s=e.find(o=>o.id===n.id);return s?{...n,typ:s.typ}:n}),[],Wrt);const i=t.markers?t.markers.layers.map(({id:n})=>n):[];r.getLayers().getArray().filter(n=>typeof n.get("styleId")=="string"&&!i.includes(n.get("id"))).forEach(n=>{const s=Dx.returnStyleObject(n.get("styleId"));s&&n.setStyle(o=>Urt.createStyle(s,o,o.get("features")!==void 0,""))})}}let xv=[];function E3(r,t,e){for(const i of xv)r.removeInteraction(i);xv=trt(t,e);for(const i of xv)r.addInteraction(i)}const Zrt={key:0,class:"polar-map-overlay"},Hrt=je({__name:"PolarMapOverlay.ce",setup(r,{expose:t}){const e=me(""),i=me(null),n=me(null),s=me(null);function o(){i.value&&i.value(),e.value="",n.value&&n.value(),s.value&&clearTimeout(s.value)}function a(l,c=null,h=2e3){i.value=Zr(l,u=>{e.value=u},{immediate:!0}),c&&(n.value=Zr(c,u=>{u||o()},{immediate:!0})),h>0&&(s.value=setTimeout(o,h))}return t({show:a,hide:o}),(l,c)=>(ht(),Ee(oO,{name:"fade"},{default:Ps(()=>[e.value?(ht(),Gt("div",Zrt,nr(e.value),1)):xr("",!0)]),_:1}))}}),Yrt=".polar-map-overlay[data-v-e3473669]{position:absolute;display:flex;justify-content:center;align-items:center;width:inherit;height:inherit;z-index:42;font-size:var(--kern-typography-font-size-static-large);text-align:center;color:#fff;background-color:#00000073;pointer-events:none}.fade-enter-active[data-v-e3473669],.fade-leave-active[data-v-e3473669]{transition:opacity .5s}.fade-enter[data-v-e3473669],.fade-leave-to[data-v-e3473669]{opacity:0}",Xrt=gr(Hrt,[["styles",[Yrt]],["__scopeId","data-v-e3473669"]]),Krt=["aria-label"],Qrt=je({__name:"PolarMap.ce",setup(r){const t=zu(),{hasWindowSize:e,hasSmallDisplay:i,center:n,zoom:s}=yr(t),o=_u("polar-map-container"),a=_u("polar-map-overlay");function l(){n.value=t.map.getView().getCenter()||n.value,s.value=t.map.getView().getZoom()||s.value}function c(){t.map=Het.map.createMap({target:o.value,extent:void 0,...t.configuration,layerConf:t.serviceRegister},"2D",{mapParams:{interactions:DP({altShiftDragRotate:!1,pinchRotate:!1,dragPan:!1,mouseWheelZoom:!1,keyboard:!1})}}),t.map.on("moveend",l),E3(t.map,e.value,i.value),ert().forEach(m=>{t.map.addInteraction(m)}),p()}Zr(e,m=>{E3(t.map,m,i.value)}),Zr(n,m=>{t.map.getView().animate({center:m,duration:400,easing:Tl})}),Zr(s,m=>{t.map.getView().setZoom(m)});const h=navigator.userAgent.indexOf("Mac")!==-1,u=_v(()=>Ci(m=>m.overlay.noCommandOnZoom,{ns:"core"})),d=_v(()=>Ci(m=>m.overlay.noControlOnZoom,{ns:"core"}));function g(m){if(e.value||!a.value)return;const y=Ct(()=>!e.value);h&&!m.metaKey?a.value.show(u,y):!h&&!m.ctrlKey&&a.value.show(d,y)}zc(async()=>{c(),t.configuration.checkServiceAvailability&&Jet(t.configuration,t.serviceRegister),t.configuration.markers&&wrt(t.map),await Vrt(t.map,t.configuration,t.serviceRegister)});const f=_v(()=>Ci(m=>m.overlay.oneFingerPan,{ns:"core"}));function p(){!e.value&&o.value&&t.hasSmallDisplay&&new Ket(o.value).on("pan",m=>{a.value&&m.maxPointers===1&&t.map.getInteractions().getArray().some(y=>y.get("_isPolarDragLikeInteraction"))&&a.value.show(f)})}return Zr(e,p),(m,y)=>(ht(),Gt(ri,null,[po(Xrt,{ref:"polar-map-overlay"},null,512),Yt("div",{ref:"polar-map-container",class:"polar-map",tabindex:"0",role:"region","aria-label":m.$t(_=>_.canvas.label,{ns:"core"}),onWheel:g},null,40,Krt)],64))}}),Jrt=':root,:host{--ol-background-color: white;--ol-accent-background-color: #F5F5F5;--ol-subtle-background-color: rgba(128, 128, 128, .25);--ol-partial-background-color: rgba(255, 255, 255, .75);--ol-foreground-color: #333333;--ol-subtle-foreground-color: #666666;--ol-brand-color: #00AAFF}.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{width:1px;height:15px;background-color:var(--ol-foreground-color);float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:10px;z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{position:absolute;font-size:12px;text-align:center;bottom:25px;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color)}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:var(--ol-subtle-background-color);border-radius:4px}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:var(--ol-subtle-foreground-color);font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:var(--ol-background-color);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.ol-overviewmap .ol-viewport:hover{cursor:pointer}',tit=".polar-map[data-v-abb3f9c5]{width:100%;height:100%}",eit=gr(Qrt,[["styles",[Jrt,tit]],["__scopeId","data-v-abb3f9c5"]]);var r8=(r=>(r.TOP_LEFT="top-left top left layout-region",r.TOP_MIDDLE="top-mid mid top layout-region",r.TOP_RIGHT="top-right top right layout-region",r.MIDDLE_LEFT="mid-left mid left layout-region",r.MIDDLE_MIDDLE="mid-mid mid layout-region",r.MIDDLE_RIGHT="mid-right mid right layout-region",r.BOTTOM_LEFT="bottom-left bottom left layout-region",r.BOTTOM_MIDDLE="bottom-mid mid bottom layout-region",r.BOTTOM_RIGHT="bottom-right bottom right layout-region",r))(r8||{});const rit=je({__name:"NineLayout.ce",setup(r){const t=Object.entries(r8),e=zu(),{hasWindowSize:i}=yr(e),n=fw(),s=Ct(()=>t.reduce((o,[a])=>({...o,[a]:n.plugins.filter(({id:l,independent:c,options:h})=>{if(h?.displayComponent&&!h.layoutTag)return console.warn(`@polar/polar(core/components/layouts/NineLayout.ce.vue?vue&type=script&setup=true&lang:30:7)
`,`@polar/polar(core/components/layouts/NineLayout.ce:38:7)
`,`Component of plugin "${l}" was registered as visible ('displayComponent' had a truthy value), but no 'layoutTag' was associated. This may be an error in configuration and will lead to the component not being visible in the UI.`),!1;const u=typeof h?.displayComponent=="boolean"?h.displayComponent:!1;return typeof c=="boolean"?u&&c:u}).filter(({options:l})=>l?.layoutTag===a)}),{}));return(o,a)=>(ht(!0),Gt(ri,null,tn(nt(t),([l,c],h)=>(ht(),Gt("div",{key:h,class:mr([{[c]:!0,"has-window-size":nt(i)},"layout-region"])},[(ht(!0),Gt(ri,null,tn(s.value[l],(u,d)=>(ht(),Ee(yn(u.component),{key:`${h}-${d}`}))),128))],2))),128))}}),iit=".layout-region{&[data-v-bf916003]{display:flex;flex-direction:column;justify-content:center;align-items:center;position:absolute;max-width:100%}&[data-v-bf916003]>*{pointer-events:all}&.has-window-size[data-v-bf916003]{max-height:100%}&.mid[data-v-bf916003]{inset:33%}&.left[data-v-bf916003]{left:0;right:auto;align-items:flex-start}&.right[data-v-bf916003]{right:0;left:66%;align-items:flex-end}&.top[data-v-bf916003]{top:0;justify-content:flex-start}&.bottom[data-v-bf916003]{bottom:0;justify-content:flex-end}}",nit=gr(rit,[["styles",[iit]],["__scopeId","data-v-bf916003"]]),sit=je({__name:"StandardLayout.ce",setup(r){const t=fw(),e=Ct(()=>t.plugins.filter(({component:i,independent:n})=>i&&(typeof n=="boolean"?n:!0)));return(i,n)=>(ht(!0),Gt(ri,null,tn(e.value,({component:s,id:o},a)=>(ht(),Gt("div",{key:`${o}-${a}`,class:"layout"},[(ht(),Ee(yn(s)))]))),128))}}),oit=".layout[data-v-14621b9a]{pointer-events:all}",ait=gr(sit,[["styles",[oit]],["__scopeId","data-v-14621b9a"]]),lit=je({__name:"PolarUI.ce",setup(r){const t=zu(),{hasWindowSize:e}=yr(t),i=Ct(()=>t.layout==="standard"?ait:t.layout==="nineRegions"?nit:t.layout);return(n,s)=>(ht(),Gt("div",{class:mr(["polar-ui",{"polar-shadow":!nt(e)}])},[(ht(),Ee(yn(i.value)))],2))}}),cit='.polar-ui[data-v-94b8d84c]{position:absolute;inset:0;pointer-events:none;width:100%;height:100%}.polar-shadow{&[data-v-94b8d84c]:before{content:"";position:absolute;box-shadow:inset 0 1px 1px #35395680,inset 0 1px 2px #35395680,inset 0 1px 6px #6e759780;inset:0;z-index:1;border-radius:var(--kern-metric-border-radius-large);pointer-events:none}}',hit=gr(lit,[["styles",[cit]],["__scopeId","data-v-94b8d84c"]]),uit=["lang","data-kern-theme"],dit=je({inheritAttrs:!1,__name:"PolarContainer.ce",props:{mapConfiguration:{type:Object},serviceRegister:{type:Array}},setup(r,{expose:t}){rO(d=>({v62ab46c2:nt(i).configuration.theme?.brandColor?.l,v62ab46d4:nt(i).configuration.theme?.brandColor?.c,v62ab46ca:nt(i).configuration.theme?.brandColor?.h}));const e=r;t();const i=zu(),{hasSmallWidth:n,hasWindowSize:s,language:o}=yr(i);i.configuration=Lr(i.configuration,fZ(e.mapConfiguration)),i.configuration.colorScheme&&(i.colorScheme=i.configuration.colorScheme),i.configuration.oidcToken&&(i.oidcToken=i.configuration.oidcToken),i.configuration.locales&&i.configuration.locales.forEach(d=>{Object.entries(d.resources).forEach(([g,f])=>{ws.addResourceBundle(d.type,g,f,!0,!0)})}),i.configuration.language&&ws.changeLanguage(i.configuration.language).catch(d=>{console.error(`@polar/polar(core/components/PolarContainer.ce.vue?vue&type=script&setup=true&lang:85:4)
`,`@polar/polar(core/components/PolarContainer.ce:84:4)
`,"Failed to set initial language:",d)}),i.serviceRegister=e.serviceRegister,i.language=ws.language,ws.on("languageChanged",d=>{i.language=d}),Zr(()=>i.language,async d=>{ws.language!==d&&await ws.changeLanguage(d)});const a=_u("polar-wrapper");let l=null;const{isActive:c}=yr(PM()),h=me(0);Zr(c,()=>h.value+=1);function u(){i.clientHeight=a.value.clientHeight,i.clientWidth=a.value.clientWidth}return zc(()=>{i.lightElement=iO(),i.shadowRoot=nO(),gZ(i.shadowRoot,i.configuration.theme?.kern||{}),i.setup(),l=new ResizeObserver(u),l.observe(a.value),u(),i.lightElement.store=ar()}),t1(()=>{l instanceof ResizeObserver&&(l.unobserve(a.value),l=null),i.teardown()}),(d,g)=>(ht(),Gt("div",{ref:"polar-wrapper",class:"polar-wrapper",lang:nt(o),"data-kern-theme":nt(i).colorScheme},[po(eit),po(hit),nt(c)&&nt(s)&&nt(n)?(ht(),Ee(_Z,{key:h.value})):xr("",!0)],8,uit))}}),git=":host{--brand-color-l: var(--v62ab46c2);--brand-color-c: var(--v62ab46d4);--brand-color-h: var(--v62ab46ca);--polar-shadow-color: 0deg 0% 63%;--polar-shadow: 0 .5px .5px hsl(var(--polar-shadow-color) / .43), 0 1.5px 1.6px -1px hsl(var(--polar-shadow-color) / .4), 0 4px 4.2px -2px hsl(var(--polar-shadow-color) / .36), -.1px 10.1px 10.6px -3px hsl(var(--polar-shadow-color) / .32)}@layer polar-map{:host{display:block;width:100%;height:30em;border-radius:var(--kern-metric-border-radius-large);overflow:hidden;box-sizing:border-box}}",fit=".polar-wrapper[data-v-cf4d0708]{position:relative;height:100%;width:100%}",pit=gr(dit,[["styles",[git,fit]],["__scopeId","data-v-cf4d0708"]]),{slice:mit,forEach:yit}=[];function _it(r){return yit.call(mit.call(arguments,1),t=>{if(t)for(const e in t)r[e]===void 0&&(r[e]=t[e])}),r}function vit(r){return typeof r!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(t=>t.test(r))}const S3=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,xit=function(r,t){const e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},i=encodeURIComponent(t);let n=`${r}=${i}`;if(e.maxAge>0){const s=e.maxAge-0;if(Number.isNaN(s))throw new Error("maxAge should be a Number");n+=`; Max-Age=${Math.floor(s)}`}if(e.domain){if(!S3.test(e.domain))throw new TypeError("option domain is invalid");n+=`; Domain=${e.domain}`}if(e.path){if(!S3.test(e.path))throw new TypeError("option path is invalid");n+=`; Path=${e.path}`}if(e.expires){if(typeof e.expires.toUTCString!="function")throw new TypeError("option expires is invalid");n+=`; Expires=${e.expires.toUTCString()}`}if(e.httpOnly&&(n+="; HttpOnly"),e.secure&&(n+="; Secure"),e.sameSite)switch(typeof e.sameSite=="string"?e.sameSite.toLowerCase():e.sameSite){case!0:n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"strict":n+="; SameSite=Strict";break;case"none":n+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return e.partitioned&&(n+="; Partitioned"),n},T3={create(r,t,e,i){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};e&&(n.expires=new Date,n.expires.setTime(n.expires.getTime()+e*60*1e3)),i&&(n.domain=i),document.cookie=xit(r,t,n)},read(r){const t=`${r}=`,e=document.cookie.split(";");for(let i=0;i<e.length;i++){let n=e[i];for(;n.charAt(0)===" ";)n=n.substring(1,n.length);if(n.indexOf(t)===0)return n.substring(t.length,n.length)}return null},remove(r,t){this.create(r,"",-1,t)}};var wit={name:"cookie",lookup(r){let{lookupCookie:t}=r;if(t&&typeof document<"u")return T3.read(t)||void 0},cacheUserLanguage(r,t){let{lookupCookie:e,cookieMinutes:i,cookieDomain:n,cookieOptions:s}=t;e&&typeof document<"u"&&T3.create(e,r,i,n,s)}},bit={name:"querystring",lookup(r){let{lookupQuerystring:t}=r,e;if(typeof window<"u"){let{search:i}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));const n=i.substring(1).split("&");for(let s=0;s<n.length;s++){const o=n[s].indexOf("=");o>0&&n[s].substring(0,o)===t&&(e=n[s].substring(o+1))}}return e}},kit={name:"hash",lookup(r){let{lookupHash:t,lookupFromHashIndex:e}=r,i;if(typeof window<"u"){const{hash:n}=window.location;if(n&&n.length>2){const s=n.substring(1);if(t){const o=s.split("&");for(let a=0;a<o.length;a++){const l=o[a].indexOf("=");l>0&&o[a].substring(0,l)===t&&(i=o[a].substring(l+1))}}if(i)return i;if(!i&&e>-1){const o=n.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?o[typeof e=="number"?e:0]?.replace("/",""):void 0}}}return i}};let wh=null;const C3=()=>{if(wh!==null)return wh;try{if(wh=typeof window<"u"&&window.localStorage!==null,!wh)return!1;const r="i18next.translate.boo";window.localStorage.setItem(r,"foo"),window.localStorage.removeItem(r)}catch{wh=!1}return wh};var Eit={name:"localStorage",lookup(r){let{lookupLocalStorage:t}=r;if(t&&C3())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(r,t){let{lookupLocalStorage:e}=t;e&&C3()&&window.localStorage.setItem(e,r)}};let bh=null;const M3=()=>{if(bh!==null)return bh;try{if(bh=typeof window<"u"&&window.sessionStorage!==null,!bh)return!1;const r="i18next.translate.boo";window.sessionStorage.setItem(r,"foo"),window.sessionStorage.removeItem(r)}catch{bh=!1}return bh};var Sit={name:"sessionStorage",lookup(r){let{lookupSessionStorage:t}=r;if(t&&M3())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(r,t){let{lookupSessionStorage:e}=t;e&&M3()&&window.sessionStorage.setItem(e,r)}},Tit={name:"navigator",lookup(r){const t=[];if(typeof navigator<"u"){const{languages:e,userLanguage:i,language:n}=navigator;if(e)for(let s=0;s<e.length;s++)t.push(e[s]);i&&t.push(i),n&&t.push(n)}return t.length>0?t:void 0}},Cit={name:"htmlTag",lookup(r){let{htmlTag:t}=r,e;const i=t||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(e=i.getAttribute("lang")),e}},Mit={name:"path",lookup(r){let{lookupFromPathIndex:t}=r;if(typeof window>"u")return;const e=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(e)?e[typeof t=="number"?t:0]?.replace("/",""):void 0}},Rit={name:"subdomain",lookup(r){let{lookupFromSubdomainIndex:t}=r;const e=typeof t=="number"?t+1:1,i=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(i)return i[e]}};let i8=!1;try{document.cookie,i8=!0}catch{}const n8=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];i8||n8.splice(1,1);const Iit=()=>({order:n8,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:r=>r});class s8{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(t,e)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=t,this.options=_it(e,this.options||{},Iit()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=n=>n.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(wit),this.addDetector(bit),this.addDetector(Eit),this.addDetector(Sit),this.addDetector(Tit),this.addDetector(Cit),this.addDetector(Mit),this.addDetector(Rit),this.addDetector(kit)}addDetector(t){return this.detectors[t.name]=t,this}detect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,e=[];return t.forEach(i=>{if(this.detectors[i]){let n=this.detectors[i].lookup(this.options);n&&typeof n=="string"&&(n=[n]),n&&(e=e.concat(n))}}),e=e.filter(i=>i!=null&&!vit(i)).map(i=>this.options.convertDetectedLanguage(i)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?e:e.length>0?e[0]:null}cacheUserLanguage(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;e&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||e.forEach(i=>{this.detectors[i]&&this.detectors[i].cacheUserLanguage(t,this.options)}))}}s8.type="languageDetector";const o8=Symbol();function Pit(r,{i18next:t,rerenderOn:e=["languageChanged","loaded","added","removed"],slotStart:i="{",slotEnd:n="}"}){const s=eO(new Date),o=()=>ju(()=>{s.value=new Date}),a=()=>s.value;e.forEach(h=>{switch(h){case"added":case"removed":t.store?.on(h,o);break;default:t.on(h,o);break}}),r.component("i18next",Oit);const l=()=>t.isInitialized;r.config.globalProperties.$t=R3(t.t.bind(t),a,l);const c=new Proxy(t,{get(h,u){return a(),Reflect.get(h,u)}});r.config.globalProperties.$i18next=c,r.provide(o8,{i18next:c,slotPattern:Lit(i,n),withAccessRecording(h,u){return R3(h,a,u)}})}function R3(r,t,e){return new Proxy(r,{apply:function(i,n,s){return t(),e()?Reflect.apply(i,n,s):""}})}function Ait(){const r=MM(o8);if(!r)throw new Error("i18next-vue: Make sure to register the i18next-vue plugin using app.use(...).");return r}function Lit(r,t){const e=`${r}\\s*([a-z0-9\\-]+)\\s*${t}`;return new RegExp(e,"gi")}const Oit=je({props:{translation:{type:String,required:!0}},setup(r,{slots:t}){const{slotPattern:e}=Ait();return()=>{const i=r.translation,n=[];let s,o=0;for(;(s=e.exec(i))!==null;){n.push(i.substring(o,s.index));const a=t[s[1]];a?n.push(...a()):n.push(s[0]),o=e.lastIndex}return n.push(i.substring(o)),n}}}),Fit={canvas:{label:"Kartenanwendung"},error:{serviceUnavailable:'Der Kartendienst "{{serviceName}}" (ID: {{serviceId}}) ist derzeit nicht verfÃ¼gbar. Dies kann die FunktionalitÃ¤t der Karte einschrÃ¤nken.'},overlay:{noControlOnZoom:"Verwenden Sie Strg+Scrollen zum Zoomen der Karte",noCommandOnZoom:"Verwenden Sie Command â + Scrollen zum Zoomen der Karte",oneFingerPan:"Verwenden Sie mindestens zwei Finger zum Verschieben der Karte"}},Nit={canvas:{label:"Map application"},error:{serviceUnavailable:`Service  "{{serviceName}}" (ID: {{serviceId}}) is unavailable. This may limit the map's functionality.`},overlay:{noControlOnZoom:"Use Ctrl+Mousewheel to zoom into the map",noCommandOnZoom:"Use Command â + Mousewheel to zoom into the map",oneFingerPan:"Use at least two fingers to pan the map"}},wv=[{type:"de",resources:Fit},{type:"en",resources:Nit}],Dit="core",$it={async install(r){r.use(Pit,{i18next:ws}),ws.use(s8);try{await ws.init({resources:Object.fromEntries(wv.map(({type:t,resources:e})=>[t,{core:e}])),detection:{lookupQuerystring:"lng",order:["querystring","navigator","htmlTag"]},load:"languageOnly",fallbackLng:wv[0]?.type,ns:[Dit],supportedLngs:wv.map(({type:t})=>t)}),console.info(`@polar/polar(core/vuePlugins/i18next:32:4)
`,"Successfully initialized i18next.")}catch(t){console.error(`@polar/polar(core/vuePlugins/i18next:34:4)
`,"Error while initializing:",t)}}};function Git({store:r}){}function jit({pinia:r,store:t}){t._instance=r}const zit={install(r){const t=gO();t.use(jit),t.use(Git),r.use(t)}},a8=/{(?<key>[^=]+)=(?<value>[^}]+)}/gm;function qit(r,t){const e={},i=t.replaceAll(a8,(n,s,o)=>(e[s]=o,""));fetch(i,{method:"GET",headers:e}).then(n=>n.ok?n.blob():n.text().then(s=>{throw new Error(s)})).then(n=>{r.getImage().src=URL.createObjectURL(n)}).catch(n=>{console.error(`@polar/polar(core/monkeyHeaderLoader:32:4)
`,n)})}const Bit=rf.prototype.addLayer;rf.prototype.addLayer=function(...r){Bit.call(this,...r),rf.prototype.getLayers.call(this).getArray().forEach(t=>{if(!(t instanceof gy))return;const e=t.getSource();e.urls?.some(i=>a8.test(i))&&typeof e.setTileLoadFunction=="function"&&(e.setTileLoadFunction(qit),t.setSource(e))})};async function Uit(r){return await new Promise(t=>Ml.initializeLayerList(r,t))}function Wit(r,t){const e=document.createElement("polar-map");return e.mapConfiguration=r,e.serviceRegister=t,e}async function vdt(r,t,e){customElements.get("polar-map")||Hit(),typeof e=="string"&&(e=await Uit(e));const i=Wit(t,e),n=document.getElementById(r);if(!n)throw new Error(`Container with ID '${r}' not found`);return i.id=n.id,n.classList.forEach(s=>i.classList.add(s)),n.replaceWith(i),i}function xdt(r,t){t.forEach(e=>{Vit(r,e)})}function Vit(r,t){r.store.addPlugin(t)}function wdt(r,t){r.store.removePlugin(t)}function l8(r,t){return t==="core"?r.store:r.store.getPluginStore(t)}function bdt(r,t,e,i,n){const s=l8(r,t);return Zr(()=>s[e],i,{immediate:!0,...n})}function kdt(r,t,e,i){const n=l8(r,t);n[e]=i}const Zit=tO(pit,{configureApp(r){r.use(zit),r.use($it)}});function Hit(){customElements.define("polar-map",Zit)}const Yit={class:"kern-card kern-card--small"},Xit={class:"kern-card__container"},Kit=je({__name:"PolarCard.ce",setup(r){return(t,e)=>(ht(),Gt("article",Yit,[Yt("div",Xit,[gw(t.$slots,"default",{},void 0,!0)])]))}}),Qit=".kern-card{&[data-v-937e165b]{height:auto;min-width:25rem;border-radius:var(--kern-metric-border-radius-large);box-shadow:var(--polar-shadow)}.kern-card__container[data-v-937e165b]{padding:var(--kern-metric-space-small);padding-bottom:.625rem}}",LE=gr(Kit,[["styles",[Qit]],["__scopeId","data-v-937e165b"]]),Jit={class:"kern-form-input"},tnt=["for"],ent=["id","aria-label","disabled","required","multiple","value"],rnt={key:0,value:""},int=["value","aria-label"],nnt=je({__name:"PolarSelect.ce",props:{label:{default:"",type:String},ariaLabel:{default:void 0,type:String},defaultLabel:{default:"",type:String},value:{type:[String,Array]},options:{type:Array},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},small:{type:Boolean,default:!1},id:{default:"",type:String}},emits:["update:value"],setup(r,{emit:t}){const e=r,i=aO(),n=Ct(()=>e.id||i),s=t;function o(a){const l=a.target;if(e.multiple){const c=Array.from(l.selectedOptions).map(h=>h.value);s("update:value",c)}else s("update:value",l.value)}return(a,l)=>(ht(),Gt("div",Jit,[r.label?(ht(),Gt("label",{key:0,class:"kern-label",for:n.value},nr(r.label),9,tnt)):xr("",!0),Yt("div",{class:mr(["kern-form-input__select-wrapper",r.small?"small":""])},[Yt("select",{id:n.value,class:"kern-form-input__select","aria-label":r.ariaLabel,disabled:r.disabled,required:r.required,multiple:r.multiple,value:r.value,onChange:o},[r.defaultLabel?(ht(),Gt("option",rnt,nr(r.defaultLabel),1)):xr("",!0),(ht(!0),Gt(ri,null,tn(r.options,({value:c,label:h,ariaLabel:u})=>(ht(),Gt("option",{key:c,value:c,"aria-label":u},nr(h),9,int))),128))],40,ent)],2)]))}}),snt=".kern-form-input__select-wrapper.small{&[data-v-f13e0d28]{height:var(--kern-metric-dimension-default)}.kern-form-input__select[data-v-f13e0d28]{padding-top:0;padding-bottom:0}&[data-v-f13e0d28]:after{position:absolute;top:50%;transform:translateY(-50%)}&[data-v-f13e0d28]:hover:not(:focus-within):after{top:calc(50% + calc(calc(var(--kern-metric-border-width-bold) - var(--kern-metric-border-width-default)) / 2))}}",c8=gr(nnt,[["styles",[snt]],["__scopeId","data-v-f13e0d28"]]),J2="http://www.w3.org/2001/XMLSchema-instance";function ge(r,t){return OE().createElementNS(r,t)}function jc(r,t){return h8(r,t,[]).join("")}function h8(r,t,e){if(r.nodeType==Node.CDATA_SECTION_NODE||r.nodeType==Node.TEXT_NODE)e.push(r.nodeValue);else{let i;for(i=r.firstChild;i;i=i.nextSibling)h8(i,t,e)}return e}function sc(r){return"documentElement"in r}function ont(r,t,e){return r.getAttributeNS(t,e)||""}function oc(r){return new DOMParser().parseFromString(r,"application/xml")}function u8(r,t){return(function(e,i){const n=r.call(this,e,i);if(n!==void 0){const s=i[i.length-1];wi(s,n)}})}function oe(r,t){return(function(e,i){const n=r.call(t??this,e,i);n!==void 0&&i[i.length-1].push(n)})}function Kt(r,t){return(function(e,i){const n=r.call(t??this,e,i);n!==void 0&&(i[i.length-1]=n)})}function Ti(r,t,e){return(function(i,n){const s=r.call(this,i,n);if(s!==void 0){const o=n[n.length-1],a=i.localName;let l;a in o?l=o[a]:(l=[],o[a]=l),l.push(s)}})}function bt(r,t,e){return(function(i,n){const s=r.call(this,i,n);if(s!==void 0){const o=n[n.length-1],a=t!==void 0?t:i.localName;o[a]=s}})}function tt(r,t){return(function(e,i,n){r.call(t??this,e,i,n),n[n.length-1].node.appendChild(e)})}function jn(r,t){return(function(e,i,n){const s=i[i.length-1].node;let o=r;o===void 0&&(o=n);const a=t!==void 0?t:s.namespaceURI;return ge(a,o)})}const d8=jn();function di(r,t,e){e=e!==void 0?e:{};let i,n;for(i=0,n=r.length;i<n;++i)e[r[i]]=t;return e}function wc(r,t,e,i){let n;for(n=t.firstElementChild;n;n=n.nextElementSibling){const s=r[n.namespaceURI];if(s!==void 0){const o=s[n.localName];o!==void 0&&o.call(i,n,e)}}}function re(r,t,e,i,n){return i.push(r),wc(t,e,i,n),i.pop()}function ant(r,t,e,i,n,s){const o=(n!==void 0?n:e).length;let a,l;for(let c=0;c<o;++c)a=e[c],a!==void 0&&(l=t.call(s,a,i,n!==void 0?n[c]:void 0),l!==void 0&&r[l.namespaceURI][l.localName].call(s,l,a,i))}function jr(r,t,e,i,n,s,o){return n.push(r),ant(t,e,i,n,s,o),n.pop()}let bv;function lnt(){return bv===void 0&&typeof XMLSerializer<"u"&&(bv=new XMLSerializer),bv}let kv;function OE(){return kv===void 0&&typeof document<"u"&&(kv=document.implementation.createDocument("","",null)),kv}function Ln(r){const t=/^\s*(true|1)|(false|0)\s*$/.exec(r);if(t)return t[1]!==void 0||!1}function Kh(r){const t=jc(r,!1);return bs(t)}function bs(r){const t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(r);if(t)return parseFloat(t[1])}function zo(r){const t=jc(r,!1);return Vo(t)}function Vo(r){const t=/^\s*(\d+)\s*$/.exec(r);if(t)return parseInt(t[1],10)}function Ge(r){return jc(r,!1).trim()}function cnt(r,t){r.appendChild(OE().createCDATASection(t))}const hnt=/^\s/,unt=/\s$/,dnt=/(\n|\t|\r|<|&| {2})/;function si(r,t){typeof t=="string"&&(hnt.test(t)||unt.test(t)||dnt.test(t))?t.split("]]>").forEach((e,i,n)=>{i<n.length-1&&(e+="]]"),i>0&&(e=">"+e),cnt(r,e)}):r.appendChild(OE().createTextNode(t))}function g8(r,t,{signal:e,edges:i}={}){let n,s=null;const o=i!=null&&i.includes("leading"),a=i==null||i.includes("trailing"),l=()=>{s!==null&&(r.apply(n,s),n=void 0,s=null)},c=()=>{a&&l(),g()};let h=null;const u=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,c()},t)},d=()=>{h!==null&&(clearTimeout(h),h=null)},g=()=>{d(),n=void 0,s=null},f=()=>{l()},p=function(...m){if(e?.aborted)return;n=this,s=m;const y=h==null;u(),o&&y&&l()};return p.schedule=u,p.cancel=g,p.flush=f,e?.addEventListener("abort",g,{once:!0}),p}function gnt(r){const t=r.map(parseFloat),e=[];for(;t.length;)e.push(t.splice(0,2));return e}function fnt(r,t,e={}){r.getView().fit(t,e)}function pnt(r,t,e={}){let i;switch(t.geometry.type){case"Polygon":i=new ia([gnt(t.geometry.coordinates)]);break;case"Point":i=new xl(t.geometry.coordinates.map(parseFloat));break;default:console.warn(`ZoomTo for type ${t.geometry.type} not implemented.`);return}fnt(r,i,e)}const Ze={STREET:"street",DISTRICT:"district",PARCEL:"parcel",STREET_KEY:"streetKey",ADDRESS_AFFIXED:"addressAffixed",ADDRESS_UNAFFIXED:"addressUnaffixed",HOUSE_NUMBERS_FOR_STREET:"houseNumbersForStreet"};function f8(r){return Array.isArray(r)&&r.length===1?f8(r[0]):r}function Bm(r,t){return Array.isArray(r)?r.map(e=>Bm(e,t)).filter(e=>e)[0]:typeof r!="object"?null:typeof r[t]<"u"?r[t]:Object.keys(r).map(e=>Bm(r[e],t)).filter(e=>e)[0]}function mnt(r){const t={objectType:Object.keys(r)[0]};return Object.keys(r[t.objectType][0]).forEach(e=>{t[e]=f8(r[t.objectType][0][e])}),t}function ynt(r){let t=[];return r.startsWith("POINT")&&(t=r.split(")")[0]?.split("(")[1]),t}function _nt(r,t){const e={type:t,properties:mnt(r)};let i=e.properties?.pos?ynt(e.properties.pos):Bm(e.properties,"pos")[0],n="",s="",o="";switch(t){case Ze.DISTRICT:e.name=e.properties.geographicIdentifier?._?e.properties.geographicIdentifier._:e.properties.geographicIdentifier;break;case Ze.STREET_KEY:case Ze.STREET:e.properties?.position_strassenachse&&(i=Bm(e.properties?.position_strassenachse,"pos")[0]),e.name=Rp()?e.properties.geographicIdentifier._:e.properties.strassenname;break;case Ze.PARCEL:e.name=`${e.properties.gemarkung}/${e.properties.flurstuecksnummer}`;break;case Ze.HOUSE_NUMBERS_FOR_STREET:n=e.properties.hausnummer?._?e.properties.hausnummer._:e.properties.hausnummer,e.properties.hausnummernzusatz&&(s=e.properties.hausnummernzusatz?._?e.properties.hausnummernzusatz._:e.properties.hausnummernzusatz),e.properties.hausnummerkomplett=`${n}${s}`,e.name=Rp()?e.properties.geographicIdentifier._:(e.properties?.geographicIdentifier?e.properties.geographicIdentifier._.split(e.properties.hausnummerkomplett)[0]:e.properties.strassenname+" ")+e.properties.hausnummerkomplett;break;case Ze.ADDRESS_AFFIXED:o=e.properties.strassenname?._?e.properties.strassenname._:e.properties.strassenname,n=e.properties.hausnummer?._?e.properties.hausnummer._:e.properties.hausnummer,s=e.properties.hausnummernzusatz?._?e.properties.hausnummernzusatz._:e.properties.hausnummernzusatz,e.name=Rp()?e.properties.geographicIdentifier._:`${o} ${n}${s}`;break;case Ze.ADDRESS_UNAFFIXED:o=e.properties.strassenname?._?e.properties.strassenname._:e.properties.strassenname,n=e.properties.hausnummer?._?e.properties.hausnummer._:e.properties.hausnummer,e.name=Rp()?e.properties.geographicIdentifier._:(e.properties?.geographicIdentifier?e.properties.geographicIdentifier._.split(n)[0]:o+" ")+n;break;default:e.name=null,console.error(`Unknown type in searchAddress.parse: '${t}'. Could not set name.`);break}switch(t){case Ze.DISTRICT:case Ze.STREET_KEY:case Ze.STREET:case Ze.PARCEL:case Ze.HOUSE_NUMBERS_FOR_STREET:case Ze.ADDRESS_AFFIXED:case Ze.ADDRESS_UNAFFIXED:e.geometry={type:"Point",coordinates:i.split(" ")};break;default:e.geometry=null,console.error(`Unknown type in searchAddress.parse: '${t}'. Could not set geometry.`);break}return e}function p8(r,t){return new Promise((e,i)=>{xS.parseString(t,{tagNameProcessors:[xS.processors.stripPrefix]},(n,s)=>{if(n){i(n);return}try{const o=s.FeatureCollection?.member?s.FeatureCollection.member.map(a=>_nt(a,r)).sort((a,l)=>a.name.localeCompare(l.name)):[];e(o)}catch(o){i(o)}})})}function vnt(r){return Array.isArray(r)?r.map(encodeURIComponent):encodeURIComponent(r)}function xnt(r,t,e=!0){return{[Ze.STREET]:i=>e?`&StoredQuery_ID=findeStrasse&strassenname=*${i}`:`&StoredQuery_ID=findeStrasse&strassenname=${i}`,[Ze.DISTRICT]:i=>`&StoredQuery_ID=findeStadtteil&stadtteilname=${i}`,[Ze.PARCEL]:i=>`&StoredQuery_ID=Flurstueck&gemarkung=${i[0]}&flurstuecksnummer=${i[1]}`,[Ze.STREET_KEY]:i=>`&StoredQuery_ID=findeStrassenSchluessel&strassenschluessel=${i}`,[Ze.ADDRESS_AFFIXED]:i=>`&StoredQuery_ID=AdresseMitZusatz&strassenname=${i[0]}&hausnummer=${i[1]}&zusatz=${i[2]}`,[Ze.ADDRESS_UNAFFIXED]:i=>`&StoredQuery_ID=AdresseOhneZusatz&strassenname=${i[0]}&hausnummer=${i[1]}`,[Ze.HOUSE_NUMBERS_FOR_STREET]:i=>`&StoredQuery_ID=HausnummernZuStrasse&strassenname=${i}`}[r](vnt(t))}function m8(r,t,e,i){return new Promise((n,s)=>{const o=JB()+xnt(r,t,i);fetch(o,{signal:e?.signal,timeout:6e3}).then(a=>n(a.text())).catch(a=>s(a))})}let gg=null;function Qh(r,t,e=(s,o)=>s.name.localeCompare(o.name),i=()=>!0,n){return new Promise((s,o)=>{m8(r,t,gg,n).then(a=>{p8(r,a).then(l=>{s(l.filter(i).sort(e))})}).catch(a=>o(a))})}function wnt(r,t,e){return new Promise((i,n)=>{m8(Ze.STREET,r,gg,e).then(s=>p8(Ze.STREET,s)).then(s=>{const o=[],a=r.match(new RegExp("^(.+)[\\s,](\\d+|\\d.*)$"));for(let l=0;l<s.length;l++)o.push([s[l]]),t&&o.push(Qh(Ze.HOUSE_NUMBERS_FOR_STREET,s[l].name,void 0,void 0,e));return!s.length&&a?.length&&t&&o.push(Qh(Ze.HOUSE_NUMBERS_FOR_STREET,a[1],(l,c)=>parseInt(l.properties?.hausnummer,10)-parseInt(c.properties?.hausnummer,10),l=>l.properties?.hausnummerkomplett?.indexOf(a[2])===0,e)),Promise.all(o)}).then(s=>i([].concat(...s))).catch(s=>n(s))})}function I3(r,t,e=!1){return e&&gg!==null&&gg.abort(),gg=new AbortController,new Promise((i,n)=>{const{map:s,zoom:o=!1,zoomToParams:a,searchAddress:l=!1,searchStreets:c=!1,searchStreetBeforeWord:h=!0,searchDistricts:u=!1,searchParcels:d=!1,searchStreetKey:g=!1,minCharacters:f=3}=t,p=[];let{searchHouseNumbers:m=!1}=t;if(r.length<f){n({error:"Search string too short."});return}if(o&&!s&&console.warn("Instructed to zoom, but required map object was not given. Zooming will be skipped."),!c&&m&&(console.warn(`Search for '${r}' supposed to retrieve house numbers, but not streets. Invalid search configuration. House numbers will not be searched for as a result.`),m=!1),!(l||c||m||u||d||g)){n({error:`Search for '${r}' received no indication what to search for. Search is canceled.`});return}if(c&&p.push(wnt(r,m,h)),l){let y=r.split(/(\d+)/).map(x=>x.trim()).filter(x=>x);if(y.length>3){const x=y[0],v=y[1],w=r.replace(y[0],"").replace(y[1],"").trim();y=[x,v,w]}const _=[!1,!1,Ze.ADDRESS_UNAFFIXED,Ze.ADDRESS_AFFIXED][y.length];_&&p.push(Qh(_,y))}if(u&&/^[a-z-Ã¼Ã¤Ã¶Ã]+$/i.test(r)&&p.push(Qh(Ze.DISTRICT,r)),g&&/^[a-z]{1}[0-9]{1,5}$/i.test(r)&&p.push(Qh(Ze.STREET_KEY,r)),d){let y;/^[0-9]{4}[\s|/][0-9]*$/.test(r)?y=r.split(/[\s|/]/):/^[0-9]{5,}$/.test(r)&&(y=[r.slice(0,4),r.slice(4)]),y&&p.push(Qh(Ze.PARCEL,y))}Promise.all(p).then(y=>{const _=[].concat(...y);if(o&&s&&_.length===1)try{pnt(s,_[0],a)}catch(x){console.error("Zooming to element from gazetteer failed."),console.error(x)}i(_)}).catch(y=>n(y))})}const xn="addressSearch";function bnt(r,t){const e=r.reduce((i,n)=>n.status==="fulfilled"?[...i,n.value]:i,[]);return t.signal.aborted||r.filter(({status:i})=>i==="rejected").forEach(({reason:i})=>{console.error(`@polar/polar(plugins/addressSearch/utils/getResultsFromPromises:20:4)
`,"An error occurred while sending a request: ",i)}),e}function y8(r){if(!r.ok)throw new Error(r.status===418?"The server refuses to brew coffee because it is, permanently, a teapot.":`The received status code ${r.status} indicates an error.`)}function knt(r,t){let e=`query=${r.replace(" ","+")}`;for(const[i,n]of Object.entries(t).filter(([s])=>s!=="filter"&&s!=="epsg"&&s!=="apiKey"&&s!=="accessToken"))e+=`&${i}=${n}`;return t.filter&&Object.keys(t.filter).length>0&&(e+="&filter=",e=Object.entries(t.filter).reduce((i,[n,s])=>`${i+n}:${s}&`,e).slice(0,-1)),e}async function Ent(r,t,e,i){const n=`${t}?`+knt(e,i),s={signal:r};i.accessToken?s.headers={Authorization:`Bearer ${i.accessToken}`}:i.apiKey&&(s.headers={"X-Api-Key":i.apiKey});const o=await fetch(encodeURI(n),s);y8(o);const a=await o.json();return{...a,features:a.features.map(l=>Lr(l,{geometry:Lr(l.geometry,{coordinates:i.epsg==="EPSG:4326"?l.geometry.coordinates:qs(l.geometry.coordinates,"EPSG:4326",i.epsg)}),title:l.properties.text}))}}async function Snt(r,t,e,i){RI(t);try{const n=Lr(i,{minCharacters:0});let s=await I3(e,Lr(n,{searchStreetBeforeWord:!1}));return!s[0]&&(s=await I3(e,n),!s[0])?{type:"FeatureCollection",features:[]}:{type:"FeatureCollection",features:Cnt(s,i.epsg,Tnt(s[0].properties.position.Point[0].$.srsName))}}catch(n){throw console.error(`@polar/polar(lib/getFeatures/mpapi:50:3)
`,n),new Error("An error occurred while fetching the feature collection.")}}function Tnt(r){if(r.includes("::"))return`EPSG:${r.split("::")[1]}`;if(r.includes(":"))return r;throw console.error(`@polar/polar(lib/getFeatures/mpapi:63:2)
`,"Unknown formatting of projection:",r),Error("Unknown formatting of projection: "+r)}const Cnt=(r,t,e)=>r.map(i=>{const{name:n,geometry:s}=i;return{type:"Feature",title:n,geometry:Lr(s,{coordinates:e===t?s.coordinates.map(Number):qs(s.coordinates.map(Number),e,t)}),properties:i.properties}}),Mnt=r=>r.replace(/\r?\n|\r/g,""),Rnt=({maxFeatures:r})=>`
<?xml version="1.0" encoding="UTF-8"?>
<wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"${r?` maxFeatures="${r}"`:""}>`,Int={wildCard:"*",singleChar:".",escapeChar:"!"},Pnt=({srsName:r,featurePrefix:t,typeName:e,xmlns:i})=>`
<wfs:Query typeName="${t}:${e}" xmlns:${t}="${i}"${r?` srsName="${r}"`:""}>
<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc">`;function P3(r,t,{featurePrefix:e,useRightHandWildcard:i,likeFilterAttributes:n}){const s=Lr(Int,n||{});return`
<ogc:PropertyIsLike${Object.entries(s).reduce((o,[a,l])=>`${o} ${a}="${l}"`,"")}>
<ogc:PropertyName>${e}:${r}</ogc:PropertyName>
<ogc:Literal>${t}${typeof i=="boolean"&&!i?"":Object.hasOwn(s,"wildCard")?s.wildCard:"*"}</ogc:Literal>
</ogc:PropertyIsLike>`}function Ant(r,t){let e=Pnt(t);if(r.length>1)e+=`<ogc:And>${r.map(([i,n])=>P3(i,n,t)).join("")}</ogc:And>`;else if(r.length===1){const i=r[0];e+=P3(i[0],i[1],t)}return e+"</ogc:Filter></wfs:Query>"}const Zd=(r,t)=>Mnt(Rnt(t)+r.map(e=>Ant(e,t)).join("")+"</wfs:GetFeature>");if(import.meta.vitest){const{expect:r,test:t}=import.meta.vitest,e={typeName:"TyPeNaMe",featurePrefix:"prefix",xmlns:"example.com",maxFeatures:999};t("creates an empty search for an empty input",()=>{r(Zd([],e)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"></wfs:GetFeature>')}),t("creates a one-query search for a single match",()=>{r(Zd([[["a","5"]]],e)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:a</ogc:PropertyName><ogc:Literal>5*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query></wfs:GetFeature>')}),t("creates a one-query and-ed search for a single match with multiple fields",()=>{r(Zd([[["a","5"],["b","3"]]],e)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:And><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:a</ogc:PropertyName><ogc:Literal>5*</ogc:Literal></ogc:PropertyIsLike><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:b</ogc:PropertyName><ogc:Literal>3*</ogc:Literal></ogc:PropertyIsLike></ogc:And></ogc:Filter></wfs:Query></wfs:GetFeature>')}),t("creates a multi-query search for a multiple matches",()=>{r(Zd([[["a","5"]],[["b","3"]]],e)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:a</ogc:PropertyName><ogc:Literal>5*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:b</ogc:PropertyName><ogc:Literal>3*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query></wfs:GetFeature>')})}const Ev={};function FE(r){if(Ev[r])return Ev[r];const t=Array.from(r.matchAll(/{{(.*?)}}/g)),e=[];let i=0;for(const n of t)i<n.index&&(e.push(r.substring(i,n.index)),i=n.index),e.push(n),i+=n[0].length;return Ev[r]=e,e}const Lnt=(r,t)=>r.uninterpreted>t.uninterpreted?1:r.uninterpreted<t.uninterpreted?-1:r.index>t.index?1:r.index<t.index?-1:0,Ont=(r,t,e)=>{const i=[...r.map((s,o)=>({match:s,uninterpreted:e[o],patternLengthDiff:(t[o].match(/{{/g)||[]).length-s.length,index:o}))].sort(Lnt).map(({match:s})=>s),n=[];return i.filter(s=>{if(s.length===0)return!1;const o=JSON.stringify(s);return n.includes(o)?!1:(n.push(o),!0)})},tw=(r,t,e)=>{if(!r)throw new Error('Parameter "patterns" is missing on wfs configuration for pattern-based search.');if(!t)throw new Error('Parameter "patternKeys" is missing on wfs configuration for pattern-based search.');const i=[],n=[];return r.forEach(s=>{const o=FE(s),a=[];let l=e;o.forEach(c=>{let h="";if(Array.isArray(c)){const u=c[1],d=t[u],g=l.match(new RegExp("^"+d));if(g!==null){const f=g[1];a.push([u,f.trim()]),h=g[0].trim()}}else h=c.trim();l.startsWith(h)&&(l=l.substring(h.length).trim())}),n.push(l.length),i.push(a)}),Ont(i,r,n)};if(import.meta.vitest){const{expect:r,test:t}=import.meta.vitest,e=(s,o,a,l,c)=>{const h=[s,o];return h.index=a,h.input=l,h.groups=c,h},i=["{{gemarkung}} {{flur}} {{flstnrzae}}/{{flstnrnen}}, {{flstkennz}}","{{gemarkung}} {{flur}} {{flstnrzae}}, {{flstkennz}}","{{gemarkung}} {{flstnrzae}}/{{flstnrnen}}, {{flstkennz}}","{{gemarkung}} {{flstnrzae}}, {{flstkennz}}","{{flstkennz}}"],n={gemarkung:"([^0-9]+)",flur:"([0-9]+)",flstnrzae:"([0-9]+)",flstnrnen:"([0-9]+)",flstkennz:"([0-9_]+)"};t("getBlocks parts pattern strings to Block[][]",()=>{r(FE(i[0])).toEqual([e("{{gemarkung}}","gemarkung",0,i[0])," ",e("{{flur}}","flur",14,i[0])," ",e("{{flstnrzae}}","flstnrzae",23,i[0]),"/",e("{{flstnrnen}}","flstnrnen",37,i[0]),", ",e("{{flstkennz}}","flstkennz",52,i[0])])}),t("match builds full match groups",()=>{r(tw(i,n,"Musterhausen 12 3/4, 1234___")).toEqual([[["gemarkung","Musterhausen"],["flur","12"],["flstnrzae","3"],["flstnrnen","4"],["flstkennz","1234___"]],[["gemarkung","Musterhausen"],["flur","12"],["flstnrzae","3"]],[["gemarkung","Musterhausen"],["flstnrzae","12"],["flstnrnen","3"]],[["gemarkung","Musterhausen"],["flstnrzae","12"],["flstkennz","3"]]])}),t("match manages to decide the best fit",()=>{r(tw(i,n,"1234___")).toEqual([[["flur","1234"],["flstkennz","___"]],[["flstnrzae","1234"],["flstkennz","___"]],[["flstkennz","1234___"]]])})}let _8=class extends _k{constructor(){super(),this.xmlSerializer_=lnt()}getType(){return"xml"}readFeature(t,e){if(!t)return null;if(typeof t=="string"){const i=oc(t);return this.readFeatureFromDocument(i,e)}return sc(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e)}readFeatureFromDocument(t,e){const i=this.readFeaturesFromDocument(t,e);return i.length>0?i[0]:null}readFeatureFromNode(t,e){return null}readFeatures(t,e){if(!t)return[];if(typeof t=="string"){const i=oc(t);return this.readFeaturesFromDocument(i,e)}return sc(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e)}readFeaturesFromDocument(t,e){const i=[];for(let n=t.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&wi(i,this.readFeaturesFromNode(n,e));return i}readFeaturesFromNode(t,e){return te()}readGeometry(t,e){if(!t)return null;if(typeof t=="string"){const i=oc(t);return this.readGeometryFromDocument(i,e)}return sc(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e)}readGeometryFromDocument(t,e){return null}readGeometryFromNode(t,e){return null}readProjection(t){if(!t)return null;if(typeof t=="string"){const e=oc(t);return this.readProjectionFromDocument(e)}return sc(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}readProjectionFromDocument(t){return this.dataProjection}readProjectionFromNode(t){return this.dataProjection}writeFeature(t,e){const i=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(i)}writeFeatureNode(t,e){return null}writeFeatures(t,e){const i=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(i)}writeFeaturesNode(t,e){return null}writeGeometry(t,e){const i=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(i)}writeGeometryNode(t,e){return null}};const Jo="http://www.opengis.net/gml",Fnt=/^\s*$/;let Lt=class extends _8{constructor(t){super(),t=t||{},this.featureType=t.featureType,this.featureNS=t.featureNS,this.srsName=t.srsName,this.schemaLocation="",this.FEATURE_COLLECTION_PARSERS={},this.FEATURE_COLLECTION_PARSERS[this.namespace]={featureMember:oe(this.readFeaturesInternal),featureMembers:Kt(this.readFeaturesInternal)},this.supportedMediaTypes=["application/gml+xml"]}readFeaturesInternal(t,e){const i=t.localName;let n=null;if(i=="FeatureCollection")n=re([],this.FEATURE_COLLECTION_PARSERS,t,e,this);else if(i=="featureMembers"||i=="featureMember"||i=="member"){const s=e[0];let o=s.featureType,a=s.featureNS;const l="p",c="p0";if(!o&&t.childNodes){o=[],a={};for(let d=0,g=t.childNodes.length;d<g;++d){const f=t.childNodes[d];if(f.nodeType===1){const p=f.nodeName.split(":").pop();if(!o.includes(p)){let m="",y=0;const _=f.namespaceURI;for(const x in a){if(a[x]===_){m=x;break}++y}m||(m=l+y,a[m]=_),o.push(m+":"+p)}}}i!="featureMember"&&(s.featureType=o,s.featureNS=a)}if(typeof a=="string"){const d=a;a={},a[c]=d}const h={},u=Array.isArray(o)?o:[o];for(const d in a){const g={};for(let f=0,p=u.length;f<p;++f)(u[f].includes(":")?u[f].split(":")[0]:c)===d&&(g[u[f].split(":").pop()]=i=="featureMembers"?oe(this.readFeatureElement,this):Kt(this.readFeatureElement,this));h[a[d]]=g}i=="featureMember"||i=="member"?n=re(void 0,h,t,e):n=re([],h,t,e)}return n===null&&(n=[]),n}readGeometryOrExtent(t,e){const i=e[0];return i.srsName=t.firstElementChild.getAttribute("srsName"),i.srsDimension=t.firstElementChild.getAttribute("srsDimension"),re(null,this.GEOMETRY_PARSERS,t,e,this)}readExtentElement(t,e){const i=e[0],n=this.readGeometryOrExtent(t,e);return n?vk(n,i):void 0}readGeometryElement(t,e){const i=e[0],n=this.readGeometryOrExtent(t,e);return n?th(n,!1,i):void 0}readFeatureElementInternal(t,e,i){let n;const s={};for(let l=t.firstElementChild;l;l=l.nextElementSibling){let c;const h=l.localName;l.childNodes.length===0||l.childNodes.length===1&&(l.firstChild.nodeType===3||l.firstChild.nodeType===4)?(c=jc(l,!1),Fnt.test(c)&&(c=void 0)):(i&&(c=h==="boundedBy"?this.readExtentElement(l,e):this.readGeometryElement(l,e)),c?h!=="boundedBy"&&(n=h):c=this.readFeatureElementInternal(l,e,!1));const u=l.attributes.length;if(u>0&&!(c instanceof Kg)){c={_content_:c};for(let d=0;d<u;d++){const g=l.attributes[d].name;c[g]=l.attributes[d].value}}s[h]?(s[h]instanceof Array||(s[h]=[s[h]]),s[h].push(c)):s[h]=c}if(!i)return s;const o=new zi(s);n&&o.setGeometryName(n);const a=t.getAttribute("fid")||ont(t,this.namespace,"id");return a&&o.setId(a),o}readFeatureElement(t,e){return this.readFeatureElementInternal(t,e,!0)}readPoint(t,e){const i=this.readFlatCoordinatesFromNode(t,e);if(i)return new Pi(i,"XYZ")}readMultiPoint(t,e){const i=re([],this.MULTIPOINT_PARSERS,t,e,this);if(i)return new td(i)}readMultiLineString(t,e){const i=re([],this.MULTILINESTRING_PARSERS,t,e,this);if(i)return new Qc(i)}readMultiPolygon(t,e){const i=re([],this.MULTIPOLYGON_PARSERS,t,e,this);if(i)return new Jc(i)}pointMemberParser(t,e){wc(this.POINTMEMBER_PARSERS,t,e,this)}lineStringMemberParser(t,e){wc(this.LINESTRINGMEMBER_PARSERS,t,e,this)}polygonMemberParser(t,e){wc(this.POLYGONMEMBER_PARSERS,t,e,this)}readLineString(t,e){const i=this.readFlatCoordinatesFromNode(t,e);if(i)return new kn(i,"XYZ")}readFlatLinearRing(t,e){const i=re(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this);if(i)return i}readLinearRing(t,e){const i=this.readFlatCoordinatesFromNode(t,e);if(i)return new um(i,"XYZ")}readPolygon(t,e){const i=re([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this);if(i&&i[0]){const n=i[0],s=[n.length];let o,a;for(o=1,a=i.length;o<a;++o)wi(n,i[o]),s.push(n.length);return new gs(n,"XYZ",s)}}readFlatCoordinatesFromNode(t,e){return re(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)}readGeometryFromNode(t,e){return this.readGeometryElement(t,[this.getReadOptions(t,e||{})])||null}readFeaturesFromNode(t,e){const i={featureType:this.featureType,featureNS:this.featureNS};return i&&Object.assign(i,this.getReadOptions(t,e)),this.readFeaturesInternal(t,[i])||[]}readProjectionFromNode(t){return ee(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))}};Lt.prototype.namespace=Jo;Lt.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}};Lt.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}};Lt.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}};Lt.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:oe(Lt.prototype.pointMemberParser),pointMembers:oe(Lt.prototype.pointMemberParser)}};Lt.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:oe(Lt.prototype.lineStringMemberParser),lineStringMembers:oe(Lt.prototype.lineStringMemberParser)}};Lt.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:oe(Lt.prototype.polygonMemberParser),polygonMembers:oe(Lt.prototype.polygonMemberParser)}};Lt.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:oe(Lt.prototype.readFlatCoordinatesFromNode)}};Lt.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:oe(Lt.prototype.readLineString)}};Lt.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:oe(Lt.prototype.readPolygon)}};Lt.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:Kt(Lt.prototype.readFlatLinearRing)}};const Nnt=Jo+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",Dnt={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};let ke=class extends Lt{constructor(t){t=t||{},super(t),this.FEATURE_COLLECTION_PARSERS[Jo].featureMember=oe(this.readFeaturesInternal),this.schemaLocation=t.schemaLocation?t.schemaLocation:Nnt}readFlatCoordinates(t,e){const i=jc(t,!1).replace(/^\s*|\s*$/g,""),n=e[0].srsName;let s="enu";if(n){const l=ee(n);l&&(s=l.getAxisOrientation())}const o=i.trim().split(/\s+/),a=[];for(let l=0,c=o.length;l<c;l++){const h=o[l].split(/,+/),u=parseFloat(h[0]),d=parseFloat(h[1]),g=h.length===3?parseFloat(h[2]):0;s.startsWith("en")?a.push(u,d,g):a.push(d,u,g)}return a}readBox(t,e){const i=re([null],this.BOX_PARSERS_,t,e,this);return hs(i[1][0],i[1][1],i[1][3],i[1][4])}innerBoundaryIsParser(t,e){const i=re(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)}outerBoundaryIsParser(t,e){const i=re(void 0,this.RING_PARSERS,t,e,this);if(i){const n=e[e.length-1];n[0]=i}}GEOMETRY_NODE_FACTORY_(t,e,i){const n=e[e.length-1],s=n.multiSurface,o=n.surface,a=n.multiCurve;return Array.isArray(t)?i="Envelope":(i=t.getType(),i==="MultiPolygon"&&s===!0?i="MultiSurface":i==="Polygon"&&o===!0?i="Surface":i==="MultiLineString"&&a===!0&&(i="MultiCurve")),ge("http://www.opengis.net/gml",i)}writeFeatureElement(t,e,i){const n=e.getId();n&&t.setAttribute("fid",n);const s=i[i.length-1],o=s.featureNS,a=e.getGeometryName();s.serializers||(s.serializers={},s.serializers[o]={});const l=[],c=[];if(e.hasProperties()){const u=e.getProperties();for(const d in u){const g=u[d];g!=null&&(l.push(d),c.push(g),d==a||typeof g.getSimplifiedGeometry=="function"?d in s.serializers[o]||(s.serializers[o][d]=tt(this.writeGeometryElement,this)):d in s.serializers[o]||(s.serializers[o][d]=tt(si)))}}const h=Object.assign({},s);h.node=t,jr(h,s.serializers,jn(void 0,o),c,i,l)}writeCurveOrLineString(t,e,i){const n=i[i.length-1].srsName;if(t.nodeName!=="LineStringSegment"&&n&&t.setAttribute("srsName",n),t.nodeName==="LineString"||t.nodeName==="LineStringSegment"){const s=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(s),this.writeCoordinates_(s,e,i)}else if(t.nodeName==="Curve"){const s=ge(t.namespaceURI,"segments");t.appendChild(s),this.writeCurveSegments_(s,e,i)}}writeLineStringOrCurveMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))}writeMultiCurveOrLineString(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=n.curve;o&&t.setAttribute("srsName",o);const l=e.getLineStrings();jr({node:t,hasZ:s,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeGeometryElement(t,e,i){const n=i[i.length-1],s=Object.assign({},n);s.node=t;let o;Array.isArray(e)?o=vk(e,n):o=th(e,!0,n),jr(s,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],i,void 0,this)}createCoordinatesNode_(t){const e=ge(t,"coordinates");return e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," "),e}writeCoordinates_(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=e.getCoordinates(),l=a.length,c=new Array(l);for(let h=0;h<l;++h){const u=a[h];c[h]=this.getCoords_(u,o,s)}si(t,c.join(" "))}writeCurveSegments_(t,e,i){const n=ge(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)}writeSurfaceOrPolygon(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName;if(t.nodeName!=="PolygonPatch"&&o&&t.setAttribute("srsName",o),t.nodeName==="Polygon"||t.nodeName==="PolygonPatch"){const a=e.getLinearRings();jr({node:t,hasZ:s,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,i,void 0,this)}else if(t.nodeName==="Surface"){const a=ge(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,i)}}RING_NODE_FACTORY_(t,e,i){const n=e[e.length-1],s=n.node,o=n.exteriorWritten;return o===void 0&&(n.exteriorWritten=!0),ge(s.namespaceURI,o!==void 0?"innerBoundaryIs":"outerBoundaryIs")}writeSurfacePatches_(t,e,i){const n=ge(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)}writeRing(t,e,i){const n=ge(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)}getCoords_(t,e,i){let n=(e?ee(e).getAxisOrientation():"enu").startsWith("en")?t[0]+","+t[1]:t[1]+","+t[0];if(i){const s=t[2]||0;n+=","+s}return n}writePoint(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName;o&&t.setAttribute("srsName",o);const a=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(a);const l=e.getCoordinates(),c=this.getCoords_(l,o,s);si(a,c)}writeMultiPoint(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName;o&&t.setAttribute("srsName",o);const a=e.getPoints();jr({node:t,hasZ:s,srsName:o},this.POINTMEMBER_SERIALIZERS,jn("pointMember"),a,i,void 0,this)}writePointMember(t,e,i){const n=ge(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)}writeLinearRing(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(s),this.writeCoordinates_(s,e,i)}writeMultiSurfaceOrPolygon(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=n.surface;o&&t.setAttribute("srsName",o);const l=e.getPolygons();jr({node:t,hasZ:s,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeSurfaceOrPolygonMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))}writeEnvelope(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=["lowerCorner","upperCorner"],o=[e[0]+" "+e[1],e[2]+" "+e[3]];jr({node:t},this.ENVELOPE_SERIALIZERS,d8,o,i,s,this)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(t,e,i){const n=e[e.length-1].node;return ge("http://www.opengis.net/gml",Dnt[n.nodeName])}};ke.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:Kt(ke.prototype.readFlatCoordinates)}};ke.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:ke.prototype.innerBoundaryIsParser,outerBoundaryIs:ke.prototype.outerBoundaryIsParser}};ke.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:oe(ke.prototype.readFlatCoordinates)}};ke.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:Kt(Lt.prototype.readPoint),MultiPoint:Kt(Lt.prototype.readMultiPoint),LineString:Kt(Lt.prototype.readLineString),MultiLineString:Kt(Lt.prototype.readMultiLineString),LinearRing:Kt(Lt.prototype.readLinearRing),Polygon:Kt(Lt.prototype.readPolygon),MultiPolygon:Kt(Lt.prototype.readMultiPolygon),Box:Kt(ke.prototype.readBox)}};ke.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:tt(ke.prototype.writeCurveOrLineString),MultiCurve:tt(ke.prototype.writeMultiCurveOrLineString),Point:tt(ke.prototype.writePoint),MultiPoint:tt(ke.prototype.writeMultiPoint),LineString:tt(ke.prototype.writeCurveOrLineString),MultiLineString:tt(ke.prototype.writeMultiCurveOrLineString),LinearRing:tt(ke.prototype.writeLinearRing),Polygon:tt(ke.prototype.writeSurfaceOrPolygon),MultiPolygon:tt(ke.prototype.writeMultiSurfaceOrPolygon),Surface:tt(ke.prototype.writeSurfaceOrPolygon),MultiSurface:tt(ke.prototype.writeMultiSurfaceOrPolygon),Envelope:tt(ke.prototype.writeEnvelope)}};ke.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:tt(ke.prototype.writeLineStringOrCurveMember),curveMember:tt(ke.prototype.writeLineStringOrCurveMember)}};ke.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:tt(ke.prototype.writeRing),innerBoundaryIs:tt(ke.prototype.writeRing)}};ke.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:tt(ke.prototype.writePointMember)}};ke.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:tt(ke.prototype.writeSurfaceOrPolygonMember),polygonMember:tt(ke.prototype.writeSurfaceOrPolygonMember)}};ke.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:tt(si),upperCorner:tt(si)}};const $nt=Jo+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",Gnt={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};let ct=class extends Lt{constructor(t){t=t||{},super(t),this.surface_=t.surface!==void 0?t.surface:!1,this.curve_=t.curve!==void 0?t.curve:!1,this.multiCurve_=t.multiCurve!==void 0?t.multiCurve:!0,this.multiSurface_=t.multiSurface!==void 0?t.multiSurface:!0,this.schemaLocation=t.schemaLocation?t.schemaLocation:$nt,this.hasZ=t.hasZ!==void 0?t.hasZ:!1}readMultiCurve(t,e){const i=re([],this.MULTICURVE_PARSERS,t,e,this);if(i)return new Qc(i)}readFlatCurveRing(t,e){const i=re([],this.MULTICURVE_PARSERS,t,e,this),n=[];for(let s=0,o=i.length;s<o;++s)wi(n,i[s].getFlatCoordinates());return n}readMultiSurface(t,e){const i=re([],this.MULTISURFACE_PARSERS,t,e,this);if(i)return new Jc(i)}curveMemberParser(t,e){wc(this.CURVEMEMBER_PARSERS,t,e,this)}surfaceMemberParser(t,e){wc(this.SURFACEMEMBER_PARSERS,t,e,this)}readPatch(t,e){return re([null],this.PATCHES_PARSERS,t,e,this)}readSegment(t,e){return re([],this.SEGMENTS_PARSERS,t,e,this)}readPolygonPatch(t,e){return re([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this)}readLineStringSegment(t,e){return re([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)}interiorParser(t,e){const i=re(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)}exteriorParser(t,e){const i=re(void 0,this.RING_PARSERS,t,e,this);if(i){const n=e[e.length-1];n[0]=i}}readSurface(t,e){const i=re([null],this.SURFACE_PARSERS,t,e,this);if(i&&i[0]){const n=i[0],s=[n.length];let o,a;for(o=1,a=i.length;o<a;++o)wi(n,i[o]),s.push(n.length);return new gs(n,"XYZ",s)}}readCurve(t,e){const i=re([null],this.CURVE_PARSERS,t,e,this);if(i)return new kn(i,"XYZ")}readEnvelope(t,e){const i=re([null],this.ENVELOPE_PARSERS,t,e,this);return hs(i[1][0],i[1][1],i[2][0],i[2][1])}readFlatPos(t,e){let i=jc(t,!1);const n=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,s=[];let o;for(;o=n.exec(i);)s.push(parseFloat(o[1])),i=i.substr(o[0].length);if(i!=="")return;const a=e[0].srsName;if((a?ee(a).getAxisOrientation():"enu")==="neu")for(let c=0,h=s.length;c<h;c+=3){const u=s[c],d=s[c+1];s[c]=d,s[c+1]=u}const l=s.length;if(l==2&&s.push(0),l!==0)return s}readFlatPosList(t,e){const i=jc(t,!1).replace(/^\s*|\s*$/g,""),n=e[0],s=n.srsName,o=n.srsDimension,a=s?ee(s).getAxisOrientation():"enu",l=i.split(/\s+/);let c=2;t.getAttribute("srsDimension")?c=Vo(t.getAttribute("srsDimension")):t.getAttribute("dimension")?c=Vo(t.getAttribute("dimension")):t.parentNode.getAttribute("srsDimension")?c=Vo(t.parentNode.getAttribute("srsDimension")):o&&(c=Vo(o));const h=a.startsWith("en");let u,d,g;const f=[];for(let p=0,m=l.length;p<m;p+=c)u=parseFloat(l[p]),d=parseFloat(l[p+1]),g=c===3?parseFloat(l[p+2]):0,h?f.push(u,d,g):f.push(d,u,g);return f}writePos_(t,e,i){const n=i[i.length-1],s=n.hasZ,o=s?"3":"2";t.setAttribute("srsDimension",o);const a=n.srsName,l=a?ee(a).getAxisOrientation():"enu",c=e.getCoordinates();let h=l.startsWith("en")?c[0]+" "+c[1]:c[1]+" "+c[0];if(s){const u=c[2]||0;h+=" "+u}si(t,h)}getCoords_(t,e,i){let n=(e?ee(e).getAxisOrientation():"enu").startsWith("en")?t[0]+" "+t[1]:t[1]+" "+t[0];if(i){const s=t[2]||0;n+=" "+s}return n}writePosList_(t,e,i){const n=i[i.length-1],s=n.hasZ,o=s?"3":"2";t.setAttribute("srsDimension",o);const a=n.srsName,l=e.getCoordinates(),c=l.length,h=new Array(c);let u;for(let d=0;d<c;++d)u=l[d],h[d]=this.getCoords_(u,a,s);si(t,h.join(" "))}writePoint(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=ge(t.namespaceURI,"pos");t.appendChild(s),this.writePos_(s,e,i)}writeEnvelope(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=["lowerCorner","upperCorner"],o=[e[0]+" "+e[1],e[2]+" "+e[3]];jr({node:t},this.ENVELOPE_SERIALIZERS,d8,o,i,s,this)}writeLinearRing(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const s=ge(t.namespaceURI,"posList");t.appendChild(s),this.writePosList_(s,e,i)}RING_NODE_FACTORY_(t,e,i){const n=e[e.length-1],s=n.node,o=n.exteriorWritten;return o===void 0&&(n.exteriorWritten=!0),ge(s.namespaceURI,o!==void 0?"interior":"exterior")}writeSurfaceOrPolygon(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName;if(t.nodeName!=="PolygonPatch"&&o&&t.setAttribute("srsName",o),t.nodeName==="Polygon"||t.nodeName==="PolygonPatch"){const a=e.getLinearRings();jr({node:t,hasZ:s,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,i,void 0,this)}else if(t.nodeName==="Surface"){const a=ge(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,i)}}writeCurveOrLineString(t,e,i){const n=i[i.length-1].srsName;if(t.nodeName!=="LineStringSegment"&&n&&t.setAttribute("srsName",n),t.nodeName==="LineString"||t.nodeName==="LineStringSegment"){const s=ge(t.namespaceURI,"posList");t.appendChild(s),this.writePosList_(s,e,i)}else if(t.nodeName==="Curve"){const s=ge(t.namespaceURI,"segments");t.appendChild(s),this.writeCurveSegments_(s,e,i)}}writeMultiSurfaceOrPolygon(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=n.surface;o&&t.setAttribute("srsName",o);const l=e.getPolygons();jr({node:t,hasZ:s,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeMultiPoint(t,e,i){const n=i[i.length-1],s=n.srsName,o=n.hasZ;s&&t.setAttribute("srsName",s);const a=e.getPoints();jr({node:t,hasZ:o,srsName:s},this.POINTMEMBER_SERIALIZERS,jn("pointMember"),a,i,void 0,this)}writeMultiCurveOrLineString(t,e,i){const n=i[i.length-1],s=n.hasZ,o=n.srsName,a=n.curve;o&&t.setAttribute("srsName",o);const l=e.getLineStrings();jr({node:t,hasZ:s,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeRing(t,e,i){const n=ge(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)}writeSurfaceOrPolygonMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))}writePointMember(t,e,i){const n=ge(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)}writeLineStringOrCurveMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))}writeSurfacePatches_(t,e,i){const n=ge(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)}writeCurveSegments_(t,e,i){const n=ge(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)}writeGeometryElement(t,e,i){const n=i[i.length-1],s=Object.assign({},n);s.node=t;let o;Array.isArray(e)?o=vk(e,n):o=th(e,!0,n),jr(s,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],i,void 0,this)}writeFeatureElement(t,e,i){const n=e.getId();n&&t.setAttribute("fid",n);const s=i[i.length-1],o=s.featureNS,a=e.getGeometryName();s.serializers||(s.serializers={},s.serializers[o]={});const l=[],c=[];if(e.hasProperties()){const u=e.getProperties();for(const d in u){const g=u[d];g!=null&&(l.push(d),c.push(g),d==a||typeof g.getSimplifiedGeometry=="function"?d in s.serializers[o]||(s.serializers[o][d]=tt(this.writeGeometryElement,this)):d in s.serializers[o]||(s.serializers[o][d]=tt(si)))}}const h=Object.assign({},s);h.node=t,jr(h,s.serializers,jn(void 0,o),c,i,l)}writeFeatureMembers_(t,e,i){const n=i[i.length-1],s=n.featureType,o=n.featureNS,a={};a[o]={},a[o][s]=tt(this.writeFeatureElement,this);const l=Object.assign({},n);l.node=t,jr(l,a,jn(s,o),e,i)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(t,e,i){const n=e[e.length-1].node;return ge(this.namespace,Gnt[n.nodeName])}GEOMETRY_NODE_FACTORY_(t,e,i){const n=e[e.length-1],s=n.multiSurface,o=n.surface,a=n.curve,l=n.multiCurve;return Array.isArray(t)?i="Envelope":(i=t.getType(),i==="MultiPolygon"&&s===!0?i="MultiSurface":i==="Polygon"&&o===!0?i="Surface":i==="LineString"&&a===!0?i="Curve":i==="MultiLineString"&&l===!0&&(i="MultiCurve")),ge(this.namespace,i)}writeGeometryNode(t,e){e=this.adaptOptions(e);const i=ge(this.namespace,"geom"),n={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return e&&Object.assign(n,e),this.writeGeometryElement(i,t,[n]),i}writeFeaturesNode(t,e){e=this.adaptOptions(e);const i=ge(this.namespace,"featureMembers");i.setAttributeNS(J2,"xsi:schemaLocation",this.schemaLocation);const n={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return e&&Object.assign(n,e),this.writeFeatureMembers_(i,t,[n]),i}};ct.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:Kt(ct.prototype.readFlatPos),posList:Kt(ct.prototype.readFlatPosList),coordinates:Kt(ke.prototype.readFlatCoordinates)}};ct.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:ct.prototype.interiorParser,exterior:ct.prototype.exteriorParser}};ct.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:Kt(Lt.prototype.readPoint),MultiPoint:Kt(Lt.prototype.readMultiPoint),LineString:Kt(Lt.prototype.readLineString),MultiLineString:Kt(Lt.prototype.readMultiLineString),LinearRing:Kt(Lt.prototype.readLinearRing),Polygon:Kt(Lt.prototype.readPolygon),MultiPolygon:Kt(Lt.prototype.readMultiPolygon),Surface:Kt(ct.prototype.readSurface),MultiSurface:Kt(ct.prototype.readMultiSurface),Curve:Kt(ct.prototype.readCurve),MultiCurve:Kt(ct.prototype.readMultiCurve),Envelope:Kt(ct.prototype.readEnvelope)}};ct.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:oe(ct.prototype.curveMemberParser),curveMembers:oe(ct.prototype.curveMemberParser)}};ct.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:oe(ct.prototype.surfaceMemberParser),surfaceMembers:oe(ct.prototype.surfaceMemberParser)}};ct.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:oe(Lt.prototype.readLineString),Curve:oe(ct.prototype.readCurve)}};ct.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:oe(Lt.prototype.readPolygon),Surface:oe(ct.prototype.readSurface)}};ct.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:Kt(ct.prototype.readPatch)}};ct.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:Kt(ct.prototype.readSegment)}};ct.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:oe(ct.prototype.readFlatPosList),upperCorner:oe(ct.prototype.readFlatPosList)}};ct.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:Kt(ct.prototype.readPolygonPatch)}};ct.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:u8(ct.prototype.readLineStringSegment)}};Lt.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:Kt(Lt.prototype.readFlatLinearRing),Ring:Kt(ct.prototype.readFlatCurveRing)}};ct.prototype.writeFeatures;ct.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:tt(ct.prototype.writeRing),interior:tt(ct.prototype.writeRing)}};ct.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:tt(si),upperCorner:tt(si)}};ct.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:tt(ct.prototype.writeSurfaceOrPolygonMember),polygonMember:tt(ct.prototype.writeSurfaceOrPolygonMember)}};ct.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:tt(ct.prototype.writePointMember)}};ct.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:tt(ct.prototype.writeLineStringOrCurveMember),curveMember:tt(ct.prototype.writeLineStringOrCurveMember)}};ct.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:tt(ct.prototype.writeCurveOrLineString),MultiCurve:tt(ct.prototype.writeMultiCurveOrLineString),Point:tt(ct.prototype.writePoint),MultiPoint:tt(ct.prototype.writeMultiPoint),LineString:tt(ct.prototype.writeCurveOrLineString),MultiLineString:tt(ct.prototype.writeMultiCurveOrLineString),LinearRing:tt(ct.prototype.writeLinearRing),Polygon:tt(ct.prototype.writeSurfaceOrPolygon),MultiPolygon:tt(ct.prototype.writeMultiSurfaceOrPolygon),Surface:tt(ct.prototype.writeSurfaceOrPolygon),MultiSurface:tt(ct.prototype.writeMultiSurfaceOrPolygon),Envelope:tt(ct.prototype.writeEnvelope)}};let De=class extends ct{constructor(t){t=t||{},super(t),this.schemaLocation=t.schemaLocation?t.schemaLocation:this.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd"}writeGeometryElement(t,e,i){const n=i[i.length-1];i[i.length-1]=Object.assign({multiCurve:!0,multiSurface:!0},n),super.writeGeometryElement(t,e,i)}};De.prototype.namespace="http://www.opengis.net/gml/3.2";De.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:Kt(ct.prototype.readFlatPos),posList:Kt(ct.prototype.readFlatPosList),coordinates:Kt(ke.prototype.readFlatCoordinates)}};De.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:ct.prototype.interiorParser,exterior:ct.prototype.exteriorParser}};De.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:Kt(Lt.prototype.readPoint),MultiPoint:Kt(Lt.prototype.readMultiPoint),LineString:Kt(Lt.prototype.readLineString),MultiLineString:Kt(Lt.prototype.readMultiLineString),LinearRing:Kt(Lt.prototype.readLinearRing),Polygon:Kt(Lt.prototype.readPolygon),MultiPolygon:Kt(Lt.prototype.readMultiPolygon),Surface:Kt(De.prototype.readSurface),MultiSurface:Kt(ct.prototype.readMultiSurface),Curve:Kt(De.prototype.readCurve),MultiCurve:Kt(ct.prototype.readMultiCurve),Envelope:Kt(De.prototype.readEnvelope)}};De.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:oe(ct.prototype.curveMemberParser),curveMembers:oe(ct.prototype.curveMemberParser)}};De.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:oe(ct.prototype.surfaceMemberParser),surfaceMembers:oe(ct.prototype.surfaceMemberParser)}};De.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:oe(Lt.prototype.readLineString),Curve:oe(ct.prototype.readCurve)}};De.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:oe(Lt.prototype.readPolygon),Surface:oe(ct.prototype.readSurface)}};De.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:Kt(ct.prototype.readPatch)}};De.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:Kt(ct.prototype.readSegment)}};De.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:oe(ct.prototype.readFlatPosList),upperCorner:oe(ct.prototype.readFlatPosList)}};De.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:Kt(ct.prototype.readPolygonPatch)}};De.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:u8(ct.prototype.readLineStringSegment)}};De.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:oe(Lt.prototype.pointMemberParser),pointMembers:oe(Lt.prototype.pointMemberParser)}};De.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:oe(Lt.prototype.lineStringMemberParser),lineStringMembers:oe(Lt.prototype.lineStringMemberParser)}};De.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:oe(Lt.prototype.polygonMemberParser),polygonMembers:oe(Lt.prototype.polygonMemberParser)}};De.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:oe(Lt.prototype.readFlatCoordinatesFromNode)}};De.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:oe(Lt.prototype.readLineString)}};De.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:oe(Lt.prototype.readPolygon)}};De.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:Kt(Lt.prototype.readFlatLinearRing),Ring:Kt(De.prototype.readFlatCurveRing)}};De.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:tt(ct.prototype.writeRing),interior:tt(ct.prototype.writeRing)}};De.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:tt(si),upperCorner:tt(si)}};De.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:tt(ct.prototype.writeSurfaceOrPolygonMember),polygonMember:tt(ct.prototype.writeSurfaceOrPolygonMember)}};De.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:tt(ct.prototype.writePointMember)}};De.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:tt(ct.prototype.writeLineStringOrCurveMember),curveMember:tt(ct.prototype.writeLineStringOrCurveMember)}};De.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:tt(ct.prototype.writeCurveOrLineString),MultiCurve:tt(ct.prototype.writeMultiCurveOrLineString),Point:tt(De.prototype.writePoint),MultiPoint:tt(ct.prototype.writeMultiPoint),LineString:tt(ct.prototype.writeCurveOrLineString),MultiLineString:tt(ct.prototype.writeMultiCurveOrLineString),LinearRing:tt(ct.prototype.writeLinearRing),Polygon:tt(ct.prototype.writeSurfaceOrPolygon),MultiPolygon:tt(ct.prototype.writeMultiSurfaceOrPolygon),Surface:tt(ct.prototype.writeSurfaceOrPolygon),MultiSurface:tt(ct.prototype.writeMultiSurfaceOrPolygon),Envelope:tt(ct.prototype.writeEnvelope)}};class v8{constructor(t){this.tagName_=t}getTagName(){return this.tagName_}}class jnt extends v8{constructor(t,e){super(t),this.conditions=e,Re(this.conditions.length>=2,"At least 2 conditions are required")}}class znt extends jnt{constructor(t){super("And",Array.prototype.slice.call(arguments))}}class qnt extends v8{constructor(t,e,i){if(super("BBOX"),this.geometryName=t,this.extent=e,e.length!==4)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");this.srsName=i}}function Bnt(r){const t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(znt,t))}function Unt(r,t,e){return new qnt(r,t,e)}const A3={"http://www.opengis.net/gml":{boundedBy:bt(Lt.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:oe(Lt.prototype.readFeaturesInternal)}},Wnt={"http://www.opengis.net/wfs":{totalInserted:bt(zo),totalUpdated:bt(zo),totalDeleted:bt(zo)},"http://www.opengis.net/wfs/2.0":{totalInserted:bt(zo),totalUpdated:bt(zo),totalDeleted:bt(zo)}},Vnt={"http://www.opengis.net/wfs":{TransactionSummary:bt(O3,"transactionSummary"),InsertResults:bt(N3,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:bt(O3,"transactionSummary"),InsertResults:bt(N3,"insertIds")}},Znt={"http://www.opengis.net/wfs":{PropertyName:tt(si)},"http://www.opengis.net/wfs/2.0":{PropertyName:tt(si)}},x8={"http://www.opengis.net/wfs":{Insert:tt(D3),Update:tt(G3),Delete:tt($3),Property:tt(j3),Native:tt(z3)},"http://www.opengis.net/wfs/2.0":{Insert:tt(D3),Update:tt(G3),Delete:tt($3),Property:tt(j3),Native:tt(z3)}},w8="feature",NE="http://www.w3.org/2000/xmlns/",DE={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},ew={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},$E={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},L3={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},GE={"2.0.0":De,"1.1.0":ct,"1.0.0":ke},Hnt="1.1.0";class Ynt extends _8{constructor(t){super(),t=t||{},this.version_=t.version?t.version:Hnt,this.featureType_=t.featureType,this.featureNS_=t.featureNS,this.gmlFormat_=t.gmlFormat?t.gmlFormat:new GE[this.version_],this.schemaLocation_=t.schemaLocation?t.schemaLocation:L3[this.version_]}getFeatureType(){return this.featureType_}setFeatureType(t){this.featureType_=t}readFeaturesFromNode(t,e){const i={node:t};Object.assign(i,{featureType:this.featureType_,featureNS:this.featureNS_}),Object.assign(i,this.getReadOptions(t,e||{}));const n=[i];let s;this.version_==="2.0.0"?s=A3:s=this.gmlFormat_.FEATURE_COLLECTION_PARSERS;let o=re([],s,t,n,this.gmlFormat_);return o||(o=[]),o}readTransactionResponse(t){if(t){if(typeof t=="string"){const e=oc(t);return this.readTransactionResponseFromDocument(e)}return sc(t)?this.readTransactionResponseFromDocument(t):this.readTransactionResponseFromNode(t)}}readFeatureCollectionMetadata(t){if(t){if(typeof t=="string"){const e=oc(t);return this.readFeatureCollectionMetadataFromDocument(e)}return sc(t)?this.readFeatureCollectionMetadataFromDocument(t):this.readFeatureCollectionMetadataFromNode(t)}}readFeatureCollectionMetadataFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(e)}readFeatureCollectionMetadataFromNode(t){const e={},i=Vo(t.getAttribute("numberOfFeatures"));return e.numberOfFeatures=i,re(e,A3,t,[],this.gmlFormat_)}readTransactionResponseFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(e)}readTransactionResponseFromNode(t){return re({},Vnt,t,[])}writeGetFeature(t){const e=ge(ew[this.version_],"GetFeature");e.setAttribute("service","WFS"),e.setAttribute("version",this.version_),t.handle&&e.setAttribute("handle",t.handle),t.outputFormat&&e.setAttribute("outputFormat",t.outputFormat),t.maxFeatures!==void 0&&e.setAttribute("maxFeatures",String(t.maxFeatures)),t.resultType&&e.setAttribute("resultType",t.resultType),t.startIndex!==void 0&&e.setAttribute("startIndex",String(t.startIndex)),t.count!==void 0&&e.setAttribute("count",String(t.count)),t.viewParams!==void 0&&e.setAttribute("viewParams",t.viewParams),e.setAttributeNS(J2,"xsi:schemaLocation",this.schemaLocation_);const i={node:e};if(Object.assign(i,{version:this.version_,srsName:t.srsName,featureNS:t.featureNS?t.featureNS:this.featureNS_,featurePrefix:t.featurePrefix,propertyNames:t.propertyNames?t.propertyNames:[]}),Re(Array.isArray(t.featureTypes),"`options.featureTypes` must be an Array"),typeof t.featureTypes[0]=="string"){let n=t.filter;t.bbox&&(Re(t.geometryName,"`options.geometryName` must also be provided when `options.bbox` is set"),n=this.combineBboxAndFilter(t.geometryName,t.bbox,t.srsName,n)),Object.assign(i,{geometryName:t.geometryName,filter:n}),K3(e,t.featureTypes,[i])}else t.featureTypes.forEach(n=>{const s=this.combineBboxAndFilter(n.geometryName,n.bbox,t.srsName,t.filter);Object.assign(i,{geometryName:n.geometryName,filter:s}),K3(e,[n.name],[i])});return e}combineBboxAndFilter(t,e,i,n){const s=Unt(t,e,i);return n?Bnt(n,s):s}writeTransaction(t,e,i,n){const s=[],o=n.version?n.version:this.version_,a=ge(ew[o],"Transaction");a.setAttribute("service","WFS"),a.setAttribute("version",o);let l;n&&(l=n.gmlOptions?n.gmlOptions:{},n.handle&&a.setAttribute("handle",n.handle)),a.setAttributeNS(J2,"xsi:schemaLocation",L3[o]);const c=Xnt(a,l,o,n);return t&&Kp("Insert",t,s,c),e&&Kp("Update",e,s,c),i&&Kp("Delete",i,s,c),n.nativeElements&&Kp("Native",n.nativeElements,s,c),a}readProjectionFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(e);return null}readProjectionFromNode(t){if(t.firstElementChild&&t.firstElementChild.firstElementChild){t=t.firstElementChild.firstElementChild;for(let e=t.firstElementChild;e;e=e.nextElementSibling)if(!(e.childNodes.length===0||e.childNodes.length===1&&e.firstChild.nodeType===3)){const i=[{}];return this.gmlFormat_.readGeometryElement(e,i),ee(i.pop().srsName)}}return null}}function Xnt(r,t,e,i){const n=i.featurePrefix?i.featurePrefix:w8;let s;return e==="1.0.0"?s=2:e==="1.1.0"?s=3:e==="2.0.0"&&(s=3.2),Object.assign({node:r},{version:e,featureNS:i.featureNS,featureType:i.featureType,featurePrefix:n,gmlVersion:s,hasZ:i.hasZ,srsName:i.srsName},t)}function Kp(r,t,e,i){jr(i,x8,jn(r),t,e)}function O3(r,t){return re({},Wnt,r,t)}const Knt={"http://www.opengis.net/ogc":{FeatureId:oe(function(r,t){return r.getAttribute("fid")})},"http://www.opengis.net/ogc/1.1":{FeatureId:oe(function(r,t){return r.getAttribute("fid")})}};function F3(r,t){wc(Knt,r,t)}const Qnt={"http://www.opengis.net/wfs":{Feature:F3},"http://www.opengis.net/wfs/2.0":{Feature:F3}};function N3(r,t){return re([],Qnt,r,t)}function D3(r,t,e){const i=e[e.length-1],n=i.featureType,s=i.featureNS,o=i.gmlVersion,a=ge(s,n);r.appendChild(a),o===2?ke.prototype.writeFeatureElement(a,t,e):o===3?ct.prototype.writeFeatureElement(a,t,e):De.prototype.writeFeatureElement(a,t,e)}function b8(r,t,e){const i=e[e.length-1].version,n=DE[i],s=ge(n,"Filter"),o=ge(n,"FeatureId");s.appendChild(o),o.setAttribute("fid",t),r.appendChild(s)}function jE(r,t){r=r||w8;const e=r+":";return t.startsWith(e)?t:e+t}function $3(r,t,e){const i=e[e.length-1];Re(t.getId()!==void 0,"Features must have an id set");const n=i.featureType,s=i.featurePrefix,o=i.featureNS,a=jE(s,n);r.setAttribute("typeName",a),r.setAttributeNS(NE,"xmlns:"+s,o);const l=t.getId();l!==void 0&&b8(r,l,e)}function G3(r,t,e){const i=e[e.length-1];Re(t.getId()!==void 0,"Features must have an id set");const n=i.version,s=i.featureType,o=i.featurePrefix,a=i.featureNS,l=jE(o,s),c=t.getGeometryName();r.setAttribute("typeName",l),r.setAttributeNS(NE,"xmlns:"+o,a);const h=t.getId();if(h!==void 0){const u=t.getKeys(),d=[];for(let g=0,f=u.length;g<f;g++){const p=t.get(u[g]);if(p!==void 0){let m=u[g];p&&typeof p.getSimplifiedGeometry=="function"&&(m=c),d.push({name:m,value:p})}}jr({version:n,gmlVersion:i.gmlVersion,node:r,hasZ:i.hasZ,srsName:i.srsName},x8,jn("Property"),d,e),b8(r,h,e)}}function j3(r,t,e){const i=e[e.length-1],n=i.version,s=ew[n],o=ge(s,n==="2.0.0"?"ValueReference":"Name"),a=i.gmlVersion;if(r.appendChild(o),si(o,t.name),t.value!==void 0&&t.value!==null){const l=ge(s,"Value");r.appendChild(l),t.value&&typeof t.value.getSimplifiedGeometry=="function"?a===2?ke.prototype.writeGeometryElement(l,t.value,e):a===3?ct.prototype.writeGeometryElement(l,t.value,e):De.prototype.writeGeometryElement(l,t.value,e):si(l,t.value)}}function z3(r,t,e){t.vendorId&&r.setAttribute("vendorId",t.vendorId),t.safeToIgnore!==void 0&&r.setAttribute("safeToIgnore",String(t.safeToIgnore)),t.value!==void 0&&si(r,t.value)}const ky={"http://www.opengis.net/wfs":{Query:tt(q3)},"http://www.opengis.net/wfs/2.0":{Query:tt(q3)},"http://www.opengis.net/ogc":{During:tt(W3),And:tt(Qp),Or:tt(Qp),Not:tt(V3),BBOX:tt(B3),Contains:tt(ja),Intersects:tt(ja),Within:tt(ja),DWithin:tt(U3),PropertyIsEqualTo:tt(Vn),PropertyIsNotEqualTo:tt(Vn),PropertyIsLessThan:tt(Vn),PropertyIsLessThanOrEqualTo:tt(Vn),PropertyIsGreaterThan:tt(Vn),PropertyIsGreaterThanOrEqualTo:tt(Vn),PropertyIsNull:tt(Z3),PropertyIsBetween:tt(H3),PropertyIsLike:tt(Y3)},"http://www.opengis.net/fes/2.0":{During:tt(W3),And:tt(Qp),Or:tt(Qp),Not:tt(V3),BBOX:tt(B3),Contains:tt(ja),Disjoint:tt(ja),Intersects:tt(ja),ResourceId:tt(tst),Within:tt(ja),DWithin:tt(U3),PropertyIsEqualTo:tt(Vn),PropertyIsNotEqualTo:tt(Vn),PropertyIsLessThan:tt(Vn),PropertyIsLessThanOrEqualTo:tt(Vn),PropertyIsGreaterThan:tt(Vn),PropertyIsGreaterThanOrEqualTo:tt(Vn),PropertyIsNull:tt(Z3),PropertyIsBetween:tt(H3),PropertyIsLike:tt(Y3)}};function q3(r,t,e){const i=e[e.length-1],n=i.version,s=i.featurePrefix,o=i.featureNS,a=i.propertyNames,l=i.srsName;let c;s?c=jE(s,t):c=t;let h;n==="2.0.0"?h="typeNames":h="typeName",r.setAttribute(h,c),l&&r.setAttribute("srsName",l),o&&r.setAttributeNS(NE,"xmlns:"+s,o);const u=Object.assign({},i);u.node=r,jr(u,Znt,jn("PropertyName"),a,e);const d=i.filter;if(d){const g=ge(Ey(n),"Filter");r.appendChild(g),Jnt(g,d,e)}}function Jnt(r,t,e){const i=e[e.length-1],n={node:r};Object.assign(n,{context:i}),jr(n,ky,jn(t.getTagName()),[t],e)}function B3(r,t,e){const i=e[e.length-1],n=i.context.version;i.srsName=t.srsName;const s=GE[n];ud(n,r,t.geometryName),s.prototype.writeGeometryElement(r,t.extent,e)}function tst(r,t,e){r.setAttribute("rid",t.rid)}function ja(r,t,e){const i=e[e.length-1],n=i.context.version;i.srsName=t.srsName;const s=GE[n];ud(n,r,t.geometryName),s.prototype.writeGeometryElement(r,t.geometry,e)}function U3(r,t,e){const i=e[e.length-1].context.version;ja(r,t,e);const n=ge(Ey(i),"Distance");si(n,t.distance.toString()),i==="2.0.0"?n.setAttribute("uom",t.unit):n.setAttribute("units",t.unit),r.appendChild(n)}function W3(r,t,e){const i=e[e.length-1].context.version;Um($E[i],"ValueReference",r,t.propertyName);const n=ge(Jo,"TimePeriod");r.appendChild(n);const s=ge(Jo,"begin");n.appendChild(s),X3(s,t.begin);const o=ge(Jo,"end");n.appendChild(o),X3(o,t.end)}function Qp(r,t,e){const i=e[e.length-1].context,n={node:r};Object.assign(n,{context:i});const s=t.conditions;for(let o=0,a=s.length;o<a;++o){const l=s[o];jr(n,ky,jn(l.getTagName()),[l],e)}}function V3(r,t,e){const i=e[e.length-1].context,n={node:r};Object.assign(n,{context:i});const s=t.condition;jr(n,ky,jn(s.getTagName()),[s],e)}function Vn(r,t,e){const i=e[e.length-1].context.version;t.matchCase!==void 0&&r.setAttribute("matchCase",t.matchCase.toString()),ud(i,r,t.propertyName),Wm(i,r,""+t.expression)}function Z3(r,t,e){const i=e[e.length-1].context.version;ud(i,r,t.propertyName)}function H3(r,t,e){const i=e[e.length-1].context.version,n=Ey(i);ud(i,r,t.propertyName);const s=ge(n,"LowerBoundary");r.appendChild(s),Wm(i,s,""+t.lowerBoundary);const o=ge(n,"UpperBoundary");r.appendChild(o),Wm(i,o,""+t.upperBoundary)}function Y3(r,t,e){const i=e[e.length-1].context.version;r.setAttribute("wildCard",t.wildCard),r.setAttribute("singleChar",t.singleChar),r.setAttribute("escapeChar",t.escapeChar),t.matchCase!==void 0&&r.setAttribute("matchCase",t.matchCase.toString()),ud(i,r,t.propertyName),Wm(i,r,""+t.pattern)}function Um(r,t,e,i){const n=ge(r,t);si(n,i),e.appendChild(n)}function Wm(r,t,e){Um(Ey(r),"Literal",t,e)}function ud(r,t,e){r==="2.0.0"?Um($E[r],"ValueReference",t,e):Um(DE[r],"PropertyName",t,e)}function X3(r,t){const e=ge(Jo,"TimeInstant");r.appendChild(e);const i=ge(Jo,"timePosition");e.appendChild(i),si(i,t)}function K3(r,t,e){const i=e[e.length-1],n=Object.assign({},i);n.node=r,jr(n,ky,jn("Query"),t,e)}function Ey(r){let t;return r==="2.0.0"?t=$E[r]:t=DE[r],t}function est(r,t){return r.fillPercentage>t.fillPercentage?-1:r.fillPercentage<t.fillPercentage?1:r.keys.length>t.keys.length?-1:r.keys.length<t.keys.length?1:r.index>t.index?-1:r.index<t.index?1:0}function rst(r,t){const e=r.properties||{},i=[...t.map((n,s)=>{const o=FE(n).reduce((l,c)=>Array.isArray(c)?[...l,c[1]]:l,[]),a=o.reduce((l,c)=>typeof e[c]<"u"&&e[c]!==""?l+1:l,0);return{pattern:n,keys:o,index:s,fillPercentage:a/o.length}})].sort(est)[0];return i.keys.reduce((n,s)=>n.replace(`{{${s}}}`,e[s]||""),i.pattern)}const Q3=new Ynt,ist=new u2;async function nst(r,t,e,i){const n=[],s={type:"FeatureCollection",features:n},o=await r.text(),a=Q3.readFeatures(o),{srsName:l}=Q3.readFeatureCollectionMetadata(o);return a.forEach(c=>{const h=JSON.parse(ist.writeFeature(c));h.title="",t&&(e?h.title=rst(h,t):h.title=Array.isArray(t)?t.map(u=>h.properties[u]).join(" "):h.properties[t]),l&&(h.geometry=Lr(h.geometry,{coordinates:qs(h.geometry.coordinates,`EPSG:${l.split("::")[1]}`,i)})),n.push(h)}),s}async function sst(r,t,e,i){const{fieldName:n,patterns:s,patternKeys:o}=i;if(!n&&(!s||!o))throw new Error('Incomplete WFS search configuration. Either "fieldName" or "patterns" & "patternKeys" are required.');n&&s&&console.error(`@polar/polar(lib/getFeatures/wfs/index:22:3)
`,'Using both "fieldName" and "patterns" for WFS search. These are mutually exclusive. "patterns" will be ignored.');const a=n?[[[n,e]]]:tw(s,o,e),l=Zd(a,i),c=await fetch(encodeURI(t),{signal:r,method:"POST",body:l});return y8(c),nst(c,n||s,!n,i.epsg)}function ost(){const r={bkg:Ent,mpapi:Snt,wfs:sst};return{registerSearchMethods:t=>{Object.entries(t).forEach(([e,i])=>{if(r[e]){console.error(`@polar/polar(plugins/addressSearch/utils/methodContainer:16:6)
`,`Method "${e}" already exists. Please choose a different name. Overrides are not allowed.`);return}r[e]=i})},getSearchMethod:t=>{const e=r[t];if(e)return e;throw new Error(`The given type "${t}" does not define a valid searchMethod.`)}}}const Fa={ERROR:Symbol("error"),NO_SEARCH:Symbol("noSearch")},zE=Sl("plugins/addressSearch",()=>{const r=ar(),t={label:"defaultLabel",hint:"",resultDisplayMode:"mixed",limitResults:Number.MAX_SAFE_INTEGER};let e=null,i,n;const s=me(null),o=me(""),a=me(!1),l=me(Fa.NO_SEARCH),c=me("defaultGroup"),h=Ct(()=>u.value.afterResultComponent||null),u=Ct(()=>r.configuration.addressSearch),d=Ct({get:()=>o.value,set:A=>{A!==o.value&&(o.value=A,F())}}),g=Ct(()=>Array.isArray(l.value)&&l.value.length>0&&l.value.some(({features:{features:A}})=>Array.isArray(A)&&A.length>0)),f=Ct(()=>u.value.focusAfterSearch||!1),p=Ct(()=>A=>{const $=u.value.groupProperties?.[A]||{};return A==="defaultGroup"?Lr(t,$):$}),m=Ct(()=>Object.keys(b.value)),y=Ct(()=>Object.keys(b.value).map(A=>({groupId:A,text:p.value(A).label}))),_=Ct(()=>m.value.length>1),x=Ct(()=>a.value?Ci(A=>A.hint.loading,{ns:xn}):l.value===Fa.ERROR?Ci(A=>A.hint.error,{ns:xn}):d.value.length>0&&d.value.length<w.value?Ci(A=>A.hint.tooShort,{ns:xn,minLength:w.value}):l.value!==Fa.NO_SEARCH&&!g.value?Ci(A=>A.hint.noResults,{ns:xn}):C.value.hint||""),v=Ct(()=>C.value.limitResults||t.limitResults),w=Ct(()=>typeof u.value.minLength=="number"?u.value.minLength:3),b=Ct(()=>u.value.searchMethods.reduce((A,$)=>{const z=$.groupId||"defaultGroup";return A[z]?A[z].push($):A[z]=[$],A},{})),E=Ct({get:()=>c.value,set:A=>{A!==c.value&&(c.value=A,l.value=Fa.NO_SEARCH,d.value.length>0&&P())}}),C=Ct(()=>p.value(E.value)),S=Ct(()=>typeof u.value.waitMs=="number"?u.value.waitMs:300);function R(){i=g8(P,S.value),n=ost(),E.value=m.value[0],u.value.customSearchMethods&&n.registerSearchMethods(u.value.customSearchMethods)}function I(){}function F(){e&&(e.abort(),e=null),i()}function N(){d.value="",l.value=Fa.NO_SEARCH,s.value=null}function P(){if(d.value.length<w.value)return l.value=Fa.NO_SEARCH,a.value=!1,Promise.resolve();a.value=!0,e=new AbortController;const A=e;return Promise.allSettled(u.value.searchMethods.map(async({categoryId:$,groupId:z,queryParameters:j,type:et,url:q})=>{const vt=await n.getSearchMethod(et)(A.signal,q,d.value,Lr(j||{},{epsg:r.configuration.epsg})),jt=$||"default",V=u.value.categoryProperties?.[jt];return{categoryId:jt,categoryLabel:V?Ci(V.label):Ci(It=>It.defaultLabel,{ns:xn}),features:vt,groupId:z||"defaultGroup"}})).then($=>l.value=bnt($,A)).catch($=>{console.error(`@polar/polar(plugins/addressSearch/store:249:6)
`,"An error occurred while searching.",$),l.value=Fa.ERROR}).finally(()=>{a.value=!1})}async function T(A,$="never"){if(d.value=A,e&&(e.abort(),e=null),await P(),!Array.isArray(l.value))return;const z=l.value.find(({features:et})=>et.features.length);if(!z)return;const j=z.features.features;($==="first"&&j.length>=1||$==="only"&&j.length===1)&&D(j[0],z.categoryId)}function D(A,$="default"){const z=u.value.customSelectResult?.[$];z?z(A,$):(s.value=A,o.value=A.title,l.value=Fa.NO_SEARCH)}return{chosenAddress:s,inputValue:d,afterResultComponent:h,focusAfterSearch:f,groupSelectOptions:y,hasMultipleGroups:_,isLoading:a,searchResults:l,selectedGroupId:E,featuresAvailable:g,hint:x,limitResults:v,abortAndRequest:F,clear:N,search:T,selectResult:D,setupPlugin:R,teardownPlugin:I}});function k8(r,t,e){for(let i=0;i<r;i++){const n=t.getElementById(`polar-plugin-address-search-results-feature-${i}-0`);if(n){n.focus(),e?.preventDefault();break}}}function ast(r,t){const e=r.toLowerCase().indexOf(t.toLowerCase());return e===-1?r:r.substring(0,e)+"<strong>"+r.substring(e,e+t.length)+"</strong>"+r.substring(e+t.length)}const lst={key:0,id:"polar-plugin-address-search-result-wrapper",tabindex:"-1"},cst={key:0,class:"polar-plugin-address-search-category-label"},hst=["id","onClick","onKeydown"],ust={class:"span-sr-only"},dst=["innerHTML"],gst=["onClick"],fst={class:"kern-label"},pst={key:2,class:"kern-divider","aria-hidden":"true"},mst=je({__name:"SearchResults.ce",setup(r){const t=ar(),e=zE(),{afterResultComponent:i,featuresAvailable:n,inputValue:s,limitResults:o,searchResults:a,selectedGroupId:l}=yr(e);Zr(l,()=>c.value=[]);const c=me([]),h=Ct(()=>Array.isArray(e.searchResults)?structuredClone(to(e.searchResults)).filter(p=>p.groupId===e.selectedGroupId).reduce((p,m)=>{const y=p.findIndex(_=>_.categoryId===m.categoryId);return y===-1?[...p,m]:(p[y].features.features=[...p[y].features.features,...m.features.features],p)},[]).map(p=>(u(p.categoryId)||(p.features.features=p.features.features.slice(0,o.value)),p)):[]);Zr(h,()=>{e.focusAfterSearch&&ju(()=>{k8(h.value.length,t.shadowRoot)})});function u(p){return c.value.includes(p)}function d(){t.shadowRoot.getElementById("polar-plugin-address-search-input")?.focus()}function g(p,m){const{target:y}=m;if(y===null){console.warn(`@polar/polar(plugins/addressSearch/components/SearchResults.ce.vue?vue&type=script&setup=true&lang:112:3)
`,`@polar/polar(plugins/addressSearch/components/SearchResults.ce:174:3)
`,"Could not focus any element.");return}const _=(t.shadowRoot?.getElementById("polar-plugin-address-search-result-wrapper")).querySelectorAll("li, button"),x=[..._].indexOf(y),v=_[(x+(p?1:-1))%_.length];if(v){v.focus();return}t.shadowRoot.getElementById("polar-plugin-address-search-input")?.focus()}function f(p){c.value=c.value.indexOf(p)===-1?[...c.value,p]:c.value.filter(m=>m!==p)}return(p,m)=>nt(n)?(ht(),Gt("div",lst,[(ht(!0),Gt(ri,null,tn(h.value,(y,_)=>(ht(),Gt(ri,{key:y.categoryId},[h.value.length>1?(ht(),Gt("h2",cst,nr(y.categoryLabel)+" "+nr(p.$t(x=>x.resultCount,{count:nt(a)[_].features.features.length,ns:nt(xn)})),1)):xr("",!0),Yt("ul",{class:mr({"polar-plugin-address-search-list-without-label":h.value.length===1})},[(ht(!0),Gt(ri,null,tn(y.features.features,(x,v)=>(ht(),Gt("li",{key:`result-${_}-${v}`,id:`polar-plugin-address-search-results-feature-${_}-${v}`,tabindex:"-1",onClick:w=>nt(e).selectResult(x,y.categoryId),onKeydown:[za(Ys(w=>nt(e).selectResult(x,y.categoryId),["prevent","stop"]),["enter"]),m[0]||(m[0]=za(Ys(w=>g(!0,w),["prevent","stop"]),["down"])),m[1]||(m[1]=za(Ys(w=>g(!1,w),["prevent","stop"]),["up"])),za(Ys(d,["prevent","stop"]),["escape"])]},[Yt("span",ust,nr(x.title),1),Yt("span",{"aria-hidden":"true",innerHTML:nt(ast)(x.title,nt(s))},null,8,dst),nt(i)?(ht(),Ee(yn(nt(i)),{key:0,feature:x},null,8,["feature"])):xr("",!0)],40,hst))),128))],2),nt(a)[_].features.features.length>nt(o)?(ht(),Gt("button",{key:1,class:"kern-btn kern-btn--tertiary",onKeydown:[m[2]||(m[2]=za(Ys(x=>g(!0,x),["prevent","stop"]),["down"])),m[3]||(m[3]=za(Ys(x=>g(!1,x),["prevent","stop"]),["up"]))],onClick:x=>f(y.categoryId)},[Yt("span",{class:mr(`kern-icon ${u(y.categoryId)?"kern-icon--keyboard-arrow-up":"kern-icon--keyboard-arrow-down"}`),"aria-hidden":"true"},null,2),Yt("span",fst,nr(p.$t(x=>x.resultList[u(y.categoryId)?"reduce":"extend"],{ns:nt(xn)})),1)],40,gst)):xr("",!0),_<h.value.length-1?(ht(),Gt("hr",pst)):xr("",!0)],64))),128))])):xr("",!0)}}),yst="#polar-plugin-address-search-result-wrapper{&[data-v-7246567e]{display:flex;flex-direction:column;gap:var(--kern-metric-space-2x-small);width:100%;padding-bottom:.625rem;overflow-y:auto}.polar-plugin-address-search-category-label[data-v-7246567e]{display:flex;align-items:center;min-height:var(--kern-metric-dimension-large);padding:0 var(--kern-metric-space-small);margin:0;font-size:calc(var(--kern-typography-font-size-static-small) * .875);font-weight:400;color:var(--kern-color-layout-text-muted)}.polar-plugin-address-search-list-without-label[data-v-7246567e]{margin-top:var(--kern-metric-space-x-small)}ul{&[data-v-7246567e]{margin:0;padding:0}li{&[data-v-7246567e]{display:flex;align-items:center;min-height:var(--kern-metric-dimension-x-large);padding:var(--kern-metric-space-none) var(--kern-metric-space-small);margin:var(--kern-metric-space-none) var(--kern-metric-space-small);border-radius:var(--kern-metric-border-radius-default);color:var(--kern-color-layout-text-default);transition:.3s cubic-bezier(.25,.8,.5,1)}&[data-v-7246567e]:hover,&[data-v-7246567e]:focus{background-color:var(--kern-color-layout-background-hued);cursor:pointer}}}button[data-v-7246567e]{margin:var(--kern-metric-space-none) var(--kern-metric-space-small)}}.span-sr-only[data-v-7246567e]{width:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}",_st=gr(mst,[["styles",[yst]],["__scopeId","data-v-7246567e"]]),vst={class:"kern-loader kern-loader--visible",role:"status"},xst={class:"kern-sr-only"},wst=je({__name:"SmallLoader.ce",setup(r){return(t,e)=>(ht(),Gt("div",vst,[Yt("span",xst,nr(t.$t(i=>i.hint.loading,{ns:nt(xn)})),1)]))}}),bst=".kern-loader{&[data-v-06c648df]{width:var(--kern-metric-dimension-large);height:var(--kern-metric-dimension-large);margin:var(--kern-metric-space-small)}&[data-v-06c648df]:before,&[data-v-06c648df]:after{display:none}}",kst=gr(wst,[["styles",[bst]],["__scopeId","data-v-06c648df"]]),Est={class:"polar-plugin-address-search-selection-wrapper"},Sst={class:"polar-plugin-address-search-input-wrapper"},Tst={id:"polar-plugin-address-search-input-description",class:"kern-sr-only"},Cst=["aria-label","onKeydown"],Mst={class:"kern-label kern-sr-only"},Rst={class:"kern-sr-only","aria-live":"polite"},Ist={key:2,class:"polar-plugin-address-search-hint"},Pst=je({__name:"AddressSearch.ce",setup(r){const t=ar(),e=zE(),{layout:i}=yr(t),{groupSelectOptions:n,hasMultipleGroups:s,hint:o,inputValue:a,isLoading:l,searchResults:c,selectedGroupId:h}=yr(e),u=Ct(()=>Ci(m=>m[n.value.find(({groupId:y})=>y===h.value)?.text||"defaultLabel"],{ns:xn})),d=Ct(()=>`${t.clientWidth*.75}px`),g=Ct(()=>i.value==="standard"?"0":"var(--kern-metric-space-small)");function f(){e.clear(),ju(()=>{(t.shadowRoot?.getElementById("polar-plugin-address-search-input")).focus()})}function p(m){Array.isArray(e.searchResults)&&k8(e.searchResults.length,t.shadowRoot,m)}return(m,y)=>(ht(),Ee(LE,{class:mr({"has-hint":nt(o).length>0,"polar-plugin-address-search-shown-results":Array.isArray(nt(c))&&nt(c).length,"kern-card-standard":nt(i)==="standard"}),style:ll(`max-width: ${d.value}`)},{default:Ps(()=>[Yt("div",Est,[nt(s)?(ht(),Ee(c8,{key:0,"aria-label":m.$t(_=>_.groupSelector,{ns:nt(xn)}),options:nt(n).map(({groupId:_,text:x})=>({value:_,label:m.$t(v=>v[x],{ns:nt(xn)})})),value:nt(h),"onUpdate:value":y[0]||(y[0]=_=>h.value=_)},null,8,["aria-label","options","value"])):xr("",!0),Yt("div",Sst,[y[4]||(y[4]=Yt("span",{class:"kern-icon kern-icon--search","aria-hidden":"true"},null,-1)),Yt("span",Tst,nr(m.$t(_=>_.aria.description,{ns:nt(xn)})),1),RM(Yt("input",{id:"polar-plugin-address-search-input","onUpdate:modelValue":y[1]||(y[1]=_=>qv(a)?a.value=_:null),class:"kern-form-input__input",type:"text","aria-label":u.value,"aria-describedby":"polar-plugin-address-search-input-description",onKeydown:[y[2]||(y[2]=za((..._)=>nt(e).abortAndRequest&&nt(e).abortAndRequest(..._),["enter"])),za(Ys(p,["prevent","stop"]),["down"])]},null,40,Cst),[[lO,nt(a)]]),nt(l)?(ht(),Ee(kst,{key:0,style:ll(`right: ${g.value}; top: ${g.value}`)},null,8,["style"])):xr("",!0),nt(a).length&&!nt(l)?(ht(),Gt("button",{key:1,class:"kern-btn kern-btn--tertiary polar-plugin-address-search-input-button",style:ll(`right: ${g.value}; top: ${g.value}`),onClick:f},[y[3]||(y[3]=Yt("span",{class:"kern-icon kern-icon--close","aria-hidden":"true"},null,-1)),Yt("span",Mst,nr(m.$t(_=>_.hint.clear,{ns:nt(xn)})),1)],4)):xr("",!0),Yt("span",Rst,nr(nt(o)),1),nt(o).length?(ht(),Gt("span",Ist,nr(nt(o)),1)):xr("",!0)])]),po(_st)]),_:1},8,["class","style"]))}}),Ast="#polar-plugin-address-search-icon-button[data-v-2b842cbb]{position:absolute;margin:var(--kern-metric-space-small)}.kern-card.polar-plugin-address-search-shown-results[data-v-2b842cbb] .kern-card__container{padding-bottom:0}.kern-card.has-hint[data-v-2b842cbb] .kern-card__container{padding-bottom:var(--kern-metric-space-small)}.kern-card.kern-card-standard[data-v-2b842cbb]{position:absolute;min-width:inherit;z-index:2}.kern-card{&[data-v-2b842cbb]{display:flex;flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-small);margin:var(--kern-metric-space-small);max-height:calc(calc(100% - var(--kern-metric-dimension-large)) - calc(2 * var(--kern-metric-space-small)));width:25rem;min-width:inherit}&[data-v-2b842cbb] .kern-card__container{flex:0 1 auto;overflow-y:auto}.polar-plugin-address-search-selection-wrapper{&[data-v-2b842cbb]{display:flex;flex-direction:row;align-items:center;width:100%;gap:var(--kern-metric-space-small)}&[data-v-2b842cbb] select{width:0}.polar-plugin-address-search-input-wrapper{&[data-v-2b842cbb]{display:grid;grid-template-columns:auto minmax(0,1fr);grid-template-rows:auto auto;align-items:center;width:100%;column-gap:var(--kern-metric-space-small)}.kern-icon--search[data-v-2b842cbb]{grid-column:1;grid-row:1;width:var(--kern-metric-dimension-large);height:var(--kern-metric-dimension-large)}#polar-plugin-address-search-input[data-v-2b842cbb]{grid-column:2;grid-row:1;border-radius:var(--kern-metric-border-radius-small);background:var(--kern-color-form-input-background);padding-right:calc(var(--kern-metric-space-large) * 2)}.polar-plugin-address-search-input-button[data-v-2b842cbb]{position:absolute;right:0;top:0;border-radius:var(--kern-metric-border-radius-small);margin:var(--kern-metric-space-default);width:var(--kern-metric-dimension-large);min-height:var(--kern-metric-dimension-large)}.kern-loader[data-v-2b842cbb]{position:absolute;right:0;top:0;margin:var(--kern-metric-space-default)}.polar-plugin-address-search-hint[data-v-2b842cbb]{grid-column:2;grid-row:2;color:var(--kern-color-layout-text-muted);font-size:calc(var(--kern-typography-font-size-static-small) * .875);padding:0 var(--kern-metric-space-2x-small);margin-top:var(--kern-metric-space-small)}}}}",Lst=gr(Pst,[["styles",[Ast]],["__scopeId","data-v-2b842cbb"]]),Ost={aria:{description:"Durch Eingabe in das Suchfeld kann die Suche nach Adressen gestartet werden"},defaultLabel:"Adresssuche",hint:{button:"Eingabefeld der Addresssuche anzeigen",clear:"Das Eingabefeld der Addresssuche leeren",error:"Etwas ist bei der Suche schiefgegangen.",loading:"Suche ...",noResults:"Keine Ergebnisse gefunden.",tooShort:"FÃ¼r die Suche bitte mindestens {{minLength}} Zeichen eingeben."},groupSelector:"Suchthema auswÃ¤hlen",resultCount:"({{count}} Ergebnisse)",resultList:{extend:"Alle Ergebnisse anzeigen",reduce:"Ergebnisliste reduzieren"}},Fst={aria:{description:"By entering text into the search field, the address search can be started"},defaultLabel:"Address Search",hint:{button:"Show address search input field",clear:"Clear address search input field",error:"Something went wrong.",loading:"Searching ...",noResults:"No results for the current query.",tooShort:"Please enter at least {{minLength}} characters."},groupSelector:"Select search topic",resultCount:"({{count}} results)",resultList:{extend:"Show all results",reduce:"Reduce result list"}},Nst=[{type:"de",resources:Ost},{type:"en",resources:Fst}];function Rdt(r){return{id:xn,component:Lst,locales:Nst,storeModule:zE,options:r}}const Dst={class:"kern-label kern-sr-only"},$st=je({__name:"PolarIconButton.ce",props:{hint:{type:String},icon:{type:String},active:{type:Boolean},tooltipPosition:{type:String}},setup(r){const{hasSmallDisplay:t}=yr(ar());return(e,i)=>(ht(),Gt("button",{class:mr(["kern-btn kern-btn--secondary polar-icon-button",{"polar-icon-button-active":r.active}])},[Yt("span",{class:mr(["kern-icon",{[r.icon]:!0,"polar-icon-button-icon-active":r.active}]),"aria-hidden":"true"},null,2),Yt("span",Dst,nr(r.hint),1),r.tooltipPosition&&!nt(t)?(ht(),Gt("span",{key:0,class:mr(["polar-tooltip",`polar-tooltip-${r.tooltipPosition}`]),"aria-hidden":"true"},nr(r.hint),3)):xr("",!0)],2))}}),Gst=".polar-icon-button{&[data-v-c643a442]{position:relative;background:var(--kern-color-layout-background-default);box-shadow:var(--polar-shadow);border:none}&[data-v-c643a442]:focus,&[data-v-c643a442]:hover{background:var(--kern-color-layout-background-default);border:solid var(--kern-color-action-on-default);outline:solid var(--kern-color-action-default)}.polar-icon-button-icon-active[data-v-c643a442]{background:var(--kern-color-layout-background-default)}.polar-tooltip{&[data-v-c643a442]{z-index:42;position:absolute;padding:5px 16px;font-family:sans-serif;background:#616161e6;color:#fff;border:2px solid #fff;border-radius:4px;font-size:14px;line-height:22px;white-space:nowrap;pointer-events:none;transition-property:opacity,right,left;transition-duration:.25s;transition-timing-function:ease;opacity:0}&.polar-tooltip-left[data-v-c643a442]{right:calc(100% + .75rem)}&.polar-tooltip-right[data-v-c643a442]{left:calc(100% + .75rem)}}&:hover .polar-tooltip[data-v-c643a442],&:focus-visible .polar-tooltip[data-v-c643a442]{opacity:1}}.polar-icon-button-active{&[data-v-c643a442]{background:var(--kern-color-action-default)}&[data-v-c643a442]:focus,&[data-v-c643a442]:hover{background:var(--kern-color-action-default);border:solid var(--kern-color-action-on-default);outline:solid var(--kern-color-action-default)}}",qE=gr($st,[["styles",[Gst]],["__scopeId","data-v-c643a442"]]),Sy="fullscreen",BE=Sl("plugins/fullscreen",()=>{const r=ar(),t=Ct(()=>r.configuration[Sy]),e=Ct(()=>t.value.renderType),i=Ct(()=>typeof t.value.targetContainer=="string"?document.getElementById(t.value.targetContainer)||document.documentElement:t.value.targetContainer?t.value.targetContainer:r.lightElement||document.documentElement),n=me(!1),s=me(null);function o(){r.lightElement&&(s.value=r.lightElement.style.cssText,r.lightElement.style.position="fixed",r.lightElement.style.margin="0",r.lightElement.style.top="0",r.lightElement.style.left="0",r.lightElement.style.width="100%",r.lightElement.style.height="100%",r.lightElement.style.zIndex="9999")}async function a(){if(!i.value.requestFullscreen){if(i.value.webkitRequestFullscreen){await i.value.webkitRequestFullscreen(),h();return}o();return}await i.value.requestFullscreen(),h()}async function l(){if(s.value!==null){r.lightElement&&(r.lightElement.style.cssText=s.value),s.value=null;return}if(document.webkitExitFullscreen){await document.webkitExitFullscreen(),h();return}await document.exitFullscreen(),h()}const c=Ct({get:()=>s.value!==null||n.value,set:g=>{(g?a:l)().catch(()=>{console.warn(`@polar/polar(plugins/fullscreen/store:110:5)
`,"Failed to toggle fullscreen mode")})}});function h(){n.value=!!(document.fullscreenElement||document.webkitFullscreenElement)}function u(){addEventListener("fullscreenchange",h),addEventListener("webkitfullscreenchange",h)}function d(){removeEventListener("fullscreenchange",h),removeEventListener("webkitfullscreenchange",h)}return{fullscreenEnabled:c,enableSimulatedFullscreen:o,renderType:e,setupPlugin:u,teardownPlugin:d}});if(import.meta.vitest){const{expect:r,test:t,vi:e}=import.meta.vitest,{createPinia:i,setActivePinia:n}=await Es(async()=>{const{createPinia:l,setActivePinia:c}=await import("./pinia-DFMOV6lD-BZLsqLPB.js");return{createPinia:l,setActivePinia:c}},__vite__mapDeps([0,1]),import.meta.url),{reactive:s}=await Es(async()=>{const{reactive:l}=await import("./vue.runtime.esm-bundler-CYHrvVzW-BTeeWO83.js");return{reactive:l}},[],import.meta.url),o=await Es(()=>import("./indicateLoading-C_uppgjV-DVX-YvQI.js").then(l=>l.s),__vite__mapDeps([2,0,1,3]),import.meta.url),a=t.extend({coreStore:[async({},l)=>{const c=s({configuration:{[Sy]:{}}});e.spyOn(o,"useCoreStore").mockReturnValue(c),await l(c)},{auto:!0}],store:async({},l)=>{n(i());const c=BE();c.setupPlugin(),await l(c),c.teardownPlugin()}});a.for([{native:!0,webkit:!0,result:!0},{native:!0,webkit:!1,result:!0},{native:!1,webkit:!0,result:!0},{native:!1,webkit:!1,result:!1}])("Fullscreen detection uses webkit prefix if necessary (native=$native, webkit=$webkit)",({native:l,webkit:c,result:h},{store:u})=>{jsdom.window.document.fullscreenElement=l,jsdom.window.document.webkitFullscreenElement=c,dispatchEvent(new Event("fullscreenchange")),r(u.fullscreenEnabled).toBe(h)}),a.for([{native:!0,webkit:!0},{native:!0,webkit:!1},{native:!1,webkit:!0}])("Enable fullscreen uses webkit prefix if necessary (native=$native, webkit=$webkit)",async({native:l,webkit:c},{store:h,coreStore:u})=>{jsdom.window.document.fullscreenElement=null;const d=e.fn(()=>new Promise(g=>{jsdom.window.document.fullscreenElement=document.createElement("div"),g()}));u.lightElement={...l?{requestFullscreen:d}:{},...c?{webkitRequestFullscreen:d}:{}},h.fullscreenEnabled=!0,r(d).toHaveBeenCalled(),await e.waitUntil(()=>h.fullscreenEnabled),r(h.fullscreenEnabled).toBeTruthy()}),a.for([{native:!0,webkit:!0},{native:!0,webkit:!1},{native:!1,webkit:!0}])("Disable fullscreen uses webkit prefix if necessary (native=$native, webkit=$webkit)",async({native:l,webkit:c},{store:h})=>{jsdom.window.document.fullscreenElement=document.createElement("div"),dispatchEvent(new Event("fullscreenchange"));const u=e.fn(()=>new Promise(d=>{jsdom.window.document.fullscreenElement=null,d()}));l&&(jsdom.window.document.exitFullscreen=u),c&&(jsdom.window.document.webkitExitFullscreen=u),h.fullscreenEnabled=!1,r(u).toHaveBeenCalled(),await e.waitUntil(()=>!h.fullscreenEnabled),r(h.fullscreenEnabled).toBeFalsy(),delete jsdom.window.document.exitFullscreen,delete jsdom.window.document.webkitExitFullscreen}),a("Enable simulated fullscreen if Fullscreen API is not available",({store:l,coreStore:c})=>{const h=new CSSStyleDeclaration;c.lightElement={style:h},h.cssText="position: relative; width: 400px; height: 300px;",l.fullscreenEnabled=!0,r(l.fullscreenEnabled).toBeTruthy(),r(h.position).toBe("fixed"),l.fullscreenEnabled=!1,r(l.fullscreenEnabled).toBeFalsy(),r(h.position).toBe("relative")})}const jst=je({__name:"FullscreenUI.ce",setup(r){const t=ar(),e=BE(),{fullscreenEnabled:i}=yr(e),n=Ct(()=>t.layout==="standard"?"polar-plugin-fullscreen-standard":e.renderType==="iconMenu"?"":"polar-plugin-fullscreen-nine-regions");return(s,o)=>(ht(),Ee(qE,{class:mr(n.value),hint:s.$t(a=>a.button.label,{ns:nt(Sy),context:nt(i)?"off":"on"}),icon:nt(i)?"kern-icon--fullscreen-exit":"kern-icon--fullscreen","tooltip-position":"left",onClick:o[0]||(o[0]=()=>i.value=!nt(i))},null,8,["class","hint","icon"]))}}),zst=".polar-icon-button.polar-plugin-fullscreen-standard[data-v-502a0228]{box-shadow:none}.polar-icon-button.polar-plugin-fullscreen-nine-regions[data-v-502a0228]{margin:var(--kern-metric-space-small)}",qst=gr(jst,[["styles",[zst]],["__scopeId","data-v-502a0228"]]),Bst={button:{label:"Vollbildmodus",label_off:"Vollbildmodus deaktivieren",label_on:"Vollbildmodus aktivieren"}},Ust={button:{label:"Fullscreen mode",label_off:"Disable fullscreen mode",label_on:"Enable fullscreen mode"}},Wst=[{type:"de",resources:Bst},{type:"en",resources:Ust}];function Idt(r={}){return{id:Sy,component:qst,locales:Wst,storeModule:BE,options:r}}const Vst=100,Zst=100,Sv={undefinedBoundaryLayer:Symbol.for("Boundary Layer undefined"),undefinedBoundarySource:Symbol.for("Boundary Source undefined"),sourceNotReady:Symbol.for("Source not ready")};async function Hst(r){let t=0;for(;r.getState()!=="ready"||r.getFeatures().length===0;)if(t++<Vst)await new Promise(e=>{setTimeout(e,Zst)});else return!1;return!0}async function Yst(r,t,e){if(typeof t>"u")return!0;const i=r.getLayers().getArray().find(s=>s.get("id")===t);if(!(i instanceof fs))return console.error(`@polar/polar(lib/passesBoundaryCheck:61:3)
`,`No layer configured to match boundaryLayerId "${t}".`),Sv.undefinedBoundaryLayer;const n=i.getSource();return n instanceof ls?await Hst(n)?n.getFeatures().some(s=>s.getGeometry()?.intersectsCoordinate(e)):(console.error(`@polar/polar(lib/passesBoundaryCheck:79:3)
`,`Layer with boundaryLayerId "${t}" did not load or is featureless.`),Sv.sourceNotReady):(console.error(`@polar/polar(lib/passesBoundaryCheck:70:3)
`,`Layer with boundaryLayerId "${t}" missing source.`),Sv.undefinedBoundarySource)}const dd=Sl("plugins/iconMenu",()=>{const r=ar(),t=me([]),e=me([]),i=me(null),n=me(null),s=Ct(()=>r.configuration.iconMenu?.buttonComponent?ac(r.configuration.iconMenu.buttonComponent):null);function o(){t.value=(r.configuration.iconMenu?.menus||[]).map(g=>g.filter(({plugin:{id:f}})=>{const p=r.configuration[f]?.displayComponent;return typeof p=="boolean"?p:!0})),e.value=(r.configuration.iconMenu?.focusMenus||[]).filter(({plugin:{id:g}})=>{const f=r.configuration[g]?.displayComponent;return typeof f=="boolean"?f:!0}),t.value.concat(e.value).flat().forEach(({plugin:g})=>{r.addPlugin(Lr(g,{independent:!1}))}),t.value.map(g=>g.map(f=>Lr(f,{plugin:{component:ac(f.plugin.component)}}))),e.value.map(g=>Lr(g,{plugin:{component:ac(g.plugin.component)}}));const u=r.configuration.iconMenu?.initiallyOpen;!r.hasSmallHeight&&!r.hasSmallWidth&&u&&l(u);const d=r.configuration.iconMenu?.focusInitiallyOpen;!r.hasSmallHeight&&!r.hasSmallWidth&&d&&c(d)}function a(){}function l(u){t.value.flat().find(({plugin:{id:d}})=>d===u)&&(i.value=u,h(u))}function c(u){e.value.find(({plugin:{id:d}})=>d===u)&&(n.value=u,h(u,!0))}function h(u,d=!1){const g=(d?e.value:t.value.flat()).find(({plugin:{id:f}})=>f===u);if(!g){console.error(`@polar/polar(plugins/iconMenu/store:120:4)
`,`Menu with id ${u} could not be found.`);return}if(!g.plugin.component){console.error(`@polar/polar(plugins/iconMenu/store:124:4)
`,`The plugin ${g.plugin.id} does not have any component to display and thus can not be opened in the moveHandle.`);return}r.hasWindowSize&&r.hasSmallWidth&&(d&&i.value!==null?i.value=null:!d&&n.value!==null&&(n.value=null)),r.setMoveHandle({closeFunction:()=>{if(d){n.value=null;return}i.value=null},closeLabel:Ci(f=>f.mobileCloseButton,{ns:"iconMenu",plugin:Ci(f=>f.hints[g.plugin.id],{ns:"iconMenu"})}),component:g.plugin.component,plugin:"iconMenu"})}return{menus:t,focusMenus:e,open:i,focusOpen:n,buttonComponent:s,openInMoveHandle:h,openMenuById:l,openFocusMenuById:c,setupPlugin:o,teardownPlugin:a}}),Xst=je({__name:"NineRegionsButton.ce",props:{icon:{type:String},id:{type:String},hint:{type:String}},setup(r){const t=r,e=dd(),{open:i}=yr(e),n=Ct(()=>i.value===t.id),s=MM("updateMaxWidth");function o(){i.value===t.id?(i.value=null,ar().setMoveHandle(null)):(i.value=t.id,e.openInMoveHandle(t.id)),s()}return(a,l)=>(ht(),Ee(qE,{active:n.value,hint:r.hint,icon:r.icon,"tooltip-position":"left",onClick:o},null,8,["active","hint","icon"]))}}),Kst=je({__name:"NineRegionsMenu.ce",setup(r){const t=dd(),{clientHeight:e,deviceIsHorizontal:i,hasSmallWidth:n,hasWindowSize:s}=yr(ar()),{buttonComponent:o,open:a}=yr(t),l=me("inherit"),c=_u("pluginComponent"),h=Ct(()=>t.menus.flat()),u=Ct(()=>h.value.length>1),d=Ct(()=>s.value?"inherit":`calc(${e.value}px - ${i.value?"calc(100% + 1.5em)":"1em"})`);Zr(i,f=>{f||g()}),zc(()=>{addEventListener("resize",g),g()}),t1(()=>{removeEventListener("resize",g)});function g(){ju(()=>{if(c.value?.[0])if(s.value)l.value="inherit";else{const{left:f,width:p}=c.value[0].$el.getBoundingClientRect();l.value=`${p+f}px`}})}return cO("updateMaxWidth",g),(f,p)=>(ht(),Ee(yn(u.value?"ul":"div"),{class:"polar-plugin-icon-menu-list"},{default:Ps(()=>[(ht(!0),Gt(ri,null,tn(h.value,({plugin:m,icon:y},_)=>(ht(),Ee(yn(u.value?"li":"div"),{key:_,class:mr(nt(i)?"polar-plugin-icon-menu-list-item-horizontal":"polar-plugin-icon-menu-list-item")},{default:Ps(()=>[y===void 0?(ht(),Ee(yn(m.component),{key:0})):(ht(),Gt(ri,{key:1},[nt(o)?(ht(),Ee(yn(nt(o)),{key:0,id:m.id,icon:y,hint:f.$t(x=>x.hints[m.id],{ns:"iconMenu"})},null,8,["id","icon","hint"])):(ht(),Ee(Xst,{key:1,id:m.id,icon:y,hint:f.$t(x=>x.hints[m.id],{ns:"iconMenu"})},null,8,["id","icon","hint"])),nt(a)===m.id&&(!nt(s)||!nt(n))?(ht(),Ee(yn(m.component),{key:2,ref_for:!0,ref_key:"pluginComponent",ref:c,class:mr([nt(i)?"polar-plugin-icon-menu-list-item-content-horizontal":"polar-plugin-icon-menu-list-item-content","polar-plugin-icon-menu-list-item-content-scrollable-y"]),style:ll(`max-height: ${d.value}; max-width: ${l.value}`)},null,8,["class","style"])):xr("",!0)],64))]),_:2},1032,["class"]))),128))]),_:1}))}}),Qst=".polar-plugin-icon-menu-list[data-v-3485794c]{position:relative;list-style:none;padding:0;margin:var(--kern-metric-space-small)}.polar-plugin-icon-menu-list-item-horizontal[data-v-3485794c]{float:left;margin-left:var(--kern-metric-space-small)}.polar-plugin-icon-menu-list-item[data-v-3485794c]{margin-bottom:var(--kern-metric-space-small);z-index:1}.polar-plugin-icon-menu-list-item-content[data-v-3485794c]{position:absolute;white-space:nowrap;top:0;right:calc(100% + var(--kern-metric-space-small))}.polar-plugin-icon-menu-list-item-content-horizontal[data-v-3485794c]{position:absolute;white-space:nowrap;top:calc(100% + var(--kern-metric-space-small));right:calc(-1 * var(--kern-metric-space-small))}.polar-plugin-icon-menu-list-item-content-scrollable-y[data-v-3485794c]{z-index:1;overflow-y:auto;scrollbar-gutter:stable}",Jst=gr(Kst,[["styles",[Qst]],["__scopeId","data-v-3485794c"]]),tot={class:"polar-plugin-icon-menu-focus-list-wrapper"},eot=["onClick"],rot={class:"kern-label"},iot=je({__name:"StandardFocusMenu.ce",props:{menus:{type:Array}},setup(r){const t=r,e=ar(),{clientHeight:i,hasSmallWidth:n,hasWindowSize:s,moveHandleTop:o}=yr(e),a=dd(),l=me(null),c=Ct(()=>`bottom: ${s.value&&o.value!==null?Math.min(i.value-o.value,i.value/4)/16:e.getPluginStore("footer")===null?0:1.5}rem`),h=Ct(()=>s.value?"inherit":`calc(${e.clientHeight}px - ${e.deviceIsHorizontal?"calc(100% + 1.5em)":"1em"})`);function u(d){a.focusOpen===d?(a.focusOpen=null,l.value=null,e.setMoveHandle(null)):(a.focusOpen=d,l.value=ac(t.menus.find(({plugin:g})=>g.id===d).plugin.component),a.openInMoveHandle(d,!0))}return(d,g)=>(ht(),Gt("div",tot,[l.value&&(!nt(s)||!nt(n))?(ht(),Ee(yn(l.value),{key:0,class:"polar-plugin-icon-menu-focus-list-content",style:ll(`max-height: ${h.value}`)},null,8,["style"])):xr("",!0),Yt("ul",{class:"polar-plugin-icon-menu-focus-list",style:ll(c.value)},[(ht(!0),Gt(ri,null,tn(r.menus,({buttonClass:f,icon:p,plugin:m})=>(ht(),Gt("li",{key:m.id,class:"polar-plugin-icon-menu-focus-list-item"},[Yt("button",{class:mr(["kern-btn kern-btn--secondary polar-plugin-icon-menu-button",f]),onClick:()=>u(m.id)},[Yt("span",{class:mr(["kern-icon",p]),"aria-hidden":"true"},null,2),Yt("span",rot,nr(nt(Ci)(y=>y.hints[m.id],{ns:"iconMenu"})),1)],10,eot)]))),128))],4)]))}}),not=".polar-plugin-icon-menu-focus-list-wrapper{&[data-v-7436f112]{display:flex;align-items:center;justify-content:center;gap:.5rem}.polar-plugin-icon-menu-focus-list{&[data-v-7436f112]{list-style:none;position:absolute;padding:0;border-radius:.5rem;background:var(--kern-color-layout-background-default);box-shadow:var(--polar-shadow);transition:bottom .25s ease;z-index:1}.polar-plugin-icon-menu-focus-list-item{&[data-v-7436f112]{margin-bottom:0}.polar-plugin-icon-menu-button{&[data-v-7436f112]{box-shadow:none;border:none}&[data-v-7436f112]:focus,&[data-v-7436f112]:hover{background:var(--kern-color-layout-background-default);border:solid var(--kern-color-action-on-default);outline:solid var(--kern-color-action-default)}}.polar-plugin-icon-menu-button-active{&[data-v-7436f112]{background:color-mix(in oklch,var(--kern-color-action-default) 12%,transparent)}&[data-v-7436f112]:focus,&[data-v-7436f112]:hover{background:color-mix(in oklch,var(--kern-color-action-default) 12%,transparent)}}}}.polar-plugin-icon-menu-focus-list-content[data-v-7436f112]{z-index:2;position:absolute;top:0;left:0;margin:var(--kern-metric-space-small);white-space:nowrap;overflow-y:auto;scrollbar-gutter:stable}}",sot=gr(iot,[["styles",[not]],["__scopeId","data-v-7436f112"]]),oot={class:"polar-plugin-icon-menu-list"},aot=je({__name:"StandardMenuList.ce",props:{menus:{type:Array},baseIndex:{default:0,type:Number}},setup(r){const t=ar(),{deviceIsHorizontal:e,hasSmallWidth:i,hasWindowSize:n}=yr(t),s=dd(),{open:o}=yr(s),a=me("inherit"),l=_u("pluginComponent"),c=Ct(()=>n.value?"inherit":`calc(${t.clientHeight}px - ${e.value?"calc(100% + 1.5rem)":t.getPluginStore("footer")===null?"4.5rem":"6.5rem"})`);Zr(e,d=>{d||h()}),zc(()=>{addEventListener("resize",h),h()}),t1(()=>{removeEventListener("resize",h)});function h(){ju(()=>{if(l.value?.[0])if(n.value)a.value="inherit";else{const{left:d,width:g}=l.value[0].$el.getBoundingClientRect();a.value=`${g+d}px`}})}function u(d){o.value===d?(o.value=null,t.setMoveHandle(null)):(o.value=d,s.openInMoveHandle(d)),h()}return(d,g)=>(ht(),Gt("ul",oot,[(ht(!0),Gt(ri,null,tn(r.menus,({buttonClass:f,icon:p,plugin:m},y)=>(ht(),Gt("li",{key:y,class:mr(nt(e)?"polar-plugin-icon-menu-list-item-horizontal":"polar-plugin-icon-menu-list-item")},[typeof p>"u"?(ht(),Ee(yn(m.component),{key:0})):(ht(),Gt(ri,{key:1},[po(qE,{class:mr(f),hint:d.$t(_=>_.hints[m.id],{ns:"iconMenu"}),icon:p,"tooltip-position":"left",onClick:()=>u(m.id)},null,8,["class","hint","icon","onClick"]),nt(o)===m.id&&(!nt(n)||!nt(i))?(ht(),Ee(yn(m.component),{key:0,ref_for:!0,ref_key:"pluginComponent",ref:l,class:mr(nt(e)?"polar-plugin-icon-menu-list-item-content-horizontal":"polar-plugin-icon-menu-list-item-content"),style:ll(`max-height: ${c.value}; max-width: ${a.value}`)},null,8,["class","style"])):xr("",!0)],64))],2))),128))]))}}),lot=".polar-icon-button.polar-plugin-icon-menu-button[data-v-ffef7f9e]{box-shadow:none}.polar-icon-button.polar-plugin-icon-menu-button-active{&[data-v-ffef7f9e]{background:color-mix(in oklch,var(--kern-color-action-default) 12%,transparent)}&[data-v-ffef7f9e]:focus,&[data-v-ffef7f9e]:hover{background:color-mix(in oklch,var(--kern-color-action-default) 12%,transparent)}}.polar-plugin-icon-menu-list{&[data-v-ffef7f9e]{list-style:none;margin:0;padding:0;border-radius:.5rem;background:var(--kern-color-layout-background-default);box-shadow:var(--polar-shadow)}.polar-plugin-icon-menu-list-item[data-v-ffef7f9e]:nth-child(n+2){margin-top:3px}.polar-plugin-icon-menu-list-item-horizontal[data-v-ffef7f9e]{float:left}.polar-plugin-icon-menu-list-item-horizontal[data-v-ffef7f9e]:nth-child(n+2){margin-left:3px}.polar-plugin-icon-menu-list-item-content[data-v-ffef7f9e]{z-index:2;position:absolute;right:calc(100% + .5rem);top:0;white-space:nowrap;overflow-y:auto;scrollbar-gutter:stable}.polar-plugin-icon-menu-list-item-content-horizontal[data-v-ffef7f9e]{z-index:1;position:absolute;top:calc(100% + .5rem);right:0;white-space:nowrap;overflow-y:auto;scrollbar-gutter:stable}}",cot=gr(aot,[["styles",[lot]],["__scopeId","data-v-ffef7f9e"]]),hot=je({__name:"StandardMenu.ce",setup(r){const{deviceIsHorizontal:t}=yr(ar()),e=dd(),i=Ct(()=>e.menus.map(s=>s.map(o=>Lr(o,{buttonClass:[ar().layout==="standard"?"polar-plugin-icon-menu-button":"",e.open===o.plugin.id?" polar-plugin-icon-menu-button-active":""].reduce((a,l)=>a.concat(" ",l)),icon:"icon"in o?o.icon:o.plugin.icon})))),n=Ct(()=>e.focusMenus.map(s=>Lr(s,{buttonClass:e.focusOpen===s.plugin.id?"polar-plugin-icon-menu-button-active":""})));return(s,o)=>(ht(),Gt(ri,null,[Yt("div",{class:mr(["polar-plugin-icon-menu-list-wrapper",{"polar-plugin-icon-menu-list-wrapper-horizontal":nt(t)}])},[(ht(!0),Gt(ri,null,tn(i.value,(a,l)=>(ht(),Ee(cot,{key:l,menus:a,"base-index":l},null,8,["menus","base-index"]))),128))],2),n.value.length?(ht(),Ee(sot,{key:0,menus:n.value},null,8,["menus"])):xr("",!0)],64))}}),uot=".polar-plugin-icon-menu-list-wrapper[data-v-c38a42bc]{position:absolute;right:0;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:var(--kern-metric-space-x-small);margin:var(--kern-metric-space-small)}.polar-plugin-icon-menu-list-wrapper-horizontal[data-v-c38a42bc]{flex-direction:row}",dot=gr(hot,[["styles",[uot]],["__scopeId","data-v-c38a42bc"]]),got=je({__name:"IconMenu.ce",setup(r){const{layout:t}=yr(ar());return(e,i)=>nt(t)==="standard"?(ht(),Ee(dot,{key:0})):(ht(),Ee(Jst,{key:1}))}}),fot={mobileCloseButton:"{{plugin}} schlieÃen",hints:{attributions:"Quellennachweis",draw:"Zeichenwerkzeuge",filter:"Filter",layerChooser:"Kartenauswahl",gfi:"Objektliste"}},pot={mobileCloseButton:"Close {{plugin}}",hints:{attributions:"Attributions",draw:"Draw tools",filter:"Filter",layerChooser:"Choose map",gfi:"Feature list"}},mot=[{type:"de",resources:fot},{type:"en",resources:pot}],yot="iconMenu";function Pdt(r){return{id:yot,component:got,locales:mot,storeModule:dd,options:r}}function _ot({legendURL:r,layers:t="",url:e,typ:i,format:n,version:s}){return r?r==="ignore"?[]:[r]:t.split(",").filter(o=>o).map(o=>`${e}?SERVICE=${i}&REQUEST=GetLegendGraphic&FORMAT=${n||"image/png"}&VERSION=${s}&LAYER=${o}`)}const J3=(r,t)=>r.filter(e=>{let{minZoom:i,maxZoom:n}=e;return typeof i>"u"&&(i=0),typeof n>"u"&&(n=Number.MAX_SAFE_INTEGER),i<=t&&t<=n});let vot=class{read(t){if(!t)return null;if(typeof t=="string"){const e=oc(t);return this.readFromDocument(e)}return sc(t)?this.readFromDocument(t):this.readFromNode(t)}readFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null}readFromNode(t){te()}};const xot="http://www.w3.org/1999/xlink";function UE(r){return r.getAttributeNS(xot,"href")}const gi=[null,"http://www.opengis.net/wms","http://www.opengis.net/sld"];function ep(r){return N1(r[0].version,"1.3")>=0}const wot=di(gi,{Service:bt(Bot),Capability:bt(qot)}),bot=di(gi,{Request:bt(Qot),Exception:bt(Zot),Layer:bt(Hot),UserDefinedSymbolization:bt(jot)});let kot=class extends vot{constructor(){super(),this.version=void 0}readFromNode(t){return this.version=t.getAttribute("version").trim(),re({version:this.version},wot,t,[])||null}};const E8={Name:bt(Ge),Title:bt(Ge),Abstract:bt(Ge),KeywordList:bt(I8),OnlineResource:bt(UE),ContactInformation:bt(Uot),Fees:bt(Ge),AccessConstraints:bt(Ge)},Eot=di(gi,E8),Sot=di(gi,{...E8,LayerLimit:bt(zo),MaxWidth:bt(zo),MaxHeight:bt(zo)}),Tot=di(gi,{ContactPersonPrimary:bt(Wot),ContactPosition:bt(Ge),ContactAddress:bt(Vot),ContactVoiceTelephone:bt(Ge),ContactFacsimileTelephone:bt(Ge),ContactElectronicMailAddress:bt(Ge)}),Cot=di(gi,{ContactPerson:bt(Ge),ContactOrganization:bt(Ge)}),Mot=di(gi,{AddressType:bt(Ge),Address:bt(Ge),City:bt(Ge),StateOrProvince:bt(Ge),PostCode:bt(Ge),Country:bt(Ge)}),Rot=di(gi,{Format:oe(Ge)}),S8={Name:bt(Ge),Title:bt(Ge),Abstract:bt(Ge),KeywordList:bt(I8),BoundingBox:Ti(M8),Dimension:Ti(Yot),Attribution:bt(Got),AuthorityURL:Ti(eat),Identifier:Ti(Ge),MetadataURL:Ti(rat),DataURL:Ti(sa),FeatureListURL:Ti(sa),Style:Ti(iat),Layer:Ti(Ty)},T8=di(gi,{...S8,SRS:Ti(Ge),Extent:bt(Xot),ScaleHint:Ti(Kot),LatLonBoundingBox:bt((r,t)=>M8(r,t,!1)),Layer:Ti(Ty)}),C8=di(gi,{...S8,CRS:Ti(Ge),EX_GeographicBoundingBox:bt(zot),MinScaleDenominator:bt(Kh),MaxScaleDenominator:bt(Kh),Layer:Ti(Ty)}),Iot=di(gi,{Title:bt(Ge),OnlineResource:bt(UE),LogoURL:bt(R8)}),Pot=di(gi,{westBoundLongitude:bt(Kh),eastBoundLongitude:bt(Kh),southBoundLatitude:bt(Kh),northBoundLatitude:bt(Kh)}),Aot=di(gi,{GetCapabilities:bt(Id),GetMap:bt(Id),GetFeatureInfo:bt(Id),DescribeLayer:bt(Id),GetLegendGraphic:bt(Id)}),Lot=di(gi,{Format:Ti(Ge),DCPType:Ti(Jot)}),Oot=di(gi,{HTTP:bt(tat)}),Fot=di(gi,{Get:bt(sa),Post:bt(sa)}),Not=di(gi,{Name:bt(Ge),Title:bt(Ge),Abstract:bt(Ge),LegendURL:Ti(R8),StyleSheetURL:bt(sa),StyleURL:bt(sa)}),Dot=di(gi,{Format:bt(Ge),OnlineResource:bt(UE)}),$ot=di(gi,{Keyword:oe(Ge)});function Got(r,t){return re({},Iot,r,t)}function jot(r,t){return{SupportSLD:!!Ln(r.getAttribute("SupportSLD")),UserLayer:!!Ln(r.getAttribute("UserLayer")),UserStyle:!!Ln(r.getAttribute("UserStyle")),RemoteWFS:!!Ln(r.getAttribute("RemoteWFS")),InlineFeatureData:!!Ln(r.getAttribute("InlineFeatureData")),RemoteWCS:!!Ln(r.getAttribute("RemoteWCS"))}}function M8(r,t,e=!0){const i=[bs(r.getAttribute("minx")),bs(r.getAttribute("miny")),bs(r.getAttribute("maxx")),bs(r.getAttribute("maxy"))],n=[bs(r.getAttribute("resx")),bs(r.getAttribute("resy"))],s={extent:i,res:n};return e&&(ep(t)?s.crs=r.getAttribute("CRS"):s.srs=r.getAttribute("SRS")),s}function zot(r,t){const e=re({},Pot,r,t);if(!e)return;const i=e.westBoundLongitude,n=e.southBoundLatitude,s=e.eastBoundLongitude,o=e.northBoundLatitude;if(!(i===void 0||n===void 0||s===void 0||o===void 0))return[i,n,s,o]}function qot(r,t){return re({},bot,r,t)}function Bot(r,t){return re({},ep(t)?Sot:Eot,r,t)}function Uot(r,t){return re({},Tot,r,t)}function Wot(r,t){return re({},Cot,r,t)}function Vot(r,t){return re({},Mot,r,t)}function Zot(r,t){return re([],Rot,r,t)}function Hot(r,t){const e=re({},ep(t)?C8:T8,r,t);return e.Layer===void 0?Object.assign(e,Ty(r,t)):e}function Ty(r,t){const e=ep(t),i=t[t.length-1],n=re({},e?C8:T8,r,t);if(!n)return;let s=Ln(r.getAttribute("queryable"));s===void 0&&(s=i.queryable),n.queryable=s!==void 0?s:!1;let o=Vo(r.getAttribute("cascaded"));o===void 0&&(o=i.cascaded),n.cascaded=o;let a=Ln(r.getAttribute("opaque"));a===void 0&&(a=i.opaque),n.opaque=a!==void 0?a:!1;let l=Ln(r.getAttribute("noSubsets"));l===void 0&&(l=i.noSubsets),n.noSubsets=l!==void 0?l:!1;let c=bs(r.getAttribute("fixedWidth"));c||(c=i.fixedWidth),n.fixedWidth=c;let h=bs(r.getAttribute("fixedHeight"));h||(h=i.fixedHeight),n.fixedHeight=h;const u=["Style","AuthorityURL"];e?u.push("CRS"):u.push("SRS","Dimension"),u.forEach(function(g){if(g in i){const f=n[g]||[];n[g]=f.concat(i[g])}});const d=["BoundingBox","Attribution"];return e?d.push("Dimension","EX_GeographicBoundingBox","MinScaleDenominator","MaxScaleDenominator"):d.push("LatLonBoundingBox","ScaleHint","Extent"),d.forEach(function(g){if(!(g in n)){const f=i[g];n[g]=f}}),n}function Yot(r,t){const e={name:r.getAttribute("name"),units:r.getAttribute("units"),unitSymbol:r.getAttribute("unitSymbol")};return ep(t)&&Object.assign(e,{default:r.getAttribute("default"),multipleValues:Ln(r.getAttribute("multipleValues")),nearestValue:Ln(r.getAttribute("nearestValue")),current:Ln(r.getAttribute("current")),values:Ge(r)}),e}function Xot(r,t){return{name:r.getAttribute("name"),default:r.getAttribute("default"),nearestValue:Ln(r.getAttribute("nearestValue"))}}function Kot(r,t){return{min:bs(r.getAttribute("min")),max:bs(r.getAttribute("max"))}}function sa(r,t){return re({},Dot,r,t)}function Qot(r,t){return re({},Aot,r,t)}function Jot(r,t){return re({},Oot,r,t)}function tat(r,t){return re({},Fot,r,t)}function Id(r,t){return re({},Lot,r,t)}function R8(r,t){const e=sa(r,t);if(e){const i=[Vo(r.getAttribute("width")),Vo(r.getAttribute("height"))];return e.size=i,e}}function eat(r,t){const e=sa(r,t);if(e)return e.name=r.getAttribute("name"),e}function rat(r,t){const e=sa(r,t);if(e)return e.type=r.getAttribute("type"),e}function iat(r,t){return re({},Not,r,t)}function I8(r,t){return re([],$ot,r,t)}function Vm(r,t){if(Array.isArray(r))return r.map(e=>Vm(e,t)).find(e=>e!==null)||null;if(typeof r=="object"){if(r.Name===t)return r;if(r.Layer)return Vm(r.Layer,t)}return null}const nat=r=>(Array.isArray(r)?r:[r]).map(t=>(Array.isArray(t.LegendURL)?t.LegendURL:typeof t.LegendURL=="object"?[t.LegendURL]:[]).map(e=>e.OnlineResource)).flat(1);function sat(r,t){return Vm(r.Capability.Layer,t)?.Title||""}function oat(r,t){const e=Vm(r.Capability.Layer,t)?.Style;return e&&nat(e)[0]||""}function aat(r,t){const e=t[r];if(e)try{return new kot().read(e)}catch(i){console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:21:4)
`,`Error reading xml '${e}' for id '${r}'.`,i)}return null}function lat(r,t){return Promise.all(r.map(async e=>{const{id:i}=e,n=e.options?.layers;if(n&&(n.title===!0||n.legend===!0)){if(typeof t[i]=="string")return console.warn(`@polar/polar(plugins/layerChooser/utils/capabilities:41:6)
`,`Re-fired loadCapabilities on id '${i}' albeit the GetCapabilities have already been successfully fetched. No re-fetch will occur.`),[i,null];const s=Ml.getLayerWhere({id:e.id});if(!s||!s.url||!s.version||!s.typ)return console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:49:6)
`,`Missing data for service '${s}' with id '${i}'.`),[i,null];const o=`${s.url}?service=${s.typ}&version=${s.version}&request=GetCapabilities`;try{const a=await fetch(o);return[i,await a.text()]}catch(a){return console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:61:6)
`,`Capabilities from ${o} could not be fetched.`,a),[i,null]}}return[i,null]})).then(e=>e.reduce((i,[n,s])=>Lr(i,{[n]:s}),{}))}function cat(r,t,e){const i=Ml.getLayerWhere({id:r}),n=aat(r,t);return{[r]:(e.order?.split(",")||i.layers.split(",")).map(s=>({layerName:s,displayName:e.title===!0&&n?sat(n,s):e.title===!1?s:e.title?.[s]||s,layerImage:e.legend===!0&&n?oat(n,s):e.legend===!1?null:e.legend?.[s]||null}))}}const hat=r=>r.reduce(([t,e],i)=>Ml.getLayerWhere({id:i.id})===null?(console.error(`@polar/polar(plugins/layerChooser/utils/getBackgroundsAndMasks:15:5)
`,`Layer ${i.id} not found in service register. This is a configuration issue. The map might behave in unexpected ways.`,i),[t,e]):i.type==="background"?[[...t,i],e]:[t,[...e,i]],[[],[]]),uat=r=>r.map(({id:t,name:e})=>({id:t,name:e})).map(t=>Lr(t,{rawLayer:Ml.getLayerWhere({id:t.id})})).filter(({rawLayer:t})=>t!==null).reduce((t,e)=>{const i=_ot(e.rawLayer)[0];return typeof i=="string"?{...t,[e.id]:{name:e.name,url:i}}:t},{}),gd=Sl("plugins/layerChooser",()=>{const r=ar(),t=me({}),e=me([]),i=me([]),n=me([]),s=me([]),o=me(""),a=me([]),l=me({}),c=me(""),h=me({}),u=me(""),d=Ct(()=>e.value.reduce((w,{id:b})=>({...w,[b]:n.value.findIndex(({id:E})=>E===b)===-1}),{})),g=Ct(()=>f.value.reduce((w,{id:b})=>({...w,[b]:s.value.findIndex(({id:E})=>E===b)===-1}),{})),f=Ct(()=>i.value.filter(({hideInMenu:w})=>!w)),p=Ct(()=>f.value.reduce((w,b)=>Lr(w,{[b.type]:Array.isArray(w[b.type])?w[b.type].concat(b):[b]}),{}));function m(){const[w,b]=hat(r.configuration.layers);e.value=w,i.value=b,w.length===0&&console.error(`@polar/polar(plugins/layerChooser/store:100:4)
`,'No layers of type "background" have been configured.'),o.value=w.find(({visibility:E})=>E)?.id||"",a.value=b.filter(({visibility:E})=>E).map(({id:E})=>E),x(),r.map.on("moveend",x),l.value=uat(r.configuration.layers),lat(r.configuration.layers,t.value).then(E=>{t.value=E,r.configuration.layers.forEach(C=>{const S=C.options?.layers;S&&(h.value=Lr(h.value,cat(C.id,E,S)))})})}function y(){r.map.un("moveend",x)}Zr(o,w=>{r.map.getLayers().getArray().forEach(b=>{e.value.find(({id:E})=>E===b.get("id"))&&b.setVisible(b.get("id")===w)})}),Zr(a,w=>{_(w)});function _(w){r.map.getLayers().getArray().forEach(b=>{i.value.find(({id:E})=>E===b.get("id"))&&b.setVisible(w.includes(b.get("id")))})}function x(){const w=r.map.getView().getZoom();n.value=J3(e.value,w),s.value=J3(i.value,w);const b=n.value.map(({id:E})=>E);b.includes(o.value)||(o.value=b[0]||""),_(s.value.map(({id:E})=>E).filter(E=>a.value.includes(E)))}function v(w){const b=r.map.getLayers().getArray().find(E=>E.get("id")===u.value).getSource();if(!b){console.error(`@polar/polar(plugins/layerChooser/store:208:4)
`,`Action 'toggleOpenedOptionsServiceLayer' failed on ${u.value}. Layer not found in OpenLayers or source not initialized in OpenLayers.`);return}b.updateParams({...b.getParams(),LAYERS:w})}return{activeBackgroundId:o,activeMaskIds:a,backgrounds:e,capabilities:t,disabledBackgrounds:d,disabledMasks:g,layersWithLegends:l,layersWithOptions:h,masksSeparatedByType:p,shownMasks:f,openedLegendId:c,openedOptionsId:u,setupPlugin:m,teardownPlugin:y,toggleOpenedOptionsServiceLayer:v}}),cs="layerChooser",dat=["id"],gat={class:"kern-label"},P8=je({__name:"LayerInformationCard.ce",props:{identifier:{type:String},idName:{type:String}},setup(r){const t=r,e=ar(),i=gd();zc(()=>{e.shadowRoot?.getElementById(`polar-layer-chooser-${t.identifier}-back-button`)?.focus()});function n(){const s=i[t.idName];i[t.idName]="",ju(()=>{e.shadowRoot?.getElementById(`polar-layer-chooser-${t.identifier}-${s}-button`)?.focus()})}return(s,o)=>(ht(),Ee(LE,null,{default:Ps(()=>[Yt("button",{id:`polar-layer-chooser-${r.identifier}-back-button`,class:"kern-btn kern-btn--secondary",onClick:n},[o[0]||(o[0]=Yt("span",{class:"kern-icon kern-icon--arrow-back","aria-hidden":"true"},null,-1)),Yt("span",gat,nr(s.$t(a=>a.returnToLayers,{ns:nt(cs)})),1)],8,dat),gw(s.$slots,"default")]),_:3}))}}),fat={class:"kern-label",for:"polar-layer-chooser-legend-anchor"},pat=["href","aria-label"],mat=["src","alt"],yat=je({__name:"LayerLegend.ce",setup(r){const t=gd(),e=Ct(()=>t.layersWithLegends[t.openedLegendId]);return(i,n)=>(ht(),Ee(P8,{identifier:"legend","id-name":"openedLegendId",class:"legend-card"},{default:Ps(()=>[Yt("label",fat,nr(i.$t(s=>s.legend.to,{name:e.value.name,ns:nt(cs)})),1),Yt("a",{id:"polar-layer-chooser-legend-anchor",href:e.value.url,"aria-label":i.$t(s=>s.legend.to,{name:e.value.name,ns:nt(cs)}),target:"_blank"},[Yt("img",{src:e.value.url,alt:i.$t(s=>s.legend.to,{name:e.value.name,ns:nt(cs)})},null,8,mat)],8,pat)]),_:1}))}}),_at=".legend-card[data-v-e248e19b]{overflow-y:scroll}",vat=gr(yat,[["styles",[_at]],["__scopeId","data-v-e248e19b"]]),xat={class:"kern-form-check"},wat=["id","name","value","type","disabled"],bat=["for"],kat=je({__name:"PolarInput.ce",props:hO({idSuffix:{type:String},label:{type:String},type:{type:null},value:{type:String},disabled:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const t=uO(r,"modelValue");return(e,i)=>(ht(),Gt("div",xat,[RM(Yt("input",{id:`polar-${r.type}-${r.value}-${r.idSuffix}`,"onUpdate:modelValue":i[0]||(i[0]=n=>t.value=n),class:mr(`polar-input kern-form-check__${r.type}`),name:r.value,value:r.value,type:r.type,disabled:r.disabled},null,10,wat),[[dO,t.value]]),Yt("label",{class:"polar-input kern-label",for:`polar-${r.type}-${r.value}-${r.idSuffix}`},nr(r.label),9,bat)]))}}),Eat=".kern-form-check__radio[disabled],.kern-form-check__checkbox[disabled]{&[data-v-83635f17]:hover{border:var(--kern-metric-border-width-default) solid var(--kern-color-form-input-border)}}.kern-form-check__checkbox[disabled]{&[data-v-83635f17]:checked:hover:before{margin:var(--kern-metric-space-x-small)}}",rw=gr(kat,[["styles",[Eat]],["__scopeId","data-v-83635f17"]]),Sat={class:"kern-fieldset"},Tat={class:"kern-label"},Cat={class:"kern-fieldset__body"},Mat=je({__name:"PolarInputGroup.ce",props:{legend:{type:String}},setup(r){return(t,e)=>(ht(),Gt("fieldset",Sat,[Yt("legend",Tat,nr(r.legend),1),Yt("div",Cat,[gw(t.$slots,"default",{},void 0,!0)])]))}}),Rat=".kern-fieldset[data-v-69d29a6c]{width:100%}.kern-fieldset__body[data-v-69d29a6c]{width:100%;padding:var(--kern-metric-space-small) 0;gap:var(--kern-metric-space-small);border-radius:var(--kern-metric-border-radius-default);background-color:var(--kern-color-layout-background-hued)}.kern-label[data-v-69d29a6c]{padding-left:.75rem}[data-v-69d29a6c] .kern-form-check{align-items:center;gap:var(--kern-metric-space-large);margin-left:.75rem;padding-right:0}",iw=gr(Mat,[["styles",[Rat]],["__scopeId","data-v-69d29a6c"]]),Iat=["src","alt"],Pat=je({__name:"LayerOptions.ce",setup(r){const t=ar(),e=gd(),{openedOptionsId:i}=yr(e),n=Ct(()=>e.layersWithOptions[i.value]),s=me(n.value.map(({layerName:l})=>l).reverse()),o=Ct({get:()=>s.value,set:l=>{s.value=l,e.toggleOpenedOptionsServiceLayer(l)}}),a=Ct(()=>t.configuration.layers.find(({id:l})=>l===i.value)?.name||"");return(l,c)=>(ht(),Ee(P8,{identifier:"options","id-name":"openedOptionsId"},{default:Ps(()=>[po(iw,{legend:l.$t(h=>h.layerHeader,{ns:nt(cs),name:a.value})},{default:Ps(()=>[(ht(!0),Gt(ri,null,tn(n.value,({displayName:h,layerImage:u,layerName:d})=>(ht(),Gt("div",{key:`polar-layer-chooser-mask-options-checkbox-${d}`,class:"polar-layer-chooser-options-checkbox-wrapper"},[u?(ht(),Gt("img",{key:0,src:u,alt:d},null,8,Iat)):xr("",!0),po(rw,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=g=>o.value=g),"id-suffix":"polar-layer-chooser-mask-options",label:h,type:"checkbox",value:d,class:mr(n.value.some(({layerImage:g})=>g!==null)?"polar-layer-chooser-options-checkbox":"")},null,8,["modelValue","label","value","class"])]))),128))]),_:1},8,["legend"])]),_:1}))}}),Aat=".polar-layer-chooser-options-checkbox-wrapper[data-v-1ce80731]{display:flex;justify-content:flex-start;align-items:center;gap:var(--kern-metric-space-large)}.kern-form-check.polar-layer-chooser-options-checkbox[data-v-1ce80731]{margin-left:0}.kern-btn[data-v-1ce80731]{border:none;min-height:inherit;padding:var(--kern-metric-space-x-small)}.kern-label[data-v-1ce80731]{padding:0;padding-left:var(--kern-metric-space-small)}",Lat=gr(Pat,[["styles",[Aat]],["__scopeId","data-v-1ce80731"]]),Oat=["id","disabled"],Fat={class:"kern-label kern-sr-only"},tM=je({__name:"LegendButton.ce",props:{disabled:{type:Boolean},id:{type:String}},setup(r){return(t,e)=>(ht(),Gt("button",{id:`polar-layer-chooser-legend-${r.id}-button`,class:"kern-btn kern-btn--tertiary",disabled:r.disabled},[e[0]||(e[0]=Yt("span",{class:"kern-icon kern-icon--info","aria-hidden":"true"},null,-1)),Yt("span",Fat,nr(t.$t(i=>i.legend.open,{ns:nt(cs)})),1)],8,Oat))}}),Nat=["id","disabled","onClick"],Dat={class:"kern-label kern-sr-only"},$at=je({__name:"LayerSelection.ce",setup(r){const t=gd(),{activeBackgroundId:e,activeMaskIds:i,backgrounds:n,disabledBackgrounds:s,disabledMasks:o,layersWithOptions:a,masksSeparatedByType:l,openedLegendId:c,shownMasks:h}=yr(t),u=Ct(()=>Object.keys(t.layersWithLegends));function d(g){t.openedOptionsId=g}return(g,f)=>(ht(),Ee(LE,{id:"polar-layer-chooser-card"},{default:Ps(()=>[nt(n).length?(ht(),Ee(iw,{key:0,legend:g.$t(p=>p.backgroundTitle,{ns:nt(cs)})},{default:Ps(()=>[(ht(!0),Gt(ri,null,tn(nt(n),({name:p,id:m})=>(ht(),Gt("div",{key:`polar-layer-chooser-background-radio-${m}`,class:"polar-layer-chooser-input-wrapper"},[po(rw,{modelValue:nt(e),"onUpdate:modelValue":f[0]||(f[0]=y=>qv(e)?e.value=y:null),"id-suffix":"polar-layer-chooser-background",label:p,type:"radio",value:m,disabled:nt(s)[m]},null,8,["modelValue","label","value","disabled"]),u.value.includes(m)?(ht(),Ee(tM,{key:0,id:m,disabled:nt(s)[m],onClick:y=>c.value=m},null,8,["id","disabled","onClick"])):xr("",!0)]))),128))]),_:1},8,["legend"])):xr("",!0),nt(h).length?(ht(!0),Gt(ri,{key:1},tn(Object.entries(nt(l)),([p,m])=>(ht(),Ee(iw,{key:`polar-layer-chooser-mask-${p}`,legend:g.$t(y=>y[`${p}Title`],{ns:nt(cs)})},{default:Ps(()=>[(ht(!0),Gt(ri,null,tn(m,({name:y,id:_})=>(ht(),Gt("div",{key:`polar-layer-chooser-mask-${p}-checkbox-${_}`,class:"polar-layer-chooser-input-wrapper"},[po(rw,{modelValue:nt(i),"onUpdate:modelValue":f[1]||(f[1]=x=>qv(i)?i.value=x:null),"id-suffix":`polar-layer-chooser-mask-${p}`,label:y,type:"checkbox",value:_,disabled:nt(o)[_]},null,8,["modelValue","id-suffix","label","value","disabled"]),Object.keys(nt(a)).includes(_)?(ht(),Gt("button",{key:0,id:`polar-layer-chooser-options-${_}-button`,class:"kern-btn kern-btn--tertiary",disabled:nt(o)[_],onClick:()=>d(_)},[f[2]||(f[2]=Yt("span",{class:"kern-icon kern-icon-fill--settings","aria-hidden":"true"},null,-1)),Yt("span",Dat,nr(g.$t(x=>x.layerOptions,{ns:nt(cs)})),1)],8,Nat)):u.value.includes(_)?(ht(),Ee(tM,{key:1,id:_,disabled:nt(o)[_],onClick:x=>c.value=_},null,8,["id","disabled","onClick"])):xr("",!0)]))),128))]),_:2},1032,["legend"]))),128)):xr("",!0)]),_:1}))}}),Gat="#polar-layer-chooser-card[data-v-c4509e12]{overflow-y:inherit}.polar-layer-chooser-input-wrapper[data-v-c4509e12]{display:flex;justify-content:space-between;align-items:center;gap:var(--kern-metric-space-large)}.kern-btn[data-v-c4509e12]{width:var(--kern-metric-dimension-large);min-height:var(--kern-metric-dimension-large);border:none;border-radius:50%}",jat=gr($at,[["styles",[Gat]],["__scopeId","data-v-c4509e12"]]),zat=je({__name:"LayerChooser.ce",setup(r){const t=gd(),e=Ct(()=>t.openedLegendId.length!==0),i=Ct(()=>t.openedOptionsId.length===0&&!e.value);return(n,s)=>i.value?(ht(),Ee(jat,{key:0})):e.value?(ht(),Ee(vat,{key:1})):(ht(),Ee(Lat,{key:2}))}}),qat={backgroundTitle:"Hintergrundkarten",maskTitle:"Fachdaten",layerHeader:'Auswahl sichtbarer Ebenen fÃ¼r Layer "{{name}}"',layerOptions:"Optionen fÃ¼r Kartenmaterial",legend:{title:"Legende",to:'Legendenbild zu "{{name}}"',open:`$t(legend.to, {ns: ${cs}}) Ã¶ffnen`},returnToLayers:"ZurÃ¼ck"},Bat={backgroundTitle:"Background maps",maskTitle:"Subject data",layerHeader:'Visible layer selection for layer "{{name}}"',layerOptions:"Map data options",legend:{title:"Legend",to:'"{{name}}" legend image',open:`Open $t(legend.to, {ns: ${cs}})`},returnToLayers:"Back"},Uat=[{type:"de",resources:qat},{type:"en",resources:Bat}];function Odt(r){return{id:cs,component:zat,icon:"kern-icon-fill--layers",locales:Uat,storeModule:gd,options:r}}class rp extends ya{constructor(t,e,i){super(),i!==void 0&&e===void 0?this.setFlatCoordinates(i,t):(e=e||0,this.setCenterAndRadius(t,e,i))}clone(){const t=new rp(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const s=this.flatCoordinates,o=t-s[0],a=e-s[1],l=o*o+a*a;if(l<n){if(l===0)for(let c=0;c<this.stride;++c)i[c]=s[c];else{const c=this.getRadius()/Math.sqrt(l);i[0]=s[0]+c*o,i[1]=s[1]+c*a;for(let h=2;h<this.stride;++h)i[h]=s[h]}return i.length=this.stride,l}return n}containsXY(t,e){const i=this.flatCoordinates,n=t-i[0],s=e-i[1];return n*n+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,i=e[this.stride]-e[0];return hs(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){const e=this.getExtent();if(wr(t,e)){const i=this.getCenter();return t[0]<=i[0]&&t[2]>=i[0]||t[1]<=i[1]&&t[3]>=i[1]?!0:_w(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){const e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(let s=1;s<e;++s)n[e+s]=t[s];this.setFlatCoordinates(this.layout,n),this.changed()}setCenterAndRadius(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const n=this.flatCoordinates;let s=LI(n,0,t,this.stride);n[s++]=n[0]+e;for(let o=1,a=this.stride;o<a;++o)n[s++]=n[o];n.length=s,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const i=this.getCenter(),n=this.getStride();this.setCenter(Ub(i,0,i.length,n,t,e,i)),this.changed()}}rp.prototype.transform;function al(r,t){const e=r.length;return t<0?r[t+e]:t>=e?r[t-e]:r[t]}function Jh(r,t){const e=r.length;let i=Math.floor(t);const n=t-i;i>=e?i-=e:i<0&&(i+=e);let s=i+1;s>=e&&(s-=e);const o=r[i],a=o[0],l=o[1],c=r[s],h=c[0]-a,u=c[1]-l;return[a+h*n,l+u*n]}const Jp={index:-1,endIndex:NaN,closestTargetDistance:1/0};function A8(r,t,e,i){const n=r[0],s=r[1];let o=1/0,a=-1,l=NaN;for(let u=0;u<t.targets.length;++u){const d=t.targets[u],g=d.coordinates;let f=1/0,p;for(let m=0;m<g.length-1;++m){const y=g[m],_=g[m+1],x=F8(n,s,y,_);x.squaredDistance<f&&(f=x.squaredDistance,p=m+x.along)}f<o&&(o=f,d.ring&&t.targetIndex===u&&(d.endIndex>d.startIndex?p<d.startIndex&&(p+=g.length):d.endIndex<d.startIndex&&p>d.startIndex&&(p-=g.length)),l=p,a=u)}const c=t.targets[a];let h=c.ring;if(t.targetIndex===a&&h){const u=Jh(c.coordinates,l),d=e.getPixelFromCoordinate(u),g=e.getPixelFromCoordinate(t.startCoord);jh(d,g)>i&&(h=!1)}if(h){const u=c.coordinates,d=u.length,g=c.startIndex,f=l;if(g<f){const p=r0(u,g,f);r0(u,g,f-d)<p&&(l-=d)}else{const p=r0(u,g,f);r0(u,g,f+d)<p&&(l+=d)}}return Jp.index=a,Jp.endIndex=l,Jp.closestTargetDistance=o,Jp}function L8(r,t){const e=[];for(let i=0;i<t.length;++i){const n=t[i].getGeometry();O8(r,n,e)}return e}function O8(r,t,e){if(t instanceof kn){t0(r,t.getCoordinates(),!1,e);return}if(t instanceof Qc){const i=t.getCoordinates();for(let n=0,s=i.length;n<s;++n)t0(r,i[n],!1,e);return}if(t instanceof gs){const i=t.getCoordinates();for(let n=0,s=i.length;n<s;++n)t0(r,i[n],!0,e);return}if(t instanceof Jc){const i=t.getCoordinates();for(let n=0,s=i.length;n<s;++n){const o=i[n];for(let a=0,l=o.length;a<l;++a)t0(r,o[a],!0,e)}return}if(t instanceof IP){const i=t.getGeometries();for(let n=0;n<i.length;++n)O8(r,i[n],e);return}}function t0(r,t,e,i){const n=r[0],s=r[1];for(let o=0,a=t.length-1;o<a;++o){const l=t[o],c=t[o+1],h=F8(n,s,l,c);if(h.squaredDistance===0){const u=o+h.along;i.push({coordinates:t,ring:e,startIndex:u,endIndex:u});return}}}function e0(r,t){return Zo(r[0],r[1],t[0],t[1])}function r0(r,t,e){let i,n;t<e?(i=t,n=e):(i=e,n=t);const s=Math.ceil(i),o=Math.floor(n);if(s>o){const l=Jh(r,i),c=Jh(r,n);return e0(l,c)}let a=0;if(i<s){const l=Jh(r,i),c=al(r,s);a+=e0(l,c)}if(o<n){const l=al(r,o),c=Jh(r,n);a+=e0(l,c)}for(let l=s;l<o-1;++l){const c=al(r,l),h=al(r,l+1);a+=e0(c,h)}return a}const Tv={along:0,squaredDistance:0};function F8(r,t,e,i){const n=e[0],s=e[1],o=i[0],a=i[1],l=o-n,c=a-s;let h=0,u=n,d=s;return(l!==0||c!==0)&&(h=kr(((r-n)*l+(t-s)*c)/(l*l+c*c),0,1),u+=l*h,d+=c*h),Tv.along=h,Tv.squaredDistance=Wu(Zo(r,t,u,d),10),Tv}const i0={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};let n0=class extends on{constructor(t,e){super(t),this.feature=e}};class Wat extends Rl{constructor(t){const e=t;e.stopDown||(e.stopDown=qu),super(e),this.on,this.once,this.un,this.options_=t,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=Zat(this.type_),this.stopClick_=!!t.stopClick,this.ignoreNextUpEvent_=!1,this.minPoints_=t.minPoints?t.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:mo,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let i=t.geometryFunction;if(!i){const n=this.mode_;if(n==="Circle")i=(s,o,a)=>{const l=o||new rp([NaN,NaN]),c=fr(s[0]),h=wu(c,fr(s[s.length-1]));return l.setCenterAndRadius(c,Math.sqrt(h),this.geometryLayout_),l};else{let s;n==="Point"?s=Pi:n==="LineString"?s=kn:n==="Polygon"&&(s=gs),i=(o,a,l)=>(a?n==="Polygon"?o[0].length?a.setCoordinates([o[0].concat([o[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(o,this.geometryLayout_):a=new s(o,this.geometryLayout_),a)}}this.geometryFunction_=i,this.dragVertexDelay_=t.dragVertexDelay!==void 0?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new fs({source:new ls({useSpatialIndex:!1,wrapX:t.wrapX?t.wrapX:!1}),style:t.style?t.style:Vat(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:mk,this.freehandCondition_,t.freehand?this.freehandCondition_=gc:this.freehandCondition_=t.freehandCondition?t.freehandCondition:bm,this.traceCondition_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener(xm.ACTIVE,this.updateState_)}setTrace(t){let e;t?t===!0?e=gc:e=t:e=wm,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}setFreehand(t){this.freehand_=t,this.freehand_?this.freehandCondition_=gc:this.freehandCondition_=this.options_&&this.options_.freehandCondition?this.options_.freehandCondition:bm}getOverlay(){return this.overlay_}getFreehand(){return this.freehand_}handleEvent(t){t.originalEvent.type===Vt.CONTEXTMENU&&t.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(t);let e=t.type===Le.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===Le.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===Le.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===Le.POINTERDOWN?i=!1:e&&this.getPointerCount()<2?(i=t.type===Le.POINTERMOVE,i&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):(t.originalEvent.pointerType==="mouse"||t.type===Le.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(t)):t.type===Le.DBLCLICK&&(i=!1),super.handleEvent(t)&&i}handleDownEvent(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new No(Le.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))},this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active){this.deactivateTrace_();return}const e=this.getMap(),i=e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),n=e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_]),s=Ei([i,n]),o=this.traceSource_.getFeaturesInExtent(s);if(o.length===0)return;const a=L8(t.coordinate,o);a.length&&(this.traceState_={active:!0,startCoord:t.coordinate.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const i=t.startIndex<=t.endIndex,n=t.startIndex<=e;i===n?i&&e>t.endIndex||!i&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(i&&e<t.endIndex||!i&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let i=0;if(t<e){const n=Math.ceil(t);let s=Math.floor(e);s===e&&(s-=1),i=s-n+1}else{const n=Math.floor(t);let s=Math.ceil(e);s===e&&(s+=1),i=n-s+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(t,e,i){if(e===i)return;const n=[];if(e<i){const s=Math.ceil(e);let o=Math.floor(i);o===i&&(o-=1);for(let a=s;a<=o;++a)n.push(al(t.coordinates,a))}else{const s=Math.floor(e);let o=Math.ceil(i);o===i&&(o+=1);for(let a=s;a>=o;--a)n.push(al(t.coordinates,a))}n.length&&this.appendCoordinates(n)}updateTrace_(t){const e=this.traceState_;if(!e.active)return;if(e.targetIndex===-1){const a=t.map.getPixelFromCoordinate(e.startCoord);if(jh(a,t.pixel)<this.snapTolerance_)return}const i=A8(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==i.index){if(e.targetIndex!==-1){const l=e.targets[e.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=e.targets[i.index];this.addTracedCoordinates_(a,a.startIndex,i.endIndex)}else{const a=e.targets[e.targetIndex];this.addOrRemoveTracedCoordinates_(a,i.endIndex)}e.targetIndex=i.index;const n=e.targets[e.targetIndex];n.endIndex=i.endIndex;const s=Jh(n.coordinates,n.endIndex),o=this.getMap().getPixelFromCoordinate(s);t.coordinate=s,t.pixel=[Math.round(o[0]),Math.round(o[1])]}handleDragEvent(t){this.ignoreNextUpEvent_=!0,super.handleDragEvent(t)}handleUpEvent(t){let e=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const i=this.traceState_.active;if(this.ignoreNextUpEvent_||this.toggleTraceState_(t),this.shouldHandle_){const n=!this.finishCoordinate_;n&&this.startDrawing_(t.coordinate),!n&&this.freehand_?this.finishDrawing():!this.freehand_&&(!n||this.mode_==="Point")&&(this.atFinish_(t.pixel,i)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return this.ignoreNextUpEvent_=!1,!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,i=t.pixel,n=e[0]-i[0],s=e[1]-i[1],o=n*n+s*s;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(t.coordinate.slice());return}this.updateTrace_(t),this.modifyDrawing_(t.coordinate)}atFinish_(t,e){let i=!1;if(this.sketchFeature_){let n=!1,s=[this.finishCoordinate_];const o=this.mode_;if(o==="Point")i=!0;else if(o==="Circle")i=this.sketchCoords_.length===2;else if(o==="LineString")n=!e&&this.sketchCoords_.length>this.minPoints_;else if(o==="Polygon"){const a=this.sketchCoords_;n=a[0].length>this.minPoints_,s=[a[0][0],a[0][a[0].length-2]],e?s=[a[0][0]]:s=[a[0][0],a[0][a[0].length-2]]}if(n){const a=this.getMap();for(let l=0,c=s.length;l<c;l++){const h=s[l],u=a.getPixelFromCoordinate(h),d=t[0]-u[0],g=t[1]-u[1],f=this.freehand_?1:this.snapTolerance_;if(i=Math.sqrt(d*d+g*g)<=f,i){this.finishCoordinate_=h;break}}}}return i}createOrUpdateSketchPoint_(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new zi(new Pi(t)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new zi);const e=t.getLinearRing(0);let i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),i.changed()):(i=new kn(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(t){const e=this.getMap().getView().getProjection(),i=hm(this.geometryLayout_);for(;t.length<i;)t.push(0);this.finishCoordinate_=t,this.mode_==="Point"?this.sketchCoords_=t.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new zi(new kn(this.sketchLineCoords_)));const n=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new zi,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new n0(i0.DRAWSTART,this.sketchFeature_))}modifyDrawing_(t){const e=this.getMap(),i=this.sketchFeature_.getGeometry(),n=e.getView().getProjection(),s=hm(this.geometryLayout_);let o,a;for(;t.length<s;)t.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(o=this.sketchCoords_[0],a=o[o.length-1],this.atFinish_(e.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(o=this.sketchCoords_,a=o[o.length-1]),a[0]=t[0],a[1]=t[1],this.geometryFunction_(this.sketchCoords_,i,n),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),i.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(t){const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();let n,s;const o=this.mode_;return o==="LineString"||o==="Circle"?(this.finishCoordinate_=t.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():n=!0),s.push(t.slice()),this.geometryFunction_(s,e,i)):o==="Polygon"&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():n=!0),s.push(t.slice()),n&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,e,i)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),n?this.finishDrawing():this.sketchFeature_}removeLastPoints_(t){if(!this.sketchFeature_)return;const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),n=this.mode_;for(let s=0;s<t;++s){let o;if(n==="LineString"||n==="Circle"){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,e,i),e.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if(n==="Polygon"){o=this.sketchCoords_[0],o.splice(-2,1);const a=this.sketchLine_.getGeometry();if(o.length>=2){const l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,e,i)}if(o.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const t=this.abortDrawing_();if(!t)return null;let e=this.sketchCoords_;const i=t.getGeometry(),n=this.getMap().getView().getProjection();return this.mode_==="LineString"?(e.pop(),this.geometryFunction_(e,i,n)):this.mode_==="Polygon"&&(e[0].pop(),this.geometryFunction_(e,i,n),e=i.getCoordinates()),this.type_==="MultiPoint"?t.setGeometry(new td([e])):this.type_==="MultiLineString"?t.setGeometry(new Qc([e])):this.type_==="MultiPolygon"&&t.setGeometry(new Jc([e])),this.dispatchEvent(new n0(i0.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t),t}abortDrawing_(){this.finishCoordinate_=null;const t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){const t=this.abortDrawing_();t&&this.dispatchEvent(new n0(i0.DRAWABORT,t))}appendCoordinates(t){const e=this.mode_,i=!this.sketchFeature_;i&&this.startDrawing_(t[0]);let n;if(e==="LineString"||e==="Circle")n=this.sketchCoords_;else if(e==="Polygon")n=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;i&&n.shift(),n.pop();for(let o=0;o<t.length;o++)this.addToDrawing_(t[o]);const s=t[t.length-1];this.sketchFeature_=this.addToDrawing_(s),this.modifyDrawing_(s)}extend(t){const e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new zi(new Pi(i)),this.updateSketchFeatures_(),this.dispatchEvent(new n0(i0.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){const t=this.getMap(),e=this.getActive();(!t||!e)&&this.abortDrawing(),this.overlay_.setMap(e?t:null)}}function Vat(){const r=sk();return function(t,e){return r[t.getGeometry().getType()]}}function Zat(r){switch(r){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+r)}}const eM=0,fg=1,rM=[0,0,0,0],fu=[],Cv={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};function Mv(r,t,e){let i;switch(t){case"LineString":i=r;break;case"MultiLineString":case"Polygon":i=r[e[0]];break;case"MultiPolygon":i=r[e[1]][e[0]];break}return i}class Rv extends on{constructor(t,e,i){super(t),this.features=e,this.mapBrowserEvent=i}}class Hat extends Rl{constructor(t){super(t),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=t.condition?t.condition:RP,this.defaultDeleteCondition_=function(i){return pV(i)&&CP(i)},this.deleteCondition_=t.deleteCondition?t.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:gc,this.vertexFeature_=null,this.vertexSegments_=null,this.lastCoordinate_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new i2,this.pixelTolerance_=t.pixelTolerance!==void 0?t.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new fs({source:new ls({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:Xat(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.traceSource_=t.traceSource||t.source||null,this.traceCondition_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSegments_=null,this.hitDetection_=null;let e;if(t.features?e=t.features:t.source&&(this.source_=t.source,e=new xi(this.source_.getFeatures()),this.source_.addEventListener(cn.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(cn.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!e)throw new Error("The modify interaction requires features, a source or a layer");t.hitDetection&&(this.hitDetection_=t.hitDetection),this.features_=e,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(Jr.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(Jr.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=t.snapToPointer===void 0?!this.hitDetection_:t.snapToPointer}setTrace(t){let e;t?t===!0?e=gc:e=t:e=wm,this.traceCondition_=e}addFeature_(t){const e=t.getGeometry();if(e){const n=this.SEGMENT_WRITERS_[e.getType()];n&&n(t,e)}const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastCoordinate_),t.addEventListener(Vt.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(t,e){if(!this.featuresBeingModified_){this.featuresBeingModified_=new xi;const i=this.featuresBeingModified_.getArray();for(let n=0,s=e.length;n<s;++n){const o=e[n].feature;o&&!i.includes(o)&&this.featuresBeingModified_.push(o)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new Rv(Cv.MODIFYSTART,this.featuresBeingModified_,t))}}removeFeature_(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(Vt.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(t){const e=this.rBush_,i=[];e.forEach(function(n){t===n.feature&&i.push(n)});for(let n=i.length-1;n>=0;--n){const s=i[n];for(let o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===s&&this.dragSegments_.splice(o,1);e.remove(s)}}setActive(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(t)}setMap(t){this.overlay_.setMap(t),super.setMap(t)}getOverlay(){return this.overlay_}handleSourceAdd_(t){t.feature&&this.features_.push(t.feature)}handleSourceRemove_(t){t.feature&&this.features_.remove(t.feature)}handleFeatureAdd_(t){this.addFeature_(t.element)}handleFeatureChange_(t){if(!this.changingFeature_){const e=t.target;this.removeFeature_(e),this.addFeature_(e)}}handleFeatureRemove_(t){this.removeFeature_(t.element)}writePointGeometry_(t,e){const i=e.getCoordinates(),n={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),n)}writeMultiPointGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length;n<s;++n){const o=i[n],a={feature:t,geometry:e,depth:[n],index:n,segment:[o,o]};this.rBush_.insert(e.getExtent(),a)}}writeLineStringGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length-1;n<s;++n){const o=i.slice(n,n+2),a={feature:t,geometry:e,index:n,segment:o};this.rBush_.insert(Ei(o),a)}}writeMultiLineStringGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length;n<s;++n){const o=i[n];for(let a=0,l=o.length-1;a<l;++a){const c=o.slice(a,a+2),h={feature:t,geometry:e,depth:[n],index:a,segment:c};this.rBush_.insert(Ei(c),h)}}}writePolygonGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length;n<s;++n){const o=i[n];for(let a=0,l=o.length-1;a<l;++a){const c=o.slice(a,a+2),h={feature:t,geometry:e,depth:[n],index:a,segment:c};this.rBush_.insert(Ei(c),h)}}}writeMultiPolygonGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length;n<s;++n){const o=i[n];for(let a=0,l=o.length;a<l;++a){const c=o[a];for(let h=0,u=c.length-1;h<u;++h){const d=c.slice(h,h+2),g={feature:t,geometry:e,depth:[a,n],index:h,segment:d};this.rBush_.insert(Ei(d),g)}}}}writeCircleGeometry_(t,e){const i=e.getCenter(),n={feature:t,geometry:e,index:eM,segment:[i,i]},s={feature:t,geometry:e,index:fg,segment:[i,i]},o=[n,s];n.featureSegments=o,s.featureSegments=o,this.rBush_.insert(tu(i),n);let a=e;this.rBush_.insert(a.getExtent(),s)}writeGeometryCollectionGeometry_(t,e){const i=e.getGeometriesArray();for(let n=0;n<i.length;++n){const s=i[n],o=this.SEGMENT_WRITERS_[s.getType()];o(t,s)}}createOrUpdateVertexFeature_(t,e,i,n){let s=this.vertexFeature_;return s?s.getGeometry().setCoordinates(t):(s=new zi(new Pi(t)),this.vertexFeature_=s,this.overlay_.getSource().addFeature(s)),s.set("features",e),s.set("geometries",i),s.set("existing",n),s}handleEvent(t){if(!t.originalEvent)return!0;this.lastPointerEvent_=t;let e;return!t.map.getView().getInteracting()&&t.type==Le.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(t.type!=Le.SINGLECLICK||!this.ignoreNextSingleClick_?e=this.removePoint():e=!0),t.type==Le.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(t)&&!e}findInsertVerticesAndUpdateDragSegments_(t){if(this.handlePointerAtPixel_(t),this.dragSegments_.length=0,this.featuresBeingModified_=null,!this.vertexFeature_)return;this.getMap().getView().getProjection();const e=[],i=this.vertexFeature_.getGeometry().getCoordinates(),n=Ei([i]),s=this.rBush_.getInExtent(n),o={};s.sort(Yat);for(let a=0,l=s.length;a<l;++a){const c=s[a],h=c.segment;let u=$t(c.geometry);const d=c.depth;if(d&&(u+="-"+d.join("-")),o[u]||(o[u]=new Array(2)),c.geometry.getType()==="Circle"&&c.index===fg){const g=nM(t,c);Xi(g,i)&&!o[u][0]&&(this.dragSegments_.push([c,0]),o[u][0]=c);continue}if(Xi(h[0],i)&&!o[u][0]){this.dragSegments_.push([c,0]),o[u][0]=c;continue}if(Xi(h[1],i)&&!o[u][1]){if(o[u][0]&&o[u][0].index===0){let g=c.geometry.getCoordinates();switch(c.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":g=g[d[1]];case"Polygon":if(c.index!==g[d[0]].length-2)continue;break}}this.dragSegments_.push([c,1]),o[u][1]=c;continue}$t(h)in this.vertexSegments_&&!o[u][0]&&!o[u][1]&&e.push(c)}return e}deactivateTrace_(){this.traceState_={active:!1}}updateTrace_(t){const e=this.traceState_;if(!e.active)return;if(e.targetIndex===-1){const s=t.map.getPixelFromCoordinate(e.startCoord);if(jh(s,t.pixel)<this.pixelTolerance_)return}const i=A8(t.coordinate,e,t.map,this.pixelTolerance_);if(e.targetIndex===-1&&Math.sqrt(i.closestTargetDistance)/t.map.getView().getResolution()>this.pixelTolerance_)return;if(e.targetIndex!==i.index){if(e.targetIndex!==-1){const o=e.targets[e.targetIndex];this.removeTracedCoordinates_(o.startIndex,o.endIndex)}else for(const o of this.traceSegments_){const a=o[0],l=a.geometry,c=o[1],h=l.getCoordinates();Mv(h,l.getType(),a.depth).splice(a.index+c,1),l.setCoordinates(h),c===0&&(a.index-=1)}const s=e.targets[i.index];this.addTracedCoordinates_(s,s.startIndex,i.endIndex)}else{const s=e.targets[e.targetIndex];this.addOrRemoveTracedCoordinates_(s,i.endIndex)}e.targetIndex=i.index;const n=e.targets[e.targetIndex];n.endIndex=i.endIndex}getTraceCandidates_(t){const e=this.getMap(),i=this.pixelTolerance_,n=e.getCoordinateFromPixel([t.pixel[0]-i,t.pixel[1]+i]),s=e.getCoordinateFromPixel([t.pixel[0]+i,t.pixel[1]-i]),o=Ei([n,s]);return this.traceSource_.getFeaturesInExtent(o)}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active){this.deactivateTrace_(),this.traceSegments_=null;return}const e=this.getTraceCandidates_(t);if(e.length===0)return;const i=L8(t.coordinate,e);i.length&&(this.traceState_={active:!0,startCoord:t.coordinate.slice(),targets:i,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const i=t.startIndex<=t.endIndex,n=t.startIndex<=e;i===n?i&&e>t.endIndex||!i&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(i&&e<t.endIndex||!i&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let i=0;if(t<e){const n=Math.ceil(t);let s=Math.floor(e);s===e&&(s-=1),i=s-n+1}else{const n=Math.floor(t);let s=Math.ceil(e);s===e&&(s+=1),i=n-s+1}if(i>0)for(const n of this.traceSegments_){const s=n[0],o=s.geometry,a=n[1];let l=n[0].index+1;a===1&&(l-=i);const c=o.getCoordinates();Mv(c,o.getType(),s.depth).splice(l,i),o.setCoordinates(c),a===1&&(s.index-=i)}}addTracedCoordinates_(t,e,i){if(e===i)return;const n=[];if(e<i){const s=Math.ceil(e);let o=Math.floor(i);o===i&&(o-=1);for(let a=s;a<=o;++a)n.push(al(t.coordinates,a))}else{const s=Math.floor(e);let o=Math.ceil(i);o===i&&(o+=1);for(let a=s;a>=o;--a)n.push(al(t.coordinates,a))}if(n.length)for(const s of this.traceSegments_){const o=s[0],a=o.geometry,l=s[1],c=o.index+1;l===0&&n.reverse();const h=a.getCoordinates();Mv(h,a.getType(),o.depth).splice(c,0,...n),a.setCoordinates(h),l===1&&(o.index+=n.length)}}updateGeometry_(t,e){const i=e[0],n=i.depth;let s;const o=i.segment,a=i.geometry,l=e[1];for(;t.length<a.getStride();)t.push(o[l][t.length]);switch(a.getType()){case"Point":s=t,o[0]=t,o[1]=t;break;case"MultiPoint":s=a.getCoordinates(),s[i.index]=t,o[0]=t,o[1]=t;break;case"LineString":s=a.getCoordinates(),s[i.index+l]=t,o[l]=t;break;case"MultiLineString":s=a.getCoordinates(),s[n[0]][i.index+l]=t,o[l]=t;break;case"Polygon":s=a.getCoordinates(),s[n[0]][i.index+l]=t,o[l]=t;break;case"MultiPolygon":s=a.getCoordinates(),s[n[1]][n[0]][i.index+l]=t,o[l]=t;break;case"Circle":const c=a;if(o[0]=t,o[1]=t,i.index===eM)this.changingFeature_=!0,c.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0,this.getMap().getView().getProjection();let h=jh(fr(c.getCenter()),fr(t));c.setRadius(h),this.changingFeature_=!1}break}s&&this.setGeometryCoordinates_(a,s)}handleDragEvent(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t,this.dragSegments_.map(([o])=>o));const e=[t.coordinate[0]+this.delta_[0],t.coordinate[1]+this.delta_[1]],i=[],n=[],s=this.traceState_.active&&!this.traceSegments_?this.traceState_.startCoord:null;if(s){this.traceSegments_=[];for(const o of this.dragSegments_){const a=o[0];jh(vw(s,a.segment),s)/t.map.getView().getResolution()<1&&this.traceSegments_.push(o)}}for(let o=0,a=this.dragSegments_.length;o<a;++o){const l=this.dragSegments_[o],c=l[0],h=c.feature;i.includes(h)||i.push(h);const u=c.geometry;n.includes(u)||n.push(u),this.updateGeometry_(e,l)}this.updateTrace_(t),this.createOrUpdateVertexFeature_(e,i,n,!0)}handleDownEvent(t){if(!this.condition_(t))return!1;const e=t.coordinate,i=this.findInsertVerticesAndUpdateDragSegments_(e);if(i?.length&&this.insertVertexCondition_(t)&&(this.willModifyFeatures_(t,i),this.vertexFeature_)){const n=this.vertexFeature_.getGeometry().getCoordinates();for(let s=i.length-1;s>=0;--s)this.insertVertex_(i[s],n);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(t){for(let e=this.dragSegments_.length-1;e>=0;--e){const i=this.dragSegments_[e][0],n=i.geometry;if(n.getType()==="Circle"){const s=n,o=s.getCenter(),a=i.featureSegments[0],l=i.featureSegments[1];a.segment[0]=o,a.segment[1]=o,l.segment[0]=o,l.segment[1]=o,this.rBush_.update(tu(o),a);let c=s;this.rBush_.update(c.getExtent(),l)}else this.rBush_.update(Ei(i.segment),i)}return this.featuresBeingModified_&&(this.toggleTraceState_(t),this.dispatchEvent(new Rv(Cv.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null),!1}handlePointerMove_(t){this.lastCoordinate_=t.coordinate,this.handlePointerAtPixel_(this.lastCoordinate_)}handlePointerAtPixel_(t){const e=this.getMap(),i=e.getPixelFromCoordinate(t);e.getView().getProjection();const n=function(a,l){return iM(t,a)-iM(t,l)};let s,o;if(this.hitDetection_){const a=typeof this.hitDetection_=="object"?l=>l===this.hitDetection_:void 0;e.forEachFeatureAtPixel(i,(l,c,h)=>{h&&h.getType()==="Point"&&(h=new Pi(Tc(h.getCoordinates())));const u=h||l.getGeometry();if(u&&u.getType()==="Point"&&l instanceof zi&&this.features_.getArray().includes(l)){o=u;const d=l.getGeometry().getFlatCoordinates().slice(0,2);s=[{feature:l,geometry:o,segment:[d,d]}]}return!0},{layerFilter:a})}if(!s){const a=Cs(tu(t,rM)),l=e.getView().getResolution()*this.pixelTolerance_,c=l1(rs(a,l,rM));s=this.rBush_.getInExtent(c)}if(s&&s.length>0){const a=s.sort(n)[0],l=a.segment;let c=nM(t,a);const h=e.getPixelFromCoordinate(c);let u=jh(i,h);if(o||u<=this.pixelTolerance_){const d={};if(d[$t(l)]=!0,this.snapToPointer_||(this.delta_[0]=c[0]-t[0],this.delta_[1]=c[1]-t[1]),a.geometry.getType()==="Circle"&&a.index===fg)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(c,[a.feature],[a.geometry],this.snappedToVertex_);else{const g=e.getPixelFromCoordinate(l[0]),f=e.getPixelFromCoordinate(l[1]),p=wu(h,g),m=wu(h,f);if(u=Math.sqrt(Math.min(p,m)),this.snappedToVertex_=u<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(c=p>m?l[1]:l[0]),this.createOrUpdateVertexFeature_(c,[a.feature],[a.geometry],this.snappedToVertex_);const y={};y[$t(a.geometry)]=!0;for(let _=1,x=s.length;_<x;++_){const v=s[_].segment;if(Xi(l[0],v[0])&&Xi(l[1],v[1])||Xi(l[0],v[1])&&Xi(l[1],v[0])){const w=$t(s[_].geometry);w in y||(y[w]=!0,d[$t(v)]=!0)}else break}}this.vertexSegments_=d;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(t,e){const i=t.segment,n=t.feature,s=t.geometry,o=t.depth,a=t.index;let l;for(;e.length<s.getStride();)e.push(0);switch(s.getType()){case"MultiLineString":l=s.getCoordinates(),l[o[0]].splice(a+1,0,e);break;case"Polygon":l=s.getCoordinates(),l[o[0]].splice(a+1,0,e);break;case"MultiPolygon":l=s.getCoordinates(),l[o[1]][o[0]].splice(a+1,0,e);break;case"LineString":l=s.getCoordinates(),l.splice(a+1,0,e);break;default:return!1}this.setGeometryCoordinates_(s,l);const c=this.rBush_;c.remove(t),this.updateSegmentIndices_(s,a,o,1);const h={segment:[i[0],e],feature:n,geometry:s,depth:o,index:a};c.insert(Ei(h.segment),h),this.dragSegments_.push([h,1]);const u={segment:[e,i[1]],feature:n,geometry:s,depth:o,index:a+1};return c.insert(Ei(u.segment),u),this.dragSegments_.push([u,0]),!0}updatePointer_(t){return t&&this.findInsertVerticesAndUpdateDragSegments_(t),this.vertexFeature_?.getGeometry().getCoordinates()}getPoint(){const t=this.vertexFeature_?.getGeometry().getCoordinates();return t?Tc(t,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(e=>e.getType()==="Circle"||e.getType().endsWith("Point")))return!1;const t=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(Ei([t])).some(({segment:e})=>Xi(e[0],t)||Xi(e[1],t))}removePoint(t){if(t&&(t=fr(t,this.getMap().getView().getProjection()),this.updatePointer_(t)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=Le.POINTERDRAG){const e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_.map(([n])=>n));const i=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Rv(Cv.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,i}return!1}removeVertex_(){const t=this.dragSegments_,e={};let i=!1,n,s,o,a,l,c,h,u,d,g,f;for(l=t.length-1;l>=0;--l)o=t[l],g=o[0],f=$t(g.feature),g.depth&&(f+="-"+g.depth.join("-")),f in e||(e[f]={}),o[1]===0?(e[f].right=g,e[f].index=g.index):o[1]==1&&(e[f].left=g,e[f].index=g.index+1);for(f in e){switch(d=e[f].right,h=e[f].left,c=e[f].index,u=c-1,h!==void 0?g=h:g=d,u<0&&(u=0),a=g.geometry,s=a.getCoordinates(),n=s,i=!1,a.getType()){case"MultiLineString":s[g.depth[0]].length>2&&(s[g.depth[0]].splice(c,1),i=!0);break;case"LineString":s.length>2&&(s.splice(c,1),i=!0);break;case"MultiPolygon":n=n[g.depth[1]];case"Polygon":n=n[g.depth[0]],n.length>4&&(c==n.length-1&&(c=0),n.splice(c,1),i=!0,c===0&&(n.pop(),n.push(n[0]),u=n.length-1));break}if(i){this.setGeometryCoordinates_(a,s);const p=[];if(h!==void 0&&(this.rBush_.remove(h),p.push(h.segment[0])),d!==void 0&&(this.rBush_.remove(d),p.push(d.segment[1])),h!==void 0&&d!==void 0){const m={depth:g.depth,feature:g.feature,geometry:g.geometry,index:u,segment:p};this.rBush_.insert(Ei(m.segment),m)}this.updateSegmentIndices_(a,c,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.length=0}}return i}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(e=>e.getType()==="Circle"||e.getType().endsWith("Point")))return!1;const t=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(Ei([t])).some(({segment:e})=>!(Xi(e[0],t)||Xi(e[1],t)))}insertPoint(t){const e=t?fr(t,this.getMap().getView().getProjection()):this.vertexFeature_?.getGeometry().getCoordinates();return e?this.findInsertVerticesAndUpdateDragSegments_(e).reduce((i,n)=>i||this.insertVertex_(n,e),!1):!1}setGeometryCoordinates_(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1}updateSegmentIndices_(t,e,i,n){this.rBush_.forEachInExtent(t.getExtent(),function(s){s.geometry===t&&(i===void 0||s.depth===void 0||ua(s.depth,i))&&s.index>e&&(s.index+=n)})}}function Yat(r,t){return r.index-t.index}function iM(r,t,e){const i=t.geometry;if(i.getType()==="Circle"){let s=i;if(t.index===fg){const o=wu(s.getCenter(),fr(r)),a=Math.sqrt(o)-s.getRadius();return a*a}}const n=fr(r);return fu[0]=fr(t.segment[0]),fu[1]=fr(t.segment[1]),RO(n,fu)}function nM(r,t,e){const i=t.geometry;if(i.getType()==="Circle"&&t.index===fg)return Tc(i.getClosestPoint(fr(r)));const n=fr(r);return fu[0]=fr(t.segment[0]),fu[1]=fr(t.segment[1]),Tc(vw(n,fu))}function Xat(){const r=sk();return function(t,e){return r.Point}}const s0={SELECT:"select"};class o0 extends on{constructor(t,e,i,n){super(t),this.selected=e,this.deselected=i,this.mapBrowserEvent=n}}const a0={};class WE extends Ju{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=t.condition?t.condition:CP,this.addCondition_=t.addCondition?t.addCondition:wm,this.removeCondition_=t.removeCondition?t.removeCondition:wm,this.toggleCondition_=t.toggleCondition?t.toggleCondition:bm,this.multi_=t.multi?t.multi:!1,this.filter_=t.filter?t.filter:mo,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.style_=t.style!==void 0?t.style:Kat(),this.features_=t.features||new xi;let e;if(t.layers)if(typeof t.layers=="function")e=t.layers;else{const i=t.layers;e=function(n){return i.includes(n)}}else e=mo;this.layerFilter_=e,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(t,e){this.featureLayerAssociation_[$t(t)]=e}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(t){return this.featureLayerAssociation_[$t(t)]}setHitTolerance(t){this.hitTolerance_=t}setMap(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(t),t?(this.features_.addEventListener(Jr.ADD,this.boundAddFeature_),this.features_.addEventListener(Jr.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(Jr.ADD,this.boundAddFeature_),this.features_.removeEventListener(Jr.REMOVE,this.boundRemoveFeature_))}addFeature_(t){const e=t.element;if(this.style_&&this.applySelectedStyle_(e),!this.getLayer(e)){const i=this.findLayerOfFeature_(e);i&&this.addFeatureLayerAssociation_(e,i)}}removeFeature_(t){this.style_&&this.restorePreviousStyle_(t.element)}findLayerOfFeature_(t){return this.getMap().getAllLayers().find(function(e){if(e instanceof fs&&e.getSource()&&e.getSource().hasFeature(t))return e})}getStyle(){return this.style_}applySelectedStyle_(t){const e=$t(t);e in a0||(a0[e]=t.getStyle()),t.setStyle(this.style_)}restorePreviousStyle_(t){const e=this.getMap().getInteractions().getArray();for(let n=e.length-1;n>=0;--n){const s=e[n];if(s!==this&&s instanceof WE&&s.getStyle()&&s.getFeatures().getArray().lastIndexOf(t)!==-1){t.setStyle(s.getStyle());return}}const i=$t(t);t.setStyle(a0[i]),delete a0[i]}removeFeatureLayerAssociation_(t){delete this.featureLayerAssociation_[$t(t)]}selectFeatureInternal_(t,e,i){if(!(t instanceof zi)||!this.filter_(t,e))return;const n=this.getFeatures();return n.getArray().includes(t)||(this.addFeatureLayerAssociation_(t,e),n.push(t),i?.push(t)),t}selectFeature(t){const e=this.findLayerOfFeature_(t);if(!this.layerFilter_(e))return!1;const i=this.selectFeatureInternal_(t,e);return i&&this.dispatchEvent(new o0(s0.SELECT,[i],[],void 0)),!!i}removeFeatureInternal_(t,e){const i=this.getFeatures();if(!(!(t instanceof zi)||!i.getArray().includes(t)))return i.remove(t),this.removeFeatureLayerAssociation_(t),e?.push(t),t}deselectFeature(t){const e=this.removeFeatureInternal_(t);return e&&this.dispatchEvent(new o0(s0.SELECT,[],[e],void 0)),!!e}toggleFeature(t){this.deselectFeature(t)||this.selectFeature(t)}clearSelection(){Bu(this.featureLayerAssociation_);const t=this.getFeatures(),e=t.getArray().slice();t.clear(),e.length!==0&&this.dispatchEvent(new o0(s0.SELECT,[],e,void 0))}handleEvent(t){if(!this.condition_(t))return!0;const e=this.addCondition_(t),i=this.removeCondition_(t),n=this.toggleCondition_(t),s=!e&&!i&&!n,o=t.map,a=this.getFeatures(),l=[],c=[];if(s){let h=!1;o.forEachFeatureAtPixel(t.pixel,(u,d)=>{if(h=!0,!!this.selectFeatureInternal_(u,d,c))return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let u=a.getLength()-1;u>=0;--u){const d=a.item(u);(c.length>0&&!c.includes(d)||!h)&&this.removeFeatureInternal_(d,l)}}else o.forEachFeatureAtPixel(t.pixel,(h,u)=>{let d;if((i||n)&&(d=this.removeFeatureInternal_(h,l)),(e||n)&&!d&&(d=this.selectFeatureInternal_(h,u,c)),!!d)return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});return(c.length>0||l.length>0)&&this.dispatchEvent(new o0(s0.SELECT,c,l,t)),!0}}function Kat(){const r=sk();return wi(r.Polygon,r.LineString),wi(r.GeometryCollection,r.LineString),function(t){return t.getGeometry()?r[t.getGeometry().getType()]:null}}const Iv={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};class Pv extends on{constructor(t,e,i,n,s){super(t),this.features=e,this.coordinate=i,this.startCoordinate=n,this.mapBrowserEvent=s}}class Qat extends Rl{constructor(t){t=t||{},super(t),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=t.features!==void 0?t.features:null;let e;if(t.layers&&!this.features_)if(typeof t.layers=="function")e=t.layers;else{const i=t.layers;e=function(n){return i.includes(n)}}else e=mo;this.layerFilter_=e,this.filter_=t.filter&&!this.features_?t.filter:mo,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.condition_=t.condition?t.condition:gc,this.lastFeature_=null,this.addChangeListener(xm.ACTIVE,this.handleActiveChanged_)}handleDownEvent(t){if(!t.originalEvent||!this.condition_(t))return!1;if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);const e=this.features_||new xi([this.lastFeature_]);return this.dispatchEvent(new Pv(Iv.TRANSLATESTART,e,t.coordinate,this.startCoordinate_,t)),!0}return!1}handleUpEvent(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);const e=this.features_||new xi([this.lastFeature_]);return this.dispatchEvent(new Pv(Iv.TRANSLATEEND,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1}handleDragEvent(t){if(this.lastCoordinate_){const e=t.coordinate;t.map.getView().getProjection();const i=fr(e),n=fr(this.lastCoordinate_),s=i[0]-n[0],o=i[1]-n[1],a=this.features_||new xi([this.lastFeature_]);a.forEach(function(l){const c=l.getGeometry();c.translate(s,o),l.setGeometry(c)}),this.lastCoordinate_=e,this.dispatchEvent(new Pv(Iv.TRANSLATING,a,e,this.startCoordinate_,t))}}handleMoveEvent(t){const e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(t,e){return e.forEachFeatureAtPixel(t,(i,n)=>{if(!(!(i instanceof zi)||!this.filter_(i,n))&&!(this.features_&&!this.features_.getArray().includes(i)))return i},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(t){this.hitTolerance_=t}setMap(t){const e=this.getMap();super.setMap(t),this.updateState_(e)}handleActiveChanged_(){this.updateState_(null)}updateState_(t){let e=this.getMap();const i=this.getActive();(!e||!i)&&(e=e||t,e&&e.getViewport().classList.remove("ol-grab","ol-grabbing"))}}const Jat=(r,t,e)=>{if(e){const i=new DOMParser().parseFromString(e,"image/svg+xml");return i.querySelectorAll("[fill]").forEach(n=>{n.setAttribute("fill",r)}),i.querySelectorAll("[stroke]").forEach(n=>{n.setAttribute("stroke",t)}),i.querySelectorAll("path, circle, rect, polygon, ellipse").forEach(n=>{n.hasAttribute("fill")||n.setAttribute("fill",r),n.hasAttribute("stroke")||n.setAttribute("stroke",t)}),new XMLSerializer().serializeToString(i)}return`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="-1 -1 25 25"
  >
    <path
      d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 0 1 0-5 2.5 2.5 0 0 1 0 5z"
      fill="${r}"
      stroke="${t}"
      stroke-width="1"
    />
  </svg>
`},tlt=({fill:r="#005CA9",stroke:t="#FFF",svg:e})=>{let i="";typeof r=="string"?i=r:"oklch"in r?i=`oklch(${r.oklch.l} ${r.oklch.c} ${r.oklch.h})`:"rgba"in r&&(i=`${r.rgba.r} ${r.rgba.g} ${r.rgba.b} ${r.rgba.a?r.rgba.a:""}`);let n="";return typeof t=="string"?n=t:"oklch"in t?n=`oklch(${t.oklch.l} ${t.oklch.c} ${t.oklch.h})`:"rgba"in t&&(n=`${t.rgba.r} ${t.rgba.g} ${t.rgba.b} ${t.rgba.a?t.rgba.a:""}`),new Vr({image:new kl({src:`data:image/svg+xml;base64,${btoa(Jat(i,n,e))}`,scale:2,anchor:[.5,1]})})},elt={Circle:rp,LinearRing:um,LineString:kn,MultiLineString:Qc,MultiPoint:td,MultiPolygon:Jc,Point:Pi,Polygon:gs};function rlt(r,t,e,i){const n=new elt[e](i);let s=Wi(n.getExtent());return(e==="Polygon"||e==="MultiPolygon")&&!n.intersectsCoordinate(s)&&(s=(n.getType()==="Polygon"?n.getInteriorPoint():n.getInteriorPoints()).getFirstCoordinate()),r===t?s:qs(s,r,t)}async function sM(r,t,e){if(!e)return!0;const i=await Yst(t,e.layerId,r);return i===!0||typeof i=="symbol"&&e.onError!=="strict"?!0:(typeof i=="symbol"?(o2("error",()=>Ci(n=>n.boundaryError,{ns:"pins"})),console.error(`@polar/polar(plugins/pins/utils/isCoordinateInBoundaryLayer:39:3)
`,"Checking boundary layer failed.")):(o2("info",()=>Ci(n=>n.notInBoundary,{ns:"pins"})),console.info(`@polar/polar(plugins/pins/utils/isCoordinateInBoundaryLayer:43:3)
`,"Pin position outside of boundary layer:",r)),!1)}const ilt=Sl("plugins/pins",()=>{const r=ar(),t=me(null),e=me(!1),i=Ct(()=>Lr({minZoomLevel:0,movable:"none",toZoomLevel:0},r.configuration.pins||{})),n=Ct(()=>{if(!t.value)return null;const y=nF(t.value,r.configuration.epsg);return[y[1],y[0]]}),s=new fs({source:new ls,style:tlt(i.value.style||{})}),o=new WE({layers:y=>y===s,style:null,condition:_V}),a=new Qat({condition:()=>r.map.getView().getZoom()>=i.value.minZoomLevel,layers:[s]});let l=null;function c(){r.map.addLayer(s),s.setZIndex(100),r.map.on("singleclick",async({coordinate:y})=>{await f(y)}),u(),d(),g()}function h(){const{map:y}=r;y.un("singleclick",async({coordinate:_})=>{await f(_)}),m(),y.removeLayer(s),y.removeInteraction(o),y.removeInteraction(a),l&&l()}function u(){const{coordinateSources:y}=i.value;y&&y.forEach(_=>{const x=_.plugin?r.getPluginStore(_.plugin):r;x&&(l=Zr(()=>x[_.key],v=>{v&&v.type!=="reverse_geocoded"&&p(v.geometry.coordinates,!1,{type:v.geometry.type})}))})}function d(){const{initial:y}=i.value;if(y){const{coordinate:_,centerOn:x,epsg:v}=y;if(x){p(_,!1,{epsg:v||r.configuration.epsg,type:"Point"});return}p(_)}}function g(){o.on("select",({selected:_})=>{i.value.movable==="none"&&(document.body.style.cursor=_.length?"not-allowed":"")}),r.map.addInteraction(o);const{movable:y}=i.value;y==="drag"&&(a.on("translatestart",()=>e.value=!0),a.on("translateend",({features:_})=>{e.value=!1,_.forEach(async x=>{const v=x.getGeometry().getCoordinates(),w=await sM(v,r.map,i.value.boundary)?v:t.value;w&&p(w)})}),r.map.addInteraction(a))}async function f(y){const _=r.map.getInteractions().getArray().some(w=>w instanceof Wat&&(w._isMultiSelect||w._isDrawPlugin)||w instanceof Hat||w._isDeleteSelect),{minZoomLevel:x,movable:v}=i.value;(v==="drag"||v==="click")&&r.map.getView().getZoom()>=x&&!_&&await sM(y,r.map,i.value.boundary)&&p(y)}function p(y,_=!0,x){m(),t.value=y,!_&&x&&(t.value=rlt(x.epsg||r.configuration.epsg,r.configuration.epsg,x.type,y),r.map.getView().setCenter(t.value),r.map.getView().setZoom(i.value.toZoomLevel)),s.getSource().addFeature(new zi({geometry:new Pi(t.value),type:"point",name:"mapMarker",zIndex:100}))}function m(){s.getSource().clear()}return{coordinate:t,latLon:n,setupPlugin:c,teardownPlugin:h}}),nlt={boundaryError:"Die ÃberprÃ¼fung der Koordinate ist fehlgeschlagen. Bitte versuchen Sie es spÃ¤ter erneut oder wenden Sie sich an einen Administrator, wenn das Problem bestehen bleibt.",notInBoundary:"Diese Koordinate kann nicht gewÃ¤hlt werden."},slt={boundaryError:"Validating the coordinate failed. Please try again later or contact an administrator if the issue persists.",notInBoundary:"It is not possible to select this coordinate."},olt=[{type:"de",resources:nlt},{type:"en",resources:slt}],alt="pins";function Ndt(r){return{id:alt,locales:olt,storeModule:ilt,options:r}}const VE="reverseGeocoder",N8=Sl("plugins/reverseGeocoder",()=>{const r=ar(),t=Ct(()=>r.configuration[VE]),e=me([]);function i(){for(const a of t.value.coordinateSources||[]){const l=a.plugin?r.getPluginStore(a.plugin):r;l&&e.value.push(Zr(()=>l[a.key],async c=>{c&&await o(c)},{immediate:!0}))}}function n(){e.value.forEach(a=>{a()})}function s(a,l){const c=a.plugin?r.getPluginStore(a.plugin):r;c&&c[a.key](l)}async function o(a){const l=pO();try{const c=await fO(t.value.url,a);return t.value.addressTarget&&s(t.value.addressTarget,c),t.value.zoomTo&&r.map.getView().fit(new Pi(a),{maxZoom:t.value.zoomTo,duration:400,easing:Tl}),c}catch(c){return console.error(`@polar/polar(plugins/reverseGeocoder/store:102:5)
`,"Reverse geocoding failed:",c),null}finally{l()}}return{reverseGeocode:o,setupPlugin:i,teardownPlugin:n}});if(import.meta.vitest){const{expect:r,test:t,vi:e}=import.meta.vitest,{createPinia:i,setActivePinia:n}=await Es(async()=>{const{createPinia:h,setActivePinia:u}=await import("./pinia-DFMOV6lD-BZLsqLPB.js");return{createPinia:h,setActivePinia:u}},__vite__mapDeps([0,1]),import.meta.url),{reactive:s}=await Es(async()=>{const{reactive:h}=await import("./vue.runtime.esm-bundler-CYHrvVzW-BTeeWO83.js");return{reactive:h}},[],import.meta.url),o=await Es(()=>import("./indicateLoading-C_uppgjV-DVX-YvQI.js").then(h=>h.s),__vite__mapDeps([2,0,1,3]),import.meta.url),a=await Es(()=>import("./reverseGeocode-CR3Bbmu1-Cvr90uaQ.js").then(h=>h.r),[],import.meta.url),l=await Es(()=>import("./indicateLoading-C_uppgjV-DVX-YvQI.js").then(h=>h.i),__vite__mapDeps([2,0,1,3]),import.meta.url),c=t.extend({reverseGeocodeUtil:[async({},h)=>{const u=e.spyOn(a,"reverseGeocode").mockResolvedValue(null);await h(u)},{auto:!0}],indicateLoading:[async({},h)=>{const u=e.spyOn(l,"indicateLoading").mockImplementation(()=>()=>{});await h(u)},{auto:!0}],coreStore:[async({},h)=>{const u=e.fn(),d=s({configuration:{[VE]:{url:"https://wps.example",coordinateSources:[{key:"coordinateSource"}],addressTarget:{key:"addressTarget"},zoomTo:99}},map:{getView:()=>({fit:u})},coordinateSource:null,addressTarget:e.fn()});e.spyOn(o,"useCoreStore").mockReturnValue(d),await h(d)},{auto:!0}],store:[async({},h)=>{n(i());const u=N8();u.setupPlugin(),await h(u),u.teardownPlugin()},{auto:!0}]});c("detects changes in coordinate sources",async({reverseGeocodeUtil:h,coreStore:u})=>{u.coordinateSource=[1,2],await new Promise(d=>setTimeout(d)),r(h).toHaveBeenCalledWith("https://wps.example",[1,2])}),c("passes geocoding result to address target",async({reverseGeocodeUtil:h,coreStore:u,store:d})=>{const g=Symbol("feature");h.mockResolvedValueOnce(g),await d.reverseGeocode([3,4]),r(u.addressTarget).toHaveBeenCalledOnce(),r(u.addressTarget).toHaveBeenCalledWith(g)}),c("zooms to input coordinate",async({reverseGeocodeUtil:h,coreStore:u,store:d})=>{const g=Symbol("feature");h.mockResolvedValueOnce(g),await d.reverseGeocode([3,4]),r(u.map.getView().fit).toHaveBeenCalledOnce()})}function Ddt(r){return{id:VE,storeModule:N8,options:r}}function llt(r,t,{signal:e,edges:i=["leading","trailing"]}={}){let n=null;const s=g8(function(...a){n=Date.now(),r.apply(this,a)},t,{signal:e,edges:i}),o=function(...a){if(n==null&&(n=Date.now()),Date.now()-n>=t){n=Date.now(),r.apply(this,a),s.cancel(),s.schedule();return}s.apply(this,a)};return o.cancel=s.cancel,o.flush=s.flush,o}function D8(){let r=96;try{const t=document.createElement("div"),e=document.body;t.id="programmatical-dpidiv",t.setAttribute("style","position: absolute; height: 1in; width: 1in; top: -100%; left: -100%;"),e.appendChild(t),r=t.offsetWidth*(window.devicePixelRatio||1),e.removeChild(t)}catch(t){console.error(`@polar/polar(lib/dpi:26:3)
`,t),console.warn(`@polar/polar(lib/dpi:27:3)
`,`Since the dpi could not be inferred, the default value ${r} will be used.`)}return r}const $8=me(D8());let l0=0;const kh=llt(()=>$8.value=D8(),100);function clt(){return l0===0&&(window.addEventListener("resize",kh,{passive:!0}),window.addEventListener("orientationchange",kh),window.visualViewport?.addEventListener("resize",kh)),l0++,IM(function(){l0--,l0===0&&(window.removeEventListener("resize",kh),window.removeEventListener("orientationchange",kh),window.visualViewport?.removeEventListener("resize",kh))}),{dpi:$8}}const oM=(r,t)=>`1 : ${new Intl.NumberFormat(t,{maximumFractionDigits:0}).format(r>1e4?Math.round(r/500)*500:r>1e3?Math.round(r/50)*50:r)}`;function aM(r,t,e){return Math.round(t*ea[r]*39.37*e)}const G8=Sl("plugins/scale",()=>{const r=ar(),{dpi:t}=clt(),e=me(0),i=Ct(()=>oM(e.value,r.language)),n=Ct(()=>{const c=Math.round(.02*e.value);return c>=1e3?`${Math.round(c/100)/10}km`:`${c}m`}),s=Ct(()=>r.configuration.options.map(c=>{const h=oM(aM(r.map.getView().getProjection().getUnits(),c.resolution,t.value),r.language);return{...c,label:h,ariaLabel:ZI(()=>Ci(u=>u.to,{ns:"scale",number:h.split(":")[1]?.replace(/[,.]/g,"").trim()})).value,value:c.zoomLevel}})),o=Ct(()=>r.configuration.scale?.layoutTag),a=Ct(()=>r.configuration.scale?.showScaleSwitcher&&s.value.length>0);function l(){const c=r.map.getView().getProjection().getUnits(),h=r.map.getView().getResolution(),u=aM(c,h,t.value);e.value=u}return r.map.on("moveend",l),IM(()=>{r.map.un("moveend",l)}),{layoutTag:o,scaleToOne:i,scaleWithUnit:n,showScaleSwitcher:a,zoomOptions:s}}),R0="scale",hlt=["title","aria-label"],ult={key:1,class:"scale-as-a-ratio"},dlt={class:"scale-line"},glt={class:"scale-line-text"},flt=je({__name:"ScaleWidget.ce",setup(r){const t=G8(),e=ar(),{layoutTag:i,scaleToOne:n,scaleWithUnit:s,showScaleSwitcher:o,zoomOptions:a}=yr(t),{layout:l,zoom:c}=yr(e),h=Ct(()=>`${Math.round(c.value)}`);function u(d){c.value=Number(d)}return(d,g)=>(ht(),Gt("div",{class:mr(["polar-plugin-scale",nt(l)==="nineRegions"?`polar-plugin-scale-nineRegions ${nt(i)}`:""]),title:d.$t(f=>f.label,{ns:nt(R0)}),"aria-label":d.$t(f=>f.label,{ns:nt(R0)})},[nt(o)?(ht(),Ee(c8,{key:0,value:h.value,options:nt(a),"aria-label":d.$t(f=>f.scaleSwitcher,{ns:nt(R0)}),small:"","onUpdate:value":u},null,8,["value","options","aria-label"])):(ht(),Gt("span",ult,nr(nt(n)),1)),Yt("span",dlt,[Yt("span",glt,nr(nt(s)),1),g[0]||(g[0]=Yt("span",{class:"scale-line-scale"},null,-1))])],10,hlt))}}),plt=".polar-plugin-scale{&[data-v-9b75fe49]{display:flex;flex-direction:row;align-items:center;gap:var(--kern-metric-space-small);padding:0 var(--kern-metric-space-small)}.scale-as-a-ratio[data-v-9b75fe49]{white-space:nowrap;color:var(--kern-color-layout-text-default)}.scale-line-text[data-v-9b75fe49]{font-weight:bolder;color:var(--kern-color-layout-text-default);min-width:5ch;text-align:right}.scale-line{&[data-v-9b75fe49]{display:flex;align-items:anchor-center;gap:var(--kern-metric-space-small)}.scale-line-scale[data-v-9b75fe49]{border-radius:0 0 .125rem .125rem;border-right:1px solid var(--kern-color-form-input-border);border-bottom:1px solid var(--kern-color-form-input-border);border-left:1px solid var(--kern-color-form-input-border);height:.75rem;width:2cm}}[data-v-9b75fe49] .kern-form-input__select-wrapper{background-color:var(--kern-color-form-input-background-inverted)}&.polar-plugin-scale-nineRegions{&[data-v-9b75fe49]{gap:var(--kern-metric-space-2x-small);padding:var(--kern-metric-space-2x-small);align-items:stretch}>*[data-v-9b75fe49]{background:var(--kern-color-form-input-background-inverted);border-radius:var(--kern-metric-border-radius-large);padding:var(--kern-metric-space-x-small) var(--kern-metric-space-small);box-shadow:var(--polar-shadow)}.scale-line-text[data-v-9b75fe49]{text-align:left}&.BOTTOM_LEFT[data-v-9b75fe49],&.TOP_LEFT[data-v-9b75fe49],&.MIDDLE_LEFT[data-v-9b75fe49]{flex-direction:row-reverse}}}",mlt=gr(flt,[["styles",[plt]],["__scopeId","data-v-9b75fe49"]]),ylt={label:"Skala",scaleSwitcher:"MaÃstab Ã¤ndern",to:"Eins zu {{number}}"},_lt={label:"Scale",scaleSwitcher:"Change scale",to:"One to {{number}}"},vlt=[{type:"de",resources:ylt},{type:"en",resources:_lt}];function $dt(r){return{id:R0,component:mlt,locales:vlt,options:r,storeModule:G8}}function xlt(r){if(typeof r=="object"){if("oklch"in r)return`oklch(${r.oklch.l}, ${r.oklch.c}, ${r.oklch.h})`;if("rgba"in r)return r.rgba.a?`rgba(${r.rgba.r}, ${r.rgba.g}, ${r.rgba.b}, ${r.rgba.a})`:`rgb(${r.rgba.r}, ${r.rgba.g}, ${r.rgba.b})`}return r}const wlt={class:"kern-alert__header"},blt={class:"kern-title"},klt=["onClick"],Elt={class:"kern-label kern-sr-only"},Slt=je({__name:"ToastUI.ce",setup(r){const t=ek();function e(n){return{error:"danger",info:"info",warning:"warning",success:"success"}[n]}const i=Ct(()=>t.toasts.map(n=>{const s=e(n.severity);return{alertClass:`kern-alert--${s}`,alertStyle:n.theme?.color?{"background-color":xlt(n.theme.color)}:{},iconClass:n.theme?.icon||`kern-icon--${s}`,text:n.text,originalToast:n}}));return(n,s)=>(ht(!0),Gt(ri,null,tn(i.value,(o,a)=>(ht(),Gt("div",{key:a,class:mr(["kern-alert",o.alertClass]),style:ll(o.alertStyle),role:"alert"},[Yt("div",wlt,[Yt("span",{class:mr(["kern-icon",o.iconClass]),"aria-hidden":"true"},null,2),Yt("span",blt,nr(o.text),1),Yt("button",{class:"kern-btn",onClick:l=>nt(t).removeToast(o.originalToast)},[s[0]||(s[0]=Yt("span",{class:"kern-icon kern-icon--close","aria-hidden":"true"},null,-1)),Yt("span",Elt,nr(n.$t(l=>l.dismissButton.label,{ns:nt(Jg)})),1)],8,klt)])],6))),128))}}),Tlt=".kern-alert{&[data-v-d4942d6e]{margin:var(--kern-metric-space-small) var(--kern-metric-space-none)}>.kern-alert__header{&[data-v-d4942d6e]{padding:var(--kern-metric-space-x-small) var(--kern-metric-space-default)}>.kern-icon[data-v-d4942d6e]{display:none;@media(min-width:30em){display:initial}}>.kern-title[data-v-d4942d6e]{flex:1;max-width:calc(100% - 2.5em);overflow-wrap:break-word}}}.kern-btn[data-v-d4942d6e]{margin-left:var(--kern-metric-space-x-small);background-color:transparent}",lM=gr(Slt,[["styles",[Tlt]],["__scopeId","data-v-d4942d6e"]]),Clt={key:0,class:"polar-plugin-toast-standard-layout"},Mlt=je({__name:"ToastContainer.ce",setup(r){const{layout:t}=yr(ar());return(e,i)=>nt(t)==="standard"?(ht(),Gt("div",Clt,[po(lM)])):(ht(),Ee(lM,{key:1}))}}),Rlt=".polar-plugin-toast-standard-layout[data-v-13133193]{position:absolute;z-index:40;top:0;left:var(--kern-metric-space-small);right:var(--kern-metric-space-small);@media(min-width:50em){left:25%;right:25%}}",Ilt=gr(Mlt,[["styles",[Rlt]],["__scopeId","data-v-13133193"]]),Plt={dismissButton:{label:"Benachrichtigung ausblenden"}},Alt={dismissButton:{label:"Hide notification"}},Llt=[{type:"de",resources:Plt},{type:"en",resources:Alt}];function Gdt(r){return{id:Jg,component:Ilt,locales:Llt,storeModule:ek,options:r}}function ZE(r){const t=Object.create(null);for(const e of r.split(","))t[e]=1;return e=>e in t}const Je={},pu=[],fo=()=>{},j8=()=>!1,HE=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),z8=r=>r.startsWith("onUpdate:"),Zi=Object.assign,YE=(r,t)=>{const e=r.indexOf(t);e>-1&&r.splice(e,1)},Olt=Object.prototype.hasOwnProperty,Xe=(r,t)=>Olt.call(r,t),ae=Array.isArray,mu=r=>ip(r)==="[object Map]",q8=r=>ip(r)==="[object Set]",cM=r=>ip(r)==="[object Date]",ye=r=>typeof r=="function",Hi=r=>typeof r=="string",oa=r=>typeof r=="symbol",tr=r=>r!==null&&typeof r=="object",B8=r=>(tr(r)||ye(r))&&ye(r.then)&&ye(r.catch),U8=Object.prototype.toString,ip=r=>U8.call(r),Flt=r=>ip(r).slice(8,-1),W8=r=>ip(r)==="[object Object]",Cy=r=>Hi(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,pg=ZE(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),My=r=>{const t=Object.create(null);return(e=>t[e]||(t[e]=r(e)))},Nlt=/-\w/g,ko=My(r=>r.replace(Nlt,t=>t.slice(1).toUpperCase())),Dlt=/\B([A-Z])/g,np=My(r=>r.replace(Dlt,"-$1").toLowerCase()),XE=My(r=>r.charAt(0).toUpperCase()+r.slice(1)),Av=My(r=>r?`on${XE(r)}`:""),ml=(r,t)=>!Object.is(r,t),Lv=(r,...t)=>{for(let e=0;e<r.length;e++)r[e](...t)},V8=(r,t,e,i=!1)=>{Object.defineProperty(r,t,{configurable:!0,enumerable:!1,writable:i,value:e})},$lt=r=>{const t=parseFloat(r);return isNaN(t)?r:t};let hM;const Ry=()=>hM||(hM=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function KE(r){if(ae(r)){const t={};for(let e=0;e<r.length;e++){const i=r[e],n=Hi(i)?qlt(i):KE(i);if(n)for(const s in n)t[s]=n[s]}return t}else if(Hi(r)||tr(r))return r}const Glt=/;(?![^(]*\))/g,jlt=/:([^]+)/,zlt=/\/\*[^]*?\*\//g;function qlt(r){const t={};return r.replace(zlt,"").split(Glt).forEach(e=>{if(e){const i=e.split(jlt);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function QE(r){let t="";if(Hi(r))t=r;else if(ae(r))for(let e=0;e<r.length;e++){const i=QE(r[e]);i&&(t+=i+" ")}else if(tr(r))for(const e in r)r[e]&&(t+=e+" ");return t.trim()}const Blt="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",jdt=ZE(Blt);function zdt(r){return!!r||r===""}function Ult(r,t){if(r.length!==t.length)return!1;let e=!0;for(let i=0;e&&i<r.length;i++)e=JE(r[i],t[i]);return e}function JE(r,t){if(r===t)return!0;let e=cM(r),i=cM(t);if(e||i)return e&&i?r.getTime()===t.getTime():!1;if(e=oa(r),i=oa(t),e||i)return r===t;if(e=ae(r),i=ae(t),e||i)return e&&i?Ult(r,t):!1;if(e=tr(r),i=tr(t),e||i){if(!e||!i)return!1;const n=Object.keys(r).length,s=Object.keys(t).length;if(n!==s)return!1;for(const o in r){const a=r.hasOwnProperty(o),l=t.hasOwnProperty(o);if(a&&!l||!a&&l||!JE(r[o],t[o]))return!1}}return String(r)===String(t)}const Z8=r=>!!(r&&r.__v_isRef===!0),Wlt=r=>Hi(r)?r:r==null?"":ae(r)||tr(r)&&(r.toString===U8||!ye(r.toString))?Z8(r)?Wlt(r.value):JSON.stringify(r,H8,2):String(r),H8=(r,t)=>Z8(t)?H8(r,t.value):mu(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[i,n],s)=>(e[Ov(i,s)+" =>"]=n,e),{})}:q8(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Ov(e))}:oa(t)?Ov(t):tr(t)&&!ae(t)&&!W8(t)?String(t):t,Ov=(r,t="")=>{var e;return oa(r)?`Symbol(${(e=r.description)!=null?e:t})`:r};let Di;class Y8{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.__v_skip=!0,this.parent=Di,!t&&Di&&(this.index=(Di.scopes||(Di.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Di;try{return Di=this,t()}finally{Di=e}}}on(){++this._on===1&&(this.prevScope=Di,Di=this)}off(){this._on>0&&--this._on===0&&(Di=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,i;for(e=0,i=this.effects.length;e<i;e++)this.effects[e].stop();for(this.effects.length=0,e=0,i=this.cleanups.length;e<i;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function qdt(r){return new Y8(r)}function Vlt(){return Di}function Bdt(r,t=!1){Di&&Di.cleanups.push(r)}let hr;const Fv=new WeakSet;class X8{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Di&&Di.active&&Di.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Fv.has(this)&&(Fv.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Q8(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,uM(this),J8(this);const t=hr,e=Os;hr=this,Os=!0;try{return this.fn()}finally{t6(this),hr=t,Os=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)rS(t);this.deps=this.depsTail=void 0,uM(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Fv.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){nw(this)&&this.run()}get dirty(){return nw(this)}}let K8=0,mg,yg;function Q8(r,t=!1){if(r.flags|=8,t){r.next=yg,yg=r;return}r.next=mg,mg=r}function tS(){K8++}function eS(){if(--K8>0)return;if(yg){let t=yg;for(yg=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let r;for(;mg;){let t=mg;for(mg=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){r||(r=i)}t=e}}if(r)throw r}function J8(r){for(let t=r.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function t6(r){let t,e=r.depsTail,i=e;for(;i;){const n=i.prevDep;i.version===-1?(i===e&&(e=n),rS(i),Zlt(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=n}r.deps=t,r.depsTail=e}function nw(r){for(let t=r.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(e6(t.dep.computed)||t.dep.version!==t.version))return!0;return!!r._dirty}function e6(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===mf)||(r.globalVersion=mf,!r.isSSR&&r.flags&128&&(!r.deps&&!r._dirty||!nw(r))))return;r.flags|=2;const t=r.dep,e=hr,i=Os;hr=r,Os=!0;try{J8(r);const n=r.fn(r._value);(t.version===0||ml(n,r._value))&&(r.flags|=128,r._value=n,t.version++)}catch(n){throw t.version++,n}finally{hr=e,Os=i,t6(r),r.flags&=-3}}function rS(r,t=!1){const{dep:e,prevSub:i,nextSub:n}=r;if(i&&(i.nextSub=n,r.prevSub=void 0),n&&(n.prevSub=i,r.nextSub=void 0),e.subs===r&&(e.subs=i,!i&&e.computed)){e.computed.flags&=-5;for(let s=e.computed.deps;s;s=s.nextDep)rS(s,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function Zlt(r){const{prevDep:t,nextDep:e}=r;t&&(t.nextDep=e,r.prevDep=void 0),e&&(e.prevDep=t,r.nextDep=void 0)}let Os=!0;const r6=[];function aa(){r6.push(Os),Os=!1}function la(){const r=r6.pop();Os=r===void 0?!0:r}function uM(r){const{cleanup:t}=r;if(r.cleanup=void 0,t){const e=hr;hr=void 0;try{t()}finally{hr=e}}}let mf=0;class Hlt{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class iS{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!hr||!Os||hr===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==hr)e=this.activeLink=new Hlt(hr,this),hr.deps?(e.prevDep=hr.depsTail,hr.depsTail.nextDep=e,hr.depsTail=e):hr.deps=hr.depsTail=e,i6(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const i=e.nextDep;i.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=i),e.prevDep=hr.depsTail,e.nextDep=void 0,hr.depsTail.nextDep=e,hr.depsTail=e,hr.deps===e&&(hr.deps=i)}return e}trigger(t){this.version++,mf++,this.notify(t)}notify(t){tS();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{eS()}}}function i6(r){if(r.dep.sc++,r.sub.flags&4){const t=r.dep.computed;if(t&&!r.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)i6(i)}const e=r.dep.subs;e!==r&&(r.prevSub=e,e&&(e.nextSub=r)),r.dep.subs=r}}const Zm=new WeakMap,bc=Symbol(""),sw=Symbol(""),yf=Symbol("");function ji(r,t,e){if(Os&&hr){let i=Zm.get(r);i||Zm.set(r,i=new Map);let n=i.get(e);n||(i.set(e,n=new iS),n.map=i,n.key=e),n.track()}}function Uo(r,t,e,i,n,s){const o=Zm.get(r);if(!o){mf++;return}const a=l=>{l&&l.trigger()};if(tS(),t==="clear")o.forEach(a);else{const l=ae(r),c=l&&Cy(e);if(l&&e==="length"){const h=Number(i);o.forEach((u,d)=>{(d==="length"||d===yf||!oa(d)&&d>=h)&&a(u)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),c&&a(o.get(yf)),t){case"add":l?c&&a(o.get("length")):(a(o.get(bc)),mu(r)&&a(o.get(sw)));break;case"delete":l||(a(o.get(bc)),mu(r)&&a(o.get(sw)));break;case"set":mu(r)&&a(o.get(bc));break}}eS()}function Ylt(r,t){const e=Zm.get(r);return e&&e.get(t)}function Eh(r){const t=Ue(r);return t===r?t:(ji(t,"iterate",yf),zn(r)?t:t.map(js))}function Iy(r){return ji(r=Ue(r),"iterate",yf),r}function Ua(r,t){return ca(r)?$u(kc(r)?js(t):t):js(t)}const Xlt={__proto__:null,[Symbol.iterator](){return Nv(this,Symbol.iterator,r=>Ua(this,r))},concat(...r){return Eh(this).concat(...r.map(t=>ae(t)?Eh(t):t))},entries(){return Nv(this,"entries",r=>(r[1]=Ua(this,r[1]),r))},every(r,t){return Lo(this,"every",r,t,void 0,arguments)},filter(r,t){return Lo(this,"filter",r,t,e=>e.map(i=>Ua(this,i)),arguments)},find(r,t){return Lo(this,"find",r,t,e=>Ua(this,e),arguments)},findIndex(r,t){return Lo(this,"findIndex",r,t,void 0,arguments)},findLast(r,t){return Lo(this,"findLast",r,t,e=>Ua(this,e),arguments)},findLastIndex(r,t){return Lo(this,"findLastIndex",r,t,void 0,arguments)},forEach(r,t){return Lo(this,"forEach",r,t,void 0,arguments)},includes(...r){return Dv(this,"includes",r)},indexOf(...r){return Dv(this,"indexOf",r)},join(r){return Eh(this).join(r)},lastIndexOf(...r){return Dv(this,"lastIndexOf",r)},map(r,t){return Lo(this,"map",r,t,void 0,arguments)},pop(){return Pd(this,"pop")},push(...r){return Pd(this,"push",r)},reduce(r,...t){return dM(this,"reduce",r,t)},reduceRight(r,...t){return dM(this,"reduceRight",r,t)},shift(){return Pd(this,"shift")},some(r,t){return Lo(this,"some",r,t,void 0,arguments)},splice(...r){return Pd(this,"splice",r)},toReversed(){return Eh(this).toReversed()},toSorted(r){return Eh(this).toSorted(r)},toSpliced(...r){return Eh(this).toSpliced(...r)},unshift(...r){return Pd(this,"unshift",r)},values(){return Nv(this,"values",r=>Ua(this,r))}};function Nv(r,t,e){const i=Iy(r),n=i[t]();return i!==r&&!zn(r)&&(n._next=n.next,n.next=()=>{const s=n._next();return s.done||(s.value=e(s.value)),s}),n}const Klt=Array.prototype;function Lo(r,t,e,i,n,s){const o=Iy(r),a=o!==r&&!zn(r),l=o[t];if(l!==Klt[t]){const u=l.apply(r,s);return a?js(u):u}let c=e;o!==r&&(a?c=function(u,d){return e.call(this,Ua(r,u),d,r)}:e.length>2&&(c=function(u,d){return e.call(this,u,d,r)}));const h=l.call(o,c,i);return a&&n?n(h):h}function dM(r,t,e,i){const n=Iy(r);let s=e;return n!==r&&(zn(r)?e.length>3&&(s=function(o,a,l){return e.call(this,o,a,l,r)}):s=function(o,a,l){return e.call(this,o,Ua(r,a),l,r)}),n[t](s,...i)}function Dv(r,t,e){const i=Ue(r);ji(i,"iterate",yf);const n=i[t](...e);return(n===-1||n===!1)&&Py(e[0])?(e[0]=Ue(e[0]),i[t](...e)):n}function Pd(r,t,e=[]){aa(),tS();const i=Ue(r)[t].apply(r,e);return eS(),la(),i}const Qlt=ZE("__proto__,__v_isRef,__isVue"),n6=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(oa));function Jlt(r){oa(r)||(r=String(r));const t=Ue(this);return ji(t,"has",r),t.hasOwnProperty(r)}class s6{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,i){if(e==="__v_skip")return t.__v_skip;const n=this._isReadonly,s=this._isShallow;if(e==="__v_isReactive")return!n;if(e==="__v_isReadonly")return n;if(e==="__v_isShallow")return s;if(e==="__v_raw")return i===(n?s?cct:c6:s?l6:a6).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const o=ae(t);if(!n){let l;if(o&&(l=Xlt[e]))return l;if(e==="hasOwnProperty")return Jlt}const a=Reflect.get(t,e,bi(t)?t:i);if((oa(e)?n6.has(e):Qlt(e))||(n||ji(t,"get",e),s))return a;if(bi(a)){const l=o&&Cy(e)?a:a.value;return n&&tr(l)?aw(l):l}return tr(a)?n?aw(a):sS(a):a}}class o6 extends s6{constructor(t=!1){super(!1,t)}set(t,e,i,n){let s=t[e];const o=ae(t)&&Cy(e);if(!this._isShallow){const c=ca(s);if(!zn(i)&&!ca(i)&&(s=Ue(s),i=Ue(i)),!o&&bi(s)&&!bi(i))return c||(s.value=i),!0}const a=o?Number(e)<t.length:Xe(t,e),l=Reflect.set(t,e,i,bi(t)?t:n);return t===Ue(n)&&(a?ml(i,s)&&Uo(t,"set",e,i):Uo(t,"add",e,i)),l}deleteProperty(t,e){const i=Xe(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&i&&Uo(t,"delete",e,void 0),n}has(t,e){const i=Reflect.has(t,e);return(!oa(e)||!n6.has(e))&&ji(t,"has",e),i}ownKeys(t){return ji(t,"iterate",ae(t)?"length":bc),Reflect.ownKeys(t)}}class tct extends s6{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const ect=new o6,rct=new tct,ict=new o6(!0);const ow=r=>r,c0=r=>Reflect.getPrototypeOf(r);function nct(r,t,e){return function(...i){const n=this.__v_raw,s=Ue(n),o=mu(s),a=r==="entries"||r===Symbol.iterator&&o,l=r==="keys"&&o,c=n[r](...i),h=e?ow:t?$u:js;return!t&&ji(s,"iterate",l?sw:bc),Zi(Object.create(c),{next(){const{value:u,done:d}=c.next();return d?{value:u,done:d}:{value:a?[h(u[0]),h(u[1])]:h(u),done:d}}})}}function h0(r){return function(...t){return r==="delete"?!1:r==="clear"?void 0:this}}function sct(r,t){const e={get(n){const s=this.__v_raw,o=Ue(s),a=Ue(n);r||(ml(n,a)&&ji(o,"get",n),ji(o,"get",a));const{has:l}=c0(o),c=t?ow:r?$u:js;if(l.call(o,n))return c(s.get(n));if(l.call(o,a))return c(s.get(a));s!==o&&s.get(n)},get size(){const n=this.__v_raw;return!r&&ji(Ue(n),"iterate",bc),n.size},has(n){const s=this.__v_raw,o=Ue(s),a=Ue(n);return r||(ml(n,a)&&ji(o,"has",n),ji(o,"has",a)),n===a?s.has(n):s.has(n)||s.has(a)},forEach(n,s){const o=this,a=o.__v_raw,l=Ue(a),c=t?ow:r?$u:js;return!r&&ji(l,"iterate",bc),a.forEach((h,u)=>n.call(s,c(h),c(u),o))}};return Zi(e,r?{add:h0("add"),set:h0("set"),delete:h0("delete"),clear:h0("clear")}:{add(n){!t&&!zn(n)&&!ca(n)&&(n=Ue(n));const s=Ue(this);return c0(s).has.call(s,n)||(s.add(n),Uo(s,"add",n,n)),this},set(n,s){!t&&!zn(s)&&!ca(s)&&(s=Ue(s));const o=Ue(this),{has:a,get:l}=c0(o);let c=a.call(o,n);c||(n=Ue(n),c=a.call(o,n));const h=l.call(o,n);return o.set(n,s),c?ml(s,h)&&Uo(o,"set",n,s):Uo(o,"add",n,s),this},delete(n){const s=Ue(this),{has:o,get:a}=c0(s);let l=o.call(s,n);l||(n=Ue(n),l=o.call(s,n)),a&&a.call(s,n);const c=s.delete(n);return l&&Uo(s,"delete",n,void 0),c},clear(){const n=Ue(this),s=n.size!==0,o=n.clear();return s&&Uo(n,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=nct(n,r,t)}),e}function nS(r,t){const e=sct(r,t);return(i,n,s)=>n==="__v_isReactive"?!r:n==="__v_isReadonly"?r:n==="__v_raw"?i:Reflect.get(Xe(e,n)&&n in i?e:i,n,s)}const oct={get:nS(!1,!1)},act={get:nS(!1,!0)},lct={get:nS(!0,!1)};const a6=new WeakMap,l6=new WeakMap,c6=new WeakMap,cct=new WeakMap;function hct(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function uct(r){return r.__v_skip||!Object.isExtensible(r)?0:hct(Flt(r))}function sS(r){return ca(r)?r:oS(r,!1,ect,oct,a6)}function dct(r){return oS(r,!1,ict,act,l6)}function aw(r){return oS(r,!0,rct,lct,c6)}function oS(r,t,e,i,n){if(!tr(r)||r.__v_raw&&!(t&&r.__v_isReactive))return r;const s=uct(r);if(s===0)return r;const o=n.get(r);if(o)return o;const a=new Proxy(r,s===2?i:e);return n.set(r,a),a}function kc(r){return ca(r)?kc(r.__v_raw):!!(r&&r.__v_isReactive)}function ca(r){return!!(r&&r.__v_isReadonly)}function zn(r){return!!(r&&r.__v_isShallow)}function Py(r){return r?!!r.__v_raw:!1}function Ue(r){const t=r&&r.__v_raw;return t?Ue(t):r}function gct(r){return!Xe(r,"__v_skip")&&Object.isExtensible(r)&&V8(r,"__v_skip",!0),r}const js=r=>tr(r)?sS(r):r,$u=r=>tr(r)?aw(r):r;function bi(r){return r?r.__v_isRef===!0:!1}function Udt(r){return h6(r,!1)}function fct(r){return h6(r,!0)}function h6(r,t){return bi(r)?r:new pct(r,t)}class pct{constructor(t,e){this.dep=new iS,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Ue(t),this._value=e?t:js(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,i=this.__v_isShallow||zn(t)||ca(t);t=i?t:Ue(t),ml(t,e)&&(this._rawValue=t,this._value=i?t:js(t),this.dep.trigger())}}function u6(r){return bi(r)?r.value:r}const mct={get:(r,t,e)=>t==="__v_raw"?r:u6(Reflect.get(r,t,e)),set:(r,t,e,i)=>{const n=r[t];return bi(n)&&!bi(e)?(n.value=e,!0):Reflect.set(r,t,e,i)}};function d6(r){return kc(r)?r:new Proxy(r,mct)}function Wdt(r){const t=ae(r)?new Array(r.length):{};for(const e in r)t[e]=_ct(r,e);return t}class yct{constructor(t,e,i){this._object=t,this._key=e,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0,this._raw=Ue(t);let n=!0,s=t;if(!ae(t)||!Cy(String(e)))do n=!Py(s)||zn(s);while(n&&(s=s.__v_raw));this._shallow=n}get value(){let t=this._object[this._key];return this._shallow&&(t=u6(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&bi(this._raw[this._key])){const e=this._object[this._key];if(bi(e)){e.value=t;return}}this._object[this._key]=t}get dep(){return Ylt(this._raw,this._key)}}function _ct(r,t,e){return new yct(r,t,e)}class vct{constructor(t,e,i){this.fn=t,this.setter=e,this._value=void 0,this.dep=new iS(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=mf-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&hr!==this)return Q8(this,!0),!0}get value(){const t=this.dep.track();return e6(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function xct(r,t,e=!1){let i,n;return ye(r)?i=r:(i=r.get,n=r.set),new vct(i,n,e)}const u0={},Hm=new WeakMap;let Bl;function wct(r,t=!1,e=Bl){if(e){let i=Hm.get(e);i||Hm.set(e,i=[]),i.push(r)}}function bct(r,t,e=Je){const{immediate:i,deep:n,once:s,scheduler:o,augmentJob:a,call:l}=e,c=v=>n?v:zn(v)||n===!1||n===0?Wo(v,1):Wo(v);let h,u,d,g,f=!1,p=!1;if(bi(r)?(u=()=>r.value,f=zn(r)):kc(r)?(u=()=>c(r),f=!0):ae(r)?(p=!0,f=r.some(v=>kc(v)||zn(v)),u=()=>r.map(v=>{if(bi(v))return v.value;if(kc(v))return c(v);if(ye(v))return l?l(v,2):v()})):ye(r)?t?u=l?()=>l(r,2):r:u=()=>{if(d){aa();try{d()}finally{la()}}const v=Bl;Bl=h;try{return l?l(r,3,[g]):r(g)}finally{Bl=v}}:u=fo,t&&n){const v=u,w=n===!0?1/0:n;u=()=>Wo(v(),w)}const m=Vlt(),y=()=>{h.stop(),m&&m.active&&YE(m.effects,h)};if(s&&t){const v=t;t=(...w)=>{v(...w),y()}}let _=p?new Array(r.length).fill(u0):u0;const x=v=>{if(!(!(h.flags&1)||!h.dirty&&!v))if(t){const w=h.run();if(n||f||(p?w.some((b,E)=>ml(b,_[E])):ml(w,_))){d&&d();const b=Bl;Bl=h;try{const E=[w,_===u0?void 0:p&&_[0]===u0?[]:_,g];_=w,l?l(t,3,E):t(...E)}finally{Bl=b}}}else h.run()};return a&&a(x),h=new X8(u),h.scheduler=o?()=>o(x,!1):x,g=v=>wct(v,!1,h),d=h.onStop=()=>{const v=Hm.get(h);if(v){if(l)l(v,4);else for(const w of v)w();Hm.delete(h)}},t?i?x(!0):_=h.run():o?o(x.bind(null,!0),!0):h.run(),y.pause=h.pause.bind(h),y.resume=h.resume.bind(h),y.stop=y,y}function Wo(r,t=1/0,e){if(t<=0||!tr(r)||r.__v_skip||(e=e||new Map,(e.get(r)||0)>=t))return r;if(e.set(r,t),t--,bi(r))Wo(r.value,t,e);else if(ae(r))for(let i=0;i<r.length;i++)Wo(r[i],t,e);else if(q8(r)||mu(r))r.forEach(i=>{Wo(i,t,e)});else if(W8(r)){for(const i in r)Wo(r[i],t,e);for(const i of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,i)&&Wo(r[i],t,e)}return r}function sp(r,t,e,i){try{return i?r(...i):r()}catch(n){Ay(n,t,e)}}function ha(r,t,e,i){if(ye(r)){const n=sp(r,t,e,i);return n&&B8(n)&&n.catch(s=>{Ay(s,t,e)}),n}if(ae(r)){const n=[];for(let s=0;s<r.length;s++)n.push(ha(r[s],t,e,i));return n}}function Ay(r,t,e,i=!0){const n=t?t.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||Je;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const h=a.ec;if(h){for(let u=0;u<h.length;u++)if(h[u](r,l,c)===!1)return}a=a.parent}if(s){aa(),sp(s,null,10,[r,l,c]),la();return}}kct(r,e,n,i,o)}function kct(r,t,e,i=!0,n=!1){if(n)throw r;console.error(r)}const Qi=[];let Hs=-1;const yu=[];let Wa=null,$h=0;const g6=Promise.resolve();let Ym=null;function Ect(r){const t=Ym||g6;return r?t.then(this?r.bind(this):r):t}function Sct(r){let t=Hs+1,e=Qi.length;for(;t<e;){const i=t+e>>>1,n=Qi[i],s=_f(n);s<r||s===r&&n.flags&2?t=i+1:e=i}return t}function aS(r){if(!(r.flags&1)){const t=_f(r),e=Qi[Qi.length-1];!e||!(r.flags&2)&&t>=_f(e)?Qi.push(r):Qi.splice(Sct(t),0,r),r.flags|=1,f6()}}function f6(){Ym||(Ym=g6.then(m6))}function Tct(r){ae(r)?yu.push(...r):Wa&&r.id===-1?Wa.splice($h+1,0,r):r.flags&1||(yu.push(r),r.flags|=1),f6()}function gM(r,t,e=Hs+1){for(;e<Qi.length;e++){const i=Qi[e];if(i&&i.flags&2){if(r&&i.id!==r.uid)continue;Qi.splice(e,1),e--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function p6(r){if(yu.length){const t=[...new Set(yu)].sort((e,i)=>_f(e)-_f(i));if(yu.length=0,Wa){Wa.push(...t);return}for(Wa=t,$h=0;$h<Wa.length;$h++){const e=Wa[$h];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Wa=null,$h=0}}const _f=r=>r.id==null?r.flags&2?-1:1/0:r.id;function m6(r){try{for(Hs=0;Hs<Qi.length;Hs++){const t=Qi[Hs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),sp(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Hs<Qi.length;Hs++){const t=Qi[Hs];t&&(t.flags&=-2)}Hs=-1,Qi.length=0,p6(),Ym=null,(Qi.length||yu.length)&&m6()}}let Dn=null,y6=null;function Xm(r){const t=Dn;return Dn=r,y6=r&&r.type.__scopeId||null,t}function Cct(r,t=Dn,e){if(!t||r._n)return r;const i=(...n)=>{i._d&&SM(-1);const s=Xm(t);let o;try{o=r(...n)}finally{Xm(s),i._d&&SM(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Vdt(r,t){if(Dn===null)return r;const e=Dy(Dn),i=r.dirs||(r.dirs=[]);for(let n=0;n<t.length;n++){let[s,o,a,l=Je]=t[n];s&&(ye(s)&&(s={mounted:s,updated:s}),s.deep&&Wo(o),i.push({dir:s,instance:e,value:o,oldValue:void 0,arg:a,modifiers:l}))}return r}function Gl(r,t,e,i){const n=r.dirs,s=t&&t.dirs;for(let o=0;o<n.length;o++){const a=n[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(aa(),ha(l,e,8,[r.el,a,r,t]),la())}}function Mct(r,t){if(qi){let e=qi.provides;const i=qi.parent&&qi.parent.provides;i===e&&(e=qi.provides=Object.create(i)),e[r]=t}}function I0(r,t,e=!1){const i=Ny();if(i||Ec){let n=Ec?Ec._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(n&&r in n)return n[r];if(arguments.length>1)return e&&ye(t)?t.call(i&&i.proxy):t}}function Zdt(){return!!(Ny()||Ec)}const Rct=Symbol.for("v-scx"),Ict=()=>I0(Rct);function $v(r,t,e){return _6(r,t,e)}function _6(r,t,e=Je){const{immediate:i,deep:n,flush:s,once:o}=e,a=Zi({},e),l=t&&i||!t&&s!=="post";let c;if(xf){if(s==="sync"){const g=Ict();c=g.__watcherHandles||(g.__watcherHandles=[])}else if(!l){const g=()=>{};return g.stop=fo,g.resume=fo,g.pause=fo,g}}const h=qi;a.call=(g,f,p)=>ha(g,h,f,p);let u=!1;s==="post"?a.scheduler=g=>{hn(g,h&&h.suspense)}:s!=="sync"&&(u=!0,a.scheduler=(g,f)=>{f?g():aS(g)}),a.augmentJob=g=>{t&&(g.flags|=4),u&&(g.flags|=2,h&&(g.id=h.uid,g.i=h))};const d=bct(r,t,a);return xf&&(c?c.push(d):l&&d()),d}function Pct(r,t,e){const i=this.proxy,n=Hi(r)?r.includes(".")?v6(i,r):()=>i[r]:r.bind(i,i);let s;ye(t)?s=t:(s=t.handler,e=t);const o=op(this),a=_6(n,s.bind(i),e);return o(),a}function v6(r,t){const e=t.split(".");return()=>{let i=r;for(let n=0;n<e.length&&i;n++)i=i[e[n]];return i}}const Act=Symbol("_vte"),Lct=r=>r.__isTeleport,Oct=Symbol("_leaveCb");function lS(r,t){r.shapeFlag&6&&r.component?(r.transition=t,lS(r.component.subTree,t)):r.shapeFlag&128?(r.ssContent.transition=t.clone(r.ssContent),r.ssFallback.transition=t.clone(r.ssFallback)):r.transition=t}function Hdt(r,t){return ye(r)?Zi({name:r.name},t,{setup:r}):r}function Ydt(){const r=Ny();return r?(r.appContext.config.idPrefix||"v")+"-"+r.ids[0]+r.ids[1]++:""}function x6(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}function Xdt(r){const t=Ny(),e=fct(null);if(t){const n=t.refs===Je?t.refs={}:t.refs;Object.defineProperty(n,r,{enumerable:!0,get:()=>e.value,set:s=>e.value=s})}return e}function fM(r,t){let e;return!!((e=Object.getOwnPropertyDescriptor(r,t))&&!e.configurable)}const Km=new WeakMap;function _g(r,t,e,i,n=!1){if(ae(r)){r.forEach((p,m)=>_g(p,t&&(ae(t)?t[m]:t),e,i,n));return}if(vg(i)&&!n){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&_g(r,t,e,i.component.subTree);return}const s=i.shapeFlag&4?Dy(i.component):i.el,o=n?null:s,{i:a,r:l}=r,c=t&&t.r,h=a.refs===Je?a.refs={}:a.refs,u=a.setupState,d=Ue(u),g=u===Je?j8:p=>fM(h,p)?!1:Xe(d,p),f=(p,m)=>!(m&&fM(h,m));if(c!=null&&c!==l){if(pM(t),Hi(c))h[c]=null,g(c)&&(u[c]=null);else if(bi(c)){const p=t;f(c,p.k)&&(c.value=null),p.k&&(h[p.k]=null)}}if(ye(l))sp(l,a,12,[o,h]);else{const p=Hi(l),m=bi(l);if(p||m){const y=()=>{if(r.f){const _=p?g(l)?u[l]:h[l]:f()||!r.k?l.value:h[r.k];if(n)ae(_)&&YE(_,s);else if(ae(_))_.includes(s)||_.push(s);else if(p)h[l]=[s],g(l)&&(u[l]=h[l]);else{const x=[s];f(l,r.k)&&(l.value=x),r.k&&(h[r.k]=x)}}else p?(h[l]=o,g(l)&&(u[l]=o)):m&&(f(l,r.k)&&(l.value=o),r.k&&(h[r.k]=o))};if(o){const _=()=>{y(),Km.delete(r)};_.id=-1,Km.set(r,_),hn(_,e)}else pM(r),y()}}}function pM(r){const t=Km.get(r);t&&(t.flags|=8,Km.delete(r))}Ry().requestIdleCallback;Ry().cancelIdleCallback;const vg=r=>!!r.type.__asyncLoader,w6=r=>r.type.__isKeepAlive;function Fct(r,t){b6(r,"a",t)}function Nct(r,t){b6(r,"da",t)}function b6(r,t,e=qi){const i=r.__wdc||(r.__wdc=()=>{let n=e;for(;n;){if(n.isDeactivated)return;n=n.parent}return r()});if(Ly(t,i,e),e){let n=e.parent;for(;n&&n.parent;)w6(n.parent.vnode)&&Dct(i,t,e,n),n=n.parent}}function Dct(r,t,e,i){const n=Ly(t,r,i,!0);k6(()=>{YE(i[t],n)},e)}function Ly(r,t,e=qi,i=!1){if(e){const n=e[r]||(e[r]=[]),s=t.__weh||(t.__weh=(...o)=>{aa();const a=op(e),l=ha(t,e,r,o);return a(),la(),l});return i?n.unshift(s):n.push(s),s}}const va=r=>(t,e=qi)=>{(!xf||r==="sp")&&Ly(r,(...i)=>t(...i),e)},$ct=va("bm"),Gct=va("m"),jct=va("bu"),zct=va("u"),qct=va("bum"),k6=va("um"),Bct=va("sp"),Uct=va("rtg"),Wct=va("rtc");function Vct(r,t=qi){Ly("ec",r,t)}const Zct="components",E6=Symbol.for("v-ndc");function Kdt(r){return Hi(r)?Hct(Zct,r,!1)||r:r||E6}function Hct(r,t,e=!0,i=!1){const n=Dn||qi;if(n){const s=n.type;{const a=Oht(s,!1);if(a&&(a===t||a===ko(t)||a===XE(ko(t))))return s}const o=mM(n[r]||s[r],t)||mM(n.appContext[r],t);return!o&&i?s:o}}function mM(r,t){return r&&(r[t]||r[ko(t)]||r[XE(ko(t))])}function Qdt(r,t,e,i){let n;const s=e,o=ae(r);if(o||Hi(r)){const a=o&&kc(r);let l=!1,c=!1;a&&(l=!zn(r),c=ca(r),r=Iy(r)),n=new Array(r.length);for(let h=0,u=r.length;h<u;h++)n[h]=t(l?c?$u(js(r[h])):js(r[h]):r[h],h,void 0,s)}else if(typeof r=="number"){n=new Array(r);for(let a=0;a<r;a++)n[a]=t(a+1,a,void 0,s)}else if(tr(r))if(r[Symbol.iterator])n=Array.from(r,(a,l)=>t(a,l,void 0,s));else{const a=Object.keys(r);n=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];n[l]=t(r[h],h,l,s)}}else n=[];return n}const lw=r=>r?V6(r)?Dy(r):lw(r.parent):null,xg=Zi(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>lw(r.parent),$root:r=>lw(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>T6(r),$forceUpdate:r=>r.f||(r.f=()=>{aS(r.update)}),$nextTick:r=>r.n||(r.n=Ect.bind(r.proxy)),$watch:r=>Pct.bind(r)}),Gv=(r,t)=>r!==Je&&!r.__isScriptSetup&&Xe(r,t),Yct={get({_:r},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:i,data:n,props:s,accessCache:o,type:a,appContext:l}=r;if(t[0]!=="$"){const d=o[t];if(d!==void 0)switch(d){case 1:return i[t];case 2:return n[t];case 4:return e[t];case 3:return s[t]}else{if(Gv(i,t))return o[t]=1,i[t];if(n!==Je&&Xe(n,t))return o[t]=2,n[t];if(Xe(s,t))return o[t]=3,s[t];if(e!==Je&&Xe(e,t))return o[t]=4,e[t];cw&&(o[t]=0)}}const c=xg[t];let h,u;if(c)return t==="$attrs"&&ji(r.attrs,"get",""),c(r);if((h=a.__cssModules)&&(h=h[t]))return h;if(e!==Je&&Xe(e,t))return o[t]=4,e[t];if(u=l.config.globalProperties,Xe(u,t))return u[t]},set({_:r},t,e){const{data:i,setupState:n,ctx:s}=r;return Gv(n,t)?(n[t]=e,!0):i!==Je&&Xe(i,t)?(i[t]=e,!0):Xe(r.props,t)||t[0]==="$"&&t.slice(1)in r?!1:(s[t]=e,!0)},has({_:{data:r,setupState:t,accessCache:e,ctx:i,appContext:n,props:s,type:o}},a){let l;return!!(e[a]||r!==Je&&a[0]!=="$"&&Xe(r,a)||Gv(t,a)||Xe(s,a)||Xe(i,a)||Xe(xg,a)||Xe(n.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(r,t,e){return e.get!=null?r._.accessCache[t]=0:Xe(e,"value")&&this.set(r,t,e.value,null),Reflect.defineProperty(r,t,e)}};function yM(r){return ae(r)?r.reduce((t,e)=>(t[e]=null,t),{}):r}let cw=!0;function Xct(r){const t=T6(r),e=r.proxy,i=r.ctx;cw=!1,t.beforeCreate&&_M(t.beforeCreate,r,"bc");const{data:n,computed:s,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:u,mounted:d,beforeUpdate:g,updated:f,activated:p,deactivated:m,beforeDestroy:y,beforeUnmount:_,destroyed:x,unmounted:v,render:w,renderTracked:b,renderTriggered:E,errorCaptured:C,serverPrefetch:S,expose:R,inheritAttrs:I,components:F,directives:N,filters:P}=t;if(c&&Kct(c,i,null),o)for(const A in o){const $=o[A];ye($)&&(i[A]=$.bind(e))}if(n){const A=n.call(e,e);tr(A)&&(r.data=sS(A))}if(cw=!0,s)for(const A in s){const $=s[A],z=ye($)?$.bind(e,e):ye($.get)?$.get.bind(e,e):fo,j=!ye($)&&ye($.set)?$.set.bind(e):fo,et=Nht({get:z,set:j});Object.defineProperty(i,A,{enumerable:!0,configurable:!0,get:()=>et.value,set:q=>et.value=q})}if(a)for(const A in a)S6(a[A],i,e,A);if(l){const A=ye(l)?l.call(e):l;Reflect.ownKeys(A).forEach($=>{Mct($,A[$])})}h&&_M(h,r,"c");function D(A,$){ae($)?$.forEach(z=>A(z.bind(e))):$&&A($.bind(e))}if(D($ct,u),D(Gct,d),D(jct,g),D(zct,f),D(Fct,p),D(Nct,m),D(Vct,C),D(Wct,b),D(Uct,E),D(qct,_),D(k6,v),D(Bct,S),ae(R))if(R.length){const A=r.exposed||(r.exposed={});R.forEach($=>{Object.defineProperty(A,$,{get:()=>e[$],set:z=>e[$]=z,enumerable:!0})})}else r.exposed||(r.exposed={});w&&r.render===fo&&(r.render=w),I!=null&&(r.inheritAttrs=I),F&&(r.components=F),N&&(r.directives=N),S&&x6(r)}function Kct(r,t,e=fo){ae(r)&&(r=hw(r));for(const i in r){const n=r[i];let s;tr(n)?"default"in n?s=I0(n.from||i,n.default,!0):s=I0(n.from||i):s=I0(n),bi(s)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):t[i]=s}}function _M(r,t,e){ha(ae(r)?r.map(i=>i.bind(t.proxy)):r.bind(t.proxy),t,e)}function S6(r,t,e,i){let n=i.includes(".")?v6(e,i):()=>e[i];if(Hi(r)){const s=t[r];ye(s)&&$v(n,s)}else if(ye(r))$v(n,r.bind(e));else if(tr(r))if(ae(r))r.forEach(s=>S6(s,t,e,i));else{const s=ye(r.handler)?r.handler.bind(e):t[r.handler];ye(s)&&$v(n,s,r)}}function T6(r){const t=r.type,{mixins:e,extends:i}=t,{mixins:n,optionsCache:s,config:{optionMergeStrategies:o}}=r.appContext,a=s.get(t);let l;return a?l=a:!n.length&&!e&&!i?l=t:(l={},n.length&&n.forEach(c=>Qm(l,c,o,!0)),Qm(l,t,o)),tr(t)&&s.set(t,l),l}function Qm(r,t,e,i=!1){const{mixins:n,extends:s}=t;s&&Qm(r,s,e,!0),n&&n.forEach(o=>Qm(r,o,e,!0));for(const o in t)if(!(i&&o==="expose")){const a=Qct[o]||e&&e[o];r[o]=a?a(r[o],t[o]):t[o]}return r}const Qct={data:vM,props:xM,emits:xM,methods:Hd,computed:Hd,beforeCreate:Yi,created:Yi,beforeMount:Yi,mounted:Yi,beforeUpdate:Yi,updated:Yi,beforeDestroy:Yi,beforeUnmount:Yi,destroyed:Yi,unmounted:Yi,activated:Yi,deactivated:Yi,errorCaptured:Yi,serverPrefetch:Yi,components:Hd,directives:Hd,watch:tht,provide:vM,inject:Jct};function vM(r,t){return t?r?function(){return Zi(ye(r)?r.call(this,this):r,ye(t)?t.call(this,this):t)}:t:r}function Jct(r,t){return Hd(hw(r),hw(t))}function hw(r){if(ae(r)){const t={};for(let e=0;e<r.length;e++)t[r[e]]=r[e];return t}return r}function Yi(r,t){return r?[...new Set([].concat(r,t))]:t}function Hd(r,t){return r?Zi(Object.create(null),r,t):t}function xM(r,t){return r?ae(r)&&ae(t)?[...new Set([...r,...t])]:Zi(Object.create(null),yM(r),yM(t??{})):t}function tht(r,t){if(!r)return t;if(!t)return r;const e=Zi(Object.create(null),r);for(const i in t)e[i]=Yi(r[i],t[i]);return e}function C6(){return{app:null,config:{isNativeTag:j8,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let eht=0;function rht(r,t){return function(i,n=null){ye(i)||(i=Zi({},i)),n!=null&&!tr(n)&&(n=null);const s=C6(),o=new WeakSet,a=[];let l=!1;const c=s.app={_uid:eht++,_component:i,_props:n,_container:null,_context:s,_instance:null,version:Dht,get config(){return s.config},set config(h){},use(h,...u){return o.has(h)||(h&&ye(h.install)?(o.add(h),h.install(c,...u)):ye(h)&&(o.add(h),h(c,...u))),c},mixin(h){return s.mixins.includes(h)||s.mixins.push(h),c},component(h,u){return u?(s.components[h]=u,c):s.components[h]},directive(h,u){return u?(s.directives[h]=u,c):s.directives[h]},mount(h,u,d){if(!l){const g=c._ceVNode||ta(i,n);return g.appContext=s,d===!0?d="svg":d===!1&&(d=void 0),r(g,h,d),l=!0,c._container=h,h.__vue_app__=c,Dy(g.component)}},onUnmount(h){a.push(h)},unmount(){l&&(ha(a,c._instance,16),r(null,c._container),delete c._container.__vue_app__)},provide(h,u){return s.provides[h]=u,c},runWithContext(h){const u=Ec;Ec=c;try{return h()}finally{Ec=u}}};return c}}let Ec=null;const iht=(r,t)=>t==="modelValue"||t==="model-value"?r.modelModifiers:r[`${t}Modifiers`]||r[`${ko(t)}Modifiers`]||r[`${np(t)}Modifiers`];function nht(r,t,...e){if(r.isUnmounted)return;const i=r.vnode.props||Je;let n=e;const s=t.startsWith("update:"),o=s&&iht(i,t.slice(7));o&&(o.trim&&(n=e.map(h=>Hi(h)?h.trim():h)),o.number&&(n=e.map($lt)));let a,l=i[a=Av(t)]||i[a=Av(ko(t))];!l&&s&&(l=i[a=Av(np(t))]),l&&ha(l,r,6,n);const c=i[a+"Once"];if(c){if(!r.emitted)r.emitted={};else if(r.emitted[a])return;r.emitted[a]=!0,ha(c,r,6,n)}}const sht=new WeakMap;function M6(r,t,e=!1){const i=e?sht:t.emitsCache,n=i.get(r);if(n!==void 0)return n;const s=r.emits;let o={},a=!1;if(!ye(r)){const l=c=>{const h=M6(c,t,!0);h&&(a=!0,Zi(o,h))};!e&&t.mixins.length&&t.mixins.forEach(l),r.extends&&l(r.extends),r.mixins&&r.mixins.forEach(l)}return!s&&!a?(tr(r)&&i.set(r,null),null):(ae(s)?s.forEach(l=>o[l]=null):Zi(o,s),tr(r)&&i.set(r,o),o)}function Oy(r,t){return!r||!HE(t)?!1:(t=t.slice(2).replace(/Once$/,""),Xe(r,t[0].toLowerCase()+t.slice(1))||Xe(r,np(t))||Xe(r,t))}function wM(r){const{type:t,vnode:e,proxy:i,withProxy:n,propsOptions:[s],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:u,data:d,setupState:g,ctx:f,inheritAttrs:p}=r,m=Xm(r);let y,_;try{if(e.shapeFlag&4){const v=n||i,w=v;y=Xs(c.call(w,v,h,u,g,d,f)),_=a}else{const v=t;y=Xs(v.length>1?v(u,{attrs:a,slots:o,emit:l}):v(u,null)),_=t.props?a:oht(a)}}catch(v){wg.length=0,Ay(v,r,1),y=ta(El)}let x=y;if(_&&p!==!1){const v=Object.keys(_),{shapeFlag:w}=x;v.length&&w&7&&(s&&v.some(z8)&&(_=aht(_,s)),x=Gu(x,_,!1,!0))}return e.dirs&&(x=Gu(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(e.dirs):e.dirs),e.transition&&lS(x,e.transition),y=x,Xm(m),y}const oht=r=>{let t;for(const e in r)(e==="class"||e==="style"||HE(e))&&((t||(t={}))[e]=r[e]);return t},aht=(r,t)=>{const e={};for(const i in r)(!z8(i)||!(i.slice(9)in t))&&(e[i]=r[i]);return e};function lht(r,t,e){const{props:i,children:n,component:s}=r,{props:o,children:a,patchFlag:l}=t,c=s.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return i?bM(i,o,c):!!o;if(l&8){const h=t.dynamicProps;for(let u=0;u<h.length;u++){const d=h[u];if(R6(o,i,d)&&!Oy(c,d))return!0}}}else return(n||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?bM(i,o,c):!0:!!o;return!1}function bM(r,t,e){const i=Object.keys(t);if(i.length!==Object.keys(r).length)return!0;for(let n=0;n<i.length;n++){const s=i[n];if(R6(t,r,s)&&!Oy(e,s))return!0}return!1}function R6(r,t,e){const i=r[e],n=t[e];return e==="style"&&tr(i)&&tr(n)?!JE(i,n):i!==n}function cht({vnode:r,parent:t},e){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===r&&(i.el=r.el),i===r)(r=t.vnode).el=e,t=t.parent;else break}}const I6={},P6=()=>Object.create(I6),A6=r=>Object.getPrototypeOf(r)===I6;function hht(r,t,e,i=!1){const n={},s=P6();r.propsDefaults=Object.create(null),L6(r,t,n,s);for(const o in r.propsOptions[0])o in n||(n[o]=void 0);e?r.props=i?n:dct(n):r.type.props?r.props=n:r.props=s,r.attrs=s}function uht(r,t,e,i){const{props:n,attrs:s,vnode:{patchFlag:o}}=r,a=Ue(n),[l]=r.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=r.vnode.dynamicProps;for(let u=0;u<h.length;u++){let d=h[u];if(Oy(r.emitsOptions,d))continue;const g=t[d];if(l)if(Xe(s,d))g!==s[d]&&(s[d]=g,c=!0);else{const f=ko(d);n[f]=uw(l,a,f,g,r,!1)}else g!==s[d]&&(s[d]=g,c=!0)}}}else{L6(r,t,n,s)&&(c=!0);let h;for(const u in a)(!t||!Xe(t,u)&&((h=np(u))===u||!Xe(t,h)))&&(l?e&&(e[u]!==void 0||e[h]!==void 0)&&(n[u]=uw(l,a,u,void 0,r,!0)):delete n[u]);if(s!==a)for(const u in s)(!t||!Xe(t,u))&&(delete s[u],c=!0)}c&&Uo(r.attrs,"set","")}function L6(r,t,e,i){const[n,s]=r.propsOptions;let o=!1,a;if(t)for(let l in t){if(pg(l))continue;const c=t[l];let h;n&&Xe(n,h=ko(l))?!s||!s.includes(h)?e[h]=c:(a||(a={}))[h]=c:Oy(r.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(s){const l=Ue(e),c=a||Je;for(let h=0;h<s.length;h++){const u=s[h];e[u]=uw(n,l,u,c[u],r,!Xe(c,u))}}return o}function uw(r,t,e,i,n,s){const o=r[e];if(o!=null){const a=Xe(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&ye(l)){const{propsDefaults:c}=n;if(e in c)i=c[e];else{const h=op(n);i=c[e]=l.call(null,t),h()}}else i=l;n.ce&&n.ce._setProp(e,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===np(e))&&(i=!0))}return i}const dht=new WeakMap;function O6(r,t,e=!1){const i=e?dht:t.propsCache,n=i.get(r);if(n)return n;const s=r.props,o={},a=[];let l=!1;if(!ye(r)){const h=u=>{l=!0;const[d,g]=O6(u,t,!0);Zi(o,d),g&&a.push(...g)};!e&&t.mixins.length&&t.mixins.forEach(h),r.extends&&h(r.extends),r.mixins&&r.mixins.forEach(h)}if(!s&&!l)return tr(r)&&i.set(r,pu),pu;if(ae(s))for(let h=0;h<s.length;h++){const u=ko(s[h]);kM(u)&&(o[u]=Je)}else if(s)for(const h in s){const u=ko(h);if(kM(u)){const d=s[h],g=o[u]=ae(d)||ye(d)?{type:d}:Zi({},d),f=g.type;let p=!1,m=!0;if(ae(f))for(let y=0;y<f.length;++y){const _=f[y],x=ye(_)&&_.name;if(x==="Boolean"){p=!0;break}else x==="String"&&(m=!1)}else p=ye(f)&&f.name==="Boolean";g[0]=p,g[1]=m,(p||Xe(g,"default"))&&a.push(u)}}const c=[o,a];return tr(r)&&i.set(r,c),c}function kM(r){return r[0]!=="$"&&!pg(r)}const cS=r=>r==="_"||r==="_ctx"||r==="$stable",hS=r=>ae(r)?r.map(Xs):[Xs(r)],ght=(r,t,e)=>{if(t._n)return t;const i=Cct((...n)=>hS(t(...n)),e);return i._c=!1,i},F6=(r,t,e)=>{const i=r._ctx;for(const n in r){if(cS(n))continue;const s=r[n];if(ye(s))t[n]=ght(n,s,i);else if(s!=null){const o=hS(s);t[n]=()=>o}}},N6=(r,t)=>{const e=hS(t);r.slots.default=()=>e},D6=(r,t,e)=>{for(const i in t)(e||!cS(i))&&(r[i]=t[i])},fht=(r,t,e)=>{const i=r.slots=P6();if(r.vnode.shapeFlag&32){const n=t._;n?(D6(i,t,e),e&&V8(i,"_",n,!0)):F6(t,i)}else t&&N6(r,t)},pht=(r,t,e)=>{const{vnode:i,slots:n}=r;let s=!0,o=Je;if(i.shapeFlag&32){const a=t._;a?e&&a===1?s=!1:D6(n,t,e):(s=!t.$stable,F6(t,n)),o=t}else t&&(N6(r,t),o={default:1});if(s)for(const a in n)!cS(a)&&o[a]==null&&delete n[a]},hn=vht;function Jdt(r){return mht(r)}function mht(r,t){const e=Ry();e.__VUE__=!0;const{insert:i,remove:n,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:u,nextSibling:d,setScopeId:g=fo,insertStaticContent:f}=r,p=(L,O,U,X=null,W=null,K=null,it=void 0,ot=null,rt=!!O.dynamicChildren)=>{if(L===O)return;L&&!Ad(L,O)&&(X=Et(L),q(L,W,K,!0),L=null),O.patchFlag===-2&&(rt=!1,O.dynamicChildren=null);const{type:H,ref:ut,shapeFlag:mt}=O;switch(H){case Fy:m(L,O,U,X);break;case El:y(L,O,U,X);break;case zv:L==null&&_(O,U,X,it);break;case qo:F(L,O,U,X,W,K,it,ot,rt);break;default:mt&1?w(L,O,U,X,W,K,it,ot,rt):mt&6?N(L,O,U,X,W,K,it,ot,rt):(mt&64||mt&128)&&H.process(L,O,U,X,W,K,it,ot,rt,Y)}ut!=null&&W?_g(ut,L&&L.ref,K,O||L,!O):ut==null&&L&&L.ref!=null&&_g(L.ref,null,K,L,!0)},m=(L,O,U,X)=>{if(L==null)i(O.el=a(O.children),U,X);else{const W=O.el=L.el;O.children!==L.children&&c(W,O.children)}},y=(L,O,U,X)=>{L==null?i(O.el=l(O.children||""),U,X):O.el=L.el},_=(L,O,U,X)=>{[L.el,L.anchor]=f(L.children,O,U,X,L.el,L.anchor)},x=({el:L,anchor:O},U,X)=>{let W;for(;L&&L!==O;)W=d(L),i(L,U,X),L=W;i(O,U,X)},v=({el:L,anchor:O})=>{let U;for(;L&&L!==O;)U=d(L),n(L),L=U;n(O)},w=(L,O,U,X,W,K,it,ot,rt)=>{if(O.type==="svg"?it="svg":O.type==="math"&&(it="mathml"),L==null)b(O,U,X,W,K,it,ot,rt);else{const H=L.el&&L.el._isVueCE?L.el:null;try{H&&H._beginPatch(),S(L,O,W,K,it,ot,rt)}finally{H&&H._endPatch()}}},b=(L,O,U,X,W,K,it,ot)=>{let rt,H;const{props:ut,shapeFlag:mt,transition:dt,dirs:pt}=L;if(rt=L.el=o(L.type,K,ut&&ut.is,ut),mt&8?h(rt,L.children):mt&16&&C(L.children,rt,null,X,W,jv(L,K),it,ot),pt&&Gl(L,null,X,"created"),E(rt,L,L.scopeId,it,X),ut){for(const Dt in ut)Dt!=="value"&&!pg(Dt)&&s(rt,Dt,null,ut[Dt],K,X);"value"in ut&&s(rt,"value",null,ut.value,K),(H=ut.onVnodeBeforeMount)&&Vs(H,X,L)}pt&&Gl(L,null,X,"beforeMount");const kt=yht(W,dt);kt&&dt.beforeEnter(rt),i(rt,O,U),((H=ut&&ut.onVnodeMounted)||kt||pt)&&hn(()=>{H&&Vs(H,X,L),kt&&dt.enter(rt),pt&&Gl(L,null,X,"mounted")},W)},E=(L,O,U,X,W)=>{if(U&&g(L,U),X)for(let K=0;K<X.length;K++)g(L,X[K]);if(W){let K=W.subTree;if(O===K||z6(K.type)&&(K.ssContent===O||K.ssFallback===O)){const it=W.vnode;E(L,it,it.scopeId,it.slotScopeIds,W.parent)}}},C=(L,O,U,X,W,K,it,ot,rt=0)=>{for(let H=rt;H<L.length;H++){const ut=L[H]=ot?Bo(L[H]):Xs(L[H]);p(null,ut,O,U,X,W,K,it,ot)}},S=(L,O,U,X,W,K,it)=>{const ot=O.el=L.el;let{patchFlag:rt,dynamicChildren:H,dirs:ut}=O;rt|=L.patchFlag&16;const mt=L.props||Je,dt=O.props||Je;let pt;if(U&&jl(U,!1),(pt=dt.onVnodeBeforeUpdate)&&Vs(pt,U,O,L),ut&&Gl(O,L,U,"beforeUpdate"),U&&jl(U,!0),(mt.innerHTML&&dt.innerHTML==null||mt.textContent&&dt.textContent==null)&&h(ot,""),H?R(L.dynamicChildren,H,ot,U,X,jv(O,W),K):it||$(L,O,ot,null,U,X,jv(O,W),K,!1),rt>0){if(rt&16)I(ot,mt,dt,U,W);else if(rt&2&&mt.class!==dt.class&&s(ot,"class",null,dt.class,W),rt&4&&s(ot,"style",mt.style,dt.style,W),rt&8){const kt=O.dynamicProps;for(let Dt=0;Dt<kt.length;Dt++){const wt=kt[Dt],zt=mt[wt],Jt=dt[wt];(Jt!==zt||wt==="value")&&s(ot,wt,zt,Jt,W,U)}}rt&1&&L.children!==O.children&&h(ot,O.children)}else!it&&H==null&&I(ot,mt,dt,U,W);((pt=dt.onVnodeUpdated)||ut)&&hn(()=>{pt&&Vs(pt,U,O,L),ut&&Gl(O,L,U,"updated")},X)},R=(L,O,U,X,W,K,it)=>{for(let ot=0;ot<O.length;ot++){const rt=L[ot],H=O[ot],ut=rt.el&&(rt.type===qo||!Ad(rt,H)||rt.shapeFlag&198)?u(rt.el):U;p(rt,H,ut,null,X,W,K,it,!0)}},I=(L,O,U,X,W)=>{if(O!==U){if(O!==Je)for(const K in O)!pg(K)&&!(K in U)&&s(L,K,O[K],null,W,X);for(const K in U){if(pg(K))continue;const it=U[K],ot=O[K];it!==ot&&K!=="value"&&s(L,K,ot,it,W,X)}"value"in U&&s(L,"value",O.value,U.value,W)}},F=(L,O,U,X,W,K,it,ot,rt)=>{const H=O.el=L?L.el:a(""),ut=O.anchor=L?L.anchor:a("");let{patchFlag:mt,dynamicChildren:dt,slotScopeIds:pt}=O;pt&&(ot=ot?ot.concat(pt):pt),L==null?(i(H,U,X),i(ut,U,X),C(O.children||[],U,ut,W,K,it,ot,rt)):mt>0&&mt&64&&dt&&L.dynamicChildren&&L.dynamicChildren.length===dt.length?(R(L.dynamicChildren,dt,U,W,K,it,ot),(O.key!=null||W&&O===W.subTree)&&$6(L,O,!0)):$(L,O,U,ut,W,K,it,ot,rt)},N=(L,O,U,X,W,K,it,ot,rt)=>{O.slotScopeIds=ot,L==null?O.shapeFlag&512?W.ctx.activate(O,U,X,it,rt):P(O,U,X,W,K,it,rt):T(L,O,rt)},P=(L,O,U,X,W,K,it)=>{const ot=L.component=Rht(L,X,W);if(w6(L)&&(ot.ctx.renderer=Y),Iht(ot,!1,it),ot.asyncDep){if(W&&W.registerDep(ot,D,it),!L.el){const rt=ot.subTree=ta(El);y(null,rt,O,U),L.placeholder=rt.el}}else D(ot,L,O,U,W,K,it)},T=(L,O,U)=>{const X=O.component=L.component;if(lht(L,O,U))if(X.asyncDep&&!X.asyncResolved){A(X,O,U);return}else X.next=O,X.update();else O.el=L.el,X.vnode=O},D=(L,O,U,X,W,K,it)=>{const ot=()=>{if(L.isMounted){let{next:mt,bu:dt,u:pt,parent:kt,vnode:Dt}=L;{const Ce=G6(L);if(Ce){mt&&(mt.el=Dt.el,A(L,mt,it)),Ce.asyncDep.then(()=>{hn(()=>{L.isUnmounted||H()},W)});return}}let wt=mt,zt;jl(L,!1),mt?(mt.el=Dt.el,A(L,mt,it)):mt=Dt,dt&&Lv(dt),(zt=mt.props&&mt.props.onVnodeBeforeUpdate)&&Vs(zt,kt,mt,Dt),jl(L,!0);const Jt=wM(L),ve=L.subTree;L.subTree=Jt,p(ve,Jt,u(ve.el),Et(ve),L,W,K),mt.el=Jt.el,wt===null&&cht(L,Jt.el),pt&&hn(pt,W),(zt=mt.props&&mt.props.onVnodeUpdated)&&hn(()=>Vs(zt,kt,mt,Dt),W)}else{let mt;const{el:dt,props:pt}=O,{bm:kt,m:Dt,parent:wt,root:zt,type:Jt}=L,ve=vg(O);jl(L,!1),kt&&Lv(kt),!ve&&(mt=pt&&pt.onVnodeBeforeMount)&&Vs(mt,wt,O),jl(L,!0);{zt.ce&&zt.ce._hasShadowRoot()&&zt.ce._injectChildStyle(Jt);const Ce=L.subTree=wM(L);p(null,Ce,U,X,L,W,K),O.el=Ce.el}if(Dt&&hn(Dt,W),!ve&&(mt=pt&&pt.onVnodeMounted)){const Ce=O;hn(()=>Vs(mt,wt,Ce),W)}(O.shapeFlag&256||wt&&vg(wt.vnode)&&wt.vnode.shapeFlag&256)&&L.a&&hn(L.a,W),L.isMounted=!0,O=U=X=null}};L.scope.on();const rt=L.effect=new X8(ot);L.scope.off();const H=L.update=rt.run.bind(rt),ut=L.job=rt.runIfDirty.bind(rt);ut.i=L,ut.id=L.uid,rt.scheduler=()=>aS(ut),jl(L,!0),H()},A=(L,O,U)=>{O.component=L;const X=L.vnode.props;L.vnode=O,L.next=null,uht(L,O.props,X,U),pht(L,O.children,U),aa(),gM(L),la()},$=(L,O,U,X,W,K,it,ot,rt=!1)=>{const H=L&&L.children,ut=L?L.shapeFlag:0,mt=O.children,{patchFlag:dt,shapeFlag:pt}=O;if(dt>0){if(dt&128){j(H,mt,U,X,W,K,it,ot,rt);return}else if(dt&256){z(H,mt,U,X,W,K,it,ot,rt);return}}pt&8?(ut&16&&It(H,W,K),mt!==H&&h(U,mt)):ut&16?pt&16?j(H,mt,U,X,W,K,it,ot,rt):It(H,W,K,!0):(ut&8&&h(U,""),pt&16&&C(mt,U,X,W,K,it,ot,rt))},z=(L,O,U,X,W,K,it,ot,rt)=>{L=L||pu,O=O||pu;const H=L.length,ut=O.length,mt=Math.min(H,ut);let dt;for(dt=0;dt<mt;dt++){const pt=O[dt]=rt?Bo(O[dt]):Xs(O[dt]);p(L[dt],pt,U,null,W,K,it,ot,rt)}H>ut?It(L,W,K,!0,!1,mt):C(O,U,X,W,K,it,ot,rt,mt)},j=(L,O,U,X,W,K,it,ot,rt)=>{let H=0;const ut=O.length;let mt=L.length-1,dt=ut-1;for(;H<=mt&&H<=dt;){const pt=L[H],kt=O[H]=rt?Bo(O[H]):Xs(O[H]);if(Ad(pt,kt))p(pt,kt,U,null,W,K,it,ot,rt);else break;H++}for(;H<=mt&&H<=dt;){const pt=L[mt],kt=O[dt]=rt?Bo(O[dt]):Xs(O[dt]);if(Ad(pt,kt))p(pt,kt,U,null,W,K,it,ot,rt);else break;mt--,dt--}if(H>mt){if(H<=dt){const pt=dt+1,kt=pt<ut?O[pt].el:X;for(;H<=dt;)p(null,O[H]=rt?Bo(O[H]):Xs(O[H]),U,kt,W,K,it,ot,rt),H++}}else if(H>dt)for(;H<=mt;)q(L[H],W,K,!0),H++;else{const pt=H,kt=H,Dt=new Map;for(H=kt;H<=dt;H++){const Pe=O[H]=rt?Bo(O[H]):Xs(O[H]);Pe.key!=null&&Dt.set(Pe.key,H)}let wt,zt=0;const Jt=dt-kt+1;let ve=!1,Ce=0;const Ve=new Array(Jt);for(H=0;H<Jt;H++)Ve[H]=0;for(H=pt;H<=mt;H++){const Pe=L[H];if(zt>=Jt){q(Pe,W,K,!0);continue}let le;if(Pe.key!=null)le=Dt.get(Pe.key);else for(wt=kt;wt<=dt;wt++)if(Ve[wt-kt]===0&&Ad(Pe,O[wt])){le=wt;break}le===void 0?q(Pe,W,K,!0):(Ve[le-kt]=H+1,le>=Ce?Ce=le:ve=!0,p(Pe,O[le],U,null,W,K,it,ot,rt),zt++)}const qr=ve?_ht(Ve):pu;for(wt=qr.length-1,H=Jt-1;H>=0;H--){const Pe=kt+H,le=O[Pe],Cr=O[Pe+1],er=Pe+1<ut?Cr.el||j6(Cr):X;Ve[H]===0?p(null,le,U,er,W,K,it,ot,rt):ve&&(wt<0||H!==qr[wt]?et(le,U,er,2):wt--)}}},et=(L,O,U,X,W=null)=>{const{el:K,type:it,transition:ot,children:rt,shapeFlag:H}=L;if(H&6){et(L.component.subTree,O,U,X);return}if(H&128){L.suspense.move(O,U,X);return}if(H&64){it.move(L,O,U,Y);return}if(it===qo){i(K,O,U);for(let mt=0;mt<rt.length;mt++)et(rt[mt],O,U,X);i(L.anchor,O,U);return}if(it===zv){x(L,O,U);return}if(X!==2&&H&1&&ot)if(X===0)ot.beforeEnter(K),i(K,O,U),hn(()=>ot.enter(K),W);else{const{leave:mt,delayLeave:dt,afterLeave:pt}=ot,kt=()=>{L.ctx.isUnmounted?n(K):i(K,O,U)},Dt=()=>{K._isLeaving&&K[Oct](!0),mt(K,()=>{kt(),pt&&pt()})};dt?dt(K,kt,Dt):Dt()}else i(K,O,U)},q=(L,O,U,X=!1,W=!1)=>{const{type:K,props:it,ref:ot,children:rt,dynamicChildren:H,shapeFlag:ut,patchFlag:mt,dirs:dt,cacheIndex:pt}=L;if(mt===-2&&(W=!1),ot!=null&&(aa(),_g(ot,null,U,L,!0),la()),pt!=null&&(O.renderCache[pt]=void 0),ut&256){O.ctx.deactivate(L);return}const kt=ut&1&&dt,Dt=!vg(L);let wt;if(Dt&&(wt=it&&it.onVnodeBeforeUnmount)&&Vs(wt,O,L),ut&6)V(L.component,U,X);else{if(ut&128){L.suspense.unmount(U,X);return}kt&&Gl(L,null,O,"beforeUnmount"),ut&64?L.type.remove(L,O,U,Y,X):H&&!H.hasOnce&&(K!==qo||mt>0&&mt&64)?It(H,O,U,!1,!0):(K===qo&&mt&384||!W&&ut&16)&&It(rt,O,U),X&&vt(L)}(Dt&&(wt=it&&it.onVnodeUnmounted)||kt)&&hn(()=>{wt&&Vs(wt,O,L),kt&&Gl(L,null,O,"unmounted")},U)},vt=L=>{const{type:O,el:U,anchor:X,transition:W}=L;if(O===qo){jt(U,X);return}if(O===zv){v(L);return}const K=()=>{n(U),W&&!W.persisted&&W.afterLeave&&W.afterLeave()};if(L.shapeFlag&1&&W&&!W.persisted){const{leave:it,delayLeave:ot}=W,rt=()=>it(U,K);ot?ot(L.el,K,rt):rt()}else K()},jt=(L,O)=>{let U;for(;L!==O;)U=d(L),n(L),L=U;n(O)},V=(L,O,U)=>{const{bum:X,scope:W,job:K,subTree:it,um:ot,m:rt,a:H}=L;EM(rt),EM(H),X&&Lv(X),W.stop(),K&&(K.flags|=8,q(it,L,O,U)),ot&&hn(ot,O),hn(()=>{L.isUnmounted=!0},O)},It=(L,O,U,X=!1,W=!1,K=0)=>{for(let it=K;it<L.length;it++)q(L[it],O,U,X,W)},Et=L=>{if(L.shapeFlag&6)return Et(L.component.subTree);if(L.shapeFlag&128)return L.suspense.next();const O=d(L.anchor||L.el),U=O&&O[Act];return U?d(U):O};let Mt=!1;const Ot=(L,O,U)=>{let X;L==null?O._vnode&&(q(O._vnode,null,null,!0),X=O._vnode.component):p(O._vnode||null,L,O,null,null,null,U),O._vnode=L,Mt||(Mt=!0,gM(X),p6(),Mt=!1)},Y={p,um:q,m:et,r:vt,mt:P,mc:C,pc:$,pbc:R,n:Et,o:r};return{render:Ot,hydrate:void 0,createApp:rht(Ot)}}function jv({type:r,props:t},e){return e==="svg"&&r==="foreignObject"||e==="mathml"&&r==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function jl({effect:r,job:t},e){e?(r.flags|=32,t.flags|=4):(r.flags&=-33,t.flags&=-5)}function yht(r,t){return(!r||r&&!r.pendingBranch)&&t&&!t.persisted}function $6(r,t,e=!1){const i=r.children,n=t.children;if(ae(i)&&ae(n))for(let s=0;s<i.length;s++){const o=i[s];let a=n[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=n[s]=Bo(n[s]),a.el=o.el),!e&&a.patchFlag!==-2&&$6(o,a)),a.type===Fy&&(a.patchFlag===-1&&(a=n[s]=Bo(a)),a.el=o.el),a.type===El&&!a.el&&(a.el=o.el)}}function _ht(r){const t=r.slice(),e=[0];let i,n,s,o,a;const l=r.length;for(i=0;i<l;i++){const c=r[i];if(c!==0){if(n=e[e.length-1],r[n]<c){t[i]=n,e.push(i);continue}for(s=0,o=e.length-1;s<o;)a=s+o>>1,r[e[a]]<c?s=a+1:o=a;c<r[e[s]]&&(s>0&&(t[i]=e[s-1]),e[s]=i)}}for(s=e.length,o=e[s-1];s-- >0;)e[s]=o,o=t[o];return e}function G6(r){const t=r.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:G6(t)}function EM(r){if(r)for(let t=0;t<r.length;t++)r[t].flags|=8}function j6(r){if(r.placeholder)return r.placeholder;const t=r.component;return t?j6(t.subTree):null}const z6=r=>r.__isSuspense;function vht(r,t){t&&t.pendingBranch?ae(r)?t.effects.push(...r):t.effects.push(r):Tct(r)}const qo=Symbol.for("v-fgt"),Fy=Symbol.for("v-txt"),El=Symbol.for("v-cmt"),zv=Symbol.for("v-stc"),wg=[];let $n=null;function xht(r=!1){wg.push($n=r?null:[])}function wht(){wg.pop(),$n=wg[wg.length-1]||null}let vf=1;function SM(r,t=!1){vf+=r,r<0&&$n&&t&&($n.hasOnce=!0)}function q6(r){return r.dynamicChildren=vf>0?$n||pu:null,wht(),vf>0&&$n&&$n.push(r),r}function tgt(r,t,e,i,n,s){return q6(W6(r,t,e,i,n,s,!0))}function bht(r,t,e,i,n){return q6(ta(r,t,e,i,n,!0))}function B6(r){return r?r.__v_isVNode===!0:!1}function Ad(r,t){return r.type===t.type&&r.key===t.key}const U6=({key:r})=>r??null,P0=({ref:r,ref_key:t,ref_for:e})=>(typeof r=="number"&&(r=""+r),r!=null?Hi(r)||bi(r)||ye(r)?{i:Dn,r,k:t,f:!!e}:r:null);function W6(r,t=null,e=null,i=0,n=null,s=r===qo?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:r,props:t,key:t&&U6(t),ref:t&&P0(t),scopeId:y6,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Dn};return a?(uS(l,e),s&128&&r.normalize(l)):e&&(l.shapeFlag|=Hi(e)?8:16),vf>0&&!o&&$n&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&$n.push(l),l}const ta=kht;function kht(r,t=null,e=null,i=0,n=null,s=!1){if((!r||r===E6)&&(r=El),B6(r)){const a=Gu(r,t,!0);return e&&uS(a,e),vf>0&&!s&&$n&&(a.shapeFlag&6?$n[$n.indexOf(r)]=a:$n.push(a)),a.patchFlag=-2,a}if(Fht(r)&&(r=r.__vccOpts),t){t=Eht(t);let{class:a,style:l}=t;a&&!Hi(a)&&(t.class=QE(a)),tr(l)&&(Py(l)&&!ae(l)&&(l=Zi({},l)),t.style=KE(l))}const o=Hi(r)?1:z6(r)?128:Lct(r)?64:tr(r)?4:ye(r)?2:0;return W6(r,t,e,i,n,o,s,!0)}function Eht(r){return r?Py(r)||A6(r)?Zi({},r):r:null}function Gu(r,t,e=!1,i=!1){const{props:n,ref:s,patchFlag:o,children:a,transition:l}=r,c=t?Tht(n||{},t):n,h={__v_isVNode:!0,__v_skip:!0,type:r.type,props:c,key:c&&U6(c),ref:t&&t.ref?e&&s?ae(s)?s.concat(P0(t)):[s,P0(t)]:P0(t):s,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:a,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:t&&r.type!==qo?o===-1?16:o|16:o,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:l,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Gu(r.ssContent),ssFallback:r.ssFallback&&Gu(r.ssFallback),placeholder:r.placeholder,el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return l&&i&&lS(h,l.clone(h)),h}function Sht(r=" ",t=0){return ta(Fy,null,r,t)}function egt(r="",t=!1){return t?(xht(),bht(El,null,r)):ta(El,null,r)}function Xs(r){return r==null||typeof r=="boolean"?ta(El):ae(r)?ta(qo,null,r.slice()):B6(r)?Bo(r):ta(Fy,null,String(r))}function Bo(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:Gu(r)}function uS(r,t){let e=0;const{shapeFlag:i}=r;if(t==null)t=null;else if(ae(t))e=16;else if(typeof t=="object")if(i&65){const n=t.default;n&&(n._c&&(n._d=!1),uS(r,n()),n._c&&(n._d=!0));return}else{e=32;const n=t._;!n&&!A6(t)?t._ctx=Dn:n===3&&Dn&&(Dn.slots._===1?t._=1:(t._=2,r.patchFlag|=1024))}else ye(t)?(t={default:t,_ctx:Dn},e=32):(t=String(t),i&64?(e=16,t=[Sht(t)]):e=8);r.children=t,r.shapeFlag|=e}function Tht(...r){const t={};for(let e=0;e<r.length;e++){const i=r[e];for(const n in i)if(n==="class")t.class!==i.class&&(t.class=QE([t.class,i.class]));else if(n==="style")t.style=KE([t.style,i.style]);else if(HE(n)){const s=t[n],o=i[n];o&&s!==o&&!(ae(s)&&s.includes(o))&&(t[n]=s?[].concat(s,o):o)}else n!==""&&(t[n]=i[n])}return t}function Vs(r,t,e,i=null){ha(r,t,7,[e,i])}const Cht=C6();let Mht=0;function Rht(r,t,e){const i=r.type,n=(t?t.appContext:r.appContext)||Cht,s={uid:Mht++,vnode:r,type:i,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Y8(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:O6(i,n),emitsOptions:M6(i,n),emit:null,emitted:null,propsDefaults:Je,inheritAttrs:i.inheritAttrs,ctx:Je,data:Je,props:Je,attrs:Je,slots:Je,refs:Je,setupState:Je,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=nht.bind(null,s),r.ce&&r.ce(s),s}let qi=null;const Ny=()=>qi||Dn;let Jm,dw;{const r=Ry(),t=(e,i)=>{let n;return(n=r[e])||(n=r[e]=[]),n.push(i),s=>{n.length>1?n.forEach(o=>o(s)):n[0](s)}};Jm=t("__VUE_INSTANCE_SETTERS__",e=>qi=e),dw=t("__VUE_SSR_SETTERS__",e=>xf=e)}const op=r=>{const t=qi;return Jm(r),r.scope.on(),()=>{r.scope.off(),Jm(t)}},TM=()=>{qi&&qi.scope.off(),Jm(null)};function V6(r){return r.vnode.shapeFlag&4}let xf=!1;function Iht(r,t=!1,e=!1){t&&dw(t);const{props:i,children:n}=r.vnode,s=V6(r);hht(r,i,s,t),fht(r,n,e||t);const o=s?Pht(r,t):void 0;return t&&dw(!1),o}function Pht(r,t){const e=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,Yct);const{setup:i}=e;if(i){aa();const n=r.setupContext=i.length>1?Lht(r):null,s=op(r),o=sp(i,r,0,[r.props,n]),a=B8(o);if(la(),s(),(a||r.sp)&&!vg(r)&&x6(r),a){if(o.then(TM,TM),t)return o.then(l=>{CM(r,l)}).catch(l=>{Ay(l,r,0)});r.asyncDep=o}else CM(r,o)}else Z6(r)}function CM(r,t,e){ye(t)?r.type.__ssrInlineRender?r.ssrRender=t:r.render=t:tr(t)&&(r.setupState=d6(t)),Z6(r)}function Z6(r,t,e){const i=r.type;r.render||(r.render=i.render||fo);{const n=op(r);aa();try{Xct(r)}finally{la(),n()}}}const Aht={get(r,t){return ji(r,"get",""),r[t]}};function Lht(r){const t=e=>{r.exposed=e||{}};return{attrs:new Proxy(r.attrs,Aht),slots:r.slots,emit:r.emit,expose:t}}function Dy(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy(d6(gct(r.exposed)),{get(t,e){if(e in t)return t[e];if(e in xg)return xg[e](r)},has(t,e){return e in t||e in xg}})):r.proxy}function Oht(r,t=!0){return ye(r)?r.displayName||r.name:r.name||t&&r.__name}function Fht(r){return ye(r)&&"__vccOpts"in r}const Nht=(r,t)=>xct(r,t,xf),Dht="3.5.28";export{qs as $,Ndt as A,qE as B,Ddt as C,Pdt as D,Odt as E,$dt as F,ye as G,Vit as H,Jdt as I,Gdt as J,Hi as K,Zi as L,ls as M,HE as N,z8 as O,B1 as P,jdt as Q,ko as R,on as S,ao as T,zi as U,zdt as V,EU as W,oa as X,Wit as Y,ae as Z,Vr as _,wV as a,np as a0,XE as a1,ha as a2,JE as a3,Lv as a4,qdt as a5,Udt as a6,gct as a7,I0 as a8,Zdt as a9,sS as aa,bi as ab,kc as ac,Ue as ad,Vlt as ae,Bdt as af,Ect as ag,Wdt as ah,Nht as ai,$v as aj,Xdt as ak,xdt as al,qo as am,egt as an,QE as ao,Wlt as ap,u6 as aq,Ydt as ar,Qdt as as,Vdt as at,bht as au,Sht as av,Kdt as aw,Hit as ax,ee as b,Sc as c,Pi as d,Kht as e,nP as f,Hdt as g,LE as h,tgt as i,so as j,o2 as k,xht as l,Yst as m,W6 as n,Tf as o,vdt as p,wdt as q,zs as r,gr as s,l8 as t,bdt as u,fs as v,kdt as w,Idt as x,Rdt as y,ts as z};
