const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./pinia-BhmAVTvm-Dvvq2Cue.js","./vue.runtime.esm-bundler-APnTtYuL-TgjA0Nnx.js","./store-C5OS7H-y.js","./index-DIHDkKBB-DoYV-2cU.js","./reverseGeocode-CR3Bbmu1-DNBqHopz.js","./indicateLoading-BDKoxTDd-CXoezeA8.js"])))=>i.map(i=>d[i]);
import{a2 as z,a3 as gn,a4 as pn,a5 as fn,a6 as We,a7 as ce,a8 as _t,a9 as mn,aa as Ye,ab as yn,ac as wr,ad as Fe,ae as je,af as ne,ag as _n,ah as lt,ai as Be,aj as vn,ak as Cr,al as bn,am as dt,an as xn,ao as kn,ap as wn,aq as Cn,ar as Sn,as as En,at as Tn,au as qe,av as O,aw as x,ax as It,ay as A,az as Sr,aA as U,aB as xe,aC as jt,aD as J,aE as de,aF as V,aG as Bt,aH as Ln,aI as vt,aJ as $n,aK as In,aL as An,aM as Fn,aN as Pn,aO as Er,aP as ct,aQ as Vt,aR as He,aS as Ee,aT as re,aU as ke,aV as Rn,aW as qt,aX as Te,aY as Tr,aZ as j,a_ as Mn,a$ as ut,b0 as Dn,b1 as Ut,b2 as te,b3 as On,b4 as X,b5 as we,b6 as Ve,b7 as ir,b8 as Lr,b9 as Kt,ba as Xt,bb as Nn,bc as Gn,bd as Bn,be as or,bf as At,bg as oe,bh as $r,bi as ht,bj as Vn,bk as Un,bl as zn,bm as Hn,bn as Wn,bo as jn,bp as Jt,bq as lr,br as qn,bs as Kn,bt as Xn,bu as Jn,bv as Yn,bw as Qn,bx as Zn,by as ea,bz as Ir,bA as ta,bB as ra,bC as Me,bD as na,F as bt,H as xt,I as kt,L as ot,bE as aa,bF as sa,bG as pe,bH as ia,R as Yt,J as oa,bI as Ar,U as Fr,T as Pr,$ as la,S as da}from"./runtime-core.esm-bundler-Dm4ZnaXF.js";import{defineComponent as H,createElementBlock as E,openBlock as b,createElementVNode as I,renderSlot as Qt,computed as L,ref as P,createBlock as M,unref as _,withCtx as he,createVNode as $e,createCommentVNode as W,withDirectives as Zt,withKeys as me,withModifiers as ve,isRef as gt,vModelText as ca,toDisplayString as ae,normalizeClass as Ie,nextTick as pt,vModelSelect as ua,Fragment as K,renderList as Q,watch as Ae,toRaw as ha,resolveDynamicComponent as ft,normalizeStyle as ga,markRaw as dr,onMounted as pa,mergeModels as fa,useModel as ma,vModelDynamic as ya}from"./vue.runtime.esm-bundler-APnTtYuL-TgjA0Nnx.js";import{defineStore as be,storeToRefs as ue}from"./pinia-BhmAVTvm-Dvvq2Cue.js";import{R as B,h as Z,f as le,v as Oe}from"./index-DIHDkKBB-DoYV-2cU.js";import{X as cr}from"./store-C5OS7H-y.js";import{indicateLoading as _a}from"./indicateLoading-BDKoxTDd-CXoezeA8.js";import{reverseGeocode as va}from"./reverseGeocode-CR3Bbmu1-DNBqHopz.js";const ba={class:"kern-card kern-card--small"},xa={class:"kern-card__container"},ka=H({__name:"PolarCard.ce",setup(n){return(e,t)=>(b(),E("article",ba,[I("div",xa,[Qt(e.$slots,"default",{},void 0,!0)])]))}}),wa=".kern-card{&[data-v-937e165b]{height:auto;min-width:25rem;border-radius:var(--kern-metric-border-radius-large);box-shadow:var(--polar-shadow)}.kern-card__container[data-v-937e165b]{padding:var(--kern-metric-space-small);padding-bottom:.625rem}}",wt=z(ka,[["styles",[wa]],["__scopeId","data-v-937e165b"]]);function Ca(n){const e=n.map(parseFloat),t=[];for(;e.length;)t.push(e.splice(0,2));return t}function Sa(n,e,t={}){n.getView().fit(e,t)}function Ea(n,e,t={}){let r;switch(e.geometry.type){case"Polygon":r=new _t([Ca(e.geometry.coordinates)]);break;case"Point":r=new ce(e.geometry.coordinates.map(parseFloat));break;default:console.warn(`ZoomTo for type ${e.geometry.type} not implemented.`);return}Sa(n,r,t)}const F={STREET:"street",DISTRICT:"district",PARCEL:"parcel",STREET_KEY:"streetKey",ADDRESS_AFFIXED:"addressAffixed",ADDRESS_UNAFFIXED:"addressUnaffixed",HOUSE_NUMBERS_FOR_STREET:"houseNumbersForStreet"};function Rr(n){return Array.isArray(n)&&n.length===1?Rr(n[0]):n}function mt(n,e){return Array.isArray(n)?n.map(t=>mt(t,e)).filter(t=>t)[0]:typeof n!="object"?null:typeof n[e]<"u"?n[e]:Object.keys(n).map(t=>mt(n[t],e)).filter(t=>t)[0]}function Ta(n){const e={objectType:Object.keys(n)[0]};return Object.keys(n[e.objectType][0]).forEach(t=>{e[t]=Rr(n[e.objectType][0][t])}),e}function La(n){let e=[];return n.startsWith("POINT")&&(e=n.split(")")[0]?.split("(")[1]),e}function $a(n,e){const t={type:e,properties:Ta(n)};let r=t.properties?.pos?La(t.properties.pos):mt(t.properties,"pos")[0],a="",s="",i="";switch(e){case F.DISTRICT:t.name=t.properties.geographicIdentifier?._?t.properties.geographicIdentifier._:t.properties.geographicIdentifier;break;case F.STREET_KEY:case F.STREET:t.properties?.position_strassenachse&&(r=mt(t.properties?.position_strassenachse,"pos")[0]),t.name=Ye()?t.properties.geographicIdentifier._:t.properties.strassenname;break;case F.PARCEL:t.name=`${t.properties.gemarkung}/${t.properties.flurstuecksnummer}`;break;case F.HOUSE_NUMBERS_FOR_STREET:a=t.properties.hausnummer?._?t.properties.hausnummer._:t.properties.hausnummer,t.properties.hausnummernzusatz&&(s=t.properties.hausnummernzusatz?._?t.properties.hausnummernzusatz._:t.properties.hausnummernzusatz),t.properties.hausnummerkomplett=`${a}${s}`,t.name=Ye()?t.properties.geographicIdentifier._:(t.properties?.geographicIdentifier?t.properties.geographicIdentifier._.split(t.properties.hausnummerkomplett)[0]:t.properties.strassenname+" ")+t.properties.hausnummerkomplett;break;case F.ADDRESS_AFFIXED:i=t.properties.strassenname?._?t.properties.strassenname._:t.properties.strassenname,a=t.properties.hausnummer?._?t.properties.hausnummer._:t.properties.hausnummer,s=t.properties.hausnummernzusatz?._?t.properties.hausnummernzusatz._:t.properties.hausnummernzusatz,t.name=Ye()?t.properties.geographicIdentifier._:`${i} ${a}${s}`;break;case F.ADDRESS_UNAFFIXED:i=t.properties.strassenname?._?t.properties.strassenname._:t.properties.strassenname,a=t.properties.hausnummer?._?t.properties.hausnummer._:t.properties.hausnummer,t.name=Ye()?t.properties.geographicIdentifier._:(t.properties?.geographicIdentifier?t.properties.geographicIdentifier._.split(a)[0]:i+" ")+a;break;default:t.name=null,console.error(`Unknown type in searchAddress.parse: '${e}'. Could not set name.`);break}switch(e){case F.DISTRICT:case F.STREET_KEY:case F.STREET:case F.PARCEL:case F.HOUSE_NUMBERS_FOR_STREET:case F.ADDRESS_AFFIXED:case F.ADDRESS_UNAFFIXED:t.geometry={type:"Point",coordinates:r.split(" ")};break;default:t.geometry=null,console.error(`Unknown type in searchAddress.parse: '${e}'. Could not set geometry.`);break}return t}function Mr(n,e){return new Promise((t,r)=>{cr.parseString(e,{tagNameProcessors:[cr.processors.stripPrefix]},(a,s)=>{if(a){r(a);return}try{const i=s.FeatureCollection?.member?s.FeatureCollection.member.map(o=>$a(o,n)).sort((o,l)=>o.name.localeCompare(l.name)):[];t(i)}catch(i){r(i)}})})}function Ia(n){return Array.isArray(n)?n.map(encodeURIComponent):encodeURIComponent(n)}function Aa(n,e,t=!0){return{[F.STREET]:r=>t?`&StoredQuery_ID=findeStrasse&strassenname=*${r}`:`&StoredQuery_ID=findeStrasse&strassenname=${r}`,[F.DISTRICT]:r=>`&StoredQuery_ID=findeStadtteil&stadtteilname=${r}`,[F.PARCEL]:r=>`&StoredQuery_ID=Flurstueck&gemarkung=${r[0]}&flurstuecksnummer=${r[1]}`,[F.STREET_KEY]:r=>`&StoredQuery_ID=findeStrassenSchluessel&strassenschluessel=${r}`,[F.ADDRESS_AFFIXED]:r=>`&StoredQuery_ID=AdresseMitZusatz&strassenname=${r[0]}&hausnummer=${r[1]}&zusatz=${r[2]}`,[F.ADDRESS_UNAFFIXED]:r=>`&StoredQuery_ID=AdresseOhneZusatz&strassenname=${r[0]}&hausnummer=${r[1]}`,[F.HOUSE_NUMBERS_FOR_STREET]:r=>`&StoredQuery_ID=HausnummernZuStrasse&strassenname=${r}`}[n](Ia(e))}function Dr(n,e,t,r){return new Promise((a,s)=>{const i=mn()+Aa(n,e,r);fetch(i,{signal:t?.signal,timeout:6e3}).then(o=>a(o.text())).catch(o=>s(o))})}let Ue=null;function Ce(n,e,t=(s,i)=>s.name.localeCompare(i.name),r=()=>!0,a){return new Promise((s,i)=>{Dr(n,e,Ue,a).then(o=>{Mr(n,o).then(l=>{s(l.filter(r).sort(t))})}).catch(o=>i(o))})}function Fa(n,e,t){return new Promise((r,a)=>{Dr(F.STREET,n,Ue,t).then(s=>Mr(F.STREET,s)).then(s=>{const i=[],o=n.match(new RegExp("^(.+)[\\s,](\\d+|\\d.*)$"));for(let l=0;l<s.length;l++)i.push([s[l]]),e&&i.push(Ce(F.HOUSE_NUMBERS_FOR_STREET,s[l].name,void 0,void 0,t));return!s.length&&o?.length&&e&&i.push(Ce(F.HOUSE_NUMBERS_FOR_STREET,o[1],(l,d)=>parseInt(l.properties?.hausnummer,10)-parseInt(d.properties?.hausnummer,10),l=>l.properties?.hausnummerkomplett?.indexOf(o[2])===0,t)),Promise.all(i)}).then(s=>r([].concat(...s))).catch(s=>a(s))})}function ur(n,e,t=!1){return t&&Ue!==null&&Ue.abort(),Ue=new AbortController,new Promise((r,a)=>{const{map:s,zoom:i=!1,zoomToParams:o,searchAddress:l=!1,searchStreets:d=!1,searchStreetBeforeWord:c=!0,searchDistricts:u=!1,searchParcels:h=!1,searchStreetKey:g=!1,minCharacters:f=3}=e,m=[];let{searchHouseNumbers:v=!1}=e;if(n.length<f){a({error:"Search string too short."});return}if(i&&!s&&console.warn("Instructed to zoom, but required map object was not given. Zooming will be skipped."),!d&&v&&(console.warn(`Search for '${n}' supposed to retrieve house numbers, but not streets. Invalid search configuration. House numbers will not be searched for as a result.`),v=!1),!(l||d||v||u||h||g)){a({error:`Search for '${n}' received no indication what to search for. Search is canceled.`});return}if(d&&m.push(Fa(n,v,c)),l){let p=n.split(/(\d+)/).map(w=>w.trim()).filter(w=>w);if(p.length>3){const w=p[0],S=p[1],C=n.replace(p[0],"").replace(p[1],"").trim();p=[w,S,C]}const y=[!1,!1,F.ADDRESS_UNAFFIXED,F.ADDRESS_AFFIXED][p.length];y&&m.push(Ce(y,p))}if(u&&/^[a-z-üäöß]+$/i.test(n)&&m.push(Ce(F.DISTRICT,n)),g&&/^[a-z]{1}[0-9]{1,5}$/i.test(n)&&m.push(Ce(F.STREET_KEY,n)),h){let p;/^[0-9]{4}[\s|/][0-9]*$/.test(n)?p=n.split(/[\s|/]/):/^[0-9]{5,}$/.test(n)&&(p=[n.slice(0,4),n.slice(4)]),p&&m.push(Ce(F.PARCEL,p))}Promise.all(m).then(p=>{const y=[].concat(...p);if(i&&s&&y.length===1)try{Ea(s,y[0],o)}catch(w){console.error("Zooming to element from gazetteer failed."),console.error(w)}r(y)}).catch(p=>a(p))})}const Y="addressSearch";function Pa(n,e){const t=n.reduce((r,a)=>a.status==="fulfilled"?[...r,a.value]:r,[]);return e.signal.aborted||n.filter(({status:r})=>r==="rejected").forEach(({reason:r})=>{console.error(`@polar/polar(plugins/addressSearch/utils/getResultsFromPromises:20:4)
`,"An error occurred while sending a request: ",r)}),t}function Or(n){if(!n.ok)throw new Error(n.status===418?"The server refuses to brew coffee because it is, permanently, a teapot.":`The received status code ${n.status} indicates an error.`)}function Ra(n,e){let t=`query=${n.replace(" ","+")}`;for(const[r,a]of Object.entries(e).filter(([s])=>s!=="filter"&&s!=="epsg"&&s!=="apiKey"&&s!=="accessToken"))t+=`&${r}=${a}`;return e.filter&&Object.keys(e.filter).length>0&&(t+="&filter=",t=Object.entries(e.filter).reduce((r,[a,s])=>`${r+a}:${s}&`,t).slice(0,-1)),t}async function Ma(n,e,t,r){const a=`${e}?`+Ra(t,r),s={signal:n};r.accessToken?s.headers={Authorization:`Bearer ${r.accessToken}`}:r.apiKey&&(s.headers={"X-Api-Key":r.apiKey});const i=await fetch(encodeURI(a),s);Or(i);const o=await i.json();return{...o,features:o.features.map(l=>B(l,{geometry:B(l.geometry,{coordinates:r.epsg==="EPSG:4326"?l.geometry.coordinates:We(l.geometry.coordinates,"EPSG:4326",r.epsg)}),title:l.properties.text}))}}async function Da(n,e,t,r){yn(e);try{const a=B(r,{minCharacters:0});let s=await ur(t,B(a,{searchStreetBeforeWord:!1}));return!s[0]&&(s=await ur(t,a),!s[0])?{type:"FeatureCollection",features:[]}:{type:"FeatureCollection",features:Na(s,r.epsg,Oa(s[0].properties.position.Point[0].$.srsName))}}catch(a){throw console.error(`@polar/polar(lib/getFeatures/mpapi:50:3)
`,a),new Error("An error occurred while fetching the feature collection.")}}function Oa(n){if(n.includes("::"))return`EPSG:${n.split("::")[1]}`;if(n.includes(":"))return n;throw console.error(`@polar/polar(lib/getFeatures/mpapi:63:2)
`,"Unknown formatting of projection:",n),Error("Unknown formatting of projection: "+n)}const Na=(n,e,t)=>n.map(r=>{const{name:a,geometry:s}=r;return{type:"Feature",title:a,geometry:B(s,{coordinates:t===e?s.coordinates.map(Number):We(s.coordinates.map(Number),t,e)}),properties:r.properties}}),Ga=n=>n.replace(/\r?\n|\r/g,""),Ba=({maxFeatures:n})=>`
<?xml version="1.0" encoding="UTF-8"?>
<wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"${n?` maxFeatures="${n}"`:""}>`,Va={wildCard:"*",singleChar:".",escapeChar:"!"},Ua=({srsName:n,featurePrefix:e,typeName:t,xmlns:r})=>`
<wfs:Query typeName="${e}:${t}" xmlns:${e}="${r}"${n?` srsName="${n}"`:""}>
<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc">`;function hr(n,e,{featurePrefix:t,useRightHandWildcard:r,likeFilterAttributes:a}){const s=B(Va,a||{});return`
<ogc:PropertyIsLike${Object.entries(s).reduce((i,[o,l])=>`${i} ${o}="${l}"`,"")}>
<ogc:PropertyName>${t}:${n}</ogc:PropertyName>
<ogc:Literal>${e}${typeof r=="boolean"&&!r?"":Object.hasOwn(s,"wildCard")?s.wildCard:"*"}</ogc:Literal>
</ogc:PropertyIsLike>`}function za(n,e){let t=Ua(e);if(n.length>1)t+=`<ogc:And>${n.map(([r,a])=>hr(r,a,e)).join("")}</ogc:And>`;else if(n.length===1){const r=n[0];t+=hr(r[0],r[1],e)}return t+"</ogc:Filter></wfs:Query>"}const Ne=(n,e)=>Ga(Ba(e)+n.map(t=>za(t,e)).join("")+"</wfs:GetFeature>");if(import.meta.vitest){const{expect:n,test:e}=import.meta.vitest,t={typeName:"TyPeNaMe",featurePrefix:"prefix",xmlns:"example.com",maxFeatures:999};e("creates an empty search for an empty input",()=>{n(Ne([],t)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"></wfs:GetFeature>')}),e("creates a one-query search for a single match",()=>{n(Ne([[["a","5"]]],t)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:a</ogc:PropertyName><ogc:Literal>5*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query></wfs:GetFeature>')}),e("creates a one-query and-ed search for a single match with multiple fields",()=>{n(Ne([[["a","5"],["b","3"]]],t)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:And><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:a</ogc:PropertyName><ogc:Literal>5*</ogc:Literal></ogc:PropertyIsLike><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:b</ogc:PropertyName><ogc:Literal>3*</ogc:Literal></ogc:PropertyIsLike></ogc:And></ogc:Filter></wfs:Query></wfs:GetFeature>')}),e("creates a multi-query search for a multiple matches",()=>{n(Ne([[["a","5"]],[["b","3"]]],t)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:a</ogc:PropertyName><ogc:Literal>5*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:b</ogc:PropertyName><ogc:Literal>3*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query></wfs:GetFeature>')})}const Ft={};function er(n){if(Ft[n])return Ft[n];const e=Array.from(n.matchAll(/{{(.*?)}}/g)),t=[];let r=0;for(const a of e)r<a.index&&(t.push(n.substring(r,a.index)),r=a.index),t.push(a),r+=a[0].length;return Ft[n]=t,t}const Ha=(n,e)=>n.uninterpreted>e.uninterpreted?1:n.uninterpreted<e.uninterpreted?-1:n.index>e.index?1:n.index<e.index?-1:0,Wa=(n,e,t)=>{const r=[...n.map((s,i)=>({match:s,uninterpreted:t[i],patternLengthDiff:(e[i].match(/{{/g)||[]).length-s.length,index:i}))].sort(Ha).map(({match:s})=>s),a=[];return r.filter(s=>{if(s.length===0)return!1;const i=JSON.stringify(s);return a.includes(i)?!1:(a.push(i),!0)})},zt=(n,e,t)=>{if(!n)throw new Error('Parameter "patterns" is missing on wfs configuration for pattern-based search.');if(!e)throw new Error('Parameter "patternKeys" is missing on wfs configuration for pattern-based search.');const r=[],a=[];return n.forEach(s=>{const i=er(s),o=[];let l=t;i.forEach(d=>{let c="";if(Array.isArray(d)){const u=d[1],h=e[u],g=l.match(new RegExp("^"+h));if(g!==null){const f=g[1];o.push([u,f.trim()]),c=g[0].trim()}}else c=d.trim();l.startsWith(c)&&(l=l.substring(c.length).trim())}),a.push(l.length),r.push(o)}),Wa(r,n,a)};if(import.meta.vitest){const{expect:n,test:e}=import.meta.vitest,t=(s,i,o,l,d)=>{const c=[s,i];return c.index=o,c.input=l,c.groups=d,c},r=["{{gemarkung}} {{flur}} {{flstnrzae}}/{{flstnrnen}}, {{flstkennz}}","{{gemarkung}} {{flur}} {{flstnrzae}}, {{flstkennz}}","{{gemarkung}} {{flstnrzae}}/{{flstnrnen}}, {{flstkennz}}","{{gemarkung}} {{flstnrzae}}, {{flstkennz}}","{{flstkennz}}"],a={gemarkung:"([^0-9]+)",flur:"([0-9]+)",flstnrzae:"([0-9]+)",flstnrnen:"([0-9]+)",flstkennz:"([0-9_]+)"};e("getBlocks parts pattern strings to Block[][]",()=>{n(er(r[0])).toEqual([t("{{gemarkung}}","gemarkung",0,r[0])," ",t("{{flur}}","flur",14,r[0])," ",t("{{flstnrzae}}","flstnrzae",23,r[0]),"/",t("{{flstnrnen}}","flstnrnen",37,r[0]),", ",t("{{flstkennz}}","flstkennz",52,r[0])])}),e("match builds full match groups",()=>{n(zt(r,a,"Musterhausen 12 3/4, 1234___")).toEqual([[["gemarkung","Musterhausen"],["flur","12"],["flstnrzae","3"],["flstnrnen","4"],["flstkennz","1234___"]],[["gemarkung","Musterhausen"],["flur","12"],["flstnrzae","3"]],[["gemarkung","Musterhausen"],["flstnrzae","12"],["flstnrnen","3"]],[["gemarkung","Musterhausen"],["flstnrzae","12"],["flstkennz","3"]]])}),e("match manages to decide the best fit",()=>{n(zt(r,a,"1234___")).toEqual([[["flur","1234"],["flstkennz","___"]],[["flstnrzae","1234"],["flstkennz","___"]],[["flstkennz","1234___"]]])})}function ja(n,e){return n.fillPercentage>e.fillPercentage?-1:n.fillPercentage<e.fillPercentage?1:n.keys.length>e.keys.length?-1:n.keys.length<e.keys.length?1:n.index>e.index?-1:n.index<e.index?1:0}function qa(n,e){const t=n.properties||{},r=[...e.map((a,s)=>{const i=er(a).reduce((l,d)=>Array.isArray(d)?[...l,d[1]]:l,[]),o=i.reduce((l,d)=>typeof t[d]<"u"&&t[d]!==""?l+1:l,0);return{pattern:a,keys:i,index:s,fillPercentage:o/i.length}})].sort(ja)[0];return r.keys.reduce((a,s)=>a.replace(`{{${s}}}`,t[s]||""),r.pattern)}const gr=new gn,Ka=new pn;async function Xa(n,e,t,r){const a=[],s={type:"FeatureCollection",features:a},i=await n.text(),o=gr.readFeatures(i),{srsName:l}=gr.readFeatureCollectionMetadata(i);return o.forEach(d=>{const c=JSON.parse(Ka.writeFeature(d));c.title="",e&&(t?c.title=qa(c,e):c.title=Array.isArray(e)?e.map(u=>c.properties[u]).join(" "):c.properties[e]),l&&(c.geometry=B(c.geometry,{coordinates:We(c.geometry.coordinates,`EPSG:${l.split("::")[1]}`,r)})),a.push(c)}),s}async function Ja(n,e,t,r){const{fieldName:a,patterns:s,patternKeys:i}=r;if(!a&&(!s||!i))throw new Error('Incomplete WFS search configuration. Either "fieldName" or "patterns" & "patternKeys" are required.');a&&s&&console.error(`@polar/polar(lib/getFeatures/wfs/index:22:3)
`,'Using both "fieldName" and "patterns" for WFS search. These are mutually exclusive. "patterns" will be ignored.');const o=a?[[[a,t]]]:zt(s,i,t),l=Ne(o,r),d=await fetch(encodeURI(e),{signal:n,method:"POST",body:l});return Or(d),Xa(d,a||s,!a,r.epsg)}function Ya(){const n={bkg:Ma,mpapi:Da,wfs:Ja};return{registerSearchMethods:e=>{Object.entries(e).forEach(([t,r])=>{if(n[t]){console.error(`@polar/polar(plugins/addressSearch/utils/methodContainer:16:6)
`,`Method "${t}" already exists. Please choose a different name. Overrides are not allowed.`);return}n[t]=r})},getSearchMethod:e=>{const t=n[e];if(t)return t;throw new Error(`The given type "${e}" does not define a valid searchMethod.`)}}}const fe={ERROR:Symbol("error"),NO_SEARCH:Symbol("noSearch")},Ct=be("plugins/addressSearch",()=>{const n=Z(),e={label:"defaultLabel",hint:"",resultDisplayMode:"mixed",limitResults:Number.MAX_SAFE_INTEGER};let t=null,r,a;const s=P(null),i=P(""),o=P(!1),l=P(fe.NO_SEARCH),d=P("defaultGroup"),c=L(()=>u.value.afterResultComponent||null),u=L(()=>n.configuration.addressSearch),h=L({get:()=>i.value,set:$=>{$!==i.value&&(i.value=$,Je())}}),g=L(()=>Array.isArray(l.value)&&l.value.length>0&&l.value.some(({features:{features:$}})=>Array.isArray($)&&$.length>0)),f=L(()=>u.value.focusAfterSearch||!1),m=L(()=>$=>{const G=u.value.groupProperties?.[$]||{};return $==="defaultGroup"?B(e,G):G}),v=L(()=>Object.keys(k.value)),p=L(()=>Object.keys(k.value).map($=>({groupId:$,text:m.value($).label}))),y=L(()=>v.value.length>1),w=L(()=>o.value?le($=>$.hint.loading,{ns:Y}):l.value===fe.ERROR?le($=>$.hint.error,{ns:Y}):h.value.length>0&&h.value.length<C.value?le($=>$.hint.tooShort,{ns:Y,minLength:C.value}):l.value!==fe.NO_SEARCH&&!g.value?le($=>$.hint.noResults,{ns:Y}):D.value.hint||""),S=L(()=>D.value.limitResults||e.limitResults),C=L(()=>typeof u.value.minLength=="number"?u.value.minLength:0),k=L(()=>u.value.searchMethods.reduce(($,G)=>{const ee=G.groupId||"defaultGroup";return $[ee]?$[ee].push(G):$[ee]=[G],$},{})),T=L({get:()=>d.value,set:$=>{$!==d.value&&(d.value=$,l.value=fe.NO_SEARCH,h.value.length>0&&Lt())}}),D=L(()=>m.value(T.value)),ie=L(()=>typeof u.value.waitMs=="number"?u.value.waitMs:0);function _e(){r=fn(Lt,ie.value),a=Ya(),T.value=v.value[0],u.value.customSearchMethods&&a.registerSearchMethods(u.value.customSearchMethods)}function Et(){}function Je(){t&&(t.abort(),t=null),r()}function Tt(){h.value="",l.value=fe.NO_SEARCH,s.value=null}function Lt(){if(h.value.length<C.value)return l.value=fe.NO_SEARCH,o.value=!1,Promise.resolve();o.value=!0,t=new AbortController;const $=t;return Promise.allSettled(u.value.searchMethods.map(async({categoryId:G,groupId:ee,queryParameters:Re,type:$t,url:cn})=>{const un=await a.getSearchMethod($t)($.signal,cn,h.value,B(Re||{},{epsg:n.configuration.epsg})),ar=G||"default",sr=u.value.categoryProperties?.[ar];return{categoryId:ar,categoryLabel:sr?le(sr.label):le(hn=>hn.defaultLabel,{ns:Y}),features:un,groupId:ee||"defaultGroup"}})).then(G=>l.value=Pa(G,$)).catch(G=>{console.error(`@polar/polar(plugins/addressSearch/store:249:6)
`,"An error occurred while searching.",G),l.value=fe.ERROR}).finally(()=>{o.value=!1})}async function dn($,G="never"){if(h.value=$,t&&(t.abort(),t=null),await Lt(),!Array.isArray(l.value))return;const ee=l.value.find(({features:$t})=>$t.features.length);if(!ee)return;const Re=ee.features.features;(G==="first"&&Re.length>=1||G==="only"&&Re.length===1)&&nr(Re[0],ee.categoryId)}function nr($,G="default"){const ee=u.value.customSelectResult?.[G];ee?ee($,G):(s.value=$,i.value=$.title,l.value=fe.NO_SEARCH)}return{chosenAddress:s,inputValue:h,afterResultComponent:c,focusAfterSearch:f,groupSelectOptions:p,hasMultipleGroups:y,isLoading:o,searchResults:l,selectedGroupId:T,featuresAvailable:g,hint:w,limitResults:S,abortAndRequest:Je,clear:Tt,search:dn,selectResult:nr,setupPlugin:_e,teardownPlugin:Et}});function Nr(n,e,t){for(let r=0;r<n;r++){const a=e.getElementById(`polar-plugin-address-search-results-feature-${r}-0`);if(a){a.focus(),t?.preventDefault();break}}}const Qa={class:"kern-form-input__select-wrapper"},Za=["aria-label"],es=["value"],ts=H({__name:"GroupSelect.ce",setup(n){const{groupSelectOptions:e,selectedGroupId:t}=ue(Ct());return(r,a)=>(b(),E("div",Qa,[Zt(I("select",{"onUpdate:modelValue":a[0]||(a[0]=s=>gt(t)?t.value=s:null),class:"kern-form-input__select","aria-label":r.$t(s=>s.groupSelector,{ns:_(Y)})},[(b(!0),E(K,null,Q(_(e),({groupId:s,text:i})=>(b(),E("option",{key:s,value:s},ae(r.$t(o=>o[i],{ns:_(Y)})),9,es))),128))],8,Za),[[ua,_(t)]])]))}});function rs(n,e){const t=n.toLowerCase().indexOf(e.toLowerCase());return t===-1?n:n.substring(0,t)+"<strong>"+n.substring(t,t+e.length)+"</strong>"+n.substring(t+e.length)}const ns={key:0,class:"polar-plugin-address-search-category-label"},as=["id","onClick","onKeydown"],ss=["innerHTML"],is=["onClick"],os={class:"kern-label"},ls={key:2,class:"kern-divider","aria-hidden":"true"},ds=H({__name:"SearchResults.ce",setup(n){const e=Z(),t=Ct(),{afterResultComponent:r,featuresAvailable:a,inputValue:s,limitResults:i,searchResults:o,selectedGroupId:l}=ue(t);Ae(l,()=>d.value=[]),Ae(a,()=>{t.focusAfterSearch&&pt(()=>{Nr(u.value.length,e.shadowRoot)})});const d=P([]),c=L(()=>e.hasWindowSize?"inherit":`${e.clientHeight*.8}px`),u=L(()=>Array.isArray(t.searchResults)?structuredClone(ha(t.searchResults)).filter(v=>v.groupId===t.selectedGroupId).reduce((v,p)=>{const y=v.findIndex(w=>w.categoryId===p.categoryId);return y===-1?[...v,p]:(v[y].features.features=[...v[y].features.features,...p.features.features],v)},[]).map(v=>(h(v.categoryId)||(v.features.features=v.features.features.slice(0,i.value)),v)):[]);function h(v){return d.value.includes(v)}function g(){e.shadowRoot.getElementById("polar-plugin-address-search-input")?.focus()}function f(v,p){const{target:y}=p;if(y===null){console.warn(`@polar/polar(plugins/addressSearch/components/SearchResults.ce.vue?vue&type=script&setup=true&lang:109:3)
`,`@polar/polar(plugins/addressSearch/components/SearchResults.ce:174:3)
`,"Could not focus any element.");return}const w=(e.shadowRoot?.getElementById("polar-plugin-address-search-result-wrapper")).querySelectorAll("li, button"),S=[...w].indexOf(y),C=w[(S+(v?1:-1))%w.length];if(C){C.focus();return}e.shadowRoot.getElementById("polar-plugin-address-search-input")?.focus()}function m(v){d.value=d.value.indexOf(v)===-1?[...d.value,v]:d.value.filter(p=>p!==v)}return(v,p)=>_(a)?(b(),E("div",{key:0,id:"polar-plugin-address-search-result-wrapper",style:ga(`max-height: ${c.value}`),tabindex:"-1"},[(b(!0),E(K,null,Q(u.value,(y,w)=>(b(),E(K,{key:y.categoryId},[u.value.length>1?(b(),E("span",ns,ae(y.categoryLabel)+" "+ae(v.$t(S=>S.resultCount,{count:_(o)[w].features.features.length,ns:_(Y)})),1)):W("",!0),I("ul",{class:Ie({"polar-plugin-address-search-list-without-label":u.value.length===1})},[(b(!0),E(K,null,Q(y.features.features,(S,C)=>(b(),E("li",{key:`result-${w}-${C}`,id:`polar-plugin-address-search-results-feature-${w}-${C}`,tabindex:"-1",onClick:k=>_(t).selectResult(S,y.categoryId),onKeydown:[me(ve(k=>_(t).selectResult(S,y.categoryId),["prevent","stop"]),["enter"]),p[0]||(p[0]=me(ve(k=>f(!0,k),["prevent","stop"]),["down"])),p[1]||(p[1]=me(ve(k=>f(!1,k),["prevent","stop"]),["up"])),me(ve(g,["prevent","stop"]),["escape"])]},[I("span",{innerHTML:_(rs)(S.title,_(s))},null,8,ss),_(r)?(b(),M(ft(_(r)),{key:0,feature:S},null,8,["feature"])):W("",!0)],40,as))),128))],2),_(o)[w].features.features.length>_(i)?(b(),E("button",{key:1,class:"kern-btn kern-btn--tertiary",onKeydown:[p[2]||(p[2]=me(ve(S=>f(!0,S),["prevent","stop"]),["down"])),p[3]||(p[3]=me(ve(S=>f(!1,S),["prevent","stop"]),["up"]))],onClick:S=>m(y.categoryId)},[I("span",{class:Ie(`kern-icon ${h(y.categoryId)?"kern-icon--keyboard-arrow-up":"kern-icon--keyboard-arrow-down"}`),"aria-hidden":"true"},null,2),I("span",os,ae(v.$t(S=>S.resultList[h(y.categoryId)?"reduce":"extend"],{ns:_(Y)})),1)],40,is)):W("",!0),w<u.value.length-1?(b(),E("hr",ls)):W("",!0)],64))),128))],4)):W("",!0)}}),cs="#polar-plugin-address-search-result-wrapper{&[data-v-ba9de509]{width:100%;padding-bottom:.625rem;overflow-y:auto}.polar-plugin-address-search-category-label[data-v-ba9de509]{display:flex;align-items:center;height:var(--kern-metric-dimension-x-large);padding:0 var(--kern-metric-space-small);font-size:.875rem;color:var(--kern-color-layout-text-muted)}.polar-plugin-address-search-list-without-label[data-v-ba9de509]{margin-top:var(--kern-metric-space-2x-small)}ul{&[data-v-ba9de509]{margin:0;padding:0}li{&[data-v-ba9de509]{display:flex;align-items:center;min-height:var(--kern-metric-dimension-x-large);padding:var(--kern-metric-space-none) var(--kern-metric-space-small);margin:var(--kern-metric-space-none) var(--kern-metric-space-small);border-radius:var(--kern-metric-border-radius-default);color:var(--kern-color-layout-text-default);transition:.3s cubic-bezier(.25,.8,.5,1)}&[data-v-ba9de509]:hover,&[data-v-ba9de509]:focus{background-color:var(--kern-color-layout-background-hued);cursor:pointer}}}button[data-v-ba9de509]{width:95%;margin:var(--kern-metric-space-none) var(--kern-metric-space-small)}}",us=z(ds,[["styles",[cs]],["__scopeId","data-v-ba9de509"]]),hs={class:"loader",role:"status"},gs=H({__name:"SmallLoader.ce",setup(n){return(e,t)=>(b(),E("div",hs,[...t[0]||(t[0]=[I("div",null,null,-1),I("div",null,null,-1),I("div",null,null,-1),I("div",null,null,-1)])]))}}),ps=".loader[data-v-6d8887fc],.loader div[data-v-6d8887fc]{box-sizing:border-box}.loader[data-v-6d8887fc]{position:absolute;right:3rem;width:var(--kern-metric-dimension-large);height:var(--kern-metric-dimension-large);margin:var(--kern-metric-space-small)}.loader div[data-v-6d8887fc]{box-sizing:border-box;display:block;position:absolute;width:var(--kern-metric-dimension-large);height:var(--kern-metric-dimension-large);border:4px solid currentColor;border-radius:50%;animation:loader-6d8887fc 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:currentColor transparent transparent transparent}.loader div[data-v-6d8887fc]:nth-child(1){animation-delay:-.45s}.loader div[data-v-6d8887fc]:nth-child(2){animation-delay:-.3s}.loader div[data-v-6d8887fc]:nth-child(3){animation-delay:-.15s}@keyframes loader-6d8887fc{0%{transform:rotate(0)}to{transform:rotate(360deg)}}",fs=z(gs,[["styles",[ps]],["__scopeId","data-v-6d8887fc"]]),ms={class:"polar-plugin-address-search-selection-wrapper"},ys={class:"polar-plugin-address-search-input-wrapper"},_s=["aria-description","onKeydown"],vs={class:"kern-label kern-sr-only"},bs={key:2,class:"polar-plugin-address-search-hint"},xs=H({__name:"AddressSearch.ce",setup(n){const e=Z(),t=Ct(),{hasMultipleGroups:r,hint:a,inputValue:s,isLoading:i,searchResults:o}=ue(t),l=P(!1),d=L(()=>(e.hasSmallDisplay||!e.hasWindowSize)&&!l.value);function c(g){const f=g;if(typeof f.focus!="function"||f.hasAttribute("disabled")||f.getAttribute("aria-hidden")==="true"||f.tabIndex<0)return!1;const m=getComputedStyle(f);return m.display==="none"||m.visibility==="hidden"?!1:!(f.offsetParent===null&&m.position!=="fixed")}function u(){l.value?!s.value.length&&!r.value&&(l.value=!l.value,pt(()=>{const g=e.shadowRoot?.getElementById("polar-plugin-address-search-icon-button"),f=document.createTreeWalker(e.shadowRoot,NodeFilter.SHOW_ELEMENT,{acceptNode(v){return v===g?NodeFilter.FILTER_SKIP:c(v)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});f.currentNode=g;const m=f.nextNode();m&&m.focus()})):(l.value=!l.value,pt(()=>{(e.shadowRoot?.getElementById("polar-plugin-address-search-input")).focus()}))}function h(g){Array.isArray(t.searchResults)&&Nr(t.searchResults.length,e.shadowRoot,g)}return(g,f)=>d.value?(b(),M(wr,{key:0,id:"polar-plugin-address-search-icon-button",hint:g.$t(m=>m.hint.button,{ns:_(Y)}),icon:"kern-icon--search",onClick:u},null,8,["hint"])):(b(),M(wt,{key:1,class:Ie({"has-hint":_(a).length>0,"polar-plugin-address-search-shown-results":Array.isArray(_(o))&&_(o).length})},{default:he(()=>[I("div",ms,[_(r)?(b(),M(ts,{key:0})):W("",!0),I("div",ys,[Zt(I("input",{id:"polar-plugin-address-search-input","onUpdate:modelValue":f[0]||(f[0]=m=>gt(s)?s.value=m:null),class:"kern-form-input__input",type:"text","aria-description":_(a).length>0?_(a):g.$t(m=>m.ariaDescription,{ns:_(Y)}),onKeydown:[f[1]||(f[1]=me((...m)=>_(t).abortAndRequest&&_(t).abortAndRequest(...m),["enter"])),me(ve(h,["prevent","stop"]),["down"])],onFocusout:u},null,40,_s),[[ca,_(s)]]),_(i)?(b(),M(fs,{key:0})):W("",!0),_(s).length?(b(),E("button",{key:1,class:"kern-btn kern-btn--tertiary polar-plugin-address-search-input-button",onClick:f[2]||(f[2]=(...m)=>_(t).clear&&_(t).clear(...m))},[f[3]||(f[3]=I("span",{class:"kern-icon kern-icon--close","aria-hidden":"true"},null,-1)),I("span",vs,ae(g.$t(m=>m.hint.clear,{ns:_(Y)})),1)])):W("",!0),_(a).length>0?(b(),E("span",bs,ae(_(a)),1)):W("",!0)])]),$e(us)]),_:1},8,["class"]))}}),ks="#polar-plugin-address-search-icon-button[data-v-3091d222]{position:absolute;margin:var(--kern-metric-space-small)}.has-hint[data-v-3091d222] .kern-card__container{padding-bottom:var(--kern-metric-space-small)!important}.polar-plugin-address-search-shown-results[data-v-3091d222] .kern-card__container{padding-bottom:0!important}.kern-card{&[data-v-3091d222]{display:flex;flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-small);position:absolute;margin:var(--kern-metric-space-small)}.polar-plugin-address-search-selection-wrapper{&[data-v-3091d222]{display:flex;flex-direction:row;align-items:center;width:100%;gap:var(--kern-metric-space-small)}.polar-plugin-address-search-input-wrapper{&[data-v-3091d222]{display:flex;flex-direction:column;width:100%}#polar-plugin-address-search-input[data-v-3091d222]{border-radius:var(--kern-metric-border-radius-small);background:var(--kern-color-form-input-background)}.polar-plugin-address-search-input-button[data-v-3091d222]{position:absolute;right:0;border-radius:var(--kern-metric-border-radius-small);margin:var(--kern-metric-space-small);margin-right:var(--kern-metric-space-default);width:var(--kern-metric-dimension-large);min-height:var(--kern-metric-dimension-large)}.polar-plugin-address-search-hint[data-v-3091d222]{color:var(--kern-color-layout-text-muted);font-size:.875rem;padding:0 .1rem;margin-top:var(--kern-metric-space-small)}}}}",ws=z(xs,[["styles",[ks]],["__scopeId","data-v-3091d222"]]),Cs={ariaDescription:"Durch Eingabe in das Suchfeld kann die Suche nach Adressen gestartet werden",defaultLabel:"Adresssuche",hint:{button:"Eingabefeld der Addresssuche anzeigen",clear:"Das Eingabefeld der Addresssuche leeren",error:"Etwas ist bei der Suche schiefgegangen.",loading:"Suche ...",noResults:"Keine Ergebnisse gefunden.",tooShort:"Für die Suche bitte mindestens {{minLength}} Zeichen eingeben."},groupSelector:"Suchthema auswählen",resultCount:"({{count}} Ergebnisse)",resultList:{extend:"Alle Ergebnisse anzeigen",reduce:"Ergebnisliste reduzieren"}},Ss={ariaDescription:"Durch Eingabe in das Suchfeld kann die Suche nach Adressen gestartet werden",defaultLabel:"Address Search",hint:{button:"Show address search input field",clear:"Clear address search input field",error:"Something went wrong.",loading:"Searching ...",noResults:"No results for the current query.",tooShort:"Please enter at least {{minLength}} characters."},groupSelector:"Select search topic",resultCount:"({{count}} results)",resultList:{extend:"Show all results",reduce:"Reduce result list"}},Es=[{type:"de",resources:Cs},{type:"en",resources:Ss}];function Ts(n){return{id:Y,component:ws,locales:Es,storeModule:Ct,options:n}}const Gr=be("plugins/footer",()=>{const n=Z(),e=P([]),t=P([]);function r(){e.value=(n.configuration.footer?.leftEntries||[]).filter(({id:s})=>{const i=n.configuration[s]?.displayComponent;return typeof i=="boolean"?i:!0}),t.value=(n.configuration.footer?.rightEntries||[]).filter(({id:s})=>{const i=n.configuration[s]?.displayComponent;return typeof i=="boolean"?i:!0}),e.value.concat(t.value).forEach(s=>{n.addPlugin(B(s,{independent:!1}))}),e.value.map(s=>B(s,{component:dr(s.component)})),t.value.map(s=>B(s,{component:dr(s.component)}))}function a(){}return{leftEntries:e,rightEntries:t,setupPlugin:r,teardownPlugin:a}}),Ls={class:"polar-plugin-footer-wrapper"},$s=H({__name:"PolarFooter.ce",setup(n){const{leftEntries:e,rightEntries:t}=ue(Gr());return(r,a)=>(b(),E("div",Ls,[I("ul",null,[(b(!0),E(K,null,Q(_(e),(s,i)=>(b(),E("li",{key:i},[(b(),M(ft(s.component)))]))),128))]),I("ul",null,[(b(!0),E(K,null,Q(_(t),(s,i)=>(b(),E("li",{key:i},[(b(),M(ft(s.component)))]))),128))])]))}}),Is=".polar-plugin-footer-wrapper{&[data-v-9004f27e]{position:absolute;bottom:0;display:flex;width:100%;height:var(--kern-metric-dimension-large);padding:var(--kern-metric-space-x-small) var(--kern-metric-space-x-small) var(--kern-metric-space-x-small) var(--kern-metric-space-small);justify-content:space-between;align-items:center;flex-shrink:0;background:var(--kern-color-layout-background-hued);box-shadow:0 1px 1px #35395629,0 1px 2px #35395640,0 1px 6px #6e759740;border-radius:0 0 var(--kern-metric-border-radius-large) var(--kern-metric-border-radius-large)}ul{&[data-v-9004f27e]{display:flex;align-items:center;gap:var(--kern-metric-space-small);padding:0}li[data-v-9004f27e]{list-style:none}}}",As=z($s,[["styles",[Is]],["__scopeId","data-v-9004f27e"]]),Fs={},Ps={},Rs=[{type:"de",resources:Fs},{type:"en",resources:Ps}],Ms="footer";function Ds(n){return{id:Ms,component:As,locales:Rs,storeModule:Gr,options:n}}const Os=100,Ns=100,Pt={undefinedBoundaryLayer:Symbol.for("Boundary Layer undefined"),undefinedBoundarySource:Symbol.for("Boundary Source undefined"),sourceNotReady:Symbol.for("Source not ready")};async function Gs(n){let e=0;for(;n.getState()!=="ready"||n.getFeatures().length===0;)if(e++<Os)await new Promise(t=>{setTimeout(t,Ns)});else return!1;return!0}async function Br(n,e,t){if(typeof e>"u")return!0;const r=n.getLayers().getArray().find(s=>s.get("id")===e);if(!(r instanceof Fe))return console.error(`@polar/polar(lib/passesBoundaryCheck:61:3)
`,`No layer configured to match boundaryLayerId "${e}".`),Pt.undefinedBoundaryLayer;const a=r.getSource();return a instanceof je?await Gs(a)?a.getFeatures().some(s=>s.getGeometry()?.intersectsCoordinate(t)):(console.error(`@polar/polar(lib/passesBoundaryCheck:79:3)
`,`Layer with boundaryLayerId "${e}" did not load or is featureless.`),Pt.sourceNotReady):(console.error(`@polar/polar(lib/passesBoundaryCheck:70:3)
`,`Layer with boundaryLayerId "${e}" missing source.`),Pt.undefinedBoundarySource)}function pr(){}const R={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},Bs={ERROR:"error"};let Vs=class extends qe{constructor(e){super(Bs.ERROR),this.code=e.code,this.message=e.message}},Us=class extends kn{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=wn,this.watchId_=void 0,this.addChangeListener(R.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(R.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=Cn(lt("EPSG:4326"),e),this.position_&&this.set(R.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(R.ACCURACY,t.accuracy),this.set(R.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(R.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(R.HEADING,t.heading===null?void 0:Sn(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const r=this.transform_(this.position_);this.set(R.POSITION,r.slice()),this.set(R.SPEED,t.speed===null?void 0:t.speed);const a=En(this.position_,t.accuracy);a.applyTransform(this.transform_),this.set(R.ACCURACY_GEOMETRY,a),this.changed()}positionError_(e){this.dispatchEvent(new Vs(e))}getAccuracy(){return this.get(R.ACCURACY)}getAccuracyGeometry(){return this.get(R.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(R.ALTITUDE)}getAltitudeAccuracy(){return this.get(R.ALTITUDE_ACCURACY)}getHeading(){return this.get(R.HEADING)}getPosition(){return this.get(R.POSITION)}getProjection(){return this.get(R.PROJECTION)}getSpeed(){return this.get(R.SPEED)}getTracking(){return this.get(R.TRACKING)}getTrackingOptions(){return this.get(R.TRACKING_OPTIONS)}setProjection(e){this.set(R.PROJECTION,lt(e))}setTracking(e){this.set(R.TRACKING,e)}setTrackingOptions(e){this.set(R.TRACKING_OPTIONS,e)}};const zs=(n,e)=>()=>n.innerHTML=e.map(([t,r,a={}])=>`<${t}>${Oe.t(r,a)}</${t}>`).join(""),Hs=`
	background: rgba(255, 255, 255, 0.8);
	padding: 0.2em 0.5em;
	border-radius: 4px;
	color: #16161d;
	box-shadow: 0px 0px 3px 2px rgba(0, 0, 0, 0.5);
`;function Ws(n,e=Hs){const t=document.createElement("div");t.style.cssText=e;const r=zs(t,n);return Oe.on("languageChanged",r),Oe.store.on("added",r),r(),{element:t,unregister:()=>{Oe.off("languageChanges",r),Oe.store.off("added",r)}}}function js(){return navigator.permissions.query({name:"geolocation"}).then(({state:n})=>n==="denied").catch(()=>!1)}function qs(n,e){const t=e/2*Math.sqrt(3),r=document.createElement("canvas").getContext("2d").createLinearGradient(0,-t,Math.sin(n),t+Math.cos(n));return r.addColorStop(0,"#0794FAFF"),r.addColorStop(2/3,"#0794FA00"),r}function Ks(n){if(typeof n.get("heading")>"u")return new dt;const e=42,t=Math.PI-n.get("heading");return new dt({image:new Tn({points:3,radius:e,rotation:t,fill:new Cr({color:qs(t,e)}),displacement:[0,-30]})})}function Xs(){const n=new Cr({color:"#0078D4"}),e=new bn({color:"#FFFFFF",width:2});return t=>[Ks(t),new dt({image:new xn({fill:n,stroke:e,radius:12}),fill:n,stroke:e})]}const Js=(n,e)=>n[0]!==e[0]||n[1]!==e[1],Vr=be("plugins/geoLocation",()=>{const n=Z(),e=P(!1),t=P(null),r=P(null),a=P([]),s=L(()=>B({showTooltip:!1,zoomLevel:7},n.configuration.geoLocation||{})),i=L(()=>s.value.boundary),o=L(()=>e.value?"DISABLED":t.value===null?"LOCATABLE":"LOCATED"),l=new ne({type:"point",name:"geoLocationMarker"}),d=new Fe({source:new je({features:[l]}),properties:{name:"geoLocationMarkerLayer"},zIndex:1/0,style:Xs()});function c(){n.map.addLayer(d),s.value.checkLocationInitially?m():js().then(k=>e.value=k),g()}function u(){n.map.removeLayer(d),p(),S(),h()}let h=pr;function g(){if(s.value.showTooltip){const{unregister:k,element:T}=Ws([["h2","markerText",{ns:"geoLocation"}]]),D=new _n({element:T,positioning:"bottom-center",offset:[0,-5]});n.map.addOverlay(D);const ie=({pixel:_e,dragging:Et})=>{if(Et)return;const Je=n.map.getFeaturesAtPixel(_e,{layerFilter:Tt=>Tt.get("name")==="geoLocationMarkerLayer"}).length?n.map.getCoordinateFromPixel(_e):void 0;D.setPosition(Je)};n.map.on("pointermove",ie),h=()=>{k(),n.map.removeOverlay(D),n.map.un("pointermove",ie),h=pr}}}function f(){(o.value==="LOCATABLE"?m:p)()}function m(){if(e.value){v({message:"Geolocation API usage was denied by user or configuration."});return}t.value===null?t.value=new Us({trackingOptions:{enableHighAccuracy:!0},tracking:!0,projection:lt("EPSG:4326")}):y(),t.value.on("change:position",y),t.value.on("change:heading",({target:k})=>{l.set("heading",k.getHeading())}),t.value.on("error",v)}function v(k){Be("error",le(T=>T.button.locationAccessDenied,{ns:"geoLocation"})),console.error(`@polar/polar(plugins/geoLocation/store:176:3)
`,k.message),e.value=!0,S()}function p(){t.value?.setTracking(!1),S(),t.value=null}async function y(){const k=We(t.value?.getPosition(),lt("EPSG:4326"),n.configuration.epsg),T=n.configuration.extent?vn(n.configuration.extent,k):!0,D=await Br(n.map,i.value?.layerId,k),ie=r.value!==D;r.value=D;const _e=typeof D=="symbol"&&i.value?.onError==="strict";if(!T||_e){C(_e),p();return}Js(a.value,k)&&(w(k),ie&&!D&&C(!1))}function w(k){a.value=k;const T=!!l.getGeometry();l.setGeometry(new ce(k)),(s.value.keepCentered||!T)&&r.value&&(n.map.getView().setCenter(k),n.map.getView().setZoom(s.value.zoomLevel))}function S(){l.setGeometry(void 0),a.value=[]}function C(k){if(k){const D=le(ie=>ie.toast.boundaryError,{ns:"geoLocation"});Be("error",D),console.error(`@polar/polar(plugins/geoLocation/store:264:4)
`,D);return}const T=le(D=>D.toast.notInBoundary,{ns:"geoLocation"});Be("info",T,{timeout:1e4}),console.info(`@polar/polar(plugins/geoLocation/store:272:3)
`,T)}return{setupPlugin:c,teardownPlugin:u,locate:f,configuration:s,isGeolocationDenied:e,state:o,position:a,boundaryCheck:r}}),Ur="geoLocation",Ys=H({__name:"GeoLocation.ce",setup(n){const{layout:e}=ue(Z()),t=Vr(),{state:r}=ue(t),a=L(()=>r.value==="LOCATED"?"kern-icon-fill--near-me":r.value==="LOCATABLE"?"kern-icon--near-me":"kern-icon--near-me-disabled"),s=L(()=>t.configuration.renderType==="iconMenu"?void 0:e.value==="standard"||t.configuration.layoutTag?.includes("RIGHT")?"left":"right");return(i,o)=>(b(),M(wr,{class:Ie(_(e)==="nineRegions"?"polar-plugin-geoLocation-nineRegions":""),hint:i.$t(l=>l.button.tooltip,{ns:_(Ur)}),icon:a.value,"tooltip-position":s.value,disabled:_(r)==="DISABLED",onClick:_(t).locate},null,8,["class","hint","icon","tooltip-position","disabled","onClick"]))}}),Qs=".polar-plugin-geoLocation-nineRegions[data-v-45fc3e3e]{margin:var(--kern-metric-space-small)}",Zs=z(Ys,[["styles",[Qs]],["__scopeId","data-v-45fc3e3e"]]),ei={markerText:"Aktuelle Position",button:{locationAccessDenied:"Standortzugriff nutzerseitig abgelehnt",tooltip:"Eigene Position markieren"},toast:{boundaryError:"Die Überprüfung Ihrer Position ist fehlgeschlagen. Bitte versuchen Sie es später erneut oder wenden Sie sich an einen Administrator, wenn das Problem bestehen bleibt.",notInBoundary:"Sie befinden sich nicht im Kartengebiet."}},ti={markerText:"Current location",button:{locationAccessDenied:"Location access denied by user",tooltip:"Mark own location"},toast:{boundaryError:"Validating your position failed. Please try later again or contact an administrator if the issue persists.",notInBoundary:"You are not within the map's boundaries."}},ri=[{type:"de",resources:ei},{type:"en",resources:ti}];function ni(n){return{id:Ur,component:Zs,locales:ri,storeModule:Vr,options:n}}const N=[null,"http://www.opengis.net/wms","http://www.opengis.net/sld"];function Ke(n){return Ln(n[0].version,"1.3")>=0}const ai=O(N,{Service:x(Ei),Capability:x(Si)}),si=O(N,{Request:x(Mi),Exception:x(Ii),Layer:x(Ai),UserDefinedSymbolization:x(wi)});let ii=class extends $n{constructor(){super(),this.version=void 0}readFromNode(e){return this.version=e.getAttribute("version").trim(),V({version:this.version},ai,e,[])||null}};const zr={Name:x(A),Title:x(A),Abstract:x(A),KeywordList:x(Xr),OnlineResource:x(jt),ContactInformation:x(Ti),Fees:x(A),AccessConstraints:x(A)},oi=O(N,zr),li=O(N,{...zr,LayerLimit:x(It),MaxWidth:x(It),MaxHeight:x(It)}),di=O(N,{ContactPersonPrimary:x(Li),ContactPosition:x(A),ContactAddress:x($i),ContactVoiceTelephone:x(A),ContactFacsimileTelephone:x(A),ContactElectronicMailAddress:x(A)}),ci=O(N,{ContactPerson:x(A),ContactOrganization:x(A)}),ui=O(N,{AddressType:x(A),Address:x(A),City:x(A),StateOrProvince:x(A),PostCode:x(A),Country:x(A)}),hi=O(N,{Format:Sr(A)}),Hr={Name:x(A),Title:x(A),Abstract:x(A),KeywordList:x(Xr),BoundingBox:U(qr),Dimension:U(Fi),Attribution:x(ki),AuthorityURL:U(Ni),Identifier:U(A),MetadataURL:U(Gi),DataURL:U(ge),FeatureListURL:U(ge),Style:U(Bi),Layer:U(St)},Wr=O(N,{...Hr,SRS:U(A),Extent:x(Pi),ScaleHint:U(Ri),LatLonBoundingBox:x((n,e)=>qr(n,e,!1)),Layer:U(St)}),jr=O(N,{...Hr,CRS:U(A),EX_GeographicBoundingBox:x(Ci),MinScaleDenominator:x(xe),MaxScaleDenominator:x(xe),Layer:U(St)}),gi=O(N,{Title:x(A),OnlineResource:x(jt),LogoURL:x(Kr)}),pi=O(N,{westBoundLongitude:x(xe),eastBoundLongitude:x(xe),southBoundLatitude:x(xe),northBoundLatitude:x(xe)}),fi=O(N,{GetCapabilities:x(De),GetMap:x(De),GetFeatureInfo:x(De),DescribeLayer:x(De),GetLegendGraphic:x(De)}),mi=O(N,{Format:U(A),DCPType:U(Di)}),yi=O(N,{HTTP:x(Oi)}),_i=O(N,{Get:x(ge),Post:x(ge)}),vi=O(N,{Name:x(A),Title:x(A),Abstract:x(A),LegendURL:U(Kr),StyleSheetURL:x(ge),StyleURL:x(ge)}),bi=O(N,{Format:x(A),OnlineResource:x(jt)}),xi=O(N,{Keyword:Sr(A)});function ki(n,e){return V({},gi,n,e)}function wi(n,e){return{SupportSLD:!!J(n.getAttribute("SupportSLD")),UserLayer:!!J(n.getAttribute("UserLayer")),UserStyle:!!J(n.getAttribute("UserStyle")),RemoteWFS:!!J(n.getAttribute("RemoteWFS")),InlineFeatureData:!!J(n.getAttribute("InlineFeatureData")),RemoteWCS:!!J(n.getAttribute("RemoteWCS"))}}function qr(n,e,t=!0){const r=[de(n.getAttribute("minx")),de(n.getAttribute("miny")),de(n.getAttribute("maxx")),de(n.getAttribute("maxy"))],a=[de(n.getAttribute("resx")),de(n.getAttribute("resy"))],s={extent:r,res:a};return t&&(Ke(e)?s.crs=n.getAttribute("CRS"):s.srs=n.getAttribute("SRS")),s}function Ci(n,e){const t=V({},pi,n,e);if(!t)return;const r=t.westBoundLongitude,a=t.southBoundLatitude,s=t.eastBoundLongitude,i=t.northBoundLatitude;if(!(r===void 0||a===void 0||s===void 0||i===void 0))return[r,a,s,i]}function Si(n,e){return V({},si,n,e)}function Ei(n,e){return V({},Ke(e)?li:oi,n,e)}function Ti(n,e){return V({},di,n,e)}function Li(n,e){return V({},ci,n,e)}function $i(n,e){return V({},ui,n,e)}function Ii(n,e){return V([],hi,n,e)}function Ai(n,e){const t=V({},Ke(e)?jr:Wr,n,e);return t.Layer===void 0?Object.assign(t,St(n,e)):t}function St(n,e){const t=Ke(e),r=e[e.length-1],a=V({},t?jr:Wr,n,e);if(!a)return;let s=J(n.getAttribute("queryable"));s===void 0&&(s=r.queryable),a.queryable=s!==void 0?s:!1;let i=Bt(n.getAttribute("cascaded"));i===void 0&&(i=r.cascaded),a.cascaded=i;let o=J(n.getAttribute("opaque"));o===void 0&&(o=r.opaque),a.opaque=o!==void 0?o:!1;let l=J(n.getAttribute("noSubsets"));l===void 0&&(l=r.noSubsets),a.noSubsets=l!==void 0?l:!1;let d=de(n.getAttribute("fixedWidth"));d||(d=r.fixedWidth),a.fixedWidth=d;let c=de(n.getAttribute("fixedHeight"));c||(c=r.fixedHeight),a.fixedHeight=c;const u=["Style","AuthorityURL"];t?u.push("CRS"):u.push("SRS","Dimension"),u.forEach(function(g){if(g in r){const f=a[g]||[];a[g]=f.concat(r[g])}});const h=["BoundingBox","Attribution"];return t?h.push("Dimension","EX_GeographicBoundingBox","MinScaleDenominator","MaxScaleDenominator"):h.push("LatLonBoundingBox","ScaleHint","Extent"),h.forEach(function(g){if(!(g in a)){const f=r[g];a[g]=f}}),a}function Fi(n,e){const t={name:n.getAttribute("name"),units:n.getAttribute("units"),unitSymbol:n.getAttribute("unitSymbol")};return Ke(e)&&Object.assign(t,{default:n.getAttribute("default"),multipleValues:J(n.getAttribute("multipleValues")),nearestValue:J(n.getAttribute("nearestValue")),current:J(n.getAttribute("current")),values:A(n)}),t}function Pi(n,e){return{name:n.getAttribute("name"),default:n.getAttribute("default"),nearestValue:J(n.getAttribute("nearestValue"))}}function Ri(n,e){return{min:de(n.getAttribute("min")),max:de(n.getAttribute("max"))}}function ge(n,e){return V({},bi,n,e)}function Mi(n,e){return V({},fi,n,e)}function Di(n,e){return V({},yi,n,e)}function Oi(n,e){return V({},_i,n,e)}function De(n,e){return V({},mi,n,e)}function Kr(n,e){const t=ge(n,e);if(t){const r=[Bt(n.getAttribute("width")),Bt(n.getAttribute("height"))];return t.size=r,t}}function Ni(n,e){const t=ge(n,e);if(t)return t.name=n.getAttribute("name"),t}function Gi(n,e){const t=ge(n,e);if(t)return t.type=n.getAttribute("type"),t}function Bi(n,e){return V({},vi,n,e)}function Xr(n,e){return V([],xi,n,e)}function Vi({legendURL:n,layers:e="",url:t,typ:r,format:a,version:s}){return n?n==="ignore"?[]:[n]:e.split(",").filter(i=>i).map(i=>`${t}?SERVICE=${r}&REQUEST=GetLegendGraphic&FORMAT=${a||"image/png"}&VERSION=${s}&LAYER=${i}`)}const fr=(n,e)=>n.filter(t=>{let{minZoom:r,maxZoom:a}=t;return typeof r>"u"&&(r=0),typeof a>"u"&&(a=Number.MAX_SAFE_INTEGER),r<=e&&e<=a});function yt(n,e){if(Array.isArray(n))return n.map(t=>yt(t,e)).find(t=>t!==null)||null;if(typeof n=="object"){if(n.Name===e)return n;if(n.Layer)return yt(n.Layer,e)}return null}const Ui=n=>(Array.isArray(n)?n:[n]).map(e=>(Array.isArray(e.LegendURL)?e.LegendURL:typeof e.LegendURL=="object"?[e.LegendURL]:[]).map(t=>t.OnlineResource)).flat(1);function zi(n,e){return yt(n.Capability.Layer,e)?.Title||""}function Hi(n,e){const t=yt(n.Capability.Layer,e)?.Style;return t&&Ui(t)[0]||""}function Wi(n,e){const t=e[n];if(t)try{return new ii().read(t)}catch(r){console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:21:4)
`,`Error reading xml '${t}' for id '${n}'.`,r)}return null}function ji(n,e){return Promise.all(n.map(async t=>{const{id:r}=t,a=t.options?.layers;if(a&&(a.title===!0||a.legend===!0)){if(typeof e[r]=="string")return console.warn(`@polar/polar(plugins/layerChooser/utils/capabilities:41:6)
`,`Re-fired loadCapabilities on id '${r}' albeit the GetCapabilities have already been successfully fetched. No re-fetch will occur.`),[r,null];const s=vt.getLayerWhere({id:t.id});if(!s||!s.url||!s.version||!s.typ)return console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:49:6)
`,`Missing data for service '${s}' with id '${r}'.`),[r,null];const i=`${s.url}?service=${s.typ}&version=${s.version}&request=GetCapabilities`;try{const o=await fetch(i);return[r,await o.text()]}catch(o){return console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:61:6)
`,`Capabilities from ${i} could not be fetched.`,o),[r,null]}}return[r,null]})).then(t=>t.reduce((r,[a,s])=>B(r,{[a]:s}),{}))}function qi(n,e,t){const r=vt.getLayerWhere({id:n}),a=Wi(n,e);return{[n]:(t.order?.split(",")||r.layers.split(",")).map(s=>({layerName:s,displayName:t.title===!0&&a?zi(a,s):t.title===!1?s:t.title?.[s]||s,layerImage:t.legend===!0&&a?Hi(a,s):t.legend===!1?null:t.legend?.[s]||null}))}}const Ki=n=>n.reduce(([e,t],r)=>vt.getLayerWhere({id:r.id})===null?(console.error(`@polar/polar(plugins/layerChooser/utils/getBackgroundsAndMasks:15:5)
`,`Layer ${r.id} not found in service register. This is a configuration issue. The map might behave in unexpected ways.`,r),[e,t]):r.type==="background"?[[...e,r],t]:[e,[...t,r]],[[],[]]),Xi=n=>n.map(({id:e,name:t})=>({id:e,name:t})).map(e=>B(e,{rawLayer:vt.getLayerWhere({id:e.id})})).filter(({rawLayer:e})=>e!==null).reduce((e,t)=>{const r=Vi(t.rawLayer)[0];return typeof r=="string"?{...e,[t.id]:{name:t.name,url:r}}:e},{}),Pe=be("plugins/layerChooser",()=>{const n=Z(),e=P({}),t=P([]),r=P([]),a=P([]),s=P([]),i=P(""),o=P([]),l=P({}),d=P(""),c=P({}),u=P(""),h=L(()=>t.value.reduce((C,{id:k})=>({...C,[k]:a.value.findIndex(({id:T})=>T===k)===-1}),{})),g=L(()=>f.value.reduce((C,{id:k})=>({...C,[k]:s.value.findIndex(({id:T})=>T===k)===-1}),{})),f=L(()=>r.value.filter(({hideInMenu:C})=>!C)),m=L(()=>f.value.reduce((C,k)=>B(C,{[k.type]:Array.isArray(C[k.type])?C[k.type].concat(k):[k]}),{}));function v(){const[C,k]=Ki(n.configuration.layers);t.value=C,r.value=k,C.length===0&&console.error(`@polar/polar(plugins/layerChooser/store:100:4)
`,'No layers of type "background" have been configured.'),i.value=C.find(({visibility:T})=>T)?.id||"",o.value=k.filter(({visibility:T})=>T).map(({id:T})=>T),w(),n.map.on("moveend",w),l.value=Xi(n.configuration.layers),ji(n.configuration.layers,e.value).then(T=>{e.value=T,n.configuration.layers.forEach(D=>{const ie=D.options?.layers;ie&&(c.value=B(c.value,qi(D.id,T,ie)))})})}function p(){n.map.un("moveend",w)}Ae(i,C=>{n.map.getLayers().getArray().forEach(k=>{t.value.find(({id:T})=>T===k.get("id"))&&k.setVisible(k.get("id")===C)})}),Ae(o,C=>{y(C)});function y(C){n.map.getLayers().getArray().forEach(k=>{r.value.find(({id:T})=>T===k.get("id"))&&k.setVisible(C.includes(k.get("id")))})}function w(){const C=n.map.getView().getZoom();a.value=fr(t.value,C),s.value=fr(r.value,C);const k=a.value.map(({id:T})=>T);k.includes(i.value)||(i.value=k[0]||""),y(s.value.map(({id:T})=>T).filter(T=>o.value.includes(T)))}function S(C){const k=n.map.getLayers().getArray().find(T=>T.get("id")===u.value).getSource();if(!k){console.error(`@polar/polar(plugins/layerChooser/store:208:4)
`,`Action 'toggleOpenedOptionsServiceLayer' failed on ${u.value}. Layer not found in OpenLayers or source not initialized in OpenLayers.`);return}k.updateParams({...k.getParams(),LAYERS:C})}return{activeBackgroundId:i,activeMaskIds:o,backgrounds:t,capabilities:e,disabledBackgrounds:h,disabledMasks:g,layersWithLegends:l,layersWithOptions:c,masksSeparatedByType:m,shownMasks:f,openedLegendId:d,openedOptionsId:u,setupPlugin:v,teardownPlugin:p,toggleOpenedOptionsServiceLayer:S}}),se="layerChooser",Ji=["id"],Yi={class:"kern-label"},Jr=H({__name:"LayerInformationCard.ce",props:{identifier:{type:String},idName:{type:String}},setup(n){const e=n,t=Z(),r=Pe();pa(()=>{t.shadowRoot?.getElementById(`polar-layer-chooser-${e.identifier}-back-button`)?.focus()});function a(){const s=r[e.idName];r[e.idName]="",pt(()=>{t.shadowRoot?.getElementById(`polar-layer-chooser-${e.identifier}-${s}-button`)?.focus()})}return(s,i)=>(b(),M(wt,null,{default:he(()=>[I("button",{id:`polar-layer-chooser-${n.identifier}-back-button`,class:"kern-btn kern-btn--secondary",onClick:a},[i[0]||(i[0]=I("span",{class:"kern-icon kern-icon--arrow-back","aria-hidden":"true"},null,-1)),I("span",Yi,ae(s.$t(o=>o.returnToLayers,{ns:_(se)})),1)],8,Ji),Qt(s.$slots,"default")]),_:3}))}}),Qi={class:"kern-label",for:"polar-layer-chooser-legend-anchor"},Zi=["href","aria-label"],eo=["src","alt"],to=H({__name:"LayerLegend.ce",setup(n){const e=Pe(),t=L(()=>e.layersWithLegends[e.openedLegendId]);return(r,a)=>(b(),M(Jr,{identifier:"legend","id-name":"openedLegendId",class:"legend-card"},{default:he(()=>[I("label",Qi,ae(r.$t(s=>s.legend.to,{name:t.value.name,ns:_(se)})),1),I("a",{id:"polar-layer-chooser-legend-anchor",href:t.value.url,"aria-label":r.$t(s=>s.legend.to,{name:t.value.name,ns:_(se)}),target:"_blank"},[I("img",{src:t.value.url,alt:r.$t(s=>s.legend.to,{name:t.value.name,ns:_(se)})},null,8,eo)],8,Zi)]),_:1}))}}),ro=".legend-card[data-v-e248e19b]{overflow-y:scroll}",no=z(to,[["styles",[ro]],["__scopeId","data-v-e248e19b"]]),ao={class:"kern-form-check"},so=["id","name","value","type","disabled"],io=["for"],oo=H({__name:"PolarInput.ce",props:fa({idSuffix:{type:String},label:{type:String},type:{type:null},value:{type:String},disabled:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=ma(n,"modelValue");return(t,r)=>(b(),E("div",ao,[Zt(I("input",{id:`polar-${n.type}-${n.value}-${n.idSuffix}`,"onUpdate:modelValue":r[0]||(r[0]=a=>e.value=a),class:Ie(`polar-input kern-form-check__${n.type}`),name:n.value,value:n.value,type:n.type,disabled:n.disabled},null,10,so),[[ya,e.value]]),I("label",{class:"polar-input kern-label",for:`polar-${n.type}-${n.value}-${n.idSuffix}`},ae(n.label),9,io)]))}}),lo=".kern-form-check__radio[disabled],.kern-form-check__checkbox[disabled]{&[data-v-83635f17]:hover{border:var(--kern-metric-border-width-default) solid var(--kern-color-form-input-border)}}.kern-form-check__checkbox[disabled]{&[data-v-83635f17]:checked:hover:before{margin:var(--kern-metric-space-x-small)}}",Ht=z(oo,[["styles",[lo]],["__scopeId","data-v-83635f17"]]),co={class:"kern-fieldset"},uo={class:"kern-label"},ho={class:"kern-fieldset__body"},go=H({__name:"PolarInputGroup.ce",props:{legend:{type:String}},setup(n){return(e,t)=>(b(),E("fieldset",co,[I("legend",uo,ae(n.legend),1),I("div",ho,[Qt(e.$slots,"default",{},void 0,!0)])]))}}),po=".kern-fieldset[data-v-69d29a6c]{width:100%}.kern-fieldset__body[data-v-69d29a6c]{width:100%;padding:var(--kern-metric-space-small) 0;gap:var(--kern-metric-space-small);border-radius:var(--kern-metric-border-radius-default);background-color:var(--kern-color-layout-background-hued)}.kern-label[data-v-69d29a6c]{padding-left:.75rem}[data-v-69d29a6c] .kern-form-check{align-items:center;gap:var(--kern-metric-space-large);margin-left:.75rem;padding-right:0}",Wt=z(go,[["styles",[po]],["__scopeId","data-v-69d29a6c"]]),fo=["src","alt"],mo=H({__name:"LayerOptions.ce",setup(n){const e=Z(),t=Pe(),{openedOptionsId:r}=ue(t),a=L(()=>t.layersWithOptions[r.value]),s=P(a.value.map(({layerName:l})=>l).reverse()),i=L({get:()=>s.value,set:l=>{s.value=l,t.toggleOpenedOptionsServiceLayer(l)}}),o=L(()=>e.configuration.layers.find(({id:l})=>l===r.value)?.name||"");return(l,d)=>(b(),M(Jr,{identifier:"options","id-name":"openedOptionsId"},{default:he(()=>[$e(Wt,{legend:l.$t(c=>c.layerHeader,{ns:_(se),name:o.value})},{default:he(()=>[(b(!0),E(K,null,Q(a.value,({displayName:c,layerImage:u,layerName:h})=>(b(),E("div",{key:`polar-layer-chooser-mask-options-checkbox-${h}`,class:"polar-layer-chooser-options-checkbox-wrapper"},[u?(b(),E("img",{key:0,src:u,alt:h},null,8,fo)):W("",!0),$e(Ht,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=g=>i.value=g),"id-suffix":"polar-layer-chooser-mask-options",label:c,type:"checkbox",value:h,class:Ie(a.value.some(({layerImage:g})=>g!==null)?"polar-layer-chooser-options-checkbox":"")},null,8,["modelValue","label","value","class"])]))),128))]),_:1},8,["legend"])]),_:1}))}}),yo=".polar-layer-chooser-options-checkbox-wrapper[data-v-1ce80731]{display:flex;justify-content:flex-start;align-items:center;gap:var(--kern-metric-space-large)}.kern-form-check.polar-layer-chooser-options-checkbox[data-v-1ce80731]{margin-left:0}.kern-btn[data-v-1ce80731]{border:none;min-height:inherit;padding:var(--kern-metric-space-x-small)}.kern-label[data-v-1ce80731]{padding:0;padding-left:var(--kern-metric-space-small)}",_o=z(mo,[["styles",[yo]],["__scopeId","data-v-1ce80731"]]),vo=["id","disabled"],bo={class:"kern-label kern-sr-only"},mr=H({__name:"LegendButton.ce",props:{disabled:{type:Boolean},id:{type:String}},setup(n){return(e,t)=>(b(),E("button",{id:`polar-layer-chooser-legend-${n.id}-button`,class:"kern-btn kern-btn--tertiary",disabled:n.disabled},[t[0]||(t[0]=I("span",{class:"kern-icon kern-icon--info","aria-hidden":"true"},null,-1)),I("span",bo,ae(e.$t(r=>r.legend.open,{ns:_(se)})),1)],8,vo))}}),xo=["id","disabled","onClick"],ko={class:"kern-label kern-sr-only"},wo=H({__name:"LayerSelection.ce",setup(n){const e=Pe(),{activeBackgroundId:t,activeMaskIds:r,backgrounds:a,disabledBackgrounds:s,disabledMasks:i,layersWithOptions:o,masksSeparatedByType:l,openedLegendId:d,shownMasks:c}=ue(e),u=L(()=>Object.keys(e.layersWithLegends));function h(g){e.openedOptionsId=g}return(g,f)=>(b(),M(wt,{id:"polar-layer-chooser-card"},{default:he(()=>[_(a).length?(b(),M(Wt,{key:0,legend:g.$t(m=>m.backgroundTitle,{ns:_(se)})},{default:he(()=>[(b(!0),E(K,null,Q(_(a),({name:m,id:v})=>(b(),E("div",{key:`polar-layer-chooser-background-radio-${v}`,class:"polar-layer-chooser-input-wrapper"},[$e(Ht,{modelValue:_(t),"onUpdate:modelValue":f[0]||(f[0]=p=>gt(t)?t.value=p:null),"id-suffix":"polar-layer-chooser-background",label:m,type:"radio",value:v,disabled:_(s)[v]},null,8,["modelValue","label","value","disabled"]),u.value.includes(v)?(b(),M(mr,{key:0,id:v,disabled:_(s)[v],onClick:p=>d.value=v},null,8,["id","disabled","onClick"])):W("",!0)]))),128))]),_:1},8,["legend"])):W("",!0),_(c).length?(b(!0),E(K,{key:1},Q(Object.entries(_(l)),([m,v])=>(b(),M(Wt,{key:`polar-layer-chooser-mask-${m}`,legend:g.$t(p=>p[`${m}Title`],{ns:_(se)})},{default:he(()=>[(b(!0),E(K,null,Q(v,({name:p,id:y})=>(b(),E("div",{key:`polar-layer-chooser-mask-${m}-checkbox-${y}`,class:"polar-layer-chooser-input-wrapper"},[$e(Ht,{modelValue:_(r),"onUpdate:modelValue":f[1]||(f[1]=w=>gt(r)?r.value=w:null),"id-suffix":`polar-layer-chooser-mask-${m}`,label:p,type:"checkbox",value:y,disabled:_(i)[y]},null,8,["modelValue","id-suffix","label","value","disabled"]),Object.keys(_(o)).includes(y)?(b(),E("button",{key:0,id:`polar-layer-chooser-options-${y}-button`,class:"kern-btn kern-btn--tertiary",disabled:_(i)[y],onClick:()=>h(y)},[f[2]||(f[2]=I("span",{class:"kern-icon kern-icon-fill--settings","aria-hidden":"true"},null,-1)),I("span",ko,ae(g.$t(w=>w.layerOptions,{ns:_(se)})),1)],8,xo)):u.value.includes(y)?(b(),M(mr,{key:1,id:y,disabled:_(i)[y],onClick:w=>d.value=y},null,8,["id","disabled","onClick"])):W("",!0)]))),128))]),_:2},1032,["legend"]))),128)):W("",!0)]),_:1}))}}),Co="#polar-layer-chooser-card[data-v-c4509e12]{overflow-y:inherit}.polar-layer-chooser-input-wrapper[data-v-c4509e12]{display:flex;justify-content:space-between;align-items:center;gap:var(--kern-metric-space-large)}.kern-btn[data-v-c4509e12]{width:var(--kern-metric-dimension-large);min-height:var(--kern-metric-dimension-large);border:none;border-radius:50%}",So=z(wo,[["styles",[Co]],["__scopeId","data-v-c4509e12"]]),Eo=H({__name:"LayerChooser.ce",setup(n){const e=Pe(),t=L(()=>e.openedLegendId.length!==0),r=L(()=>e.openedOptionsId.length===0&&!t.value);return(a,s)=>r.value?(b(),M(So,{key:0})):t.value?(b(),M(no,{key:1})):(b(),M(_o,{key:2}))}}),To={backgroundTitle:"Hintergrundkarten",maskTitle:"Fachdaten",layerHeader:'Auswahl sichtbarer Ebenen für Layer "{{name}}"',layerOptions:"Optionen für Kartenmaterial",legend:{title:"Legende",to:'Legendenbild zu "{{name}}"',open:`$t(legend.to, {ns: ${se}}) öffnen`},returnToLayers:"Zurück"},Lo={backgroundTitle:"Background maps",maskTitle:"Subject data",layerHeader:'Visible layer selection for layer "{{name}}"',layerOptions:"Map data options",legend:{title:"Legend",to:'"{{name}}" legend image',open:`Open $t(legend.to, {ns: ${se}})`},returnToLayers:"Back"},$o=[{type:"de",resources:To},{type:"en",resources:Lo}];function Io(n){return{id:se,component:Eo,icon:"kern-icon-fill--layers",locales:$o,storeModule:Pe,options:n}}const Ao=["KernLoader","BasicLoader","RingLoader","RollerLoader","CircleLoader","SpinnerLoader"],Yr=be("plugins/loadingIndicator",()=>{const n=P(new Set),e=P("KernLoader"),t=L(()=>n.value.size>0);function r(){const l=Z().configuration.loadingIndicator?.loaderStyle;l&&o(l)}function a(){o("KernLoader")}function s(l){n.value=new Set([...n.value,l])}function i(l){const d=new Set(n.value);d.delete(l),n.value=d}function o(l){Ao.includes(l)?e.value=l:console.error(`@polar/polar(plugins/loadingIndicator/store:62:5)
`,`Loader style ${l} does not exist. Using previous style (${e.value}).`)}return{loaderStyle:e,showLoader:t,addLoadingKey:s,removeLoadingKey:i,setLoaderStyle:o,setupPlugin:r,teardownPlugin:a}}),Fo={class:"lds-default"},Po=H({__name:"BasicLoader.ce",setup(n){return(e,t)=>(b(),E("div",Fo,[(b(),E(K,null,Q(12,r=>I("div",{key:r})),64))]))}}),Ro=".lds-default[data-v-6079aaec]{color:var(--kern-color-action-default)}.lds-default[data-v-6079aaec],.lds-default div[data-v-6079aaec]{box-sizing:border-box}.lds-default[data-v-6079aaec]{display:inline-block;position:relative;width:80px;height:80px}.lds-default div[data-v-6079aaec]{position:absolute;width:6.4px;height:6.4px;background:currentColor;border-radius:50%;animation:lds-default-6079aaec 1.2s linear infinite}.lds-default div[data-v-6079aaec]:nth-child(1){animation-delay:0s;top:36.8px;left:66.24px}.lds-default div[data-v-6079aaec]:nth-child(2){animation-delay:-.1s;top:22.08px;left:62.29579px}.lds-default div[data-v-6079aaec]:nth-child(3){animation-delay:-.2s;top:11.30421px;left:51.52px}.lds-default div[data-v-6079aaec]:nth-child(4){animation-delay:-.3s;top:7.36px;left:36.8px}.lds-default div[data-v-6079aaec]:nth-child(5){animation-delay:-.4s;top:11.30421px;left:22.08px}.lds-default div[data-v-6079aaec]:nth-child(6){animation-delay:-.5s;top:22.08px;left:11.30421px}.lds-default div[data-v-6079aaec]:nth-child(7){animation-delay:-.6s;top:36.8px;left:7.36px}.lds-default div[data-v-6079aaec]:nth-child(8){animation-delay:-.7s;top:51.52px;left:11.30421px}.lds-default div[data-v-6079aaec]:nth-child(9){animation-delay:-.8s;top:62.29579px;left:22.08px}.lds-default div[data-v-6079aaec]:nth-child(10){animation-delay:-.9s;top:66.24px;left:36.8px}.lds-default div[data-v-6079aaec]:nth-child(11){animation-delay:-1s;top:62.29579px;left:51.52px}.lds-default div[data-v-6079aaec]:nth-child(12){animation-delay:-1.1s;top:51.52px;left:62.29579px}@keyframes lds-default-6079aaec{0%,20%,80%,to{transform:scale(1)}50%{transform:scale(1.5)}}",Mo=z(Po,[["styles",[Ro]],["__scopeId","data-v-6079aaec"]]),Do={},Oo=".lds-circle[data-v-149ac9d5]{color:var(--kern-color-action-default)}.lds-circle[data-v-149ac9d5],.lds-circle div[data-v-149ac9d5]{box-sizing:border-box}.lds-circle[data-v-149ac9d5]{display:inline-block;transform:translateZ(1px);width:80px;height:80px}.lds-circle>div[data-v-149ac9d5]{display:inline-block;width:64px;height:64px;margin:8px;background:currentColor;border-radius:50%;animation:lds-circle-149ac9d5 2.4s cubic-bezier(0,.2,.8,1) infinite}@keyframes lds-circle-149ac9d5{0%,to{animation-timing-function:cubic-bezier(.5,0,1,.5)}0%{transform:rotateY(0)}50%{transform:rotateY(1800deg);animation-timing-function:cubic-bezier(0,.5,.5,1)}to{transform:rotateY(3600deg)}}",No={class:"lds-circle"};function Go(n,e,t,r,a,s){return b(),E("div",No,[...e[0]||(e[0]=[I("div",null,null,-1)])])}const Bo=z(Do,[["render",Go],["styles",[Oo]],["__scopeId","data-v-149ac9d5"]]),Vo={},Uo=".lds-ring[data-v-712a38e8]{color:var(--kern-color-action-default)}.lds-ring[data-v-712a38e8],.lds-ring div[data-v-712a38e8]{box-sizing:border-box}.lds-ring[data-v-712a38e8]{display:inline-block;position:relative;width:80px;height:80px}.lds-ring div[data-v-712a38e8]{box-sizing:border-box;display:block;position:absolute;width:64px;height:64px;margin:8px;border:8px solid currentColor;border-radius:50%;animation:lds-ring-712a38e8 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:currentColor transparent transparent transparent}.lds-ring div[data-v-712a38e8]:nth-child(1){animation-delay:-.45s}.lds-ring div[data-v-712a38e8]:nth-child(2){animation-delay:-.3s}.lds-ring div[data-v-712a38e8]:nth-child(3){animation-delay:-.15s}@keyframes lds-ring-712a38e8{0%{transform:rotate(0)}to{transform:rotate(360deg)}}",zo={class:"lds-ring"};function Ho(n,e,t,r,a,s){return b(),E("div",zo,[(b(),E(K,null,Q(4,i=>I("div",{key:i})),64))])}const Wo=z(Vo,[["render",Ho],["styles",[Uo]],["__scopeId","data-v-712a38e8"]]),jo={},qo='.lds-roller[data-v-c8254b29]{color:var(--kern-color-action-default)}.lds-roller[data-v-c8254b29],.lds-roller div[data-v-c8254b29],.lds-roller div[data-v-c8254b29]:after{box-sizing:border-box}.lds-roller[data-v-c8254b29]{display:inline-block;position:relative;width:80px;height:80px}.lds-roller div[data-v-c8254b29]{animation:lds-roller-c8254b29 1.2s cubic-bezier(.5,0,.5,1) infinite;transform-origin:40px 40px}.lds-roller div[data-v-c8254b29]:after{content:" ";display:block;position:absolute;width:7.2px;height:7.2px;border-radius:50%;background:currentColor;margin:-3.6px 0 0 -3.6px}.lds-roller div[data-v-c8254b29]:nth-child(1){animation-delay:-36ms}.lds-roller div[data-v-c8254b29]:nth-child(1):after{top:62.62742px;left:62.62742px}.lds-roller div[data-v-c8254b29]:nth-child(2){animation-delay:-72ms}.lds-roller div[data-v-c8254b29]:nth-child(2):after{top:67.71281px;left:56px}.lds-roller div[data-v-c8254b29]:nth-child(3){animation-delay:-.108s}.lds-roller div[data-v-c8254b29]:nth-child(3):after{top:70.90963px;left:48.28221px}.lds-roller div[data-v-c8254b29]:nth-child(4){animation-delay:-.144s}.lds-roller div[data-v-c8254b29]:nth-child(4):after{top:72px;left:40px}.lds-roller div[data-v-c8254b29]:nth-child(5){animation-delay:-.18s}.lds-roller div[data-v-c8254b29]:nth-child(5):after{top:70.90963px;left:31.71779px}.lds-roller div[data-v-c8254b29]:nth-child(6){animation-delay:-.216s}.lds-roller div[data-v-c8254b29]:nth-child(6):after{top:67.71281px;left:24px}.lds-roller div[data-v-c8254b29]:nth-child(7){animation-delay:-.252s}.lds-roller div[data-v-c8254b29]:nth-child(7):after{top:62.62742px;left:17.37258px}.lds-roller div[data-v-c8254b29]:nth-child(8){animation-delay:-.288s}.lds-roller div[data-v-c8254b29]:nth-child(8):after{top:56px;left:12.28719px}@keyframes lds-roller-c8254b29{0%{transform:rotate(0)}to{transform:rotate(360deg)}}',Ko={class:"lds-roller"};function Xo(n,e,t,r,a,s){return b(),E("div",Ko,[(b(),E(K,null,Q(8,i=>I("div",{key:i})),64))])}const Jo=z(jo,[["render",Xo],["styles",[qo]],["__scopeId","data-v-c8254b29"]]),Yo={},Qo='.lds-spinner[data-v-1790c8de]{color:var(--kern-color-action-default)}.lds-spinner[data-v-1790c8de],.lds-spinner div[data-v-1790c8de],.lds-spinner div[data-v-1790c8de]:after{box-sizing:border-box}.lds-spinner[data-v-1790c8de]{color:currentColor;display:inline-block;position:relative;width:80px;height:80px}.lds-spinner div[data-v-1790c8de]{transform-origin:40px 40px;animation:lds-spinner-1790c8de 1.2s linear infinite}.lds-spinner div[data-v-1790c8de]:after{content:" ";display:block;position:absolute;top:3.2px;left:36.8px;width:6.4px;height:17.6px;border-radius:20%;background:currentColor}.lds-spinner div[data-v-1790c8de]:nth-child(1){transform:rotate(0);animation-delay:-1.1s}.lds-spinner div[data-v-1790c8de]:nth-child(2){transform:rotate(30deg);animation-delay:-1s}.lds-spinner div[data-v-1790c8de]:nth-child(3){transform:rotate(60deg);animation-delay:-.9s}.lds-spinner div[data-v-1790c8de]:nth-child(4){transform:rotate(90deg);animation-delay:-.8s}.lds-spinner div[data-v-1790c8de]:nth-child(5){transform:rotate(120deg);animation-delay:-.7s}.lds-spinner div[data-v-1790c8de]:nth-child(6){transform:rotate(150deg);animation-delay:-.6s}.lds-spinner div[data-v-1790c8de]:nth-child(7){transform:rotate(180deg);animation-delay:-.5s}.lds-spinner div[data-v-1790c8de]:nth-child(8){transform:rotate(210deg);animation-delay:-.4s}.lds-spinner div[data-v-1790c8de]:nth-child(9){transform:rotate(240deg);animation-delay:-.3s}.lds-spinner div[data-v-1790c8de]:nth-child(10){transform:rotate(270deg);animation-delay:-.2s}.lds-spinner div[data-v-1790c8de]:nth-child(11){transform:rotate(300deg);animation-delay:-.1s}.lds-spinner div[data-v-1790c8de]:nth-child(12){transform:rotate(330deg);animation-delay:0s}@keyframes lds-spinner-1790c8de{0%{opacity:1}to{opacity:0}}',Zo={class:"lds-spinner"};function el(n,e,t,r,a,s){return b(),E("div",Zo,[(b(),E(K,null,Q(12,i=>I("div",{key:i})),64))])}const tl=z(Yo,[["render",el],["styles",[Qo]],["__scopeId","data-v-1790c8de"]]),rl={key:0,class:"polar-plugin-loading-indicator-wrapper"},nl={key:0,class:"polar-plugin-loading-indicator-overlay"},al={key:0,class:"kern-loader kern-loader--visible",role:"status"},sl=H({__name:"LoadingIndicator.ce",setup(n){const{layout:e}=ue(Z()),{loaderStyle:t,showLoader:r}=ue(Yr()),a={BasicLoader:Mo,CircleLoader:Bo,RingLoader:Wo,RollerLoader:Jo,SpinnerLoader:tl};return(s,i)=>_(r)&&_(t)!==null?(b(),E("div",rl,[_(e)==="standard"?(b(),E("div",nl)):W("",!0),$e(wt,null,{default:he(()=>[_(t)==="KernLoader"?(b(),E("div",al)):(b(),M(ft(a[_(t)]),{key:1,class:"kern-loader--visible",role:"status"}))]),_:1})])):W("",!0)}}),il=".polar-plugin-loading-indicator-wrapper{&[data-v-d34e6512]{z-index:100;position:absolute;display:flex;align-items:center;justify-content:center;width:100%;height:100%}.polar-plugin-loading-indicator-overlay[data-v-d34e6512]{position:absolute;width:100%;height:100%;opacity:var(--kern-color-action-state-opacity-overlay);background:#fff}.kern-card[data-v-d34e6512]{min-width:fit-content;height:fit-content;border-radius:50%}[data-v-d34e6512] .kern-card__container{padding:var(--kern-metric-space-small)!important}}",ol=z(sl,[["styles",[il]],["__scopeId","data-v-d34e6512"]]),ll="loadingIndicator";function dl(n){return{id:ll,component:ol,storeModule:Yr,options:n}}class Xe extends qn{constructor(e,t,r){super(),r!==void 0&&t===void 0?this.setFlatCoordinates(r,e):(t=t||0,this.setCenterAndRadius(e,t,r))}clone(){const e=new Xe(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,a){const s=this.flatCoordinates,i=e-s[0],o=t-s[1],l=i*i+o*o;if(l<a){if(l===0)for(let d=0;d<this.stride;++d)r[d]=s[d];else{const d=this.getRadius()/Math.sqrt(l);r[0]=s[0]+d*i,r[1]=s[1]+d*o;for(let c=2;c<this.stride;++c)r[c]=s[c]}return r.length=this.stride,l}return a}containsXY(e,t){const r=this.flatCoordinates,a=e-r[0],s=t-r[1];return a*a+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,r=t[this.stride]-t[0];return Kn(t[0]-r,t[1]-r,t[0]+r,t[1]+r,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(Xn(e,t)){const r=this.getCenter();return e[0]<=r[0]&&e[2]>=r[0]||e[1]<=r[1]&&e[3]>=r[1]?!0:Jn(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,r=this.flatCoordinates[t]-this.flatCoordinates[0],a=e.slice();a[t]=a[0]+r;for(let s=1;s<t;++s)a[t+s]=e[s];this.setFlatCoordinates(this.layout,a),this.changed()}setCenterAndRadius(e,t,r){this.setLayout(r,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const a=this.flatCoordinates;let s=Yn(a,0,e,this.stride);a[s++]=a[0]+t;for(let i=1,o=this.stride;i<o;++i)a[s++]=a[i];a.length=s,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const r=this.getCenter(),a=this.getStride();this.setCenter(Qn(r,0,r.length,a,e,t,r)),this.changed()}}Xe.prototype.transform;function ye(n,e){const t=n.length;return e<0?n[e+t]:e>=t?n[e-t]:n[e]}function Se(n,e){const t=n.length;let r=Math.floor(e);const a=e-r;r>=t?r-=t:r<0&&(r+=t);let s=r+1;s>=t&&(s-=t);const i=n[r],o=i[0],l=i[1],d=n[s],c=d[0]-o,u=d[1]-l;return[o+c*a,l+u*a]}const Qe={index:-1,endIndex:NaN,closestTargetDistance:1/0};function Qr(n,e,t,r){const a=n[0],s=n[1];let i=1/0,o=-1,l=NaN;for(let u=0;u<e.targets.length;++u){const h=e.targets[u],g=h.coordinates;let f=1/0,m;for(let v=0;v<g.length-1;++v){const p=g[v],y=g[v+1],w=tn(a,s,p,y);w.squaredDistance<f&&(f=w.squaredDistance,m=v+w.along)}f<i&&(i=f,h.ring&&e.targetIndex===u&&(h.endIndex>h.startIndex?m<h.startIndex&&(m+=g.length):h.endIndex<h.startIndex&&m>h.startIndex&&(m-=g.length)),l=m,o=u)}const d=e.targets[o];let c=d.ring;if(e.targetIndex===o&&c){const u=Se(d.coordinates,l),h=t.getPixelFromCoordinate(u),g=t.getPixelFromCoordinate(e.startCoord);we(h,g)>r&&(c=!1)}if(c){const u=d.coordinates,h=u.length,g=d.startIndex,f=l;if(g<f){const m=tt(u,g,f);tt(u,g,f-h)<m&&(l-=h)}else{const m=tt(u,g,f);tt(u,g,f+h)<m&&(l+=h)}}return Qe.index=o,Qe.endIndex=l,Qe.closestTargetDistance=i,Qe}function Zr(n,e){const t=[];for(let r=0;r<e.length;++r){const a=e[r].getGeometry();en(n,a,t)}return t}function en(n,e,t){if(e instanceof Ve){Ze(n,e.getCoordinates(),!1,t);return}if(e instanceof Kt){const r=e.getCoordinates();for(let a=0,s=r.length;a<s;++a)Ze(n,r[a],!1,t);return}if(e instanceof _t){const r=e.getCoordinates();for(let a=0,s=r.length;a<s;++a)Ze(n,r[a],!0,t);return}if(e instanceof Xt){const r=e.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a];for(let o=0,l=i.length;o<l;++o)Ze(n,i[o],!0,t)}return}if(e instanceof Zn){const r=e.getGeometries();for(let a=0;a<r.length;++a)en(n,r[a],t);return}}function Ze(n,e,t,r){const a=n[0],s=n[1];for(let i=0,o=e.length-1;i<o;++i){const l=e[i],d=e[i+1],c=tn(a,s,l,d);if(c.squaredDistance===0){const u=i+c.along;r.push({coordinates:e,ring:t,startIndex:u,endIndex:u});return}}}function et(n,e){return Ir(n[0],n[1],e[0],e[1])}function tt(n,e,t){let r,a;e<t?(r=e,a=t):(r=t,a=e);const s=Math.ceil(r),i=Math.floor(a);if(s>i){const l=Se(n,r),d=Se(n,a);return et(l,d)}let o=0;if(r<s){const l=Se(n,r),d=ye(n,s);o+=et(l,d)}if(i<a){const l=ye(n,i),d=Se(n,a);o+=et(l,d)}for(let l=s;l<i-1;++l){const d=ye(n,l),c=ye(n,l+1);o+=et(d,c)}return o}const Rt={along:0,squaredDistance:0};function tn(n,e,t,r){const a=t[0],s=t[1],i=r[0],o=r[1],l=i-a,d=o-s;let c=0,u=a,h=s;return(l!==0||d!==0)&&(c=ra(((n-a)*l+(e-s)*d)/(l*l+d*d),0,1),u+=l*c,h+=d*c),Rt.along=c,Rt.squaredDistance=ea(Ir(n,e,u,h),10),Rt}const rt={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class nt extends qe{constructor(e,t){super(e),this.feature=t}}class cl extends qt{constructor(e){const t=e;t.stopDown||(t.stopDown=Mn),super(t),this.on,this.once,this.un,this.options_=e,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=hl(this.type_),this.stopClick_=!!e.stopClick,this.ignoreNextUpEvent_=!1,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:He,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let r=e.geometryFunction;if(!r){const a=this.mode_;if(a==="Circle")r=(s,i,o)=>{const l=i||new Xe([NaN,NaN]),d=j(s[0]),c=ut(d,j(s[s.length-1]));return l.setCenterAndRadius(d,Math.sqrt(c),this.geometryLayout_),l};else{let s;a==="Point"?s=ce:a==="LineString"?s=Ve:a==="Polygon"&&(s=_t),r=(i,o,l)=>(o?a==="Polygon"?i[0].length?o.setCoordinates([i[0].concat([i[0][0]])],this.geometryLayout_):o.setCoordinates([],this.geometryLayout_):o.setCoordinates(i,this.geometryLayout_):o=new s(i,this.geometryLayout_),o)}}this.geometryFunction_=r,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Fe({source:new je({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:ul(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:Dn,this.freehandCondition_,e.freehand?this.freehandCondition_=Te:this.freehandCondition_=e.freehandCondition?e.freehandCondition:Vt,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(Tr.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=Te:t=e:t=ct,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}setFreehand(e){this.freehand_=e,this.freehand_?this.freehandCondition_=Te:this.freehandCondition_=this.options_&&this.options_.freehandCondition?this.options_.freehandCondition:Vt}getOverlay(){return this.overlay_}getFreehand(){return this.freehand_}handleEvent(e){e.originalEvent.type===Ut.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===te.POINTERMOVE,r=!0;return!this.freehand_&&this.lastDragTime_&&e.type===te.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===te.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),r=!1):this.freehand_&&e.type===te.POINTERDOWN?r=!1:t&&this.getPointerCount()<2?(r=e.type===te.POINTERMOVE,r&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===te.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===te.DBLCLICK&&(r=!1),super.handleEvent(e)&&r}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new On(te.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),r=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),a=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),s=X([r,a]),i=this.traceSource_.getFeaturesInExtent(s);if(i.length===0)return;const o=Zr(e.coordinate,i);o.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:o,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const r=e.startIndex<=e.endIndex,a=e.startIndex<=t;r===a?r&&t>e.endIndex||!r&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(r&&t<e.endIndex||!r&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let r=0;if(e<t){const a=Math.ceil(e);let s=Math.floor(t);s===t&&(s-=1),r=s-a+1}else{const a=Math.floor(e);let s=Math.ceil(t);s===t&&(s+=1),r=a-s+1}r>0&&this.removeLastPoints_(r)}addTracedCoordinates_(e,t,r){if(t===r)return;const a=[];if(t<r){const s=Math.ceil(t);let i=Math.floor(r);i===r&&(i-=1);for(let o=s;o<=i;++o)a.push(ye(e.coordinates,o))}else{const s=Math.floor(t);let i=Math.ceil(r);i===r&&(i+=1);for(let o=s;o>=i;--o)a.push(ye(e.coordinates,o))}a.length&&this.appendCoordinates(a)}updateTrace_(e){const t=this.traceState_;if(!t.active)return;if(t.targetIndex===-1){const o=e.map.getPixelFromCoordinate(t.startCoord);if(we(o,e.pixel)<this.snapTolerance_)return}const r=Qr(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==r.index){if(t.targetIndex!==-1){const l=t.targets[t.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const o=t.targets[r.index];this.addTracedCoordinates_(o,o.startIndex,r.endIndex)}else{const o=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(o,r.endIndex)}t.targetIndex=r.index;const a=t.targets[t.targetIndex];a.endIndex=r.endIndex;const s=Se(a.coordinates,a.endIndex),i=this.getMap().getPixelFromCoordinate(s);e.coordinate=s,e.pixel=[Math.round(i[0]),Math.round(i[1])]}handleDragEvent(e){this.ignoreNextUpEvent_=!0,super.handleDragEvent(e)}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const r=this.traceState_.active;if(this.ignoreNextUpEvent_||this.toggleTraceState_(e),this.shouldHandle_){const a=!this.finishCoordinate_;a&&this.startDrawing_(e.coordinate),!a&&this.freehand_?this.finishDrawing():!this.freehand_&&(!a||this.mode_==="Point")&&(this.atFinish_(e.pixel,r)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return this.ignoreNextUpEvent_=!1,!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,r=e.pixel,a=t[0]-r[0],s=t[1]-r[1],i=a*a+s*s;if(this.shouldHandle_=this.freehand_?i>this.squaredClickTolerance_:i<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let r=!1;if(this.sketchFeature_){let a=!1,s=[this.finishCoordinate_];const i=this.mode_;if(i==="Point")r=!0;else if(i==="Circle")r=this.sketchCoords_.length===2;else if(i==="LineString")a=!t&&this.sketchCoords_.length>this.minPoints_;else if(i==="Polygon"){const o=this.sketchCoords_;a=o[0].length>this.minPoints_,s=[o[0][0],o[0][o[0].length-2]],t?s=[o[0][0]]:s=[o[0][0],o[0][o[0].length-2]]}if(a){const o=this.getMap();for(let l=0,d=s.length;l<d;l++){const c=s[l],u=o.getPixelFromCoordinate(c),h=e[0]-u[0],g=e[1]-u[1],f=this.freehand_?1:this.snapTolerance_;if(r=Math.sqrt(h*h+g*g)<=f,r){this.finishCoordinate_=c;break}}}}return r}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new ne(new ce(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new ne);const t=e.getLinearRing(0);let r=this.sketchLine_.getGeometry();r?(r.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),r.changed()):(r=new Ve(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(r))}startDrawing_(e){const t=this.getMap().getView().getProjection(),r=ir(this.geometryLayout_);for(;e.length<r;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new ne(new Ve(this.sketchLineCoords_)));const a=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new ne,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(a),this.updateSketchFeatures_(),this.dispatchEvent(new nt(rt.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),r=this.sketchFeature_.getGeometry(),a=t.getView().getProjection(),s=ir(this.geometryLayout_);let i,o;for(;e.length<s;)e.push(0);this.mode_==="Point"?o=this.sketchCoords_:this.mode_==="Polygon"?(i=this.sketchCoords_[0],o=i[i.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(i=this.sketchCoords_,o=i[i.length-1]),o[0]=e[0],o[1]=e[1],this.geometryFunction_(this.sketchCoords_,r,a),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),r.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(r):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection();let a,s;const i=this.mode_;return i==="LineString"||i==="Circle"?(this.finishCoordinate_=e.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():a=!0),s.push(e.slice()),this.geometryFunction_(s,t,r)):i==="Polygon"&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():a=!0),s.push(e.slice()),a&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,t,r)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),a?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),a=this.mode_;for(let s=0;s<e;++s){let i;if(a==="LineString"||a==="Circle"){if(i=this.sketchCoords_,i.splice(-2,1),i.length>=2){this.finishCoordinate_=i[i.length-2].slice();const o=this.finishCoordinate_.slice();i[i.length-1]=o,this.createOrUpdateSketchPoint_(o)}this.geometryFunction_(i,t,r),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(a==="Polygon"){i=this.sketchCoords_[0],i.splice(-2,1);const o=this.sketchLine_.getGeometry();if(i.length>=2){const l=i[i.length-2].slice();i[i.length-1]=l,this.createOrUpdateSketchPoint_(l)}o.setCoordinates(i),this.geometryFunction_(this.sketchCoords_,t,r)}if(i.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return null;let t=this.sketchCoords_;const r=e.getGeometry(),a=this.getMap().getView().getProjection();return this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,r,a)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,r,a),t=r.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new Lr([t])):this.type_==="MultiLineString"?e.setGeometry(new Kt([t])):this.type_==="MultiPolygon"&&e.setGeometry(new Xt([t])),this.dispatchEvent(new nt(rt.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new nt(rt.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,r=!this.sketchFeature_;r&&this.startDrawing_(e[0]);let a;if(t==="LineString"||t==="Circle")a=this.sketchCoords_;else if(t==="Polygon")a=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;r&&a.shift(),a.pop();for(let i=0;i<e.length;i++)this.addToDrawing_(e[i]);const s=e[e.length-1];this.sketchFeature_=this.addToDrawing_(s),this.modifyDrawing_(s)}extend(e){const t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();const r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.sketchPoint_=new ne(new ce(r)),this.updateSketchFeatures_(),this.dispatchEvent(new nt(rt.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function ul(){const n=Jt();return function(e,t){return n[e.getGeometry().getType()]}}function hl(n){switch(n){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+n)}}const yr=0,ze=1,_r=[0,0,0,0],Le=[],Mt={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};function Dt(n,e,t){let r;switch(e){case"LineString":r=n;break;case"MultiLineString":case"Polygon":r=n[t[0]];break;case"MultiPolygon":r=n[t[1]][t[0]];break}return r}class Ot extends qe{constructor(e,t,r){super(e),this.features=t,this.mapBrowserEvent=r}}class gl extends qt{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:Nn,this.defaultDeleteCondition_=function(r){return Gn(r)&&Er(r)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:Te,this.vertexFeature_=null,this.vertexSegments_=null,this.lastCoordinate_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new Bn,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Fe({source:new je({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:fl(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.traceSource_=e.traceSource||e.source||null,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSegments_=null,this.hitDetection_=null;let t;if(e.features?t=e.features:e.source&&(this.source_=e.source,t=new Ee(this.source_.getFeatures()),this.source_.addEventListener(or.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(or.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(ke.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(ke.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}setTrace(e){let t;e?e===!0?t=Te:t=e:t=ct,this.traceCondition_=t}addFeature_(e){const t=e.getGeometry();if(t){const a=this.SEGMENT_WRITERS_[t.getType()];a&&a(e,t)}const r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastCoordinate_),e.addEventListener(Ut.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Ee;const r=this.featuresBeingModified_.getArray();for(let a=0,s=t.length;a<s;++a){const i=t[a].feature;i&&!r.includes(i)&&this.featuresBeingModified_.push(i)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new Ot(Mt.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(Ut.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,r=[];t.forEach(function(a){e===a.feature&&r.push(a)});for(let a=r.length-1;a>=0;--a){const s=r[a];for(let i=this.dragSegments_.length-1;i>=0;--i)this.dragSegments_[i][0]===s&&this.dragSegments_.splice(i,1);t.remove(s)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const r=t.getCoordinates(),a={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),a)}writeMultiPointGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a],o={feature:e,geometry:t,depth:[a],index:a,segment:[i,i]};this.rBush_.insert(t.getExtent(),o)}}writeLineStringGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length-1;a<s;++a){const i=r.slice(a,a+2),o={feature:e,geometry:t,index:a,segment:i};this.rBush_.insert(X(i),o)}}writeMultiLineStringGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a];for(let o=0,l=i.length-1;o<l;++o){const d=i.slice(o,o+2),c={feature:e,geometry:t,depth:[a],index:o,segment:d};this.rBush_.insert(X(d),c)}}}writePolygonGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a];for(let o=0,l=i.length-1;o<l;++o){const d=i.slice(o,o+2),c={feature:e,geometry:t,depth:[a],index:o,segment:d};this.rBush_.insert(X(d),c)}}}writeMultiPolygonGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a];for(let o=0,l=i.length;o<l;++o){const d=i[o];for(let c=0,u=d.length-1;c<u;++c){const h=d.slice(c,c+2),g={feature:e,geometry:t,depth:[o,a],index:c,segment:h};this.rBush_.insert(X(h),g)}}}}writeCircleGeometry_(e,t){const r=t.getCenter(),a={feature:e,geometry:t,index:yr,segment:[r,r]},s={feature:e,geometry:t,index:ze,segment:[r,r]},i=[a,s];a.featureSegments=i,s.featureSegments=i,this.rBush_.insert(At(r),a);let o=t;this.rBush_.insert(o.getExtent(),s)}writeGeometryCollectionGeometry_(e,t){const r=t.getGeometriesArray();for(let a=0;a<r.length;++a){const s=r[a],i=this.SEGMENT_WRITERS_[s.getType()];i(e,s)}}createOrUpdateVertexFeature_(e,t,r,a){let s=this.vertexFeature_;return s?s.getGeometry().setCoordinates(e):(s=new ne(new ce(e)),this.vertexFeature_=s,this.overlay_.getSource().addFeature(s)),s.set("features",t),s.set("geometries",r),s.set("existing",a),s}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let t;return!e.map.getView().getInteracting()&&e.type==te.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=te.SINGLECLICK||!this.ignoreNextSingleClick_?t=this.removePoint():t=!0),e.type==te.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}findInsertVerticesAndUpdateDragSegments_(e){if(this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null,!this.vertexFeature_)return;this.getMap().getView().getProjection();const t=[],r=this.vertexFeature_.getGeometry().getCoordinates(),a=X([r]),s=this.rBush_.getInExtent(a),i={};s.sort(pl);for(let o=0,l=s.length;o<l;++o){const d=s[o],c=d.segment;let u=re(d.geometry);const h=d.depth;if(h&&(u+="-"+h.join("-")),i[u]||(i[u]=new Array(2)),d.geometry.getType()==="Circle"&&d.index===ze){const g=br(e,d);oe(g,r)&&!i[u][0]&&(this.dragSegments_.push([d,0]),i[u][0]=d);continue}if(oe(c[0],r)&&!i[u][0]){this.dragSegments_.push([d,0]),i[u][0]=d;continue}if(oe(c[1],r)&&!i[u][1]){if(i[u][0]&&i[u][0].index===0){let g=d.geometry.getCoordinates();switch(d.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":g=g[h[1]];case"Polygon":if(d.index!==g[h[0]].length-2)continue;break}}this.dragSegments_.push([d,1]),i[u][1]=d;continue}re(c)in this.vertexSegments_&&!i[u][0]&&!i[u][1]&&t.push(d)}return t}deactivateTrace_(){this.traceState_={active:!1}}updateTrace_(e){const t=this.traceState_;if(!t.active)return;if(t.targetIndex===-1){const s=e.map.getPixelFromCoordinate(t.startCoord);if(we(s,e.pixel)<this.pixelTolerance_)return}const r=Qr(e.coordinate,t,e.map,this.pixelTolerance_);if(t.targetIndex===-1&&Math.sqrt(r.closestTargetDistance)/e.map.getView().getResolution()>this.pixelTolerance_)return;if(t.targetIndex!==r.index){if(t.targetIndex!==-1){const i=t.targets[t.targetIndex];this.removeTracedCoordinates_(i.startIndex,i.endIndex)}else for(const i of this.traceSegments_){const o=i[0],l=o.geometry,d=i[1],c=l.getCoordinates();Dt(c,l.getType(),o.depth).splice(o.index+d,1),l.setCoordinates(c),d===0&&(o.index-=1)}const s=t.targets[r.index];this.addTracedCoordinates_(s,s.startIndex,r.endIndex)}else{const s=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(s,r.endIndex)}t.targetIndex=r.index;const a=t.targets[t.targetIndex];a.endIndex=r.endIndex}getTraceCandidates_(e){const t=this.getMap(),r=this.pixelTolerance_,a=t.getCoordinateFromPixel([e.pixel[0]-r,e.pixel[1]+r]),s=t.getCoordinateFromPixel([e.pixel[0]+r,e.pixel[1]-r]),i=X([a,s]);return this.traceSource_.getFeaturesInExtent(i)}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_(),this.traceSegments_=null;return}const t=this.getTraceCandidates_(e);if(t.length===0)return;const r=Zr(e.coordinate,t);r.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:r,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const r=e.startIndex<=e.endIndex,a=e.startIndex<=t;r===a?r&&t>e.endIndex||!r&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(r&&t<e.endIndex||!r&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let r=0;if(e<t){const a=Math.ceil(e);let s=Math.floor(t);s===t&&(s-=1),r=s-a+1}else{const a=Math.floor(e);let s=Math.ceil(t);s===t&&(s+=1),r=a-s+1}if(r>0)for(const a of this.traceSegments_){const s=a[0],i=s.geometry,o=a[1];let l=a[0].index+1;o===1&&(l-=r);const d=i.getCoordinates();Dt(d,i.getType(),s.depth).splice(l,r),i.setCoordinates(d),o===1&&(s.index-=r)}}addTracedCoordinates_(e,t,r){if(t===r)return;const a=[];if(t<r){const s=Math.ceil(t);let i=Math.floor(r);i===r&&(i-=1);for(let o=s;o<=i;++o)a.push(ye(e.coordinates,o))}else{const s=Math.floor(t);let i=Math.ceil(r);i===r&&(i+=1);for(let o=s;o>=i;--o)a.push(ye(e.coordinates,o))}if(a.length)for(const s of this.traceSegments_){const i=s[0],o=i.geometry,l=s[1],d=i.index+1;l===0&&a.reverse();const c=o.getCoordinates();Dt(c,o.getType(),i.depth).splice(d,0,...a),o.setCoordinates(c),l===1&&(i.index+=a.length)}}updateGeometry_(e,t){const r=t[0],a=r.depth;let s;const i=r.segment,o=r.geometry,l=t[1];for(;e.length<o.getStride();)e.push(i[l][e.length]);switch(o.getType()){case"Point":s=e,i[0]=e,i[1]=e;break;case"MultiPoint":s=o.getCoordinates(),s[r.index]=e,i[0]=e,i[1]=e;break;case"LineString":s=o.getCoordinates(),s[r.index+l]=e,i[l]=e;break;case"MultiLineString":s=o.getCoordinates(),s[a[0]][r.index+l]=e,i[l]=e;break;case"Polygon":s=o.getCoordinates(),s[a[0]][r.index+l]=e,i[l]=e;break;case"MultiPolygon":s=o.getCoordinates(),s[a[1]][a[0]][r.index+l]=e,i[l]=e;break;case"Circle":const d=o;if(i[0]=e,i[1]=e,r.index===yr)this.changingFeature_=!0,d.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0,this.getMap().getView().getProjection();let c=we(j(d.getCenter()),j(e));d.setRadius(c),this.changingFeature_=!1}break}s&&this.setGeometryCoordinates_(o,s)}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([i])=>i));const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],r=[],a=[],s=this.traceState_.active&&!this.traceSegments_?this.traceState_.startCoord:null;if(s){this.traceSegments_=[];for(const i of this.dragSegments_){const o=i[0];we($r(s,o.segment),s)/e.map.getView().getResolution()<1&&this.traceSegments_.push(i)}}for(let i=0,o=this.dragSegments_.length;i<o;++i){const l=this.dragSegments_[i],d=l[0],c=d.feature;r.includes(c)||r.push(c);const u=d.geometry;a.includes(u)||a.push(u),this.updateGeometry_(t,l)}this.updateTrace_(e),this.createOrUpdateVertexFeature_(t,r,a,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate,r=this.findInsertVerticesAndUpdateDragSegments_(t);if(r?.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,r),this.vertexFeature_)){const a=this.vertexFeature_.getGeometry().getCoordinates();for(let s=r.length-1;s>=0;--s)this.insertVertex_(r[s],a);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const r=this.dragSegments_[t][0],a=r.geometry;if(a.getType()==="Circle"){const s=a,i=s.getCenter(),o=r.featureSegments[0],l=r.featureSegments[1];o.segment[0]=i,o.segment[1]=i,l.segment[0]=i,l.segment[1]=i,this.rBush_.update(At(i),o);let d=s;this.rBush_.update(d.getExtent(),l)}else this.rBush_.update(X(r.segment),r)}return this.featuresBeingModified_&&(this.toggleTraceState_(e),this.dispatchEvent(new Ot(Mt.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastCoordinate_=e.coordinate,this.handlePointerAtPixel_(this.lastCoordinate_)}handlePointerAtPixel_(e){const t=this.getMap(),r=t.getPixelFromCoordinate(e);t.getView().getProjection();const a=function(o,l){return vr(e,o)-vr(e,l)};let s,i;if(this.hitDetection_){const o=typeof this.hitDetection_=="object"?l=>l===this.hitDetection_:void 0;t.forEachFeatureAtPixel(r,(l,d,c)=>{c&&c.getType()==="Point"&&(c=new ce(ht(c.getCoordinates())));const u=c||l.getGeometry();if(u&&u.getType()==="Point"&&l instanceof ne&&this.features_.getArray().includes(l)){i=u;const h=l.getGeometry().getFlatCoordinates().slice(0,2);s=[{feature:l,geometry:i,segment:[h,h]}]}return!0},{layerFilter:o})}if(!s){const o=Vn(At(e,_r)),l=t.getView().getResolution()*this.pixelTolerance_,d=Un(zn(o,l,_r));s=this.rBush_.getInExtent(d)}if(s&&s.length>0){const o=s.sort(a)[0],l=o.segment;let d=br(e,o);const c=t.getPixelFromCoordinate(d);let u=we(r,c);if(i||u<=this.pixelTolerance_){const h={};if(h[re(l)]=!0,this.snapToPointer_||(this.delta_[0]=d[0]-e[0],this.delta_[1]=d[1]-e[1]),o.geometry.getType()==="Circle"&&o.index===ze)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(d,[o.feature],[o.geometry],this.snappedToVertex_);else{const g=t.getPixelFromCoordinate(l[0]),f=t.getPixelFromCoordinate(l[1]),m=ut(c,g),v=ut(c,f);if(u=Math.sqrt(Math.min(m,v)),this.snappedToVertex_=u<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(d=m>v?l[1]:l[0]),this.createOrUpdateVertexFeature_(d,[o.feature],[o.geometry],this.snappedToVertex_);const p={};p[re(o.geometry)]=!0;for(let y=1,w=s.length;y<w;++y){const S=s[y].segment;if(oe(l[0],S[0])&&oe(l[1],S[1])||oe(l[0],S[1])&&oe(l[1],S[0])){const C=re(s[y].geometry);C in p||(p[C]=!0,h[re(S)]=!0)}else break}}this.vertexSegments_=h;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const r=e.segment,a=e.feature,s=e.geometry,i=e.depth,o=e.index;let l;for(;t.length<s.getStride();)t.push(0);switch(s.getType()){case"MultiLineString":l=s.getCoordinates(),l[i[0]].splice(o+1,0,t);break;case"Polygon":l=s.getCoordinates(),l[i[0]].splice(o+1,0,t);break;case"MultiPolygon":l=s.getCoordinates(),l[i[1]][i[0]].splice(o+1,0,t);break;case"LineString":l=s.getCoordinates(),l.splice(o+1,0,t);break;default:return!1}this.setGeometryCoordinates_(s,l);const d=this.rBush_;d.remove(e),this.updateSegmentIndices_(s,o,i,1);const c={segment:[r[0],t],feature:a,geometry:s,depth:i,index:o};d.insert(X(c.segment),c),this.dragSegments_.push([c,1]);const u={segment:[t,r[1]],feature:a,geometry:s,depth:i,index:o+1};return d.insert(X(u.segment),u),this.dragSegments_.push([u,0]),!0}updatePointer_(e){return e&&this.findInsertVerticesAndUpdateDragSegments_(e),this.vertexFeature_?.getGeometry().getCoordinates()}getPoint(){const e=this.vertexFeature_?.getGeometry().getCoordinates();return e?ht(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(t=>t.getType()==="Circle"||t.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(X([e])).some(({segment:t})=>oe(t[0],e)||oe(t[1],e))}removePoint(e){if(e&&(e=j(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=te.POINTERDRAG){const t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_.map(([a])=>a));const r=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Ot(Mt.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,r}return!1}removeVertex_(){const e=this.dragSegments_,t={};let r=!1,a,s,i,o,l,d,c,u,h,g,f;for(l=e.length-1;l>=0;--l)i=e[l],g=i[0],f=re(g.feature),g.depth&&(f+="-"+g.depth.join("-")),f in t||(t[f]={}),i[1]===0?(t[f].right=g,t[f].index=g.index):i[1]==1&&(t[f].left=g,t[f].index=g.index+1);for(f in t){switch(h=t[f].right,c=t[f].left,d=t[f].index,u=d-1,c!==void 0?g=c:g=h,u<0&&(u=0),o=g.geometry,s=o.getCoordinates(),a=s,r=!1,o.getType()){case"MultiLineString":s[g.depth[0]].length>2&&(s[g.depth[0]].splice(d,1),r=!0);break;case"LineString":s.length>2&&(s.splice(d,1),r=!0);break;case"MultiPolygon":a=a[g.depth[1]];case"Polygon":a=a[g.depth[0]],a.length>4&&(d==a.length-1&&(d=0),a.splice(d,1),r=!0,d===0&&(a.pop(),a.push(a[0]),u=a.length-1));break}if(r){this.setGeometryCoordinates_(o,s);const m=[];if(c!==void 0&&(this.rBush_.remove(c),m.push(c.segment[0])),h!==void 0&&(this.rBush_.remove(h),m.push(h.segment[1])),c!==void 0&&h!==void 0){const v={depth:g.depth,feature:g.feature,geometry:g.geometry,index:u,segment:m};this.rBush_.insert(X(v.segment),v)}this.updateSegmentIndices_(o,d,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return r}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(t=>t.getType()==="Circle"||t.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(X([e])).some(({segment:t})=>!(oe(t[0],e)||oe(t[1],e)))}insertPoint(e){const t=e?j(e,this.getMap().getView().getProjection()):this.vertexFeature_?.getGeometry().getCoordinates();return t?this.findInsertVerticesAndUpdateDragSegments_(t).reduce((r,a)=>r||this.insertVertex_(a,t),!1):!1}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,r,a){this.rBush_.forEachInExtent(e.getExtent(),function(s){s.geometry===e&&(r===void 0||s.depth===void 0||Hn(s.depth,r))&&s.index>t&&(s.index+=a)})}}function pl(n,e){return n.index-e.index}function vr(n,e,t){const r=e.geometry;if(r.getType()==="Circle"){let s=r;if(e.index===ze){const i=ut(s.getCenter(),j(n)),o=Math.sqrt(i)-s.getRadius();return o*o}}const a=j(n);return Le[0]=j(e.segment[0]),Le[1]=j(e.segment[1]),ta(a,Le)}function br(n,e,t){const r=e.geometry;if(r.getType()==="Circle"&&e.index===ze)return ht(r.getClosestPoint(j(n)));const a=j(n);return Le[0]=j(e.segment[0]),Le[1]=j(e.segment[1]),ht($r(a,Le))}function fl(){const n=Jt();return function(e,t){return n.Point}}const at={SELECT:"select"};class st extends qe{constructor(e,t,r,a){super(e),this.selected=t,this.deselected=r,this.mapBrowserEvent=a}}const it={};class tr extends Pn{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:Er,this.addCondition_=e.addCondition?e.addCondition:ct,this.removeCondition_=e.removeCondition?e.removeCondition:ct,this.toggleCondition_=e.toggleCondition?e.toggleCondition:Vt,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:He,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:ml(),this.features_=e.features||new Ee;let t;if(e.layers)if(typeof e.layers=="function")t=e.layers;else{const r=e.layers;t=function(a){return r.includes(a)}}else t=He;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[re(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[re(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(ke.ADD,this.boundAddFeature_),this.features_.addEventListener(ke.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(ke.ADD,this.boundAddFeature_),this.features_.removeEventListener(ke.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const r=this.findLayerOfFeature_(t);r&&this.addFeatureLayerAssociation_(t,r)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}findLayerOfFeature_(e){return this.getMap().getAllLayers().find(function(t){if(t instanceof Fe&&t.getSource()&&t.getSource().hasFeature(e))return t})}getStyle(){return this.style_}applySelectedStyle_(e){const t=re(e);t in it||(it[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let a=t.length-1;a>=0;--a){const s=t[a];if(s!==this&&s instanceof tr&&s.getStyle()&&s.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(s.getStyle());return}}const r=re(e);e.setStyle(it[r]),delete it[r]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[re(e)]}selectFeatureInternal_(e,t,r){if(!(e instanceof ne)||!this.filter_(e,t))return;const a=this.getFeatures();return a.getArray().includes(e)||(this.addFeatureLayerAssociation_(e,t),a.push(e),r?.push(e)),e}selectFeature(e){const t=this.findLayerOfFeature_(e);if(!this.layerFilter_(t))return!1;const r=this.selectFeatureInternal_(e,t);return r&&this.dispatchEvent(new st(at.SELECT,[r],[],void 0)),!!r}removeFeatureInternal_(e,t){const r=this.getFeatures();if(!(!(e instanceof ne)||!r.getArray().includes(e)))return r.remove(e),this.removeFeatureLayerAssociation_(e),t?.push(e),e}deselectFeature(e){const t=this.removeFeatureInternal_(e);return t&&this.dispatchEvent(new st(at.SELECT,[],[t],void 0)),!!t}toggleFeature(e){this.deselectFeature(e)||this.selectFeature(e)}clearSelection(){Rn(this.featureLayerAssociation_);const e=this.getFeatures(),t=e.getArray().slice();e.clear(),t.length!==0&&this.dispatchEvent(new st(at.SELECT,[],t,void 0))}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),r=this.removeCondition_(e),a=this.toggleCondition_(e),s=!t&&!r&&!a,i=e.map,o=this.getFeatures(),l=[],d=[];if(s){let c=!1;i.forEachFeatureAtPixel(e.pixel,(u,h)=>{if(c=!0,!!this.selectFeatureInternal_(u,h,d))return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let u=o.getLength()-1;u>=0;--u){const h=o.item(u);(d.length>0&&!d.includes(h)||!c)&&this.removeFeatureInternal_(h,l)}}else i.forEachFeatureAtPixel(e.pixel,(c,u)=>{let h;if((r||a)&&(h=this.removeFeatureInternal_(c,l)),(t||a)&&!h&&(h=this.selectFeatureInternal_(c,u,d)),!!h)return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});return(d.length>0||l.length>0)&&this.dispatchEvent(new st(at.SELECT,d,l,e)),!0}}function ml(){const n=Jt();return lr(n.Polygon,n.LineString),lr(n.GeometryCollection,n.LineString),function(e){return e.getGeometry()?n[e.getGeometry().getType()]:null}}const Nt={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};class Gt extends qe{constructor(e,t,r,a,s){super(e),this.features=t,this.coordinate=r,this.startCoordinate=a,this.mapBrowserEvent=s}}class yl extends qt{constructor(e){e=e||{},super(e),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=e.features!==void 0?e.features:null;let t;if(e.layers&&!this.features_)if(typeof e.layers=="function")t=e.layers;else{const r=e.layers;t=function(a){return r.includes(a)}}else t=He;this.layerFilter_=t,this.filter_=e.filter&&!this.features_?e.filter:He,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.condition_=e.condition?e.condition:Te,this.lastFeature_=null,this.addChangeListener(Tr.ACTIVE,this.handleActiveChanged_)}handleDownEvent(e){if(!e.originalEvent||!this.condition_(e))return!1;if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=e.coordinate,this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);const t=this.features_||new Ee([this.lastFeature_]);return this.dispatchEvent(new Gt(Nt.TRANSLATESTART,t,e.coordinate,this.startCoordinate_,e)),!0}return!1}handleUpEvent(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);const t=this.features_||new Ee([this.lastFeature_]);return this.dispatchEvent(new Gt(Nt.TRANSLATEEND,t,e.coordinate,this.startCoordinate_,e)),this.startCoordinate_=null,!0}return!1}handleDragEvent(e){if(this.lastCoordinate_){const t=e.coordinate;e.map.getView().getProjection();const r=j(t),a=j(this.lastCoordinate_),s=r[0]-a[0],i=r[1]-a[1],o=this.features_||new Ee([this.lastFeature_]);o.forEach(function(l){const d=l.getGeometry();d.translate(s,i),l.setGeometry(d)}),this.lastCoordinate_=t,this.dispatchEvent(new Gt(Nt.TRANSLATING,o,t,this.startCoordinate_,e))}}handleMoveEvent(e){const t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(e,t){return t.forEachFeatureAtPixel(e,(r,a)=>{if(!(!(r instanceof ne)||!this.filter_(r,a))&&!(this.features_&&!this.features_.getArray().includes(r)))return r},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(e){this.hitTolerance_=e}setMap(e){const t=this.getMap();super.setMap(e),this.updateState_(t)}handleActiveChanged_(){this.updateState_(null)}updateState_(e){let t=this.getMap();const r=this.getActive();(!t||!r)&&(t=t||e,t&&t.getViewport().classList.remove("ol-grab","ol-grabbing"))}}const _l=(n,e,t)=>{if(t){const r=new DOMParser().parseFromString(t,"image/svg+xml");return r.querySelectorAll("[fill]").forEach(a=>{a.setAttribute("fill",n)}),r.querySelectorAll("[stroke]").forEach(a=>{a.setAttribute("stroke",e)}),r.querySelectorAll("path, circle, rect, polygon, ellipse").forEach(a=>{a.hasAttribute("fill")||a.setAttribute("fill",n),a.hasAttribute("stroke")||a.setAttribute("stroke",e)}),new XMLSerializer().serializeToString(r)}return`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="-1 -1 25 25"
  >
    <path
      d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 0 1 0-5 2.5 2.5 0 0 1 0 5z"
      fill="${n}"
      stroke="${e}"
      stroke-width="1"
    />
  </svg>
`},vl=({fill:n="#005CA9",stroke:e="#FFF",svg:t})=>{let r="";typeof n=="string"?r=n:"oklch"in n?r=`oklch(${n.oklch.l} ${n.oklch.c} ${n.oklch.h})`:"rgba"in n&&(r=`${n.rgba.r} ${n.rgba.g} ${n.rgba.b} ${n.rgba.a?n.rgba.a:""}`);let a="";return typeof e=="string"?a=e:"oklch"in e?a=`oklch(${e.oklch.l} ${e.oklch.c} ${e.oklch.h})`:"rgba"in e&&(a=`${e.rgba.r} ${e.rgba.g} ${e.rgba.b} ${e.rgba.a?e.rgba.a:""}`),new dt({image:new Fn({src:`data:image/svg+xml;base64,${btoa(_l(r,a,t))}`,scale:2,anchor:[.5,1]})})},bl={Circle:Xe,LinearRing:Wn,LineString:Ve,MultiLineString:Kt,MultiPoint:Lr,MultiPolygon:Xt,Point:ce,Polygon:_t};function xl(n,e,t,r){const a=new bl[t](r);let s=jn(a.getExtent());return(t==="Polygon"||t==="MultiPolygon")&&!a.intersectsCoordinate(s)&&(s=(a.getType()==="Polygon"?a.getInteriorPoint():a.getInteriorPoints()).getFirstCoordinate()),n===e?s:We(s,n,e)}async function xr(n,e,t){if(!t)return!0;const r=await Br(e,t.layerId,n);return r===!0||typeof r=="symbol"&&t.onError!=="strict"?!0:(typeof r=="symbol"?(Be("error",()=>le(a=>a.boundaryError,{ns:"pins"})),console.error(`@polar/polar(plugins/pins/utils/isCoordinateInBoundaryLayer:39:3)
`,"Checking boundary layer failed.")):(Be("info",()=>le(a=>a.notInBoundary,{ns:"pins"})),console.info(`@polar/polar(plugins/pins/utils/isCoordinateInBoundaryLayer:43:3)
`,"Pin position outside of boundary layer:",n)),!1)}const kl=be("plugins/pins",()=>{const n=Z(),e=P(null),t=P(!1),r=L(()=>B({minZoomLevel:0,movable:"none",toZoomLevel:0},n.configuration.pins||{})),a=L(()=>{if(!e.value)return null;const p=An(e.value,n.configuration.epsg);return[p[1],p[0]]}),s=new Fe({source:new je,style:vl(r.value.style||{})}),i=new tr({layers:p=>p===s,style:null,condition:In}),o=new yl({condition:()=>n.map.getView().getZoom()>=r.value.minZoomLevel,layers:[s]});let l=null;function d(){n.map.addLayer(s),s.setZIndex(100),n.map.on("singleclick",async({coordinate:p})=>{await f(p)}),u(),h(),g()}function c(){const{map:p}=n;p.un("singleclick",async({coordinate:y})=>{await f(y)}),v(),p.removeLayer(s),p.removeInteraction(i),p.removeInteraction(o),l&&l()}function u(){const{coordinateSources:p}=r.value;p&&p.forEach(y=>{const w=y.plugin?n.getPluginStore(y.plugin):n;w&&(l=Ae(()=>w[y.key],S=>{S&&S.type!=="reverse_geocoded"&&m(S.geometry.coordinates,!1,{type:S.geometry.type})}))})}function h(){const{initial:p}=r.value;if(p){const{coordinate:y,centerOn:w,epsg:S}=p;if(w){m(y,!1,{epsg:S||n.configuration.epsg,type:"Point"});return}m(y)}}function g(){i.on("select",({selected:y})=>{r.value.movable==="none"&&(document.body.style.cursor=y.length?"not-allowed":"")}),n.map.addInteraction(i);const{movable:p}=r.value;p==="drag"&&(o.on("translatestart",()=>t.value=!0),o.on("translateend",({features:y})=>{t.value=!1,y.forEach(async w=>{const S=w.getGeometry().getCoordinates(),C=await xr(S,n.map,r.value.boundary)?S:e.value;C&&m(C)})}),n.map.addInteraction(o))}async function f(p){const y=n.map.getInteractions().getArray().some(C=>C instanceof cl&&(C._isMultiSelect||C._isDrawPlugin)||C instanceof gl||C._isDeleteSelect),{minZoomLevel:w,movable:S}=r.value;(S==="drag"||S==="click")&&n.map.getView().getZoom()>=w&&!y&&await xr(p,n.map,r.value.boundary)&&m(p)}function m(p,y=!0,w){v(),e.value=p,!y&&w&&(e.value=xl(w.epsg||n.configuration.epsg,n.configuration.epsg,w.type,p),n.map.getView().setCenter(e.value),n.map.getView().setZoom(r.value.toZoomLevel)),s.getSource().addFeature(new ne({geometry:new ce(e.value),type:"point",name:"mapMarker",zIndex:100}))}function v(){s.getSource().clear()}return{coordinate:e,latLon:a,setupPlugin:d,teardownPlugin:c}}),wl={boundaryError:"Die Überprüfung der Koordinate ist fehlgeschlagen. Bitte versuchen Sie es später erneut oder wenden Sie sich an einen Administrator, wenn das Problem bestehen bleibt.",notInBoundary:"Diese Koordinate kann nicht gewählt werden."},Cl={boundaryError:"Validating the coordinate failed. Please try again later or contact an administrator if the issue persists.",notInBoundary:"It is not possible to select this coordinate."},Sl=[{type:"de",resources:wl},{type:"en",resources:Cl}],El="pins";function Tl(n){return{id:El,locales:Sl,storeModule:kl,options:n}}const rr="reverseGeocoder",rn=be("plugins/reverseGeocoder",()=>{const n=Z(),e=L(()=>n.configuration[rr]),t=P([]);function r(){for(const o of e.value.coordinateSources||[]){const l=o.plugin?n.getPluginStore(o.plugin):n;l&&t.value.push(Ae(()=>l[o.key],async d=>{d&&await i(d)},{immediate:!0}))}}function a(){t.value.forEach(o=>{o()})}function s(o,l){const d=o.plugin?n.getPluginStore(o.plugin):n;d&&d[o.key](l)}async function i(o){const l=_a();try{const d=await va(e.value.url,o);return e.value.addressTarget&&s(e.value.addressTarget,d),e.value.zoomTo&&n.map.getView().fit(new ce(o),{maxZoom:e.value.zoomTo,duration:400,easing:na}),d}catch(d){return console.error(`@polar/polar(plugins/reverseGeocoder/store:102:5)
`,"Reverse geocoding failed:",d),null}finally{l()}}return{reverseGeocode:i,setupPlugin:r,teardownPlugin:a}});if(import.meta.vitest){const{expect:n,test:e,vi:t}=import.meta.vitest,{createPinia:r,setActivePinia:a}=await Me(async()=>{const{createPinia:c,setActivePinia:u}=await import("./pinia-BhmAVTvm-Dvvq2Cue.js");return{createPinia:c,setActivePinia:u}},__vite__mapDeps([0,1]),import.meta.url),{reactive:s}=await Me(async()=>{const{reactive:c}=await import("./vue.runtime.esm-bundler-APnTtYuL-TgjA0Nnx.js");return{reactive:c}},[],import.meta.url),i=await Me(()=>import("./store-C5OS7H-y.js").then(c=>c.s),__vite__mapDeps([2,0,1,3]),import.meta.url),o=await Me(()=>import("./reverseGeocode-CR3Bbmu1-DNBqHopz.js"),__vite__mapDeps([4,2,0,1,3]),import.meta.url),l=await Me(()=>import("./indicateLoading-BDKoxTDd-CXoezeA8.js"),__vite__mapDeps([5,3,0,1]),import.meta.url),d=e.extend({reverseGeocodeUtil:[async({},c)=>{const u=t.spyOn(o,"reverseGeocode").mockResolvedValue(null);await c(u)},{auto:!0}],indicateLoading:[async({},c)=>{const u=t.spyOn(l,"indicateLoading").mockImplementation(()=>()=>{});await c(u)},{auto:!0}],coreStore:[async({},c)=>{const u=t.fn(),h=s({configuration:{[rr]:{url:"https://wps.example",coordinateSources:[{key:"coordinateSource"}],addressTarget:{key:"addressTarget"},zoomTo:99}},map:{getView:()=>({fit:u})},coordinateSource:null,addressTarget:t.fn()});t.spyOn(i,"useCoreStore").mockReturnValue(h),await c(h)},{auto:!0}],store:[async({},c)=>{a(r());const u=rn();u.setupPlugin(),await c(u),u.teardownPlugin()},{auto:!0}]});d("detects changes in coordinate sources",async({reverseGeocodeUtil:c,coreStore:u})=>{u.coordinateSource=[1,2],await new Promise(h=>setTimeout(h)),n(c).toHaveBeenCalledWith("https://wps.example",[1,2])}),d("passes geocoding result to address target",async({reverseGeocodeUtil:c,coreStore:u,store:h})=>{const g=Symbol("feature");c.mockResolvedValueOnce(g),await h.reverseGeocode([3,4]),n(u.addressTarget).toHaveBeenCalledOnce(),n(u.addressTarget).toHaveBeenCalledWith(g)}),d("zooms to input coordinate",async({reverseGeocodeUtil:c,coreStore:u,store:h})=>{const g=Symbol("feature");c.mockResolvedValueOnce(g),await h.reverseGeocode([3,4]),n(u.map.getView().fit).toHaveBeenCalledOnce()})}function Ll(n){return{id:rr,storeModule:rn,options:n}}const $l={style:{background:"#fff"}},Il=bt({__name:"EmptyComponent",setup(n){return(e,t)=>(kt(),xt("div",$l,"HELLO THERE"))}}),Al={class:"kern-btn kern-btn--tertiary",style:{"border-radius":"0.25rem","min-height":"2rem",width:"2rem"}},Fl=bt({__name:"MockAttributions.ce",setup(n){return(e,t)=>(kt(),xt("button",Al,[...t[0]||(t[0]=[ot("span",{class:"kern-icon kern-icon-fill--copyright",style:{color:"var(--kern-color-action-default)"}},null,-1)])]))}}),Pl={style:{display:"flex",gap:"0.5rem"}},Rl=bt({__name:"MockPointerPosition.ce",setup(n){return(e,t)=>(kt(),xt("div",Pl,[...t[0]||(t[0]=[ot("span",{class:"kern-icon kern-icon--fullscreen","aria-hidden":"true"},null,-1),ot("span",{style:{display:"flex","align-items":"center"}},"9.9555 | 53.5479",-1),ot("button",{class:"kern-btn kern-btn--tertiary",style:{"min-height":"1rem","font-size":"1.125rem","text-decoration-line":"underline","text-underline-offset":"2px","text-underline-position":"from-font",color:"#1a3da5"}}," EPSG:4326 ",-1)])]))}}),nn=[{id:"23420",name:"basemap.de Web Raster Farbe",url:"https://sgx.geodatenzentrum.de/wms_basemapde",typ:"WMS",layers:"de_basemapde_web_raster_farbe",format:"image/png",version:"1.3.0",singleTile:!1,transparent:!0,transparency:0,urlIsVisible:!0,tilesize:512,gutter:0,minScale:"0",maxScale:"2500000",legendURL:"",cache:!1,featureCount:5},{id:"23421",name:"basemap.de Web Raster Grau",url:"https://sgx.geodatenzentrum.de/wms_basemapde",typ:"WMS",layers:"de_basemapde_web_raster_grau",format:"image/png",version:"1.3.0",singleTile:!1,transparent:!0,transparency:0,urlIsVisible:!0,tilesize:512,gutter:0,minScale:"0",maxScale:"2500000",legendURL:"",cache:!1,featureCount:5},{id:"1454",name:"Ausgleichsflächen",url:"https://geodienste.hamburg.de/HH_WFS_Ausgleichsflaechen",typ:"WFS",featureType:"ausgleichsflaechen",outputFormat:"XML",version:"1.1.0",featureNS:"https://registry.gdi-de.org/id/de.hh.up",featurePrefix:"de.hh.up",legendURL:""},{id:"6059",name:"MML Anliegen",url:"https://geodienste.hamburg.de/lgv-config/anliegen_extern.json",typ:"GeoJSON",format:"XML",version:"1.0",minScale:"0",maxScale:"2500000",legendURL:"",urlIsVisible:!0},{id:"denkmaelerWMS",name:"Denkmal WMS",url:"https://efi2-deegree.schleswig-holstein.de/dish-deegree/services/wms_shp",typ:"WMS",layers:"0,1,2,3,4,6,24,25",legendURL:"ignore",format:"image/png",version:"1.3.0",transparent:!0}],Ml="data:application/json;base64,WwoJewoJCSJzdHlsZUlkIjogInBhbmRhIiwKCQkicnVsZXMiOiBbCgkJCXsKCQkJCSJzdHlsZSI6IHsKCQkJCQkicG9seWdvblN0cm9rZUNvbG9yIjogWzMsIDI1NSwgMSwgMV0sCgkJCQkJInBvbHlnb25GaWxsSGF0Y2giOiB7CgkJCQkJCSJiYWNrZ3JvdW5kQ29sb3IiOiBbMCwgMCwgMCwgMC4yNV0sCgkJCQkJCSJwYXR0ZXJuIjogImRpYWdvbmFsLXJpZ2h0IiwKCQkJCQkJInBhdHRlcm5Db2xvciI6IFszLCAyNTUsIDEsIDFdCgkJCQkJfQoJCQkJfQoJCQl9CgkJXQoJfQpdCg==",Dl={style:{background:"#fff"}},Ol=bt({__name:"YetAnotherEmptyComponent",setup(n){return(e,t)=>(kt(),xt("div",Dl,"Awesome"))}}),an="23420",Nl="23421",Gl="1454",kr="6059",Bl="denkmaelerWMS",sn="1693";let Ge="light";const q=await aa("snowbox",{colorScheme:Ge,startCenter:[573364,6028874],layers:[{id:an,visibility:!0,type:"background",name:"Basemap.de (Farbe)"},{id:Nl,type:"background",name:"Basemap.de (Grau)",maxZoom:6},{id:sn,visibility:!0,hideInMenu:!0,type:"mask",name:"meldemichel.layers.hamburgBorder"},{id:kr,type:"mask",name:"Anliegen (MML)",visibility:!1},{id:Gl,type:"mask",name:"Ausgleichsflächen",styleId:"panda",visibility:!0,minZoom:5},{id:Bl,type:"mask",name:"Kulturdenkmale",visibility:!0,options:{layers:{order:"6,24,25,4,3,2,1,0",title:{6:"Denkmalbereich",24:"Mehrheit von baulichen Anlagen",25:"Sachgesamtheit",4:"Baudenkmal",3:"Gründenkmal",2:"Gewässer",1:"Baudenkmal (Fläche)",0:"Gründenkmal (Fläche)"},legend:!0}}}],layout:"standard",checkServiceAvailability:!0,featureStyles:Ml,markers:{layers:[{id:kr,defaultStyle:{stroke:"#FFFFFF",fill:"#005CA9"},hoverStyle:{stroke:"#46688E",fill:"#8BA1B8"},selectionStyle:{stroke:"#FFFFFF",fill:"#E10019"},unselectableStyle:{stroke:"#FFFFFF",fill:"#333333"}}],clusterClickZoom:!0},locales:[{type:"de",resources:{fullscreen:{button:{label_on:"Mach groß",label_off:"Mach klein"}},iconMenu:{hints:{attributions:"LMAO",fullscreen:"BEEEEEG YOSHEEEEE"}}}}],scale:{showScaleSwitcher:!0}},nn);document.getElementById("secondMap").addEventListener("click",async()=>{const n=sa({startCenter:[573364,6028874],layers:[{id:an,visibility:!0,type:"background",name:"snowbox.layers.basemap"}]},nn);n.classList.add("snowbox"),document.getElementById("secondMapContainer").appendChild(n),pe(n,Fr({layoutTag:"TOP_RIGHT"}))});document.getElementById("secondMapClean").addEventListener("click",()=>{document.getElementById("secondMapContainer").innerText=""});pe(q,Pr({displayComponent:!0,layoutTag:"BOTTOM_MIDDLE"}));setTimeout(()=>{ia(q,"toast")},3e3);setTimeout(()=>{pe(q,Pr({displayComponent:!0,layoutTag:"BOTTOM_MIDDLE"})),Yt(q,"toast").addToast({text:"Sechs Sekunden",severity:"info"})},6e3);pe(q,dl({loaderStyle:"BasicLoader"}));pe(q,Ts({searchMethods:[{queryParameters:{searchStreets:!0,searchHouseNumbers:!0},type:"mpapi",url:"https://geodienste.hamburg.de/HH_WFS_GAGES?service=WFS&request=GetFeature&version=2.0.0"}],minLength:3,waitMs:300,focusAfterSearch:!0,groupProperties:{defaultGroup:{limitResults:5}}}));pe(q,Tl({coordinateSources:[{plugin:"addressSearch",key:"chosenAddress"}],boundary:{layerId:sn},movable:"drag",style:{fill:"#FF0019"},toZoomLevel:7}));pe(q,Ll({url:"https://geodienste.hamburg.de/HH_WPS",coordinateSources:[{plugin:"pins",key:"coordinate"}],addressTarget:{plugin:"addressSearch",key:"selectResult"},zoomTo:7}));pe(q,la({displayComponent:!0,layoutTag:"TOP_RIGHT",initiallyOpen:"layerChooser",focusMenus:[{plugin:{component:Ol,id:"attributions",locales:[]},icon:"kern-icon--near-me"}],menus:[[{plugin:ni({checkLocationInitially:!1,keepCentered:!1,showTooltip:!0,zoomLevel:7})}],[{plugin:{component:Il,id:"realKewl",locales:[]},icon:"kern-icon-fill--share"}],[{plugin:Io({})},{plugin:Fr({})}]]}));pe(q,Ds({leftEntries:[{id:"mockPointer",component:Rl}],rightEntries:[da({}),{id:"mockAttributions",component:Fl}]}));const on=Yt(q,"toast");on.addToast({text:"Hallo Welt",severity:"info"});on.addToast({text:"Achtung! Dies ist ein Toast!",severity:"error"});const ln=Yt(q,"loadingIndicator");ln.addLoadingKey("loadingTest");setTimeout(()=>ln.removeLoadingKey("loadingTest"),2e3);oa(q,"core","selectedCoordinates",n=>document.getElementById("selected-feature-coordinates").innerText=JSON.stringify(n));document.getElementById("language-switcher").addEventListener("change",n=>{const e=n.target,{value:t}=e;Ar(q,"core","language",t),e[0].innerHTML=t==="en"?"English":"Englisch",e[1].innerHTML=t==="en"?"German":"Deutsch"});document.getElementById("color-scheme-switcher").addEventListener("click",({target:n})=>{n.innerHTML=`Switch to ${Ge} mode`,Ge=Ge==="light"?"dark":"light",Ar(q,"core","colorScheme",Ge)});
