const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./pinia-x73l2-vU-D6MOxTBQ.js","./vue.runtime.esm-bundler-BAmx9FTa-DJQ8eZeL.js","./store-CN0wr1Kw.js","./index-9ywQE4Jo-CIqdQbCQ.js","./reverseGeocode-CR3Bbmu1-t1-wbI-u.js","./indicateLoading-DzQEZ1AR-CrqcV_vt.js"])))=>i.map(i=>d[i]);
import{a1 as z,a2 as un,a3 as hn,a4 as We,a5 as ce,a6 as bt,a7 as gn,a8 as tt,a9 as pn,aa as kr,ab as Fe,ac as je,ad as re,ae as fn,af as ut,ag as Be,ah as mn,ai as wr,aj as yn,ak as ht,al as _n,am as vn,an as bn,ao as xn,ap as kn,aq as wn,ar as Cn,as as qe,at as O,au as v,av as Lt,aw as A,ax as Cr,ay as U,az as ke,aA as Wt,aB as X,aC as de,aD as V,aE as Nt,aF as Sn,aG as xt,aH as En,aI as Tn,aJ as $n,aK as Ln,aL as In,aM as Sr,aN as gt,aO as Bt,aP as He,aQ as Te,aR as te,aS as we,aT as An,aU as jt,aV as $e,aW as Er,aX as H,aY as Fn,aZ as pt,a_ as Pn,a$ as Vt,b0 as ee,b1 as Rn,b2 as K,b3 as Ce,b4 as Ve,b5 as sr,b6 as Tr,b7 as qt,b8 as Kt,b9 as Mn,ba as Dn,bb as On,bc as ir,bd as It,be as oe,bf as $r,bg as ft,bh as Gn,bi as Nn,bj as Bn,bk as Vn,bl as Un,bm as zn,bn as Xt,bo as or,bp as Hn,bq as Wn,br as jn,bs as qn,bt as Kn,bu as Xn,bv as Jn,bw as Yn,bx as Lr,by as Qn,bz as Zn,bA as Me,bB as ea,F as Ke,H as Xe,I as Je,L as be,bC as ta,bD as ra,bE as ye,S as Ir,Q as na,bF as Ar,U as Fr,T as aa,$ as sa}from"./runtime-core.esm-bundler-BAd4IUdP.js";import{defineComponent as W,createElementBlock as E,openBlock as b,createElementVNode as L,renderSlot as Jt,computed as $,ref as P,createBlock as D,unref as y,withCtx as he,createVNode as Ie,createCommentVNode as j,withDirectives as Yt,withKeys as fe,withModifiers as ve,isRef as mt,vModelText as ia,toDisplayString as ne,normalizeClass as Ye,nextTick as Qt,vModelSelect as oa,Fragment as q,renderList as Y,watch as Ae,toRaw as la,resolveDynamicComponent as yt,normalizeStyle as da,markRaw as lr,mergeModels as ca,useModel as ua,vModelDynamic as ha,onMounted as ga}from"./vue.runtime.esm-bundler-BAmx9FTa-DJQ8eZeL.js";import{defineStore as xe,storeToRefs as ue}from"./pinia-x73l2-vU-D6MOxTBQ.js";import{R as B,h as Q,f as le,v as Oe}from"./index-9ywQE4Jo-CIqdQbCQ.js";import{X as dr}from"./store-CN0wr1Kw.js";import{indicateLoading as pa}from"./indicateLoading-DzQEZ1AR-CrqcV_vt.js";import{reverseGeocode as fa}from"./reverseGeocode-CR3Bbmu1-t1-wbI-u.js";const ma={class:"kern-card kern-card--small"},ya={class:"kern-card__container"},_a=W({__name:"PolarCard.ce",setup(n){return(e,t)=>(b(),E("article",ma,[L("div",ya,[Jt(e.$slots,"default",{},void 0)])]))}}),va=".kern-card{&[data-v-937e165b]{height:auto;min-width:25rem;border-radius:var(--kern-metric-border-radius-large);box-shadow:var(--polar-shadow)}.kern-card__container[data-v-937e165b]{padding:var(--kern-metric-space-small);padding-bottom:.625rem}}",kt=z(_a,[["styles",[va]],["__scopeId","data-v-937e165b"]]);function ba(n,e,{signal:t,edges:r}={}){let a,s=null;const i=r!=null&&r.includes("leading"),o=r==null||r.includes("trailing"),l=()=>{s!==null&&(n.apply(a,s),a=void 0,s=null)},d=()=>{o&&l(),g()};let c=null;const u=()=>{c!=null&&clearTimeout(c),c=setTimeout(()=>{c=null,d()},e)},h=()=>{c!==null&&(clearTimeout(c),c=null)},g=()=>{h(),a=void 0,s=null},f=()=>{l()},k=function(..._){if(t?.aborted)return;a=this,s=_;const p=c==null;u(),i&&p&&l()};return k.schedule=u,k.cancel=g,k.flush=f,t?.addEventListener("abort",g,{once:!0}),k}function xa(n){const e=n.map(parseFloat),t=[];for(;e.length;)t.push(e.splice(0,2));return t}function ka(n,e,t={}){n.getView().fit(e,t)}function wa(n,e,t={}){let r;switch(e.geometry.type){case"Polygon":r=new bt([xa(e.geometry.coordinates)]);break;case"Point":r=new ce(e.geometry.coordinates.map(parseFloat));break;default:console.warn(`ZoomTo for type ${e.geometry.type} not implemented.`);return}ka(n,r,t)}const F={STREET:"street",DISTRICT:"district",PARCEL:"parcel",STREET_KEY:"streetKey",ADDRESS_AFFIXED:"addressAffixed",ADDRESS_UNAFFIXED:"addressUnaffixed",HOUSE_NUMBERS_FOR_STREET:"houseNumbersForStreet"};function Pr(n){return Array.isArray(n)&&n.length===1?Pr(n[0]):n}function _t(n,e){return Array.isArray(n)?n.map(t=>_t(t,e)).filter(t=>t)[0]:typeof n!="object"?null:typeof n[e]<"u"?n[e]:Object.keys(n).map(t=>_t(n[t],e)).filter(t=>t)[0]}function Ca(n){const e={objectType:Object.keys(n)[0]};return Object.keys(n[e.objectType][0]).forEach(t=>{e[t]=Pr(n[e.objectType][0][t])}),e}function Sa(n){let e=[];return n.startsWith("POINT")&&(e=n.split(")")[0]?.split("(")[1]),e}function Ea(n,e){const t={type:e,properties:Ca(n)};let r=t.properties?.pos?Sa(t.properties.pos):_t(t.properties,"pos")[0],a="",s="",i="";switch(e){case F.DISTRICT:t.name=t.properties.geographicIdentifier?._?t.properties.geographicIdentifier._:t.properties.geographicIdentifier;break;case F.STREET_KEY:case F.STREET:t.properties?.position_strassenachse&&(r=_t(t.properties?.position_strassenachse,"pos")[0]),t.name=tt()?t.properties.geographicIdentifier._:t.properties.strassenname;break;case F.PARCEL:t.name=`${t.properties.gemarkung}/${t.properties.flurstuecksnummer}`;break;case F.HOUSE_NUMBERS_FOR_STREET:a=t.properties.hausnummer?._?t.properties.hausnummer._:t.properties.hausnummer,t.properties.hausnummernzusatz&&(s=t.properties.hausnummernzusatz?._?t.properties.hausnummernzusatz._:t.properties.hausnummernzusatz),t.properties.hausnummerkomplett=`${a}${s}`,t.name=tt()?t.properties.geographicIdentifier._:(t.properties?.geographicIdentifier?t.properties.geographicIdentifier._.split(t.properties.hausnummerkomplett)[0]:t.properties.strassenname+" ")+t.properties.hausnummerkomplett;break;case F.ADDRESS_AFFIXED:i=t.properties.strassenname?._?t.properties.strassenname._:t.properties.strassenname,a=t.properties.hausnummer?._?t.properties.hausnummer._:t.properties.hausnummer,s=t.properties.hausnummernzusatz?._?t.properties.hausnummernzusatz._:t.properties.hausnummernzusatz,t.name=tt()?t.properties.geographicIdentifier._:`${i} ${a}${s}`;break;case F.ADDRESS_UNAFFIXED:i=t.properties.strassenname?._?t.properties.strassenname._:t.properties.strassenname,a=t.properties.hausnummer?._?t.properties.hausnummer._:t.properties.hausnummer,t.name=tt()?t.properties.geographicIdentifier._:(t.properties?.geographicIdentifier?t.properties.geographicIdentifier._.split(a)[0]:i+" ")+a;break;default:t.name=null,console.error(`Unknown type in searchAddress.parse: '${e}'. Could not set name.`);break}switch(e){case F.DISTRICT:case F.STREET_KEY:case F.STREET:case F.PARCEL:case F.HOUSE_NUMBERS_FOR_STREET:case F.ADDRESS_AFFIXED:case F.ADDRESS_UNAFFIXED:t.geometry={type:"Point",coordinates:r.split(" ")};break;default:t.geometry=null,console.error(`Unknown type in searchAddress.parse: '${e}'. Could not set geometry.`);break}return t}function Rr(n,e){return new Promise((t,r)=>{dr.parseString(e,{tagNameProcessors:[dr.processors.stripPrefix]},(a,s)=>{if(a){r(a);return}try{const i=s.FeatureCollection?.member?s.FeatureCollection.member.map(o=>Ea(o,n)).sort((o,l)=>o.name.localeCompare(l.name)):[];t(i)}catch(i){r(i)}})})}function Ta(n){return Array.isArray(n)?n.map(encodeURIComponent):encodeURIComponent(n)}function $a(n,e,t=!0){return{[F.STREET]:r=>t?`&StoredQuery_ID=findeStrasse&strassenname=*${r}`:`&StoredQuery_ID=findeStrasse&strassenname=${r}`,[F.DISTRICT]:r=>`&StoredQuery_ID=findeStadtteil&stadtteilname=${r}`,[F.PARCEL]:r=>`&StoredQuery_ID=Flurstueck&gemarkung=${r[0]}&flurstuecksnummer=${r[1]}`,[F.STREET_KEY]:r=>`&StoredQuery_ID=findeStrassenSchluessel&strassenschluessel=${r}`,[F.ADDRESS_AFFIXED]:r=>`&StoredQuery_ID=AdresseMitZusatz&strassenname=${r[0]}&hausnummer=${r[1]}&zusatz=${r[2]}`,[F.ADDRESS_UNAFFIXED]:r=>`&StoredQuery_ID=AdresseOhneZusatz&strassenname=${r[0]}&hausnummer=${r[1]}`,[F.HOUSE_NUMBERS_FOR_STREET]:r=>`&StoredQuery_ID=HausnummernZuStrasse&strassenname=${r}`}[n](Ta(e))}function Mr(n,e,t,r){return new Promise((a,s)=>{const i=gn()+$a(n,e,r);fetch(i,{signal:t?.signal,timeout:6e3}).then(o=>a(o.text())).catch(o=>s(o))})}let Ue=null;function Se(n,e,t=(s,i)=>s.name.localeCompare(i.name),r=()=>!0,a){return new Promise((s,i)=>{Mr(n,e,Ue,a).then(o=>{Rr(n,o).then(l=>{s(l.filter(r).sort(t))})}).catch(o=>i(o))})}function La(n,e,t){return new Promise((r,a)=>{Mr(F.STREET,n,Ue,t).then(s=>Rr(F.STREET,s)).then(s=>{const i=[],o=n.match(new RegExp("^(.+)[\\s,](\\d+|\\d.*)$"));for(let l=0;l<s.length;l++)i.push([s[l]]),e&&i.push(Se(F.HOUSE_NUMBERS_FOR_STREET,s[l].name,void 0,void 0,t));return!s.length&&o?.length&&e&&i.push(Se(F.HOUSE_NUMBERS_FOR_STREET,o[1],(l,d)=>parseInt(l.properties?.hausnummer,10)-parseInt(d.properties?.hausnummer,10),l=>l.properties?.hausnummerkomplett?.indexOf(o[2])===0,t)),Promise.all(i)}).then(s=>r([].concat(...s))).catch(s=>a(s))})}function cr(n,e,t=!1){return t&&Ue!==null&&Ue.abort(),Ue=new AbortController,new Promise((r,a)=>{const{map:s,zoom:i=!1,zoomToParams:o,searchAddress:l=!1,searchStreets:d=!1,searchStreetBeforeWord:c=!0,searchDistricts:u=!1,searchParcels:h=!1,searchStreetKey:g=!1,minCharacters:f=3}=e,k=[];let{searchHouseNumbers:_=!1}=e;if(n.length<f){a({error:"Search string too short."});return}if(i&&!s&&console.warn("Instructed to zoom, but required map object was not given. Zooming will be skipped."),!d&&_&&(console.warn(`Search for '${n}' supposed to retrieve house numbers, but not streets. Invalid search configuration. House numbers will not be searched for as a result.`),_=!1),!(l||d||_||u||h||g)){a({error:`Search for '${n}' received no indication what to search for. Search is canceled.`});return}if(d&&k.push(La(n,_,c)),l){let p=n.split(/(\d+)/).map(w=>w.trim()).filter(w=>w);if(p.length>3){const w=p[0],S=p[1],C=n.replace(p[0],"").replace(p[1],"").trim();p=[w,S,C]}const m=[!1,!1,F.ADDRESS_UNAFFIXED,F.ADDRESS_AFFIXED][p.length];m&&k.push(Se(m,p))}if(u&&/^[a-z-üäöß]+$/i.test(n)&&k.push(Se(F.DISTRICT,n)),g&&/^[a-z]{1}[0-9]{1,5}$/i.test(n)&&k.push(Se(F.STREET_KEY,n)),h){let p;/^[0-9]{4}[\s|/][0-9]*$/.test(n)?p=n.split(/[\s|/]/):/^[0-9]{5,}$/.test(n)&&(p=[n.slice(0,4),n.slice(4)]),p&&k.push(Se(F.PARCEL,p))}Promise.all(k).then(p=>{const m=[].concat(...p);if(i&&s&&m.length===1)try{wa(s,m[0],o)}catch(w){console.error("Zooming to element from gazetteer failed."),console.error(w)}r(m)}).catch(p=>a(p))})}const J="addressSearch";function Ia(n,e){const t=n.reduce((r,a)=>a.status==="fulfilled"?[...r,a.value]:r,[]);return e.signal.aborted||n.filter(({status:r})=>r==="rejected").forEach(({reason:r})=>{console.error(`@polar/polar(plugins/addressSearch/utils/getResultsFromPromises:20:4)
`,"An error occurred while sending a request: ",r)}),t}function Dr(n){if(!n.ok)throw new Error(n.status===418?"The server refuses to brew coffee because it is, permanently, a teapot.":`The received status code ${n.status} indicates an error.`)}function Aa(n,e){let t=`query=${n.replace(" ","+")}`;for(const[r,a]of Object.entries(e).filter(([s])=>s!=="filter"&&s!=="epsg"&&s!=="apiKey"&&s!=="accessToken"))t+=`&${r}=${a}`;return e.filter&&Object.keys(e.filter).length>0&&(t+="&filter=",t=Object.entries(e.filter).reduce((r,[a,s])=>`${r+a}:${s}&`,t).slice(0,-1)),t}async function Fa(n,e,t,r){const a=`${e}?`+Aa(t,r),s={signal:n};r.accessToken?s.headers={Authorization:`Bearer ${r.accessToken}`}:r.apiKey&&(s.headers={"X-Api-Key":r.apiKey});const i=await fetch(encodeURI(a),s);Dr(i);const o=await i.json();return{...o,features:o.features.map(l=>B(l,{geometry:B(l.geometry,{coordinates:r.epsg==="EPSG:4326"?l.geometry.coordinates:We(l.geometry.coordinates,"EPSG:4326",r.epsg)}),title:l.properties.text}))}}async function Pa(n,e,t,r){pn(e);try{const a=B(r,{minCharacters:0});let s=await cr(t,B(a,{searchStreetBeforeWord:!1}));return!s[0]&&(s=await cr(t,a),!s[0])?{type:"FeatureCollection",features:[]}:{type:"FeatureCollection",features:Ma(s,r.epsg,Ra(s[0].properties.position.Point[0].$.srsName))}}catch(a){throw console.error(`@polar/polar(lib/getFeatures/mpapi:50:3)
`,a),new Error("An error occurred while fetching the feature collection.")}}function Ra(n){if(n.includes("::"))return`EPSG:${n.split("::")[1]}`;if(n.includes(":"))return n;throw console.error(`@polar/polar(lib/getFeatures/mpapi:63:2)
`,"Unknown formatting of projection:",n),Error("Unknown formatting of projection: "+n)}const Ma=(n,e,t)=>n.map(r=>{const{name:a,geometry:s}=r;return{type:"Feature",title:a,geometry:B(s,{coordinates:t===e?s.coordinates.map(Number):We(s.coordinates.map(Number),t,e)}),properties:r.properties}}),Da=n=>n.replace(/\r?\n|\r/g,""),Oa=({maxFeatures:n})=>`
<?xml version="1.0" encoding="UTF-8"?>
<wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"${n?` maxFeatures="${n}"`:""}>`,Ga={wildCard:"*",singleChar:".",escapeChar:"!"},Na=({srsName:n,featurePrefix:e,typeName:t,xmlns:r})=>`
<wfs:Query typeName="${e}:${t}" xmlns:${e}="${r}"${n?` srsName="${n}"`:""}>
<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc">`;function ur(n,e,{featurePrefix:t,useRightHandWildcard:r,likeFilterAttributes:a}){const s=B(Ga,a||{});return`
<ogc:PropertyIsLike${Object.entries(s).reduce((i,[o,l])=>`${i} ${o}="${l}"`,"")}>
<ogc:PropertyName>${t}:${n}</ogc:PropertyName>
<ogc:Literal>${e}${typeof r=="boolean"&&!r?"":Object.hasOwn(s,"wildCard")?s.wildCard:"*"}</ogc:Literal>
</ogc:PropertyIsLike>`}function Ba(n,e){let t=Na(e);if(n.length>1)t+=`<ogc:And>${n.map(([r,a])=>ur(r,a,e)).join("")}</ogc:And>`;else if(n.length===1){const r=n[0];t+=ur(r[0],r[1],e)}return t+"</ogc:Filter></wfs:Query>"}const Ge=(n,e)=>Da(Oa(e)+n.map(t=>Ba(t,e)).join("")+"</wfs:GetFeature>");if(import.meta.vitest){const{expect:n,test:e}=import.meta.vitest,t={typeName:"TyPeNaMe",featurePrefix:"prefix",xmlns:"example.com",maxFeatures:999};e("creates an empty search for an empty input",()=>{n(Ge([],t)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"></wfs:GetFeature>')}),e("creates a one-query search for a single match",()=>{n(Ge([[["a","5"]]],t)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:a</ogc:PropertyName><ogc:Literal>5*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query></wfs:GetFeature>')}),e("creates a one-query and-ed search for a single match with multiple fields",()=>{n(Ge([[["a","5"],["b","3"]]],t)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:And><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:a</ogc:PropertyName><ogc:Literal>5*</ogc:Literal></ogc:PropertyIsLike><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:b</ogc:PropertyName><ogc:Literal>3*</ogc:Literal></ogc:PropertyIsLike></ogc:And></ogc:Filter></wfs:Query></wfs:GetFeature>')}),e("creates a multi-query search for a multiple matches",()=>{n(Ge([[["a","5"]],[["b","3"]]],t)).toEqual('<?xml version="1.0" encoding="UTF-8"?><wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" maxFeatures="999"><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:a</ogc:PropertyName><ogc:Literal>5*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query><wfs:Query typeName="prefix:TyPeNaMe" xmlns:prefix="example.com"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:PropertyIsLike wildCard="*" singleChar="." escapeChar="!"><ogc:PropertyName>prefix:b</ogc:PropertyName><ogc:Literal>3*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query></wfs:GetFeature>')})}const At={};function Zt(n){if(At[n])return At[n];const e=Array.from(n.matchAll(/{{(.*?)}}/g)),t=[];let r=0;for(const a of e)r<a.index&&(t.push(n.substring(r,a.index)),r=a.index),t.push(a),r+=a[0].length;return At[n]=t,t}const Va=(n,e)=>n.uninterpreted>e.uninterpreted?1:n.uninterpreted<e.uninterpreted?-1:n.index>e.index?1:n.index<e.index?-1:0,Ua=(n,e,t)=>{const r=[...n.map((s,i)=>({match:s,uninterpreted:t[i],patternLengthDiff:(e[i].match(/{{/g)||[]).length-s.length,index:i}))].sort(Va).map(({match:s})=>s),a=[];return r.filter(s=>{if(s.length===0)return!1;const i=JSON.stringify(s);return a.includes(i)?!1:(a.push(i),!0)})},Ut=(n,e,t)=>{if(!n)throw new Error('Parameter "patterns" is missing on wfs configuration for pattern-based search.');if(!e)throw new Error('Parameter "patternKeys" is missing on wfs configuration for pattern-based search.');const r=[],a=[];return n.forEach(s=>{const i=Zt(s),o=[];let l=t;i.forEach(d=>{let c="";if(Array.isArray(d)){const u=d[1],h=e[u],g=l.match(new RegExp("^"+h));if(g!==null){const f=g[1];o.push([u,f.trim()]),c=g[0].trim()}}else c=d.trim();l.startsWith(c)&&(l=l.substring(c.length).trim())}),a.push(l.length),r.push(o)}),Ua(r,n,a)};if(import.meta.vitest){const{expect:n,test:e}=import.meta.vitest,t=(s,i,o,l,d)=>{const c=[s,i];return c.index=o,c.input=l,c.groups=d,c},r=["{{gemarkung}} {{flur}} {{flstnrzae}}/{{flstnrnen}}, {{flstkennz}}","{{gemarkung}} {{flur}} {{flstnrzae}}, {{flstkennz}}","{{gemarkung}} {{flstnrzae}}/{{flstnrnen}}, {{flstkennz}}","{{gemarkung}} {{flstnrzae}}, {{flstkennz}}","{{flstkennz}}"],a={gemarkung:"([^0-9]+)",flur:"([0-9]+)",flstnrzae:"([0-9]+)",flstnrnen:"([0-9]+)",flstkennz:"([0-9_]+)"};e("getBlocks parts pattern strings to Block[][]",()=>{n(Zt(r[0])).toEqual([t("{{gemarkung}}","gemarkung",0,r[0])," ",t("{{flur}}","flur",14,r[0])," ",t("{{flstnrzae}}","flstnrzae",23,r[0]),"/",t("{{flstnrnen}}","flstnrnen",37,r[0]),", ",t("{{flstkennz}}","flstkennz",52,r[0])])}),e("match builds full match groups",()=>{n(Ut(r,a,"Musterhausen 12 3/4, 1234___")).toEqual([[["gemarkung","Musterhausen"],["flur","12"],["flstnrzae","3"],["flstnrnen","4"],["flstkennz","1234___"]],[["gemarkung","Musterhausen"],["flur","12"],["flstnrzae","3"]],[["gemarkung","Musterhausen"],["flstnrzae","12"],["flstnrnen","3"]],[["gemarkung","Musterhausen"],["flstnrzae","12"],["flstkennz","3"]]])}),e("match manages to decide the best fit",()=>{n(Ut(r,a,"1234___")).toEqual([[["flur","1234"],["flstkennz","___"]],[["flstnrzae","1234"],["flstkennz","___"]],[["flstkennz","1234___"]]])})}function za(n,e){return n.fillPercentage>e.fillPercentage?-1:n.fillPercentage<e.fillPercentage?1:n.keys.length>e.keys.length?-1:n.keys.length<e.keys.length?1:n.index>e.index?-1:n.index<e.index?1:0}function Ha(n,e){const t=n.properties||{},r=[...e.map((a,s)=>{const i=Zt(a).reduce((l,d)=>Array.isArray(d)?[...l,d[1]]:l,[]),o=i.reduce((l,d)=>typeof t[d]<"u"&&t[d]!==""?l+1:l,0);return{pattern:a,keys:i,index:s,fillPercentage:o/i.length}})].sort(za)[0];return r.keys.reduce((a,s)=>a.replace(`{{${s}}}`,t[s]||""),r.pattern)}const hr=new un,Wa=new hn;async function ja(n,e,t,r){const a=[],s={type:"FeatureCollection",features:a},i=await n.text(),o=hr.readFeatures(i),{srsName:l}=hr.readFeatureCollectionMetadata(i);return o.forEach(d=>{const c=JSON.parse(Wa.writeFeature(d));c.title="",e&&(t?c.title=Ha(c,e):c.title=Array.isArray(e)?e.map(u=>c.properties[u]).join(" "):c.properties[e]),l&&(c.geometry=B(c.geometry,{coordinates:We(c.geometry.coordinates,`EPSG:${l.split("::")[1]}`,r)})),a.push(c)}),s}async function qa(n,e,t,r){const{fieldName:a,patterns:s,patternKeys:i}=r;if(!a&&(!s||!i))throw new Error('Incomplete WFS search configuration. Either "fieldName" or "patterns" & "patternKeys" are required.');a&&s&&console.error(`@polar/polar(lib/getFeatures/wfs/index:22:3)
`,'Using both "fieldName" and "patterns" for WFS search. These are mutually exclusive. "patterns" will be ignored.');const o=a?[[[a,t]]]:Ut(s,i,t),l=Ge(o,r),d=await fetch(encodeURI(e),{signal:n,method:"POST",body:l});return Dr(d),ja(d,a||s,!a,r.epsg)}function Ka(){const n={bkg:Fa,mpapi:Pa,wfs:qa};return{registerSearchMethods:e=>{Object.entries(e).forEach(([t,r])=>{if(n[t]){console.error(`@polar/polar(plugins/addressSearch/utils/methodContainer:16:6)
`,`Method "${t}" already exists. Please choose a different name. Overrides are not allowed.`);return}n[t]=r})},getSearchMethod:e=>{const t=n[e];if(t)return t;throw new Error(`The given type "${e}" does not define a valid searchMethod.`)}}}const pe={ERROR:Symbol("error"),NO_SEARCH:Symbol("noSearch")},wt=xe("plugins/addressSearch",()=>{const n=Q(),e={label:"defaultLabel",hint:"",resultDisplayMode:"mixed",limitResults:Number.MAX_SAFE_INTEGER};let t=null,r,a;const s=P(null),i=P(""),o=P(!1),l=P(pe.NO_SEARCH),d=P("defaultGroup"),c=$(()=>u.value.afterResultComponent||null),u=$(()=>n.configuration.addressSearch),h=$({get:()=>i.value,set:I=>{I!==i.value&&(i.value=I,et())}}),g=$(()=>Array.isArray(l.value)&&l.value.length>0&&l.value.some(({features:{features:I}})=>Array.isArray(I)&&I.length>0)),f=$(()=>u.value.focusAfterSearch||!1),k=$(()=>I=>{const N=u.value.groupProperties?.[I]||{};return I==="defaultGroup"?B(e,N):N}),_=$(()=>Object.keys(x.value)),p=$(()=>Object.keys(x.value).map(I=>({groupId:I,text:k.value(I).label}))),m=$(()=>_.value.length>1),w=$(()=>o.value?le(I=>I.hint.loading,{ns:J}):l.value===pe.ERROR?le(I=>I.hint.error,{ns:J}):h.value.length>0&&h.value.length<C.value?le(I=>I.hint.tooShort,{ns:J,minLength:C.value}):l.value!==pe.NO_SEARCH&&!g.value?le(I=>I.hint.noResults,{ns:J}):M.value.hint||""),S=$(()=>M.value.limitResults||e.limitResults),C=$(()=>typeof u.value.minLength=="number"?u.value.minLength:0),x=$(()=>u.value.searchMethods.reduce((I,N)=>{const Z=N.groupId||"defaultGroup";return I[Z]?I[Z].push(N):I[Z]=[N],I},{})),T=$({get:()=>d.value,set:I=>{I!==d.value&&(d.value=I,l.value=pe.NO_SEARCH,h.value.length>0&&Tt())}}),M=$(()=>k.value(T.value)),ie=$(()=>typeof u.value.waitMs=="number"?u.value.waitMs:0);function _e(){r=ba(Tt,ie.value),a=Ka(),T.value=_.value[0],u.value.customSearchMethods&&a.registerSearchMethods(u.value.customSearchMethods)}function St(){}function et(){t&&(t.abort(),t=null),r()}function Et(){h.value="",l.value=pe.NO_SEARCH,s.value=null}function Tt(){if(h.value.length<C.value)return l.value=pe.NO_SEARCH,o.value=!1,Promise.resolve();o.value=!0,t=new AbortController;const I=t;return Promise.allSettled(u.value.searchMethods.map(async({categoryId:N,groupId:Z,queryParameters:Re,type:$t,url:ln})=>{const dn=await a.getSearchMethod($t)(I.signal,ln,h.value,B(Re||{},{epsg:n.configuration.epsg})),nr=N||"default",ar=u.value.categoryProperties?.[nr];return{categoryId:nr,categoryLabel:ar?le(ar.label):le(cn=>cn.defaultLabel,{ns:J}),features:dn,groupId:Z||"defaultGroup"}})).then(N=>l.value=Ia(N,I)).catch(N=>{console.error(`@polar/polar(plugins/addressSearch/store:249:6)
`,"An error occurred while searching.",N),l.value=pe.ERROR}).finally(()=>{o.value=!1})}async function on(I,N="never"){if(h.value=I,t&&(t.abort(),t=null),await Tt(),!Array.isArray(l.value))return;const Z=l.value.find(({features:$t})=>$t.features.length);if(!Z)return;const Re=Z.features.features;(N==="first"&&Re.length>=1||N==="only"&&Re.length===1)&&rr(Re[0],Z.categoryId)}function rr(I,N="default"){const Z=u.value.customSelectResult?.[N];Z?Z(I,N):(s.value=I,i.value=I.title,l.value=pe.NO_SEARCH)}return{chosenAddress:s,inputValue:h,afterResultComponent:c,focusAfterSearch:f,groupSelectOptions:p,hasMultipleGroups:m,isLoading:o,searchResults:l,selectedGroupId:T,featuresAvailable:g,hint:w,limitResults:S,abortAndRequest:et,clear:Et,search:on,selectResult:rr,setupPlugin:_e,teardownPlugin:St}});function Or(n,e,t){for(let r=0;r<n;r++){const a=e.getElementById(`polar-plugin-address-search-results-feature-${r}-0`);if(a){a.focus(),t?.preventDefault();break}}}const Xa={class:"kern-form-input__select-wrapper"},Ja=["aria-label"],Ya=["value"],Qa=W({__name:"GroupSelect.ce",setup(n){const{groupSelectOptions:e,selectedGroupId:t}=ue(wt());return(r,a)=>(b(),E("div",Xa,[Yt(L("select",{"onUpdate:modelValue":a[0]||(a[0]=s=>mt(t)?t.value=s:null),class:"kern-form-input__select","aria-label":r.$t(s=>s.groupSelector,{ns:y(J)})},[(b(!0),E(q,null,Y(y(e),({groupId:s,text:i})=>(b(),E("option",{key:s,value:s},ne(r.$t(o=>o[i],{ns:y(J)})),9,Ya))),128))],8,Ja),[[oa,y(t)]])]))}});function Za(n,e){const t=n.toLowerCase().indexOf(e.toLowerCase());return t===-1?n:n.substring(0,t)+"<strong>"+n.substring(t,t+e.length)+"</strong>"+n.substring(t+e.length)}const es={key:0,class:"polar-plugin-address-search-category-label"},ts={tabindex:"-1"},rs=["id","onClick","onKeydown"],ns=["innerHTML"],as=["onClick"],ss={class:"kern-label"},is={key:2,class:"kern-divider","aria-hidden":"true"},os=W({__name:"SearchResults.ce",setup(n){const e=Q(),t=wt(),{afterResultComponent:r,featuresAvailable:a,inputValue:s,limitResults:i,searchResults:o,selectedGroupId:l}=ue(t);Ae(l,()=>d.value=[]),Ae(a,()=>{t.focusAfterSearch&&Qt(()=>{Or(u.value.length,e.shadowRoot)})});const d=P([]),c=$(()=>e.hasWindowSize?"inherit":`${e.clientHeight*.8}px`),u=$(()=>Array.isArray(t.searchResults)?structuredClone(la(t.searchResults)).filter(_=>_.groupId===t.selectedGroupId).reduce((_,p)=>{const m=_.findIndex(w=>w.categoryId===p.categoryId);return m===-1?[..._,p]:(_[m].features.features=[..._[m].features.features,...p.features.features],_)},[]).map(_=>(h(_.categoryId)||(_.features.features=_.features.features.slice(0,i.value)),_)):[]);function h(_){return d.value.includes(_)}function g(){e.shadowRoot.getElementById("polar-plugin-address-search-input")?.focus()}function f(_,p){const{target:m}=p;if(m===null){console.warn(`@polar/polar(plugins/addressSearch/components/SearchResults.ce.vue?vue&type=script&setup=true&lang:110:3)
`,`@polar/polar(plugins/addressSearch/components/SearchResults.ce:168:3)
`,"Could not focus any element.");return}const w=(e.shadowRoot?.getElementById("polar-plugin-address-search-result-wrapper")).querySelectorAll("li, button"),S=[...w].indexOf(m),C=w[(S+(_?1:-1))%w.length];if(C){C.focus();return}e.shadowRoot.getElementById("polar-plugin-address-search-input")?.focus()}function k(_){d.value=d.value.indexOf(_)===-1?[...d.value,_]:d.value.filter(p=>p!==_)}return(_,p)=>y(a)?(b(),E("div",{key:0,id:"polar-plugin-address-search-result-wrapper",style:da(`max-height: ${c.value}`)},[(b(!0),E(q,null,Y(u.value,(m,w)=>(b(),E(q,{key:m.categoryId},[u.value.length>1?(b(),E("span",es,ne(m.categoryLabel)+" "+ne(_.$t(S=>S.resultCount,{count:y(o)[w].features.features.length,ns:y(J)})),1)):j("",!0),L("ul",ts,[(b(!0),E(q,null,Y(m.features.features,(S,C)=>(b(),E("li",{key:`result-${w}-${C}`,id:`polar-plugin-address-search-results-feature-${w}-${C}`,tabindex:"-1",onClick:x=>y(t).selectResult(S,m.categoryId),onKeydown:[fe(ve(x=>y(t).selectResult(S,m.categoryId),["prevent","stop"]),["enter"]),p[0]||(p[0]=fe(ve(x=>f(!0,x),["prevent","stop"]),["down"])),p[1]||(p[1]=fe(ve(x=>f(!1,x),["prevent","stop"]),["up"])),fe(ve(g,["prevent","stop"]),["escape"])]},[L("span",{innerHTML:y(Za)(S.title,y(s))},null,8,ns),y(r)?(b(),D(yt(y(r)),{key:0,feature:S},null,8,["feature"])):j("",!0)],40,rs))),128))]),y(o)[w].features.features.length>y(i)?(b(),E("button",{key:1,class:"kern-btn kern-btn--tertiary",onKeydown:[p[2]||(p[2]=fe(ve(S=>f(!0,S),["prevent","stop"]),["down"])),p[3]||(p[3]=fe(ve(S=>f(!1,S),["prevent","stop"]),["up"]))],onClick:S=>k(m.categoryId)},[L("span",{class:Ye(`kern-icon ${h(m.categoryId)?"kern-icon--keyboard-arrow-up":"kern-icon--keyboard-arrow-down"}`),"aria-hidden":"true"},null,2),L("span",ss,ne(_.$t(S=>S.resultList[h(m.categoryId)?"reduce":"extend"],{ns:y(J)})),1)],40,as)):j("",!0),w<u.value.length-1?(b(),E("hr",is)):j("",!0)],64))),128))],4)):j("",!0)}}),ls="#polar-plugin-address-search-result-wrapper{&[data-v-3aa20fa5]{width:100%;padding-bottom:.625rem;overflow-y:auto}.polar-plugin-address-search-category-label[data-v-3aa20fa5]{display:flex;align-items:center;height:var(--kern-metric-dimension-x-large);padding:0 var(--kern-metric-space-small);font-size:.875rem;color:var(--kern-color-layout-text-muted)}ul{&[data-v-3aa20fa5]{margin:0;padding:0}li{&[data-v-3aa20fa5]{display:flex;align-items:center;min-height:var(--kern-metric-dimension-x-large);padding:var(--kern-metric-space-none) var(--kern-metric-space-small);margin:var(--kern-metric-space-none) var(--kern-metric-space-small);border-radius:var(--kern-metric-border-radius-default);color:var(--kern-color-layout-text-default);transition:.3s cubic-bezier(.25,.8,.5,1)}&[data-v-3aa20fa5]:hover,&[data-v-3aa20fa5]:focus{background-color:var(--kern-color-layout-background-hued);cursor:pointer}}}button[data-v-3aa20fa5]{width:95%;margin:var(--kern-metric-space-none) var(--kern-metric-space-small)}}",ds=z(os,[["styles",[ls]],["__scopeId","data-v-3aa20fa5"]]),cs={class:"polar-plugin-address-search-selection-wrapper"},us={class:"polar-plugin-address-search-input-wrapper"},hs=["aria-description","onKeydown"],gs={key:0,class:"loader",role:"status"},ps={class:"kern-label kern-sr-only"},fs={key:1,class:"polar-plugin-address-search-hint"},ms=W({__name:"AddressSearch.ce",setup(n){const e=Q(),t=wt(),{hasMultipleGroups:r,hint:a,inputValue:s,isLoading:i,searchResults:o}=ue(t),l=P(!1),d=$(()=>(e.hasSmallDisplay||!e.hasWindowSize)&&!l.value);function c(){(!l.value||!s.value.length&&!r.value)&&(l.value=!l.value,Qt(()=>{(e.shadowRoot?.getElementById(`polar-plugin-address-search-${l.value?"input":"icon-button"}`)).focus()}))}function u(h){Array.isArray(t.searchResults)&&Or(t.searchResults.length,e.shadowRoot,h)}return(h,g)=>d.value?(b(),D(kr,{key:0,id:"polar-plugin-address-search-icon-button",hint:h.$t(f=>f.hint.button,{ns:y(J)}),icon:"kern-icon--search",onClick:c},null,8,["hint"])):(b(),D(kt,{key:1,class:Ye({"has-hint":y(a).length>0,"polar-plugin-address-search-shown-results":Array.isArray(y(o))&&y(o).length})},{default:he(()=>[L("div",cs,[y(r)?(b(),D(Qa,{key:0})):j("",!0),L("div",us,[Yt(L("input",{id:"polar-plugin-address-search-input","onUpdate:modelValue":g[0]||(g[0]=f=>mt(s)?s.value=f:null),class:"kern-form-input__input",type:"text","aria-description":y(a).length>0?y(a):h.$t(f=>f.ariaDescription,{ns:y(J)}),onKeydown:[g[1]||(g[1]=fe((...f)=>y(t).abortAndRequest&&y(t).abortAndRequest(...f),["enter"])),fe(ve(u,["prevent","stop"]),["down"])],onFocusout:c},null,40,hs),[[ia,y(s)]]),y(i)?(b(),E("div",gs,[...g[3]||(g[3]=[L("div",null,null,-1),L("div",null,null,-1),L("div",null,null,-1),L("div",null,null,-1)])])):j("",!0),L("button",{class:"kern-btn kern-btn--tertiary polar-plugin-address-search-input-button",onClick:g[2]||(g[2]=(...f)=>y(t).clear&&y(t).clear(...f))},[g[4]||(g[4]=L("span",{class:"kern-icon kern-icon--close","aria-hidden":"true"},null,-1)),L("span",ps,ne(h.$t(f=>f.hint.clear,{ns:y(J)})),1)]),y(a).length>0?(b(),E("span",fs,ne(y(a)),1)):j("",!0)])]),Ie(ds)]),_:1},8,["class"]))}}),ys="#polar-plugin-address-search-icon-button[data-v-1eff2bd2]{position:absolute;margin:var(--kern-metric-space-small)}.has-hint[data-v-1eff2bd2] .kern-card__container{padding-bottom:var(--kern-metric-space-small)!important}.polar-plugin-address-search-shown-results[data-v-1eff2bd2] .kern-card__container{padding-bottom:0!important}.kern-card{&[data-v-1eff2bd2]{display:flex;flex-direction:column;align-items:flex-start;gap:var(--kern-metric-space-small);position:absolute;margin:var(--kern-metric-space-small)}.polar-plugin-address-search-selection-wrapper{&[data-v-1eff2bd2]{display:flex;flex-direction:row;align-items:center;width:100%;gap:var(--kern-metric-space-small)}.polar-plugin-address-search-input-wrapper{&[data-v-1eff2bd2]{display:flex;flex-direction:column;width:100%}#polar-plugin-address-search-input[data-v-1eff2bd2]{pointer-events:all;border-radius:var(--kern-metric-border-radius-small);background:var(--kern-color-form-input-background)}.polar-plugin-address-search-input-button[data-v-1eff2bd2]{position:absolute;right:0;border-radius:var(--kern-metric-border-radius-small);margin:var(--kern-metric-space-small);margin-right:var(--kern-metric-space-default);width:var(--kern-metric-dimension-large);min-height:var(--kern-metric-dimension-large)}.polar-plugin-address-search-hint[data-v-1eff2bd2]{color:var(--kern-color-layout-text-muted);font-size:.875rem;padding:0 .1rem;margin-top:var(--kern-metric-space-small)}}}}.loader[data-v-1eff2bd2],.loader div[data-v-1eff2bd2]{box-sizing:border-box}.loader[data-v-1eff2bd2]{position:absolute;right:3rem;width:var(--kern-metric-dimension-large);height:var(--kern-metric-dimension-large);margin:var(--kern-metric-space-small)}.loader div[data-v-1eff2bd2]{box-sizing:border-box;display:block;position:absolute;width:var(--kern-metric-dimension-large);height:var(--kern-metric-dimension-large);border:4px solid currentColor;border-radius:50%;animation:loader-1eff2bd2 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:currentColor transparent transparent transparent}.loader div[data-v-1eff2bd2]:nth-child(1){animation-delay:-.45s}.loader div[data-v-1eff2bd2]:nth-child(2){animation-delay:-.3s}.loader div[data-v-1eff2bd2]:nth-child(3){animation-delay:-.15s}@keyframes loader-1eff2bd2{0%{transform:rotate(0)}to{transform:rotate(360deg)}}",_s=z(ms,[["styles",[ys]],["__scopeId","data-v-1eff2bd2"]]),vs={ariaDescription:"Durch Eingabe in das Suchfeld kann die Suche nach Adressen gestartet werden",defaultLabel:"Adresssuche",hint:{button:"Eingabefeld der Addresssuche anzeigen",clear:"Das Eingabefeld der Addresssuche leeren",error:"Etwas ist bei der Suche schiefgegangen.",loading:"Suche ...",noResults:"Keine Ergebnisse gefunden.",tooShort:"Für die Suche bitte mindestens {{minLength}} Zeichen eingeben."},groupSelector:"Suchthema auswählen",resultCount:"({{count}} Ergebnisse)",resultList:{extend:"Alle Ergebnisse anzeigen",reduce:"Ergebnisliste reduzieren"}},bs={ariaDescription:"Durch Eingabe in das Suchfeld kann die Suche nach Adressen gestartet werden",defaultLabel:"Address Search",hint:{button:"Show address search input field",clear:"Clear address search input field",error:"Something went wrong.",loading:"Searching ...",noResults:"No results for the current query.",tooShort:"Please enter at least {{minLength}} characters."},groupSelector:"Select search topic",resultCount:"({{count}} results)",resultList:{extend:"Show all results",reduce:"Reduce result list"}},xs=[{type:"de",resources:vs},{type:"en",resources:bs}];function ks(n){return{id:J,component:_s,locales:xs,storeModule:wt,options:n}}const Gr=xe("plugins/footer",()=>{const n=Q(),e=P([]),t=P([]);function r(){e.value=(n.configuration.footer?.leftEntries||[]).filter(({id:s})=>{const i=n.configuration[s]?.displayComponent;return typeof i=="boolean"?i:!0}),t.value=(n.configuration.footer?.rightEntries||[]).filter(({id:s})=>{const i=n.configuration[s]?.displayComponent;return typeof i=="boolean"?i:!0}),e.value.concat(t.value).forEach(s=>{n.addPlugin(B(s,{independent:!1}))}),e.value.map(s=>B(s,{component:lr(s.component)})),t.value.map(s=>B(s,{component:lr(s.component)}))}function a(){}return{leftEntries:e,rightEntries:t,setupPlugin:r,teardownPlugin:a}}),ws={class:"polar-plugin-footer-wrapper"},Cs=W({__name:"PolarFooter.ce",setup(n){const{leftEntries:e,rightEntries:t}=ue(Gr());return(r,a)=>(b(),E("div",ws,[L("ul",null,[(b(!0),E(q,null,Y(y(e),(s,i)=>(b(),E("li",{key:i},[(b(),D(yt(s.component)))]))),128))]),L("ul",null,[(b(!0),E(q,null,Y(y(t),(s,i)=>(b(),E("li",{key:i},[(b(),D(yt(s.component)))]))),128))])]))}}),Ss=".polar-plugin-footer-wrapper{&[data-v-27a01195]{position:absolute;bottom:0;display:flex;width:100%;height:var(--kern-metric-space-x-large);padding:var(--kern-metric-space-x-small) var(--kern-metric-space-x-small) var(--kern-metric-space-x-small) var(--kern-metric-space-small);justify-content:space-between;align-items:center;flex-shrink:0;background:var(--kern-color-layout-background-hued);box-shadow:0 1px 1px #35395629,0 1px 2px #35395640,0 1px 6px #6e759740;border-radius:0 0 var(--kern-metric-border-radius-large) var(--kern-metric-border-radius-large)}ul{&[data-v-27a01195]{display:flex;align-items:center;gap:var(--kern-metric-space-small);padding:0}li[data-v-27a01195]{list-style:none}}}",Es=z(Cs,[["styles",[Ss]],["__scopeId","data-v-27a01195"]]),Ts={},$s={},Ls=[{type:"de",resources:Ts},{type:"en",resources:$s}],Is="footer";function As(n){return{id:Is,component:Es,locales:Ls,storeModule:Gr,options:n}}const Fs=100,Ps=100,Ft={undefinedBoundaryLayer:Symbol.for("Boundary Layer undefined"),undefinedBoundarySource:Symbol.for("Boundary Source undefined"),sourceNotReady:Symbol.for("Source not ready")};async function Rs(n){let e=0;for(;n.getState()!=="ready"||n.getFeatures().length===0;)if(e++<Fs)await new Promise(t=>{setTimeout(t,Ps)});else return!1;return!0}async function Nr(n,e,t){if(typeof e>"u")return!0;const r=n.getLayers().getArray().find(s=>s.get("id")===e);if(!(r instanceof Fe))return console.error(`@polar/polar(lib/passesBoundaryCheck:61:3)
`,`No layer configured to match boundaryLayerId "${e}".`),Ft.undefinedBoundaryLayer;const a=r.getSource();return a instanceof je?await Rs(a)?a.getFeatures().some(s=>s.getGeometry()?.intersectsCoordinate(t)):(console.error(`@polar/polar(lib/passesBoundaryCheck:79:3)
`,`Layer with boundaryLayerId "${e}" did not load or is featureless.`),Ft.sourceNotReady):(console.error(`@polar/polar(lib/passesBoundaryCheck:70:3)
`,`Layer with boundaryLayerId "${e}" missing source.`),Ft.undefinedBoundarySource)}function gr(){}const R={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},Ms={ERROR:"error"};let Ds=class extends qe{constructor(e){super(Ms.ERROR),this.code=e.code,this.message=e.message}},Os=class extends vn{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=bn,this.watchId_=void 0,this.addChangeListener(R.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(R.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=xn(ut("EPSG:4326"),e),this.position_&&this.set(R.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(R.ACCURACY,t.accuracy),this.set(R.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(R.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(R.HEADING,t.heading===null?void 0:kn(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const r=this.transform_(this.position_);this.set(R.POSITION,r.slice()),this.set(R.SPEED,t.speed===null?void 0:t.speed);const a=wn(this.position_,t.accuracy);a.applyTransform(this.transform_),this.set(R.ACCURACY_GEOMETRY,a),this.changed()}positionError_(e){this.dispatchEvent(new Ds(e))}getAccuracy(){return this.get(R.ACCURACY)}getAccuracyGeometry(){return this.get(R.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(R.ALTITUDE)}getAltitudeAccuracy(){return this.get(R.ALTITUDE_ACCURACY)}getHeading(){return this.get(R.HEADING)}getPosition(){return this.get(R.POSITION)}getProjection(){return this.get(R.PROJECTION)}getSpeed(){return this.get(R.SPEED)}getTracking(){return this.get(R.TRACKING)}getTrackingOptions(){return this.get(R.TRACKING_OPTIONS)}setProjection(e){this.set(R.PROJECTION,ut(e))}setTracking(e){this.set(R.TRACKING,e)}setTrackingOptions(e){this.set(R.TRACKING_OPTIONS,e)}};const Gs=(n,e)=>()=>n.innerHTML=e.map(([t,r,a={}])=>`<${t}>${Oe.t(r,a)}</${t}>`).join(""),Ns=`
	background: rgba(255, 255, 255, 0.8);
	padding: 0.2em 0.5em;
	border-radius: 4px;
	color: #16161d;
	box-shadow: 0px 0px 3px 2px rgba(0, 0, 0, 0.5);
`;function Bs(n,e=Ns){const t=document.createElement("div");t.style.cssText=e;const r=Gs(t,n);return Oe.on("languageChanged",r),Oe.store.on("added",r),r(),{element:t,unregister:()=>{Oe.off("languageChanges",r),Oe.store.off("added",r)}}}function Vs(){return navigator.permissions.query({name:"geolocation"}).then(({state:n})=>n==="denied").catch(()=>!1)}function Us(n,e){const t=e/2*Math.sqrt(3),r=document.createElement("canvas").getContext("2d").createLinearGradient(0,-t,Math.sin(n),t+Math.cos(n));return r.addColorStop(0,"#0794FAFF"),r.addColorStop(2/3,"#0794FA00"),r}function zs(n){if(typeof n.get("heading")>"u")return new ht;const e=42,t=Math.PI-n.get("heading");return new ht({image:new Cn({points:3,radius:e,rotation:t,fill:new wr({color:Us(t,e)}),displacement:[0,-30]})})}function Hs(){const n=new wr({color:"#0078D4"}),e=new yn({color:"#FFFFFF",width:2});return t=>[zs(t),new ht({image:new _n({fill:n,stroke:e,radius:12}),fill:n,stroke:e})]}const Ws=(n,e)=>n[0]!==e[0]||n[1]!==e[1],Br=xe("plugins/geoLocation",()=>{const n=Q(),e=P(!1),t=P(null),r=P(null),a=P([]),s=$(()=>B({showTooltip:!1,zoomLevel:7},n.configuration.geoLocation||{})),i=$(()=>s.value.boundary),o=$(()=>e.value?"DISABLED":t.value===null?"LOCATABLE":"LOCATED"),l=new re({type:"point",name:"geoLocationMarker"}),d=new Fe({source:new je({features:[l]}),properties:{name:"geoLocationMarkerLayer"},zIndex:1/0,style:Hs()});function c(){n.map.addLayer(d),s.value.checkLocationInitially?k():Vs().then(x=>e.value=x),g()}function u(){n.map.removeLayer(d),p(),S(),h()}let h=gr;function g(){if(s.value.showTooltip){const{unregister:x,element:T}=Bs([["h2","markerText",{ns:"geoLocation"}]]),M=new fn({element:T,positioning:"bottom-center",offset:[0,-5]});n.map.addOverlay(M);const ie=({pixel:_e,dragging:St})=>{if(St)return;const et=n.map.getFeaturesAtPixel(_e,{layerFilter:Et=>Et.get("name")==="geoLocationMarkerLayer"}).length?n.map.getCoordinateFromPixel(_e):void 0;M.setPosition(et)};n.map.on("pointermove",ie),h=()=>{x(),n.map.removeOverlay(M),n.map.un("pointermove",ie),h=gr}}}function f(){(o.value==="LOCATABLE"?k:p)()}function k(){if(e.value){_({message:"Geolocation API usage was denied by user or configuration."});return}t.value===null?t.value=new Os({trackingOptions:{enableHighAccuracy:!0},tracking:!0,projection:ut("EPSG:4326")}):m(),t.value.on("change:position",m),t.value.on("change:heading",({target:x})=>{l.set("heading",x.getHeading())}),t.value.on("error",_)}function _(x){Be("error",le(T=>T.button.locationAccessDenied,{ns:"geoLocation"})),console.error(`@polar/polar(plugins/geoLocation/store:176:3)
`,x.message),e.value=!0,S()}function p(){t.value?.setTracking(!1),S(),t.value=null}async function m(){const x=We(t.value?.getPosition(),ut("EPSG:4326"),n.configuration.epsg),T=n.configuration.extent?mn(n.configuration.extent,x):!0,M=await Nr(n.map,i.value?.layerId,x),ie=r.value!==M;r.value=M;const _e=typeof M=="symbol"&&i.value?.onError==="strict";if(!T||_e){C(_e),p();return}Ws(a.value,x)&&(w(x),ie&&!M&&C(!1))}function w(x){a.value=x;const T=!!l.getGeometry();l.setGeometry(new ce(x)),(s.value.keepCentered||!T)&&r.value&&(n.map.getView().setCenter(x),n.map.getView().setZoom(s.value.zoomLevel))}function S(){l.setGeometry(void 0),a.value=[]}function C(x){if(x){const M=le(ie=>ie.toast.boundaryError,{ns:"geoLocation"});Be("error",M),console.error(`@polar/polar(plugins/geoLocation/store:264:4)
`,M);return}const T=le(M=>M.toast.notInBoundary,{ns:"geoLocation"});Be("info",T,{timeout:1e4}),console.info(`@polar/polar(plugins/geoLocation/store:272:3)
`,T)}return{setupPlugin:c,teardownPlugin:u,locate:f,configuration:s,isGeolocationDenied:e,state:o,position:a,boundaryCheck:r}}),Vr="geoLocation",js=W({__name:"GeoLocation.ce",setup(n){const{layout:e}=ue(Q()),t=Br(),{state:r}=ue(t),a=$(()=>r.value==="LOCATED"?"kern-icon-fill--near-me":r.value==="LOCATABLE"?"kern-icon--near-me":"kern-icon--near-me-disabled"),s=$(()=>t.configuration.renderType==="iconMenu"?void 0:e.value==="standard"||t.configuration.layoutTag?.includes("RIGHT")?"left":"right");return(i,o)=>(b(),D(kr,{class:Ye(y(e)==="nineRegions"?"polar-plugin-geoLocation-nineRegions":""),hint:i.$t(l=>l.button.tooltip,{ns:y(Vr)}),icon:a.value,"tooltip-position":s.value,disabled:y(r)==="DISABLED",onClick:y(t).locate},null,8,["class","hint","icon","tooltip-position","disabled","onClick"]))}}),qs=".polar-plugin-geoLocation-nineRegions[data-v-45fc3e3e]{margin:var(--kern-metric-space-small)}",Ks=z(js,[["styles",[qs]],["__scopeId","data-v-45fc3e3e"]]),Xs={markerText:"Aktuelle Position",button:{locationAccessDenied:"Standortzugriff nutzerseitig abgelehnt",tooltip:"Eigene Position markieren"},toast:{boundaryError:"Die Überprüfung Ihrer Position ist fehlgeschlagen. Bitte versuchen Sie es später erneut oder wenden Sie sich an einen Administrator, wenn das Problem bestehen bleibt.",notInBoundary:"Sie befinden sich nicht im Kartengebiet."}},Js={markerText:"Current location",button:{locationAccessDenied:"Location access denied by user",tooltip:"Mark own location"},toast:{boundaryError:"Validating your position failed. Please try later again or contact an administrator if the issue persists.",notInBoundary:"You are not within the map's boundaries."}},Ys=[{type:"de",resources:Xs},{type:"en",resources:Js}];function Qs(n){return{id:Vr,component:Ks,locales:Ys,storeModule:Br,options:n}}const G=[null,"http://www.opengis.net/wms","http://www.opengis.net/sld"];function Qe(n){return Sn(n[0].version,"1.3")>=0}const Zs=O(G,{Service:v(xi),Capability:v(bi)}),ei=O(G,{Request:v(Ii),Exception:v(Si),Layer:v(Ei),UserDefinedSymbolization:v(_i)});let ti=class extends En{constructor(){super(),this.version=void 0}readFromNode(e){return this.version=e.getAttribute("version").trim(),V({version:this.version},Zs,e,[])||null}};const Ur={Name:v(A),Title:v(A),Abstract:v(A),KeywordList:v(Kr),OnlineResource:v(Wt),ContactInformation:v(ki),Fees:v(A),AccessConstraints:v(A)},ri=O(G,Ur),ni=O(G,{...Ur,LayerLimit:v(Lt),MaxWidth:v(Lt),MaxHeight:v(Lt)}),ai=O(G,{ContactPersonPrimary:v(wi),ContactPosition:v(A),ContactAddress:v(Ci),ContactVoiceTelephone:v(A),ContactFacsimileTelephone:v(A),ContactElectronicMailAddress:v(A)}),si=O(G,{ContactPerson:v(A),ContactOrganization:v(A)}),ii=O(G,{AddressType:v(A),Address:v(A),City:v(A),StateOrProvince:v(A),PostCode:v(A),Country:v(A)}),oi=O(G,{Format:Cr(A)}),zr={Name:v(A),Title:v(A),Abstract:v(A),KeywordList:v(Kr),BoundingBox:U(jr),Dimension:U(Ti),Attribution:v(yi),AuthorityURL:U(Pi),Identifier:U(A),MetadataURL:U(Ri),DataURL:U(ge),FeatureListURL:U(ge),Style:U(Mi),Layer:U(Ct)},Hr=O(G,{...zr,SRS:U(A),Extent:v($i),ScaleHint:U(Li),LatLonBoundingBox:v((n,e)=>jr(n,e,!1)),Layer:U(Ct)}),Wr=O(G,{...zr,CRS:U(A),EX_GeographicBoundingBox:v(vi),MinScaleDenominator:v(ke),MaxScaleDenominator:v(ke),Layer:U(Ct)}),li=O(G,{Title:v(A),OnlineResource:v(Wt),LogoURL:v(qr)}),di=O(G,{westBoundLongitude:v(ke),eastBoundLongitude:v(ke),southBoundLatitude:v(ke),northBoundLatitude:v(ke)}),ci=O(G,{GetCapabilities:v(De),GetMap:v(De),GetFeatureInfo:v(De),DescribeLayer:v(De),GetLegendGraphic:v(De)}),ui=O(G,{Format:U(A),DCPType:U(Ai)}),hi=O(G,{HTTP:v(Fi)}),gi=O(G,{Get:v(ge),Post:v(ge)}),pi=O(G,{Name:v(A),Title:v(A),Abstract:v(A),LegendURL:U(qr),StyleSheetURL:v(ge),StyleURL:v(ge)}),fi=O(G,{Format:v(A),OnlineResource:v(Wt)}),mi=O(G,{Keyword:Cr(A)});function yi(n,e){return V({},li,n,e)}function _i(n,e){return{SupportSLD:!!X(n.getAttribute("SupportSLD")),UserLayer:!!X(n.getAttribute("UserLayer")),UserStyle:!!X(n.getAttribute("UserStyle")),RemoteWFS:!!X(n.getAttribute("RemoteWFS")),InlineFeatureData:!!X(n.getAttribute("InlineFeatureData")),RemoteWCS:!!X(n.getAttribute("RemoteWCS"))}}function jr(n,e,t=!0){const r=[de(n.getAttribute("minx")),de(n.getAttribute("miny")),de(n.getAttribute("maxx")),de(n.getAttribute("maxy"))],a=[de(n.getAttribute("resx")),de(n.getAttribute("resy"))],s={extent:r,res:a};return t&&(Qe(e)?s.crs=n.getAttribute("CRS"):s.srs=n.getAttribute("SRS")),s}function vi(n,e){const t=V({},di,n,e);if(!t)return;const r=t.westBoundLongitude,a=t.southBoundLatitude,s=t.eastBoundLongitude,i=t.northBoundLatitude;if(!(r===void 0||a===void 0||s===void 0||i===void 0))return[r,a,s,i]}function bi(n,e){return V({},ei,n,e)}function xi(n,e){return V({},Qe(e)?ni:ri,n,e)}function ki(n,e){return V({},ai,n,e)}function wi(n,e){return V({},si,n,e)}function Ci(n,e){return V({},ii,n,e)}function Si(n,e){return V([],oi,n,e)}function Ei(n,e){const t=V({},Qe(e)?Wr:Hr,n,e);return t.Layer===void 0?Object.assign(t,Ct(n,e)):t}function Ct(n,e){const t=Qe(e),r=e[e.length-1],a=V({},t?Wr:Hr,n,e);if(!a)return;let s=X(n.getAttribute("queryable"));s===void 0&&(s=r.queryable),a.queryable=s!==void 0?s:!1;let i=Nt(n.getAttribute("cascaded"));i===void 0&&(i=r.cascaded),a.cascaded=i;let o=X(n.getAttribute("opaque"));o===void 0&&(o=r.opaque),a.opaque=o!==void 0?o:!1;let l=X(n.getAttribute("noSubsets"));l===void 0&&(l=r.noSubsets),a.noSubsets=l!==void 0?l:!1;let d=de(n.getAttribute("fixedWidth"));d||(d=r.fixedWidth),a.fixedWidth=d;let c=de(n.getAttribute("fixedHeight"));c||(c=r.fixedHeight),a.fixedHeight=c;const u=["Style","AuthorityURL"];t?u.push("CRS"):u.push("SRS","Dimension"),u.forEach(function(g){if(g in r){const f=a[g]||[];a[g]=f.concat(r[g])}});const h=["BoundingBox","Attribution"];return t?h.push("Dimension","EX_GeographicBoundingBox","MinScaleDenominator","MaxScaleDenominator"):h.push("LatLonBoundingBox","ScaleHint","Extent"),h.forEach(function(g){if(!(g in a)){const f=r[g];a[g]=f}}),a}function Ti(n,e){const t={name:n.getAttribute("name"),units:n.getAttribute("units"),unitSymbol:n.getAttribute("unitSymbol")};return Qe(e)&&Object.assign(t,{default:n.getAttribute("default"),multipleValues:X(n.getAttribute("multipleValues")),nearestValue:X(n.getAttribute("nearestValue")),current:X(n.getAttribute("current")),values:A(n)}),t}function $i(n,e){return{name:n.getAttribute("name"),default:n.getAttribute("default"),nearestValue:X(n.getAttribute("nearestValue"))}}function Li(n,e){return{min:de(n.getAttribute("min")),max:de(n.getAttribute("max"))}}function ge(n,e){return V({},fi,n,e)}function Ii(n,e){return V({},ci,n,e)}function Ai(n,e){return V({},hi,n,e)}function Fi(n,e){return V({},gi,n,e)}function De(n,e){return V({},ui,n,e)}function qr(n,e){const t=ge(n,e);if(t){const r=[Nt(n.getAttribute("width")),Nt(n.getAttribute("height"))];return t.size=r,t}}function Pi(n,e){const t=ge(n,e);if(t)return t.name=n.getAttribute("name"),t}function Ri(n,e){const t=ge(n,e);if(t)return t.type=n.getAttribute("type"),t}function Mi(n,e){return V({},pi,n,e)}function Kr(n,e){return V([],mi,n,e)}function Di({legendURL:n,layers:e="",url:t,typ:r,format:a,version:s}){return n?n==="ignore"?[]:[n]:e.split(",").filter(i=>i).map(i=>`${t}?SERVICE=${r}&REQUEST=GetLegendGraphic&FORMAT=${a||"image/png"}&VERSION=${s}&LAYER=${i}`)}const pr=(n,e)=>n.filter(t=>{let{minZoom:r,maxZoom:a}=t;return typeof r>"u"&&(r=0),typeof a>"u"&&(a=Number.MAX_SAFE_INTEGER),r<=e&&e<=a});function vt(n,e){if(Array.isArray(n))return n.map(t=>vt(t,e)).find(t=>t!==null)||null;if(typeof n=="object"){if(n.Name===e)return n;if(n.Layer)return vt(n.Layer,e)}return null}const Oi=n=>(Array.isArray(n)?n:[n]).map(e=>(Array.isArray(e.LegendURL)?e.LegendURL:typeof e.LegendURL=="object"?[e.LegendURL]:[]).map(t=>t.OnlineResource)).flat(1);function Gi(n,e){return vt(n.Capability.Layer,e)?.Title||""}function Ni(n,e){const t=vt(n.Capability.Layer,e)?.Style;return t&&Oi(t)[0]||""}function Bi(n,e){const t=e[n];if(t)try{return new ti().read(t)}catch(r){console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:21:4)
`,`Error reading xml '${t}' for id '${n}'.`,r)}return null}function Vi(n,e){return Promise.all(n.map(async t=>{const{id:r}=t,a=t.options?.layers;if(a&&(a.title===!0||a.legend===!0)){if(typeof e[r]=="string")return console.warn(`@polar/polar(plugins/layerChooser/utils/capabilities:41:6)
`,`Re-fired loadCapabilities on id '${r}' albeit the GetCapabilities have already been successfully fetched. No re-fetch will occur.`),[r,null];const s=xt.getLayerWhere({id:t.id});if(!s||!s.url||!s.version||!s.typ)return console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:49:6)
`,`Missing data for service '${s}' with id '${r}'.`),[r,null];const i=`${s.url}?service=${s.typ}&version=${s.version}&request=GetCapabilities`;try{const o=await fetch(i);return[r,await o.text()]}catch(o){return console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:61:6)
`,`Capabilities from ${i} could not be fetched.`,o),[r,null]}}return[r,null]})).then(t=>t.reduce((r,[a,s])=>B(r,{[a]:s}),{}))}function Ui(n,e,t){const r=xt.getLayerWhere({id:n}),a=Bi(n,e);return{[n]:(t.order?.split(",")||r.layers.split(",")).map(s=>({layerName:s,displayName:t.title===!0&&a?Gi(a,s):t.title===!1?s:t.title?.[s]||s,layerImage:t.legend===!0&&a?Ni(a,s):t.legend===!1?null:t.legend?.[s]||null}))}}const zi=n=>n.reduce(([e,t],r)=>xt.getLayerWhere({id:r.id})===null?(console.error(`@polar/polar(plugins/layerChooser/utils/getBackgroundsAndMasks:15:5)
`,`Layer ${r.id} not found in service register. This is a configuration issue. The map might behave in unexpected ways.`,r),[e,t]):r.type==="background"?[[...e,r],t]:[e,[...t,r]],[[],[]]),Hi=n=>n.map(({id:e,name:t})=>({id:e,name:t})).map(e=>B(e,{rawLayer:xt.getLayerWhere({id:e.id})})).filter(({rawLayer:e})=>e!==null).reduce((e,t)=>{const r=Di(t.rawLayer)[0];return typeof r=="string"?{...e,[t.id]:{name:t.name,url:r}}:e},{}),Pe=xe("plugins/layerChooser",()=>{const n=Q(),e=P({}),t=P([]),r=P([]),a=P([]),s=P([]),i=P(""),o=P([]),l=P({}),d=P(""),c=P({}),u=P(""),h=$(()=>t.value.reduce((C,{id:x})=>({...C,[x]:a.value.findIndex(({id:T})=>T===x)===-1}),{})),g=$(()=>f.value.reduce((C,{id:x})=>({...C,[x]:s.value.findIndex(({id:T})=>T===x)===-1}),{})),f=$(()=>r.value.filter(({hideInMenu:C})=>!C)),k=$(()=>f.value.reduce((C,x)=>B(C,{[x.type]:Array.isArray(C[x.type])?C[x.type].concat(x):[x]}),{}));function _(){const[C,x]=zi(n.configuration.layers);t.value=C,r.value=x,C.length===0&&console.error(`@polar/polar(plugins/layerChooser/store:100:4)
`,'No layers of type "background" have been configured.'),i.value=C.find(({visibility:T})=>T)?.id||"",o.value=x.filter(({visibility:T})=>T).map(({id:T})=>T),w(),n.map.on("moveend",w),l.value=Hi(n.configuration.layers),Vi(n.configuration.layers,e.value).then(T=>{e.value=T,n.configuration.layers.forEach(M=>{const ie=M.options?.layers;ie&&(c.value=B(c.value,Ui(M.id,T,ie)))})})}function p(){n.map.un("moveend",w)}Ae(i,C=>{n.map.getLayers().getArray().forEach(x=>{t.value.find(({id:T})=>T===x.get("id"))&&x.setVisible(x.get("id")===C)})}),Ae(o,C=>{m(C)});function m(C){n.map.getLayers().getArray().forEach(x=>{r.value.find(({id:T})=>T===x.get("id"))&&x.setVisible(C.includes(x.get("id")))})}function w(){const C=n.map.getView().getZoom();a.value=pr(t.value,C),s.value=pr(r.value,C);const x=a.value.map(({id:T})=>T);x.includes(i.value)||(i.value=x[0]||""),m(s.value.map(({id:T})=>T).filter(T=>o.value.includes(T)))}function S(C){const x=n.map.getLayers().getArray().find(T=>T.get("id")===u.value).getSource();if(!x){console.error(`@polar/polar(plugins/layerChooser/store:208:4)
`,`Action 'toggleOpenedOptionsServiceLayer' failed on ${u.value}. Layer not found in OpenLayers or source not initialized in OpenLayers.`);return}x.updateParams({...x.getParams(),LAYERS:C})}return{activeBackgroundId:i,activeMaskIds:o,backgrounds:t,capabilities:e,disabledBackgrounds:h,disabledMasks:g,layersWithLegends:l,layersWithOptions:c,masksSeparatedByType:k,shownMasks:f,openedLegendId:d,openedOptionsId:u,setupPlugin:_,teardownPlugin:p,toggleOpenedOptionsServiceLayer:S}}),ae="layerChooser",Wi=["id"],ji={class:"kern-label"},qi=W({__name:"LayerInformationCard.ce",props:{identifier:{type:String},idName:{type:String}},setup(n){const e=n,t=Q(),r=Pe();ga(()=>{t.shadowRoot?.getElementById(`polar-layer-chooser-${e.identifier}-back-button`)?.focus()});function a(){const s=r[e.idName];r[e.idName]="",Qt(()=>{t.shadowRoot?.getElementById(`polar-layer-chooser-${e.identifier}-${s}-button`)?.focus()})}return(s,i)=>(b(),D(kt,null,{default:he(()=>[L("button",{id:`polar-layer-chooser-${n.identifier}-back-button`,class:"kern-btn kern-btn--secondary",onClick:a},[i[0]||(i[0]=L("span",{class:"kern-icon kern-icon--arrow-back","aria-hidden":"true"},null,-1)),L("span",ji,ne(s.$t(o=>o.returnToLayers,{ns:y(ae)})),1)],8,Wi),Jt(s.$slots,"default",{},void 0,!0)]),_:3}))}}),Ki="button[data-v-a40f4439]{pointer-events:all}",Xr=z(qi,[["styles",[Ki]],["__scopeId","data-v-a40f4439"]]),Xi={class:"kern-label",for:"polar-layer-chooser-legend-anchor"},Ji=["href","aria-label"],Yi=["src","alt"],Qi=W({__name:"LayerLegend.ce",setup(n){const e=Pe(),t=$(()=>e.layersWithLegends[e.openedLegendId]);return(r,a)=>(b(),D(Xr,{identifier:"legend","id-name":"openedLegendId",class:"legend-card"},{default:he(()=>[L("label",Xi,ne(r.$t(s=>s.legend.to,{name:t.value.name,ns:y(ae)})),1),L("a",{id:"polar-layer-chooser-legend-anchor",href:t.value.url,"aria-label":r.$t(s=>s.legend.to,{name:t.value.name,ns:y(ae)}),target:"_blank"},[L("img",{src:t.value.url,alt:r.$t(s=>s.legend.to,{name:t.value.name,ns:y(ae)})},null,8,Yi)],8,Ji)]),_:1}))}}),Zi=".legend-card{&[data-v-d0f82324]{overflow-y:scroll}a[data-v-d0f82324]{pointer-events:all}}",eo=z(Qi,[["styles",[Zi]],["__scopeId","data-v-d0f82324"]]),to={class:"kern-form-check"},ro=["id","name","value","type","disabled"],no=["for"],ao=W({__name:"PolarInput.ce",props:ca({idSuffix:{type:String},label:{type:String},type:{type:null},value:{type:String},disabled:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=ua(n,"modelValue");return(t,r)=>(b(),E("div",to,[Yt(L("input",{id:`polar-${n.type}-${n.value}-${n.idSuffix}`,"onUpdate:modelValue":r[0]||(r[0]=a=>e.value=a),class:Ye(`polar-input kern-form-check__${n.type}`),name:n.value,value:n.value,type:n.type,disabled:n.disabled},null,10,ro),[[ha,e.value]]),L("label",{class:"polar-input kern-label",for:`polar-${n.type}-${n.value}-${n.idSuffix}`},ne(n.label),9,no)]))}}),so=".polar-input[data-v-caf745f0]{pointer-events:all}.kern-form-check__radio[disabled],.kern-form-check__checkbox[disabled]{&[data-v-caf745f0]:hover{border:var(--kern-metric-border-width-default) solid var(--kern-color-form-input-border)}}.kern-form-check__checkbox[disabled]{&[data-v-caf745f0]:checked:hover:before{margin:var(--kern-metric-space-x-small)}}",zt=z(ao,[["styles",[so]],["__scopeId","data-v-caf745f0"]]),io={class:"kern-fieldset"},oo={class:"kern-label"},lo={class:"kern-fieldset__body"},co=W({__name:"PolarInputGroup.ce",props:{legend:{type:String}},setup(n){return(e,t)=>(b(),E("fieldset",io,[L("legend",oo,ne(n.legend),1),L("div",lo,[Jt(e.$slots,"default",{},void 0)])]))}}),uo=".kern-fieldset[data-v-69d29a6c]{width:100%}.kern-fieldset__body[data-v-69d29a6c]{width:100%;padding:var(--kern-metric-space-small) 0;gap:var(--kern-metric-space-small);border-radius:var(--kern-metric-border-radius-default);background-color:var(--kern-color-layout-background-hued)}.kern-label[data-v-69d29a6c]{padding-left:.75rem}[data-v-69d29a6c] .kern-form-check{align-items:center;gap:var(--kern-metric-space-large);margin-left:.75rem;padding-right:0}",Ht=z(co,[["styles",[uo]],["__scopeId","data-v-69d29a6c"]]),ho=["src","alt"],go=W({__name:"LayerOptions.ce",setup(n){const e=Q(),t=Pe(),{openedOptionsId:r}=ue(t),a=$(()=>t.layersWithOptions[r.value]),s=P(a.value.map(({layerName:l})=>l).reverse()),i=$({get:()=>s.value,set:l=>{s.value=l,t.toggleOpenedOptionsServiceLayer(l)}}),o=$(()=>e.configuration.layers.find(({id:l})=>l===r.value)?.name||"");return(l,d)=>(b(),D(Xr,{identifier:"options","id-name":"openedOptionsId"},{default:he(()=>[Ie(Ht,{legend:l.$t(c=>c.layerHeader,{ns:y(ae),name:o.value})},{default:he(()=>[(b(!0),E(q,null,Y(a.value,({displayName:c,layerImage:u,layerName:h})=>(b(),E("div",{key:`polar-layer-chooser-mask-options-checkbox-${h}`,class:"polar-layer-chooser-options-checkbox-wrapper"},[u?(b(),E("img",{key:0,src:u,alt:h},null,8,ho)):j("",!0),Ie(zt,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=g=>i.value=g),"id-suffix":"polar-layer-chooser-mask-options",label:c,type:"checkbox",value:h,class:Ye(a.value.some(({layerImage:g})=>g!==null)?"polar-layer-chooser-options-checkbox":"")},null,8,["modelValue","label","value","class"])]))),128))]),_:1},8,["legend"])]),_:1}))}}),po=".polar-layer-chooser-options-checkbox-wrapper[data-v-ee5a3965]{display:flex;justify-content:flex-start;align-items:center;gap:var(--kern-metric-space-large)}.kern-form-check.polar-layer-chooser-options-checkbox[data-v-ee5a3965]{margin-left:0}.kern-btn[data-v-ee5a3965]{border:none;min-height:inherit;padding:var(--kern-metric-space-x-small);pointer-events:all}.kern-label[data-v-ee5a3965]{padding:0;padding-left:var(--kern-metric-space-small)}",fo=z(go,[["styles",[po]],["__scopeId","data-v-ee5a3965"]]),mo=["id","disabled"],yo={class:"kern-label kern-sr-only"},fr=W({__name:"LegendButton.ce",props:{disabled:{type:Boolean},id:{type:String}},setup(n){return(e,t)=>(b(),E("button",{id:`polar-layer-chooser-legend-${n.id}-button`,class:"kern-btn kern-btn--tertiary",disabled:n.disabled},[t[0]||(t[0]=L("span",{class:"kern-icon kern-icon--info","aria-hidden":"true"},null,-1)),L("span",yo,ne(e.$t(r=>r.legend.open,{ns:y(ae)})),1)],8,mo))}}),_o=["id","disabled","onClick"],vo={class:"kern-label kern-sr-only"},bo=W({__name:"LayerSelection.ce",setup(n){const e=Pe(),{activeBackgroundId:t,activeMaskIds:r,backgrounds:a,disabledBackgrounds:s,disabledMasks:i,layersWithOptions:o,masksSeparatedByType:l,openedLegendId:d,shownMasks:c}=ue(e),u=$(()=>Object.keys(e.layersWithLegends));function h(g){e.openedOptionsId=g}return(g,f)=>(b(),D(kt,{id:"polar-layer-chooser-card"},{default:he(()=>[y(a).length?(b(),D(Ht,{key:0,legend:g.$t(k=>k.backgroundTitle,{ns:y(ae)})},{default:he(()=>[(b(!0),E(q,null,Y(y(a),({name:k,id:_})=>(b(),E("div",{key:`polar-layer-chooser-background-radio-${_}`,class:"polar-layer-chooser-input-wrapper"},[Ie(zt,{modelValue:y(t),"onUpdate:modelValue":f[0]||(f[0]=p=>mt(t)?t.value=p:null),"id-suffix":"polar-layer-chooser-background",label:k,type:"radio",value:_,disabled:y(s)[_]},null,8,["modelValue","label","value","disabled"]),u.value.includes(_)?(b(),D(fr,{key:0,id:_,disabled:y(s)[_],onClick:p=>d.value=_},null,8,["id","disabled","onClick"])):j("",!0)]))),128))]),_:1},8,["legend"])):j("",!0),y(c).length?(b(!0),E(q,{key:1},Y(Object.entries(y(l)),([k,_])=>(b(),D(Ht,{key:`polar-layer-chooser-mask-${k}`,legend:g.$t(p=>p[`${k}Title`],{ns:y(ae)})},{default:he(()=>[(b(!0),E(q,null,Y(_,({name:p,id:m})=>(b(),E("div",{key:`polar-layer-chooser-mask-${k}-checkbox-${m}`,class:"polar-layer-chooser-input-wrapper"},[Ie(zt,{modelValue:y(r),"onUpdate:modelValue":f[1]||(f[1]=w=>mt(r)?r.value=w:null),"id-suffix":`polar-layer-chooser-mask-${k}`,label:p,type:"checkbox",value:m,disabled:y(i)[m]},null,8,["modelValue","id-suffix","label","value","disabled"]),Object.keys(y(o)).includes(m)?(b(),E("button",{key:0,id:`polar-layer-chooser-options-${m}-button`,class:"kern-btn kern-btn--tertiary",disabled:y(i)[m],onClick:()=>h(m)},[f[2]||(f[2]=L("span",{class:"kern-icon kern-icon-fill--settings","aria-hidden":"true"},null,-1)),L("span",vo,ne(g.$t(w=>w.layerOptions,{ns:y(ae)})),1)],8,_o)):u.value.includes(m)?(b(),D(fr,{key:1,id:m,disabled:y(i)[m],onClick:w=>d.value=m},null,8,["id","disabled","onClick"])):j("",!0)]))),128))]),_:2},1032,["legend"]))),128)):j("",!0)]),_:1}))}}),xo="#polar-layer-chooser-card[data-v-98ce45f5]{overflow-y:inherit}.polar-layer-chooser-input-wrapper{&[data-v-98ce45f5]{display:flex;justify-content:space-between;align-items:center;gap:var(--kern-metric-space-large)}button[data-v-98ce45f5]{pointer-events:all}}.kern-btn[data-v-98ce45f5]{width:var(--kern-metric-dimension-large);min-height:var(--kern-metric-dimension-large);border:none;border-radius:50%}",ko=z(bo,[["styles",[xo]],["__scopeId","data-v-98ce45f5"]]),wo=W({__name:"LayerChooser.ce",setup(n){const e=Pe(),t=$(()=>e.openedLegendId.length!==0),r=$(()=>e.openedOptionsId.length===0&&!t.value);return(a,s)=>r.value?(b(),D(ko,{key:0})):t.value?(b(),D(eo,{key:1})):(b(),D(fo,{key:2}))}}),Co={backgroundTitle:"Hintergrundkarten",maskTitle:"Fachdaten",layerHeader:'Auswahl sichtbarer Ebenen für Layer "{{name}}"',layerOptions:"Optionen für Kartenmaterial",legend:{title:"Legende",to:'Legendenbild zu "{{name}}"',open:`$t(legend.to, {ns: ${ae}}) öffnen`},returnToLayers:"Zurück"},So={backgroundTitle:"Background maps",maskTitle:"Subject data",layerHeader:'Visible layer selection for layer "{{name}}"',layerOptions:"Map data options",legend:{title:"Legend",to:'"{{name}}" legend image',open:`Open $t(legend.to, {ns: ${ae}})`},returnToLayers:"Back"},Eo=[{type:"de",resources:Co},{type:"en",resources:So}];function To(n){return{id:ae,component:wo,icon:"kern-icon-fill--layers",locales:Eo,storeModule:Pe,options:n}}const $o=["KernLoader","BasicLoader","RingLoader","RollerLoader","CircleLoader","SpinnerLoader"],Jr=xe("plugins/loadingIndicator",()=>{const n=P(new Set),e=P("KernLoader"),t=$(()=>n.value.size>0);function r(){const l=Q().configuration.loadingIndicator?.loaderStyle;l&&o(l)}function a(){o("KernLoader")}function s(l){n.value=new Set([...n.value,l])}function i(l){const d=new Set(n.value);d.delete(l),n.value=d}function o(l){$o.includes(l)?e.value=l:console.error(`@polar/polar(plugins/loadingIndicator/store:62:5)
`,`Loader style ${l} does not exist. Using previous style (${e.value}).`)}return{loaderStyle:e,showLoader:t,addLoadingKey:s,removeLoadingKey:i,setLoaderStyle:o,setupPlugin:r,teardownPlugin:a}}),Lo={class:"lds-default"},Io=W({__name:"BasicLoader.ce",setup(n){return(e,t)=>(b(),E("div",Lo,[(b(),E(q,null,Y(12,r=>L("div",{key:r})),64))]))}}),Ao=".lds-default[data-v-6079aaec]{color:var(--kern-color-action-default)}.lds-default[data-v-6079aaec],.lds-default div[data-v-6079aaec]{box-sizing:border-box}.lds-default[data-v-6079aaec]{display:inline-block;position:relative;width:80px;height:80px}.lds-default div[data-v-6079aaec]{position:absolute;width:6.4px;height:6.4px;background:currentColor;border-radius:50%;animation:lds-default-6079aaec 1.2s linear infinite}.lds-default div[data-v-6079aaec]:nth-child(1){animation-delay:0s;top:36.8px;left:66.24px}.lds-default div[data-v-6079aaec]:nth-child(2){animation-delay:-.1s;top:22.08px;left:62.29579px}.lds-default div[data-v-6079aaec]:nth-child(3){animation-delay:-.2s;top:11.30421px;left:51.52px}.lds-default div[data-v-6079aaec]:nth-child(4){animation-delay:-.3s;top:7.36px;left:36.8px}.lds-default div[data-v-6079aaec]:nth-child(5){animation-delay:-.4s;top:11.30421px;left:22.08px}.lds-default div[data-v-6079aaec]:nth-child(6){animation-delay:-.5s;top:22.08px;left:11.30421px}.lds-default div[data-v-6079aaec]:nth-child(7){animation-delay:-.6s;top:36.8px;left:7.36px}.lds-default div[data-v-6079aaec]:nth-child(8){animation-delay:-.7s;top:51.52px;left:11.30421px}.lds-default div[data-v-6079aaec]:nth-child(9){animation-delay:-.8s;top:62.29579px;left:22.08px}.lds-default div[data-v-6079aaec]:nth-child(10){animation-delay:-.9s;top:66.24px;left:36.8px}.lds-default div[data-v-6079aaec]:nth-child(11){animation-delay:-1s;top:62.29579px;left:51.52px}.lds-default div[data-v-6079aaec]:nth-child(12){animation-delay:-1.1s;top:51.52px;left:62.29579px}@keyframes lds-default-6079aaec{0%,20%,80%,to{transform:scale(1)}50%{transform:scale(1.5)}}",Fo=z(Io,[["styles",[Ao]],["__scopeId","data-v-6079aaec"]]),Po={},Ro=".lds-circle[data-v-149ac9d5]{color:var(--kern-color-action-default)}.lds-circle[data-v-149ac9d5],.lds-circle div[data-v-149ac9d5]{box-sizing:border-box}.lds-circle[data-v-149ac9d5]{display:inline-block;transform:translateZ(1px);width:80px;height:80px}.lds-circle>div[data-v-149ac9d5]{display:inline-block;width:64px;height:64px;margin:8px;background:currentColor;border-radius:50%;animation:lds-circle-149ac9d5 2.4s cubic-bezier(0,.2,.8,1) infinite}@keyframes lds-circle-149ac9d5{0%,to{animation-timing-function:cubic-bezier(.5,0,1,.5)}0%{transform:rotateY(0)}50%{transform:rotateY(1800deg);animation-timing-function:cubic-bezier(0,.5,.5,1)}to{transform:rotateY(3600deg)}}",Mo={class:"lds-circle"};function Do(n,e,t,r,a,s){return b(),E("div",Mo,[...e[0]||(e[0]=[L("div",null,null,-1)])])}const Oo=z(Po,[["render",Do],["styles",[Ro]],["__scopeId","data-v-149ac9d5"]]),Go={},No=".lds-ring[data-v-712a38e8]{color:var(--kern-color-action-default)}.lds-ring[data-v-712a38e8],.lds-ring div[data-v-712a38e8]{box-sizing:border-box}.lds-ring[data-v-712a38e8]{display:inline-block;position:relative;width:80px;height:80px}.lds-ring div[data-v-712a38e8]{box-sizing:border-box;display:block;position:absolute;width:64px;height:64px;margin:8px;border:8px solid currentColor;border-radius:50%;animation:lds-ring-712a38e8 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:currentColor transparent transparent transparent}.lds-ring div[data-v-712a38e8]:nth-child(1){animation-delay:-.45s}.lds-ring div[data-v-712a38e8]:nth-child(2){animation-delay:-.3s}.lds-ring div[data-v-712a38e8]:nth-child(3){animation-delay:-.15s}@keyframes lds-ring-712a38e8{0%{transform:rotate(0)}to{transform:rotate(360deg)}}",Bo={class:"lds-ring"};function Vo(n,e,t,r,a,s){return b(),E("div",Bo,[(b(),E(q,null,Y(4,i=>L("div",{key:i})),64))])}const Uo=z(Go,[["render",Vo],["styles",[No]],["__scopeId","data-v-712a38e8"]]),zo={},Ho='.lds-roller[data-v-c8254b29]{color:var(--kern-color-action-default)}.lds-roller[data-v-c8254b29],.lds-roller div[data-v-c8254b29],.lds-roller div[data-v-c8254b29]:after{box-sizing:border-box}.lds-roller[data-v-c8254b29]{display:inline-block;position:relative;width:80px;height:80px}.lds-roller div[data-v-c8254b29]{animation:lds-roller-c8254b29 1.2s cubic-bezier(.5,0,.5,1) infinite;transform-origin:40px 40px}.lds-roller div[data-v-c8254b29]:after{content:" ";display:block;position:absolute;width:7.2px;height:7.2px;border-radius:50%;background:currentColor;margin:-3.6px 0 0 -3.6px}.lds-roller div[data-v-c8254b29]:nth-child(1){animation-delay:-36ms}.lds-roller div[data-v-c8254b29]:nth-child(1):after{top:62.62742px;left:62.62742px}.lds-roller div[data-v-c8254b29]:nth-child(2){animation-delay:-72ms}.lds-roller div[data-v-c8254b29]:nth-child(2):after{top:67.71281px;left:56px}.lds-roller div[data-v-c8254b29]:nth-child(3){animation-delay:-.108s}.lds-roller div[data-v-c8254b29]:nth-child(3):after{top:70.90963px;left:48.28221px}.lds-roller div[data-v-c8254b29]:nth-child(4){animation-delay:-.144s}.lds-roller div[data-v-c8254b29]:nth-child(4):after{top:72px;left:40px}.lds-roller div[data-v-c8254b29]:nth-child(5){animation-delay:-.18s}.lds-roller div[data-v-c8254b29]:nth-child(5):after{top:70.90963px;left:31.71779px}.lds-roller div[data-v-c8254b29]:nth-child(6){animation-delay:-.216s}.lds-roller div[data-v-c8254b29]:nth-child(6):after{top:67.71281px;left:24px}.lds-roller div[data-v-c8254b29]:nth-child(7){animation-delay:-.252s}.lds-roller div[data-v-c8254b29]:nth-child(7):after{top:62.62742px;left:17.37258px}.lds-roller div[data-v-c8254b29]:nth-child(8){animation-delay:-.288s}.lds-roller div[data-v-c8254b29]:nth-child(8):after{top:56px;left:12.28719px}@keyframes lds-roller-c8254b29{0%{transform:rotate(0)}to{transform:rotate(360deg)}}',Wo={class:"lds-roller"};function jo(n,e,t,r,a,s){return b(),E("div",Wo,[(b(),E(q,null,Y(8,i=>L("div",{key:i})),64))])}const qo=z(zo,[["render",jo],["styles",[Ho]],["__scopeId","data-v-c8254b29"]]),Ko={},Xo='.lds-spinner[data-v-1790c8de]{color:var(--kern-color-action-default)}.lds-spinner[data-v-1790c8de],.lds-spinner div[data-v-1790c8de],.lds-spinner div[data-v-1790c8de]:after{box-sizing:border-box}.lds-spinner[data-v-1790c8de]{color:currentColor;display:inline-block;position:relative;width:80px;height:80px}.lds-spinner div[data-v-1790c8de]{transform-origin:40px 40px;animation:lds-spinner-1790c8de 1.2s linear infinite}.lds-spinner div[data-v-1790c8de]:after{content:" ";display:block;position:absolute;top:3.2px;left:36.8px;width:6.4px;height:17.6px;border-radius:20%;background:currentColor}.lds-spinner div[data-v-1790c8de]:nth-child(1){transform:rotate(0);animation-delay:-1.1s}.lds-spinner div[data-v-1790c8de]:nth-child(2){transform:rotate(30deg);animation-delay:-1s}.lds-spinner div[data-v-1790c8de]:nth-child(3){transform:rotate(60deg);animation-delay:-.9s}.lds-spinner div[data-v-1790c8de]:nth-child(4){transform:rotate(90deg);animation-delay:-.8s}.lds-spinner div[data-v-1790c8de]:nth-child(5){transform:rotate(120deg);animation-delay:-.7s}.lds-spinner div[data-v-1790c8de]:nth-child(6){transform:rotate(150deg);animation-delay:-.6s}.lds-spinner div[data-v-1790c8de]:nth-child(7){transform:rotate(180deg);animation-delay:-.5s}.lds-spinner div[data-v-1790c8de]:nth-child(8){transform:rotate(210deg);animation-delay:-.4s}.lds-spinner div[data-v-1790c8de]:nth-child(9){transform:rotate(240deg);animation-delay:-.3s}.lds-spinner div[data-v-1790c8de]:nth-child(10){transform:rotate(270deg);animation-delay:-.2s}.lds-spinner div[data-v-1790c8de]:nth-child(11){transform:rotate(300deg);animation-delay:-.1s}.lds-spinner div[data-v-1790c8de]:nth-child(12){transform:rotate(330deg);animation-delay:0s}@keyframes lds-spinner-1790c8de{0%{opacity:1}to{opacity:0}}',Jo={class:"lds-spinner"};function Yo(n,e,t,r,a,s){return b(),E("div",Jo,[(b(),E(q,null,Y(12,i=>L("div",{key:i})),64))])}const Qo=z(Ko,[["render",Yo],["styles",[Xo]],["__scopeId","data-v-1790c8de"]]),Zo={key:0,class:"polar-plugin-loading-indicator-wrapper"},el={key:0,class:"polar-plugin-loading-indicator-overlay"},tl={key:0,class:"kern-loader kern-loader--visible",role:"status"},rl=W({__name:"LoadingIndicator.ce",setup(n){const{layout:e}=ue(Q()),{loaderStyle:t,showLoader:r}=ue(Jr()),a={BasicLoader:Fo,CircleLoader:Oo,RingLoader:Uo,RollerLoader:qo,SpinnerLoader:Qo};return(s,i)=>y(r)&&y(t)!==null?(b(),E("div",Zo,[y(e)==="standard"?(b(),E("div",el)):j("",!0),Ie(kt,null,{default:he(()=>[y(t)==="KernLoader"?(b(),E("div",tl)):(b(),D(yt(a[y(t)]),{key:1,class:"kern-loader--visible",role:"status"}))]),_:1})])):j("",!0)}}),nl=".polar-plugin-loading-indicator-wrapper{&[data-v-d34e6512]{z-index:100;position:absolute;display:flex;align-items:center;justify-content:center;width:100%;height:100%}.polar-plugin-loading-indicator-overlay[data-v-d34e6512]{position:absolute;width:100%;height:100%;opacity:var(--kern-color-action-state-opacity-overlay);background:#fff}.kern-card[data-v-d34e6512]{min-width:fit-content;height:fit-content;border-radius:50%}[data-v-d34e6512] .kern-card__container{padding:var(--kern-metric-space-small)!important}}",al=z(rl,[["styles",[nl]],["__scopeId","data-v-d34e6512"]]),sl="loadingIndicator";function il(n){return{id:sl,component:al,storeModule:Jr,options:n}}class Ze extends Hn{constructor(e,t,r){super(),r!==void 0&&t===void 0?this.setFlatCoordinates(r,e):(t=t||0,this.setCenterAndRadius(e,t,r))}clone(){const e=new Ze(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,a){const s=this.flatCoordinates,i=e-s[0],o=t-s[1],l=i*i+o*o;if(l<a){if(l===0)for(let d=0;d<this.stride;++d)r[d]=s[d];else{const d=this.getRadius()/Math.sqrt(l);r[0]=s[0]+d*i,r[1]=s[1]+d*o;for(let c=2;c<this.stride;++c)r[c]=s[c]}return r.length=this.stride,l}return a}containsXY(e,t){const r=this.flatCoordinates,a=e-r[0],s=t-r[1];return a*a+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,r=t[this.stride]-t[0];return Wn(t[0]-r,t[1]-r,t[0]+r,t[1]+r,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(jn(e,t)){const r=this.getCenter();return e[0]<=r[0]&&e[2]>=r[0]||e[1]<=r[1]&&e[3]>=r[1]?!0:qn(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,r=this.flatCoordinates[t]-this.flatCoordinates[0],a=e.slice();a[t]=a[0]+r;for(let s=1;s<t;++s)a[t+s]=e[s];this.setFlatCoordinates(this.layout,a),this.changed()}setCenterAndRadius(e,t,r){this.setLayout(r,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const a=this.flatCoordinates;let s=Kn(a,0,e,this.stride);a[s++]=a[0]+t;for(let i=1,o=this.stride;i<o;++i)a[s++]=a[i];a.length=s,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const r=this.getCenter(),a=this.getStride();this.setCenter(Xn(r,0,r.length,a,e,t,r)),this.changed()}}Ze.prototype.transform;function me(n,e){const t=n.length;return e<0?n[e+t]:e>=t?n[e-t]:n[e]}function Ee(n,e){const t=n.length;let r=Math.floor(e);const a=e-r;r>=t?r-=t:r<0&&(r+=t);let s=r+1;s>=t&&(s-=t);const i=n[r],o=i[0],l=i[1],d=n[s],c=d[0]-o,u=d[1]-l;return[o+c*a,l+u*a]}const rt={index:-1,endIndex:NaN,closestTargetDistance:1/0};function Yr(n,e,t,r){const a=n[0],s=n[1];let i=1/0,o=-1,l=NaN;for(let u=0;u<e.targets.length;++u){const h=e.targets[u],g=h.coordinates;let f=1/0,k;for(let _=0;_<g.length-1;++_){const p=g[_],m=g[_+1],w=en(a,s,p,m);w.squaredDistance<f&&(f=w.squaredDistance,k=_+w.along)}f<i&&(i=f,h.ring&&e.targetIndex===u&&(h.endIndex>h.startIndex?k<h.startIndex&&(k+=g.length):h.endIndex<h.startIndex&&k>h.startIndex&&(k-=g.length)),l=k,o=u)}const d=e.targets[o];let c=d.ring;if(e.targetIndex===o&&c){const u=Ee(d.coordinates,l),h=t.getPixelFromCoordinate(u),g=t.getPixelFromCoordinate(e.startCoord);Ce(h,g)>r&&(c=!1)}if(c){const u=d.coordinates,h=u.length,g=d.startIndex,f=l;if(g<f){const k=st(u,g,f);st(u,g,f-h)<k&&(l-=h)}else{const k=st(u,g,f);st(u,g,f+h)<k&&(l+=h)}}return rt.index=o,rt.endIndex=l,rt.closestTargetDistance=i,rt}function Qr(n,e){const t=[];for(let r=0;r<e.length;++r){const a=e[r].getGeometry();Zr(n,a,t)}return t}function Zr(n,e,t){if(e instanceof Ve){nt(n,e.getCoordinates(),!1,t);return}if(e instanceof qt){const r=e.getCoordinates();for(let a=0,s=r.length;a<s;++a)nt(n,r[a],!1,t);return}if(e instanceof bt){const r=e.getCoordinates();for(let a=0,s=r.length;a<s;++a)nt(n,r[a],!0,t);return}if(e instanceof Kt){const r=e.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a];for(let o=0,l=i.length;o<l;++o)nt(n,i[o],!0,t)}return}if(e instanceof Jn){const r=e.getGeometries();for(let a=0;a<r.length;++a)Zr(n,r[a],t);return}}function nt(n,e,t,r){const a=n[0],s=n[1];for(let i=0,o=e.length-1;i<o;++i){const l=e[i],d=e[i+1],c=en(a,s,l,d);if(c.squaredDistance===0){const u=i+c.along;r.push({coordinates:e,ring:t,startIndex:u,endIndex:u});return}}}function at(n,e){return Lr(n[0],n[1],e[0],e[1])}function st(n,e,t){let r,a;e<t?(r=e,a=t):(r=t,a=e);const s=Math.ceil(r),i=Math.floor(a);if(s>i){const l=Ee(n,r),d=Ee(n,a);return at(l,d)}let o=0;if(r<s){const l=Ee(n,r),d=me(n,s);o+=at(l,d)}if(i<a){const l=me(n,i),d=Ee(n,a);o+=at(l,d)}for(let l=s;l<i-1;++l){const d=me(n,l),c=me(n,l+1);o+=at(d,c)}return o}const Pt={along:0,squaredDistance:0};function en(n,e,t,r){const a=t[0],s=t[1],i=r[0],o=r[1],l=i-a,d=o-s;let c=0,u=a,h=s;return(l!==0||d!==0)&&(c=Zn(((n-a)*l+(e-s)*d)/(l*l+d*d),0,1),u+=l*c,h+=d*c),Pt.along=c,Pt.squaredDistance=Yn(Lr(n,e,u,h),10),Pt}const it={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class ot extends qe{constructor(e,t){super(e),this.feature=t}}class ol extends jt{constructor(e){const t=e;t.stopDown||(t.stopDown=Fn),super(t),this.on,this.once,this.un,this.options_=e,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=dl(this.type_),this.stopClick_=!!e.stopClick,this.ignoreNextUpEvent_=!1,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:He,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let r=e.geometryFunction;if(!r){const a=this.mode_;if(a==="Circle")r=(s,i,o)=>{const l=i||new Ze([NaN,NaN]),d=H(s[0]),c=pt(d,H(s[s.length-1]));return l.setCenterAndRadius(d,Math.sqrt(c),this.geometryLayout_),l};else{let s;a==="Point"?s=ce:a==="LineString"?s=Ve:a==="Polygon"&&(s=bt),r=(i,o,l)=>(o?a==="Polygon"?i[0].length?o.setCoordinates([i[0].concat([i[0][0]])],this.geometryLayout_):o.setCoordinates([],this.geometryLayout_):o.setCoordinates(i,this.geometryLayout_):o=new s(i,this.geometryLayout_),o)}}this.geometryFunction_=r,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Fe({source:new je({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:ll(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:Pn,this.freehandCondition_,e.freehand?this.freehandCondition_=$e:this.freehandCondition_=e.freehandCondition?e.freehandCondition:Bt,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(Er.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=$e:t=e:t=gt,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}setFreehand(e){this.freehand_=e,this.freehand_?this.freehandCondition_=$e:this.freehandCondition_=this.options_&&this.options_.freehandCondition?this.options_.freehandCondition:Bt}getOverlay(){return this.overlay_}getFreehand(){return this.freehand_}handleEvent(e){e.originalEvent.type===Vt.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===ee.POINTERMOVE,r=!0;return!this.freehand_&&this.lastDragTime_&&e.type===ee.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===ee.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),r=!1):this.freehand_&&e.type===ee.POINTERDOWN?r=!1:t&&this.getPointerCount()<2?(r=e.type===ee.POINTERMOVE,r&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===ee.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===ee.DBLCLICK&&(r=!1),super.handleEvent(e)&&r}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new Rn(ee.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),r=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),a=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),s=K([r,a]),i=this.traceSource_.getFeaturesInExtent(s);if(i.length===0)return;const o=Qr(e.coordinate,i);o.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:o,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const r=e.startIndex<=e.endIndex,a=e.startIndex<=t;r===a?r&&t>e.endIndex||!r&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(r&&t<e.endIndex||!r&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let r=0;if(e<t){const a=Math.ceil(e);let s=Math.floor(t);s===t&&(s-=1),r=s-a+1}else{const a=Math.floor(e);let s=Math.ceil(t);s===t&&(s+=1),r=a-s+1}r>0&&this.removeLastPoints_(r)}addTracedCoordinates_(e,t,r){if(t===r)return;const a=[];if(t<r){const s=Math.ceil(t);let i=Math.floor(r);i===r&&(i-=1);for(let o=s;o<=i;++o)a.push(me(e.coordinates,o))}else{const s=Math.floor(t);let i=Math.ceil(r);i===r&&(i+=1);for(let o=s;o>=i;--o)a.push(me(e.coordinates,o))}a.length&&this.appendCoordinates(a)}updateTrace_(e){const t=this.traceState_;if(!t.active)return;if(t.targetIndex===-1){const o=e.map.getPixelFromCoordinate(t.startCoord);if(Ce(o,e.pixel)<this.snapTolerance_)return}const r=Yr(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==r.index){if(t.targetIndex!==-1){const l=t.targets[t.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const o=t.targets[r.index];this.addTracedCoordinates_(o,o.startIndex,r.endIndex)}else{const o=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(o,r.endIndex)}t.targetIndex=r.index;const a=t.targets[t.targetIndex];a.endIndex=r.endIndex;const s=Ee(a.coordinates,a.endIndex),i=this.getMap().getPixelFromCoordinate(s);e.coordinate=s,e.pixel=[Math.round(i[0]),Math.round(i[1])]}handleDragEvent(e){this.ignoreNextUpEvent_=!0,super.handleDragEvent(e)}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const r=this.traceState_.active;if(this.ignoreNextUpEvent_||this.toggleTraceState_(e),this.shouldHandle_){const a=!this.finishCoordinate_;a&&this.startDrawing_(e.coordinate),!a&&this.freehand_?this.finishDrawing():!this.freehand_&&(!a||this.mode_==="Point")&&(this.atFinish_(e.pixel,r)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return this.ignoreNextUpEvent_=!1,!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,r=e.pixel,a=t[0]-r[0],s=t[1]-r[1],i=a*a+s*s;if(this.shouldHandle_=this.freehand_?i>this.squaredClickTolerance_:i<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let r=!1;if(this.sketchFeature_){let a=!1,s=[this.finishCoordinate_];const i=this.mode_;if(i==="Point")r=!0;else if(i==="Circle")r=this.sketchCoords_.length===2;else if(i==="LineString")a=!t&&this.sketchCoords_.length>this.minPoints_;else if(i==="Polygon"){const o=this.sketchCoords_;a=o[0].length>this.minPoints_,s=[o[0][0],o[0][o[0].length-2]],t?s=[o[0][0]]:s=[o[0][0],o[0][o[0].length-2]]}if(a){const o=this.getMap();for(let l=0,d=s.length;l<d;l++){const c=s[l],u=o.getPixelFromCoordinate(c),h=e[0]-u[0],g=e[1]-u[1],f=this.freehand_?1:this.snapTolerance_;if(r=Math.sqrt(h*h+g*g)<=f,r){this.finishCoordinate_=c;break}}}}return r}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new re(new ce(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new re);const t=e.getLinearRing(0);let r=this.sketchLine_.getGeometry();r?(r.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),r.changed()):(r=new Ve(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(r))}startDrawing_(e){const t=this.getMap().getView().getProjection(),r=sr(this.geometryLayout_);for(;e.length<r;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new re(new Ve(this.sketchLineCoords_)));const a=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new re,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(a),this.updateSketchFeatures_(),this.dispatchEvent(new ot(it.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),r=this.sketchFeature_.getGeometry(),a=t.getView().getProjection(),s=sr(this.geometryLayout_);let i,o;for(;e.length<s;)e.push(0);this.mode_==="Point"?o=this.sketchCoords_:this.mode_==="Polygon"?(i=this.sketchCoords_[0],o=i[i.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(i=this.sketchCoords_,o=i[i.length-1]),o[0]=e[0],o[1]=e[1],this.geometryFunction_(this.sketchCoords_,r,a),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),r.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(r):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection();let a,s;const i=this.mode_;return i==="LineString"||i==="Circle"?(this.finishCoordinate_=e.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():a=!0),s.push(e.slice()),this.geometryFunction_(s,t,r)):i==="Polygon"&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():a=!0),s.push(e.slice()),a&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,t,r)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),a?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),a=this.mode_;for(let s=0;s<e;++s){let i;if(a==="LineString"||a==="Circle"){if(i=this.sketchCoords_,i.splice(-2,1),i.length>=2){this.finishCoordinate_=i[i.length-2].slice();const o=this.finishCoordinate_.slice();i[i.length-1]=o,this.createOrUpdateSketchPoint_(o)}this.geometryFunction_(i,t,r),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(a==="Polygon"){i=this.sketchCoords_[0],i.splice(-2,1);const o=this.sketchLine_.getGeometry();if(i.length>=2){const l=i[i.length-2].slice();i[i.length-1]=l,this.createOrUpdateSketchPoint_(l)}o.setCoordinates(i),this.geometryFunction_(this.sketchCoords_,t,r)}if(i.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return null;let t=this.sketchCoords_;const r=e.getGeometry(),a=this.getMap().getView().getProjection();return this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,r,a)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,r,a),t=r.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new Tr([t])):this.type_==="MultiLineString"?e.setGeometry(new qt([t])):this.type_==="MultiPolygon"&&e.setGeometry(new Kt([t])),this.dispatchEvent(new ot(it.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new ot(it.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,r=!this.sketchFeature_;r&&this.startDrawing_(e[0]);let a;if(t==="LineString"||t==="Circle")a=this.sketchCoords_;else if(t==="Polygon")a=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;r&&a.shift(),a.pop();for(let i=0;i<e.length;i++)this.addToDrawing_(e[i]);const s=e[e.length-1];this.sketchFeature_=this.addToDrawing_(s),this.modifyDrawing_(s)}extend(e){const t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();const r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.sketchPoint_=new re(new ce(r)),this.updateSketchFeatures_(),this.dispatchEvent(new ot(it.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function ll(){const n=Xt();return function(e,t){return n[e.getGeometry().getType()]}}function dl(n){switch(n){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+n)}}const mr=0,ze=1,yr=[0,0,0,0],Le=[],Rt={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};function Mt(n,e,t){let r;switch(e){case"LineString":r=n;break;case"MultiLineString":case"Polygon":r=n[t[0]];break;case"MultiPolygon":r=n[t[1]][t[0]];break}return r}class Dt extends qe{constructor(e,t,r){super(e),this.features=t,this.mapBrowserEvent=r}}class cl extends jt{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:Mn,this.defaultDeleteCondition_=function(r){return Dn(r)&&Sr(r)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:$e,this.vertexFeature_=null,this.vertexSegments_=null,this.lastCoordinate_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new On,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Fe({source:new je({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:hl(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.traceSource_=e.traceSource||e.source||null,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSegments_=null,this.hitDetection_=null;let t;if(e.features?t=e.features:e.source&&(this.source_=e.source,t=new Te(this.source_.getFeatures()),this.source_.addEventListener(ir.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(ir.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(we.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(we.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}setTrace(e){let t;e?e===!0?t=$e:t=e:t=gt,this.traceCondition_=t}addFeature_(e){const t=e.getGeometry();if(t){const a=this.SEGMENT_WRITERS_[t.getType()];a&&a(e,t)}const r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastCoordinate_),e.addEventListener(Vt.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Te;const r=this.featuresBeingModified_.getArray();for(let a=0,s=t.length;a<s;++a){const i=t[a].feature;i&&!r.includes(i)&&this.featuresBeingModified_.push(i)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new Dt(Rt.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(Vt.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,r=[];t.forEach(function(a){e===a.feature&&r.push(a)});for(let a=r.length-1;a>=0;--a){const s=r[a];for(let i=this.dragSegments_.length-1;i>=0;--i)this.dragSegments_[i][0]===s&&this.dragSegments_.splice(i,1);t.remove(s)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const r=t.getCoordinates(),a={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),a)}writeMultiPointGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a],o={feature:e,geometry:t,depth:[a],index:a,segment:[i,i]};this.rBush_.insert(t.getExtent(),o)}}writeLineStringGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length-1;a<s;++a){const i=r.slice(a,a+2),o={feature:e,geometry:t,index:a,segment:i};this.rBush_.insert(K(i),o)}}writeMultiLineStringGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a];for(let o=0,l=i.length-1;o<l;++o){const d=i.slice(o,o+2),c={feature:e,geometry:t,depth:[a],index:o,segment:d};this.rBush_.insert(K(d),c)}}}writePolygonGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a];for(let o=0,l=i.length-1;o<l;++o){const d=i.slice(o,o+2),c={feature:e,geometry:t,depth:[a],index:o,segment:d};this.rBush_.insert(K(d),c)}}}writeMultiPolygonGeometry_(e,t){const r=t.getCoordinates();for(let a=0,s=r.length;a<s;++a){const i=r[a];for(let o=0,l=i.length;o<l;++o){const d=i[o];for(let c=0,u=d.length-1;c<u;++c){const h=d.slice(c,c+2),g={feature:e,geometry:t,depth:[o,a],index:c,segment:h};this.rBush_.insert(K(h),g)}}}}writeCircleGeometry_(e,t){const r=t.getCenter(),a={feature:e,geometry:t,index:mr,segment:[r,r]},s={feature:e,geometry:t,index:ze,segment:[r,r]},i=[a,s];a.featureSegments=i,s.featureSegments=i,this.rBush_.insert(It(r),a);let o=t;this.rBush_.insert(o.getExtent(),s)}writeGeometryCollectionGeometry_(e,t){const r=t.getGeometriesArray();for(let a=0;a<r.length;++a){const s=r[a],i=this.SEGMENT_WRITERS_[s.getType()];i(e,s)}}createOrUpdateVertexFeature_(e,t,r,a){let s=this.vertexFeature_;return s?s.getGeometry().setCoordinates(e):(s=new re(new ce(e)),this.vertexFeature_=s,this.overlay_.getSource().addFeature(s)),s.set("features",t),s.set("geometries",r),s.set("existing",a),s}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let t;return!e.map.getView().getInteracting()&&e.type==ee.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=ee.SINGLECLICK||!this.ignoreNextSingleClick_?t=this.removePoint():t=!0),e.type==ee.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}findInsertVerticesAndUpdateDragSegments_(e){if(this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null,!this.vertexFeature_)return;this.getMap().getView().getProjection();const t=[],r=this.vertexFeature_.getGeometry().getCoordinates(),a=K([r]),s=this.rBush_.getInExtent(a),i={};s.sort(ul);for(let o=0,l=s.length;o<l;++o){const d=s[o],c=d.segment;let u=te(d.geometry);const h=d.depth;if(h&&(u+="-"+h.join("-")),i[u]||(i[u]=new Array(2)),d.geometry.getType()==="Circle"&&d.index===ze){const g=vr(e,d);oe(g,r)&&!i[u][0]&&(this.dragSegments_.push([d,0]),i[u][0]=d);continue}if(oe(c[0],r)&&!i[u][0]){this.dragSegments_.push([d,0]),i[u][0]=d;continue}if(oe(c[1],r)&&!i[u][1]){if(i[u][0]&&i[u][0].index===0){let g=d.geometry.getCoordinates();switch(d.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":g=g[h[1]];case"Polygon":if(d.index!==g[h[0]].length-2)continue;break}}this.dragSegments_.push([d,1]),i[u][1]=d;continue}te(c)in this.vertexSegments_&&!i[u][0]&&!i[u][1]&&t.push(d)}return t}deactivateTrace_(){this.traceState_={active:!1}}updateTrace_(e){const t=this.traceState_;if(!t.active)return;if(t.targetIndex===-1){const s=e.map.getPixelFromCoordinate(t.startCoord);if(Ce(s,e.pixel)<this.pixelTolerance_)return}const r=Yr(e.coordinate,t,e.map,this.pixelTolerance_);if(t.targetIndex===-1&&Math.sqrt(r.closestTargetDistance)/e.map.getView().getResolution()>this.pixelTolerance_)return;if(t.targetIndex!==r.index){if(t.targetIndex!==-1){const i=t.targets[t.targetIndex];this.removeTracedCoordinates_(i.startIndex,i.endIndex)}else for(const i of this.traceSegments_){const o=i[0],l=o.geometry,d=i[1],c=l.getCoordinates();Mt(c,l.getType(),o.depth).splice(o.index+d,1),l.setCoordinates(c),d===0&&(o.index-=1)}const s=t.targets[r.index];this.addTracedCoordinates_(s,s.startIndex,r.endIndex)}else{const s=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(s,r.endIndex)}t.targetIndex=r.index;const a=t.targets[t.targetIndex];a.endIndex=r.endIndex}getTraceCandidates_(e){const t=this.getMap(),r=this.pixelTolerance_,a=t.getCoordinateFromPixel([e.pixel[0]-r,e.pixel[1]+r]),s=t.getCoordinateFromPixel([e.pixel[0]+r,e.pixel[1]-r]),i=K([a,s]);return this.traceSource_.getFeaturesInExtent(i)}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_(),this.traceSegments_=null;return}const t=this.getTraceCandidates_(e);if(t.length===0)return;const r=Qr(e.coordinate,t);r.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:r,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const r=e.startIndex<=e.endIndex,a=e.startIndex<=t;r===a?r&&t>e.endIndex||!r&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(r&&t<e.endIndex||!r&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let r=0;if(e<t){const a=Math.ceil(e);let s=Math.floor(t);s===t&&(s-=1),r=s-a+1}else{const a=Math.floor(e);let s=Math.ceil(t);s===t&&(s+=1),r=a-s+1}if(r>0)for(const a of this.traceSegments_){const s=a[0],i=s.geometry,o=a[1];let l=a[0].index+1;o===1&&(l-=r);const d=i.getCoordinates();Mt(d,i.getType(),s.depth).splice(l,r),i.setCoordinates(d),o===1&&(s.index-=r)}}addTracedCoordinates_(e,t,r){if(t===r)return;const a=[];if(t<r){const s=Math.ceil(t);let i=Math.floor(r);i===r&&(i-=1);for(let o=s;o<=i;++o)a.push(me(e.coordinates,o))}else{const s=Math.floor(t);let i=Math.ceil(r);i===r&&(i+=1);for(let o=s;o>=i;--o)a.push(me(e.coordinates,o))}if(a.length)for(const s of this.traceSegments_){const i=s[0],o=i.geometry,l=s[1],d=i.index+1;l===0&&a.reverse();const c=o.getCoordinates();Mt(c,o.getType(),i.depth).splice(d,0,...a),o.setCoordinates(c),l===1&&(i.index+=a.length)}}updateGeometry_(e,t){const r=t[0],a=r.depth;let s;const i=r.segment,o=r.geometry,l=t[1];for(;e.length<o.getStride();)e.push(i[l][e.length]);switch(o.getType()){case"Point":s=e,i[0]=e,i[1]=e;break;case"MultiPoint":s=o.getCoordinates(),s[r.index]=e,i[0]=e,i[1]=e;break;case"LineString":s=o.getCoordinates(),s[r.index+l]=e,i[l]=e;break;case"MultiLineString":s=o.getCoordinates(),s[a[0]][r.index+l]=e,i[l]=e;break;case"Polygon":s=o.getCoordinates(),s[a[0]][r.index+l]=e,i[l]=e;break;case"MultiPolygon":s=o.getCoordinates(),s[a[1]][a[0]][r.index+l]=e,i[l]=e;break;case"Circle":const d=o;if(i[0]=e,i[1]=e,r.index===mr)this.changingFeature_=!0,d.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0,this.getMap().getView().getProjection();let c=Ce(H(d.getCenter()),H(e));d.setRadius(c),this.changingFeature_=!1}break}s&&this.setGeometryCoordinates_(o,s)}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([i])=>i));const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],r=[],a=[],s=this.traceState_.active&&!this.traceSegments_?this.traceState_.startCoord:null;if(s){this.traceSegments_=[];for(const i of this.dragSegments_){const o=i[0];Ce($r(s,o.segment),s)/e.map.getView().getResolution()<1&&this.traceSegments_.push(i)}}for(let i=0,o=this.dragSegments_.length;i<o;++i){const l=this.dragSegments_[i],d=l[0],c=d.feature;r.includes(c)||r.push(c);const u=d.geometry;a.includes(u)||a.push(u),this.updateGeometry_(t,l)}this.updateTrace_(e),this.createOrUpdateVertexFeature_(t,r,a,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate,r=this.findInsertVerticesAndUpdateDragSegments_(t);if(r?.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,r),this.vertexFeature_)){const a=this.vertexFeature_.getGeometry().getCoordinates();for(let s=r.length-1;s>=0;--s)this.insertVertex_(r[s],a);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const r=this.dragSegments_[t][0],a=r.geometry;if(a.getType()==="Circle"){const s=a,i=s.getCenter(),o=r.featureSegments[0],l=r.featureSegments[1];o.segment[0]=i,o.segment[1]=i,l.segment[0]=i,l.segment[1]=i,this.rBush_.update(It(i),o);let d=s;this.rBush_.update(d.getExtent(),l)}else this.rBush_.update(K(r.segment),r)}return this.featuresBeingModified_&&(this.toggleTraceState_(e),this.dispatchEvent(new Dt(Rt.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastCoordinate_=e.coordinate,this.handlePointerAtPixel_(this.lastCoordinate_)}handlePointerAtPixel_(e){const t=this.getMap(),r=t.getPixelFromCoordinate(e);t.getView().getProjection();const a=function(o,l){return _r(e,o)-_r(e,l)};let s,i;if(this.hitDetection_){const o=typeof this.hitDetection_=="object"?l=>l===this.hitDetection_:void 0;t.forEachFeatureAtPixel(r,(l,d,c)=>{c&&c.getType()==="Point"&&(c=new ce(ft(c.getCoordinates())));const u=c||l.getGeometry();if(u&&u.getType()==="Point"&&l instanceof re&&this.features_.getArray().includes(l)){i=u;const h=l.getGeometry().getFlatCoordinates().slice(0,2);s=[{feature:l,geometry:i,segment:[h,h]}]}return!0},{layerFilter:o})}if(!s){const o=Gn(It(e,yr)),l=t.getView().getResolution()*this.pixelTolerance_,d=Nn(Bn(o,l,yr));s=this.rBush_.getInExtent(d)}if(s&&s.length>0){const o=s.sort(a)[0],l=o.segment;let d=vr(e,o);const c=t.getPixelFromCoordinate(d);let u=Ce(r,c);if(i||u<=this.pixelTolerance_){const h={};if(h[te(l)]=!0,this.snapToPointer_||(this.delta_[0]=d[0]-e[0],this.delta_[1]=d[1]-e[1]),o.geometry.getType()==="Circle"&&o.index===ze)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(d,[o.feature],[o.geometry],this.snappedToVertex_);else{const g=t.getPixelFromCoordinate(l[0]),f=t.getPixelFromCoordinate(l[1]),k=pt(c,g),_=pt(c,f);if(u=Math.sqrt(Math.min(k,_)),this.snappedToVertex_=u<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(d=k>_?l[1]:l[0]),this.createOrUpdateVertexFeature_(d,[o.feature],[o.geometry],this.snappedToVertex_);const p={};p[te(o.geometry)]=!0;for(let m=1,w=s.length;m<w;++m){const S=s[m].segment;if(oe(l[0],S[0])&&oe(l[1],S[1])||oe(l[0],S[1])&&oe(l[1],S[0])){const C=te(s[m].geometry);C in p||(p[C]=!0,h[te(S)]=!0)}else break}}this.vertexSegments_=h;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const r=e.segment,a=e.feature,s=e.geometry,i=e.depth,o=e.index;let l;for(;t.length<s.getStride();)t.push(0);switch(s.getType()){case"MultiLineString":l=s.getCoordinates(),l[i[0]].splice(o+1,0,t);break;case"Polygon":l=s.getCoordinates(),l[i[0]].splice(o+1,0,t);break;case"MultiPolygon":l=s.getCoordinates(),l[i[1]][i[0]].splice(o+1,0,t);break;case"LineString":l=s.getCoordinates(),l.splice(o+1,0,t);break;default:return!1}this.setGeometryCoordinates_(s,l);const d=this.rBush_;d.remove(e),this.updateSegmentIndices_(s,o,i,1);const c={segment:[r[0],t],feature:a,geometry:s,depth:i,index:o};d.insert(K(c.segment),c),this.dragSegments_.push([c,1]);const u={segment:[t,r[1]],feature:a,geometry:s,depth:i,index:o+1};return d.insert(K(u.segment),u),this.dragSegments_.push([u,0]),!0}updatePointer_(e){return e&&this.findInsertVerticesAndUpdateDragSegments_(e),this.vertexFeature_?.getGeometry().getCoordinates()}getPoint(){const e=this.vertexFeature_?.getGeometry().getCoordinates();return e?ft(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(t=>t.getType()==="Circle"||t.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(K([e])).some(({segment:t})=>oe(t[0],e)||oe(t[1],e))}removePoint(e){if(e&&(e=H(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=ee.POINTERDRAG){const t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_.map(([a])=>a));const r=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Dt(Rt.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,r}return!1}removeVertex_(){const e=this.dragSegments_,t={};let r=!1,a,s,i,o,l,d,c,u,h,g,f;for(l=e.length-1;l>=0;--l)i=e[l],g=i[0],f=te(g.feature),g.depth&&(f+="-"+g.depth.join("-")),f in t||(t[f]={}),i[1]===0?(t[f].right=g,t[f].index=g.index):i[1]==1&&(t[f].left=g,t[f].index=g.index+1);for(f in t){switch(h=t[f].right,c=t[f].left,d=t[f].index,u=d-1,c!==void 0?g=c:g=h,u<0&&(u=0),o=g.geometry,s=o.getCoordinates(),a=s,r=!1,o.getType()){case"MultiLineString":s[g.depth[0]].length>2&&(s[g.depth[0]].splice(d,1),r=!0);break;case"LineString":s.length>2&&(s.splice(d,1),r=!0);break;case"MultiPolygon":a=a[g.depth[1]];case"Polygon":a=a[g.depth[0]],a.length>4&&(d==a.length-1&&(d=0),a.splice(d,1),r=!0,d===0&&(a.pop(),a.push(a[0]),u=a.length-1));break}if(r){this.setGeometryCoordinates_(o,s);const k=[];if(c!==void 0&&(this.rBush_.remove(c),k.push(c.segment[0])),h!==void 0&&(this.rBush_.remove(h),k.push(h.segment[1])),c!==void 0&&h!==void 0){const _={depth:g.depth,feature:g.feature,geometry:g.geometry,index:u,segment:k};this.rBush_.insert(K(_.segment),_)}this.updateSegmentIndices_(o,d,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return r}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(t=>t.getType()==="Circle"||t.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(K([e])).some(({segment:t})=>!(oe(t[0],e)||oe(t[1],e)))}insertPoint(e){const t=e?H(e,this.getMap().getView().getProjection()):this.vertexFeature_?.getGeometry().getCoordinates();return t?this.findInsertVerticesAndUpdateDragSegments_(t).reduce((r,a)=>r||this.insertVertex_(a,t),!1):!1}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,r,a){this.rBush_.forEachInExtent(e.getExtent(),function(s){s.geometry===e&&(r===void 0||s.depth===void 0||Vn(s.depth,r))&&s.index>t&&(s.index+=a)})}}function ul(n,e){return n.index-e.index}function _r(n,e,t){const r=e.geometry;if(r.getType()==="Circle"){let s=r;if(e.index===ze){const i=pt(s.getCenter(),H(n)),o=Math.sqrt(i)-s.getRadius();return o*o}}const a=H(n);return Le[0]=H(e.segment[0]),Le[1]=H(e.segment[1]),Qn(a,Le)}function vr(n,e,t){const r=e.geometry;if(r.getType()==="Circle"&&e.index===ze)return ft(r.getClosestPoint(H(n)));const a=H(n);return Le[0]=H(e.segment[0]),Le[1]=H(e.segment[1]),ft($r(a,Le))}function hl(){const n=Xt();return function(e,t){return n.Point}}const lt={SELECT:"select"};class dt extends qe{constructor(e,t,r,a){super(e),this.selected=t,this.deselected=r,this.mapBrowserEvent=a}}const ct={};class er extends In{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:Sr,this.addCondition_=e.addCondition?e.addCondition:gt,this.removeCondition_=e.removeCondition?e.removeCondition:gt,this.toggleCondition_=e.toggleCondition?e.toggleCondition:Bt,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:He,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:gl(),this.features_=e.features||new Te;let t;if(e.layers)if(typeof e.layers=="function")t=e.layers;else{const r=e.layers;t=function(a){return r.includes(a)}}else t=He;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[te(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[te(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(we.ADD,this.boundAddFeature_),this.features_.addEventListener(we.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(we.ADD,this.boundAddFeature_),this.features_.removeEventListener(we.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const r=this.findLayerOfFeature_(t);r&&this.addFeatureLayerAssociation_(t,r)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}findLayerOfFeature_(e){return this.getMap().getAllLayers().find(function(t){if(t instanceof Fe&&t.getSource()&&t.getSource().hasFeature(e))return t})}getStyle(){return this.style_}applySelectedStyle_(e){const t=te(e);t in ct||(ct[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let a=t.length-1;a>=0;--a){const s=t[a];if(s!==this&&s instanceof er&&s.getStyle()&&s.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(s.getStyle());return}}const r=te(e);e.setStyle(ct[r]),delete ct[r]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[te(e)]}selectFeatureInternal_(e,t,r){if(!(e instanceof re)||!this.filter_(e,t))return;const a=this.getFeatures();return a.getArray().includes(e)||(this.addFeatureLayerAssociation_(e,t),a.push(e),r?.push(e)),e}selectFeature(e){const t=this.findLayerOfFeature_(e);if(!this.layerFilter_(t))return!1;const r=this.selectFeatureInternal_(e,t);return r&&this.dispatchEvent(new dt(lt.SELECT,[r],[],void 0)),!!r}removeFeatureInternal_(e,t){const r=this.getFeatures();if(!(!(e instanceof re)||!r.getArray().includes(e)))return r.remove(e),this.removeFeatureLayerAssociation_(e),t?.push(e),e}deselectFeature(e){const t=this.removeFeatureInternal_(e);return t&&this.dispatchEvent(new dt(lt.SELECT,[],[t],void 0)),!!t}toggleFeature(e){this.deselectFeature(e)||this.selectFeature(e)}clearSelection(){An(this.featureLayerAssociation_);const e=this.getFeatures(),t=e.getArray().slice();e.clear(),t.length!==0&&this.dispatchEvent(new dt(lt.SELECT,[],t,void 0))}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),r=this.removeCondition_(e),a=this.toggleCondition_(e),s=!t&&!r&&!a,i=e.map,o=this.getFeatures(),l=[],d=[];if(s){let c=!1;i.forEachFeatureAtPixel(e.pixel,(u,h)=>{if(c=!0,!!this.selectFeatureInternal_(u,h,d))return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let u=o.getLength()-1;u>=0;--u){const h=o.item(u);(d.length>0&&!d.includes(h)||!c)&&this.removeFeatureInternal_(h,l)}}else i.forEachFeatureAtPixel(e.pixel,(c,u)=>{let h;if((r||a)&&(h=this.removeFeatureInternal_(c,l)),(t||a)&&!h&&(h=this.selectFeatureInternal_(c,u,d)),!!h)return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});return(d.length>0||l.length>0)&&this.dispatchEvent(new dt(lt.SELECT,d,l,e)),!0}}function gl(){const n=Xt();return or(n.Polygon,n.LineString),or(n.GeometryCollection,n.LineString),function(e){return e.getGeometry()?n[e.getGeometry().getType()]:null}}const Ot={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};class Gt extends qe{constructor(e,t,r,a,s){super(e),this.features=t,this.coordinate=r,this.startCoordinate=a,this.mapBrowserEvent=s}}class pl extends jt{constructor(e){e=e||{},super(e),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=e.features!==void 0?e.features:null;let t;if(e.layers&&!this.features_)if(typeof e.layers=="function")t=e.layers;else{const r=e.layers;t=function(a){return r.includes(a)}}else t=He;this.layerFilter_=t,this.filter_=e.filter&&!this.features_?e.filter:He,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.condition_=e.condition?e.condition:$e,this.lastFeature_=null,this.addChangeListener(Er.ACTIVE,this.handleActiveChanged_)}handleDownEvent(e){if(!e.originalEvent||!this.condition_(e))return!1;if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=e.coordinate,this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);const t=this.features_||new Te([this.lastFeature_]);return this.dispatchEvent(new Gt(Ot.TRANSLATESTART,t,e.coordinate,this.startCoordinate_,e)),!0}return!1}handleUpEvent(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);const t=this.features_||new Te([this.lastFeature_]);return this.dispatchEvent(new Gt(Ot.TRANSLATEEND,t,e.coordinate,this.startCoordinate_,e)),this.startCoordinate_=null,!0}return!1}handleDragEvent(e){if(this.lastCoordinate_){const t=e.coordinate;e.map.getView().getProjection();const r=H(t),a=H(this.lastCoordinate_),s=r[0]-a[0],i=r[1]-a[1],o=this.features_||new Te([this.lastFeature_]);o.forEach(function(l){const d=l.getGeometry();d.translate(s,i),l.setGeometry(d)}),this.lastCoordinate_=t,this.dispatchEvent(new Gt(Ot.TRANSLATING,o,t,this.startCoordinate_,e))}}handleMoveEvent(e){const t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(e,t){return t.forEachFeatureAtPixel(e,(r,a)=>{if(!(!(r instanceof re)||!this.filter_(r,a))&&!(this.features_&&!this.features_.getArray().includes(r)))return r},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(e){this.hitTolerance_=e}setMap(e){const t=this.getMap();super.setMap(e),this.updateState_(t)}handleActiveChanged_(){this.updateState_(null)}updateState_(e){let t=this.getMap();const r=this.getActive();(!t||!r)&&(t=t||e,t&&t.getViewport().classList.remove("ol-grab","ol-grabbing"))}}const fl=(n,e,t)=>{if(t){const r=new DOMParser().parseFromString(t,"image/svg+xml");return r.querySelectorAll("[fill]").forEach(a=>{a.setAttribute("fill",n)}),r.querySelectorAll("[stroke]").forEach(a=>{a.setAttribute("stroke",e)}),r.querySelectorAll("path, circle, rect, polygon, ellipse").forEach(a=>{a.hasAttribute("fill")||a.setAttribute("fill",n),a.hasAttribute("stroke")||a.setAttribute("stroke",e)}),new XMLSerializer().serializeToString(r)}return`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="-1 -1 25 25"
  >
    <path
      d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 0 1 0-5 2.5 2.5 0 0 1 0 5z"
      fill="${n}"
      stroke="${e}"
      stroke-width="1"
    />
  </svg>
`},ml=({fill:n="#005CA9",stroke:e="#FFF",svg:t})=>{let r="";typeof n=="string"?r=n:"oklch"in n?r=`oklch(${n.oklch.l} ${n.oklch.c} ${n.oklch.h})`:"rgba"in n&&(r=`${n.rgba.r} ${n.rgba.g} ${n.rgba.b} ${n.rgba.a?n.rgba.a:""}`);let a="";return typeof e=="string"?a=e:"oklch"in e?a=`oklch(${e.oklch.l} ${e.oklch.c} ${e.oklch.h})`:"rgba"in e&&(a=`${e.rgba.r} ${e.rgba.g} ${e.rgba.b} ${e.rgba.a?e.rgba.a:""}`),new ht({image:new Ln({src:`data:image/svg+xml;base64,${btoa(fl(r,a,t))}`,scale:2,anchor:[.5,1]})})},yl={Circle:Ze,LinearRing:Un,LineString:Ve,MultiLineString:qt,MultiPoint:Tr,MultiPolygon:Kt,Point:ce,Polygon:bt};function _l(n,e,t,r){const a=new yl[t](r);let s=zn(a.getExtent());return(t==="Polygon"||t==="MultiPolygon")&&!a.intersectsCoordinate(s)&&(s=(a.getType()==="Polygon"?a.getInteriorPoint():a.getInteriorPoints()).getFirstCoordinate()),n===e?s:We(s,n,e)}async function br(n,e,t){if(!t)return!0;const r=await Nr(e,t.layerId,n);return r===!0||typeof r=="symbol"&&t.onError!=="strict"?!0:(typeof r=="symbol"?(Be("error",()=>le(a=>a.boundaryError,{ns:"pins"})),console.error(`@polar/polar(plugins/pins/utils/isCoordinateInBoundaryLayer:39:3)
`,"Checking boundary layer failed.")):(Be("info",()=>le(a=>a.notInBoundary,{ns:"pins"})),console.info(`@polar/polar(plugins/pins/utils/isCoordinateInBoundaryLayer:43:3)
`,"Pin position outside of boundary layer:",n)),!1)}const vl=xe("plugins/pins",()=>{const n=Q(),e=P(null),t=P(!1),r=$(()=>B({minZoomLevel:0,movable:"none",toZoomLevel:0},n.configuration.pins||{})),a=$(()=>{if(!e.value)return null;const p=$n(e.value,n.configuration.epsg);return[p[1],p[0]]}),s=new Fe({source:new je,style:ml(r.value.style||{})}),i=new er({layers:p=>p===s,style:null,condition:Tn}),o=new pl({condition:()=>n.map.getView().getZoom()>=r.value.minZoomLevel,layers:[s]});let l=null;function d(){n.map.addLayer(s),s.setZIndex(100),n.map.on("singleclick",async({coordinate:p})=>{await f(p)}),u(),h(),g()}function c(){const{map:p}=n;p.un("singleclick",async({coordinate:m})=>{await f(m)}),_(),p.removeLayer(s),p.removeInteraction(i),p.removeInteraction(o),l&&l()}function u(){const{coordinateSources:p}=r.value;p&&p.forEach(m=>{const w=m.plugin?n.getPluginStore(m.plugin):n;w&&(l=Ae(()=>w[m.key],S=>{S&&S.type!=="reverse_geocoded"&&k(S.geometry.coordinates,!1,{type:S.geometry.type})}))})}function h(){const{initial:p}=r.value;if(p){const{coordinate:m,centerOn:w,epsg:S}=p;if(w){k(m,!1,{epsg:S||n.configuration.epsg,type:"Point"});return}k(m)}}function g(){i.on("select",({selected:m})=>{r.value.movable==="none"&&(document.body.style.cursor=m.length?"not-allowed":"")}),n.map.addInteraction(i);const{movable:p}=r.value;p==="drag"&&(o.on("translatestart",()=>t.value=!0),o.on("translateend",({features:m})=>{t.value=!1,m.forEach(async w=>{const S=w.getGeometry().getCoordinates(),C=await br(S,n.map,r.value.boundary)?S:e.value;C&&k(C)})}),n.map.addInteraction(o))}async function f(p){const m=n.map.getInteractions().getArray().some(C=>C instanceof ol&&(C._isMultiSelect||C._isDrawPlugin)||C instanceof cl||C._isDeleteSelect),{minZoomLevel:w,movable:S}=r.value;(S==="drag"||S==="click")&&n.map.getView().getZoom()>=w&&!m&&await br(p,n.map,r.value.boundary)&&k(p)}function k(p,m=!0,w){_(),e.value=p,!m&&w&&(e.value=_l(w.epsg||n.configuration.epsg,n.configuration.epsg,w.type,p),n.map.getView().setCenter(e.value),n.map.getView().setZoom(r.value.toZoomLevel)),s.getSource().addFeature(new re({geometry:new ce(e.value),type:"point",name:"mapMarker",zIndex:100}))}function _(){s.getSource().clear()}return{coordinate:e,latLon:a,setupPlugin:d,teardownPlugin:c}}),bl={boundaryError:"Die Überprüfung der Koordinate ist fehlgeschlagen. Bitte versuchen Sie es später erneut oder wenden Sie sich an einen Administrator, wenn das Problem bestehen bleibt.",notInBoundary:"Diese Koordinate kann nicht gewählt werden."},xl={boundaryError:"Validating the coordinate failed. Please try again later or contact an administrator if the issue persists.",notInBoundary:"It is not possible to select this coordinate."},kl=[{type:"de",resources:bl},{type:"en",resources:xl}],wl="pins";function Cl(n){return{id:wl,locales:kl,storeModule:vl,options:n}}const tr="reverseGeocoder",tn=xe("plugins/reverseGeocoder",()=>{const n=Q(),e=$(()=>n.configuration[tr]),t=P([]);function r(){for(const o of e.value.coordinateSources||[]){const l=o.plugin?n.getPluginStore(o.plugin):n;l&&t.value.push(Ae(()=>l[o.key],async d=>{d&&await i(d)},{immediate:!0}))}}function a(){t.value.forEach(o=>{o()})}function s(o,l){const d=o.plugin?n.getPluginStore(o.plugin):n;d&&d[o.key](l)}async function i(o){const l=pa();try{const d=await fa(e.value.url,o);return e.value.addressTarget&&s(e.value.addressTarget,d),e.value.zoomTo&&n.map.getView().fit(new ce(o),{maxZoom:e.value.zoomTo,duration:400,easing:ea}),d}catch(d){return console.error(`@polar/polar(plugins/reverseGeocoder/store:102:5)
`,"Reverse geocoding failed:",d),null}finally{l()}}return{reverseGeocode:i,setupPlugin:r,teardownPlugin:a}});if(import.meta.vitest){const{expect:n,test:e,vi:t}=import.meta.vitest,{createPinia:r,setActivePinia:a}=await Me(async()=>{const{createPinia:c,setActivePinia:u}=await import("./pinia-x73l2-vU-D6MOxTBQ.js");return{createPinia:c,setActivePinia:u}},__vite__mapDeps([0,1]),import.meta.url),{reactive:s}=await Me(async()=>{const{reactive:c}=await import("./vue.runtime.esm-bundler-BAmx9FTa-DJQ8eZeL.js");return{reactive:c}},[],import.meta.url),i=await Me(()=>import("./store-CN0wr1Kw.js").then(c=>c.s),__vite__mapDeps([2,0,1,3]),import.meta.url),o=await Me(()=>import("./reverseGeocode-CR3Bbmu1-t1-wbI-u.js"),__vite__mapDeps([4,2,0,1,3]),import.meta.url),l=await Me(()=>import("./indicateLoading-DzQEZ1AR-CrqcV_vt.js"),__vite__mapDeps([5,3,0,1]),import.meta.url),d=e.extend({reverseGeocodeUtil:[async({},c)=>{const u=t.spyOn(o,"reverseGeocode").mockResolvedValue(null);await c(u)},{auto:!0}],indicateLoading:[async({},c)=>{const u=t.spyOn(l,"indicateLoading").mockImplementation(()=>()=>{});await c(u)},{auto:!0}],coreStore:[async({},c)=>{const u=t.fn(),h=s({configuration:{[tr]:{url:"https://wps.example",coordinateSources:[{key:"coordinateSource"}],addressTarget:{key:"addressTarget"},zoomTo:99}},map:{getView:()=>({fit:u})},coordinateSource:null,addressTarget:t.fn()});t.spyOn(i,"useCoreStore").mockReturnValue(h),await c(h)},{auto:!0}],store:[async({},c)=>{a(r());const u=tn();u.setupPlugin(),await c(u),u.teardownPlugin()},{auto:!0}]});d("detects changes in coordinate sources",async({reverseGeocodeUtil:c,coreStore:u})=>{u.coordinateSource=[1,2],await new Promise(h=>setTimeout(h)),n(c).toHaveBeenCalledWith("https://wps.example",[1,2])}),d("passes geocoding result to address target",async({reverseGeocodeUtil:c,coreStore:u,store:h})=>{const g=Symbol("feature");c.mockResolvedValueOnce(g),await h.reverseGeocode([3,4]),n(u.addressTarget).toHaveBeenCalledOnce(),n(u.addressTarget).toHaveBeenCalledWith(g)}),d("zooms to input coordinate",async({reverseGeocodeUtil:c,coreStore:u,store:h})=>{const g=Symbol("feature");c.mockResolvedValueOnce(g),await h.reverseGeocode([3,4]),n(u.map.getView().fit).toHaveBeenCalledOnce()})}function Sl(n){return{id:tr,storeModule:tn,options:n}}const El={style:{background:"#fff"}},Tl=Ke({__name:"EmptyComponent",setup(n){return(e,t)=>(Je(),Xe("div",El,"HELLO THERE"))}}),$l={class:"kern-btn kern-btn--tertiary",style:{"border-radius":"0.25rem","min-height":"2rem",width:"2rem"}},Ll=Ke({__name:"MockAttributions.ce",setup(n){return(e,t)=>(Je(),Xe("button",$l,[...t[0]||(t[0]=[be("span",{class:"kern-icon kern-icon-fill--copyright",style:{color:"var(--kern-color-action-default)"}},null,-1)])]))}}),Il={style:{display:"flex",gap:"0.5rem"}},Al=Ke({__name:"MockPointerPosition.ce",setup(n){return(e,t)=>(Je(),Xe("div",Il,[...t[0]||(t[0]=[be("span",{class:"kern-icon kern-icon--fullscreen","aria-hidden":"true"},null,-1),be("span",{style:{display:"flex","align-items":"center"}},"9.9555 | 53.5479",-1),be("button",{class:"kern-btn kern-btn--tertiary",style:{"min-height":"1rem","font-size":"1.125rem","text-decoration-line":"underline","text-underline-offset":"2px","text-underline-position":"from-font",color:"#1a3da5"}}," EPSG:4326 ",-1)])]))}}),Fl={style:{display:"flex","align-items":"center",gap:"0.5rem"}},Pl=Ke({__name:"MockScale.ce",setup(n){return(e,t)=>(Je(),Xe("div",Fl,[...t[0]||(t[0]=[be("span",{style:{color:"#404565"}},"1 : 4.000.000",-1),be("span",{style:{color:"#171a2b","font-weight":"500"}},"4 km",-1),be("span",{style:{width:"1.5rem",height:"0.75rem","border-radius":"0 0 0.125rem 0.125rem","border-right":"1px solid#171a2b","border-bottom":"1px solid #171a2b","border-left":"1px solid #171a2b"}},null,-1)])]))}}),Rl=[{id:"23420",name:"basemap.de Web Raster Farbe",url:"https://sgx.geodatenzentrum.de/wms_basemapde",typ:"WMS",layers:"de_basemapde_web_raster_farbe",format:"image/png",version:"1.3.0",singleTile:!1,transparent:!0,transparency:0,urlIsVisible:!0,tilesize:512,gutter:0,minScale:"0",maxScale:"2500000",legendURL:"",cache:!1,featureCount:5},{id:"23421",name:"basemap.de Web Raster Grau",url:"https://sgx.geodatenzentrum.de/wms_basemapde",typ:"WMS",layers:"de_basemapde_web_raster_grau",format:"image/png",version:"1.3.0",singleTile:!1,transparent:!0,transparency:0,urlIsVisible:!0,tilesize:512,gutter:0,minScale:"0",maxScale:"2500000",legendURL:"",cache:!1,featureCount:5},{id:"1454",name:"Ausgleichsflächen",url:"https://geodienste.hamburg.de/HH_WFS_Ausgleichsflaechen",typ:"WFS",featureType:"ausgleichsflaechen",outputFormat:"XML",version:"1.1.0",featureNS:"https://registry.gdi-de.org/id/de.hh.up",featurePrefix:"de.hh.up",legendURL:""},{id:"6059",name:"MML Anliegen",url:"https://geodienste.hamburg.de/lgv-config/anliegen_extern.json",typ:"GeoJSON",format:"XML",version:"1.0",minScale:"0",maxScale:"2500000",legendURL:"",urlIsVisible:!0},{id:"denkmaelerWMS",name:"Denkmal WMS",url:"https://efi2-deegree.schleswig-holstein.de/dish-deegree/services/wms_shp",typ:"WMS",layers:"0,1,2,3,4,6,24,25",legendURL:"ignore",format:"image/png",version:"1.3.0",transparent:!0}],Ml="data:application/json;base64,WwoJewoJCSJzdHlsZUlkIjogInBhbmRhIiwKCQkicnVsZXMiOiBbCgkJCXsKCQkJCSJzdHlsZSI6IHsKCQkJCQkicG9seWdvblN0cm9rZUNvbG9yIjogWzMsIDI1NSwgMSwgMV0sCgkJCQkJInBvbHlnb25GaWxsSGF0Y2giOiB7CgkJCQkJCSJiYWNrZ3JvdW5kQ29sb3IiOiBbMCwgMCwgMCwgMC4yNV0sCgkJCQkJCSJwYXR0ZXJuIjogImRpYWdvbmFsLXJpZ2h0IiwKCQkJCQkJInBhdHRlcm5Db2xvciI6IFszLCAyNTUsIDEsIDFdCgkJCQkJfQoJCQkJfQoJCQl9CgkJXQoJfQpdCg==",Dl={style:{background:"#fff"}},Ol=Ke({__name:"YetAnotherEmptyComponent",setup(n){return(e,t)=>(Je(),Xe("div",Dl,"Awesome"))}}),rn="23420",Gl="23421",Nl="1454",xr="6059",Bl="denkmaelerWMS",nn="1693";let Ne="light";const se=await ta("snowbox",{colorScheme:Ne,startCenter:[573364,6028874],layers:[{id:rn,visibility:!0,type:"background",name:"Basemap.de (Farbe)"},{id:Gl,type:"background",name:"Basemap.de (Grau)",maxZoom:6},{id:nn,visibility:!0,hideInMenu:!0,type:"mask",name:"meldemichel.layers.hamburgBorder"},{id:xr,type:"mask",name:"Anliegen (MML)",visibility:!1},{id:Nl,type:"mask",name:"Ausgleichsflächen",styleId:"panda",visibility:!0,minZoom:5},{id:Bl,type:"mask",name:"Kulturdenkmale",visibility:!0,options:{layers:{order:"6,24,25,4,3,2,1,0",title:{6:"Denkmalbereich",24:"Mehrheit von baulichen Anlagen",25:"Sachgesamtheit",4:"Baudenkmal",3:"Gründenkmal",2:"Gewässer",1:"Baudenkmal (Fläche)",0:"Gründenkmal (Fläche)"},legend:!0}}}],layout:"standard",checkServiceAvailability:!0,featureStyles:Ml,markers:{layers:[{id:xr,defaultStyle:{stroke:"#FFFFFF",fill:"#005CA9"},hoverStyle:{stroke:"#46688E",fill:"#8BA1B8"},selectionStyle:{stroke:"#FFFFFF",fill:"#E10019"},unselectableStyle:{stroke:"#FFFFFF",fill:"#333333"}}],clusterClickZoom:!0},locales:[{type:"de",resources:{fullscreen:{button:{label_on:"Mach groß",label_off:"Mach klein"}},iconMenu:{hints:{attributions:"LMAO",fullscreen:"BEEEEEG YOSHEEEEE"}}}}]},Rl);document.getElementById("secondMap").addEventListener("click",async()=>{const n=await ra({layers:[{id:rn,visibility:!0,type:"background",name:"snowbox.layers.basemap"}]},"https://geodienste.hamburg.de/services-internet.json");n.classList.add("snowbox"),document.getElementById("secondMapContainer").appendChild(n),ye(n,Fr({layoutTag:"TOP_RIGHT"}))});document.getElementById("secondMapClean").addEventListener("click",()=>{document.getElementById("secondMapContainer").innerText=""});ye(se,aa({displayComponent:!0,layoutTag:"BOTTOM_MIDDLE"}));ye(se,il({loaderStyle:"BasicLoader"}));ye(se,ks({searchMethods:[{queryParameters:{searchStreets:!0,searchHouseNumbers:!0},type:"mpapi",url:"https://geodienste.hamburg.de/HH_WFS_GAGES?service=WFS&request=GetFeature&version=2.0.0"}],minLength:3,waitMs:300,focusAfterSearch:!0,groupProperties:{defaultGroup:{limitResults:5}}}));ye(se,Cl({coordinateSources:[{plugin:"addressSearch",key:"chosenAddress"}],boundary:{layerId:nn},movable:"drag",style:{fill:"#FF0019"},toZoomLevel:7}));ye(se,Sl({url:"https://geodienste.hamburg.de/HH_WPS",coordinateSources:[{plugin:"pins",key:"coordinate"}],addressTarget:{plugin:"addressSearch",key:"selectResult"},zoomTo:7}));ye(se,sa({displayComponent:!0,layoutTag:"TOP_RIGHT",initiallyOpen:"layerChooser",focusMenus:[{plugin:{component:Ol,id:"attributions",locales:[]},icon:"kern-icon--near-me"}],menus:[[{plugin:Qs({checkLocationInitially:!1,keepCentered:!1,showTooltip:!0,zoomLevel:7})}],[{plugin:{component:Tl,id:"realKewl",locales:[]},icon:"kern-icon-fill--share"}],[{plugin:To({})},{plugin:Fr({})}]]}));ye(se,As({leftEntries:[{id:"mockPointer",component:Al}],rightEntries:[{id:"mockScale",component:Pl},{id:"mockAttributions",component:Ll}]}));const an=Ir(se,"toast");an.addToast({text:"Hallo Welt",severity:"info"});an.addToast({text:"Achtung! Dies ist ein Toast!",severity:"error"});const sn=Ir(se,"loadingIndicator");sn.addLoadingKey("loadingTest");setTimeout(()=>sn.removeLoadingKey("loadingTest"),2e3);na(se,"core","selectedCoordinates",n=>document.getElementById("selected-feature-coordinates").innerText=JSON.stringify(n));document.getElementById("language-switcher").addEventListener("change",n=>{const e=n.target,{value:t}=e;Ar(se,"core","language",t),e[0].innerHTML=t==="en"?"English":"Englisch",e[1].innerHTML=t==="en"?"German":"Deutsch"});document.getElementById("color-scheme-switcher").addEventListener("click",({target:n})=>{n.innerHTML=`Switch to ${Ne} mode`,Ne=Ne==="light"?"dark":"light",Ar(se,"core","colorScheme",Ne)});
