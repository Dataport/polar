const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./invisibleStyle-Chpv9ziO-Bjwfqc_m.js","./asserts-BSy1ujn8-CTfb8-hw.js","./doesFeaturePassFilter-DOaMN8Xr-CuqwBqk2.js","./Feature-DNujdKX6-DPKx2Wrc.js","./pinia-CbxOPHy1-Ds7GYo7H.js","./vue.runtime.esm-bundler-x5GycwNE-C2i-EXPZ.js","./index-Jm_6oqP4-CS9u4XLK.js","./reverseGeocode-DMu2C9hG-OuZRICI0.js","./xml2js-DjsFtvPy-CazYFt_-.js","./indicateLoading-D-j3Jp1s-b41NEvCz.js"])))=>i.map(i=>d[i]);
import{a1 as D,a2 as ce,a3 as pe,a4 as Rn,a5 as Se,a6 as Vn,a7 as tt,a8 as Fe,a9 as Zt,aa as On,ab as ae,ac as Bn,ad as Gn,ae as Nn,af as Un,ag as R,ah as m,ai as ut,aj as E,ak as Xt,al as B,am as ye,an as $t,ao as Y,ap as te,aq as O,ar as kt,as as Hn,at as lt,au as Wn,av as jn,aw as zn,ax as Yn,ay as qn,az as Qt,aA as nt,aB as xt,aC as ke,aD as _e,aE as Et,aF as xe,aG as en,aH as N,aI as it,aJ as Kn,aK as q,aL as Jn,aM as z,aN as ve,aO as Ae,aP as Vt,aQ as tn,aR as It,aS as Pt,aT as Zn,aU as Xn,aV as Qn,aW as Ot,aX as ht,aY as Q,aZ as nn,a_ as at,a$ as ei,b0 as ti,b1 as ni,b2 as Ft,b3 as ii,b4 as ai,b5 as ri,b6 as si,b7 as oi,b8 as li,b9 as di,ba as ci,bb as ui,bc as hi,bd as gi,G as Re,K as Ve,L as Oe,N as ue,be as pi,bf as fi,bg as fe,S as an,J as mi,bh as rn,U as sn,T as yi,$ as _i}from"./runtime-core.esm-bundler-Crctbksn.js";import{defineComponent as M,createElementBlock as x,openBlock as f,createElementVNode as S,renderSlot as At,ref as P,computed as $,watch as we,createBlock as A,withCtx as re,createCommentVNode as U,unref as C,useModel as he,withDirectives as Be,vModelSelect as vi,Fragment as H,renderList as j,toDisplayString as Z,createVNode as de,mergeProps as Ct,normalizeClass as Te,mergeModels as Ge,useId as on,vModelCheckbox as bi,vModelRadio as ki,createTextVNode as xi,vModelText as Ci,markRaw as Bt,resolveDynamicComponent as wt,isRef as Gt,vModelDynamic as wi,onMounted as Si,nextTick as Ti}from"./vue.runtime.esm-bundler-x5GycwNE-C2i-EXPZ.js";import{defineStore as me,storeToRefs as ge}from"./pinia-CbxOPHy1-Ds7GYo7H.js";import{h as X,f as ie,R as se,v as Ie}from"./index-Jm_6oqP4-CS9u4XLK.js";import{an as Li,ao as $i,z as ln,H as Ei,C as rt,I as Ii,g as Pi,U as Fi,ap as Mt,k as Ai,l as dn,d as Mi}from"./invisibleStyle-Chpv9ziO-Bjwfqc_m.js";import{doesFeaturePassFilter as Di}from"./doesFeaturePassFilter-DOaMN8Xr-CuqwBqk2.js";import{i as W}from"./Feature-DNujdKX6-DPKx2Wrc.js";import{V as Ri,E as Ne,D as De,x as K,g as Vi,B as Oi,L as St,A as Bi,K as Nt}from"./asserts-BSy1ujn8-CTfb8-hw.js";import"./xml2js-DjsFtvPy-CazYFt_-.js";import{indicateLoading as Gi}from"./indicateLoading-D-j3Jp1s-b41NEvCz.js";import{reverseGeocode as Ni}from"./reverseGeocode-DMu2C9hG-OuZRICI0.js";const Ui={class:"kern-card kern-card--small"},Hi={class:"kern-card__container"},Wi=M({__name:"PolarCard.ce",setup(i){return(e,t)=>(f(),x("article",Ui,[S("div",Hi,[At(e.$slots,"default",{},void 0)])]))}}),ji=".kern-card{&[data-v-6728745d]{height:inherit;min-width:25rem;border-radius:var(--kern-metric-border-radius-large);box-shadow:var(--polar-shadow)}.kern-card__container[data-v-6728745d]{padding:var(--kern-metric-space-small);padding-bottom:.625rem}}",dt=D(Wi,[["styles",[ji]],["__scopeId","data-v-6728745d"]]),st="filter";function zi(i){let e=i.getSource();if(!e)throw new Error("Could not find a vector source for this layer");for(;e instanceof Rn;)if(e=e.getSource(),!e)throw new Error("Could not find a vector source for this layer");if(!(e instanceof pe))throw new Error("Could not find a vector source for this layer");return e}function cn(i,e){const t=i.getFeatures().flatMap(n=>n.get("features")||[n]);i.clear(),t.forEach(n=>{(Di(n,e)?Li:$i)(n)}),i.addFeatures(t)}if(import.meta.vitest){const{test:i,expect:e,vi:t}=import.meta.vitest,{isVisible:n,isInvisible:a}=await ce(async()=>{const{isVisible:s,isInvisible:o}=await import("./invisibleStyle-Chpv9ziO-Bjwfqc_m.js").then(l=>l.aq);return{isVisible:s,isInvisible:o}},__vite__mapDeps([0,1]),import.meta.url),r=await ce(()=>import("./doesFeaturePassFilter-DOaMN8Xr-CuqwBqk2.js"),__vite__mapDeps([2,3,4,5,6,1]),import.meta.url);t.spyOn(r,"doesFeaturePassFilter").mockImplementation(s=>s.get("filter")==="yes"),i("feature visibility is updated according to filter",()=>{const s=new W;s.set("filter","yes");const o=new W;o.set("filter","no");const l=new pe;l.addFeatures([s,o]),cn(l,{}),e(l.getFeatures()).toHaveLength(2),e(l.getFeatures()).toContain(s),e(n(s)).toBeTruthy(),e(l.getFeatures()).toContain(o),e(a(o)).toBeTruthy()})}const Ue=me("plugins/filter",()=>{const i=X(),e=$(()=>i.configuration[st]??{layers:{}}),t=P({}),n=$(()=>i.map.getAllLayers().filter(o=>Object.keys(e.value.layers).includes(o.get("id")))),a=[];function r(){n.value.forEach(o=>{const l=zi(o),d=()=>{cn(l,t.value[o.get("id")]??{})};l.on("featuresloadend",d),a.push(()=>{l.un("featuresloadend",d)}),a.push(we(()=>t.value[o.get("id")],()=>{d()},{deep:!0,immediate:!0}))})}function s(){a.forEach(o=>{o()})}return{configuration:e,state:t,setupPlugin:r,teardownPlugin:s}}),Yi={class:"kern-label"},qi=M({__name:"KernBlockButton.ce",props:{icon:{type:Boolean},label:{type:String}},emits:["click"],setup(i,{emit:e}){const t=i,n=e;return(a,r)=>(f(),x("button",{class:"kern-btn kern-btn--block kern-btn--tertiary",onClick:r[0]||(r[0]=s=>n("click"))},[t.icon?(f(),x("span",{key:0,class:Te({"kern-icon":!0,[t.icon]:!0}),"aria-hidden":"true"},null,2)):U("",!0),S("span",Yi,Z(t.label),1)]))}}),Ki=".kern-btn--tertiary{&[data-v-36d236e4]{background-color:#edf1fa;justify-content:left}.kern-label[data-v-36d236e4]{text-decoration:none}}",Ji=D(qi,[["styles",[Ki]],["__scopeId","data-v-36d236e4"]]),Zi=["id"],Xi=["for"],Qi={class:"kern-label"},ea=M({__name:"KernBlockButtonCheckbox.ce",props:Ge({icon:{type:Boolean},label:{type:String}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const e=i,t=he(i,"modelValue"),n=on();return(a,r)=>(f(),x(H,null,[Be(S("input",{id:C(n),"onUpdate:modelValue":r[0]||(r[0]=s=>t.value=s),type:"checkbox"},null,8,Zi),[[bi,t.value]]),S("label",{for:C(n),class:"kern-btn kern-btn--block kern-btn--tertiary"},[e.icon?(f(),x("span",{key:0,class:Te({"kern-icon":!0,[e.icon]:!0}),"aria-hidden":"true"},null,2)):U("",!0),S("span",Qi,Z(e.label),1)],8,Xi)],64))}}),ta=".kern-btn--tertiary{&[data-v-b673f9d3]{background-color:#edf1fa;justify-content:left}.kern-label[data-v-b673f9d3]{text-decoration:none}}input[type=checkbox]{&[data-v-b673f9d3]{display:none}&:checked+label[data-v-b673f9d3]{border:var(--kern-metric-border-width-default) solid var(--kern-color-action-default)}}",na=D(ea,[["styles",[ta]],["__scopeId","data-v-b673f9d3"]]),ia={class:"kern-heading-small"},aa={class:"polar-filter-category-values"},ra=M({__name:"FilterCategory.ce",props:{layer:{type:String}},setup(i){const e=i,t=Ue(),n=$(()=>t.configuration.layers[e.layer]);function a(l){return typeof l=="string"?l:l.value}function r(l){const d=t.state[e.layer]??={};return d.knownValues??={},d.knownValues[l]??=Object.fromEntries(n.value.categories?.find(c=>c.targetProperty===l)?.knownValues.map(c=>[a(c),!0])??[])}function s(l,d,c){r(l)[d]=c}function o(l){const d=r(l.targetProperty),c=Object.values(d).filter(u=>u).length!==l.knownValues.length;l.knownValues.forEach(u=>{d[a(u)]=c})}return(l,d)=>(f(!0),x(H,null,j(n.value.categories,c=>(f(),x("section",{key:c.targetProperty,class:"polar-filter-section"},[S("h3",ia,Z(l.$t(u=>u.layer[e.layer].category[c.targetProperty].title,{ns:C(st)})),1),S("div",aa,[c.selectAll?(f(),A(Ji,{key:0,icon:"kern-icon--deselect",label:l.$t(u=>u.category.deselectAll,{ns:"filter"}),onClick:u=>o(c)},null,8,["label","onClick"])):U("",!0),(f(!0),x(H,null,j(c.knownValues,u=>(f(),A(na,{key:a(u),icon:typeof u!="string"&&u.icon,label:l.$t(h=>h.layer[e.layer].category[c.targetProperty].knownValue[a(u)],{ns:C(st)}),"model-value":C(t).state[e.layer]?.knownValues?.[c.targetProperty]?.[a(u)]??!0,"onUpdate:modelValue":h=>s(c.targetProperty,a(u),h)},null,8,["icon","label","model-value","onUpdate:modelValue"]))),128))])]))),128))}}),sa={class:"kern-form-input"},oa={class:"kern-form-input__select-wrapper"},la=M({__name:"FilterLayerChooser.ce",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(i){const e=he(i,"modelValue"),t=Ue(),n=$(()=>Object.keys(t.configuration.layers));return(a,r)=>(f(),x("div",sa,[r[1]||(r[1]=S("label",{class:"kern-label",for:"select"},"Fachdatensatz auswählen",-1)),S("div",oa,[Be(S("select",{"onUpdate:modelValue":r[0]||(r[0]=s=>e.value=s),class:"kern-form-input__select"},[(f(!0),x(H,null,j(n.value,s=>(f(),x("option",{key:s},Z(s),1))),128))],512),[[vi,e.value]])])]))}}),da=["id","name","value"],ca=["for"],ua={class:"kern-label"},ha=M({__name:"KernBlockButtonRadioGroup.ce",props:Ge({items:{type:Array}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const e=i,t=he(i,"modelValue"),n=on();return(a,r)=>(f(!0),x(H,null,j(e.items,s=>(f(),x(H,{key:s.value},[Be(S("input",{id:C(n)+"*"+s.value,"onUpdate:modelValue":r[0]||(r[0]=o=>t.value=o),type:"radio",name:C(n),value:s.value},null,8,da),[[ki,t.value]]),S("label",{for:C(n)+"*"+s.value,class:"kern-btn kern-btn--block kern-btn--tertiary"},[s.icon?(f(),x("span",{key:0,class:Te({"kern-icon":!0,[s.icon]:!0}),"aria-hidden":"true"},null,2)):U("",!0),S("span",ua,Z(s.label),1)],8,ca)],64))),128))}}),ga=".kern-btn--tertiary{&[data-v-74b52236]{background-color:#edf1fa;justify-content:left}.kern-label[data-v-74b52236]{text-decoration:none}}input[type=radio]{&[data-v-74b52236]{display:none}&:checked+label[data-v-74b52236]{border:var(--kern-metric-border-width-default) solid var(--kern-color-action-default)}}",pa=D(ha,[["styles",[ga]],["__scopeId","data-v-74b52236"]]);function gt(i){return i===null?"":[i.getFullYear(),i.getMonth()+1,i.getDate()].map(e=>e.toString().padStart(2,"0")).join("-")}function fa(i){if(i.length===0)return null;const[e,t,n]=i.split("-");return new Date(Number(e),Number(t)-1,Number(n))}const ma=["min","max"],Ut=M({__name:"KernDatePicker.ce",props:Ge({min:{type:Date},max:{type:Date}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const e=i,t=he(i,"modelValue"),n=$({get:()=>gt(t.value),set:a=>{t.value=fa(a)}});return(a,r)=>Be((f(),x("input",{"onUpdate:modelValue":r[0]||(r[0]=s=>n.value=s),type:"date",class:"kern-form-input__input",min:C(gt)(e.min??null),max:C(gt)(e.max??null)},null,8,ma)),[[Ci,n.value]])}}),ya={class:"range-picker"},_a=M({__name:"KernDateRangePicker.ce",props:Ge({min:{type:Date},max:{type:Date}},{start:{required:!0},startModifiers:{},end:{required:!0},endModifiers:{}}),emits:["update:start","update:end"],setup(i){const e=i,t=he(i,"start"),n=he(i,"end");return(a,r)=>(f(),x("div",ya,[de(Ut,Ct({modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=s=>t.value=s)},e),null,16,["modelValue"]),r[2]||(r[2]=xi(" – ",-1)),de(Ut,Ct({modelValue:n.value,"onUpdate:modelValue":r[1]||(r[1]=s=>n.value=s)},e),null,16,["modelValue"])]))}}),va=".range-picker[data-v-7414cb2a]{display:flex;align-items:center;justify-content:space-between;margin:.3em 0}",ba=D(_a,[["styles",[va]],["__scopeId","data-v-7414cb2a"]]),ka={key:0,class:"polar-filter-section"},xa={class:"kern-heading-small"},Ca={class:"polar-filter-category-values"},wa=M({__name:"FilterTime.ce",props:{layer:{type:String}},setup(i){const e=i,t=new Date(-864e13),n=new Date(864e13),a=X(),r=Ue(),s=$(()=>r.configuration.layers[e.layer]),o=$(()=>s.value.time?.targetProperty||""),l=$(()=>s.value.time?.pattern||"YYYY-MM-DD"),d=$(()=>r.state[e.layer]?.timeSpan?.[o.value]??{from:t,until:n,pattern:l.value}),c=$({get:()=>d.value.from.getTime()===t.getTime()?null:d.value.from,set:g=>{const y=r.state[e.layer]??={},_=y.timeSpan??={},L=_[o.value]??={from:t,until:n,pattern:l.value};L.from=g||t}}),u=$({get:()=>{if(d.value.until.getTime()===n.getTime())return null;const g=new Date(d.value.until);return g.setDate(g.getDate()-1),g},set:g=>{const y=r.state[e.layer]??={},_=y.timeSpan??={},L=_[o.value]??={from:t,until:n,pattern:l.value};if(g===null){L.until=n;return}const b=new Date(g);b.setDate(b.getDate()+1),L.until=b}});function h(g,y){const _=new Date;return _.setDate(_.getDate()+g),y.toDateString()===_.toDateString()}const p=P(!1),v=$({get:()=>{if(p.value)return"custom";if(c.value===null&&u.value===null)return"all";if(c.value&&u.value){for(const g of s.value.time?.last||[])if(h(0,u.value)&&h(-g,c.value))return`last-${g}`;for(const g of s.value.time?.next||[])if(h(0,c.value)&&h(g,u.value))return`next-${g}`}return"custom"},set:g=>{if(g==="all"||g==="custom")c.value=null,u.value=null;else if(g.startsWith("last-")){const y=Number(g.substring(5)),_=new Date,L=new Date(_.getFullYear(),_.getMonth(),_.getDate()-y),b=new Date(_.getFullYear(),_.getMonth(),_.getDate());c.value=L,u.value=b}else if(g.startsWith("next-")){const y=Number(g.substring(5)),_=new Date,L=new Date(_.getFullYear(),_.getMonth(),_.getDate()),b=new Date(_.getFullYear(),_.getMonth(),_.getDate()+y);b.setDate(b.getDate()+y),c.value=L,u.value=b}p.value=g==="custom"}}),w=$(()=>({from:{min:new Date},until:{max:new Date}})[s.value.time?.freeSelection||""]||{}),I=$(()=>(a.language,[{value:"all",label:ie(g=>g.time.noRestriction,{ns:"filter"}),icon:"kern-icon--all-inclusive"},...s.value.time?.last?.map(g=>({value:`last-${g}`,label:ie(y=>y.time.last,{ns:"filter",count:g}),icon:"kern-icon--history"}))||[],...s.value.time?.next?.map(g=>({value:`next-${g}`,label:ie(y=>y.time.next,{ns:"filter",count:g}),icon:"kern-icon--timeline"}))||[],...s.value.time?.freeSelection?[{value:"custom",label:ie(g=>g.time.chooseTimeFrame,{ns:"filter"}),icon:"kern-icon--calendar-month"}]:[]]));return(g,y)=>s.value.time?(f(),x("section",ka,[S("h3",xa,Z(g.$t(_=>_.time.header,{ns:"filter"})),1),S("div",Ca,[de(pa,{modelValue:v.value,"onUpdate:modelValue":y[0]||(y[0]=_=>v.value=_),items:I.value},null,8,["modelValue","items"])]),v.value==="custom"?(f(),A(ba,Ct({key:0,start:c.value,"onUpdate:start":y[1]||(y[1]=_=>c.value=_),end:u.value,"onUpdate:end":y[2]||(y[2]=_=>u.value=_)},w.value),null,16,["start","end"])):U("",!0)])):U("",!0)}}),Sa=M({__name:"FilterUI.ce",setup(i){const e=Ue(),t=P("");return we(()=>e.configuration.layers,n=>{t.value.length===0&&(t.value=Object.keys(n)[0]||"")},{immediate:!0,deep:!0}),(n,a)=>(f(),A(dt,{class:"polar-filter-card"},{default:re(()=>[Object.keys(C(e).configuration.layers).length>1?(f(),A(la,{key:0,modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=r=>t.value=r)},null,8,["modelValue"])):U("",!0),t.value?(f(),A(ra,{key:1,layer:t.value},null,8,["layer"])):U("",!0),t.value?(f(),A(wa,{key:2,layer:t.value},null,8,["layer"])):U("",!0)]),_:1}))}}),Ta=".polar-filter-card[data-v-c5e1da0e]{pointer-events:all;padding-bottom:3em}[data-v-c5e1da0e] .polar-filter-section{width:100%;h3{padding-left:.15em}.polar-filter-category-values{display:flex;flex-direction:column;gap:var(--kern-metric-space-x-small)}}",La=D(Sa,[["styles",[Ta]],["__scopeId","data-v-c5e1da0e"]]),$a={category:{deselectAll:"Alle an-/abwählen"},time:{header:"Zeitraum",noRestriction:"Keine Einschränkung",last_zero:"Heute",last_one:"Der letzte Tag",last_other:"Die letzten {{count}} Tage",next_zero:"Heute",next_one:"Der nächste Tag",next_other:"Die nächsten {{count}} Tage",chooseTimeFrame:"Zeitraum wählen"}},Ea={category:{deselectAll:"De-/select all"},time:{header:"Time frame",noRestriction:"No restriction",last_zero:"Today",last_one:"The last day",last_other:"The last {{count}} days",next_zero:"Today",next_one:"The next day",next_other:"The next {{count}} days",chooseTimeFrame:"Choose time frame"}},Ia=[{type:"de",resources:$a},{type:"en",resources:Ea}];function Pa(i){return{id:st,component:La,locales:Ia,icon:"kern-icon--filter-alt",storeModule:Ue,options:i}}const un=me("plugins/footer",()=>{const i=X(),e=P([]),t=P([]);function n(){e.value=(i.configuration.footer?.leftEntries||[]).filter(({id:r})=>{const s=i.configuration[r]?.displayComponent;return typeof s=="boolean"?s:!0}),t.value=(i.configuration.footer?.rightEntries||[]).filter(({id:r})=>{const s=i.configuration[r]?.displayComponent;return typeof s=="boolean"?s:!0}),e.value.concat(t.value).forEach(r=>{i.addPlugin(se(r,{independent:!1}))}),e.value.map(r=>se(r,{component:Bt(r.component)})),t.value.map(r=>se(r,{component:Bt(r.component)}))}function a(){}return{leftEntries:e,rightEntries:t,setupPlugin:n,teardownPlugin:a}}),Fa={class:"polar-plugin-footer-wrapper"},Aa=M({__name:"PolarFooter.ce",setup(i){const{leftEntries:e,rightEntries:t}=ge(un());return(n,a)=>(f(),x("div",Fa,[S("ul",null,[(f(!0),x(H,null,j(C(e),(r,s)=>(f(),x("li",{key:s},[(f(),A(wt(r.component)))]))),128))]),S("ul",null,[(f(!0),x(H,null,j(C(t),(r,s)=>(f(),x("li",{key:s},[(f(),A(wt(r.component)))]))),128))])]))}}),Ma=".polar-plugin-footer-wrapper{&[data-v-27a01195]{position:absolute;bottom:0;display:flex;width:100%;height:var(--kern-metric-space-x-large);padding:var(--kern-metric-space-x-small) var(--kern-metric-space-x-small) var(--kern-metric-space-x-small) var(--kern-metric-space-small);justify-content:space-between;align-items:center;flex-shrink:0;background:var(--kern-color-layout-background-hued);box-shadow:0 1px 1px #35395629,0 1px 2px #35395640,0 1px 6px #6e759740;border-radius:0 0 var(--kern-metric-border-radius-large) var(--kern-metric-border-radius-large)}ul{&[data-v-27a01195]{display:flex;align-items:center;gap:var(--kern-metric-space-small);padding:0}li[data-v-27a01195]{list-style:none}}}",Da=D(Aa,[["styles",[Ma]],["__scopeId","data-v-27a01195"]]),Ra={},Va={},Oa=[{type:"de",resources:Ra},{type:"en",resources:Va}],Ba="footer";function Ga(i){return{id:Ba,component:Da,locales:Oa,storeModule:un,options:i}}const Na=100,Ua=100,pt={undefinedBoundaryLayer:Symbol.for("Boundary Layer undefined"),undefinedBoundarySource:Symbol.for("Boundary Source undefined"),sourceNotReady:Symbol.for("Source not ready")};async function Ha(i){let e=0;for(;i.getState()!=="ready"||i.getFeatures().length===0;)if(e++<Na)await new Promise(t=>{setTimeout(t,Ua)});else return!1;return!0}async function hn(i,e,t){if(typeof e>"u")return!0;const n=i.getLayers().getArray().find(r=>r.get("id")===e);if(!(n instanceof Se))return console.error(`@polar/polar(lib/passesBoundaryCheck:61:3)
`,`No layer configured to match boundaryLayerId "${e}".`),pt.undefinedBoundaryLayer;const a=n.getSource();return a instanceof pe?await Ha(a)?a.getFeatures().some(r=>r.getGeometry()?.intersectsCoordinate(t)):(console.error(`@polar/polar(lib/passesBoundaryCheck:79:3)
`,`Layer with boundaryLayerId "${e}" did not load or is featureless.`),pt.sourceNotReady):(console.error(`@polar/polar(lib/passesBoundaryCheck:70:3)
`,`Layer with boundaryLayerId "${e}" missing source.`),pt.undefinedBoundarySource)}function Ht(){}const F={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},Wa={ERROR:"error"};let ja=class extends Ne{constructor(e){super(Wa.ERROR),this.code=e.code,this.message=e.message}},za=class extends Ri{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=Bn,this.watchId_=void 0,this.addChangeListener(F.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(F.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=Gn(tt("EPSG:4326"),e),this.position_&&this.set(F.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(F.ACCURACY,t.accuracy),this.set(F.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(F.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(F.HEADING,t.heading===null?void 0:Pi(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const n=this.transform_(this.position_);this.set(F.POSITION,n.slice()),this.set(F.SPEED,t.speed===null?void 0:t.speed);const a=Nn(this.position_,t.accuracy);a.applyTransform(this.transform_),this.set(F.ACCURACY_GEOMETRY,a),this.changed()}positionError_(e){this.dispatchEvent(new ja(e))}getAccuracy(){return this.get(F.ACCURACY)}getAccuracyGeometry(){return this.get(F.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(F.ALTITUDE)}getAltitudeAccuracy(){return this.get(F.ALTITUDE_ACCURACY)}getHeading(){return this.get(F.HEADING)}getPosition(){return this.get(F.POSITION)}getProjection(){return this.get(F.PROJECTION)}getSpeed(){return this.get(F.SPEED)}getTracking(){return this.get(F.TRACKING)}getTrackingOptions(){return this.get(F.TRACKING_OPTIONS)}setProjection(e){this.set(F.PROJECTION,tt(e))}setTracking(e){this.set(F.TRACKING,e)}setTrackingOptions(e){this.set(F.TRACKING_OPTIONS,e)}};const Ya=(i,e)=>()=>i.innerHTML=e.map(([t,n,a={}])=>`<${t}>${Ie.t(n,a)}</${t}>`).join(""),qa=`
	background: rgba(255, 255, 255, 0.8);
	padding: 0.2em 0.5em;
	border-radius: 4px;
	color: #16161d;
	box-shadow: 0px 0px 3px 2px rgba(0, 0, 0, 0.5);
`;function Ka(i,e=qa){const t=document.createElement("div");t.style.cssText=e;const n=Ya(t,i);return Ie.on("languageChanged",n),Ie.store.on("added",n),n(),{element:t,unregister:()=>{Ie.off("languageChanges",n),Ie.store.off("added",n)}}}function Ja(){return navigator.permissions.query({name:"geolocation"}).then(({state:i})=>i==="denied").catch(()=>!1)}function Za(i,e){const t=e/2*Math.sqrt(3),n=document.createElement("canvas").getContext("2d").createLinearGradient(0,-t,Math.sin(i),t+Math.cos(i));return n.addColorStop(0,"#0794FAFF"),n.addColorStop(2/3,"#0794FA00"),n}function Xa(i){if(typeof i.get("heading")>"u")return new rt;const e=42,t=Math.PI-i.get("heading");return new rt({image:new Fi({points:3,radius:e,rotation:t,fill:new ln({color:Za(t,e)}),displacement:[0,-30]})})}function Qa(){const i=new ln({color:"#0078D4"}),e=new Ei({color:"#FFFFFF",width:2});return t=>[Xa(t),new rt({image:new Ii({fill:i,stroke:e,radius:12}),fill:i,stroke:e})]}const er=(i,e)=>i[0]!==e[0]||i[1]!==e[1],gn=me("plugins/geoLocation",()=>{const i=X(),e=P(!1),t=P(null),n=P(null),a=P([]),r=$(()=>se({showTooltip:!1,zoomLevel:7},i.configuration.geoLocation||{})),s=$(()=>r.value.boundary),o=$(()=>e.value?"DISABLED":t.value===null?"LOCATABLE":"LOCATED"),l=new W({type:"point",name:"geoLocationMarker"}),d=new Se({source:new pe({features:[l]}),properties:{name:"geoLocationMarkerLayer"},zIndex:1/0,style:Qa()});function c(){i.map.addLayer(d),r.value.checkLocationInitially?w():Ja().then(k=>e.value=k),p()}function u(){i.map.removeLayer(d),g(),L(),h()}let h=Ht;function p(){if(r.value.showTooltip){const{unregister:k,element:T}=Ka([["h2","markerText",{ns:"geoLocation"}]]),G=new Vn({element:T,positioning:"bottom-center",offset:[0,-5]});i.map.addOverlay(G);const ne=({pixel:$e,dragging:An})=>{if(An)return;const Mn=i.map.getFeaturesAtPixel($e,{layerFilter:Dn=>Dn.get("name")==="geoLocationMarkerLayer"}).length?i.map.getCoordinateFromPixel($e):void 0;G.setPosition(Mn)};i.map.on("pointermove",ne),h=()=>{k(),i.map.removeOverlay(G),i.map.un("pointermove",ne),h=Ht}}}function v(){(o.value==="LOCATABLE"?w:g)()}function w(){if(e.value){I({message:"Geolocation API usage was denied by user or configuration."});return}t.value===null?t.value=new za({trackingOptions:{enableHighAccuracy:!0},tracking:!0,projection:tt("EPSG:4326")}):y(),t.value.on("change:position",y),t.value.on("change:heading",({target:k})=>{l.set("heading",k.getHeading())}),t.value.on("error",I)}function I(k){Fe("error",ie(T=>T.button.locationAccessDenied,{ns:"geoLocation"})),console.error(`@polar/polar(plugins/geoLocation/store:176:3)
`,k.message),e.value=!0,L()}function g(){t.value?.setTracking(!1),L(),t.value=null}async function y(){const k=Zt(t.value?.getPosition(),tt("EPSG:4326"),i.configuration.epsg),T=i.configuration.extent?On(i.configuration.extent,k):!0,G=await hn(i.map,s.value?.layerId,k),ne=n.value!==G;n.value=G;const $e=typeof G=="symbol"&&s.value?.onError==="strict";if(!T||$e){b($e),g();return}er(a.value,k)&&(_(k),ne&&!G&&b(!1))}function _(k){a.value=k;const T=!!l.getGeometry();l.setGeometry(new ae(k)),(r.value.keepCentered||!T)&&n.value&&(i.map.getView().setCenter(k),i.map.getView().setZoom(r.value.zoomLevel))}function L(){l.setGeometry(void 0),a.value=[]}function b(k){if(k){const G=ie(ne=>ne.toast.boundaryError,{ns:"geoLocation"});Fe("error",G),console.error(`@polar/polar(plugins/geoLocation/store:264:4)
`,G);return}const T=ie(G=>G.toast.notInBoundary,{ns:"geoLocation"});Fe("info",T,{timeout:1e4}),console.info(`@polar/polar(plugins/geoLocation/store:272:3)
`,T)}return{setupPlugin:c,teardownPlugin:u,locate:v,configuration:r,isGeolocationDenied:e,state:o,position:a,boundaryCheck:n}}),pn="geoLocation",tr=M({__name:"GeoLocation.ce",setup(i){const{layout:e}=ge(X()),t=gn(),{state:n}=ge(t),a=$(()=>n.value==="LOCATED"?"kern-icon-fill--near-me":n.value==="LOCATABLE"?"kern-icon--near-me":"kern-icon--near-me-disabled"),r=$(()=>t.configuration.renderType==="iconMenu"?void 0:e.value==="standard"||t.configuration.layoutTag?.includes("RIGHT")?"left":"right");return(s,o)=>(f(),A(Un,{class:Te(C(e)==="nineRegions"?"polar-plugin-geoLocation-nineRegions":""),hint:s.$t(l=>l.button.tooltip,{ns:C(pn)}),icon:a.value,"tooltip-position":r.value,disabled:C(n)==="DISABLED",onClick:C(t).locate},null,8,["class","hint","icon","tooltip-position","disabled","onClick"]))}}),nr=".polar-plugin-geoLocation-nineRegions[data-v-45fc3e3e]{margin:var(--kern-metric-space-small)}",ir=D(tr,[["styles",[nr]],["__scopeId","data-v-45fc3e3e"]]),ar={markerText:"Aktuelle Position",button:{locationAccessDenied:"Standortzugriff nutzerseitig abgelehnt",tooltip:"Eigene Position markieren"},toast:{boundaryError:"Die Überprüfung Ihrer Position ist fehlgeschlagen. Bitte versuchen Sie es später erneut oder wenden Sie sich an einen Administrator, wenn das Problem bestehen bleibt.",notInBoundary:"Sie befinden sich nicht im Kartengebiet."}},rr={markerText:"Current location",button:{locationAccessDenied:"Location access denied by user",tooltip:"Mark own location"},toast:{boundaryError:"Validating your position failed. Please try later again or contact an administrator if the issue persists.",notInBoundary:"You are not within the map's boundaries."}},sr=[{type:"de",resources:ar},{type:"en",resources:rr}];function or(i){return{id:pn,component:ir,locales:sr,storeModule:gn,options:i}}const V=[null,"http://www.opengis.net/wms","http://www.opengis.net/sld"];function He(i){return Hn(i[0].version,"1.3")>=0}const lr=R(V,{Service:m(Ir),Capability:m(Er)}),dr=R(V,{Request:m(Br),Exception:m(Mr),Layer:m(Dr),UserDefinedSymbolization:m(Lr)});let cr=class extends Wn{constructor(){super(),this.version=void 0}readFromNode(e){return this.version=e.getAttribute("version").trim(),O({version:this.version},lr,e,[])||null}};const fn={Name:m(E),Title:m(E),Abstract:m(E),KeywordList:m(kn),OnlineResource:m($t),ContactInformation:m(Pr),Fees:m(E),AccessConstraints:m(E)},ur=R(V,fn),hr=R(V,{...fn,LayerLimit:m(ut),MaxWidth:m(ut),MaxHeight:m(ut)}),gr=R(V,{ContactPersonPrimary:m(Fr),ContactPosition:m(E),ContactAddress:m(Ar),ContactVoiceTelephone:m(E),ContactFacsimileTelephone:m(E),ContactElectronicMailAddress:m(E)}),pr=R(V,{ContactPerson:m(E),ContactOrganization:m(E)}),fr=R(V,{AddressType:m(E),Address:m(E),City:m(E),StateOrProvince:m(E),PostCode:m(E),Country:m(E)}),mr=R(V,{Format:Xt(E)}),mn={Name:m(E),Title:m(E),Abstract:m(E),KeywordList:m(kn),BoundingBox:B(vn),Dimension:B(Rr),Attribution:m(Tr),AuthorityURL:B(Ur),Identifier:B(E),MetadataURL:B(Hr),DataURL:B(oe),FeatureListURL:B(oe),Style:B(Wr),Layer:B(ct)},yn=R(V,{...mn,SRS:B(E),Extent:m(Vr),ScaleHint:B(Or),LatLonBoundingBox:m((i,e)=>vn(i,e,!1)),Layer:B(ct)}),_n=R(V,{...mn,CRS:B(E),EX_GeographicBoundingBox:m($r),MinScaleDenominator:m(ye),MaxScaleDenominator:m(ye),Layer:B(ct)}),yr=R(V,{Title:m(E),OnlineResource:m($t),LogoURL:m(bn)}),_r=R(V,{westBoundLongitude:m(ye),eastBoundLongitude:m(ye),southBoundLatitude:m(ye),northBoundLatitude:m(ye)}),vr=R(V,{GetCapabilities:m(Ee),GetMap:m(Ee),GetFeatureInfo:m(Ee),DescribeLayer:m(Ee),GetLegendGraphic:m(Ee)}),br=R(V,{Format:B(E),DCPType:B(Gr)}),kr=R(V,{HTTP:m(Nr)}),xr=R(V,{Get:m(oe),Post:m(oe)}),Cr=R(V,{Name:m(E),Title:m(E),Abstract:m(E),LegendURL:B(bn),StyleSheetURL:m(oe),StyleURL:m(oe)}),wr=R(V,{Format:m(E),OnlineResource:m($t)}),Sr=R(V,{Keyword:Xt(E)});function Tr(i,e){return O({},yr,i,e)}function Lr(i,e){return{SupportSLD:!!Y(i.getAttribute("SupportSLD")),UserLayer:!!Y(i.getAttribute("UserLayer")),UserStyle:!!Y(i.getAttribute("UserStyle")),RemoteWFS:!!Y(i.getAttribute("RemoteWFS")),InlineFeatureData:!!Y(i.getAttribute("InlineFeatureData")),RemoteWCS:!!Y(i.getAttribute("RemoteWCS"))}}function vn(i,e,t=!0){const n=[te(i.getAttribute("minx")),te(i.getAttribute("miny")),te(i.getAttribute("maxx")),te(i.getAttribute("maxy"))],a=[te(i.getAttribute("resx")),te(i.getAttribute("resy"))],r={extent:n,res:a};return t&&(He(e)?r.crs=i.getAttribute("CRS"):r.srs=i.getAttribute("SRS")),r}function $r(i,e){const t=O({},_r,i,e);if(!t)return;const n=t.westBoundLongitude,a=t.southBoundLatitude,r=t.eastBoundLongitude,s=t.northBoundLatitude;if(!(n===void 0||a===void 0||r===void 0||s===void 0))return[n,a,r,s]}function Er(i,e){return O({},dr,i,e)}function Ir(i,e){return O({},He(e)?hr:ur,i,e)}function Pr(i,e){return O({},gr,i,e)}function Fr(i,e){return O({},pr,i,e)}function Ar(i,e){return O({},fr,i,e)}function Mr(i,e){return O([],mr,i,e)}function Dr(i,e){const t=O({},He(e)?_n:yn,i,e);return t.Layer===void 0?Object.assign(t,ct(i,e)):t}function ct(i,e){const t=He(e),n=e[e.length-1],a=O({},t?_n:yn,i,e);if(!a)return;let r=Y(i.getAttribute("queryable"));r===void 0&&(r=n.queryable),a.queryable=r!==void 0?r:!1;let s=kt(i.getAttribute("cascaded"));s===void 0&&(s=n.cascaded),a.cascaded=s;let o=Y(i.getAttribute("opaque"));o===void 0&&(o=n.opaque),a.opaque=o!==void 0?o:!1;let l=Y(i.getAttribute("noSubsets"));l===void 0&&(l=n.noSubsets),a.noSubsets=l!==void 0?l:!1;let d=te(i.getAttribute("fixedWidth"));d||(d=n.fixedWidth),a.fixedWidth=d;let c=te(i.getAttribute("fixedHeight"));c||(c=n.fixedHeight),a.fixedHeight=c;const u=["Style","AuthorityURL"];t?u.push("CRS"):u.push("SRS","Dimension"),u.forEach(function(p){if(p in n){const v=a[p]||[];a[p]=v.concat(n[p])}});const h=["BoundingBox","Attribution"];return t?h.push("Dimension","EX_GeographicBoundingBox","MinScaleDenominator","MaxScaleDenominator"):h.push("LatLonBoundingBox","ScaleHint","Extent"),h.forEach(function(p){if(!(p in a)){const v=n[p];a[p]=v}}),a}function Rr(i,e){const t={name:i.getAttribute("name"),units:i.getAttribute("units"),unitSymbol:i.getAttribute("unitSymbol")};return He(e)&&Object.assign(t,{default:i.getAttribute("default"),multipleValues:Y(i.getAttribute("multipleValues")),nearestValue:Y(i.getAttribute("nearestValue")),current:Y(i.getAttribute("current")),values:E(i)}),t}function Vr(i,e){return{name:i.getAttribute("name"),default:i.getAttribute("default"),nearestValue:Y(i.getAttribute("nearestValue"))}}function Or(i,e){return{min:te(i.getAttribute("min")),max:te(i.getAttribute("max"))}}function oe(i,e){return O({},wr,i,e)}function Br(i,e){return O({},vr,i,e)}function Gr(i,e){return O({},kr,i,e)}function Nr(i,e){return O({},xr,i,e)}function Ee(i,e){return O({},br,i,e)}function bn(i,e){const t=oe(i,e);if(t){const n=[kt(i.getAttribute("width")),kt(i.getAttribute("height"))];return t.size=n,t}}function Ur(i,e){const t=oe(i,e);if(t)return t.name=i.getAttribute("name"),t}function Hr(i,e){const t=oe(i,e);if(t)return t.type=i.getAttribute("type"),t}function Wr(i,e){return O({},Cr,i,e)}function kn(i,e){return O([],Sr,i,e)}function jr({legendURL:i,layers:e="",url:t,typ:n,format:a,version:r}){return i?i==="ignore"?[]:[i]:e.split(",").filter(s=>s).map(s=>`${t}?SERVICE=${n}&REQUEST=GetLegendGraphic&FORMAT=${a||"image/png"}&VERSION=${r}&LAYER=${s}`)}const Wt=(i,e)=>i.filter(t=>{let{minZoom:n,maxZoom:a}=t;return typeof n>"u"&&(n=0),typeof a>"u"&&(a=Number.MAX_SAFE_INTEGER),n<=e&&e<=a});function ot(i,e){if(Array.isArray(i))return i.map(t=>ot(t,e)).find(t=>t!==null)||null;if(typeof i=="object"){if(i.Name===e)return i;if(i.Layer)return ot(i.Layer,e)}return null}const zr=i=>(Array.isArray(i)?i:[i]).map(e=>(Array.isArray(e.LegendURL)?e.LegendURL:typeof e.LegendURL=="object"?[e.LegendURL]:[]).map(t=>t.OnlineResource)).flat(1);function Yr(i,e){return ot(i.Capability.Layer,e)?.Title||""}function qr(i,e){const t=ot(i.Capability.Layer,e)?.Style;return t&&zr(t)[0]||""}function Kr(i,e){const t=e[i];if(t)try{return new cr().read(t)}catch(n){console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:21:4)
`,`Error reading xml '${t}' for id '${i}'.`,n)}return null}function Jr(i,e){return Promise.all(i.map(async t=>{const{id:n}=t,a=t.options?.layers;if(a&&(a.title===!0||a.legend===!0)){if(typeof e[n]=="string")return console.warn(`@polar/polar(plugins/layerChooser/utils/capabilities:41:6)
`,`Re-fired loadCapabilities on id '${n}' albeit the GetCapabilities have already been successfully fetched. No re-fetch will occur.`),[n,null];const r=lt.getLayerWhere({id:t.id});if(!r||!r.url||!r.version||!r.typ)return console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:49:6)
`,`Missing data for service '${r}' with id '${n}'.`),[n,null];const s=`${r.url}?service=${r.typ}&version=${r.version}&request=GetCapabilities`;try{const o=await fetch(s);return[n,await o.text()]}catch(o){return console.error(`@polar/polar(plugins/layerChooser/utils/capabilities:61:6)
`,`Capabilities from ${s} could not be fetched.`,o),[n,null]}}return[n,null]})).then(t=>t.reduce((n,[a,r])=>se(n,{[a]:r}),{}))}function Zr(i,e,t){const n=lt.getLayerWhere({id:i}),a=Kr(i,e);return{[i]:(t.order?.split(",")||n.layers.split(",")).map(r=>({layerName:r,displayName:t.title===!0&&a?Yr(a,r):t.title===!1?r:t.title?.[r]||r,layerImage:t.legend===!0&&a?qr(a,r):t.legend===!1?null:t.legend?.[r]||null}))}}const Xr=i=>i.reduce(([e,t],n)=>lt.getLayerWhere({id:n.id})===null?(console.error(`@polar/polar(plugins/layerChooser/utils/getBackgroundsAndMasks:15:5)
`,`Layer ${n.id} not found in service register. This is a configuration issue. The map might behave in unexpected ways.`,n),[e,t]):n.type==="background"?[[...e,n],t]:[e,[...t,n]],[[],[]]),Qr=i=>i.map(({id:e,name:t})=>({id:e,name:t})).map(e=>se(e,{rawLayer:lt.getLayerWhere({id:e.id})})).filter(({rawLayer:e})=>e!==null).reduce((e,t)=>{const n=jr(t.rawLayer)[0];return typeof n=="string"?{...e,[t.id]:{name:t.name,url:n}}:e},{}),Le=me("plugins/layerChooser",()=>{const i=X(),e=P({}),t=P([]),n=P([]),a=P([]),r=P([]),s=P(""),o=P([]),l=P({}),d=P(""),c=P({}),u=P(""),h=$(()=>t.value.reduce((b,{id:k})=>({...b,[k]:a.value.findIndex(({id:T})=>T===k)===-1}),{})),p=$(()=>v.value.reduce((b,{id:k})=>({...b,[k]:r.value.findIndex(({id:T})=>T===k)===-1}),{})),v=$(()=>n.value.filter(({hideInMenu:b})=>!b)),w=$(()=>v.value.reduce((b,k)=>se(b,{[k.type]:Array.isArray(b[k.type])?b[k.type].concat(k):[k]}),{}));function I(){const[b,k]=Xr(i.configuration.layers);t.value=b,n.value=k,b.length===0&&console.error(`@polar/polar(plugins/layerChooser/store:100:4)
`,'No layers of type "background" have been configured.'),s.value=b.find(({visibility:T})=>T)?.id||"",o.value=k.filter(({visibility:T})=>T).map(({id:T})=>T),_(),i.map.on("moveend",_),l.value=Qr(i.configuration.layers),Jr(i.configuration.layers,e.value).then(T=>{e.value=T,i.configuration.layers.forEach(G=>{const ne=G.options?.layers;ne&&(c.value=se(c.value,Zr(G.id,T,ne)))})})}function g(){i.map.un("moveend",_)}we(s,b=>{i.map.getLayers().getArray().forEach(k=>{t.value.find(({id:T})=>T===k.get("id"))&&k.setVisible(k.get("id")===b)})}),we(o,b=>{y(b)});function y(b){i.map.getLayers().getArray().forEach(k=>{n.value.find(({id:T})=>T===k.get("id"))&&k.setVisible(b.includes(k.get("id")))})}function _(){const b=i.map.getView().getZoom();a.value=Wt(t.value,b),r.value=Wt(n.value,b);const k=a.value.map(({id:T})=>T);k.includes(s.value)||(s.value=k[0]||""),y(r.value.map(({id:T})=>T).filter(T=>o.value.includes(T)))}function L(b){const k=i.map.getLayers().getArray().find(T=>T.get("id")===u.value).getSource();if(!k){console.error(`@polar/polar(plugins/layerChooser/store:208:4)
`,`Action 'toggleOpenedOptionsServiceLayer' failed on ${u.value}. Layer not found in OpenLayers or source not initialized in OpenLayers.`);return}k.updateParams({...k.getParams(),LAYERS:b})}return{activeBackgroundId:s,activeMaskIds:o,backgrounds:t,capabilities:e,disabledBackgrounds:h,disabledMasks:p,layersWithLegends:l,layersWithOptions:c,masksSeparatedByType:w,shownMasks:v,openedLegendId:d,openedOptionsId:u,setupPlugin:I,teardownPlugin:g,toggleOpenedOptionsServiceLayer:L}}),J="layerChooser",es=["id"],ts={class:"kern-label"},ns=M({__name:"LayerInformationCard.ce",props:{identifier:{type:String},idName:{type:String}},setup(i){const e=i,t=X(),n=Le();Si(()=>{t.shadowRoot?.getElementById(`polar-layer-chooser-${e.identifier}-back-button`)?.focus()});function a(){const r=n[e.idName];n[e.idName]="",Ti(()=>{t.shadowRoot?.getElementById(`polar-layer-chooser-${e.identifier}-${r}-button`)?.focus()})}return(r,s)=>(f(),A(dt,null,{default:re(()=>[S("button",{id:`polar-layer-chooser-${i.identifier}-back-button`,class:"kern-btn kern-btn--secondary",onClick:a},[s[0]||(s[0]=S("span",{class:"kern-icon kern-icon--arrow-back","aria-hidden":"true"},null,-1)),S("span",ts,Z(r.$t(o=>o.returnToLayers,{ns:C(J)})),1)],8,es),At(r.$slots,"default",{},void 0,!0)]),_:3}))}}),is="button[data-v-a40f4439]{pointer-events:all}",xn=D(ns,[["styles",[is]],["__scopeId","data-v-a40f4439"]]),as={class:"kern-label",for:"polar-layer-chooser-legend-anchor"},rs=["href","aria-label"],ss=["src","alt"],os=M({__name:"LayerLegend.ce",setup(i){const e=Le(),t=$(()=>e.layersWithLegends[e.openedLegendId]);return(n,a)=>(f(),A(xn,{identifier:"legend","id-name":"openedLegendId",class:"legend-card"},{default:re(()=>[S("label",as,Z(n.$t(r=>r.legend.to,{name:t.value.name,ns:C(J)})),1),S("a",{id:"polar-layer-chooser-legend-anchor",href:t.value.url,"aria-label":n.$t(r=>r.legend.to,{name:t.value.name,ns:C(J)}),target:"_blank"},[S("img",{src:t.value.url,alt:n.$t(r=>r.legend.to,{name:t.value.name,ns:C(J)})},null,8,ss)],8,rs)]),_:1}))}}),ls=".legend-card{&[data-v-d0f82324]{overflow-y:scroll}a[data-v-d0f82324]{pointer-events:all}}",ds=D(os,[["styles",[ls]],["__scopeId","data-v-d0f82324"]]),cs={class:"kern-form-check"},us=["id","name","value","type","disabled"],hs=["for"],gs=M({__name:"PolarInput.ce",props:Ge({idSuffix:{type:String},label:{type:String},type:{type:null},value:{type:String},disabled:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const e=he(i,"modelValue");return(t,n)=>(f(),x("div",cs,[Be(S("input",{id:`polar-${i.type}-${i.value}-${i.idSuffix}`,"onUpdate:modelValue":n[0]||(n[0]=a=>e.value=a),class:Te(`polar-input kern-form-check__${i.type}`),name:i.value,value:i.value,type:i.type,disabled:i.disabled},null,10,us),[[wi,e.value]]),S("label",{class:"polar-input kern-label",for:`polar-${i.type}-${i.value}-${i.idSuffix}`},Z(i.label),9,hs)]))}}),ps=".polar-input[data-v-caf745f0]{pointer-events:all}.kern-form-check__radio[disabled],.kern-form-check__checkbox[disabled]{&[data-v-caf745f0]:hover{border:var(--kern-metric-border-width-default) solid var(--kern-color-form-input-border)}}.kern-form-check__checkbox[disabled]{&[data-v-caf745f0]:checked:hover:before{margin:var(--kern-metric-space-x-small)}}",Tt=D(gs,[["styles",[ps]],["__scopeId","data-v-caf745f0"]]),fs={class:"kern-fieldset"},ms={class:"kern-label"},ys={class:"kern-fieldset__body"},_s=M({__name:"PolarInputGroup.ce",props:{legend:{type:String}},setup(i){return(e,t)=>(f(),x("fieldset",fs,[S("legend",ms,Z(i.legend),1),S("div",ys,[At(e.$slots,"default",{},void 0)])]))}}),vs=".kern-fieldset[data-v-69d29a6c]{width:100%}.kern-fieldset__body[data-v-69d29a6c]{width:100%;padding:var(--kern-metric-space-small) 0;gap:var(--kern-metric-space-small);border-radius:var(--kern-metric-border-radius-default);background-color:var(--kern-color-layout-background-hued)}.kern-label[data-v-69d29a6c]{padding-left:.75rem}[data-v-69d29a6c] .kern-form-check{align-items:center;gap:var(--kern-metric-space-large);margin-left:.75rem;padding-right:0}",Lt=D(_s,[["styles",[vs]],["__scopeId","data-v-69d29a6c"]]),bs=["src","alt"],ks=M({__name:"LayerOptions.ce",setup(i){const e=X(),t=Le(),{openedOptionsId:n}=ge(t),a=$(()=>t.layersWithOptions[n.value]),r=P(a.value.map(({layerName:l})=>l).reverse()),s=$({get:()=>r.value,set:l=>{r.value=l,t.toggleOpenedOptionsServiceLayer(l)}}),o=$(()=>e.configuration.layers.find(({id:l})=>l===n.value)?.name||"");return(l,d)=>(f(),A(xn,{identifier:"options","id-name":"openedOptionsId"},{default:re(()=>[de(Lt,{legend:l.$t(c=>c.layerHeader,{ns:C(J),name:o.value})},{default:re(()=>[(f(!0),x(H,null,j(a.value,({displayName:c,layerImage:u,layerName:h})=>(f(),x("div",{key:`polar-layer-chooser-mask-options-checkbox-${h}`,class:"polar-layer-chooser-options-checkbox-wrapper"},[u?(f(),x("img",{key:0,src:u,alt:h},null,8,bs)):U("",!0),de(Tt,{modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=p=>s.value=p),"id-suffix":"polar-layer-chooser-mask-options",label:c,type:"checkbox",value:h,class:Te(a.value.some(({layerImage:p})=>p!==null)?"polar-layer-chooser-options-checkbox":"")},null,8,["modelValue","label","value","class"])]))),128))]),_:1},8,["legend"])]),_:1}))}}),xs=".polar-layer-chooser-options-checkbox-wrapper[data-v-ee5a3965]{display:flex;justify-content:flex-start;align-items:center;gap:var(--kern-metric-space-large)}.kern-form-check.polar-layer-chooser-options-checkbox[data-v-ee5a3965]{margin-left:0}.kern-btn[data-v-ee5a3965]{border:none;min-height:inherit;padding:var(--kern-metric-space-x-small);pointer-events:all}.kern-label[data-v-ee5a3965]{padding:0;padding-left:var(--kern-metric-space-small)}",Cs=D(ks,[["styles",[xs]],["__scopeId","data-v-ee5a3965"]]),ws=["id","disabled"],Ss={class:"kern-label kern-sr-only"},jt=M({__name:"LegendButton.ce",props:{disabled:{type:Boolean},id:{type:String}},setup(i){return(e,t)=>(f(),x("button",{id:`polar-layer-chooser-legend-${i.id}-button`,class:"kern-btn kern-btn--tertiary",disabled:i.disabled},[t[0]||(t[0]=S("span",{class:"kern-icon kern-icon--info","aria-hidden":"true"},null,-1)),S("span",Ss,Z(e.$t(n=>n.legend.open,{ns:C(J)})),1)],8,ws))}}),Ts=["id","disabled","onClick"],Ls={class:"kern-label kern-sr-only"},$s=M({__name:"LayerSelection.ce",setup(i){const e=Le(),{activeBackgroundId:t,activeMaskIds:n,backgrounds:a,disabledBackgrounds:r,disabledMasks:s,layersWithOptions:o,masksSeparatedByType:l,openedLegendId:d,shownMasks:c}=ge(e),u=$(()=>Object.keys(e.layersWithLegends));function h(p){e.openedOptionsId=p}return(p,v)=>(f(),A(dt,{id:"polar-layer-chooser-card"},{default:re(()=>[C(a).length?(f(),A(Lt,{key:0,legend:p.$t(w=>w.backgroundTitle,{ns:C(J)})},{default:re(()=>[(f(!0),x(H,null,j(C(a),({name:w,id:I})=>(f(),x("div",{key:`polar-layer-chooser-background-radio-${I}`,class:"polar-layer-chooser-input-wrapper"},[de(Tt,{modelValue:C(t),"onUpdate:modelValue":v[0]||(v[0]=g=>Gt(t)?t.value=g:null),"id-suffix":"polar-layer-chooser-background",label:w,type:"radio",value:I,disabled:C(r)[I]},null,8,["modelValue","label","value","disabled"]),u.value.includes(I)?(f(),A(jt,{key:0,id:I,disabled:C(r)[I],onClick:g=>d.value=I},null,8,["id","disabled","onClick"])):U("",!0)]))),128))]),_:1},8,["legend"])):U("",!0),C(c).length?(f(!0),x(H,{key:1},j(Object.entries(C(l)),([w,I])=>(f(),A(Lt,{key:`polar-layer-chooser-mask-${w}`,legend:p.$t(g=>g[`${w}Title`],{ns:C(J)})},{default:re(()=>[(f(!0),x(H,null,j(I,({name:g,id:y})=>(f(),x("div",{key:`polar-layer-chooser-mask-${w}-checkbox-${y}`,class:"polar-layer-chooser-input-wrapper"},[de(Tt,{modelValue:C(n),"onUpdate:modelValue":v[1]||(v[1]=_=>Gt(n)?n.value=_:null),"id-suffix":`polar-layer-chooser-mask-${w}`,label:g,type:"checkbox",value:y,disabled:C(s)[y]},null,8,["modelValue","id-suffix","label","value","disabled"]),Object.keys(C(o)).includes(y)?(f(),x("button",{key:0,id:`polar-layer-chooser-options-${y}-button`,class:"kern-btn kern-btn--tertiary",disabled:C(s)[y],onClick:()=>h(y)},[v[2]||(v[2]=S("span",{class:"kern-icon kern-icon-fill--settings","aria-hidden":"true"},null,-1)),S("span",Ls,Z(p.$t(_=>_.layerOptions,{ns:C(J)})),1)],8,Ts)):u.value.includes(y)?(f(),A(jt,{key:1,id:y,disabled:C(s)[y],onClick:_=>d.value=y},null,8,["id","disabled","onClick"])):U("",!0)]))),128))]),_:2},1032,["legend"]))),128)):U("",!0)]),_:1}))}}),Es="#polar-layer-chooser-card[data-v-98ce45f5]{overflow-y:inherit}.polar-layer-chooser-input-wrapper{&[data-v-98ce45f5]{display:flex;justify-content:space-between;align-items:center;gap:var(--kern-metric-space-large)}button[data-v-98ce45f5]{pointer-events:all}}.kern-btn[data-v-98ce45f5]{width:var(--kern-metric-dimension-large);min-height:var(--kern-metric-dimension-large);border:none;border-radius:50%}",Is=D($s,[["styles",[Es]],["__scopeId","data-v-98ce45f5"]]),Ps=M({__name:"LayerChooser.ce",setup(i){const e=Le(),t=$(()=>e.openedLegendId.length!==0),n=$(()=>e.openedOptionsId.length===0&&!t.value);return(a,r)=>n.value?(f(),A(Is,{key:0})):t.value?(f(),A(ds,{key:1})):(f(),A(Cs,{key:2}))}}),Fs={backgroundTitle:"Hintergrundkarten",maskTitle:"Fachdaten",layerHeader:'Auswahl sichtbarer Ebenen für Layer "{{name}}"',layerOptions:"Optionen für Kartenmaterial",legend:{title:"Legende",to:'Legendenbild zu "{{name}}"',open:`$t(legend.to, {ns: ${J}}) öffnen`},returnToLayers:"Zurück"},As={backgroundTitle:"Background maps",maskTitle:"Subject data",layerHeader:'Visible layer selection for layer "{{name}}"',layerOptions:"Map data options",legend:{title:"Legend",to:'"{{name}}" legend image',open:`Open $t(legend.to, {ns: ${J}})`},returnToLayers:"Back"},Ms=[{type:"de",resources:Fs},{type:"en",resources:As}];function Ds(i){return{id:J,component:Ps,icon:"kern-icon-fill--layers",locales:Ms,storeModule:Le,options:i}}const Rs=["KernLoader","BasicLoader","RingLoader","RollerLoader","CircleLoader","SpinnerLoader"],Cn=me("plugins/loadingIndicator",()=>{const i=P(new Set),e=P("KernLoader"),t=$(()=>i.value.size>0);function n(){const l=X().configuration.loadingIndicator?.loaderStyle;l&&o(l)}function a(){o("KernLoader")}function r(l){i.value=new Set([...i.value,l])}function s(l){const d=new Set(i.value);d.delete(l),i.value=d}function o(l){Rs.includes(l)?e.value=l:console.error(`@polar/polar(plugins/loadingIndicator/store:62:5)
`,`Loader style ${l} does not exist. Using previous style (${e.value}).`)}return{loaderStyle:e,showLoader:t,addLoadingKey:r,removeLoadingKey:s,setLoaderStyle:o,setupPlugin:n,teardownPlugin:a}}),Vs={class:"lds-default"},Os=M({__name:"BasicLoader.ce",setup(i){return(e,t)=>(f(),x("div",Vs,[(f(),x(H,null,j(12,n=>S("div",{key:n})),64))]))}}),Bs=".lds-default[data-v-6079aaec]{color:var(--kern-color-action-default)}.lds-default[data-v-6079aaec],.lds-default div[data-v-6079aaec]{box-sizing:border-box}.lds-default[data-v-6079aaec]{display:inline-block;position:relative;width:80px;height:80px}.lds-default div[data-v-6079aaec]{position:absolute;width:6.4px;height:6.4px;background:currentColor;border-radius:50%;animation:lds-default-6079aaec 1.2s linear infinite}.lds-default div[data-v-6079aaec]:nth-child(1){animation-delay:0s;top:36.8px;left:66.24px}.lds-default div[data-v-6079aaec]:nth-child(2){animation-delay:-.1s;top:22.08px;left:62.29579px}.lds-default div[data-v-6079aaec]:nth-child(3){animation-delay:-.2s;top:11.30421px;left:51.52px}.lds-default div[data-v-6079aaec]:nth-child(4){animation-delay:-.3s;top:7.36px;left:36.8px}.lds-default div[data-v-6079aaec]:nth-child(5){animation-delay:-.4s;top:11.30421px;left:22.08px}.lds-default div[data-v-6079aaec]:nth-child(6){animation-delay:-.5s;top:22.08px;left:11.30421px}.lds-default div[data-v-6079aaec]:nth-child(7){animation-delay:-.6s;top:36.8px;left:7.36px}.lds-default div[data-v-6079aaec]:nth-child(8){animation-delay:-.7s;top:51.52px;left:11.30421px}.lds-default div[data-v-6079aaec]:nth-child(9){animation-delay:-.8s;top:62.29579px;left:22.08px}.lds-default div[data-v-6079aaec]:nth-child(10){animation-delay:-.9s;top:66.24px;left:36.8px}.lds-default div[data-v-6079aaec]:nth-child(11){animation-delay:-1s;top:62.29579px;left:51.52px}.lds-default div[data-v-6079aaec]:nth-child(12){animation-delay:-1.1s;top:51.52px;left:62.29579px}@keyframes lds-default-6079aaec{0%,20%,80%,to{transform:scale(1)}50%{transform:scale(1.5)}}",Gs=D(Os,[["styles",[Bs]],["__scopeId","data-v-6079aaec"]]),Ns={},Us=".lds-circle[data-v-149ac9d5]{color:var(--kern-color-action-default)}.lds-circle[data-v-149ac9d5],.lds-circle div[data-v-149ac9d5]{box-sizing:border-box}.lds-circle[data-v-149ac9d5]{display:inline-block;transform:translateZ(1px);width:80px;height:80px}.lds-circle>div[data-v-149ac9d5]{display:inline-block;width:64px;height:64px;margin:8px;background:currentColor;border-radius:50%;animation:lds-circle-149ac9d5 2.4s cubic-bezier(0,.2,.8,1) infinite}@keyframes lds-circle-149ac9d5{0%,to{animation-timing-function:cubic-bezier(.5,0,1,.5)}0%{transform:rotateY(0)}50%{transform:rotateY(1800deg);animation-timing-function:cubic-bezier(0,.5,.5,1)}to{transform:rotateY(3600deg)}}",Hs={class:"lds-circle"};function Ws(i,e,t,n,a,r){return f(),x("div",Hs,[...e[0]||(e[0]=[S("div",null,null,-1)])])}const js=D(Ns,[["render",Ws],["styles",[Us]],["__scopeId","data-v-149ac9d5"]]),zs={},Ys=".lds-ring[data-v-712a38e8]{color:var(--kern-color-action-default)}.lds-ring[data-v-712a38e8],.lds-ring div[data-v-712a38e8]{box-sizing:border-box}.lds-ring[data-v-712a38e8]{display:inline-block;position:relative;width:80px;height:80px}.lds-ring div[data-v-712a38e8]{box-sizing:border-box;display:block;position:absolute;width:64px;height:64px;margin:8px;border:8px solid currentColor;border-radius:50%;animation:lds-ring-712a38e8 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:currentColor transparent transparent transparent}.lds-ring div[data-v-712a38e8]:nth-child(1){animation-delay:-.45s}.lds-ring div[data-v-712a38e8]:nth-child(2){animation-delay:-.3s}.lds-ring div[data-v-712a38e8]:nth-child(3){animation-delay:-.15s}@keyframes lds-ring-712a38e8{0%{transform:rotate(0)}to{transform:rotate(360deg)}}",qs={class:"lds-ring"};function Ks(i,e,t,n,a,r){return f(),x("div",qs,[(f(),x(H,null,j(4,s=>S("div",{key:s})),64))])}const Js=D(zs,[["render",Ks],["styles",[Ys]],["__scopeId","data-v-712a38e8"]]),Zs={},Xs='.lds-roller[data-v-c8254b29]{color:var(--kern-color-action-default)}.lds-roller[data-v-c8254b29],.lds-roller div[data-v-c8254b29],.lds-roller div[data-v-c8254b29]:after{box-sizing:border-box}.lds-roller[data-v-c8254b29]{display:inline-block;position:relative;width:80px;height:80px}.lds-roller div[data-v-c8254b29]{animation:lds-roller-c8254b29 1.2s cubic-bezier(.5,0,.5,1) infinite;transform-origin:40px 40px}.lds-roller div[data-v-c8254b29]:after{content:" ";display:block;position:absolute;width:7.2px;height:7.2px;border-radius:50%;background:currentColor;margin:-3.6px 0 0 -3.6px}.lds-roller div[data-v-c8254b29]:nth-child(1){animation-delay:-36ms}.lds-roller div[data-v-c8254b29]:nth-child(1):after{top:62.62742px;left:62.62742px}.lds-roller div[data-v-c8254b29]:nth-child(2){animation-delay:-72ms}.lds-roller div[data-v-c8254b29]:nth-child(2):after{top:67.71281px;left:56px}.lds-roller div[data-v-c8254b29]:nth-child(3){animation-delay:-.108s}.lds-roller div[data-v-c8254b29]:nth-child(3):after{top:70.90963px;left:48.28221px}.lds-roller div[data-v-c8254b29]:nth-child(4){animation-delay:-.144s}.lds-roller div[data-v-c8254b29]:nth-child(4):after{top:72px;left:40px}.lds-roller div[data-v-c8254b29]:nth-child(5){animation-delay:-.18s}.lds-roller div[data-v-c8254b29]:nth-child(5):after{top:70.90963px;left:31.71779px}.lds-roller div[data-v-c8254b29]:nth-child(6){animation-delay:-.216s}.lds-roller div[data-v-c8254b29]:nth-child(6):after{top:67.71281px;left:24px}.lds-roller div[data-v-c8254b29]:nth-child(7){animation-delay:-.252s}.lds-roller div[data-v-c8254b29]:nth-child(7):after{top:62.62742px;left:17.37258px}.lds-roller div[data-v-c8254b29]:nth-child(8){animation-delay:-.288s}.lds-roller div[data-v-c8254b29]:nth-child(8):after{top:56px;left:12.28719px}@keyframes lds-roller-c8254b29{0%{transform:rotate(0)}to{transform:rotate(360deg)}}',Qs={class:"lds-roller"};function eo(i,e,t,n,a,r){return f(),x("div",Qs,[(f(),x(H,null,j(8,s=>S("div",{key:s})),64))])}const to=D(Zs,[["render",eo],["styles",[Xs]],["__scopeId","data-v-c8254b29"]]),no={},io='.lds-spinner[data-v-1790c8de]{color:var(--kern-color-action-default)}.lds-spinner[data-v-1790c8de],.lds-spinner div[data-v-1790c8de],.lds-spinner div[data-v-1790c8de]:after{box-sizing:border-box}.lds-spinner[data-v-1790c8de]{color:currentColor;display:inline-block;position:relative;width:80px;height:80px}.lds-spinner div[data-v-1790c8de]{transform-origin:40px 40px;animation:lds-spinner-1790c8de 1.2s linear infinite}.lds-spinner div[data-v-1790c8de]:after{content:" ";display:block;position:absolute;top:3.2px;left:36.8px;width:6.4px;height:17.6px;border-radius:20%;background:currentColor}.lds-spinner div[data-v-1790c8de]:nth-child(1){transform:rotate(0);animation-delay:-1.1s}.lds-spinner div[data-v-1790c8de]:nth-child(2){transform:rotate(30deg);animation-delay:-1s}.lds-spinner div[data-v-1790c8de]:nth-child(3){transform:rotate(60deg);animation-delay:-.9s}.lds-spinner div[data-v-1790c8de]:nth-child(4){transform:rotate(90deg);animation-delay:-.8s}.lds-spinner div[data-v-1790c8de]:nth-child(5){transform:rotate(120deg);animation-delay:-.7s}.lds-spinner div[data-v-1790c8de]:nth-child(6){transform:rotate(150deg);animation-delay:-.6s}.lds-spinner div[data-v-1790c8de]:nth-child(7){transform:rotate(180deg);animation-delay:-.5s}.lds-spinner div[data-v-1790c8de]:nth-child(8){transform:rotate(210deg);animation-delay:-.4s}.lds-spinner div[data-v-1790c8de]:nth-child(9){transform:rotate(240deg);animation-delay:-.3s}.lds-spinner div[data-v-1790c8de]:nth-child(10){transform:rotate(270deg);animation-delay:-.2s}.lds-spinner div[data-v-1790c8de]:nth-child(11){transform:rotate(300deg);animation-delay:-.1s}.lds-spinner div[data-v-1790c8de]:nth-child(12){transform:rotate(330deg);animation-delay:0s}@keyframes lds-spinner-1790c8de{0%{opacity:1}to{opacity:0}}',ao={class:"lds-spinner"};function ro(i,e,t,n,a,r){return f(),x("div",ao,[(f(),x(H,null,j(12,s=>S("div",{key:s})),64))])}const so=D(no,[["render",ro],["styles",[io]],["__scopeId","data-v-1790c8de"]]),oo={key:0,class:"polar-plugin-loading-indicator-wrapper"},lo={key:0,class:"polar-plugin-loading-indicator-overlay"},co={key:0,class:"kern-loader kern-loader--visible",role:"status"},uo=M({__name:"LoadingIndicator.ce",setup(i){const{layout:e}=ge(X()),{loaderStyle:t,showLoader:n}=ge(Cn()),a={BasicLoader:Gs,CircleLoader:js,RingLoader:Js,RollerLoader:to,SpinnerLoader:so};return(r,s)=>C(n)&&C(t)!==null?(f(),x("div",oo,[C(e)==="standard"?(f(),x("div",lo)):U("",!0),de(dt,null,{default:re(()=>[C(t)==="KernLoader"?(f(),x("div",co)):(f(),A(wt(a[C(t)]),{key:1,class:"kern-loader--visible",role:"status"}))]),_:1})])):U("",!0)}}),ho=".polar-plugin-loading-indicator-wrapper{&[data-v-d34e6512]{z-index:100;position:absolute;display:flex;align-items:center;justify-content:center;width:100%;height:100%}.polar-plugin-loading-indicator-overlay[data-v-d34e6512]{position:absolute;width:100%;height:100%;opacity:var(--kern-color-action-state-opacity-overlay);background:#fff}.kern-card[data-v-d34e6512]{min-width:fit-content;height:fit-content;border-radius:50%}[data-v-d34e6512] .kern-card__container{padding:var(--kern-metric-space-small)!important}}",go=D(uo,[["styles",[ho]],["__scopeId","data-v-d34e6512"]]),po="loadingIndicator";function fo(i){return{id:po,component:go,storeModule:Cn,options:i}}class We extends ri{constructor(e,t,n){super(),n!==void 0&&t===void 0?this.setFlatCoordinates(n,e):(t=t||0,this.setCenterAndRadius(e,t,n))}clone(){const e=new We(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,a){const r=this.flatCoordinates,s=e-r[0],o=t-r[1],l=s*s+o*o;if(l<a){if(l===0)for(let d=0;d<this.stride;++d)n[d]=r[d];else{const d=this.getRadius()/Math.sqrt(l);n[0]=r[0]+d*s,n[1]=r[1]+d*o;for(let c=2;c<this.stride;++c)n[c]=r[c]}return n.length=this.stride,l}return a}containsXY(e,t){const n=this.flatCoordinates,a=e-n[0],r=t-n[1];return a*a+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,n=t[this.stride]-t[0];return si(t[0]-n,t[1]-n,t[0]+n,t[1]+n,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(oi(e,t)){const n=this.getCenter();return e[0]<=n[0]&&e[2]>=n[0]||e[1]<=n[1]&&e[3]>=n[1]?!0:li(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,n=this.flatCoordinates[t]-this.flatCoordinates[0],a=e.slice();a[t]=a[0]+n;for(let r=1;r<t;++r)a[t+r]=e[r];this.setFlatCoordinates(this.layout,a),this.changed()}setCenterAndRadius(e,t,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const a=this.flatCoordinates;let r=di(a,0,e,this.stride);a[r++]=a[0]+t;for(let s=1,o=this.stride;s<o;++s)a[r++]=a[s];a.length=r,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const n=this.getCenter(),a=this.getStride();this.setCenter(ci(n,0,n.length,a,e,t,n)),this.changed()}}We.prototype.transform;function le(i,e){const t=i.length;return e<0?i[e+t]:e>=t?i[e-t]:i[e]}function be(i,e){const t=i.length;let n=Math.floor(e);const a=e-n;n>=t?n-=t:n<0&&(n+=t);let r=n+1;r>=t&&(r-=t);const s=i[n],o=s[0],l=s[1],d=i[r],c=d[0]-o,u=d[1]-l;return[o+c*a,l+u*a]}const je={index:-1,endIndex:NaN,closestTargetDistance:1/0};function wn(i,e,t,n){const a=i[0],r=i[1];let s=1/0,o=-1,l=NaN;for(let u=0;u<e.targets.length;++u){const h=e.targets[u],p=h.coordinates;let v=1/0,w;for(let I=0;I<p.length-1;++I){const g=p[I],y=p[I+1],_=Ln(a,r,g,y);_.squaredDistance<v&&(v=_.squaredDistance,w=I+_.along)}v<s&&(s=v,h.ring&&e.targetIndex===u&&(h.endIndex>h.startIndex?w<h.startIndex&&(w+=p.length):h.endIndex<h.startIndex&&w>h.startIndex&&(w-=p.length)),l=w,o=u)}const d=e.targets[o];let c=d.ring;if(e.targetIndex===o&&c){const u=be(d.coordinates,l),h=t.getPixelFromCoordinate(u),p=t.getPixelFromCoordinate(e.startCoord);ve(h,p)>n&&(c=!1)}if(c){const u=d.coordinates,h=u.length,p=d.startIndex,v=l;if(p<v){const w=qe(u,p,v);qe(u,p,v-h)<w&&(l-=h)}else{const w=qe(u,p,v);qe(u,p,v+h)<w&&(l+=h)}}return je.index=o,je.endIndex=l,je.closestTargetDistance=s,je}function Sn(i,e){const t=[];for(let n=0;n<e.length;++n){const a=e[n].getGeometry();Tn(i,a,t)}return t}function Tn(i,e,t){if(e instanceof Ae){ze(i,e.getCoordinates(),!1,t);return}if(e instanceof It){const n=e.getCoordinates();for(let a=0,r=n.length;a<r;++a)ze(i,n[a],!1,t);return}if(e instanceof Ft){const n=e.getCoordinates();for(let a=0,r=n.length;a<r;++a)ze(i,n[a],!0,t);return}if(e instanceof Pt){const n=e.getCoordinates();for(let a=0,r=n.length;a<r;++a){const s=n[a];for(let o=0,l=s.length;o<l;++o)ze(i,s[o],!0,t)}return}if(e instanceof ui){const n=e.getGeometries();for(let a=0;a<n.length;++a)Tn(i,n[a],t);return}}function ze(i,e,t,n){const a=i[0],r=i[1];for(let s=0,o=e.length-1;s<o;++s){const l=e[s],d=e[s+1],c=Ln(a,r,l,d);if(c.squaredDistance===0){const u=s+c.along;n.push({coordinates:e,ring:t,startIndex:u,endIndex:u});return}}}function Ye(i,e){return dn(i[0],i[1],e[0],e[1])}function qe(i,e,t){let n,a;e<t?(n=e,a=t):(n=t,a=e);const r=Math.ceil(n),s=Math.floor(a);if(r>s){const l=be(i,n),d=be(i,a);return Ye(l,d)}let o=0;if(n<r){const l=be(i,n),d=le(i,r);o+=Ye(l,d)}if(s<a){const l=le(i,s),d=be(i,a);o+=Ye(l,d)}for(let l=r;l<s-1;++l){const d=le(i,l),c=le(i,l+1);o+=Ye(d,c)}return o}const ft={along:0,squaredDistance:0};function Ln(i,e,t,n){const a=t[0],r=t[1],s=n[0],o=n[1],l=s-a,d=o-r;let c=0,u=a,h=r;return(l!==0||d!==0)&&(c=Mi(((i-a)*l+(e-r)*d)/(l*l+d*d),0,1),u+=l*c,h+=d*c),ft.along=c,ft.squaredDistance=Ai(dn(i,e,u,h),10),ft}const Ke={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class Je extends Ne{constructor(e,t){super(e),this.feature=t}}class mo extends Et{constructor(e){const t=e;t.stopDown||(t.stopDown=Oi),super(t),this.on,this.once,this.un,this.options_=e,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=_o(this.type_),this.stopClick_=!!e.stopClick,this.ignoreNextUpEvent_=!1,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:De,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let n=e.geometryFunction;if(!n){const a=this.mode_;if(a==="Circle")n=(r,s,o)=>{const l=s||new We([NaN,NaN]),d=N(r[0]),c=it(d,N(r[r.length-1]));return l.setCenterAndRadius(d,Math.sqrt(c),this.geometryLayout_),l};else{let r;a==="Point"?r=ae:a==="LineString"?r=Ae:a==="Polygon"&&(r=Ft),n=(s,o,l)=>(o?a==="Polygon"?s[0].length?o.setCoordinates([s[0].concat([s[0][0]])],this.geometryLayout_):o.setCoordinates([],this.geometryLayout_):o.setCoordinates(s,this.geometryLayout_):o=new r(s,this.geometryLayout_),o)}}this.geometryFunction_=n,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Se({source:new pe({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:yo(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:Kn,this.freehandCondition_,e.freehand?this.freehandCondition_=xe:this.freehandCondition_=e.freehandCondition?e.freehandCondition:xt,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(en.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=xe:t=e:t=nt,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}setFreehand(e){this.freehand_=e,this.freehand_?this.freehandCondition_=xe:this.freehandCondition_=this.options_&&this.options_.freehandCondition?this.options_.freehandCondition:xt}getOverlay(){return this.overlay_}getFreehand(){return this.freehand_}handleEvent(e){e.originalEvent.type===St.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===q.POINTERMOVE,n=!0;return!this.freehand_&&this.lastDragTime_&&e.type===q.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===q.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),n=!1):this.freehand_&&e.type===q.POINTERDOWN?n=!1:t&&this.getPointerCount()<2?(n=e.type===q.POINTERMOVE,n&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===q.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===q.DBLCLICK&&(n=!1),super.handleEvent(e)&&n}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new Jn(q.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),n=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),a=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),r=z([n,a]),s=this.traceSource_.getFeaturesInExtent(r);if(s.length===0)return;const o=Sn(e.coordinate,s);o.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:o,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const n=e.startIndex<=e.endIndex,a=e.startIndex<=t;n===a?n&&t>e.endIndex||!n&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(n&&t<e.endIndex||!n&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let n=0;if(e<t){const a=Math.ceil(e);let r=Math.floor(t);r===t&&(r-=1),n=r-a+1}else{const a=Math.floor(e);let r=Math.ceil(t);r===t&&(r+=1),n=a-r+1}n>0&&this.removeLastPoints_(n)}addTracedCoordinates_(e,t,n){if(t===n)return;const a=[];if(t<n){const r=Math.ceil(t);let s=Math.floor(n);s===n&&(s-=1);for(let o=r;o<=s;++o)a.push(le(e.coordinates,o))}else{const r=Math.floor(t);let s=Math.ceil(n);s===n&&(s+=1);for(let o=r;o>=s;--o)a.push(le(e.coordinates,o))}a.length&&this.appendCoordinates(a)}updateTrace_(e){const t=this.traceState_;if(!t.active)return;if(t.targetIndex===-1){const o=e.map.getPixelFromCoordinate(t.startCoord);if(ve(o,e.pixel)<this.snapTolerance_)return}const n=wn(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==n.index){if(t.targetIndex!==-1){const l=t.targets[t.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const o=t.targets[n.index];this.addTracedCoordinates_(o,o.startIndex,n.endIndex)}else{const o=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(o,n.endIndex)}t.targetIndex=n.index;const a=t.targets[t.targetIndex];a.endIndex=n.endIndex;const r=be(a.coordinates,a.endIndex),s=this.getMap().getPixelFromCoordinate(r);e.coordinate=r,e.pixel=[Math.round(s[0]),Math.round(s[1])]}handleDragEvent(e){this.ignoreNextUpEvent_=!0,super.handleDragEvent(e)}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const n=this.traceState_.active;if(this.ignoreNextUpEvent_||this.toggleTraceState_(e),this.shouldHandle_){const a=!this.finishCoordinate_;a&&this.startDrawing_(e.coordinate),!a&&this.freehand_?this.finishDrawing():!this.freehand_&&(!a||this.mode_==="Point")&&(this.atFinish_(e.pixel,n)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return this.ignoreNextUpEvent_=!1,!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,n=e.pixel,a=t[0]-n[0],r=t[1]-n[1],s=a*a+r*r;if(this.shouldHandle_=this.freehand_?s>this.squaredClickTolerance_:s<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let n=!1;if(this.sketchFeature_){let a=!1,r=[this.finishCoordinate_];const s=this.mode_;if(s==="Point")n=!0;else if(s==="Circle")n=this.sketchCoords_.length===2;else if(s==="LineString")a=!t&&this.sketchCoords_.length>this.minPoints_;else if(s==="Polygon"){const o=this.sketchCoords_;a=o[0].length>this.minPoints_,r=[o[0][0],o[0][o[0].length-2]],t?r=[o[0][0]]:r=[o[0][0],o[0][o[0].length-2]]}if(a){const o=this.getMap();for(let l=0,d=r.length;l<d;l++){const c=r[l],u=o.getPixelFromCoordinate(c),h=e[0]-u[0],p=e[1]-u[1],v=this.freehand_?1:this.snapTolerance_;if(n=Math.sqrt(h*h+p*p)<=v,n){this.finishCoordinate_=c;break}}}}return n}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new W(new ae(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new W);const t=e.getLinearRing(0);let n=this.sketchLine_.getGeometry();n?(n.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),n.changed()):(n=new Ae(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(n))}startDrawing_(e){const t=this.getMap().getView().getProjection(),n=Vt(this.geometryLayout_);for(;e.length<n;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new W(new Ae(this.sketchLineCoords_)));const a=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new W,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(a),this.updateSketchFeatures_(),this.dispatchEvent(new Je(Ke.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),n=this.sketchFeature_.getGeometry(),a=t.getView().getProjection(),r=Vt(this.geometryLayout_);let s,o;for(;e.length<r;)e.push(0);this.mode_==="Point"?o=this.sketchCoords_:this.mode_==="Polygon"?(s=this.sketchCoords_[0],o=s[s.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(s=this.sketchCoords_,o=s[s.length-1]),o[0]=e[0],o[1]=e[1],this.geometryFunction_(this.sketchCoords_,n,a),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),n.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(n):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection();let a,r;const s=this.mode_;return s==="LineString"||s==="Circle"?(this.finishCoordinate_=e.slice(),r=this.sketchCoords_,r.length>=this.maxPoints_&&(this.freehand_?r.pop():a=!0),r.push(e.slice()),this.geometryFunction_(r,t,n)):s==="Polygon"&&(r=this.sketchCoords_[0],r.length>=this.maxPoints_&&(this.freehand_?r.pop():a=!0),r.push(e.slice()),a&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,t,n)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),a?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),a=this.mode_;for(let r=0;r<e;++r){let s;if(a==="LineString"||a==="Circle"){if(s=this.sketchCoords_,s.splice(-2,1),s.length>=2){this.finishCoordinate_=s[s.length-2].slice();const o=this.finishCoordinate_.slice();s[s.length-1]=o,this.createOrUpdateSketchPoint_(o)}this.geometryFunction_(s,t,n),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(a==="Polygon"){s=this.sketchCoords_[0],s.splice(-2,1);const o=this.sketchLine_.getGeometry();if(s.length>=2){const l=s[s.length-2].slice();s[s.length-1]=l,this.createOrUpdateSketchPoint_(l)}o.setCoordinates(s),this.geometryFunction_(this.sketchCoords_,t,n)}if(s.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return null;let t=this.sketchCoords_;const n=e.getGeometry(),a=this.getMap().getView().getProjection();return this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,n,a)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,n,a),t=n.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new tn([t])):this.type_==="MultiLineString"?e.setGeometry(new It([t])):this.type_==="MultiPolygon"&&e.setGeometry(new Pt([t])),this.dispatchEvent(new Je(Ke.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new Je(Ke.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,n=!this.sketchFeature_;n&&this.startDrawing_(e[0]);let a;if(t==="LineString"||t==="Circle")a=this.sketchCoords_;else if(t==="Polygon")a=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;n&&a.shift(),a.pop();for(let s=0;s<e.length;s++)this.addToDrawing_(e[s]);const r=e[e.length-1];this.sketchFeature_=this.addToDrawing_(r),this.modifyDrawing_(r)}extend(e){const t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();const n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.sketchPoint_=new W(new ae(n)),this.updateSketchFeatures_(),this.dispatchEvent(new Je(Ke.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function yo(){const i=Mt();return function(e,t){return i[e.getGeometry().getType()]}}function _o(i){switch(i){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+i)}}const zt=0,Me=1,Yt=[0,0,0,0],Ce=[],mt={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};function yt(i,e,t){let n;switch(e){case"LineString":n=i;break;case"MultiLineString":case"Polygon":n=i[t[0]];break;case"MultiPolygon":n=i[t[1]][t[0]];break}return n}class _t extends Ne{constructor(e,t,n){super(e),this.features=t,this.mapBrowserEvent=n}}class vo extends Et{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:Zn,this.defaultDeleteCondition_=function(n){return Xn(n)&&Qt(n)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:xe,this.vertexFeature_=null,this.vertexSegments_=null,this.lastCoordinate_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new Qn,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Se({source:new pe({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:ko(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.traceSource_=e.traceSource||e.source||null,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSegments_=null,this.hitDetection_=null;let t;if(e.features?t=e.features:e.source&&(this.source_=e.source,t=new ke(this.source_.getFeatures()),this.source_.addEventListener(Ot.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(Ot.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(_e.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(_e.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}setTrace(e){let t;e?e===!0?t=xe:t=e:t=nt,this.traceCondition_=t}addFeature_(e){const t=e.getGeometry();if(t){const a=this.SEGMENT_WRITERS_[t.getType()];a&&a(e,t)}const n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastCoordinate_),e.addEventListener(St.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new ke;const n=this.featuresBeingModified_.getArray();for(let a=0,r=t.length;a<r;++a){const s=t[a].feature;s&&!n.includes(s)&&this.featuresBeingModified_.push(s)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new _t(mt.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(St.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,n=[];t.forEach(function(a){e===a.feature&&n.push(a)});for(let a=n.length-1;a>=0;--a){const r=n[a];for(let s=this.dragSegments_.length-1;s>=0;--s)this.dragSegments_[s][0]===r&&this.dragSegments_.splice(s,1);t.remove(r)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const n=t.getCoordinates(),a={feature:e,geometry:t,segment:[n,n]};this.rBush_.insert(t.getExtent(),a)}writeMultiPointGeometry_(e,t){const n=t.getCoordinates();for(let a=0,r=n.length;a<r;++a){const s=n[a],o={feature:e,geometry:t,depth:[a],index:a,segment:[s,s]};this.rBush_.insert(t.getExtent(),o)}}writeLineStringGeometry_(e,t){const n=t.getCoordinates();for(let a=0,r=n.length-1;a<r;++a){const s=n.slice(a,a+2),o={feature:e,geometry:t,index:a,segment:s};this.rBush_.insert(z(s),o)}}writeMultiLineStringGeometry_(e,t){const n=t.getCoordinates();for(let a=0,r=n.length;a<r;++a){const s=n[a];for(let o=0,l=s.length-1;o<l;++o){const d=s.slice(o,o+2),c={feature:e,geometry:t,depth:[a],index:o,segment:d};this.rBush_.insert(z(d),c)}}}writePolygonGeometry_(e,t){const n=t.getCoordinates();for(let a=0,r=n.length;a<r;++a){const s=n[a];for(let o=0,l=s.length-1;o<l;++o){const d=s.slice(o,o+2),c={feature:e,geometry:t,depth:[a],index:o,segment:d};this.rBush_.insert(z(d),c)}}}writeMultiPolygonGeometry_(e,t){const n=t.getCoordinates();for(let a=0,r=n.length;a<r;++a){const s=n[a];for(let o=0,l=s.length;o<l;++o){const d=s[o];for(let c=0,u=d.length-1;c<u;++c){const h=d.slice(c,c+2),p={feature:e,geometry:t,depth:[o,a],index:c,segment:h};this.rBush_.insert(z(h),p)}}}}writeCircleGeometry_(e,t){const n=t.getCenter(),a={feature:e,geometry:t,index:zt,segment:[n,n]},r={feature:e,geometry:t,index:Me,segment:[n,n]},s=[a,r];a.featureSegments=s,r.featureSegments=s,this.rBush_.insert(ht(n),a);let o=t;this.rBush_.insert(o.getExtent(),r)}writeGeometryCollectionGeometry_(e,t){const n=t.getGeometriesArray();for(let a=0;a<n.length;++a){const r=n[a],s=this.SEGMENT_WRITERS_[r.getType()];s(e,r)}}createOrUpdateVertexFeature_(e,t,n,a){let r=this.vertexFeature_;return r?r.getGeometry().setCoordinates(e):(r=new W(new ae(e)),this.vertexFeature_=r,this.overlay_.getSource().addFeature(r)),r.set("features",t),r.set("geometries",n),r.set("existing",a),r}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let t;return!e.map.getView().getInteracting()&&e.type==q.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=q.SINGLECLICK||!this.ignoreNextSingleClick_?t=this.removePoint():t=!0),e.type==q.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}findInsertVerticesAndUpdateDragSegments_(e){if(this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null,!this.vertexFeature_)return;this.getMap().getView().getProjection();const t=[],n=this.vertexFeature_.getGeometry().getCoordinates(),a=z([n]),r=this.rBush_.getInExtent(a),s={};r.sort(bo);for(let o=0,l=r.length;o<l;++o){const d=r[o],c=d.segment;let u=K(d.geometry);const h=d.depth;if(h&&(u+="-"+h.join("-")),s[u]||(s[u]=new Array(2)),d.geometry.getType()==="Circle"&&d.index===Me){const p=Kt(e,d);Q(p,n)&&!s[u][0]&&(this.dragSegments_.push([d,0]),s[u][0]=d);continue}if(Q(c[0],n)&&!s[u][0]){this.dragSegments_.push([d,0]),s[u][0]=d;continue}if(Q(c[1],n)&&!s[u][1]){if(s[u][0]&&s[u][0].index===0){let p=d.geometry.getCoordinates();switch(d.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":p=p[h[1]];case"Polygon":if(d.index!==p[h[0]].length-2)continue;break}}this.dragSegments_.push([d,1]),s[u][1]=d;continue}K(c)in this.vertexSegments_&&!s[u][0]&&!s[u][1]&&t.push(d)}return t}deactivateTrace_(){this.traceState_={active:!1}}updateTrace_(e){const t=this.traceState_;if(!t.active)return;if(t.targetIndex===-1){const r=e.map.getPixelFromCoordinate(t.startCoord);if(ve(r,e.pixel)<this.pixelTolerance_)return}const n=wn(e.coordinate,t,e.map,this.pixelTolerance_);if(t.targetIndex===-1&&Math.sqrt(n.closestTargetDistance)/e.map.getView().getResolution()>this.pixelTolerance_)return;if(t.targetIndex!==n.index){if(t.targetIndex!==-1){const s=t.targets[t.targetIndex];this.removeTracedCoordinates_(s.startIndex,s.endIndex)}else for(const s of this.traceSegments_){const o=s[0],l=o.geometry,d=s[1],c=l.getCoordinates();yt(c,l.getType(),o.depth).splice(o.index+d,1),l.setCoordinates(c),d===0&&(o.index-=1)}const r=t.targets[n.index];this.addTracedCoordinates_(r,r.startIndex,n.endIndex)}else{const r=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(r,n.endIndex)}t.targetIndex=n.index;const a=t.targets[t.targetIndex];a.endIndex=n.endIndex}getTraceCandidates_(e){const t=this.getMap(),n=this.pixelTolerance_,a=t.getCoordinateFromPixel([e.pixel[0]-n,e.pixel[1]+n]),r=t.getCoordinateFromPixel([e.pixel[0]+n,e.pixel[1]-n]),s=z([a,r]);return this.traceSource_.getFeaturesInExtent(s)}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_(),this.traceSegments_=null;return}const t=this.getTraceCandidates_(e);if(t.length===0)return;const n=Sn(e.coordinate,t);n.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:n,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const n=e.startIndex<=e.endIndex,a=e.startIndex<=t;n===a?n&&t>e.endIndex||!n&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(n&&t<e.endIndex||!n&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let n=0;if(e<t){const a=Math.ceil(e);let r=Math.floor(t);r===t&&(r-=1),n=r-a+1}else{const a=Math.floor(e);let r=Math.ceil(t);r===t&&(r+=1),n=a-r+1}if(n>0)for(const a of this.traceSegments_){const r=a[0],s=r.geometry,o=a[1];let l=a[0].index+1;o===1&&(l-=n);const d=s.getCoordinates();yt(d,s.getType(),r.depth).splice(l,n),s.setCoordinates(d),o===1&&(r.index-=n)}}addTracedCoordinates_(e,t,n){if(t===n)return;const a=[];if(t<n){const r=Math.ceil(t);let s=Math.floor(n);s===n&&(s-=1);for(let o=r;o<=s;++o)a.push(le(e.coordinates,o))}else{const r=Math.floor(t);let s=Math.ceil(n);s===n&&(s+=1);for(let o=r;o>=s;--o)a.push(le(e.coordinates,o))}if(a.length)for(const r of this.traceSegments_){const s=r[0],o=s.geometry,l=r[1],d=s.index+1;l===0&&a.reverse();const c=o.getCoordinates();yt(c,o.getType(),s.depth).splice(d,0,...a),o.setCoordinates(c),l===1&&(s.index+=a.length)}}updateGeometry_(e,t){const n=t[0],a=n.depth;let r;const s=n.segment,o=n.geometry,l=t[1];for(;e.length<o.getStride();)e.push(s[l][e.length]);switch(o.getType()){case"Point":r=e,s[0]=e,s[1]=e;break;case"MultiPoint":r=o.getCoordinates(),r[n.index]=e,s[0]=e,s[1]=e;break;case"LineString":r=o.getCoordinates(),r[n.index+l]=e,s[l]=e;break;case"MultiLineString":r=o.getCoordinates(),r[a[0]][n.index+l]=e,s[l]=e;break;case"Polygon":r=o.getCoordinates(),r[a[0]][n.index+l]=e,s[l]=e;break;case"MultiPolygon":r=o.getCoordinates(),r[a[1]][a[0]][n.index+l]=e,s[l]=e;break;case"Circle":const d=o;if(s[0]=e,s[1]=e,n.index===zt)this.changingFeature_=!0,d.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0,this.getMap().getView().getProjection();let c=ve(N(d.getCenter()),N(e));d.setRadius(c),this.changingFeature_=!1}break}r&&this.setGeometryCoordinates_(o,r)}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([s])=>s));const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],n=[],a=[],r=this.traceState_.active&&!this.traceSegments_?this.traceState_.startCoord:null;if(r){this.traceSegments_=[];for(const s of this.dragSegments_){const o=s[0];ve(nn(r,o.segment),r)/e.map.getView().getResolution()<1&&this.traceSegments_.push(s)}}for(let s=0,o=this.dragSegments_.length;s<o;++s){const l=this.dragSegments_[s],d=l[0],c=d.feature;n.includes(c)||n.push(c);const u=d.geometry;a.includes(u)||a.push(u),this.updateGeometry_(t,l)}this.updateTrace_(e),this.createOrUpdateVertexFeature_(t,n,a,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate,n=this.findInsertVerticesAndUpdateDragSegments_(t);if(n?.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,n),this.vertexFeature_)){const a=this.vertexFeature_.getGeometry().getCoordinates();for(let r=n.length-1;r>=0;--r)this.insertVertex_(n[r],a);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const n=this.dragSegments_[t][0],a=n.geometry;if(a.getType()==="Circle"){const r=a,s=r.getCenter(),o=n.featureSegments[0],l=n.featureSegments[1];o.segment[0]=s,o.segment[1]=s,l.segment[0]=s,l.segment[1]=s,this.rBush_.update(ht(s),o);let d=r;this.rBush_.update(d.getExtent(),l)}else this.rBush_.update(z(n.segment),n)}return this.featuresBeingModified_&&(this.toggleTraceState_(e),this.dispatchEvent(new _t(mt.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastCoordinate_=e.coordinate,this.handlePointerAtPixel_(this.lastCoordinate_)}handlePointerAtPixel_(e){const t=this.getMap(),n=t.getPixelFromCoordinate(e);t.getView().getProjection();const a=function(o,l){return qt(e,o)-qt(e,l)};let r,s;if(this.hitDetection_){const o=typeof this.hitDetection_=="object"?l=>l===this.hitDetection_:void 0;t.forEachFeatureAtPixel(n,(l,d,c)=>{c&&c.getType()==="Point"&&(c=new ae(at(c.getCoordinates())));const u=c||l.getGeometry();if(u&&u.getType()==="Point"&&l instanceof W&&this.features_.getArray().includes(l)){s=u;const h=l.getGeometry().getFlatCoordinates().slice(0,2);r=[{feature:l,geometry:s,segment:[h,h]}]}return!0},{layerFilter:o})}if(!r){const o=ei(ht(e,Yt)),l=t.getView().getResolution()*this.pixelTolerance_,d=ti(ni(o,l,Yt));r=this.rBush_.getInExtent(d)}if(r&&r.length>0){const o=r.sort(a)[0],l=o.segment;let d=Kt(e,o);const c=t.getPixelFromCoordinate(d);let u=ve(n,c);if(s||u<=this.pixelTolerance_){const h={};if(h[K(l)]=!0,this.snapToPointer_||(this.delta_[0]=d[0]-e[0],this.delta_[1]=d[1]-e[1]),o.geometry.getType()==="Circle"&&o.index===Me)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(d,[o.feature],[o.geometry],this.snappedToVertex_);else{const p=t.getPixelFromCoordinate(l[0]),v=t.getPixelFromCoordinate(l[1]),w=it(c,p),I=it(c,v);if(u=Math.sqrt(Math.min(w,I)),this.snappedToVertex_=u<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(d=w>I?l[1]:l[0]),this.createOrUpdateVertexFeature_(d,[o.feature],[o.geometry],this.snappedToVertex_);const g={};g[K(o.geometry)]=!0;for(let y=1,_=r.length;y<_;++y){const L=r[y].segment;if(Q(l[0],L[0])&&Q(l[1],L[1])||Q(l[0],L[1])&&Q(l[1],L[0])){const b=K(r[y].geometry);b in g||(g[b]=!0,h[K(L)]=!0)}else break}}this.vertexSegments_=h;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const n=e.segment,a=e.feature,r=e.geometry,s=e.depth,o=e.index;let l;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case"MultiLineString":l=r.getCoordinates(),l[s[0]].splice(o+1,0,t);break;case"Polygon":l=r.getCoordinates(),l[s[0]].splice(o+1,0,t);break;case"MultiPolygon":l=r.getCoordinates(),l[s[1]][s[0]].splice(o+1,0,t);break;case"LineString":l=r.getCoordinates(),l.splice(o+1,0,t);break;default:return!1}this.setGeometryCoordinates_(r,l);const d=this.rBush_;d.remove(e),this.updateSegmentIndices_(r,o,s,1);const c={segment:[n[0],t],feature:a,geometry:r,depth:s,index:o};d.insert(z(c.segment),c),this.dragSegments_.push([c,1]);const u={segment:[t,n[1]],feature:a,geometry:r,depth:s,index:o+1};return d.insert(z(u.segment),u),this.dragSegments_.push([u,0]),!0}updatePointer_(e){return e&&this.findInsertVerticesAndUpdateDragSegments_(e),this.vertexFeature_?.getGeometry().getCoordinates()}getPoint(){const e=this.vertexFeature_?.getGeometry().getCoordinates();return e?at(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(t=>t.getType()==="Circle"||t.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(z([e])).some(({segment:t})=>Q(t[0],e)||Q(t[1],e))}removePoint(e){if(e&&(e=N(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=q.POINTERDRAG){const t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_.map(([a])=>a));const n=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new _t(mt.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,n}return!1}removeVertex_(){const e=this.dragSegments_,t={};let n=!1,a,r,s,o,l,d,c,u,h,p,v;for(l=e.length-1;l>=0;--l)s=e[l],p=s[0],v=K(p.feature),p.depth&&(v+="-"+p.depth.join("-")),v in t||(t[v]={}),s[1]===0?(t[v].right=p,t[v].index=p.index):s[1]==1&&(t[v].left=p,t[v].index=p.index+1);for(v in t){switch(h=t[v].right,c=t[v].left,d=t[v].index,u=d-1,c!==void 0?p=c:p=h,u<0&&(u=0),o=p.geometry,r=o.getCoordinates(),a=r,n=!1,o.getType()){case"MultiLineString":r[p.depth[0]].length>2&&(r[p.depth[0]].splice(d,1),n=!0);break;case"LineString":r.length>2&&(r.splice(d,1),n=!0);break;case"MultiPolygon":a=a[p.depth[1]];case"Polygon":a=a[p.depth[0]],a.length>4&&(d==a.length-1&&(d=0),a.splice(d,1),n=!0,d===0&&(a.pop(),a.push(a[0]),u=a.length-1));break}if(n){this.setGeometryCoordinates_(o,r);const w=[];if(c!==void 0&&(this.rBush_.remove(c),w.push(c.segment[0])),h!==void 0&&(this.rBush_.remove(h),w.push(h.segment[1])),c!==void 0&&h!==void 0){const I={depth:p.depth,feature:p.feature,geometry:p.geometry,index:u,segment:w};this.rBush_.insert(z(I.segment),I)}this.updateSegmentIndices_(o,d,p.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return n}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(t=>t.getType()==="Circle"||t.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(z([e])).some(({segment:t})=>!(Q(t[0],e)||Q(t[1],e)))}insertPoint(e){const t=e?N(e,this.getMap().getView().getProjection()):this.vertexFeature_?.getGeometry().getCoordinates();return t?this.findInsertVerticesAndUpdateDragSegments_(t).reduce((n,a)=>n||this.insertVertex_(a,t),!1):!1}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,n,a){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(n===void 0||r.depth===void 0||Bi(r.depth,n))&&r.index>t&&(r.index+=a)})}}function bo(i,e){return i.index-e.index}function qt(i,e,t){const n=e.geometry;if(n.getType()==="Circle"){let r=n;if(e.index===Me){const s=it(r.getCenter(),N(i)),o=Math.sqrt(s)-r.getRadius();return o*o}}const a=N(i);return Ce[0]=N(e.segment[0]),Ce[1]=N(e.segment[1]),hi(a,Ce)}function Kt(i,e,t){const n=e.geometry;if(n.getType()==="Circle"&&e.index===Me)return at(n.getClosestPoint(N(i)));const a=N(i);return Ce[0]=N(e.segment[0]),Ce[1]=N(e.segment[1]),at(nn(a,Ce))}function ko(){const i=Mt();return function(e,t){return i.Point}}const Ze={SELECT:"select"};class Xe extends Ne{constructor(e,t,n,a){super(e),this.selected=t,this.deselected=n,this.mapBrowserEvent=a}}const Qe={};class Dt extends qn{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:Qt,this.addCondition_=e.addCondition?e.addCondition:nt,this.removeCondition_=e.removeCondition?e.removeCondition:nt,this.toggleCondition_=e.toggleCondition?e.toggleCondition:xt,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:De,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:xo(),this.features_=e.features||new ke;let t;if(e.layers)if(typeof e.layers=="function")t=e.layers;else{const n=e.layers;t=function(a){return n.includes(a)}}else t=De;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[K(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[K(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(_e.ADD,this.boundAddFeature_),this.features_.addEventListener(_e.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(_e.ADD,this.boundAddFeature_),this.features_.removeEventListener(_e.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const n=this.findLayerOfFeature_(t);n&&this.addFeatureLayerAssociation_(t,n)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}findLayerOfFeature_(e){return this.getMap().getAllLayers().find(function(t){if(t instanceof Se&&t.getSource()&&t.getSource().hasFeature(e))return t})}getStyle(){return this.style_}applySelectedStyle_(e){const t=K(e);t in Qe||(Qe[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let a=t.length-1;a>=0;--a){const r=t[a];if(r!==this&&r instanceof Dt&&r.getStyle()&&r.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(r.getStyle());return}}const n=K(e);e.setStyle(Qe[n]),delete Qe[n]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[K(e)]}selectFeatureInternal_(e,t,n){if(!(e instanceof W)||!this.filter_(e,t))return;const a=this.getFeatures();return a.getArray().includes(e)||(this.addFeatureLayerAssociation_(e,t),a.push(e),n?.push(e)),e}selectFeature(e){const t=this.findLayerOfFeature_(e);if(!this.layerFilter_(t))return!1;const n=this.selectFeatureInternal_(e,t);return n&&this.dispatchEvent(new Xe(Ze.SELECT,[n],[],void 0)),!!n}removeFeatureInternal_(e,t){const n=this.getFeatures();if(!(!(e instanceof W)||!n.getArray().includes(e)))return n.remove(e),this.removeFeatureLayerAssociation_(e),t?.push(e),e}deselectFeature(e){const t=this.removeFeatureInternal_(e);return t&&this.dispatchEvent(new Xe(Ze.SELECT,[],[t],void 0)),!!t}toggleFeature(e){this.deselectFeature(e)||this.selectFeature(e)}clearSelection(){Vi(this.featureLayerAssociation_);const e=this.getFeatures(),t=e.getArray().slice();e.clear(),t.length!==0&&this.dispatchEvent(new Xe(Ze.SELECT,[],t,void 0))}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),n=this.removeCondition_(e),a=this.toggleCondition_(e),r=!t&&!n&&!a,s=e.map,o=this.getFeatures(),l=[],d=[];if(r){let c=!1;s.forEachFeatureAtPixel(e.pixel,(u,h)=>{if(c=!0,!!this.selectFeatureInternal_(u,h,d))return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let u=o.getLength()-1;u>=0;--u){const h=o.item(u);(d.length>0&&!d.includes(h)||!c)&&this.removeFeatureInternal_(h,l)}}else s.forEachFeatureAtPixel(e.pixel,(c,u)=>{let h;if((n||a)&&(h=this.removeFeatureInternal_(c,l)),(t||a)&&!h&&(h=this.selectFeatureInternal_(c,u,d)),!!h)return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});return(d.length>0||l.length>0)&&this.dispatchEvent(new Xe(Ze.SELECT,d,l,e)),!0}}function xo(){const i=Mt();return Nt(i.Polygon,i.LineString),Nt(i.GeometryCollection,i.LineString),function(e){return e.getGeometry()?i[e.getGeometry().getType()]:null}}const vt={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};class bt extends Ne{constructor(e,t,n,a,r){super(e),this.features=t,this.coordinate=n,this.startCoordinate=a,this.mapBrowserEvent=r}}class Co extends Et{constructor(e){e=e||{},super(e),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=e.features!==void 0?e.features:null;let t;if(e.layers&&!this.features_)if(typeof e.layers=="function")t=e.layers;else{const n=e.layers;t=function(a){return n.includes(a)}}else t=De;this.layerFilter_=t,this.filter_=e.filter&&!this.features_?e.filter:De,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.condition_=e.condition?e.condition:xe,this.lastFeature_=null,this.addChangeListener(en.ACTIVE,this.handleActiveChanged_)}handleDownEvent(e){if(!e.originalEvent||!this.condition_(e))return!1;if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=e.coordinate,this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);const t=this.features_||new ke([this.lastFeature_]);return this.dispatchEvent(new bt(vt.TRANSLATESTART,t,e.coordinate,this.startCoordinate_,e)),!0}return!1}handleUpEvent(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);const t=this.features_||new ke([this.lastFeature_]);return this.dispatchEvent(new bt(vt.TRANSLATEEND,t,e.coordinate,this.startCoordinate_,e)),this.startCoordinate_=null,!0}return!1}handleDragEvent(e){if(this.lastCoordinate_){const t=e.coordinate;e.map.getView().getProjection();const n=N(t),a=N(this.lastCoordinate_),r=n[0]-a[0],s=n[1]-a[1],o=this.features_||new ke([this.lastFeature_]);o.forEach(function(l){const d=l.getGeometry();d.translate(r,s),l.setGeometry(d)}),this.lastCoordinate_=t,this.dispatchEvent(new bt(vt.TRANSLATING,o,t,this.startCoordinate_,e))}}handleMoveEvent(e){const t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(e,t){return t.forEachFeatureAtPixel(e,(n,a)=>{if(!(!(n instanceof W)||!this.filter_(n,a))&&!(this.features_&&!this.features_.getArray().includes(n)))return n},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(e){this.hitTolerance_=e}setMap(e){const t=this.getMap();super.setMap(e),this.updateState_(t)}handleActiveChanged_(){this.updateState_(null)}updateState_(e){let t=this.getMap();const n=this.getActive();(!t||!n)&&(t=t||e,t&&t.getViewport().classList.remove("ol-grab","ol-grabbing"))}}const wo=(i,e,t)=>{if(t){const n=new DOMParser().parseFromString(t,"image/svg+xml");return n.querySelectorAll("[fill]").forEach(a=>{a.setAttribute("fill",i)}),n.querySelectorAll("[stroke]").forEach(a=>{a.setAttribute("stroke",e)}),n.querySelectorAll("path, circle, rect, polygon, ellipse").forEach(a=>{a.hasAttribute("fill")||a.setAttribute("fill",i),a.hasAttribute("stroke")||a.setAttribute("stroke",e)}),new XMLSerializer().serializeToString(n)}return`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="-1 -1 25 25"
  >
    <path
      d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 0 1 0-5 2.5 2.5 0 0 1 0 5z"
      fill="${i}"
      stroke="${e}"
      stroke-width="1"
    />
  </svg>
`},So=({fill:i="#005CA9",stroke:e="#FFF",svg:t})=>{let n="";typeof i=="string"?n=i:"oklch"in i?n=`oklch(${i.oklch.l} ${i.oklch.c} ${i.oklch.h})`:"rgba"in i&&(n=`${i.rgba.r} ${i.rgba.g} ${i.rgba.b} ${i.rgba.a?i.rgba.a:""}`);let a="";return typeof e=="string"?a=e:"oklch"in e?a=`oklch(${e.oklch.l} ${e.oklch.c} ${e.oklch.h})`:"rgba"in e&&(a=`${e.rgba.r} ${e.rgba.g} ${e.rgba.b} ${e.rgba.a?e.rgba.a:""}`),new rt({image:new Yn({src:`data:image/svg+xml;base64,${btoa(wo(n,a,t))}`,scale:2,anchor:[.5,1]})})},To={Circle:We,LinearRing:ii,LineString:Ae,MultiLineString:It,MultiPoint:tn,MultiPolygon:Pt,Point:ae,Polygon:Ft};function Lo(i,e,t,n){const a=new To[t](n);let r=ai(a.getExtent());return(t==="Polygon"||t==="MultiPolygon")&&!a.intersectsCoordinate(r)&&(r=(a.getType()==="Polygon"?a.getInteriorPoint():a.getInteriorPoints()).getFirstCoordinate()),i===e?r:Zt(r,i,e)}async function Jt(i,e,t){if(!t)return!0;const n=await hn(e,t.layerId,i);return n===!0||typeof n=="symbol"&&t.onError!=="strict"?!0:(typeof n=="symbol"?(Fe("error",()=>ie(a=>a.boundaryError,{ns:"pins"})),console.error(`@polar/polar(plugins/pins/utils/isCoordinateInBoundaryLayer:39:3)
`,"Checking boundary layer failed.")):(Fe("info",()=>ie(a=>a.notInBoundary,{ns:"pins"})),console.info(`@polar/polar(plugins/pins/utils/isCoordinateInBoundaryLayer:43:3)
`,"Pin position outside of boundary layer:",i)),!1)}const $o=me("plugins/pins",()=>{const i=X(),e=P(null),t=P(!1),n=$(()=>se({minZoomLevel:0,movable:"none",toZoomLevel:0},i.configuration.pins||{})),a=$(()=>{if(!e.value)return null;const g=zn(e.value,i.configuration.epsg);return[g[1],g[0]]}),r=new Se({source:new pe,style:So(n.value.style||{})}),s=new Dt({layers:g=>g===r,style:null,condition:jn}),o=new Co({condition:()=>i.map.getView().getZoom()>=n.value.minZoomLevel,layers:[r]});let l=null;function d(){i.map.addLayer(r),r.setZIndex(100),i.map.on("singleclick",async({coordinate:g})=>{await v(g)}),u(),h(),p()}function c(){const{map:g}=i;g.un("singleclick",async({coordinate:y})=>{await v(y)}),I(),g.removeLayer(r),g.removeInteraction(s),g.removeInteraction(o),l&&l()}function u(){const{coordinateSources:g}=n.value;g&&g.forEach(y=>{const _=i.getPluginStore(y.pluginName);_&&(l=we(()=>_[y.getterName],L=>{L&&L.type!=="reverse_geocoded"&&w(L.geometry.coordinates,!1,{epsg:L.epsg,type:L.geometry.type})}))})}function h(){const{initial:g}=n.value;if(g){const{coordinate:y,centerOn:_,epsg:L}=g;if(_){w(y,!1,{epsg:L||i.configuration.epsg,type:"Point"});return}w(y)}}function p(){s.on("select",({selected:y})=>{n.value.movable==="none"&&(document.body.style.cursor=y.length?"not-allowed":"")}),i.map.addInteraction(s);const{movable:g}=n.value;g==="drag"&&(o.on("translatestart",()=>t.value=!0),o.on("translateend",({features:y})=>{t.value=!1,y.forEach(async _=>{const L=_.getGeometry().getCoordinates(),b=await Jt(L,i.map,n.value.boundary)?L:e.value;b&&w(b)})}),i.map.addInteraction(o))}async function v(g){const y=i.map.getInteractions().getArray().some(b=>b instanceof mo&&(b._isMultiSelect||b._isDrawPlugin)||b instanceof vo||b._isDeleteSelect),{minZoomLevel:_,movable:L}=n.value;(L==="drag"||L==="click")&&i.map.getView().getZoom()>=_&&!y&&await Jt(g,i.map,n.value.boundary)&&w(g)}function w(g,y=!0,_){I(),e.value=g,!y&&_&&(e.value=Lo(_.epsg,i.configuration.epsg,_.type,g),i.map.getView().setCenter(e.value),i.map.getView().setZoom(n.value.toZoomLevel)),r.getSource().addFeature(new W({geometry:new ae(e.value),type:"point",name:"mapMarker",zIndex:100}))}function I(){r.getSource().clear()}return{coordinate:e,latLon:a,setupPlugin:d,teardownPlugin:c}}),Eo={boundaryError:"Die Überprüfung der Koordinate ist fehlgeschlagen. Bitte versuchen Sie es später erneut oder wenden Sie sich an einen Administrator, wenn das Problem bestehen bleibt.",notInBoundary:"Diese Koordinate kann nicht gewählt werden."},Io={boundaryError:"Validating the coordinate failed. Please try again later or contact an administrator if the issue persists.",notInBoundary:"It is not possible to select this coordinate."},Po=[{type:"de",resources:Eo},{type:"en",resources:Io}],Fo="pins";function Ao(i){return{id:Fo,locales:Po,storeModule:$o,options:i}}const Rt="reverseGeocoder",$n=me("plugins/reverseGeocoder",()=>{const i=X(),e=$(()=>i.configuration[Rt]),t=P([]);function n(){for(const o of e.value.coordinateSources||[]){const l=o.plugin?i.getPluginStore(o.plugin):i;l&&t.value.push(we(()=>l[o.key],async d=>{d&&await s(d)},{immediate:!0}))}}function a(){t.value.forEach(o=>{o()})}function r(o,l){const d=o.plugin?i.getPluginStore(o.plugin):i;d&&(d[o.key]=l)}async function s(o){const l=Gi();try{const d=await Ni(e.value.url,o);return e.value.addressTarget&&r(e.value.addressTarget,d),e.value.zoomTo&&i.map.getView().fit(new ae(o),{maxZoom:e.value.zoomTo,duration:400,easing:gi}),d}catch(d){return console.error(`@polar/polar(plugins/reverseGeocoder/store:102:5)
`,"Reverse geocoding failed:",d),null}finally{l()}}return{reverseGeocode:s,setupPlugin:n,teardownPlugin:a}});if(import.meta.vitest){const{expect:i,test:e,vi:t}=import.meta.vitest,{createPinia:n,setActivePinia:a}=await ce(async()=>{const{createPinia:c,setActivePinia:u}=await import("./pinia-CbxOPHy1-Ds7GYo7H.js");return{createPinia:c,setActivePinia:u}},__vite__mapDeps([4,5]),import.meta.url),{reactive:r}=await ce(async()=>{const{reactive:c}=await import("./vue.runtime.esm-bundler-x5GycwNE-C2i-EXPZ.js");return{reactive:c}},[],import.meta.url),s=await ce(()=>import("./Feature-DNujdKX6-DPKx2Wrc.js").then(c=>c.s),__vite__mapDeps([3,4,5,6,1]),import.meta.url),o=await ce(()=>import("./reverseGeocode-DMu2C9hG-OuZRICI0.js"),__vite__mapDeps([7,8]),import.meta.url),l=await ce(()=>import("./indicateLoading-D-j3Jp1s-b41NEvCz.js"),__vite__mapDeps([9,6,4,5]),import.meta.url),d=e.extend({reverseGeocodeUtil:[async({},c)=>{const u=t.spyOn(o,"reverseGeocode").mockResolvedValue(null);await c(u)},{auto:!0}],indicateLoading:[async({},c)=>{const u=t.spyOn(l,"indicateLoading").mockImplementation(()=>()=>{});await c(u)},{auto:!0}],coreStore:[async({},c)=>{const u=t.fn(),h=r({configuration:{[Rt]:{url:"https://wps.example",coordinateSources:[{key:"coordinateSource"}],addressTarget:{key:"addressTarget"},zoomTo:99}},map:{getView:()=>({fit:u})},coordinateSource:null,addressTarget:null});t.spyOn(s,"useCoreStore").mockReturnValue(h),await c(h)},{auto:!0}],store:[async({},c)=>{a(n());const u=$n();u.setupPlugin(),await c(u),u.teardownPlugin()},{auto:!0}]});d("detects changes in coordinate sources",async({reverseGeocodeUtil:c,coreStore:u})=>{u.coordinateSource=[1,2],await new Promise(h=>setTimeout(h)),i(c).toHaveBeenCalledWith("https://wps.example",[1,2])}),d("passes geocoding result to address target",async({reverseGeocodeUtil:c,coreStore:u,store:h})=>{const p=Symbol("feature");c.mockResolvedValueOnce(p),await h.reverseGeocode([3,4]),i(u.addressTarget).toBe(p)}),d("zooms to input coordinate",async({reverseGeocodeUtil:c,coreStore:u,store:h})=>{const p=Symbol("feature");c.mockResolvedValueOnce(p),await h.reverseGeocode([3,4]),i(u.map.getView().fit).toHaveBeenCalledOnce()})}function Mo(i){return{id:Rt,storeModule:$n,options:i}}const Do={style:{background:"#fff"}},Ro=Re({__name:"EmptyComponent",setup(i){return(e,t)=>(Oe(),Ve("div",Do,"HELLO THERE"))}}),Vo={class:"kern-btn kern-btn--tertiary",style:{"border-radius":"0.25rem","min-height":"2rem",width:"2rem"}},Oo=Re({__name:"MockAttributions.ce",setup(i){return(e,t)=>(Oe(),Ve("button",Vo,[...t[0]||(t[0]=[ue("span",{class:"kern-icon kern-icon-fill--copyright",style:{color:"var(--kern-color-action-default)"}},null,-1)])]))}}),Bo={style:{display:"flex",gap:"0.5rem"}},Go=Re({__name:"MockPointerPosition.ce",setup(i){return(e,t)=>(Oe(),Ve("div",Bo,[...t[0]||(t[0]=[ue("span",{class:"kern-icon kern-icon--fullscreen","aria-hidden":"true"},null,-1),ue("span",{style:{display:"flex","align-items":"center"}},"9.9555 | 53.5479",-1),ue("button",{class:"kern-btn kern-btn--tertiary",style:{"min-height":"1rem","font-size":"1.125rem","text-decoration-line":"underline","text-underline-offset":"2px","text-underline-position":"from-font",color:"#1a3da5"}}," EPSG:4326 ",-1)])]))}}),No={style:{display:"flex","align-items":"center",gap:"0.5rem"}},Uo=Re({__name:"MockScale.ce",setup(i){return(e,t)=>(Oe(),Ve("div",No,[...t[0]||(t[0]=[ue("span",{style:{color:"#404565"}},"1 : 4.000.000",-1),ue("span",{style:{color:"#171a2b","font-weight":"500"}},"4 km",-1),ue("span",{style:{width:"1.5rem",height:"0.75rem","border-radius":"0 0 0.125rem 0.125rem","border-right":"1px solid#171a2b","border-bottom":"1px solid #171a2b","border-left":"1px solid #171a2b"}},null,-1)])]))}}),Ho=[{id:"23420",name:"basemap.de Web Raster Farbe",url:"https://sgx.geodatenzentrum.de/wms_basemapde",typ:"WMS",layers:"de_basemapde_web_raster_farbe",format:"image/png",version:"1.3.0",singleTile:!1,transparent:!0,transparency:0,urlIsVisible:!0,tilesize:512,gutter:0,minScale:"0",maxScale:"2500000",legendURL:"",cache:!1,featureCount:5},{id:"23421",name:"basemap.de Web Raster Grau",url:"https://sgx.geodatenzentrum.de/wms_basemapde",typ:"WMS",layers:"de_basemapde_web_raster_grau",format:"image/png",version:"1.3.0",singleTile:!1,transparent:!0,transparency:0,urlIsVisible:!0,tilesize:512,gutter:0,minScale:"0",maxScale:"2500000",legendURL:"",cache:!1,featureCount:5},{id:"1454",name:"Ausgleichsflächen",url:"https://geodienste.hamburg.de/HH_WFS_Ausgleichsflaechen",typ:"WFS",featureType:"ausgleichsflaechen",outputFormat:"XML",version:"1.1.0",featureNS:"https://registry.gdi-de.org/id/de.hh.up",featurePrefix:"de.hh.up",legendURL:""},{id:"6059",name:"MML Anliegen",url:"https://geodienste.hamburg.de/lgv-config/anliegen_extern.json",typ:"GeoJSON",format:"XML",version:"1.0",minScale:"0",maxScale:"2500000",legendURL:"",urlIsVisible:!0},{id:"denkmaelerWMS",name:"Denkmal WMS",url:"https://efi2-deegree.schleswig-holstein.de/dish-deegree/services/wms_shp",typ:"WMS",layers:"0,1,2,3,4,6,24,25",legendURL:"ignore",format:"image/png",version:"1.3.0",transparent:!0}],Wo="data:application/json;base64,WwoJewoJCSJzdHlsZUlkIjogInBhbmRhIiwKCQkicnVsZXMiOiBbCgkJCXsKCQkJCSJzdHlsZSI6IHsKCQkJCQkicG9seWdvblN0cm9rZUNvbG9yIjogWzMsIDI1NSwgMSwgMV0sCgkJCQkJInBvbHlnb25GaWxsSGF0Y2giOiB7CgkJCQkJCSJiYWNrZ3JvdW5kQ29sb3IiOiBbMCwgMCwgMCwgMC4yNV0sCgkJCQkJCSJwYXR0ZXJuIjogImRpYWdvbmFsLXJpZ2h0IiwKCQkJCQkJInBhdHRlcm5Db2xvciI6IFszLCAyNTUsIDEsIDFdCgkJCQkJfQoJCQkJfQoJCQl9CgkJXQoJfQpdCg==",jo={style:{background:"#fff"}},zo=Re({__name:"YetAnotherEmptyComponent",setup(i){return(e,t)=>(Oe(),Ve("div",jo,"Awesome"))}}),En="23420",Yo="23421",qo="1454",et="6059",Ko="denkmaelerWMS",In="1693";let Pe="light";const ee=await pi("snowbox",{colorScheme:Pe,startCenter:[573364,6028874],layers:[{id:En,visibility:!0,type:"background",name:"Basemap.de (Farbe)"},{id:Yo,type:"background",name:"Basemap.de (Grau)",maxZoom:6},{id:In,visibility:!0,hideInMenu:!0,type:"mask",name:"meldemichel.layers.hamburgBorder"},{id:et,type:"mask",name:"Anliegen (MML)",visibility:!1},{id:qo,type:"mask",name:"Ausgleichsflächen",styleId:"panda",visibility:!0,minZoom:5},{id:Ko,type:"mask",name:"Kulturdenkmale",visibility:!0,options:{layers:{order:"6,24,25,4,3,2,1,0",title:{6:"Denkmalbereich",24:"Mehrheit von baulichen Anlagen",25:"Sachgesamtheit",4:"Baudenkmal",3:"Gründenkmal",2:"Gewässer",1:"Baudenkmal (Fläche)",0:"Gründenkmal (Fläche)"},legend:!0}}}],layout:"standard",checkServiceAvailability:!0,featureStyles:Wo,markers:{layers:[{id:et,defaultStyle:{stroke:"#FFFFFF",fill:"#005CA9"},hoverStyle:{stroke:"#46688E",fill:"#8BA1B8"},selectionStyle:{stroke:"#FFFFFF",fill:"#E10019"},unselectableStyle:{stroke:"#FFFFFF",fill:"#333333"}}],clusterClickZoom:!0},locales:[{type:"de",resources:{filter:{layer:{[et]:{category:{skat:{title:"Schadensart",knownValue:{100:"Wege und Straßen",101:"Schlagloch und Wegeschaden",102:"Verunreinigung und Vandalismus"}},statu:{title:"Bearbeitungsstatus",knownValue:{"In Bearbeitung":"In Bearbeitung",abgeschlossen:"Abgeschlossen"}}}}}},fullscreen:{button:{label_on:"Mach groß",label_off:"Mach klein"}},iconMenu:{hints:{attributions:"LMAO",fullscreen:"BEEEEEG YOSHEEEEE"}}}}]},Ho);document.getElementById("secondMap").addEventListener("click",async()=>{const i=await fi({layers:[{id:En,visibility:!0,type:"background",name:"snowbox.layers.basemap"}]},"https://geodienste.hamburg.de/services-internet.json");i.classList.add("snowbox"),document.getElementById("secondMapContainer").appendChild(i),fe(i,sn({layoutTag:"TOP_RIGHT"}))});document.getElementById("secondMapClean").addEventListener("click",()=>{document.getElementById("secondMapContainer").innerText=""});fe(ee,yi({displayComponent:!0,layoutTag:"BOTTOM_MIDDLE"}));fe(ee,fo({loaderStyle:"BasicLoader"}));fe(ee,Ao({boundary:{layerId:In},movable:"drag",style:{fill:"#FF0019"},toZoomLevel:7}));fe(ee,Mo({url:"https://geodienste.hamburg.de/HH_WPS",coordinateSources:[{plugin:"pins",key:"coordinate"}],addressTarget:{plugin:"addressSearch",key:"selectResult"},zoomTo:7}));fe(ee,_i({displayComponent:!0,layoutTag:"TOP_RIGHT",initiallyOpen:"layerChooser",focusMenus:[{plugin:{component:zo,id:"attributions",locales:[]},icon:"kern-icon--near-me"}],menus:[[{plugin:or({checkLocationInitially:!1,keepCentered:!1,showTooltip:!0,zoomLevel:7})}],[{plugin:{component:Ro,id:"realKewl",locales:[]},icon:"kern-icon-fill--share"}],[{plugin:Pa({layers:{[et]:{categories:[{targetProperty:"skat",knownValues:[{value:"100",icon:"kern-icon--road"},{value:"101",icon:"kern-icon--remove-road"},{value:"102",icon:"kern-icon--destruction"}],selectAll:!0},{targetProperty:"statu",knownValues:[{value:"In Bearbeitung",icon:"kern-icon--assignment"},{value:"abgeschlossen",icon:"kern-icon--check"}]}],time:{targetProperty:"start",freeSelection:"until",last:[0,7,30],pattern:"YYYYMMDD"}}}})}],[{plugin:Ds({})},{plugin:sn({})}]]}));fe(ee,Ga({leftEntries:[{id:"mockPointer",component:Go}],rightEntries:[{id:"mockScale",component:Uo},{id:"mockAttributions",component:Oo}]}));const Pn=an(ee,"toast");Pn.addToast({text:"Hallo Welt",severity:"info"});Pn.addToast({text:"Achtung! Dies ist ein Toast!",severity:"error"});const Fn=an(ee,"loadingIndicator");Fn.addLoadingKey("loadingTest");setTimeout(()=>Fn.removeLoadingKey("loadingTest"),2e3);mi(ee,"core","selectedCoordinates",i=>document.getElementById("selected-feature-coordinates").innerText=JSON.stringify(i));document.getElementById("language-switcher").addEventListener("change",i=>{const e=i.target,{value:t}=e;rn(ee,"core","language",t),e[0].innerHTML=t==="en"?"English":"Englisch",e[1].innerHTML=t==="en"?"German":"Deutsch"});document.getElementById("color-scheme-switcher").addEventListener("click",({target:i})=>{i.innerHTML=`Switch to ${Pe} mode`,Pe=Pe==="light"?"dark":"light",rn(ee,"core","colorScheme",Pe)});
