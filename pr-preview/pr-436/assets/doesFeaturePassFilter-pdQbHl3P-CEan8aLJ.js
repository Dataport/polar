import{V as h,p as m,c as y,L as l,F as u}from"./asserts-C1UfHExR-pcJD3tIw.js";let c=class i extends h{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new i(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const n=this.getStyle();return n&&e.setStyle(n),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(m(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=y(e,l.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?g(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function g(r){if(typeof r=="function")return r;let e;return Array.isArray(r)?e=r:(u(typeof r.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[r]),function(){return e}}function o(r,e){const t=Object.fromEntries(["Y","M","D"].map(n=>[n,""]));return e.split("").forEach((n,a)=>{n in t&&typeof t[n]=="string"&&(t[n]+=r[a]||"")}),new Date(Number(t.Y),Number(t.M)-1,Number(t.D))}if(import.meta.vitest){const{expect:r,test:e}=import.meta.vitest;e.for([{date:"2025-07-01",pattern:"YYYY-MM-DD",expected:new Date("Jul 1, 2025")},{date:"202-521-12X",pattern:"YYY-YDM-MD-",expected:new Date("Nov 22, 2025")},{date:"2026-01",pattern:"YYYY-MM-DD",expected:new Date("Dec 31, 2025")}])("parseDateWithPattern works as expected",({date:t,pattern:n,expected:a})=>{r(o(t,n)).toEqual(a)})}function s(r,e){return!(e.knownValues&&!Object.entries(e.knownValues).every(([t,n])=>n[r.get(t)])||e.timeSpan&&!Object.entries(e.timeSpan).every(([t,n])=>{const a=o(r.get(t),n.pattern);return a>=n.from&&a<n.until}))}if(import.meta.vitest){const{expect:r,test:e}=import.meta.vitest,t=new c;t.set("category","blue"),t.set("time","2025-01-01"),e("a feature passes an empty filter",()=>{r(s(t,{})).toBeTruthy()}),e("a feature passes the category filter",()=>{r(s(t,{knownValues:{category:{blue:!0}}})).toBeTruthy()}),e("a feature fails the category filter",()=>{r(s(t,{knownValues:{category:{red:!0}}})).toBeFalsy()}),e("a feature passes the time filter",()=>{r(s(t,{timeSpan:{time:{pattern:"YYYY-MM-DD",from:new Date("Jan 1, 2024"),until:new Date("Dec 31, 2026")}}})).toBeTruthy()}),e("a feature fails the time filter",()=>{r(s(t,{timeSpan:{time:{pattern:"YYYY-MM-DD",from:new Date("Jan 1, 2024"),until:new Date("Dec 31, 2024")}}})).toBeFalsy()}),e("a feature fails one out of two filters",()=>{r(s(t,{knownValues:{category:{blue:!0},misc:{yes:!0}}})).toBeFalsy()})}const p=Object.freeze(Object.defineProperty({__proto__:null,doesFeaturePassFilter:s},Symbol.toStringTag,{value:"Module"}));export{p as d,c as i,s};
