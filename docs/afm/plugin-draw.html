<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
  <title>ðŸ§ŠðŸ“š POLAR Documentation</title>
	<link rel="stylesheet" href="./github-markdown.css">
  <style>
    body {
      box-sizing: border-box;
      min-width: 200px;
      max-width: 980px;
      margin: 0 auto;
      padding: 45px;
    }
    @media (prefers-color-scheme: dark) {
      html {
        background-color: #0d1117;
      }
    }
  </style>
</head>
<body>
  <article class="markdown-body">
    <h1 id="draw" tabindex="-1">Draw</h1>
<h2 id="scope" tabindex="-1">Scope</h2>
<p>The draw plugin allows users to draw features on the map. Drawn features may be edited and deleted.</p>
<p>Currently supported OpenLayers geometry types:</p>
<ul>
<li><code>'Circle''</code></li>
<li><code>'LineString'</code></li>
<li><code>'Point'</code></li>
<li><code>'Polygon'</code></li>
</ul>
<p>Also, <code>'Text'</code> is supported which is modeled as an OpenLayers <code>'Point'</code>. This is no default feature, so it must be specified in the configuration to use it.</p>
<h2 id="user-instructions-for-text-mode" tabindex="-1">User instructions for Text Mode</h2>
<p>The interaction with text features is not intuitive, which is why the text feature should come with instructions for the users:</p>
<h3 id="edit" tabindex="-1">Edit</h3>
<p>To edit the text or the placement of the text feature, the user must click on the center of the text to select the point geometry below it. After selecting it, the user can move the point by keeping the left mouse button pressed, or edit the text in the input field that opens with selecting the feature. If more than one text size is specified in the configuration, the user can change the text size with a slider.</p>
<h3 id="delete" tabindex="-1">Delete</h3>
<p>To delete the text, the user must either click on the point at the center of the text or use CTRL + left mouse button to open a box over all features that he or she wants to delete.</p>
<h2 id="configuration" tabindex="-1">Configuration</h2>
<p>The styling of the drawn features can be configured to overwrite the default ol-style. Configuration is oriented around the <a href="https://openlayers.org/en/latest/apidoc/module-ol_style_Style.html#~StyleLike">OpenLayers styles</a>.</p>
<h3 id="draw-1" tabindex="-1">draw</h3>
<table>
<thead>
<tr>
<th>fieldName</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>enableOptions</td>
<td>boolean?</td>
<td>If <code>true</code>, draw options are displayed, like choosing and changing stroke color. Not available for texts features. Defaults to <code>false</code>.</td>
</tr>
<tr>
<td>measureOptions</td>
<td>measureOptions?</td>
<td>If set, an additional radio is being shown to the user to be able to let the (then) drawn features display their length and / or area. See <a href="#drawmeasureoptions">draw.measureOptions</a> for further information. Not shown by default.</td>
</tr>
<tr>
<td>selectableDrawModes</td>
<td>string[]?</td>
<td>List 'Point', 'LineString', 'Circle', 'Text' and/or 'Polygon' as desired. All besides 'Text' are selectable by default.</td>
</tr>
<tr>
<td>style</td>
<td>style?</td>
<td>Please see example below for styling options. Defaults to standard OpenLayers styling.</td>
</tr>
<tr>
<td>textStyle</td>
<td>textStyle?</td>
<td>Use this object with properties 'font' and 'textColor' to style text feature.</td>
</tr>
</tbody>
</table>
<p>For details on the <code>displayComponent</code> attribute, refer to the <a href="https://dataport.github.io/polar/docs/afm/core.html#global-plugin-parameters">Global Plugin Parameters</a> section of <code>@polar/core</code>.</p>
<details>
<summary>Example configuration</summary>
<pre><code class="language-js">draw: {
  selectableDrawModes: ['Circle', 'LineString', 'Point', 'Polygon', 'Text'],
  textStyle: {
    font: {
      size: [10, 20, 30],
      family: 'Arial',
    },
  },
  style: {
    fill: { 
      color: 'rgba(255, 255, 255, 0.5)' 
    },
    stroke: {
      color: '#e51313',
      width: 2,
    },
    circle: {
      radius: 7,
      fillColor: '#e51313',
    },
  },
},
</code></pre>
</details>
<h4 id="draw.measureoptions" tabindex="-1">draw.measureOptions</h4>
<table>
<thead>
<tr>
<th>fieldName</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>metres</td>
<td>boolean?</td>
<td>Whether to show the measure option <code>'m / mÂ²'</code> to the user. <code>false</code> by default.</td>
</tr>
<tr>
<td>kilometres</td>
<td>boolean?</td>
<td>Whether to show the measure option <code>'km / kmÂ²'</code> to the user. <code>false</code> by default.</td>
</tr>
<tr>
<td>hectares</td>
<td>boolean?</td>
<td>Whether to show the measure option <code>'km / haâ€š'</code> to the user. <code>false</code> by default.</td>
</tr>
<tr>
<td>initialOption</td>
<td>'none' | 'meters' | 'kilometres' | 'hectares'</td>
<td>The initial measure option to be selected. Defaults to <code>'none'</code>.</td>
</tr>
</tbody>
</table>
<h4 id="draw.textstyle" tabindex="-1">draw.textStyle</h4>
<table>
<thead>
<tr>
<th>fieldName</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>font</td>
<td>object | string</td>
<td>Style the font of the text feature with either css font properties or use font as an object with properties 'size' and 'family'.</td>
</tr>
<tr>
<td>textColor</td>
<td>string?</td>
<td>Define text color in hex or rgb / rgba code.</td>
</tr>
</tbody>
</table>
<p>Example configuration:</p>
<pre><code class="language-js">textStyle: {
  font: '16px sans-serif'
  textColor: '#e51313'
}
</code></pre>
<h5 id="draw.textstyle.font" tabindex="-1">draw.textStyle.font</h5>
<table>
<thead>
<tr>
<th>fieldName</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>family</td>
<td>string?</td>
<td>Font family.</td>
</tr>
<tr>
<td>size</td>
<td>number[]?</td>
<td>Array with numbers that define the available text sizes that a user can choose from</td>
</tr>
</tbody>
</table>
<p>Example configuration:</p>
<pre><code class="language-js">font: {
  size: [10.5, 20, 30.5, 35],
  family: 'serif'
},
</code></pre>
<h4 id="draw.style-(by-example)" tabindex="-1">draw.style (by example)</h4>
<p>The <code>@masterportal/masterportalapi</code> has vectorStyles in development. As soon as that's done, we shall use its styling syntax and methods.</p>
<p>For the time being, please use this example as a rough reference as to what can currently be done.</p>
<pre><code class="language-js">{
  draw: {
    enableOptions: true,
    style: {
      fill: {
        color: 'rgba(255, 255, 255, 0.5)'
      },
      stroke: {
        color: '#e51313',
        width: 2
      },
      circle: {
        radius: 7,
        fillColor: '#e51313'
      },
      // Styling for text of measurements; supports everything described at https://openlayers.org/en/v9.2.4/apidoc/module-ol_style_Text-Text.html
      measure: {
        font: '16px sans-serif',
        placement: 'line',
        fill: new Fill({ color: 'black' }),
        stroke: new Stroke({ color: 'black' }),
        offsetY: -5
      }
    }
  }
}
</code></pre>
<h2 id="store" tabindex="-1">Store</h2>
<h3 id="state" tabindex="-1">State</h3>
<pre><code class="language-js">map.subscribe('plugin/draw/featureCollection', (featureCollection) =&gt; {
  /* Your code. */
})
</code></pre>
<p>The returned featureCollection is a <a href="https://geojson.org/">GeoJSON</a> FeatureCollection. It includes all drawn features (including possible measurements in meters with two decimals precision) and updates on changes.</p>
<h3 id="actions" tabindex="-1">Actions</h3>
<pre><code class="language-js">map.$store.dispatch('plugin/draw/addFeatures', {
  geoJSON: {
    type: 'FeatureCollection',
    features: [
      {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'Point',
          coordinates: [484000, 5885000],
        },
      },
    ],
  },
  overwrite: true, // defaults to false
})
</code></pre>
<p>Calling the action <code>addFeatures</code> expects an object containing the parameter <code>geoJSON</code>, which is a <a href="https://geojson.org/">GeoJSON</a> FeatureCollection.<br />
It adds the given features from the FeatureCollection to the drawn source. It is also possible to completely overwrite them using the parameter <code>overwrite</code>.</p>
<p>It's important to note that the GeoJSON Standard <a href="https://www.rfc-editor.org/rfc/rfc7946">RFC7946</a> does not support circles.
To add a circle to the map, it is assumed, that a feature being a circle has a property <code>radius</code> together with a point geometry.</p>
<pre><code class="language-js">map.$store.dispatch('plugin/draw/zoomToFeature', {
  index: 42, // defaults to 0
  margin: 420, // defaults to 20
})
</code></pre>
<p>Calling the action <code>zoomToFeature</code> zooms to the feature with position <code>index</code>, if given, and fits the map view around it with a padding of size <code>margin</code> in every direction of the feature.</p>
<pre><code class="language-js">map.$store.dispatch('plugin/draw/zoomToAllFeatures', {
  margin: 420, // defaults to 20
})
</code></pre>
<p>Calling the action <code>zoomToFeature</code> zooms to all drawn features, fits them in the map view with a padding of size <code>margin</code> in every direction of the features.</p>

    
    <h2>Locales</h2>
    <table>
      <thead>
        <tr>
          <th scope="col">Locale Key</th>
          <th scope="col">German default</th>
          <th scope="col">English default</th>
        </tr>
      </thead>
      <tbody>
        
        <tr>
          <td>plugins.draw.mode.none</td>
          <td>Keine Interaktion</td>
          <td>No interaction</td>
        </tr>
        
        <tr>
          <td>plugins.draw.mode.draw</td>
          <td>Zeichnen</td>
          <td>Draw</td>
        </tr>
        
        <tr>
          <td>plugins.draw.mode.measure</td>
          <td>Zeichnen und Messen</td>
          <td>Draw and measure</td>
        </tr>
        
        <tr>
          <td>plugins.draw.mode.write</td>
          <td>Zeichnen und Schreiben</td>
          <td>Draw and write</td>
        </tr>
        
        <tr>
          <td>plugins.draw.mode.writeAndMeasure</td>
          <td>Zeichnen, Schreiben und Messen</td>
          <td>Draw, write and measure</td>
        </tr>
        
        <tr>
          <td>plugins.draw.mode.edit</td>
          <td>Bearbeiten</td>
          <td>Edit</td>
        </tr>
        
        <tr>
          <td>plugins.draw.mode.translate</td>
          <td>Verschieben</td>
          <td>Translate</td>
        </tr>
        
        <tr>
          <td>plugins.draw.mode.delete</td>
          <td>LÃ¶schen</td>
          <td>Delete</td>
        </tr>
        
        <tr>
          <td>plugins.draw.drawMode.circle</td>
          <td>Kreis</td>
          <td>Circle</td>
        </tr>
        
        <tr>
          <td>plugins.draw.drawMode.lineString</td>
          <td>Linie</td>
          <td>Line</td>
        </tr>
        
        <tr>
          <td>plugins.draw.drawMode.point</td>
          <td>Punkt</td>
          <td>Point</td>
        </tr>
        
        <tr>
          <td>plugins.draw.drawMode.polygon</td>
          <td>Polygon</td>
          <td>Polygon</td>
        </tr>
        
        <tr>
          <td>plugins.draw.drawMode.text</td>
          <td>Text</td>
          <td>Text</td>
        </tr>
        
        <tr>
          <td>plugins.draw.measureMode.none</td>
          <td>Keine Messung</td>
          <td>No measure</td>
        </tr>
        
        <tr>
          <td>plugins.draw.measureMode.metres</td>
          <td>m</td>
          <td>m</td>
        </tr>
        
        <tr>
          <td>plugins.draw.measureMode.metresArea</td>
          <td>m / mÂ²</td>
          <td>m / mÂ²</td>
        </tr>
        
        <tr>
          <td>plugins.draw.measureMode.kilometres</td>
          <td>km</td>
          <td>km</td>
        </tr>
        
        <tr>
          <td>plugins.draw.measureMode.kilometresArea</td>
          <td>km / kmÂ²</td>
          <td>km / kmÂ²</td>
        </tr>
        
        <tr>
          <td>plugins.draw.measureMode.hectares</td>
          <td>km / ha</td>
          <td>km / ha</td>
        </tr>
        
        <tr>
          <td>plugins.draw.options.stroke</td>
          <td>Linienfarbe</td>
          <td>Stroke color</td>
        </tr>
        
        <tr>
          <td>plugins.draw.title.drawMode</td>
          <td>Zeichenmodus</td>
          <td>Drawing mode</td>
        </tr>
        
        <tr>
          <td>plugins.draw.title.mode</td>
          <td>Modus</td>
          <td>Mode</td>
        </tr>
        
        <tr>
          <td>plugins.draw.title.measureMode</td>
          <td>Messmodus</td>
          <td>Measure mode</td>
        </tr>
        
        <tr>
          <td>plugins.draw.title.options</td>
          <td>Zeichenoptionen</td>
          <td>Draw options</td>
        </tr>
        
        <tr>
          <td>plugins.draw.label.textSize</td>
          <td>TextgrÃ¶ÃŸe (px) wÃ¤hlen:</td>
          <td>Choose text size (px):</td>
        </tr>
        
      </tbody>
    </table>
  
  </article>
  <hr>
  <a href="https://github.com/Dataport/polar/blob/main/LEGALNOTICE.md" style="font-family: sans-serif;">Legal Notice (Impressum)</a>
</body>
</html>